const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BvYtYsvB.js","./Daxj9iUW.js","./mZ7MwQU_.js","./DJltBpam.js","./CNpyTKY4.js","./CCkUbLvU.js","./BrUSJa21.js","./BNh9d8Tc.js"])))=>i.map(i=>d[i]);
var kge=Object.defineProperty;var RK=s=>{throw TypeError(s)};var Dge=(s,e,t)=>e in s?kge(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var pt=(s,e,t)=>Dge(s,typeof e!="symbol"?e+"":e,t),o5=(s,e,t)=>e.has(s)||RK("Cannot "+t);var Z=(s,e,t)=>(o5(s,e,"read from private field"),t?t.call(s):e.get(s)),ke=(s,e,t)=>e.has(s)?RK("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),Sd=(s,e,t,i)=>(o5(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),MK=(s,e,t)=>(o5(s,e,"access private method"),t);import"./Bzak7iHL.js";import{w as Tge,y as ch,p as Lt,f as De,j as jn,a as It,k as ey,bc as Nie,l as wb,ab as Bz,c as Ee,r as Ie,g as I,i as X,b3 as YE,s as ue,t as ze,n as Oi,b2 as Rie,u as Br,h as At,e as Le,b as ty,bp as Xr,bn as jl,bq as Nge,ao as Dr,o as Wz,aK as Rge}from"./s46vk8Jw.js";import{c as gt,a as Q,f as Re,s as fs,t as pn,u as ku,d as dv,o as oc,b as Mie,p as Hz}from"./DN3X4kc0.js";import{s as Hi,a as vc,C as Vz,S as XE,d as Xt,b as Qn,c as jo,f as El,M as Mge,i as Aie,g as r5}from"./CUB-rzCD.js";import{s as zn,r as vn,p as Ae,i as St}from"./2OVp_Qab.js";import{I as ir,X as Yf,U as Age,V as Pge,W as Oge}from"./BmHSYkZA.js";import{h as Ch}from"./DheJj1GP.js";import{s as tt}from"./DtPKuzlZ.js";import{e as Xn,B as fo,o as tc,aa as Fge,ab as Bge,c as Pie}from"./Cancu-m9.js";import{b as If,c as Rt}from"./De42ds-N.js";import{s as zz,a as Aa,C as Oie,L as Wge}from"./C8urkpmS.js";import{S as Fie}from"./ckyQhoJs.js";import{ap as Bie,y as Ac,z as Pc,A as hl,S as Oc,K as Wie,F as Hie,w as Jm,H as Vie,I as zie,e as Hge,r as Ov,v as Fv,a0 as L0,x as Bv,aJ as Vge,aD as zge,ab as Uge,a7 as $ge,az as qge,a8 as jge,a9 as a5,h as l5,D as Kge,m as Gge,n as Yge,o as Xge,p as Zge,q as Qge,aK as Jge}from"./Drk8VXU9.js";import{I as ul,L as Uie}from"./BIp1fOdr.js";import{i as eme}from"./D_OlEWjx.js";import{g as $t}from"./CluvpHAZ.js";import{d as AK}from"./DhQwU1Nv.js";import{_ as Qe}from"./Dp1pzeXC.js";var mg,z1,rE,sA,$ie;const oA=class oA{constructor(e){ke(this,sA);ke(this,mg,new WeakMap);ke(this,z1);ke(this,rE);Sd(this,rE,e)}observe(e,t){var i=Z(this,mg).get(e)||new Set;return i.add(t),Z(this,mg).set(e,i),MK(this,sA,$ie).call(this).observe(e,Z(this,rE)),()=>{var n=Z(this,mg).get(e);n.delete(t),n.size===0&&(Z(this,mg).delete(e),Z(this,z1).unobserve(e))}}};mg=new WeakMap,z1=new WeakMap,rE=new WeakMap,sA=new WeakSet,$ie=function(){return Z(this,z1)??Sd(this,z1,new ResizeObserver(e=>{for(var t of e){oA.entries.set(t.target,t);for(var i of Z(this,mg).get(t.target)||[])i(t)}}))},pt(oA,"entries",new WeakMap);let t9=oA;var tme=new t9({box:"border-box"});function PK(s,e,t){var i=tme.observe(s,()=>t(s[e]));Tge(()=>(ch(()=>t(s[e])),i))}function ime(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"m3 16 4 4 4-4"}],["path",{d:"M7 20V4"}],["path",{d:"M11 4h4"}],["path",{d:"M11 8h7"}],["path",{d:"M11 12h10"}]];ir(s,zn({name:"arrow-down-narrow-wide"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function nme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"m21 16-4 4-4-4"}],["path",{d:"M17 20V4"}],["path",{d:"m3 8 4-4 4 4"}],["path",{d:"M7 4v16"}]];ir(s,zn({name:"arrow-up-down"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function sme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"m3 8 4-4 4 4"}],["path",{d:"M7 4v16"}],["path",{d:"M11 12h4"}],["path",{d:"M11 16h7"}],["path",{d:"M11 20h10"}]];ir(s,zn({name:"arrow-up-narrow-wide"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function CN(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1"}],["path",{d:"M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1"}]];ir(s,zn({name:"braces"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function wN(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18"}],["path",{d:"M16 10h.01"}],["path",{d:"M12 10h.01"}],["path",{d:"M8 10h.01"}],["path",{d:"M12 14h.01"}],["path",{d:"M8 14h.01"}],["path",{d:"M12 18h.01"}],["path",{d:"M8 18h.01"}]];ir(s,zn({name:"calculator"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function Tct(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"m15 18-6-6 6-6"}]];ir(s,zn({name:"chevron-left"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function ome(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["circle",{cx:"12",cy:"6",r:"1"}],["line",{x1:"5",x2:"19",y1:"12",y2:"12"}],["circle",{cx:"12",cy:"18",r:"1"}]];ir(s,zn({name:"divide"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function rme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["circle",{cx:"12",cy:"12",r:"1"}],["circle",{cx:"12",cy:"5",r:"1"}],["circle",{cx:"12",cy:"19",r:"1"}]];ir(s,zn({name:"ellipsis-vertical"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function ame(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"}]];ir(s,zn({name:"funnel"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function mS(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];ir(s,zn({name:"grip-vertical"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function lme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M3 7V5c0-1.1.9-2 2-2h2"}],["path",{d:"M17 3h2c1.1 0 2 .9 2 2v2"}],["path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2"}],["path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2"}],["rect",{width:"7",height:"5",x:"7",y:"7",rx:"1"}],["rect",{width:"7",height:"5",x:"10",y:"12",rx:"1"}]];ir(s,zn({name:"group"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function qie(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["line",{x1:"4",x2:"20",y1:"9",y2:"9"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21"}]];ir(s,zn({name:"hash"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function nL(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];ir(s,zn({name:"layers"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function jie(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M12 2v4"}],["path",{d:"m16.2 7.8 2.9-2.9"}],["path",{d:"M18 12h4"}],["path",{d:"m16.2 16.2 2.9 2.9"}],["path",{d:"M12 18v4"}],["path",{d:"m4.9 19.1 2.9-2.9"}],["path",{d:"M2 12h4"}],["path",{d:"m4.9 4.9 2.9 2.9"}]];ir(s,zn({name:"loader"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function Nct(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];ir(s,zn({name:"rotate-ccw"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function cme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M18 7V5a1 1 0 0 0-1-1H6.5a.5.5 0 0 0-.4.8l4.5 6a2 2 0 0 1 0 2.4l-4.5 6a.5.5 0 0 0 .4.8H17a1 1 0 0 0 1-1v-2"}]];ir(s,zn({name:"sigma"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function dme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["path",{d:"M9 17c2 0 2.8-1 2.8-2.8V10c0-2 1-3.3 3.2-3"}],["path",{d:"M9 11.2h5.7"}]];ir(s,zn({name:"square-function"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}function hme(s,e){Lt(e,!0);/**
 * @license @lucide/svelte v0.561.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=vn(e,["$$slots","$$events","$$legacy"]);const i=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];ir(s,zn({name:"trash"},()=>t,{get iconNode(){return i},children:(n,o)=>{var r=gt(),a=De(r);Hi(a,()=>e.children??jn),Q(n,r)},$$slots:{default:!0}})),It()}const ume=()=>"Copy Cell Value",fme=()=>"Copiar valor de celda",gme=()=>"نسخ قيمة الخلية",mme=()=>"Zellwert kopieren",pme=()=>"셀 값 복사",_me=()=>"Copier la valeur de la cellule",bme=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ume():t==="es"?fme():t==="ar"?gme():t==="de"?mme():t==="ko"?pme():_me()},vme=()=>"Copy Row as JSON",Cme=()=>"Copiar fila como JSON",wme=()=>"نسخ الصف كـ JSON",yme=()=>"Zeile als JSON kopieren",Sme=()=>"행을 JSON으로 복사",xme=()=>"Copier la ligne en JSON",Lme=(s={},e={})=>{const t=e.locale??$t();return t==="en"?vme():t==="es"?Cme():t==="ar"?wme():t==="de"?yme():t==="ko"?Sme():xme()},Ime=()=>"Copy Column Values",Eme=()=>"Copiar valores de columna",kme=()=>"نسخ قيم العمود",Dme=()=>"Spaltenwerte kopieren",Tme=()=>"열 값 복사",Nme=()=>"Copier les valeurs de la colonne",Rme=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ime():t==="es"?Eme():t==="ar"?kme():t==="de"?Dme():t==="ko"?Tme():Nme()},Mme=()=>"Delete Row",Ame=()=>"Eliminar fila",Pme=()=>"حذف الصف",Ome=()=>"Zeile löschen",Fme=()=>"행 삭제",Bme=()=>"Supprimer la ligne",Wme=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Mme():t==="es"?Ame():t==="ar"?Pme():t==="de"?Ome():t==="ko"?Fme():Bme()},Hme=()=>"Enter Parameter Values",Vme=()=>"Ingresar valores de parámetros",zme=()=>"إدخال قيم المعاملات",Ume=()=>"Parameterwerte eingeben",$me=()=>"매개변수 값 입력",qme=()=>"Saisir les valeurs des paramètres",jme=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Hme():t==="es"?Vme():t==="ar"?zme():t==="de"?Ume():t==="ko"?$me():qme()},Kme=()=>"Provide values for the query parameters",Gme=()=>"Proporciona valores para los parámetros de la consulta",Yme=()=>"قم بتوفير قيم لمعاملات الاستعلام",Xme=()=>"Geben Sie Werte für die Abfrageparameter an",Zme=()=>"쿼리 매개변수의 값을 입력하세요",Qme=()=>"Fournissez les valeurs pour les paramètres de la requête",Jme=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Kme():t==="es"?Gme():t==="ar"?Yme():t==="de"?Xme():t==="ko"?Zme():Qme()},epe=()=>"Execute",tpe=()=>"Ejecutar",ipe=()=>"تنفيذ",npe=()=>"Ausführen",spe=()=>"실행",ope=()=>"Exécuter",rpe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?epe():t==="es"?tpe():t==="ar"?ipe():t==="de"?npe():t==="ko"?spe():ope()},ape=()=>"Cancel",lpe=()=>"Cancelar",cpe=()=>"إلغاء",dpe=()=>"Abbrechen",hpe=()=>"취소",upe=()=>"Annuler",fpe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ape():t==="es"?lpe():t==="ar"?cpe():t==="de"?dpe():t==="ko"?hpe():upe()},gpe=s=>`Enter ${s==null?void 0:s.name}`,mpe=s=>`Ingresar ${s==null?void 0:s.name}`,ppe=s=>`أدخل ${s==null?void 0:s.name}`,_pe=s=>`${s==null?void 0:s.name} eingeben`,bpe=s=>`${s==null?void 0:s.name} 입력`,vpe=s=>`Saisir ${s==null?void 0:s.name}`,Cpe=(s,e={})=>{const t=e.locale??$t();return t==="en"?gpe(s):t==="es"?mpe(s):t==="ar"?ppe(s):t==="de"?_pe(s):t==="ko"?bpe(s):vpe(s)},wpe=()=>"Select...",ype=()=>"Seleccionar...",Spe=()=>"اختر...",xpe=()=>"Auswählen...",Lpe=()=>"선택...",Ipe=()=>"Sélectionner...",Epe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?wpe():t==="es"?ype():t==="ar"?Spe():t==="de"?xpe():t==="ko"?Lpe():Ipe()},iy=()=>"WHERE",kpe=iy,Dpe=iy,Tpe=iy,Npe=iy,Rpe=iy,Mpe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?iy():t==="es"?kpe():t==="ar"?Dpe():t==="de"?Tpe():t==="ko"?Npe():Rpe()},ny=()=>"GROUP BY",Ape=ny,Ppe=ny,Ope=ny,Fpe=ny,Bpe=ny,Wpe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ny():t==="es"?Ape():t==="ar"?Ppe():t==="de"?Ope():t==="ko"?Fpe():Bpe()},sy=()=>"AGGREGATES",Hpe=sy,Vpe=sy,zpe=sy,Upe=sy,$pe=sy,qpe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?sy():t==="es"?Hpe():t==="ar"?Vpe():t==="de"?zpe():t==="ko"?Upe():$pe()},oy=()=>"HAVING",jpe=oy,Kpe=oy,Gpe=oy,Ype=oy,Xpe=oy,Zpe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?oy():t==="es"?jpe():t==="ar"?Kpe():t==="de"?Gpe():t==="ko"?Ype():Xpe()},ry=()=>"ORDER BY",Qpe=ry,Jpe=ry,e_e=ry,t_e=ry,i_e=ry,n_e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ry():t==="es"?Qpe():t==="ar"?Jpe():t==="de"?e_e():t==="ko"?t_e():i_e()},ay=()=>"LIMIT",s_e=ay,o_e=ay,r_e=ay,a_e=ay,l_e=ay,c_e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ay():t==="es"?s_e():t==="ar"?o_e():t==="de"?r_e():t==="ko"?a_e():l_e()},ly=()=>"Add",d_e=ly,h_e=ly,u_e=ly,f_e=ly,g_e=ly,I0=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ly():t==="es"?d_e():t==="ar"?h_e():t==="de"?u_e():t==="ko"?f_e():g_e()},cy=()=>"Back to Main",m_e=cy,p_e=cy,__e=cy,b_e=cy,v_e=cy,C_e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?cy():t==="es"?m_e():t==="ar"?p_e():t==="de"?__e():t==="ko"?b_e():v_e()},dy=s=>`Editing: ${s==null?void 0:s.context}`,w_e=dy,y_e=dy,S_e=dy,x_e=dy,L_e=dy,I_e=(s,e={})=>{const t=e.locale??$t();return t==="en"?dy(s):t==="es"?w_e(s):t==="ar"?y_e(s):t==="de"?S_e(s):t==="ko"?x_e(s):L_e(s)},hy=s=>`CTE: ${s==null?void 0:s.name}`,E_e=hy,k_e=hy,D_e=hy,T_e=hy,N_e=hy,R_e=(s,e={})=>{const t=e.locale??$t();return t==="en"?hy(s):t==="es"?E_e(s):t==="ar"?k_e(s):t==="de"?D_e(s):t==="ko"?T_e(s):N_e(s)},uy=()=>"Subquery",M_e=uy,A_e=uy,P_e=uy,O_e=uy,F_e=uy,c5=(s={},e={})=>{const t=e.locale??$t();return t==="en"?uy():t==="es"?M_e():t==="ar"?A_e():t==="de"?P_e():t==="ko"?O_e():F_e()},fy=()=>"Main Query",B_e=fy,W_e=fy,H_e=fy,V_e=fy,z_e=fy,U_e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?fy():t==="es"?B_e():t==="ar"?W_e():t==="de"?H_e():t==="ko"?V_e():z_e()},gy=()=>"Select...",$_e=gy,q_e=gy,j_e=gy,K_e=gy,G_e=gy,Y_e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?gy():t==="es"?$_e():t==="ar"?q_e():t==="de"?j_e():t==="ko"?K_e():G_e()},my=s=>`Subquery (${s==null?void 0:s.count} tables)`,X_e=my,Z_e=my,Q_e=my,J_e=my,ebe=my,tbe=(s,e={})=>{const t=e.locale??$t();return t==="en"?my(s):t==="es"?X_e(s):t==="ar"?Z_e(s):t==="de"?Q_e(s):t==="ko"?J_e(s):ebe(s)},py=()=>"+ Create New Subquery",ibe=py,nbe=py,sbe=py,obe=py,rbe=py,OK=(s={},e={})=>{const t=e.locale??$t();return t==="en"?py():t==="es"?ibe():t==="ar"?nbe():t==="de"?sbe():t==="ko"?obe():rbe()},_y=()=>"Use literal value",abe=_y,lbe=_y,cbe=_y,dbe=_y,hbe=_y,ube=(s={},e={})=>{const t=e.locale??$t();return t==="en"?_y():t==="es"?abe():t==="ar"?lbe():t==="de"?cbe():t==="ko"?dbe():hbe()},by=()=>"Use subquery",fbe=by,gbe=by,mbe=by,pbe=by,_be=by,bbe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?by():t==="es"?fbe():t==="ar"?gbe():t==="de"?mbe():t==="ko"?pbe():_be()},vy=()=>'No filters. Click "Add" to add a WHERE condition.',vbe=vy,Cbe=vy,wbe=vy,ybe=vy,Sbe=vy,xbe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?vy():t==="es"?vbe():t==="ar"?Cbe():t==="de"?wbe():t==="ko"?ybe():Sbe()},Cy=()=>'No grouping. Click "Add" to add a GROUP BY column.',Lbe=Cy,Ibe=Cy,Ebe=Cy,kbe=Cy,Dbe=Cy,Tbe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Cy():t==="es"?Lbe():t==="ar"?Ibe():t==="de"?Ebe():t==="ko"?kbe():Dbe()},wy=()=>'No aggregates. Click "Add" to add COUNT, SUM, etc.',Nbe=wy,Rbe=wy,Mbe=wy,Abe=wy,Pbe=wy,Obe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?wy():t==="es"?Nbe():t==="ar"?Rbe():t==="de"?Mbe():t==="ko"?Abe():Pbe()},yy=()=>'No HAVING conditions. Click "Add" to filter groups.',Fbe=yy,Bbe=yy,Wbe=yy,Hbe=yy,Vbe=yy,zbe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?yy():t==="es"?Fbe():t==="ar"?Bbe():t==="de"?Wbe():t==="ko"?Hbe():Vbe()},Sy=()=>'No sorting. Click "Add" to add an ORDER BY clause.',Ube=Sy,$be=Sy,qbe=Sy,jbe=Sy,Kbe=Sy,Gbe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Sy():t==="es"?Ube():t==="ar"?$be():t==="de"?qbe():t==="ko"?jbe():Kbe()},xy=()=>"Return first",Ybe=xy,Xbe=xy,Zbe=xy,Qbe=xy,Jbe=xy,eve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?xy():t==="es"?Ybe():t==="ar"?Xbe():t==="de"?Zbe():t==="ko"?Qbe():Jbe()},Ly=()=>"rows",tve=Ly,ive=Ly,nve=Ly,sve=Ly,ove=Ly,rve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ly():t==="es"?tve():t==="ar"?ive():t==="de"?nve():t==="ko"?sve():ove()},Iy=()=>"No limit",ave=Iy,lve=Iy,cve=Iy,dve=Iy,hve=Iy,uve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Iy():t==="es"?ave():t==="ar"?lve():t==="de"?cve():t==="ko"?dve():hve()},Ey=()=>"equals",fve=Ey,gve=Ey,mve=Ey,pve=Ey,_ve=Ey,bve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ey():t==="es"?fve():t==="ar"?gve():t==="de"?mve():t==="ko"?pve():_ve()},ky=()=>"not equals",vve=ky,Cve=ky,wve=ky,yve=ky,Sve=ky,xve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?ky():t==="es"?vve():t==="ar"?Cve():t==="de"?wve():t==="ko"?yve():Sve()},Dy=()=>"greater than",Lve=Dy,Ive=Dy,Eve=Dy,kve=Dy,Dve=Dy,FK=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Dy():t==="es"?Lve():t==="ar"?Ive():t==="de"?Eve():t==="ko"?kve():Dve()},Ty=()=>"less than",Tve=Ty,Nve=Ty,Rve=Ty,Mve=Ty,Ave=Ty,BK=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ty():t==="es"?Tve():t==="ar"?Nve():t==="de"?Rve():t==="ko"?Mve():Ave()},Ny=()=>"contains",Pve=Ny,Ove=Ny,Fve=Ny,Bve=Ny,Wve=Ny,Hve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ny():t==="es"?Pve():t==="ar"?Ove():t==="de"?Fve():t==="ko"?Bve():Wve()},Ry=()=>"in",Vve=Ry,zve=Ry,Uve=Ry,$ve=Ry,qve=Ry,jve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ry():t==="es"?Vve():t==="ar"?zve():t==="de"?Uve():t==="ko"?$ve():qve()},My=()=>"not in",Kve=My,Gve=My,Yve=My,Xve=My,Zve=My,Qve=(s={},e={})=>{const t=e.locale??$t();return t==="en"?My():t==="es"?Kve():t==="ar"?Gve():t==="de"?Yve():t==="ko"?Xve():Zve()},Ay=()=>"is null",Jve=Ay,eCe=Ay,tCe=Ay,iCe=Ay,nCe=Ay,sCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ay():t==="es"?Jve():t==="ar"?eCe():t==="de"?tCe():t==="ko"?iCe():nCe()},Py=()=>"is not null",oCe=Py,rCe=Py,aCe=Py,lCe=Py,cCe=Py,dCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Py():t==="es"?oCe():t==="ar"?rCe():t==="de"?aCe():t==="ko"?lCe():cCe()},Oy=()=>"is true",hCe=Oy,uCe=Oy,fCe=Oy,gCe=Oy,mCe=Oy,pCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Oy():t==="es"?hCe():t==="ar"?uCe():t==="de"?fCe():t==="ko"?gCe():mCe()},Fy=()=>"is false",_Ce=Fy,bCe=Fy,vCe=Fy,CCe=Fy,wCe=Fy,yCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Fy():t==="es"?_Ce():t==="ar"?bCe():t==="de"?vCe():t==="ko"?CCe():wCe()},By=()=>"is not true",SCe=By,xCe=By,LCe=By,ICe=By,ECe=By,kCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?By():t==="es"?SCe():t==="ar"?xCe():t==="de"?LCe():t==="ko"?ICe():ECe()},Wy=()=>"is not false",DCe=Wy,TCe=Wy,NCe=Wy,RCe=Wy,MCe=Wy,ACe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Wy():t==="es"?DCe():t==="ar"?TCe():t==="de"?NCe():t==="ko"?RCe():MCe()},Hy=()=>"Tables",PCe=Hy,OCe=Hy,FCe=Hy,BCe=Hy,WCe=Hy,HCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Hy():t==="es"?PCe():t==="ar"?OCe():t==="de"?FCe():t==="ko"?BCe():WCe()},Vy=()=>"Drag onto canvas",VCe=Vy,zCe=Vy,UCe=Vy,$Ce=Vy,qCe=Vy,jCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Vy():t==="es"?VCe():t==="ar"?zCe():t==="de"?UCe():t==="ko"?$Ce():qCe()},zy=()=>"No tables available. Connect to a database to see tables.",KCe=zy,GCe=zy,YCe=zy,XCe=zy,ZCe=zy,QCe=(s={},e={})=>{const t=e.locale??$t();return t==="en"?zy():t==="es"?KCe():t==="ar"?GCe():t==="de"?YCe():t==="ko"?XCe():ZCe()},Uy=()=>"Subquery",JCe=Uy,e1e=Uy,t1e=Uy,i1e=Uy,n1e=Uy,s1e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Uy():t==="es"?JCe():t==="ar"?e1e():t==="de"?t1e():t==="ko"?i1e():n1e()},$y=()=>"nested",o1e=$y,r1e=$y,a1e=$y,l1e=$y,c1e=$y,d1e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?$y():t==="es"?o1e():t==="ar"?r1e():t==="de"?a1e():t==="ko"?l1e():c1e()},qy=()=>"CTE (WITH)",h1e=qy,u1e=qy,f1e=qy,g1e=qy,m1e=qy,p1e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?qy():t==="es"?h1e():t==="ar"?u1e():t==="de"?f1e():t==="ko"?g1e():m1e()},jy=()=>"reusable",_1e=jy,b1e=jy,v1e=jy,C1e=jy,w1e=jy,y1e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?jy():t==="es"?_1e():t==="ar"?b1e():t==="de"?v1e():t==="ko"?C1e():w1e()},Ky=()=>"Defined CTEs",S1e=Ky,x1e=Ky,L1e=Ky,I1e=Ky,E1e=Ky,k1e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Ky():t==="es"?S1e():t==="ar"?x1e():t==="de"?L1e():t==="ko"?I1e():E1e()},Gy=()=>"AS",D1e=Gy,T1e=Gy,N1e=Gy,R1e=Gy,M1e=Gy,A1e=(s={},e={})=>{const t=e.locale??$t();return t==="en"?Gy():t==="es"?D1e():t==="ar"?T1e():t==="de"?N1e():t==="ko"?R1e():M1e()};var P1e={value:()=>{}};function tO(){for(var s=0,e=arguments.length,t={},i;s<e;++s){if(!(i=arguments[s]+"")||i in t||/[\s.]/.test(i))throw new Error("illegal type: "+i);t[i]=[]}return new DT(t)}function DT(s){this._=s}function O1e(s,e){return s.trim().split(/^|\s+/).map(function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}})}DT.prototype=tO.prototype={constructor:DT,on:function(s,e){var t=this._,i=O1e(s+"",t),n,o=-1,r=i.length;if(arguments.length<2){for(;++o<r;)if((n=(s=i[o]).type)&&(n=F1e(t[n],s.name)))return n;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<r;)if(n=(s=i[o]).type)t[n]=WK(t[n],s.name,e);else if(e==null)for(n in t)t[n]=WK(t[n],s.name,null);return this},copy:function(){var s={},e=this._;for(var t in e)s[t]=e[t].slice();return new DT(s)},call:function(s,e){if((n=arguments.length-2)>0)for(var t=new Array(n),i=0,n,o;i<n;++i)t[i]=arguments[i+2];if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(o=this._[s],i=0,n=o.length;i<n;++i)o[i].value.apply(e,t)},apply:function(s,e,t){if(!this._.hasOwnProperty(s))throw new Error("unknown type: "+s);for(var i=this._[s],n=0,o=i.length;n<o;++n)i[n].value.apply(e,t)}};function F1e(s,e){for(var t=0,i=s.length,n;t<i;++t)if((n=s[t]).name===e)return n.value}function WK(s,e,t){for(var i=0,n=s.length;i<n;++i)if(s[i].name===e){s[i]=P1e,s=s.slice(0,i).concat(s.slice(i+1));break}return t!=null&&s.push({name:e,value:t}),s}var i9="http://www.w3.org/1999/xhtml";const HK={svg:"http://www.w3.org/2000/svg",xhtml:i9,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function iO(s){var e=s+="",t=e.indexOf(":");return t>=0&&(e=s.slice(0,t))!=="xmlns"&&(s=s.slice(t+1)),HK.hasOwnProperty(e)?{space:HK[e],local:s}:s}function B1e(s){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===i9&&e.documentElement.namespaceURI===i9?e.createElement(s):e.createElementNS(t,s)}}function W1e(s){return function(){return this.ownerDocument.createElementNS(s.space,s.local)}}function Kie(s){var e=iO(s);return(e.local?W1e:B1e)(e)}function H1e(){}function Uz(s){return s==null?H1e:function(){return this.querySelector(s)}}function V1e(s){typeof s!="function"&&(s=Uz(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var o=e[n],r=o.length,a=i[n]=new Array(r),l,c,d=0;d<r;++d)(l=o[d])&&(c=s.call(l,l.__data__,d,o))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new Rl(i,this._parents)}function z1e(s){return s==null?[]:Array.isArray(s)?s:Array.from(s)}function U1e(){return[]}function Gie(s){return s==null?U1e:function(){return this.querySelectorAll(s)}}function $1e(s){return function(){return z1e(s.apply(this,arguments))}}function q1e(s){typeof s=="function"?s=$1e(s):s=Gie(s);for(var e=this._groups,t=e.length,i=[],n=[],o=0;o<t;++o)for(var r=e[o],a=r.length,l,c=0;c<a;++c)(l=r[c])&&(i.push(s.call(l,l.__data__,c,r)),n.push(l));return new Rl(i,n)}function Yie(s){return function(){return this.matches(s)}}function Xie(s){return function(e){return e.matches(s)}}var j1e=Array.prototype.find;function K1e(s){return function(){return j1e.call(this.children,s)}}function G1e(){return this.firstElementChild}function Y1e(s){return this.select(s==null?G1e:K1e(typeof s=="function"?s:Xie(s)))}var X1e=Array.prototype.filter;function Z1e(){return Array.from(this.children)}function Q1e(s){return function(){return X1e.call(this.children,s)}}function J1e(s){return this.selectAll(s==null?Z1e:Q1e(typeof s=="function"?s:Xie(s)))}function ewe(s){typeof s!="function"&&(s=Yie(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var o=e[n],r=o.length,a=i[n]=[],l,c=0;c<r;++c)(l=o[c])&&s.call(l,l.__data__,c,o)&&a.push(l);return new Rl(i,this._parents)}function Zie(s){return new Array(s.length)}function twe(){return new Rl(this._enter||this._groups.map(Zie),this._parents)}function yN(s,e){this.ownerDocument=s.ownerDocument,this.namespaceURI=s.namespaceURI,this._next=null,this._parent=s,this.__data__=e}yN.prototype={constructor:yN,appendChild:function(s){return this._parent.insertBefore(s,this._next)},insertBefore:function(s,e){return this._parent.insertBefore(s,e)},querySelector:function(s){return this._parent.querySelector(s)},querySelectorAll:function(s){return this._parent.querySelectorAll(s)}};function iwe(s){return function(){return s}}function nwe(s,e,t,i,n,o){for(var r=0,a,l=e.length,c=o.length;r<c;++r)(a=e[r])?(a.__data__=o[r],i[r]=a):t[r]=new yN(s,o[r]);for(;r<l;++r)(a=e[r])&&(n[r]=a)}function swe(s,e,t,i,n,o,r){var a,l,c=new Map,d=e.length,h=o.length,u=new Array(d),f;for(a=0;a<d;++a)(l=e[a])&&(u[a]=f=r.call(l,l.__data__,a,e)+"",c.has(f)?n[a]=l:c.set(f,l));for(a=0;a<h;++a)f=r.call(s,o[a],a,o)+"",(l=c.get(f))?(i[a]=l,l.__data__=o[a],c.delete(f)):t[a]=new yN(s,o[a]);for(a=0;a<d;++a)(l=e[a])&&c.get(u[a])===l&&(n[a]=l)}function owe(s){return s.__data__}function rwe(s,e){if(!arguments.length)return Array.from(this,owe);var t=e?swe:nwe,i=this._parents,n=this._groups;typeof s!="function"&&(s=iwe(s));for(var o=n.length,r=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var d=i[c],h=n[c],u=h.length,f=awe(s.call(d,d&&d.__data__,c,i)),g=f.length,m=a[c]=new Array(g),p=r[c]=new Array(g),v=l[c]=new Array(u);t(d,h,m,p,v,f,e);for(var b=0,w=0,C,y;b<g;++b)if(C=m[b]){for(b>=w&&(w=b+1);!(y=p[w])&&++w<g;);C._next=y||null}}return r=new Rl(r,i),r._enter=a,r._exit=l,r}function awe(s){return typeof s=="object"&&"length"in s?s:Array.from(s)}function lwe(){return new Rl(this._exit||this._groups.map(Zie),this._parents)}function cwe(s,e,t){var i=this.enter(),n=this,o=this.exit();return typeof s=="function"?(i=s(i),i&&(i=i.selection())):i=i.append(s+""),e!=null&&(n=e(n),n&&(n=n.selection())),t==null?o.remove():t(o),i&&n?i.merge(n).order():n}function dwe(s){for(var e=s.selection?s.selection():s,t=this._groups,i=e._groups,n=t.length,o=i.length,r=Math.min(n,o),a=new Array(n),l=0;l<r;++l)for(var c=t[l],d=i[l],h=c.length,u=a[l]=new Array(h),f,g=0;g<h;++g)(f=c[g]||d[g])&&(u[g]=f);for(;l<n;++l)a[l]=t[l];return new Rl(a,this._parents)}function hwe(){for(var s=this._groups,e=-1,t=s.length;++e<t;)for(var i=s[e],n=i.length-1,o=i[n],r;--n>=0;)(r=i[n])&&(o&&r.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(r,o),o=r);return this}function uwe(s){s||(s=fwe);function e(h,u){return h&&u?s(h.__data__,u.__data__):!h-!u}for(var t=this._groups,i=t.length,n=new Array(i),o=0;o<i;++o){for(var r=t[o],a=r.length,l=n[o]=new Array(a),c,d=0;d<a;++d)(c=r[d])&&(l[d]=c);l.sort(e)}return new Rl(n,this._parents).order()}function fwe(s,e){return s<e?-1:s>e?1:s>=e?0:NaN}function gwe(){var s=arguments[0];return arguments[0]=this,s.apply(null,arguments),this}function mwe(){return Array.from(this)}function pwe(){for(var s=this._groups,e=0,t=s.length;e<t;++e)for(var i=s[e],n=0,o=i.length;n<o;++n){var r=i[n];if(r)return r}return null}function _we(){let s=0;for(const e of this)++s;return s}function bwe(){return!this.node()}function vwe(s){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var n=e[t],o=0,r=n.length,a;o<r;++o)(a=n[o])&&s.call(a,a.__data__,o,n);return this}function Cwe(s){return function(){this.removeAttribute(s)}}function wwe(s){return function(){this.removeAttributeNS(s.space,s.local)}}function ywe(s,e){return function(){this.setAttribute(s,e)}}function Swe(s,e){return function(){this.setAttributeNS(s.space,s.local,e)}}function xwe(s,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(s):this.setAttribute(s,t)}}function Lwe(s,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(s.space,s.local):this.setAttributeNS(s.space,s.local,t)}}function Iwe(s,e){var t=iO(s);if(arguments.length<2){var i=this.node();return t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}return this.each((e==null?t.local?wwe:Cwe:typeof e=="function"?t.local?Lwe:xwe:t.local?Swe:ywe)(t,e))}function Qie(s){return s.ownerDocument&&s.ownerDocument.defaultView||s.document&&s||s.defaultView}function Ewe(s){return function(){this.style.removeProperty(s)}}function kwe(s,e,t){return function(){this.style.setProperty(s,e,t)}}function Dwe(s,e,t){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(s):this.style.setProperty(s,i,t)}}function Twe(s,e,t){return arguments.length>1?this.each((e==null?Ewe:typeof e=="function"?Dwe:kwe)(s,e,t??"")):lw(this.node(),s)}function lw(s,e){return s.style.getPropertyValue(e)||Qie(s).getComputedStyle(s,null).getPropertyValue(e)}function Nwe(s){return function(){delete this[s]}}function Rwe(s,e){return function(){this[s]=e}}function Mwe(s,e){return function(){var t=e.apply(this,arguments);t==null?delete this[s]:this[s]=t}}function Awe(s,e){return arguments.length>1?this.each((e==null?Nwe:typeof e=="function"?Mwe:Rwe)(s,e)):this.node()[s]}function Jie(s){return s.trim().split(/^|\s+/)}function $z(s){return s.classList||new ene(s)}function ene(s){this._node=s,this._names=Jie(s.getAttribute("class")||"")}ene.prototype={add:function(s){var e=this._names.indexOf(s);e<0&&(this._names.push(s),this._node.setAttribute("class",this._names.join(" ")))},remove:function(s){var e=this._names.indexOf(s);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(s){return this._names.indexOf(s)>=0}};function tne(s,e){for(var t=$z(s),i=-1,n=e.length;++i<n;)t.add(e[i])}function ine(s,e){for(var t=$z(s),i=-1,n=e.length;++i<n;)t.remove(e[i])}function Pwe(s){return function(){tne(this,s)}}function Owe(s){return function(){ine(this,s)}}function Fwe(s,e){return function(){(e.apply(this,arguments)?tne:ine)(this,s)}}function Bwe(s,e){var t=Jie(s+"");if(arguments.length<2){for(var i=$z(this.node()),n=-1,o=t.length;++n<o;)if(!i.contains(t[n]))return!1;return!0}return this.each((typeof e=="function"?Fwe:e?Pwe:Owe)(t,e))}function Wwe(){this.textContent=""}function Hwe(s){return function(){this.textContent=s}}function Vwe(s){return function(){var e=s.apply(this,arguments);this.textContent=e??""}}function zwe(s){return arguments.length?this.each(s==null?Wwe:(typeof s=="function"?Vwe:Hwe)(s)):this.node().textContent}function Uwe(){this.innerHTML=""}function $we(s){return function(){this.innerHTML=s}}function qwe(s){return function(){var e=s.apply(this,arguments);this.innerHTML=e??""}}function jwe(s){return arguments.length?this.each(s==null?Uwe:(typeof s=="function"?qwe:$we)(s)):this.node().innerHTML}function Kwe(){this.nextSibling&&this.parentNode.appendChild(this)}function Gwe(){return this.each(Kwe)}function Ywe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Xwe(){return this.each(Ywe)}function Zwe(s){var e=typeof s=="function"?s:Kie(s);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Qwe(){return null}function Jwe(s,e){var t=typeof s=="function"?s:Kie(s),i=e==null?Qwe:typeof e=="function"?e:Uz(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),i.apply(this,arguments)||null)})}function eye(){var s=this.parentNode;s&&s.removeChild(this)}function tye(){return this.each(eye)}function iye(){var s=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function nye(){var s=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(s,this.nextSibling):s}function sye(s){return this.select(s?nye:iye)}function oye(s){return arguments.length?this.property("__data__",s):this.node().__data__}function rye(s){return function(e){s.call(this,e,this.__data__)}}function aye(s){return s.trim().split(/^|\s+/).map(function(e){var t="",i=e.indexOf(".");return i>=0&&(t=e.slice(i+1),e=e.slice(0,i)),{type:e,name:t}})}function lye(s){return function(){var e=this.__on;if(e){for(var t=0,i=-1,n=e.length,o;t<n;++t)o=e[t],(!s.type||o.type===s.type)&&o.name===s.name?this.removeEventListener(o.type,o.listener,o.options):e[++i]=o;++i?e.length=i:delete this.__on}}}function cye(s,e,t){return function(){var i=this.__on,n,o=rye(e);if(i){for(var r=0,a=i.length;r<a;++r)if((n=i[r]).type===s.type&&n.name===s.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=o,n.options=t),n.value=e;return}}this.addEventListener(s.type,o,t),n={type:s.type,name:s.name,value:e,listener:o,options:t},i?i.push(n):this.__on=[n]}}function dye(s,e,t){var i=aye(s+""),n,o=i.length,r;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(n=0,d=a[l];n<o;++n)if((r=i[n]).type===d.type&&r.name===d.name)return d.value}return}for(a=e?cye:lye,n=0;n<o;++n)this.each(a(i[n],e,t));return this}function nne(s,e,t){var i=Qie(s),n=i.CustomEvent;typeof n=="function"?n=new n(e,t):(n=i.document.createEvent("Event"),t?(n.initEvent(e,t.bubbles,t.cancelable),n.detail=t.detail):n.initEvent(e,!1,!1)),s.dispatchEvent(n)}function hye(s,e){return function(){return nne(this,s,e)}}function uye(s,e){return function(){return nne(this,s,e.apply(this,arguments))}}function fye(s,e){return this.each((typeof e=="function"?uye:hye)(s,e))}function*gye(){for(var s=this._groups,e=0,t=s.length;e<t;++e)for(var i=s[e],n=0,o=i.length,r;n<o;++n)(r=i[n])&&(yield r)}var sne=[null];function Rl(s,e){this._groups=s,this._parents=e}function ZE(){return new Rl([[document.documentElement]],sne)}function mye(){return this}Rl.prototype=ZE.prototype={constructor:Rl,select:V1e,selectAll:q1e,selectChild:Y1e,selectChildren:J1e,filter:ewe,data:rwe,enter:twe,exit:lwe,join:cwe,merge:dwe,selection:mye,order:hwe,sort:uwe,call:gwe,nodes:mwe,node:pwe,size:_we,empty:bwe,each:vwe,attr:Iwe,style:Twe,property:Awe,classed:Bwe,text:zwe,html:jwe,raise:Gwe,lower:Xwe,append:Zwe,insert:Jwe,remove:tye,clone:sye,datum:oye,on:dye,dispatch:fye,[Symbol.iterator]:gye};function bl(s){return typeof s=="string"?new Rl([[document.querySelector(s)]],[document.documentElement]):new Rl([[s]],sne)}function pye(s){let e;for(;e=s.sourceEvent;)s=e;return s}function Wc(s,e){if(s=pye(s),e===void 0&&(e=s.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var i=t.createSVGPoint();return i.x=s.clientX,i.y=s.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var n=e.getBoundingClientRect();return[s.clientX-n.left-e.clientLeft,s.clientY-n.top-e.clientTop]}}return[s.pageX,s.pageY]}const _ye={passive:!1},sL={capture:!0,passive:!1};function d5(s){s.stopImmediatePropagation()}function l1(s){s.preventDefault(),s.stopImmediatePropagation()}function one(s){var e=s.document.documentElement,t=bl(s).on("dragstart.drag",l1,sL);"onselectstart"in e?t.on("selectstart.drag",l1,sL):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function rne(s,e){var t=s.document.documentElement,i=bl(s).on("dragstart.drag",null);e&&(i.on("click.drag",l1,sL),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in t?i.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Kk=s=>()=>s;function n9(s,{sourceEvent:e,subject:t,target:i,identifier:n,active:o,x:r,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}n9.prototype.on=function(){var s=this._.on.apply(this._,arguments);return s===this._?this:s};function bye(s){return!s.ctrlKey&&!s.button}function vye(){return this.parentNode}function Cye(s,e){return e??{x:s.x,y:s.y}}function wye(){return navigator.maxTouchPoints||"ontouchstart"in this}function ane(){var s=bye,e=vye,t=Cye,i=wye,n={},o=tO("start","drag","end"),r=0,a,l,c,d,h=0;function u(C){C.on("mousedown.drag",f).filter(i).on("touchstart.drag",p).on("touchmove.drag",v,_ye).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(C,y){if(!(d||!s.call(this,C,y))){var x=w(this,e.call(this,C,y),C,y,"mouse");x&&(bl(C.view).on("mousemove.drag",g,sL).on("mouseup.drag",m,sL),one(C.view),d5(C),c=!1,a=C.clientX,l=C.clientY,x("start",C))}}function g(C){if(l1(C),!c){var y=C.clientX-a,x=C.clientY-l;c=y*y+x*x>h}n.mouse("drag",C)}function m(C){bl(C.view).on("mousemove.drag mouseup.drag",null),rne(C.view,c),l1(C),n.mouse("end",C)}function p(C,y){if(s.call(this,C,y)){var x=C.changedTouches,S=e.call(this,C,y),L=x.length,E,M;for(E=0;E<L;++E)(M=w(this,S,C,y,x[E].identifier,x[E]))&&(d5(C),M("start",C,x[E]))}}function v(C){var y=C.changedTouches,x=y.length,S,L;for(S=0;S<x;++S)(L=n[y[S].identifier])&&(l1(C),L("drag",C,y[S]))}function b(C){var y=C.changedTouches,x=y.length,S,L;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),S=0;S<x;++S)(L=n[y[S].identifier])&&(d5(C),L("end",C,y[S]))}function w(C,y,x,S,L,E){var M=o.copy(),R=Wc(E||x,y),T,A,N;if((N=t.call(C,new n9("beforestart",{sourceEvent:x,target:u,identifier:L,active:r,x:R[0],y:R[1],dx:0,dy:0,dispatch:M}),S))!=null)return T=N.x-R[0]||0,A=N.y-R[1]||0,function P(W,H,G){var V=R,U;switch(W){case"start":n[L]=P,U=r++;break;case"end":delete n[L],--r;case"drag":R=Wc(G||H,y),U=r;break}M.call(W,C,new n9(W,{sourceEvent:H,subject:N,target:u,identifier:L,active:U,x:R[0]+T,y:R[1]+A,dx:R[0]-V[0],dy:R[1]-V[1],dispatch:M}),S)}}return u.filter=function(C){return arguments.length?(s=typeof C=="function"?C:Kk(!!C),u):s},u.container=function(C){return arguments.length?(e=typeof C=="function"?C:Kk(C),u):e},u.subject=function(C){return arguments.length?(t=typeof C=="function"?C:Kk(C),u):t},u.touchable=function(C){return arguments.length?(i=typeof C=="function"?C:Kk(!!C),u):i},u.on=function(){var C=o.on.apply(o,arguments);return C===o?u:C},u.clickDistance=function(C){return arguments.length?(h=(C=+C)*C,u):Math.sqrt(h)},u}function qz(s,e,t){s.prototype=e.prototype=t,t.constructor=s}function lne(s,e){var t=Object.create(s.prototype);for(var i in e)t[i]=e[i];return t}function QE(){}var oL=.7,SN=1/oL,c1="\\s*([+-]?\\d+)\\s*",rL="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yye=/^#([0-9a-f]{3,8})$/,Sye=new RegExp(`^rgb\\(${c1},${c1},${c1}\\)$`),xye=new RegExp(`^rgb\\(${gh},${gh},${gh}\\)$`),Lye=new RegExp(`^rgba\\(${c1},${c1},${c1},${rL}\\)$`),Iye=new RegExp(`^rgba\\(${gh},${gh},${gh},${rL}\\)$`),Eye=new RegExp(`^hsl\\(${rL},${gh},${gh}\\)$`),kye=new RegExp(`^hsla\\(${rL},${gh},${gh},${rL}\\)$`),VK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qz(QE,yb,{copy(s){return Object.assign(new this.constructor,this,s)},displayable(){return this.rgb().displayable()},hex:zK,formatHex:zK,formatHex8:Dye,formatHsl:Tye,formatRgb:UK,toString:UK});function zK(){return this.rgb().formatHex()}function Dye(){return this.rgb().formatHex8()}function Tye(){return cne(this).formatHsl()}function UK(){return this.rgb().formatRgb()}function yb(s){var e,t;return s=(s+"").trim().toLowerCase(),(e=yye.exec(s))?(t=e[1].length,e=parseInt(e[1],16),t===6?$K(e):t===3?new $a(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Gk(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Gk(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Sye.exec(s))?new $a(e[1],e[2],e[3],1):(e=xye.exec(s))?new $a(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Lye.exec(s))?Gk(e[1],e[2],e[3],e[4]):(e=Iye.exec(s))?Gk(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Eye.exec(s))?KK(e[1],e[2]/100,e[3]/100,1):(e=kye.exec(s))?KK(e[1],e[2]/100,e[3]/100,e[4]):VK.hasOwnProperty(s)?$K(VK[s]):s==="transparent"?new $a(NaN,NaN,NaN,0):null}function $K(s){return new $a(s>>16&255,s>>8&255,s&255,1)}function Gk(s,e,t,i){return i<=0&&(s=e=t=NaN),new $a(s,e,t,i)}function Nye(s){return s instanceof QE||(s=yb(s)),s?(s=s.rgb(),new $a(s.r,s.g,s.b,s.opacity)):new $a}function s9(s,e,t,i){return arguments.length===1?Nye(s):new $a(s,e,t,i??1)}function $a(s,e,t,i){this.r=+s,this.g=+e,this.b=+t,this.opacity=+i}qz($a,s9,lne(QE,{brighter(s){return s=s==null?SN:Math.pow(SN,s),new $a(this.r*s,this.g*s,this.b*s,this.opacity)},darker(s){return s=s==null?oL:Math.pow(oL,s),new $a(this.r*s,this.g*s,this.b*s,this.opacity)},rgb(){return this},clamp(){return new $a(o_(this.r),o_(this.g),o_(this.b),xN(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qK,formatHex:qK,formatHex8:Rye,formatRgb:jK,toString:jK}));function qK(){return`#${Hp(this.r)}${Hp(this.g)}${Hp(this.b)}`}function Rye(){return`#${Hp(this.r)}${Hp(this.g)}${Hp(this.b)}${Hp((isNaN(this.opacity)?1:this.opacity)*255)}`}function jK(){const s=xN(this.opacity);return`${s===1?"rgb(":"rgba("}${o_(this.r)}, ${o_(this.g)}, ${o_(this.b)}${s===1?")":`, ${s})`}`}function xN(s){return isNaN(s)?1:Math.max(0,Math.min(1,s))}function o_(s){return Math.max(0,Math.min(255,Math.round(s)||0))}function Hp(s){return s=o_(s),(s<16?"0":"")+s.toString(16)}function KK(s,e,t,i){return i<=0?s=e=t=NaN:t<=0||t>=1?s=e=NaN:e<=0&&(s=NaN),new Xc(s,e,t,i)}function cne(s){if(s instanceof Xc)return new Xc(s.h,s.s,s.l,s.opacity);if(s instanceof QE||(s=yb(s)),!s)return new Xc;if(s instanceof Xc)return s;s=s.rgb();var e=s.r/255,t=s.g/255,i=s.b/255,n=Math.min(e,t,i),o=Math.max(e,t,i),r=NaN,a=o-n,l=(o+n)/2;return a?(e===o?r=(t-i)/a+(t<i)*6:t===o?r=(i-e)/a+2:r=(e-t)/a+4,a/=l<.5?o+n:2-o-n,r*=60):a=l>0&&l<1?0:r,new Xc(r,a,l,s.opacity)}function Mye(s,e,t,i){return arguments.length===1?cne(s):new Xc(s,e,t,i??1)}function Xc(s,e,t,i){this.h=+s,this.s=+e,this.l=+t,this.opacity=+i}qz(Xc,Mye,lne(QE,{brighter(s){return s=s==null?SN:Math.pow(SN,s),new Xc(this.h,this.s,this.l*s,this.opacity)},darker(s){return s=s==null?oL:Math.pow(oL,s),new Xc(this.h,this.s,this.l*s,this.opacity)},rgb(){var s=this.h%360+(this.h<0)*360,e=isNaN(s)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,n=2*t-i;return new $a(h5(s>=240?s-240:s+120,n,i),h5(s,n,i),h5(s<120?s+240:s-120,n,i),this.opacity)},clamp(){return new Xc(GK(this.h),Yk(this.s),Yk(this.l),xN(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const s=xN(this.opacity);return`${s===1?"hsl(":"hsla("}${GK(this.h)}, ${Yk(this.s)*100}%, ${Yk(this.l)*100}%${s===1?")":`, ${s})`}`}}));function GK(s){return s=(s||0)%360,s<0?s+360:s}function Yk(s){return Math.max(0,Math.min(1,s||0))}function h5(s,e,t){return(s<60?e+(t-e)*s/60:s<180?t:s<240?e+(t-e)*(240-s)/60:e)*255}const jz=s=>()=>s;function Aye(s,e){return function(t){return s+t*e}}function Pye(s,e,t){return s=Math.pow(s,t),e=Math.pow(e,t)-s,t=1/t,function(i){return Math.pow(s+i*e,t)}}function Oye(s){return(s=+s)==1?dne:function(e,t){return t-e?Pye(e,t,s):jz(isNaN(e)?t:e)}}function dne(s,e){var t=e-s;return t?Aye(s,t):jz(isNaN(s)?e:s)}const LN=(function s(e){var t=Oye(e);function i(n,o){var r=t((n=s9(n)).r,(o=s9(o)).r),a=t(n.g,o.g),l=t(n.b,o.b),c=dne(n.opacity,o.opacity);return function(d){return n.r=r(d),n.g=a(d),n.b=l(d),n.opacity=c(d),n+""}}return i.gamma=s,i})(1);function Fye(s,e){e||(e=[]);var t=s?Math.min(e.length,s.length):0,i=e.slice(),n;return function(o){for(n=0;n<t;++n)i[n]=s[n]*(1-o)+e[n]*o;return i}}function Bye(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Wye(s,e){var t=e?e.length:0,i=s?Math.min(t,s.length):0,n=new Array(i),o=new Array(t),r;for(r=0;r<i;++r)n[r]=BS(s[r],e[r]);for(;r<t;++r)o[r]=e[r];return function(a){for(r=0;r<i;++r)o[r]=n[r](a);return o}}function Hye(s,e){var t=new Date;return s=+s,e=+e,function(i){return t.setTime(s*(1-i)+e*i),t}}function Gd(s,e){return s=+s,e=+e,function(t){return s*(1-t)+e*t}}function Vye(s,e){var t={},i={},n;(s===null||typeof s!="object")&&(s={}),(e===null||typeof e!="object")&&(e={});for(n in e)n in s?t[n]=BS(s[n],e[n]):i[n]=e[n];return function(o){for(n in t)i[n]=t[n](o);return i}}var o9=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,u5=new RegExp(o9.source,"g");function zye(s){return function(){return s}}function Uye(s){return function(e){return s(e)+""}}function hne(s,e){var t=o9.lastIndex=u5.lastIndex=0,i,n,o,r=-1,a=[],l=[];for(s=s+"",e=e+"";(i=o9.exec(s))&&(n=u5.exec(e));)(o=n.index)>t&&(o=e.slice(t,o),a[r]?a[r]+=o:a[++r]=o),(i=i[0])===(n=n[0])?a[r]?a[r]+=n:a[++r]=n:(a[++r]=null,l.push({i:r,x:Gd(i,n)})),t=u5.lastIndex;return t<e.length&&(o=e.slice(t),a[r]?a[r]+=o:a[++r]=o),a.length<2?l[0]?Uye(l[0].x):zye(e):(e=l.length,function(c){for(var d=0,h;d<e;++d)a[(h=l[d]).i]=h.x(c);return a.join("")})}function BS(s,e){var t=typeof e,i;return e==null||t==="boolean"?jz(e):(t==="number"?Gd:t==="string"?(i=yb(e))?(e=i,LN):hne:e instanceof yb?LN:e instanceof Date?Hye:Bye(e)?Fye:Array.isArray(e)?Wye:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Vye:Gd)(s,e)}var YK=180/Math.PI,r9={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function une(s,e,t,i,n,o){var r,a,l;return(r=Math.sqrt(s*s+e*e))&&(s/=r,e/=r),(l=s*t+e*i)&&(t-=s*l,i-=e*l),(a=Math.sqrt(t*t+i*i))&&(t/=a,i/=a,l/=a),s*i<e*t&&(s=-s,e=-e,l=-l,r=-r),{translateX:n,translateY:o,rotate:Math.atan2(e,s)*YK,skewX:Math.atan(l)*YK,scaleX:r,scaleY:a}}var Xk;function $ye(s){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(s+"");return e.isIdentity?r9:une(e.a,e.b,e.c,e.d,e.e,e.f)}function qye(s){return s==null||(Xk||(Xk=document.createElementNS("http://www.w3.org/2000/svg","g")),Xk.setAttribute("transform",s),!(s=Xk.transform.baseVal.consolidate()))?r9:(s=s.matrix,une(s.a,s.b,s.c,s.d,s.e,s.f))}function fne(s,e,t,i){function n(c){return c.length?c.pop()+" ":""}function o(c,d,h,u,f,g){if(c!==h||d!==u){var m=f.push("translate(",null,e,null,t);g.push({i:m-4,x:Gd(c,h)},{i:m-2,x:Gd(d,u)})}else(h||u)&&f.push("translate("+h+e+u+t)}function r(c,d,h,u){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),u.push({i:h.push(n(h)+"rotate(",null,i)-2,x:Gd(c,d)})):d&&h.push(n(h)+"rotate("+d+i)}function a(c,d,h,u){c!==d?u.push({i:h.push(n(h)+"skewX(",null,i)-2,x:Gd(c,d)}):d&&h.push(n(h)+"skewX("+d+i)}function l(c,d,h,u,f,g){if(c!==h||d!==u){var m=f.push(n(f)+"scale(",null,",",null,")");g.push({i:m-4,x:Gd(c,h)},{i:m-2,x:Gd(d,u)})}else(h!==1||u!==1)&&f.push(n(f)+"scale("+h+","+u+")")}return function(c,d){var h=[],u=[];return c=s(c),d=s(d),o(c.translateX,c.translateY,d.translateX,d.translateY,h,u),r(c.rotate,d.rotate,h,u),a(c.skewX,d.skewX,h,u),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,h,u),c=d=null,function(f){for(var g=-1,m=u.length,p;++g<m;)h[(p=u[g]).i]=p.x(f);return h.join("")}}}var jye=fne($ye,"px, ","px)","deg)"),Kye=fne(qye,", ",")",")"),Gye=1e-12;function XK(s){return((s=Math.exp(s))+1/s)/2}function Yye(s){return((s=Math.exp(s))-1/s)/2}function Xye(s){return((s=Math.exp(2*s))-1)/(s+1)}const TT=(function s(e,t,i){function n(o,r){var a=o[0],l=o[1],c=o[2],d=r[0],h=r[1],u=r[2],f=d-a,g=h-l,m=f*f+g*g,p,v;if(m<Gye)v=Math.log(u/c)/e,p=function(S){return[a+S*f,l+S*g,c*Math.exp(e*S*v)]};else{var b=Math.sqrt(m),w=(u*u-c*c+i*m)/(2*c*t*b),C=(u*u-c*c-i*m)/(2*u*t*b),y=Math.log(Math.sqrt(w*w+1)-w),x=Math.log(Math.sqrt(C*C+1)-C);v=(x-y)/e,p=function(S){var L=S*v,E=XK(y),M=c/(t*b)*(E*Xye(e*L+y)-Yye(y));return[a+M*f,l+M*g,c*E/XK(e*L+y)]}}return p.duration=v*1e3*e/Math.SQRT2,p}return n.rho=function(o){var r=Math.max(.001,+o),a=r*r,l=a*a;return s(r,a,l)},n})(Math.SQRT2,2,4);var cw=0,pS=0,E0=0,gne=1e3,IN,_S,EN=0,Sb=0,nO=0,aL=typeof performance=="object"&&performance.now?performance:Date,mne=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(s){setTimeout(s,17)};function Kz(){return Sb||(mne(Zye),Sb=aL.now()+nO)}function Zye(){Sb=0}function kN(){this._call=this._time=this._next=null}kN.prototype=pne.prototype={constructor:kN,restart:function(s,e,t){if(typeof s!="function")throw new TypeError("callback is not a function");t=(t==null?Kz():+t)+(e==null?0:+e),!this._next&&_S!==this&&(_S?_S._next=this:IN=this,_S=this),this._call=s,this._time=t,a9()},stop:function(){this._call&&(this._call=null,this._time=1/0,a9())}};function pne(s,e,t){var i=new kN;return i.restart(s,e,t),i}function Qye(){Kz(),++cw;for(var s=IN,e;s;)(e=Sb-s._time)>=0&&s._call.call(void 0,e),s=s._next;--cw}function ZK(){Sb=(EN=aL.now())+nO,cw=pS=0;try{Qye()}finally{cw=0,e0e(),Sb=0}}function Jye(){var s=aL.now(),e=s-EN;e>gne&&(nO-=e,EN=s)}function e0e(){for(var s,e=IN,t,i=1/0;e;)e._call?(i>e._time&&(i=e._time),s=e,e=e._next):(t=e._next,e._next=null,e=s?s._next=t:IN=t);_S=s,a9(i)}function a9(s){if(!cw){pS&&(pS=clearTimeout(pS));var e=s-Sb;e>24?(s<1/0&&(pS=setTimeout(ZK,s-aL.now()-nO)),E0&&(E0=clearInterval(E0))):(E0||(EN=aL.now(),E0=setInterval(Jye,gne)),cw=1,mne(ZK))}}function QK(s,e,t){var i=new kN;return e=e==null?0:+e,i.restart(n=>{i.stop(),s(n+e)},e,t),i}var t0e=tO("start","end","cancel","interrupt"),i0e=[],_ne=0,JK=1,l9=2,NT=3,eG=4,c9=5,RT=6;function sO(s,e,t,i,n,o){var r=s.__transition;if(!r)s.__transition={};else if(t in r)return;n0e(s,t,{name:e,index:i,group:n,on:t0e,tween:i0e,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:_ne})}function Gz(s,e){var t=_d(s,e);if(t.state>_ne)throw new Error("too late; already scheduled");return t}function Mh(s,e){var t=_d(s,e);if(t.state>NT)throw new Error("too late; already running");return t}function _d(s,e){var t=s.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function n0e(s,e,t){var i=s.__transition,n;i[e]=t,t.timer=pne(o,0,t.time);function o(c){t.state=JK,t.timer.restart(r,t.delay,t.time),t.delay<=c&&r(c-t.delay)}function r(c){var d,h,u,f;if(t.state!==JK)return l();for(d in i)if(f=i[d],f.name===t.name){if(f.state===NT)return QK(r);f.state===eG?(f.state=RT,f.timer.stop(),f.on.call("interrupt",s,s.__data__,f.index,f.group),delete i[d]):+d<e&&(f.state=RT,f.timer.stop(),f.on.call("cancel",s,s.__data__,f.index,f.group),delete i[d])}if(QK(function(){t.state===NT&&(t.state=eG,t.timer.restart(a,t.delay,t.time),a(c))}),t.state=l9,t.on.call("start",s,s.__data__,t.index,t.group),t.state===l9){for(t.state=NT,n=new Array(u=t.tween.length),d=0,h=-1;d<u;++d)(f=t.tween[d].value.call(s,s.__data__,t.index,t.group))&&(n[++h]=f);n.length=h+1}}function a(c){for(var d=c<t.duration?t.ease.call(null,c/t.duration):(t.timer.restart(l),t.state=c9,1),h=-1,u=n.length;++h<u;)n[h].call(s,d);t.state===c9&&(t.on.call("end",s,s.__data__,t.index,t.group),l())}function l(){t.state=RT,t.timer.stop(),delete i[e];for(var c in i)return;delete s.__transition}}function MT(s,e){var t=s.__transition,i,n,o=!0,r;if(t){e=e==null?null:e+"";for(r in t){if((i=t[r]).name!==e){o=!1;continue}n=i.state>l9&&i.state<c9,i.state=RT,i.timer.stop(),i.on.call(n?"interrupt":"cancel",s,s.__data__,i.index,i.group),delete t[r]}o&&delete s.__transition}}function s0e(s){return this.each(function(){MT(this,s)})}function o0e(s,e){var t,i;return function(){var n=Mh(this,s),o=n.tween;if(o!==t){i=t=o;for(var r=0,a=i.length;r<a;++r)if(i[r].name===e){i=i.slice(),i.splice(r,1);break}}n.tween=i}}function r0e(s,e,t){var i,n;if(typeof t!="function")throw new Error;return function(){var o=Mh(this,s),r=o.tween;if(r!==i){n=(i=r).slice();for(var a={name:e,value:t},l=0,c=n.length;l<c;++l)if(n[l].name===e){n[l]=a;break}l===c&&n.push(a)}o.tween=n}}function a0e(s,e){var t=this._id;if(s+="",arguments.length<2){for(var i=_d(this.node(),t).tween,n=0,o=i.length,r;n<o;++n)if((r=i[n]).name===s)return r.value;return null}return this.each((e==null?o0e:r0e)(t,s,e))}function Yz(s,e,t){var i=s._id;return s.each(function(){var n=Mh(this,i);(n.value||(n.value={}))[e]=t.apply(this,arguments)}),function(n){return _d(n,i).value[e]}}function bne(s,e){var t;return(typeof e=="number"?Gd:e instanceof yb?LN:(t=yb(e))?(e=t,LN):hne)(s,e)}function l0e(s){return function(){this.removeAttribute(s)}}function c0e(s){return function(){this.removeAttributeNS(s.space,s.local)}}function d0e(s,e,t){var i,n=t+"",o;return function(){var r=this.getAttribute(s);return r===n?null:r===i?o:o=e(i=r,t)}}function h0e(s,e,t){var i,n=t+"",o;return function(){var r=this.getAttributeNS(s.space,s.local);return r===n?null:r===i?o:o=e(i=r,t)}}function u0e(s,e,t){var i,n,o;return function(){var r,a=t(this),l;return a==null?void this.removeAttribute(s):(r=this.getAttribute(s),l=a+"",r===l?null:r===i&&l===n?o:(n=l,o=e(i=r,a)))}}function f0e(s,e,t){var i,n,o;return function(){var r,a=t(this),l;return a==null?void this.removeAttributeNS(s.space,s.local):(r=this.getAttributeNS(s.space,s.local),l=a+"",r===l?null:r===i&&l===n?o:(n=l,o=e(i=r,a)))}}function g0e(s,e){var t=iO(s),i=t==="transform"?Kye:bne;return this.attrTween(s,typeof e=="function"?(t.local?f0e:u0e)(t,i,Yz(this,"attr."+s,e)):e==null?(t.local?c0e:l0e)(t):(t.local?h0e:d0e)(t,i,e))}function m0e(s,e){return function(t){this.setAttribute(s,e.call(this,t))}}function p0e(s,e){return function(t){this.setAttributeNS(s.space,s.local,e.call(this,t))}}function _0e(s,e){var t,i;function n(){var o=e.apply(this,arguments);return o!==i&&(t=(i=o)&&p0e(s,o)),t}return n._value=e,n}function b0e(s,e){var t,i;function n(){var o=e.apply(this,arguments);return o!==i&&(t=(i=o)&&m0e(s,o)),t}return n._value=e,n}function v0e(s,e){var t="attr."+s;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var i=iO(s);return this.tween(t,(i.local?_0e:b0e)(i,e))}function C0e(s,e){return function(){Gz(this,s).delay=+e.apply(this,arguments)}}function w0e(s,e){return e=+e,function(){Gz(this,s).delay=e}}function y0e(s){var e=this._id;return arguments.length?this.each((typeof s=="function"?C0e:w0e)(e,s)):_d(this.node(),e).delay}function S0e(s,e){return function(){Mh(this,s).duration=+e.apply(this,arguments)}}function x0e(s,e){return e=+e,function(){Mh(this,s).duration=e}}function L0e(s){var e=this._id;return arguments.length?this.each((typeof s=="function"?S0e:x0e)(e,s)):_d(this.node(),e).duration}function I0e(s,e){if(typeof e!="function")throw new Error;return function(){Mh(this,s).ease=e}}function E0e(s){var e=this._id;return arguments.length?this.each(I0e(e,s)):_d(this.node(),e).ease}function k0e(s,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;Mh(this,s).ease=t}}function D0e(s){if(typeof s!="function")throw new Error;return this.each(k0e(this._id,s))}function T0e(s){typeof s!="function"&&(s=Yie(s));for(var e=this._groups,t=e.length,i=new Array(t),n=0;n<t;++n)for(var o=e[n],r=o.length,a=i[n]=[],l,c=0;c<r;++c)(l=o[c])&&s.call(l,l.__data__,c,o)&&a.push(l);return new rf(i,this._parents,this._name,this._id)}function N0e(s){if(s._id!==this._id)throw new Error;for(var e=this._groups,t=s._groups,i=e.length,n=t.length,o=Math.min(i,n),r=new Array(i),a=0;a<o;++a)for(var l=e[a],c=t[a],d=l.length,h=r[a]=new Array(d),u,f=0;f<d;++f)(u=l[f]||c[f])&&(h[f]=u);for(;a<i;++a)r[a]=e[a];return new rf(r,this._parents,this._name,this._id)}function R0e(s){return(s+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function M0e(s,e,t){var i,n,o=R0e(e)?Gz:Mh;return function(){var r=o(this,s),a=r.on;a!==i&&(n=(i=a).copy()).on(e,t),r.on=n}}function A0e(s,e){var t=this._id;return arguments.length<2?_d(this.node(),t).on.on(s):this.each(M0e(t,s,e))}function P0e(s){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==s)return;e&&e.removeChild(this)}}function O0e(){return this.on("end.remove",P0e(this._id))}function F0e(s){var e=this._name,t=this._id;typeof s!="function"&&(s=Uz(s));for(var i=this._groups,n=i.length,o=new Array(n),r=0;r<n;++r)for(var a=i[r],l=a.length,c=o[r]=new Array(l),d,h,u=0;u<l;++u)(d=a[u])&&(h=s.call(d,d.__data__,u,a))&&("__data__"in d&&(h.__data__=d.__data__),c[u]=h,sO(c[u],e,t,u,c,_d(d,t)));return new rf(o,this._parents,e,t)}function B0e(s){var e=this._name,t=this._id;typeof s!="function"&&(s=Gie(s));for(var i=this._groups,n=i.length,o=[],r=[],a=0;a<n;++a)for(var l=i[a],c=l.length,d,h=0;h<c;++h)if(d=l[h]){for(var u=s.call(d,d.__data__,h,l),f,g=_d(d,t),m=0,p=u.length;m<p;++m)(f=u[m])&&sO(f,e,t,m,u,g);o.push(u),r.push(d)}return new rf(o,r,e,t)}var W0e=ZE.prototype.constructor;function H0e(){return new W0e(this._groups,this._parents)}function V0e(s,e){var t,i,n;return function(){var o=lw(this,s),r=(this.style.removeProperty(s),lw(this,s));return o===r?null:o===t&&r===i?n:n=e(t=o,i=r)}}function vne(s){return function(){this.style.removeProperty(s)}}function z0e(s,e,t){var i,n=t+"",o;return function(){var r=lw(this,s);return r===n?null:r===i?o:o=e(i=r,t)}}function U0e(s,e,t){var i,n,o;return function(){var r=lw(this,s),a=t(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(s),lw(this,s))),r===l?null:r===i&&l===n?o:(n=l,o=e(i=r,a))}}function $0e(s,e){var t,i,n,o="style."+e,r="end."+o,a;return function(){var l=Mh(this,s),c=l.on,d=l.value[o]==null?a||(a=vne(e)):void 0;(c!==t||n!==d)&&(i=(t=c).copy()).on(r,n=d),l.on=i}}function q0e(s,e,t){var i=(s+="")=="transform"?jye:bne;return e==null?this.styleTween(s,V0e(s,i)).on("end.style."+s,vne(s)):typeof e=="function"?this.styleTween(s,U0e(s,i,Yz(this,"style."+s,e))).each($0e(this._id,s)):this.styleTween(s,z0e(s,i,e),t).on("end.style."+s,null)}function j0e(s,e,t){return function(i){this.style.setProperty(s,e.call(this,i),t)}}function K0e(s,e,t){var i,n;function o(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&j0e(s,r,t)),i}return o._value=e,o}function G0e(s,e,t){var i="style."+(s+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,K0e(s,e,t??""))}function Y0e(s){return function(){this.textContent=s}}function X0e(s){return function(){var e=s(this);this.textContent=e??""}}function Z0e(s){return this.tween("text",typeof s=="function"?X0e(Yz(this,"text",s)):Y0e(s==null?"":s+""))}function Q0e(s){return function(e){this.textContent=s.call(this,e)}}function J0e(s){var e,t;function i(){var n=s.apply(this,arguments);return n!==t&&(e=(t=n)&&Q0e(n)),e}return i._value=s,i}function eSe(s){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(s==null)return this.tween(e,null);if(typeof s!="function")throw new Error;return this.tween(e,J0e(s))}function tSe(){for(var s=this._name,e=this._id,t=Cne(),i=this._groups,n=i.length,o=0;o<n;++o)for(var r=i[o],a=r.length,l,c=0;c<a;++c)if(l=r[c]){var d=_d(l,e);sO(l,s,t,c,r,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new rf(i,this._parents,s,t)}function iSe(){var s,e,t=this,i=t._id,n=t.size();return new Promise(function(o,r){var a={value:r},l={value:function(){--n===0&&o()}};t.each(function(){var c=Mh(this,i),d=c.on;d!==s&&(e=(s=d).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),n===0&&o()})}var nSe=0;function rf(s,e,t,i){this._groups=s,this._parents=e,this._name=t,this._id=i}function Cne(){return++nSe}var Uh=ZE.prototype;rf.prototype={constructor:rf,select:F0e,selectAll:B0e,selectChild:Uh.selectChild,selectChildren:Uh.selectChildren,filter:T0e,merge:N0e,selection:H0e,transition:tSe,call:Uh.call,nodes:Uh.nodes,node:Uh.node,size:Uh.size,empty:Uh.empty,each:Uh.each,on:A0e,attr:g0e,attrTween:v0e,style:q0e,styleTween:G0e,text:Z0e,textTween:eSe,remove:O0e,tween:a0e,delay:y0e,duration:L0e,ease:E0e,easeVarying:D0e,end:iSe,[Symbol.iterator]:Uh[Symbol.iterator]};function sSe(s){return((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2}var oSe={time:null,delay:0,duration:250,ease:sSe};function rSe(s,e){for(var t;!(t=s.__transition)||!(t=t[e]);)if(!(s=s.parentNode))throw new Error(`transition ${e} not found`);return t}function aSe(s){var e,t;s instanceof rf?(e=s._id,s=s._name):(e=Cne(),(t=oSe).time=Kz(),s=s==null?null:s+"");for(var i=this._groups,n=i.length,o=0;o<n;++o)for(var r=i[o],a=r.length,l,c=0;c<a;++c)(l=r[c])&&sO(l,s,e,c,r,t||rSe(l,e));return new rf(i,this._parents,s,e)}ZE.prototype.interrupt=s0e;ZE.prototype.transition=aSe;const Zk=s=>()=>s;function lSe(s,{sourceEvent:e,target:t,transform:i,dispatch:n}){Object.defineProperties(this,{type:{value:s,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:n}})}function Du(s,e,t){this.k=s,this.x=e,this.y=t}Du.prototype={constructor:Du,scale:function(s){return s===1?this:new Du(this.k*s,this.x,this.y)},translate:function(s,e){return s===0&e===0?this:new Du(this.k,this.x+this.k*s,this.y+this.k*e)},apply:function(s){return[s[0]*this.k+this.x,s[1]*this.k+this.y]},applyX:function(s){return s*this.k+this.x},applyY:function(s){return s*this.k+this.y},invert:function(s){return[(s[0]-this.x)/this.k,(s[1]-this.y)/this.k]},invertX:function(s){return(s-this.x)/this.k},invertY:function(s){return(s-this.y)/this.k},rescaleX:function(s){return s.copy().domain(s.range().map(this.invertX,this).map(s.invert,s))},rescaleY:function(s){return s.copy().domain(s.range().map(this.invertY,this).map(s.invert,s))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var oO=new Du(1,0,0);wne.prototype=Du.prototype;function wne(s){for(;!s.__zoom;)if(!(s=s.parentNode))return oO;return s.__zoom}function f5(s){s.stopImmediatePropagation()}function k0(s){s.preventDefault(),s.stopImmediatePropagation()}function cSe(s){return(!s.ctrlKey||s.type==="wheel")&&!s.button}function dSe(){var s=this;return s instanceof SVGElement?(s=s.ownerSVGElement||s,s.hasAttribute("viewBox")?(s=s.viewBox.baseVal,[[s.x,s.y],[s.x+s.width,s.y+s.height]]):[[0,0],[s.width.baseVal.value,s.height.baseVal.value]]):[[0,0],[s.clientWidth,s.clientHeight]]}function tG(){return this.__zoom||oO}function hSe(s){return-s.deltaY*(s.deltaMode===1?.05:s.deltaMode?1:.002)*(s.ctrlKey?10:1)}function uSe(){return navigator.maxTouchPoints||"ontouchstart"in this}function fSe(s,e,t){var i=s.invertX(e[0][0])-t[0][0],n=s.invertX(e[1][0])-t[1][0],o=s.invertY(e[0][1])-t[0][1],r=s.invertY(e[1][1])-t[1][1];return s.translate(n>i?(i+n)/2:Math.min(0,i)||Math.max(0,n),r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r))}function yne(){var s=cSe,e=dSe,t=fSe,i=hSe,n=uSe,o=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],a=250,l=TT,c=tO("start","zoom","end"),d,h,u,f=500,g=150,m=0,p=10;function v(N){N.property("__zoom",tG).on("wheel.zoom",L,{passive:!1}).on("mousedown.zoom",E).on("dblclick.zoom",M).filter(n).on("touchstart.zoom",R).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(N,P,W,H){var G=N.selection?N.selection():N;G.property("__zoom",tG),N!==G?y(N,P,W,H):G.interrupt().each(function(){x(this,arguments).event(H).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},v.scaleBy=function(N,P,W,H){v.scaleTo(N,function(){var G=this.__zoom.k,V=typeof P=="function"?P.apply(this,arguments):P;return G*V},W,H)},v.scaleTo=function(N,P,W,H){v.transform(N,function(){var G=e.apply(this,arguments),V=this.__zoom,U=W==null?C(G):typeof W=="function"?W.apply(this,arguments):W,$=V.invert(U),Y=typeof P=="function"?P.apply(this,arguments):P;return t(w(b(V,Y),U,$),G,r)},W,H)},v.translateBy=function(N,P,W,H){v.transform(N,function(){return t(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof W=="function"?W.apply(this,arguments):W),e.apply(this,arguments),r)},null,H)},v.translateTo=function(N,P,W,H,G){v.transform(N,function(){var V=e.apply(this,arguments),U=this.__zoom,$=H==null?C(V):typeof H=="function"?H.apply(this,arguments):H;return t(oO.translate($[0],$[1]).scale(U.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof W=="function"?-W.apply(this,arguments):-W),V,r)},H,G)};function b(N,P){return P=Math.max(o[0],Math.min(o[1],P)),P===N.k?N:new Du(P,N.x,N.y)}function w(N,P,W){var H=P[0]-W[0]*N.k,G=P[1]-W[1]*N.k;return H===N.x&&G===N.y?N:new Du(N.k,H,G)}function C(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function y(N,P,W,H){N.on("start.zoom",function(){x(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(H).end()}).tween("zoom",function(){var G=this,V=arguments,U=x(G,V).event(H),$=e.apply(G,V),Y=W==null?C($):typeof W=="function"?W.apply(G,V):W,se=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),j=G.__zoom,ie=typeof P=="function"?P.apply(G,V):P,te=l(j.invert(Y).concat(se/j.k),ie.invert(Y).concat(se/ie.k));return function(pe){if(pe===1)pe=ie;else{var J=te(pe),le=se/J[2];pe=new Du(le,Y[0]-J[0]*le,Y[1]-J[1]*le)}U.zoom(null,pe)}})}function x(N,P,W){return!W&&N.__zooming||new S(N,P)}function S(N,P){this.that=N,this.args=P,this.active=0,this.sourceEvent=null,this.extent=e.apply(N,P),this.taps=0}S.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,P){return this.mouse&&N!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var P=bl(this.that).datum();c.call(N,this.that,new lSe(N,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:c}),P)}};function L(N,...P){if(!s.apply(this,arguments))return;var W=x(this,P).event(N),H=this.__zoom,G=Math.max(o[0],Math.min(o[1],H.k*Math.pow(2,i.apply(this,arguments)))),V=Wc(N);if(W.wheel)(W.mouse[0][0]!==V[0]||W.mouse[0][1]!==V[1])&&(W.mouse[1]=H.invert(W.mouse[0]=V)),clearTimeout(W.wheel);else{if(H.k===G)return;W.mouse=[V,H.invert(V)],MT(this),W.start()}k0(N),W.wheel=setTimeout(U,g),W.zoom("mouse",t(w(b(H,G),W.mouse[0],W.mouse[1]),W.extent,r));function U(){W.wheel=null,W.end()}}function E(N,...P){if(u||!s.apply(this,arguments))return;var W=N.currentTarget,H=x(this,P,!0).event(N),G=bl(N.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",se,!0),V=Wc(N,W),U=N.clientX,$=N.clientY;one(N.view),f5(N),H.mouse=[V,this.__zoom.invert(V)],MT(this),H.start();function Y(j){if(k0(j),!H.moved){var ie=j.clientX-U,te=j.clientY-$;H.moved=ie*ie+te*te>m}H.event(j).zoom("mouse",t(w(H.that.__zoom,H.mouse[0]=Wc(j,W),H.mouse[1]),H.extent,r))}function se(j){G.on("mousemove.zoom mouseup.zoom",null),rne(j.view,H.moved),k0(j),H.event(j).end()}}function M(N,...P){if(s.apply(this,arguments)){var W=this.__zoom,H=Wc(N.changedTouches?N.changedTouches[0]:N,this),G=W.invert(H),V=W.k*(N.shiftKey?.5:2),U=t(w(b(W,V),H,G),e.apply(this,P),r);k0(N),a>0?bl(this).transition().duration(a).call(y,U,H,N):bl(this).call(v.transform,U,H,N)}}function R(N,...P){if(s.apply(this,arguments)){var W=N.touches,H=W.length,G=x(this,P,N.changedTouches.length===H).event(N),V,U,$,Y;for(f5(N),U=0;U<H;++U)$=W[U],Y=Wc($,this),Y=[Y,this.__zoom.invert(Y),$.identifier],G.touch0?!G.touch1&&G.touch0[2]!==Y[2]&&(G.touch1=Y,G.taps=0):(G.touch0=Y,V=!0,G.taps=1+!!d);d&&(d=clearTimeout(d)),V&&(G.taps<2&&(h=Y[0],d=setTimeout(function(){d=null},f)),MT(this),G.start())}}function T(N,...P){if(this.__zooming){var W=x(this,P).event(N),H=N.changedTouches,G=H.length,V,U,$,Y;for(k0(N),V=0;V<G;++V)U=H[V],$=Wc(U,this),W.touch0&&W.touch0[2]===U.identifier?W.touch0[0]=$:W.touch1&&W.touch1[2]===U.identifier&&(W.touch1[0]=$);if(U=W.that.__zoom,W.touch1){var se=W.touch0[0],j=W.touch0[1],ie=W.touch1[0],te=W.touch1[1],pe=(pe=ie[0]-se[0])*pe+(pe=ie[1]-se[1])*pe,J=(J=te[0]-j[0])*J+(J=te[1]-j[1])*J;U=b(U,Math.sqrt(pe/J)),$=[(se[0]+ie[0])/2,(se[1]+ie[1])/2],Y=[(j[0]+te[0])/2,(j[1]+te[1])/2]}else if(W.touch0)$=W.touch0[0],Y=W.touch0[1];else return;W.zoom("touch",t(w(U,$,Y),W.extent,r))}}function A(N,...P){if(this.__zooming){var W=x(this,P).event(N),H=N.changedTouches,G=H.length,V,U;for(f5(N),u&&clearTimeout(u),u=setTimeout(function(){u=null},f),V=0;V<G;++V)U=H[V],W.touch0&&W.touch0[2]===U.identifier?delete W.touch0:W.touch1&&W.touch1[2]===U.identifier&&delete W.touch1;if(W.touch1&&!W.touch0&&(W.touch0=W.touch1,delete W.touch1),W.touch0)W.touch0[1]=this.__zoom.invert(W.touch0[0]);else if(W.end(),W.taps===2&&(U=Wc(U,this),Math.hypot(h[0]-U[0],h[1]-U[1])<p)){var $=bl(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return v.wheelDelta=function(N){return arguments.length?(i=typeof N=="function"?N:Zk(+N),v):i},v.filter=function(N){return arguments.length?(s=typeof N=="function"?N:Zk(!!N),v):s},v.touchable=function(N){return arguments.length?(n=typeof N=="function"?N:Zk(!!N),v):n},v.extent=function(N){return arguments.length?(e=typeof N=="function"?N:Zk([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),v):e},v.scaleExtent=function(N){return arguments.length?(o[0]=+N[0],o[1]=+N[1],v):[o[0],o[1]]},v.translateExtent=function(N){return arguments.length?(r[0][0]=+N[0][0],r[1][0]=+N[1][0],r[0][1]=+N[0][1],r[1][1]=+N[1][1],v):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},v.constrain=function(N){return arguments.length?(t=N,v):t},v.duration=function(N){return arguments.length?(a=+N,v):a},v.interpolate=function(N){return arguments.length?(l=N,v):l},v.on=function(){var N=c.on.apply(c,arguments);return N===c?v:N},v.clickDistance=function(N){return arguments.length?(m=(N=+N)*N,v):Math.sqrt(m)},v.tapDistance=function(N){return arguments.length?(p=+N,v):p},v}const lL={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:s=>`Node type "${s}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:s=>`The old edge with id=${s} does not exist.`,error009:s=>`Marker type "${s}" doesn't exist.`,error008:(s,{id:e,sourceHandle:t,targetHandle:i})=>`Couldn't create edge for ${s} handle id: "${s==="source"?t:i}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:s=>`Edge type "${s}" not found. Using fallback type "default".`,error012:s=>`Node with id "${s}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(s="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${s}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},d9=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Sne=["Enter"," ","Escape"],gSe={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:s,x:e,y:t})=>`Moved selected node ${s}. New position, x: ${e}, y: ${t}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var dw;(function(s){s.Strict="strict",s.Loose="loose"})(dw||(dw={}));var d1;(function(s){s.Free="free",s.Vertical="vertical",s.Horizontal="horizontal"})(d1||(d1={}));var DN;(function(s){s.Partial="partial",s.Full="full"})(DN||(DN={}));const h9={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var rg;(function(s){s.Bezier="default",s.Straight="straight",s.Step="step",s.SmoothStep="smoothstep",s.SimpleBezier="simplebezier"})(rg||(rg={}));var TN;(function(s){s.Arrow="arrow",s.ArrowClosed="arrowclosed"})(TN||(TN={}));var Ci;(function(s){s.Left="left",s.Top="top",s.Right="right",s.Bottom="bottom"})(Ci||(Ci={}));const iG={[Ci.Left]:Ci.Right,[Ci.Right]:Ci.Left,[Ci.Top]:Ci.Bottom,[Ci.Bottom]:Ci.Top};function mSe(s,e){if(!s&&!e)return!0;if(!s||!e||s.size!==e.size)return!1;if(!s.size&&!e.size)return!0;for(const t of s.keys())if(!e.has(t))return!1;return!0}function nG(s,e,t){if(!t)return;const i=[];s.forEach((n,o)=>{e!=null&&e.has(o)||i.push(n)}),i.length&&t(i)}function pSe(s){return s===null?null:s?"valid":"invalid"}const xne=s=>"id"in s&&"source"in s&&"target"in s,_Se=s=>"id"in s&&"position"in s&&!("source"in s)&&!("target"in s),Xz=s=>"id"in s&&"internals"in s&&!("source"in s)&&!("target"in s),JE=(s,e=[0,0])=>{const{width:t,height:i}=hv(s),n=s.origin??e,o=t*n[0],r=i*n[1];return{x:s.position.x-o,y:s.position.y-r}},bSe=(s,e={nodeOrigin:[0,0]})=>{if(s.length===0)return{x:0,y:0,width:0,height:0};const t=s.reduce((i,n)=>{const o=typeof n=="string";let r=!e.nodeLookup&&!o?n:void 0;e.nodeLookup&&(r=o?e.nodeLookup.get(n):Xz(n)?n:e.nodeLookup.get(n.id));const a=r?NN(r,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return aO(i,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return lO(t)},rO=(s,e={})=>{let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0},i=!1;return s.forEach(n=>{(e.filter===void 0||e.filter(n))&&(t=aO(t,NN(n)),i=!0)}),i?lO(t):{x:0,y:0,width:0,height:0}},Zz=(s,e,[t,i,n]=[0,0,1],o=!1,r=!1)=>{const a={...tk(e,[t,i,n]),width:e.width/n,height:e.height/n},l=[];for(const c of s.values()){const{measured:d,selectable:h=!0,hidden:u=!1}=c;if(r&&!h||u)continue;const f=d.width??c.width??c.initialWidth??null,g=d.height??c.height??c.initialHeight??null,m=cL(a,uw(c)),p=(f??0)*(g??0),v=o&&m>0;(!c.internals.handleBounds||v||m>=p||c.dragging)&&l.push(c)}return l},vSe=(s,e)=>{const t=new Set;return s.forEach(i=>{t.add(i.id)}),e.filter(i=>t.has(i.source)||t.has(i.target))};function CSe(s,e){const t=new Map,i=e!=null&&e.nodes?new Set(e.nodes.map(n=>n.id)):null;return s.forEach(n=>{n.measured.width&&n.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!n.hidden)&&(!i||i.has(n.id))&&t.set(n.id,n)}),t}async function wSe({nodes:s,width:e,height:t,panZoom:i,minZoom:n,maxZoom:o},r){if(s.size===0)return Promise.resolve(!0);const a=CSe(s,r),l=rO(a),c=Qz(l,e,t,(r==null?void 0:r.minZoom)??n,(r==null?void 0:r.maxZoom)??o,(r==null?void 0:r.padding)??.1);return await i.setViewport(c,{duration:r==null?void 0:r.duration,ease:r==null?void 0:r.ease,interpolate:r==null?void 0:r.interpolate}),Promise.resolve(!0)}function Lne({nodeId:s,nextPosition:e,nodeLookup:t,nodeOrigin:i=[0,0],nodeExtent:n,onError:o}){const r=t.get(s),a=r.parentId?t.get(r.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},d=r.origin??i;let h=r.extent||n;if(r.extent==="parent"&&!r.expandParent)if(!a)o==null||o("005",lL.error005());else{const f=a.measured.width,g=a.measured.height;f&&g&&(h=[[l,c],[l+f,c+g]])}else a&&fw(r.extent)&&(h=[[r.extent[0][0]+l,r.extent[0][1]+c],[r.extent[1][0]+l,r.extent[1][1]+c]]);const u=fw(h)?xb(e,h,r.measured):e;return(r.measured.width===void 0||r.measured.height===void 0)&&(o==null||o("015",lL.error015())),{position:{x:u.x-l+(r.measured.width??0)*d[0],y:u.y-c+(r.measured.height??0)*d[1]},positionAbsolute:u}}async function ySe({nodesToRemove:s=[],edgesToRemove:e=[],nodes:t,edges:i,onBeforeDelete:n}){const o=new Set(s.map(u=>u.id)),r=[];for(const u of t){if(u.deletable===!1)continue;const f=o.has(u.id),g=!f&&u.parentId&&r.find(m=>m.id===u.parentId);(f||g)&&r.push(u)}const a=new Set(e.map(u=>u.id)),l=i.filter(u=>u.deletable!==!1),d=vSe(r,l);for(const u of l)a.has(u.id)&&!d.find(g=>g.id===u.id)&&d.push(u);if(!n)return{edges:d,nodes:r};const h=await n({nodes:r,edges:d});return typeof h=="boolean"?h?{edges:d,nodes:r}:{edges:[],nodes:[]}:h}const hw=(s,e=0,t=1)=>Math.min(Math.max(s,e),t),xb=(s={x:0,y:0},e,t)=>({x:hw(s.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:hw(s.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function Ine(s,e,t){const{width:i,height:n}=hv(t),{x:o,y:r}=t.internals.positionAbsolute;return xb(s,[[o,r],[o+i,r+n]],e)}const sG=(s,e,t)=>s<e?hw(Math.abs(s-e),1,e)/e:s>t?-hw(Math.abs(s-t),1,e)/e:0,Ene=(s,e,t=15,i=40)=>{const n=sG(s.x,i,e.width-i)*t,o=sG(s.y,i,e.height-i)*t;return[n,o]},aO=(s,e)=>({x:Math.min(s.x,e.x),y:Math.min(s.y,e.y),x2:Math.max(s.x2,e.x2),y2:Math.max(s.y2,e.y2)}),u9=({x:s,y:e,width:t,height:i})=>({x:s,y:e,x2:s+t,y2:e+i}),lO=({x:s,y:e,x2:t,y2:i})=>({x:s,y:e,width:t-s,height:i-e}),uw=(s,e=[0,0])=>{var n,o;const{x:t,y:i}=Xz(s)?s.internals.positionAbsolute:JE(s,e);return{x:t,y:i,width:((n=s.measured)==null?void 0:n.width)??s.width??s.initialWidth??0,height:((o=s.measured)==null?void 0:o.height)??s.height??s.initialHeight??0}},NN=(s,e=[0,0])=>{var n,o;const{x:t,y:i}=Xz(s)?s.internals.positionAbsolute:JE(s,e);return{x:t,y:i,x2:t+(((n=s.measured)==null?void 0:n.width)??s.width??s.initialWidth??0),y2:i+(((o=s.measured)==null?void 0:o.height)??s.height??s.initialHeight??0)}},SSe=(s,e)=>lO(aO(u9(s),u9(e))),cL=(s,e)=>{const t=Math.max(0,Math.min(s.x+s.width,e.x+e.width)-Math.max(s.x,e.x)),i=Math.max(0,Math.min(s.y+s.height,e.y+e.height)-Math.max(s.y,e.y));return Math.ceil(t*i)},oG=s=>Tu(s.width)&&Tu(s.height)&&Tu(s.x)&&Tu(s.y),Tu=s=>!isNaN(s)&&isFinite(s),xSe=(s,e)=>{},ek=(s,e=[1,1])=>({x:e[0]*Math.round(s.x/e[0]),y:e[1]*Math.round(s.y/e[1])}),tk=({x:s,y:e},[t,i,n],o=!1,r=[1,1])=>{const a={x:(s-t)/n,y:(e-i)/n};return o?ek(a,r):a},RN=({x:s,y:e},[t,i,n])=>({x:s*n+t,y:e*n+i});function Wv(s,e){if(typeof s=="number")return Math.floor((e-e/(1+s))*.5);if(typeof s=="string"&&s.endsWith("px")){const t=parseFloat(s);if(!Number.isNaN(t))return Math.floor(t)}if(typeof s=="string"&&s.endsWith("%")){const t=parseFloat(s);if(!Number.isNaN(t))return Math.floor(e*t*.01)}return console.error(`[React Flow] The padding value "${s}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function LSe(s,e,t){if(typeof s=="string"||typeof s=="number"){const i=Wv(s,t),n=Wv(s,e);return{top:i,right:n,bottom:i,left:n,x:n*2,y:i*2}}if(typeof s=="object"){const i=Wv(s.top??s.y??0,t),n=Wv(s.bottom??s.y??0,t),o=Wv(s.left??s.x??0,e),r=Wv(s.right??s.x??0,e);return{top:i,right:r,bottom:n,left:o,x:o+r,y:i+n}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function ISe(s,e,t,i,n,o){const{x:r,y:a}=RN(s,[e,t,i]),{x:l,y:c}=RN({x:s.x+s.width,y:s.y+s.height},[e,t,i]),d=n-l,h=o-c;return{left:Math.floor(r),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(h)}}const Qz=(s,e,t,i,n,o)=>{const r=LSe(o,e,t),a=(e-r.x)/s.width,l=(t-r.y)/s.height,c=Math.min(a,l),d=hw(c,i,n),h=s.x+s.width/2,u=s.y+s.height/2,f=e/2-h*d,g=t/2-u*d,m=ISe(s,f,g,d,e,t),p={left:Math.min(m.left-r.left,0),top:Math.min(m.top-r.top,0),right:Math.min(m.right-r.right,0),bottom:Math.min(m.bottom-r.bottom,0)};return{x:f-p.left+p.right,y:g-p.top+p.bottom,zoom:d}},dL=()=>{var s;return typeof navigator<"u"&&((s=navigator==null?void 0:navigator.userAgent)==null?void 0:s.indexOf("Mac"))>=0};function fw(s){return s!=null&&s!=="parent"}function hv(s){var e,t;return{width:((e=s.measured)==null?void 0:e.width)??s.width??s.initialWidth??0,height:((t=s.measured)==null?void 0:t.height)??s.height??s.initialHeight??0}}function ESe(s){var e,t;return(((e=s.measured)==null?void 0:e.width)??s.width??s.initialWidth)!==void 0&&(((t=s.measured)==null?void 0:t.height)??s.height??s.initialHeight)!==void 0}function kSe(s,e={width:0,height:0},t,i,n){const o={...s},r=i.get(t);if(r){const a=r.origin||n;o.x+=r.internals.positionAbsolute.x-(e.width??0)*a[0],o.y+=r.internals.positionAbsolute.y-(e.height??0)*a[1]}return o}function DSe(s){return{...gSe,...s||{}}}function WS(s,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:i,containerBounds:n}){const{x:o,y:r}=Qc(s),a=tk({x:o-((n==null?void 0:n.left)??0),y:r-((n==null?void 0:n.top)??0)},i),{x:l,y:c}=t?ek(a,e):a;return{xSnapped:l,ySnapped:c,...a}}const kne=s=>({width:s.offsetWidth,height:s.offsetHeight}),Dne=s=>{var e;return((e=s==null?void 0:s.getRootNode)==null?void 0:e.call(s))||(window==null?void 0:window.document)},TSe=["INPUT","SELECT","TEXTAREA"];function Tne(s){var i,n;const e=((n=(i=s.composedPath)==null?void 0:i.call(s))==null?void 0:n[0])||s.target;return(e==null?void 0:e.nodeType)!==1?!1:TSe.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const Nne=s=>"clientX"in s,Qc=(s,e)=>{var o,r;const t=Nne(s),i=t?s.clientX:(o=s.touches)==null?void 0:o[0].clientX,n=t?s.clientY:(r=s.touches)==null?void 0:r[0].clientY;return{x:i-((e==null?void 0:e.left)??0),y:n-((e==null?void 0:e.top)??0)}},rG=(s,e,t,i,n)=>{const o=e.querySelectorAll(`.${s}`);return!o||!o.length?null:Array.from(o).map(r=>{const a=r.getBoundingClientRect();return{id:r.getAttribute("data-handleid"),type:s,nodeId:n,position:r.getAttribute("data-handlepos"),x:(a.left-t.left)/i,y:(a.top-t.top)/i,...kne(r)}})};function NSe({sourceX:s,sourceY:e,targetX:t,targetY:i,sourceControlX:n,sourceControlY:o,targetControlX:r,targetControlY:a}){const l=s*.125+n*.375+r*.375+t*.125,c=e*.125+o*.375+a*.375+i*.125,d=Math.abs(l-s),h=Math.abs(c-e);return[l,c,d,h]}function Qk(s,e){return s>=0?.5*s:e*25*Math.sqrt(-s)}function aG({pos:s,x1:e,y1:t,x2:i,y2:n,c:o}){switch(s){case Ci.Left:return[e-Qk(e-i,o),t];case Ci.Right:return[e+Qk(i-e,o),t];case Ci.Top:return[e,t-Qk(t-n,o)];case Ci.Bottom:return[e,t+Qk(n-t,o)]}}function cO({sourceX:s,sourceY:e,sourcePosition:t=Ci.Bottom,targetX:i,targetY:n,targetPosition:o=Ci.Top,curvature:r=.25}){const[a,l]=aG({pos:t,x1:s,y1:e,x2:i,y2:n,c:r}),[c,d]=aG({pos:o,x1:i,y1:n,x2:s,y2:e,c:r}),[h,u,f,g]=NSe({sourceX:s,sourceY:e,targetX:i,targetY:n,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${s},${e} C${a},${l} ${c},${d} ${i},${n}`,h,u,f,g]}function Rne({sourceX:s,sourceY:e,targetX:t,targetY:i}){const n=Math.abs(t-s)/2,o=t<s?t+n:t-n,r=Math.abs(i-e)/2,a=i<e?i+r:i-r;return[o,a,n,r]}function RSe({sourceNode:s,targetNode:e,selected:t=!1,zIndex:i=0,elevateOnSelect:n=!1,zIndexMode:o="basic"}){if(o==="manual")return i;const r=n&&t?i+1e3:i,a=Math.max(s.parentId||n&&s.selected?s.internals.z:0,e.parentId||n&&e.selected?e.internals.z:0);return r+a}function MSe({sourceNode:s,targetNode:e,width:t,height:i,transform:n}){const o=aO(NN(s),NN(e));o.x===o.x2&&(o.x2+=1),o.y===o.y2&&(o.y2+=1);const r={x:-n[0]/n[2],y:-n[1]/n[2],width:t/n[2],height:i/n[2]};return cL(r,lO(o))>0}const ASe=({source:s,sourceHandle:e,target:t,targetHandle:i})=>`xy-edge__${s}${e||""}-${t}${i||""}`,PSe=(s,e)=>e.some(t=>t.source===s.source&&t.target===s.target&&(t.sourceHandle===s.sourceHandle||!t.sourceHandle&&!s.sourceHandle)&&(t.targetHandle===s.targetHandle||!t.targetHandle&&!s.targetHandle)),OSe=(s,e,t={})=>{if(!s.source||!s.target)return e;const i=t.getEdgeId||ASe;let n;return xne(s)?n={...s}:n={...s,id:i(s)},PSe(n,e)?e:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,e.concat(n))};function Mne({sourceX:s,sourceY:e,targetX:t,targetY:i}){const[n,o,r,a]=Rne({sourceX:s,sourceY:e,targetX:t,targetY:i});return[`M ${s},${e}L ${t},${i}`,n,o,r,a]}const lG={[Ci.Left]:{x:-1,y:0},[Ci.Right]:{x:1,y:0},[Ci.Top]:{x:0,y:-1},[Ci.Bottom]:{x:0,y:1}},FSe=({source:s,sourcePosition:e=Ci.Bottom,target:t})=>e===Ci.Left||e===Ci.Right?s.x<t.x?{x:1,y:0}:{x:-1,y:0}:s.y<t.y?{x:0,y:1}:{x:0,y:-1},cG=(s,e)=>Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2));function BSe({source:s,sourcePosition:e=Ci.Bottom,target:t,targetPosition:i=Ci.Top,center:n,offset:o,stepPosition:r}){const a=lG[e],l=lG[i],c={x:s.x+a.x*o,y:s.y+a.y*o},d={x:t.x+l.x*o,y:t.y+l.y*o},h=FSe({source:c,sourcePosition:e,target:d}),u=h.x!==0?"x":"y",f=h[u];let g=[],m,p;const v={x:0,y:0},b={x:0,y:0},[,,w,C]=Rne({sourceX:s.x,sourceY:s.y,targetX:t.x,targetY:t.y});if(a[u]*l[u]===-1){u==="x"?(m=n.x??c.x+(d.x-c.x)*r,p=n.y??(c.y+d.y)/2):(m=n.x??(c.x+d.x)/2,p=n.y??c.y+(d.y-c.y)*r);const x=[{x:m,y:c.y},{x:m,y:d.y}],S=[{x:c.x,y:p},{x:d.x,y:p}];a[u]===f?g=u==="x"?x:S:g=u==="x"?S:x}else{const x=[{x:c.x,y:d.y}],S=[{x:d.x,y:c.y}];if(u==="x"?g=a.x===f?S:x:g=a.y===f?x:S,e===i){const T=Math.abs(s[u]-t[u]);if(T<=o){const A=Math.min(o-1,o-T);a[u]===f?v[u]=(c[u]>s[u]?-1:1)*A:b[u]=(d[u]>t[u]?-1:1)*A}}if(e!==i){const T=u==="x"?"y":"x",A=a[u]===l[T],N=c[T]>d[T],P=c[T]<d[T];(a[u]===1&&(!A&&N||A&&P)||a[u]!==1&&(!A&&P||A&&N))&&(g=u==="x"?x:S)}const L={x:c.x+v.x,y:c.y+v.y},E={x:d.x+b.x,y:d.y+b.y},M=Math.max(Math.abs(L.x-g[0].x),Math.abs(E.x-g[0].x)),R=Math.max(Math.abs(L.y-g[0].y),Math.abs(E.y-g[0].y));M>=R?(m=(L.x+E.x)/2,p=g[0].y):(m=g[0].x,p=(L.y+E.y)/2)}return[[s,{x:c.x+v.x,y:c.y+v.y},...g,{x:d.x+b.x,y:d.y+b.y},t],m,p,w,C]}function WSe(s,e,t,i){const n=Math.min(cG(s,e)/2,cG(e,t)/2,i),{x:o,y:r}=e;if(s.x===o&&o===t.x||s.y===r&&r===t.y)return`L${o} ${r}`;if(s.y===r){const c=s.x<t.x?-1:1,d=s.y<t.y?1:-1;return`L ${o+n*c},${r}Q ${o},${r} ${o},${r+n*d}`}const a=s.x<t.x?1:-1,l=s.y<t.y?-1:1;return`L ${o},${r+n*l}Q ${o},${r} ${o+n*a},${r}`}function Jz({sourceX:s,sourceY:e,sourcePosition:t=Ci.Bottom,targetX:i,targetY:n,targetPosition:o=Ci.Top,borderRadius:r=5,centerX:a,centerY:l,offset:c=20,stepPosition:d=.5}){const[h,u,f,g,m]=BSe({source:{x:s,y:e},sourcePosition:t,target:{x:i,y:n},targetPosition:o,center:{x:a,y:l},offset:c,stepPosition:d});return[h.reduce((v,b,w)=>{let C="";return w>0&&w<h.length-1?C=WSe(h[w-1],b,h[w+1],r):C=`${w===0?"M":"L"}${b.x} ${b.y}`,v+=C,v},""),u,f,g,m]}function dG(s){var e;return s&&!!(s.internals.handleBounds||(e=s.handles)!=null&&e.length)&&!!(s.measured.width||s.width||s.initialWidth)}function HSe(s){var h;const{sourceNode:e,targetNode:t}=s;if(!dG(e)||!dG(t))return null;const i=e.internals.handleBounds||hG(e.handles),n=t.internals.handleBounds||hG(t.handles),o=uG((i==null?void 0:i.source)??[],s.sourceHandle),r=uG(s.connectionMode===dw.Strict?(n==null?void 0:n.target)??[]:((n==null?void 0:n.target)??[]).concat((n==null?void 0:n.source)??[]),s.targetHandle);if(!o||!r)return(h=s.onError)==null||h.call(s,"008",lL.error008(o?"target":"source",{id:s.id,sourceHandle:s.sourceHandle,targetHandle:s.targetHandle})),null;const a=(o==null?void 0:o.position)||Ci.Bottom,l=(r==null?void 0:r.position)||Ci.Top,c=Lb(e,o,a),d=Lb(t,r,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function hG(s){if(!s)return null;const e=[],t=[];for(const i of s)i.width=i.width??1,i.height=i.height??1,i.type==="source"?e.push(i):i.type==="target"&&t.push(i);return{source:e,target:t}}function Lb(s,e,t=Ci.Left,i=!1){const n=((e==null?void 0:e.x)??0)+s.internals.positionAbsolute.x,o=((e==null?void 0:e.y)??0)+s.internals.positionAbsolute.y,{width:r,height:a}=e??hv(s);if(i)return{x:n+r/2,y:o+a/2};switch((e==null?void 0:e.position)??t){case Ci.Top:return{x:n+r/2,y:o};case Ci.Right:return{x:n+r,y:o+a/2};case Ci.Bottom:return{x:n+r/2,y:o+a};case Ci.Left:return{x:n,y:o+a/2}}}function uG(s,e){return s&&(e?s.find(t=>t.id===e):s[0])||null}function f9(s,e){return s?typeof s=="string"?s:`${e?`${e}__`:""}${Object.keys(s).sort().map(i=>`${i}=${s[i]}`).join("&")}`:""}function VSe(s,{id:e,defaultColor:t,defaultMarkerStart:i,defaultMarkerEnd:n}){const o=new Set;return s.reduce((r,a)=>([a.markerStart||i,a.markerEnd||n].forEach(l=>{if(l&&typeof l=="object"){const c=f9(l,e);o.has(c)||(r.push({id:c,color:l.color||t,...l}),o.add(c))}}),r),[]).sort((r,a)=>r.id.localeCompare(a.id))}const Ane=1e3,zSe=10,eU={nodeOrigin:[0,0],nodeExtent:d9,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},USe={...eU,checkEquality:!0};function tU(s,e){const t={...s};for(const i in e)e[i]!==void 0&&(t[i]=e[i]);return t}function $Se(s,e,t){const i=tU(eU,t);for(const n of s.values())if(n.parentId)nU(n,s,e,i);else{const o=JE(n,i.nodeOrigin),r=fw(n.extent)?n.extent:i.nodeExtent,a=xb(o,r,hv(n));n.internals.positionAbsolute=a}}function qSe(s,e){if(!s.handles)return s.measured?e==null?void 0:e.internals.handleBounds:void 0;const t=[],i=[];for(const n of s.handles){const o={id:n.id,width:n.width??1,height:n.height??1,nodeId:s.id,x:n.x,y:n.y,position:n.position,type:n.type};n.type==="source"?t.push(o):n.type==="target"&&i.push(o)}return{source:t,target:i}}function iU(s){return s==="manual"}function jSe(s,e,t,i={}){var c,d;const n=tU(USe,i),o={i:0},r=new Map(e),a=n!=null&&n.elevateNodesOnSelect&&!iU(n.zIndexMode)?Ane:0;let l=s.length>0;e.clear(),t.clear();for(const h of s){let u=r.get(h.id);if(n.checkEquality&&h===(u==null?void 0:u.internals.userNode))e.set(h.id,u);else{const f=JE(h,n.nodeOrigin),g=fw(h.extent)?h.extent:n.nodeExtent,m=xb(f,g,hv(h));u={...n.defaults,...h,measured:{width:(c=h.measured)==null?void 0:c.width,height:(d=h.measured)==null?void 0:d.height},internals:{positionAbsolute:m,handleBounds:qSe(h,u),z:Pne(h,a,n.zIndexMode),userNode:h}},e.set(h.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(l=!1),h.parentId&&nU(u,e,t,i,o)}return l}function KSe(s,e){if(!s.parentId)return;const t=e.get(s.parentId);t?t.set(s.id,s):e.set(s.parentId,new Map([[s.id,s]]))}function nU(s,e,t,i,n){const{elevateNodesOnSelect:o,nodeOrigin:r,nodeExtent:a,zIndexMode:l}=tU(eU,i),c=s.parentId,d=e.get(c);if(!d){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}KSe(s,t),n&&!d.parentId&&d.internals.rootParentIndex===void 0&&l==="auto"&&(d.internals.rootParentIndex=++n.i,d.internals.z=d.internals.z+n.i*zSe),n&&d.internals.rootParentIndex!==void 0&&(n.i=d.internals.rootParentIndex);const h=o&&!iU(l)?Ane:0,{x:u,y:f,z:g}=GSe(s,d,r,a,h,l),{positionAbsolute:m}=s.internals,p=u!==m.x||f!==m.y;(p||g!==s.internals.z)&&e.set(s.id,{...s,internals:{...s.internals,positionAbsolute:p?{x:u,y:f}:m,z:g}})}function Pne(s,e,t){const i=Tu(s.zIndex)?s.zIndex:0;return iU(t)?i:i+(s.selected?e:0)}function GSe(s,e,t,i,n,o){const{x:r,y:a}=e.internals.positionAbsolute,l=hv(s),c=JE(s,t),d=fw(s.extent)?xb(c,s.extent,l):c;let h=xb({x:r+d.x,y:a+d.y},i,l);s.extent==="parent"&&(h=Ine(h,l,e));const u=Pne(s,n,o),f=e.internals.z??0;return{x:h.x,y:h.y,z:f>=u?f+1:u}}function YSe(s,e,t,i=[0,0]){var r;const n=[],o=new Map;for(const a of s){const l=e.get(a.parentId);if(!l)continue;const c=((r=o.get(a.parentId))==null?void 0:r.expandedRect)??uw(l),d=SSe(c,a.rect);o.set(a.parentId,{expandedRect:d,parent:l})}return o.size>0&&o.forEach(({expandedRect:a,parent:l},c)=>{var w;const d=l.internals.positionAbsolute,h=hv(l),u=l.origin??i,f=a.x<d.x?Math.round(Math.abs(d.x-a.x)):0,g=a.y<d.y?Math.round(Math.abs(d.y-a.y)):0,m=Math.max(h.width,Math.round(a.width)),p=Math.max(h.height,Math.round(a.height)),v=(m-h.width)*u[0],b=(p-h.height)*u[1];(f>0||g>0||v||b)&&(n.push({id:c,type:"position",position:{x:l.position.x-f+v,y:l.position.y-g+b}}),(w=t.get(c))==null||w.forEach(C=>{s.some(y=>y.id===C.id)||n.push({id:C.id,type:"position",position:{x:C.position.x+f,y:C.position.y+g}})})),(h.width<a.width||h.height<a.height||f||g)&&n.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(f?u[0]*f-v:0),height:p+(g?u[1]*g-b:0)}})}),n}function XSe(s,e,t,i,n,o,r){const a=i==null?void 0:i.querySelector(".xyflow__viewport");let l=!1;if(!a)return{changes:[],updatedInternals:l};const c=[],d=window.getComputedStyle(a),{m22:h}=new window.DOMMatrixReadOnly(d.transform),u=[];for(const f of s.values()){const g=e.get(f.id);if(!g)continue;if(g.hidden){e.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),l=!0;continue}const m=kne(f.nodeElement),p=g.measured.width!==m.width||g.measured.height!==m.height;if(!!(m.width&&m.height&&(p||!g.internals.handleBounds||f.force))){const b=f.nodeElement.getBoundingClientRect(),w=fw(g.extent)?g.extent:o;let{positionAbsolute:C}=g.internals;g.parentId&&g.extent==="parent"?C=Ine(C,m,e.get(g.parentId)):w&&(C=xb(C,w,m));const y={...g,measured:m,internals:{...g.internals,positionAbsolute:C,handleBounds:{source:rG("source",f.nodeElement,b,h,g.id),target:rG("target",f.nodeElement,b,h,g.id)}}};e.set(g.id,y),g.parentId&&nU(y,e,t,{nodeOrigin:n,zIndexMode:r}),l=!0,p&&(c.push({id:g.id,type:"dimensions",dimensions:m}),g.expandParent&&g.parentId&&u.push({id:g.id,parentId:g.parentId,rect:uw(y,n)}))}}if(u.length>0){const f=YSe(u,e,t,n);c.push(...f)}return{changes:c,updatedInternals:l}}async function ZSe({delta:s,panZoom:e,transform:t,translateExtent:i,width:n,height:o}){if(!e||!s.x&&!s.y)return Promise.resolve(!1);const r=await e.setViewportConstrained({x:t[0]+s.x,y:t[1]+s.y,zoom:t[2]},[[0,0],[n,o]],i),a=!!r&&(r.x!==t[0]||r.y!==t[1]||r.k!==t[2]);return Promise.resolve(a)}function fG(s,e,t,i,n,o){let r=n;const a=i.get(r)||new Map;i.set(r,a.set(t,e)),r=`${n}-${s}`;const l=i.get(r)||new Map;if(i.set(r,l.set(t,e)),o){r=`${n}-${s}-${o}`;const c=i.get(r)||new Map;i.set(r,c.set(t,e))}}function QSe(s,e,t){s.clear(),e.clear();for(const i of t){const{source:n,target:o,sourceHandle:r=null,targetHandle:a=null}=i,l={edgeId:i.id,source:n,target:o,sourceHandle:r,targetHandle:a},c=`${n}-${r}--${o}-${a}`,d=`${o}-${a}--${n}-${r}`;fG("source",l,d,s,n,r),fG("target",l,c,s,o,a),e.set(i.id,i)}}function One(s,e){if(!s.parentId)return!1;const t=e.get(s.parentId);return t?t.selected?!0:One(t,e):!1}function gG(s,e,t){var n;let i=s;do{if((n=i==null?void 0:i.matches)!=null&&n.call(i,e))return!0;if(i===t)return!1;i=i==null?void 0:i.parentElement}while(i);return!1}function JSe(s,e,t,i){const n=new Map;for(const[o,r]of s)if((r.selected||r.id===i)&&(!r.parentId||!One(r,s))&&(r.draggable||e&&typeof r.draggable>"u")){const a=s.get(o);a&&n.set(o,{id:o,position:a.position||{x:0,y:0},distance:{x:t.x-a.internals.positionAbsolute.x,y:t.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return n}function g5({nodeId:s,dragItems:e,nodeLookup:t,dragging:i=!0}){var r,a,l;const n=[];for(const[c,d]of e){const h=(r=t.get(c))==null?void 0:r.internals.userNode;h&&n.push({...h,position:d.position,dragging:i})}if(!s)return[n[0],n];const o=(a=t.get(s))==null?void 0:a.internals.userNode;return[o?{...o,position:((l=e.get(s))==null?void 0:l.position)||o.position,dragging:i}:n[0],n]}function exe({dragItems:s,snapGrid:e,x:t,y:i}){const n=s.values().next().value;if(!n)return null;const o={x:t-n.distance.x,y:i-n.distance.y},r=ek(o,e);return{x:r.x-o.x,y:r.y-o.y}}function txe({onNodeMouseDown:s,getStoreItems:e,onDragStart:t,onDrag:i,onDragStop:n}){let o={x:null,y:null},r=0,a=new Map,l=!1,c={x:0,y:0},d=null,h=!1,u=null,f=!1,g=!1,m=null;function p({noDragClassName:b,handleSelector:w,domNode:C,isSelectable:y,nodeId:x,nodeClickDistance:S=0}){u=bl(C);function L({x:T,y:A}){const{nodeLookup:N,nodeExtent:P,snapGrid:W,snapToGrid:H,nodeOrigin:G,onNodeDrag:V,onSelectionDrag:U,onError:$,updateNodePositions:Y}=e();o={x:T,y:A};let se=!1;const j=a.size>1,ie=j&&P?u9(rO(a)):null,te=j&&H?exe({dragItems:a,snapGrid:W,x:T,y:A}):null;for(const[pe,J]of a){if(!N.has(pe))continue;let le={x:T-J.distance.x,y:A-J.distance.y};H&&(le=te?{x:Math.round(le.x+te.x),y:Math.round(le.y+te.y)}:ek(le,W));let be=null;if(j&&P&&!J.extent&&ie){const{positionAbsolute:qe}=J.internals,mt=qe.x-ie.x+P[0][0],Ke=qe.x+J.measured.width-ie.x2+P[1][0],nt=qe.y-ie.y+P[0][1],ft=qe.y+J.measured.height-ie.y2+P[1][1];be=[[mt,nt],[Ke,ft]]}const{position:Ce,positionAbsolute:Je}=Lne({nodeId:pe,nextPosition:le,nodeLookup:N,nodeExtent:be||P,nodeOrigin:G,onError:$});se=se||J.position.x!==Ce.x||J.position.y!==Ce.y,J.position=Ce,J.internals.positionAbsolute=Je}if(g=g||se,!!se&&(Y(a,!0),m&&(i||V||!x&&U))){const[pe,J]=g5({nodeId:x,dragItems:a,nodeLookup:N});i==null||i(m,a,pe,J),V==null||V(m,pe,J),x||U==null||U(m,J)}}async function E(){if(!d)return;const{transform:T,panBy:A,autoPanSpeed:N,autoPanOnNodeDrag:P}=e();if(!P){l=!1,cancelAnimationFrame(r);return}const[W,H]=Ene(c,d,N);(W!==0||H!==0)&&(o.x=(o.x??0)-W/T[2],o.y=(o.y??0)-H/T[2],await A({x:W,y:H})&&L(o)),r=requestAnimationFrame(E)}function M(T){var j;const{nodeLookup:A,multiSelectionActive:N,nodesDraggable:P,transform:W,snapGrid:H,snapToGrid:G,selectNodesOnDrag:V,onNodeDragStart:U,onSelectionDragStart:$,unselectNodesAndEdges:Y}=e();h=!0,(!V||!y)&&!N&&x&&((j=A.get(x))!=null&&j.selected||Y()),y&&V&&x&&(s==null||s(x));const se=WS(T.sourceEvent,{transform:W,snapGrid:H,snapToGrid:G,containerBounds:d});if(o=se,a=JSe(A,P,se,x),a.size>0&&(t||U||!x&&$)){const[ie,te]=g5({nodeId:x,dragItems:a,nodeLookup:A});t==null||t(T.sourceEvent,a,ie,te),U==null||U(T.sourceEvent,ie,te),x||$==null||$(T.sourceEvent,te)}}const R=ane().clickDistance(S).on("start",T=>{const{domNode:A,nodeDragThreshold:N,transform:P,snapGrid:W,snapToGrid:H}=e();d=(A==null?void 0:A.getBoundingClientRect())||null,f=!1,g=!1,m=T.sourceEvent,N===0&&M(T),o=WS(T.sourceEvent,{transform:P,snapGrid:W,snapToGrid:H,containerBounds:d}),c=Qc(T.sourceEvent,d)}).on("drag",T=>{const{autoPanOnNodeDrag:A,transform:N,snapGrid:P,snapToGrid:W,nodeDragThreshold:H,nodeLookup:G}=e(),V=WS(T.sourceEvent,{transform:N,snapGrid:P,snapToGrid:W,containerBounds:d});if(m=T.sourceEvent,(T.sourceEvent.type==="touchmove"&&T.sourceEvent.touches.length>1||x&&!G.has(x))&&(f=!0),!f){if(!l&&A&&h&&(l=!0,E()),!h){const U=Qc(T.sourceEvent,d),$=U.x-c.x,Y=U.y-c.y;Math.sqrt($*$+Y*Y)>H&&M(T)}(o.x!==V.xSnapped||o.y!==V.ySnapped)&&a&&h&&(c=Qc(T.sourceEvent,d),L(V))}}).on("end",T=>{if(!(!h||f)&&(l=!1,h=!1,cancelAnimationFrame(r),a.size>0)){const{nodeLookup:A,updateNodePositions:N,onNodeDragStop:P,onSelectionDragStop:W}=e();if(g&&(N(a,!1),g=!1),n||P||!x&&W){const[H,G]=g5({nodeId:x,dragItems:a,nodeLookup:A,dragging:!1});n==null||n(T.sourceEvent,a,H,G),P==null||P(T.sourceEvent,H,G),x||W==null||W(T.sourceEvent,G)}}}).filter(T=>{const A=T.target;return!T.button&&(!b||!gG(A,`.${b}`,C))&&(!w||gG(A,w,C))});u.call(R)}function v(){u==null||u.on(".drag",null)}return{update:p,destroy:v}}function ixe(s,e,t){const i=[],n={x:s.x-t,y:s.y-t,width:t*2,height:t*2};for(const o of e.values())cL(n,uw(o))>0&&i.push(o);return i}const nxe=250;function sxe(s,e,t,i){var a,l;let n=[],o=1/0;const r=ixe(s,t,e+nxe);for(const c of r){const d=[...((a=c.internals.handleBounds)==null?void 0:a.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const h of d){if(i.nodeId===h.nodeId&&i.type===h.type&&i.id===h.id)continue;const{x:u,y:f}=Lb(c,h,h.position,!0),g=Math.sqrt(Math.pow(u-s.x,2)+Math.pow(f-s.y,2));g>e||(g<o?(n=[{...h,x:u,y:f}],o=g):g===o&&n.push({...h,x:u,y:f}))}}if(!n.length)return null;if(n.length>1){const c=i.type==="source"?"target":"source";return n.find(d=>d.type===c)??n[0]}return n[0]}function Fne(s,e,t,i,n,o=!1){var c,d,h;const r=i.get(s);if(!r)return null;const a=n==="strict"?(c=r.internals.handleBounds)==null?void 0:c[e]:[...((d=r.internals.handleBounds)==null?void 0:d.source)??[],...((h=r.internals.handleBounds)==null?void 0:h.target)??[]],l=(t?a==null?void 0:a.find(u=>u.id===t):a==null?void 0:a[0])??null;return l&&o?{...l,...Lb(r,l,l.position,!0)}:l}function Bne(s,e){return s||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function oxe(s,e){let t=null;return e?t=!0:s&&!e&&(t=!1),t}const Wne=()=>!0;function rxe(s,{connectionMode:e,connectionRadius:t,handleId:i,nodeId:n,edgeUpdaterType:o,isTarget:r,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:h,panBy:u,cancelConnection:f,onConnectStart:g,onConnect:m,onConnectEnd:p,isValidConnection:v=Wne,onReconnectEnd:b,updateConnection:w,getTransform:C,getFromHandle:y,autoPanSpeed:x,dragThreshold:S=1,handleDomNode:L}){const E=Dne(s.target);let M=0,R;const{x:T,y:A}=Qc(s),N=Bne(o,L),P=a==null?void 0:a.getBoundingClientRect();let W=!1;if(!P||!N)return;const H=Fne(n,N,i,l,e);if(!H)return;let G=Qc(s,P),V=!1,U=null,$=!1,Y=null;function se(){if(!d||!P)return;const[Ce,Je]=Ene(G,P,x);u({x:Ce,y:Je}),M=requestAnimationFrame(se)}const j={...H,nodeId:n,type:N,position:H.position},ie=l.get(n);let pe={inProgress:!0,isValid:null,from:Lb(ie,j,Ci.Left,!0),fromHandle:j,fromPosition:j.position,fromNode:ie,to:G,toHandle:null,toPosition:iG[j.position],toNode:null,pointer:G};function J(){W=!0,w(pe),g==null||g(s,{nodeId:n,handleId:i,handleType:N})}S===0&&J();function le(Ce){if(!W){const{x:ft,y:Pe}=Qc(Ce),Be=ft-T,Me=Pe-A;if(!(Be*Be+Me*Me>S*S))return;J()}if(!y()||!j){be(Ce);return}const Je=C();G=Qc(Ce,P),R=sxe(tk(G,Je,!1,[1,1]),t,l,j),V||(se(),V=!0);const qe=Hne(Ce,{handle:R,connectionMode:e,fromNodeId:n,fromHandleId:i,fromType:r?"target":"source",isValidConnection:v,doc:E,lib:c,flowId:h,nodeLookup:l});Y=qe.handleDomNode,U=qe.connection,$=oxe(!!R,qe.isValid);const mt=l.get(n),Ke=mt?Lb(mt,j,Ci.Left,!0):pe.from,nt={...pe,from:Ke,isValid:$,to:qe.toHandle&&$?RN({x:qe.toHandle.x,y:qe.toHandle.y},Je):G,toHandle:qe.toHandle,toPosition:$&&qe.toHandle?qe.toHandle.position:iG[j.position],toNode:qe.toHandle?l.get(qe.toHandle.nodeId):null,pointer:G};w(nt),pe=nt}function be(Ce){if(!("touches"in Ce&&Ce.touches.length>0)){if(W){(R||Y)&&U&&$&&(m==null||m(U));const{inProgress:Je,...qe}=pe,mt={...qe,toPosition:pe.toHandle?pe.toPosition:null};p==null||p(Ce,mt),o&&(b==null||b(Ce,mt))}f(),cancelAnimationFrame(M),V=!1,$=!1,U=null,Y=null,E.removeEventListener("mousemove",le),E.removeEventListener("mouseup",be),E.removeEventListener("touchmove",le),E.removeEventListener("touchend",be)}}E.addEventListener("mousemove",le),E.addEventListener("mouseup",be),E.addEventListener("touchmove",le),E.addEventListener("touchend",be)}function Hne(s,{handle:e,connectionMode:t,fromNodeId:i,fromHandleId:n,fromType:o,doc:r,lib:a,flowId:l,isValidConnection:c=Wne,nodeLookup:d}){const h=o==="target",u=e?r.querySelector(`.${a}-flow__handle[data-id="${l}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:f,y:g}=Qc(s),m=r.elementFromPoint(f,g),p=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:u,v={handleDomNode:p,isValid:!1,connection:null,toHandle:null};if(p){const b=Bne(void 0,p),w=p.getAttribute("data-nodeid"),C=p.getAttribute("data-handleid"),y=p.classList.contains("connectable"),x=p.classList.contains("connectableend");if(!w||!b)return v;const S={source:h?w:i,sourceHandle:h?C:n,target:h?i:w,targetHandle:h?n:C};v.connection=S;const E=y&&x&&(t===dw.Strict?h&&b==="source"||!h&&b==="target":w!==i||C!==n);v.isValid=E&&c(S),v.toHandle=Fne(w,b,C,d,t,!0)}return v}const mG={onPointerDown:rxe,isValid:Hne};function Rct({domNode:s,panZoom:e,getTransform:t,getViewScale:i}){const n=bl(s);function o({translateExtent:a,width:l,height:c,zoomStep:d=1,pannable:h=!0,zoomable:u=!0,inversePan:f=!1}){const g=w=>{if(w.sourceEvent.type!=="wheel"||!e)return;const C=t(),y=w.sourceEvent.ctrlKey&&dL()?10:1,x=-w.sourceEvent.deltaY*(w.sourceEvent.deltaMode===1?.05:w.sourceEvent.deltaMode?1:.002)*d,S=C[2]*Math.pow(2,x*y);e.scaleTo(S)};let m=[0,0];const p=w=>{(w.sourceEvent.type==="mousedown"||w.sourceEvent.type==="touchstart")&&(m=[w.sourceEvent.clientX??w.sourceEvent.touches[0].clientX,w.sourceEvent.clientY??w.sourceEvent.touches[0].clientY])},v=w=>{const C=t();if(w.sourceEvent.type!=="mousemove"&&w.sourceEvent.type!=="touchmove"||!e)return;const y=[w.sourceEvent.clientX??w.sourceEvent.touches[0].clientX,w.sourceEvent.clientY??w.sourceEvent.touches[0].clientY],x=[y[0]-m[0],y[1]-m[1]];m=y;const S=i()*Math.max(C[2],Math.log(C[2]))*(f?-1:1),L={x:C[0]-x[0]*S,y:C[1]-x[1]*S},E=[[0,0],[l,c]];e.setViewportConstrained({x:L.x,y:L.y,zoom:C[2]},E,a)},b=yne().on("start",p).on("zoom",h?v:null).on("zoom.wheel",u?g:null);n.call(b,{})}function r(){n.on("zoom",null)}return{update:o,destroy:r,pointer:Wc}}const dO=s=>({x:s.x,y:s.y,zoom:s.k}),m5=({x:s,y:e,zoom:t})=>oO.translate(s,e).scale(t),SC=(s,e)=>s.target.closest(`.${e}`),Vne=(s,e)=>e===2&&Array.isArray(s)&&s.includes(2),axe=s=>((s*=2)<=1?s*s*s:(s-=2)*s*s+2)/2,p5=(s,e=0,t=axe,i=()=>{})=>{const n=typeof e=="number"&&e>0;return n||i(),n?s.transition().duration(e).ease(t).on("end",i):s},zne=s=>{const e=s.ctrlKey&&dL()?10:1;return-s.deltaY*(s.deltaMode===1?.05:s.deltaMode?1:.002)*e};function lxe({zoomPanValues:s,noWheelClassName:e,d3Selection:t,d3Zoom:i,panOnScrollMode:n,panOnScrollSpeed:o,zoomOnPinch:r,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(SC(d,e))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const h=t.property("__zoom").k||1;if(d.ctrlKey&&r){const p=Wc(d),v=zne(d),b=h*Math.pow(2,v);i.scaleTo(t,b,p,d);return}const u=d.deltaMode===1?20:1;let f=n===d1.Vertical?0:d.deltaX*u,g=n===d1.Horizontal?0:d.deltaY*u;!dL()&&d.shiftKey&&n!==d1.Vertical&&(f=d.deltaY*u,g=0),i.translateBy(t,-(f/h)*o,-(g/h)*o,{internal:!0});const m=dO(t.property("__zoom"));clearTimeout(s.panScrollTimeout),s.isPanScrolling?(l==null||l(d,m),s.panScrollTimeout=setTimeout(()=>{c==null||c(d,m),s.isPanScrolling=!1},150)):(s.isPanScrolling=!0,a==null||a(d,m))}}function cxe({noWheelClassName:s,preventScrolling:e,d3ZoomHandler:t}){return function(i,n){const o=i.type==="wheel",r=!e&&o&&!i.ctrlKey,a=SC(i,s);if(i.ctrlKey&&o&&a&&i.preventDefault(),r||a)return null;i.preventDefault(),t.call(this,i,n)}}function dxe({zoomPanValues:s,onDraggingChange:e,onPanZoomStart:t}){return i=>{var o,r,a;if((o=i.sourceEvent)!=null&&o.internal)return;const n=dO(i.transform);s.mouseButton=((r=i.sourceEvent)==null?void 0:r.button)||0,s.isZoomingOrPanning=!0,s.prevViewport=n,((a=i.sourceEvent)==null?void 0:a.type)==="mousedown"&&e(!0),t&&(t==null||t(i.sourceEvent,n))}}function hxe({zoomPanValues:s,panOnDrag:e,onPaneContextMenu:t,onTransformChange:i,onPanZoom:n}){return o=>{var r,a;s.usedRightMouseButton=!!(t&&Vne(e,s.mouseButton??0)),(r=o.sourceEvent)!=null&&r.sync||i([o.transform.x,o.transform.y,o.transform.k]),n&&!((a=o.sourceEvent)!=null&&a.internal)&&(n==null||n(o.sourceEvent,dO(o.transform)))}}function uxe({zoomPanValues:s,panOnDrag:e,panOnScroll:t,onDraggingChange:i,onPanZoomEnd:n,onPaneContextMenu:o}){return r=>{var a;if(!((a=r.sourceEvent)!=null&&a.internal)&&(s.isZoomingOrPanning=!1,o&&Vne(e,s.mouseButton??0)&&!s.usedRightMouseButton&&r.sourceEvent&&o(r.sourceEvent),s.usedRightMouseButton=!1,i(!1),n)){const l=dO(r.transform);s.prevViewport=l,clearTimeout(s.timerId),s.timerId=setTimeout(()=>{n==null||n(r.sourceEvent,l)},t?150:0)}}}function fxe({zoomActivationKeyPressed:s,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:i,panOnScroll:n,zoomOnDoubleClick:o,userSelectionActive:r,noWheelClassName:a,noPanClassName:l,lib:c,connectionInProgress:d}){return h=>{var p;const u=s||e,f=t&&h.ctrlKey,g=h.type==="wheel";if(h.button===1&&h.type==="mousedown"&&(SC(h,`${c}-flow__node`)||SC(h,`${c}-flow__edge`)))return!0;if(!i&&!u&&!n&&!o&&!t||r||d&&!g||SC(h,a)&&g||SC(h,l)&&(!g||n&&g&&!s)||!t&&h.ctrlKey&&g)return!1;if(!t&&h.type==="touchstart"&&((p=h.touches)==null?void 0:p.length)>1)return h.preventDefault(),!1;if(!u&&!n&&!f&&g||!i&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(i)&&!i.includes(h.button)&&h.type==="mousedown")return!1;const m=Array.isArray(i)&&i.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||g)&&m}}function gxe({domNode:s,minZoom:e,maxZoom:t,translateExtent:i,viewport:n,onPanZoom:o,onPanZoomStart:r,onPanZoomEnd:a,onDraggingChange:l}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=s.getBoundingClientRect(),h=yne().scaleExtent([e,t]).translateExtent(i),u=bl(s).call(h);b({x:n.x,y:n.y,zoom:hw(n.zoom,e,t)},[[0,0],[d.width,d.height]],i);const f=u.on("wheel.zoom"),g=u.on("dblclick.zoom");h.wheelDelta(zne);function m(R,T){return u?new Promise(A=>{h==null||h.interpolate((T==null?void 0:T.interpolate)==="linear"?BS:TT).transform(p5(u,T==null?void 0:T.duration,T==null?void 0:T.ease,()=>A(!0)),R)}):Promise.resolve(!1)}function p({noWheelClassName:R,noPanClassName:T,onPaneContextMenu:A,userSelectionActive:N,panOnScroll:P,panOnDrag:W,panOnScrollMode:H,panOnScrollSpeed:G,preventScrolling:V,zoomOnPinch:U,zoomOnScroll:$,zoomOnDoubleClick:Y,zoomActivationKeyPressed:se,lib:j,onTransformChange:ie,connectionInProgress:te,paneClickDistance:pe,selectionOnDrag:J}){N&&!c.isZoomingOrPanning&&v();const le=P&&!se&&!N;h.clickDistance(J?1/0:!Tu(pe)||pe<0?0:pe);const be=le?lxe({zoomPanValues:c,noWheelClassName:R,d3Selection:u,d3Zoom:h,panOnScrollMode:H,panOnScrollSpeed:G,zoomOnPinch:U,onPanZoomStart:r,onPanZoom:o,onPanZoomEnd:a}):cxe({noWheelClassName:R,preventScrolling:V,d3ZoomHandler:f});if(u.on("wheel.zoom",be,{passive:!1}),!N){const Je=dxe({zoomPanValues:c,onDraggingChange:l,onPanZoomStart:r});h.on("start",Je);const qe=hxe({zoomPanValues:c,panOnDrag:W,onPaneContextMenu:!!A,onPanZoom:o,onTransformChange:ie});h.on("zoom",qe);const mt=uxe({zoomPanValues:c,panOnDrag:W,panOnScroll:P,onPaneContextMenu:A,onPanZoomEnd:a,onDraggingChange:l});h.on("end",mt)}const Ce=fxe({zoomActivationKeyPressed:se,panOnDrag:W,zoomOnScroll:$,panOnScroll:P,zoomOnDoubleClick:Y,zoomOnPinch:U,userSelectionActive:N,noPanClassName:T,noWheelClassName:R,lib:j,connectionInProgress:te});h.filter(Ce),Y?u.on("dblclick.zoom",g):u.on("dblclick.zoom",null)}function v(){h.on("zoom",null)}async function b(R,T,A){const N=m5(R),P=h==null?void 0:h.constrain()(N,T,A);return P&&await m(P),new Promise(W=>W(P))}async function w(R,T){const A=m5(R);return await m(A,T),new Promise(N=>N(A))}function C(R){if(u){const T=m5(R),A=u.property("__zoom");(A.k!==R.zoom||A.x!==R.x||A.y!==R.y)&&(h==null||h.transform(u,T,null,{sync:!0}))}}function y(){const R=u?wne(u.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function x(R,T){return u?new Promise(A=>{h==null||h.interpolate((T==null?void 0:T.interpolate)==="linear"?BS:TT).scaleTo(p5(u,T==null?void 0:T.duration,T==null?void 0:T.ease,()=>A(!0)),R)}):Promise.resolve(!1)}function S(R,T){return u?new Promise(A=>{h==null||h.interpolate((T==null?void 0:T.interpolate)==="linear"?BS:TT).scaleBy(p5(u,T==null?void 0:T.duration,T==null?void 0:T.ease,()=>A(!0)),R)}):Promise.resolve(!1)}function L(R){h==null||h.scaleExtent(R)}function E(R){h==null||h.translateExtent(R)}function M(R){const T=!Tu(R)||R<0?0:R;h==null||h.clickDistance(T)}return{update:p,destroy:v,setViewport:w,setViewportConstrained:b,getViewport:y,scaleTo:x,scaleBy:S,setScaleExtent:L,setTranslateExtent:E,syncViewport:C,setClickDistance:M}}var hL;(function(s){s.Line="line",s.Handle="handle"})(hL||(hL={}));const mxe=["top-left","top-right","bottom-left","bottom-right"],pxe=["top","right","bottom","left"];function _xe({width:s,prevWidth:e,height:t,prevHeight:i,affectsX:n,affectsY:o}){const r=s-e,a=t-i,l=[r>0?1:r<0?-1:0,a>0?1:a<0?-1:0];return r&&n&&(l[0]=l[0]*-1),a&&o&&(l[1]=l[1]*-1),l}function pG(s){const e=s.includes("right")||s.includes("left"),t=s.includes("bottom")||s.includes("top"),i=s.includes("left"),n=s.includes("top");return{isHorizontal:e,isVertical:t,affectsX:i,affectsY:n}}function Ff(s,e){return Math.max(0,e-s)}function Bf(s,e){return Math.max(0,s-e)}function Jk(s,e,t){return Math.max(0,e-s,s-t)}function _G(s,e){return s?!e:e}function bxe(s,e,t,i,n,o,r,a){let{affectsX:l,affectsY:c}=e;const{isHorizontal:d,isVertical:h}=e,u=d&&h,{xSnapped:f,ySnapped:g}=t,{minWidth:m,maxWidth:p,minHeight:v,maxHeight:b}=i,{x:w,y:C,width:y,height:x,aspectRatio:S}=s;let L=Math.floor(d?f-s.pointerX:0),E=Math.floor(h?g-s.pointerY:0);const M=y+(l?-L:L),R=x+(c?-E:E),T=-o[0]*y,A=-o[1]*x;let N=Jk(M,m,p),P=Jk(R,v,b);if(r){let G=0,V=0;l&&L<0?G=Ff(w+L+T,r[0][0]):!l&&L>0&&(G=Bf(w+M+T,r[1][0])),c&&E<0?V=Ff(C+E+A,r[0][1]):!c&&E>0&&(V=Bf(C+R+A,r[1][1])),N=Math.max(N,G),P=Math.max(P,V)}if(a){let G=0,V=0;l&&L>0?G=Bf(w+L,a[0][0]):!l&&L<0&&(G=Ff(w+M,a[1][0])),c&&E>0?V=Bf(C+E,a[0][1]):!c&&E<0&&(V=Ff(C+R,a[1][1])),N=Math.max(N,G),P=Math.max(P,V)}if(n){if(d){const G=Jk(M/S,v,b)*S;if(N=Math.max(N,G),r){let V=0;!l&&!c||l&&!c&&u?V=Bf(C+A+M/S,r[1][1])*S:V=Ff(C+A+(l?L:-L)/S,r[0][1])*S,N=Math.max(N,V)}if(a){let V=0;!l&&!c||l&&!c&&u?V=Ff(C+M/S,a[1][1])*S:V=Bf(C+(l?L:-L)/S,a[0][1])*S,N=Math.max(N,V)}}if(h){const G=Jk(R*S,m,p)/S;if(P=Math.max(P,G),r){let V=0;!l&&!c||c&&!l&&u?V=Bf(w+R*S+T,r[1][0])/S:V=Ff(w+(c?E:-E)*S+T,r[0][0])/S,P=Math.max(P,V)}if(a){let V=0;!l&&!c||c&&!l&&u?V=Ff(w+R*S,a[1][0])/S:V=Bf(w+(c?E:-E)*S,a[0][0])/S,P=Math.max(P,V)}}}E=E+(E<0?P:-P),L=L+(L<0?N:-N),n&&(u?M>R*S?E=(_G(l,c)?-L:L)/S:L=(_G(l,c)?-E:E)*S:d?(E=L/S,c=l):(L=E*S,l=c));const W=l?w+L:w,H=c?C+E:C;return{width:y+(l?-L:L),height:x+(c?-E:E),x:o[0]*L*(l?-1:1)+W,y:o[1]*E*(c?-1:1)+H}}const Une={width:0,height:0,x:0,y:0},vxe={...Une,pointerX:0,pointerY:0,aspectRatio:1};function Cxe(s){return[[0,0],[s.measured.width,s.measured.height]]}function wxe(s,e,t){const i=e.position.x+s.position.x,n=e.position.y+s.position.y,o=s.measured.width??0,r=s.measured.height??0,a=t[0]*o,l=t[1]*r;return[[i-a,n-l],[i+o-a,n+r-l]]}function yxe({domNode:s,nodeId:e,getStoreItems:t,onChange:i,onEnd:n}){const o=bl(s);let r={controlDirection:pG("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:c,boundaries:d,keepAspectRatio:h,resizeDirection:u,onResizeStart:f,onResize:g,onResizeEnd:m,shouldResize:p}){let v={...Une},b={...vxe};r={boundaries:d,resizeDirection:u,keepAspectRatio:h,controlDirection:pG(c)};let w,C=null,y=[],x,S,L,E=!1;const M=ane().on("start",R=>{const{nodeLookup:T,transform:A,snapGrid:N,snapToGrid:P,nodeOrigin:W,paneDomNode:H}=t();if(w=T.get(e),!w)return;C=(H==null?void 0:H.getBoundingClientRect())??null;const{xSnapped:G,ySnapped:V}=WS(R.sourceEvent,{transform:A,snapGrid:N,snapToGrid:P,containerBounds:C});v={width:w.measured.width??0,height:w.measured.height??0,x:w.position.x??0,y:w.position.y??0},b={...v,pointerX:G,pointerY:V,aspectRatio:v.width/v.height},x=void 0,w.parentId&&(w.extent==="parent"||w.expandParent)&&(x=T.get(w.parentId),S=x&&w.extent==="parent"?Cxe(x):void 0),y=[],L=void 0;for(const[U,$]of T)if($.parentId===e&&(y.push({id:U,position:{...$.position},extent:$.extent}),$.extent==="parent"||$.expandParent)){const Y=wxe($,w,$.origin??W);L?L=[[Math.min(Y[0][0],L[0][0]),Math.min(Y[0][1],L[0][1])],[Math.max(Y[1][0],L[1][0]),Math.max(Y[1][1],L[1][1])]]:L=Y}f==null||f(R,{...v})}).on("drag",R=>{const{transform:T,snapGrid:A,snapToGrid:N,nodeOrigin:P}=t(),W=WS(R.sourceEvent,{transform:T,snapGrid:A,snapToGrid:N,containerBounds:C}),H=[];if(!w)return;const{x:G,y:V,width:U,height:$}=v,Y={},se=w.origin??P,{width:j,height:ie,x:te,y:pe}=bxe(b,r.controlDirection,W,r.boundaries,r.keepAspectRatio,se,S,L),J=j!==U,le=ie!==$,be=te!==G&&J,Ce=pe!==V&&le;if(!be&&!Ce&&!J&&!le)return;if((be||Ce||se[0]===1||se[1]===1)&&(Y.x=be?te:v.x,Y.y=Ce?pe:v.y,v.x=Y.x,v.y=Y.y,y.length>0)){const Ke=te-G,nt=pe-V;for(const ft of y)ft.position={x:ft.position.x-Ke+se[0]*(j-U),y:ft.position.y-nt+se[1]*(ie-$)},H.push(ft)}if((J||le)&&(Y.width=J&&(!r.resizeDirection||r.resizeDirection==="horizontal")?j:v.width,Y.height=le&&(!r.resizeDirection||r.resizeDirection==="vertical")?ie:v.height,v.width=Y.width,v.height=Y.height),x&&w.expandParent){const Ke=se[0]*(Y.width??0);Y.x&&Y.x<Ke&&(v.x=Ke,b.x=b.x-(Y.x-Ke));const nt=se[1]*(Y.height??0);Y.y&&Y.y<nt&&(v.y=nt,b.y=b.y-(Y.y-nt))}const Je=_xe({width:v.width,prevWidth:U,height:v.height,prevHeight:$,affectsX:r.controlDirection.affectsX,affectsY:r.controlDirection.affectsY}),qe={...v,direction:Je};(p==null?void 0:p(R,qe))!==!1&&(E=!0,g==null||g(R,qe),i(Y,H))}).on("end",R=>{E&&(m==null||m(R,{...v}),n==null||n({...v}),E=!1)});o.call(M)}function l(){o.on(".drag",null)}return{update:a,destroy:l}}function sU(){const s={};return[e=>{if(e&&!Nie(s))throw new Error(e);return wb(s)},e=>ey(s,e)]}const[$ne,Sxe]=sU(),[xxe,Lxe]=sU(),[Ixe,Exe]=sU();var kxe=Re("<div><!></div>");function Ib(s,e){Lt(e,!0);let t=Ae(e,"id",3,null),i=Ae(e,"type",3,"source"),n=Ae(e,"position",19,()=>Ci.Top),o=Ae(e,"isConnectableStart",3,!0),r=Ae(e,"isConnectableEnd",3,!0),a=vn(e,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const l=$ne("Handle must be used within a Custom Node component"),c=xxe("Handle must be used within a Custom Node component");let d=X(()=>i()==="target"),h=X(()=>e.isConnectable!==void 0?e.isConnectable:c.value),u=Em(),f=X(()=>u.ariaLabelConfig),g=null;Bz(()=>{if(e.onconnect||e.ondisconnect){u.edges;let T=u.connectionLookup.get(`${l}-${i()}${t()?`-${t()}`:""}`);if(g&&!mSe(T,g)){const A=T??new Map;nG(g,A,e.ondisconnect),nG(A,g,e.onconnect)}g=new Map(T)}});let m=X(()=>{if(!u.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:T,toHandle:A,isValid:N}=u.connection,P=T&&T.nodeId===l&&T.type===i()&&T.id===t(),W=A&&A.nodeId===l&&A.type===i()&&A.id===t(),H=u.connectionMode===dw.Strict?(T==null?void 0:T.type)!==i():l!==(T==null?void 0:T.nodeId)||t()!==(T==null?void 0:T.id);return[!0,P,W,H,W&&N]}),p=X(()=>YE(I(m),5)),v=X(()=>I(p)[0]),b=X(()=>I(p)[1]),w=X(()=>I(p)[2]),C=X(()=>I(p)[3]),y=X(()=>I(p)[4]);function x(T){var N;const A=u.onbeforeconnect?u.onbeforeconnect(T):T;A&&(u.addEdge(A),(N=u.onconnect)==null||N.call(u,T))}function S(T){const A=Nne(T);T.currentTarget&&(A&&T.button===0||!A)&&mG.onPointerDown(T,{handleId:t(),nodeId:l,isTarget:I(d),connectionRadius:u.connectionRadius,domNode:u.domNode,nodeLookup:u.nodeLookup,connectionMode:u.connectionMode,lib:"svelte",autoPanOnConnect:u.autoPanOnConnect,autoPanSpeed:u.autoPanSpeed,flowId:u.flowId,isValidConnection:e.isValidConnection??u.isValidConnection,updateConnection:u.updateConnection,cancelConnection:u.cancelConnection,panBy:u.panBy,onConnect:x,onConnectStart:(N,P)=>{var W;(W=u.onconnectstart)==null||W.call(u,N,{nodeId:P.nodeId,handleId:P.handleId,handleType:P.handleType})},onConnectEnd:(N,P)=>{var W;(W=u.onconnectend)==null||W.call(u,N,P)},getTransform:()=>[u.viewport.x,u.viewport.y,u.viewport.zoom],getFromHandle:()=>u.connection.fromHandle,dragThreshold:u.connectionDragThreshold,handleDomNode:T.currentTarget})}function L(T){var Y,se;if(!l||!u.clickConnectStartHandle&&!o())return;if(!u.clickConnectStartHandle){(Y=u.onclickconnectstart)==null||Y.call(u,T,{nodeId:l,handleId:t(),handleType:i()}),u.clickConnectStartHandle={nodeId:l,type:i(),id:t()};return}const A=Dne(T.target),N=e.isValidConnection??u.isValidConnection,{connectionMode:P,clickConnectStartHandle:W,flowId:H,nodeLookup:G}=u,{connection:V,isValid:U}=mG.isValid(T,{handle:{nodeId:l,id:t(),type:i()},connectionMode:P,fromNodeId:W.nodeId,fromHandleId:W.id??null,fromType:W.type,isValidConnection:N,flowId:H,doc:A,lib:"svelte",nodeLookup:G});U&&V&&x(V);const $=structuredClone(zz(u.connection));delete $.inProgress,$.toPosition=$.toHandle?$.toHandle.position:null,(se=u.onclickconnectend)==null||se.call(u,T,$),u.clickConnectStartHandle=null}var E=kxe(),M=()=>{};vc(E,()=>({"data-handleid":t(),"data-nodeid":l,"data-handlepos":n(),"data-id":`${u.flowId??""}-${l??""}-${t()??"null"??""}-${i()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${n()}`,u.noDragClass,u.noPanClass,n(),e.class],onmousedown:S,ontouchstart:S,onclick:u.clickConnect?L:void 0,onkeypress:M,style:e.style,role:"button","aria-label":I(f)["handle.ariaLabel"],tabindex:"-1",...a,[Vz]:{valid:I(y),connectingto:I(w),connectingfrom:I(b),source:!I(d),target:I(d),connectablestart:o(),connectableend:r(),connectable:I(h),connectionindicator:I(h)&&(!I(v)||I(C))&&(I(v)||u.clickConnectStartHandle?r():o())}}));var R=Ee(E);Hi(R,()=>e.children??jn),Ie(E),Q(s,E),It()}var Dxe=Re("<!> <!>",1);function qne(s,e){Lt(e,!0);let t=Ae(e,"targetPosition",19,()=>Ci.Top),i=Ae(e,"sourcePosition",19,()=>Ci.Bottom);var n=Dxe(),o=De(n);Ib(o,{type:"target",get position(){return t()}});var r=ue(o),a=ue(r);Ib(a,{type:"source",get position(){return i()}}),ze(()=>{var l;return tt(r,` ${((l=e.data)==null?void 0:l.label)??""} `)}),Q(s,n),It()}var Txe=Re(" <!>",1);function Nxe(s,e){Lt(e,!0);let t=Ae(e,"data",19,()=>({label:"Node"})),i=Ae(e,"sourcePosition",19,()=>Ci.Bottom);Oi();var n=Txe(),o=De(n),r=ue(o);Ib(r,{type:"source",get position(){return i()}}),ze(()=>{var a;return tt(o,`${((a=t())==null?void 0:a.label)??""} `)}),Q(s,n),It()}var Rxe=Re(" <!>",1);function Mxe(s,e){Lt(e,!0);let t=Ae(e,"data",19,()=>({label:"Node"})),i=Ae(e,"targetPosition",19,()=>Ci.Top);Oi();var n=Rxe(),o=De(n),r=ue(o);Ib(r,{type:"target",get position(){return i()}}),ze(()=>{var a;return tt(o,`${((a=t())==null?void 0:a.label)??""} `)}),Q(s,n),It()}function Axe(s,e){}function _5(s,e,t){if(!t||!e)return;const i=t==="root"?e:e.querySelector(`.svelte-flow__${t}`);i&&i.appendChild(s)}function b5(s,e){const t=X(Em),i=X(()=>I(t).domNode);let n;return I(i)?_5(s,I(i),e):n=Rie(()=>{Br(()=>{_5(s,I(i),e),n==null||n()})}),{async update(o){_5(s,I(i),o)},destroy(){s.parentNode&&s.parentNode.removeChild(s),n==null||n()}}}function Pxe(){let s=At(typeof window>"u");if(I(s)){const e=Rie(()=>{Br(()=>{Le(s,!1),e==null||e()})})}return{get value(){return I(s)}}}const bG=s=>_Se(s),Oxe=s=>xne(s);function wh(s){return s===void 0?void 0:`${s}px`}const MN={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Fxe=Re("<div><!></div>");function oU(s,e){Lt(e,!0);let t=Ae(e,"x",3,0),i=Ae(e,"y",3,0),n=Ae(e,"selectEdgeOnClick",3,!1),o=Ae(e,"transparent",3,!1),r=vn(e,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const a=Em(),l=Ixe("EdgeLabel must be used within a Custom Edge component");let c=X(()=>{var f;return(f=a.visible.edges.get(l))==null?void 0:f.zIndex});var d=Fxe(),h=()=>{n()&&l&&a.handleEdgeSelection(l)};vc(d,f=>({class:["svelte-flow__edge-label",{transparent:o()},e.class],tabindex:"-1",onclick:h,...r,[XE]:f}),[()=>({display:Pxe().value?"none":void 0,cursor:n()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${t()??""}px,${i()??""}px)`,"pointer-events":"all",width:wh(e.width),height:wh(e.height),"z-index":I(c)})],void 0,void 0,"svelte-1wg91mu");var u=Ee(d);Hi(u,()=>e.children??jn),Ie(d),Aa(d,(f,g)=>b5==null?void 0:b5(f,g),()=>"edge-labels"),Q(s,d),It()}var Bxe=fs("<path></path>"),Wxe=fs('<path fill="none"></path><!><!>',1);function Yy(s,e){let t=Ae(e,"interactionWidth",3,20),i=vn(e,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var n=Wxe(),o=De(n),r=ue(o);{var a=d=>{var h=Bxe();vc(h,()=>({d:e.path,"stroke-opacity":0,"stroke-width":t(),fill:"none",class:"svelte-flow__edge-interaction",...i})),Q(d,h)};St(r,d=>{t()>0&&d(a)})}var l=ue(r);{var c=d=>{oU(d,{get x(){return e.labelX},get y(){return e.labelY},get style(){return e.labelStyle},selectEdgeOnClick:!0,children:(h,u)=>{Oi();var f=pn();ze(()=>tt(f,e.label)),Q(h,f)},$$slots:{default:!0}})};St(l,d=>{e.label&&d(c)})}ze(()=>{Xt(o,"id",e.id),Xt(o,"d",e.path),Qn(o,0,jo(["svelte-flow__edge-path",e.class])),Xt(o,"marker-start",e.markerStart),Xt(o,"marker-end",e.markerEnd),El(o,e.style)}),Q(s,n)}function jne(s,e){Lt(e,!0);let t=X(()=>{var a;return cO({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,curvature:(a=e.pathOptions)==null?void 0:a.curvature})}),i=X(()=>YE(I(t),3)),n=X(()=>I(i)[0]),o=X(()=>I(i)[1]),r=X(()=>I(i)[2]);Yy(s,{get id(){return e.id},get path(){return I(n)},get labelX(){return I(o)},get labelY(){return I(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),It()}function Hxe(s,e){Lt(e,!0);let t=X(()=>Jz({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition})),i=X(()=>YE(I(t),3)),n=X(()=>I(i)[0]),o=X(()=>I(i)[1]),r=X(()=>I(i)[2]);Yy(s,{get path(){return I(n)},get labelX(){return I(o)},get labelY(){return I(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),It()}function Vxe(s,e){Lt(e,!0);let t=X(()=>Mne({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY})),i=X(()=>YE(I(t),3)),n=X(()=>I(i)[0]),o=X(()=>I(i)[1]),r=X(()=>I(i)[2]);Yy(s,{get path(){return I(n)},get labelX(){return I(o)},get labelY(){return I(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),It()}function zxe(s,e){Lt(e,!0);let t=X(()=>Jz({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,borderRadius:0})),i=X(()=>YE(I(t),3)),n=X(()=>I(i)[0]),o=X(()=>I(i)[1]),r=X(()=>I(i)[2]);Yy(s,{get path(){return I(n)},get labelX(){return I(o)},get labelY(){return I(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),It()}function Uxe(s,e,t,i){const n=new Map;return Zz(s,{x:0,y:0,width:t,height:i},e,!0).forEach(o=>{n.set(o.id,o)}),n}function vG(s){const{edges:e,defaultEdgeOptions:t,nodeLookup:i,previousEdges:n,connectionMode:o,onerror:r,onlyRenderVisible:a,elevateEdgesOnSelect:l,zIndexMode:c}=s,d=new Map;for(const h of e){const u=i.get(h.source),f=i.get(h.target);if(!u||!f)continue;if(a){const{visibleNodes:p,transform:v,width:b,height:w}=s;if(MSe({sourceNode:u,targetNode:f,width:b,height:w,transform:v}))p.set(u.id,u),p.set(f.id,f);else continue}const g=n.get(h.id);if(g&&h===g.edge&&u==g.sourceNode&&f==g.targetNode){d.set(h.id,g);continue}const m=HSe({id:h.id,sourceNode:u,targetNode:f,sourceHandle:h.sourceHandle||null,targetHandle:h.targetHandle||null,connectionMode:o,onError:r});m&&d.set(h.id,{...t,...h,...m,zIndex:RSe({selected:h.selected,zIndex:h.zIndex??t.zIndex,sourceNode:u,targetNode:f,elevateOnSelect:l,zIndexMode:c}),sourceNode:u,targetNode:f,edge:h})}return d}const Kne={input:Nxe,output:Mxe,default:qne,group:Axe},Gne={straight:Vxe,smoothstep:Hxe,default:jne,step:zxe};function $xe(s,e,t,i,n,o){if(e&&!t&&i&&n){const r=rO(o,{filter:a=>!!((a.width||a.initialWidth)&&(a.height||a.initialHeight))});return Qz(r,i,n,.5,2,.1)}else return t??{x:0,y:0,zoom:1}}function qxe(s){var t,i,n,o,r,a,l,c,d,h,u,f,g,m,p,v,b,w,C,y,x,S,L,E,M,R,T,A,N,P,W,H,G,V,U,$,Y,se,j,ie,te,pe,J,le,be,Ce,Je,qe,mt,Ke,nt,ft,Pe,Be,Me,rt,Et,qt,Ge,at,yt,Jt,li,Vi,jt,Mi,ni,yn,pi,ci,Ai,Li,Yi,oi,$i,Ri;class e{constructor(){ke(this,t,X(()=>s.props.id??"1"));ke(this,i,At(null));ke(this,n,At(null));ke(this,o,At(s.width??0));ke(this,r,At(s.height??0));ke(this,a,At(s.props.zIndexMode??"basic"));ke(this,l,X(()=>{var _i;const fe=jSe(s.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:s.props.elevateNodesOnSelect??!0,checkEquality:!0,zIndexMode:this.zIndexMode});return this.fitViewQueued&&fe&&((_i=this.fitViewOptions)!=null&&_i.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),fe}));ke(this,c,X(()=>this.panZoom!==null));ke(this,d,X(()=>(QSe(this.connectionLookup,this.edgeLookup,s.edges),s.edges)));pt(this,"_prevSelectedNodes",[]);pt(this,"_prevSelectedNodeIds",new Set);ke(this,h,X(()=>{const fe=this._prevSelectedNodeIds.size,_i=new Set,Ii=this.nodes.filter(Xi=>(Xi.selected&&(_i.add(Xi.id),this._prevSelectedNodeIds.delete(Xi.id)),Xi.selected));return(fe!==_i.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=Ii),this._prevSelectedNodeIds=_i,this._prevSelectedNodes}));pt(this,"_prevSelectedEdges",[]);pt(this,"_prevSelectedEdgeIds",new Set);ke(this,u,X(()=>{const fe=this._prevSelectedEdgeIds.size,_i=new Set,Ii=this.edges.filter(Xi=>(Xi.selected&&(_i.add(Xi.id),this._prevSelectedEdgeIds.delete(Xi.id)),Xi.selected));return(fe!==_i.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=Ii),this._prevSelectedEdgeIds=_i,this._prevSelectedEdges}));pt(this,"selectionChangeHandlers",new Map);pt(this,"nodeLookup",new Map);pt(this,"parentLookup",new Map);pt(this,"connectionLookup",new Map);pt(this,"edgeLookup",new Map);pt(this,"_prevVisibleEdges",new Map);ke(this,f,X(()=>{const{nodes:fe,_edges:_i,_prevVisibleEdges:Ii,nodeLookup:Xi,connectionMode:Es,onerror:Ys,onlyRenderVisibleElements:Bs,defaultEdgeOptions:Ca,zIndexMode:Xs}=this;let Lo,Ws;const Hs={edges:_i,defaultEdgeOptions:Ca,previousEdges:Ii,nodeLookup:Xi,connectionMode:Es,elevateEdgesOnSelect:s.props.elevateEdgesOnSelect??!0,zIndexMode:Xs,onerror:Ys};if(Bs){const{viewport:xc,width:wd,height:yd}=this,Of=[xc.x,xc.y,xc.zoom];Lo=Uxe(Xi,Of,wd,yd),Ws=vG({...Hs,onlyRenderVisible:!0,visibleNodes:Lo,transform:Of,width:wd,height:yd})}else Lo=this.nodeLookup,Ws=vG(Hs);return{nodes:Lo,edges:Ws}}));ke(this,g,X(()=>s.props.nodesDraggable??!0));ke(this,m,X(()=>s.props.nodesConnectable??!0));ke(this,p,X(()=>s.props.elementsSelectable??!0));ke(this,v,X(()=>s.props.nodesFocusable??!0));ke(this,b,X(()=>s.props.edgesFocusable??!0));ke(this,w,X(()=>s.props.disableKeyboardA11y??!1));ke(this,C,X(()=>s.props.minZoom??.5));ke(this,y,X(()=>s.props.maxZoom??2));ke(this,x,X(()=>s.props.nodeOrigin??[0,0]));ke(this,S,X(()=>s.props.nodeExtent??d9));ke(this,L,X(()=>s.props.translateExtent??d9));ke(this,E,X(()=>s.props.defaultEdgeOptions??{}));ke(this,M,X(()=>s.props.nodeDragThreshold??1));ke(this,R,X(()=>s.props.autoPanOnNodeDrag??!0));ke(this,T,X(()=>s.props.autoPanOnConnect??!0));ke(this,A,X(()=>s.props.autoPanOnNodeFocus??!0));ke(this,N,X(()=>s.props.autoPanSpeed??15));ke(this,P,X(()=>s.props.connectionDragThreshold??1));pt(this,"fitViewQueued",s.props.fitView??!1);pt(this,"fitViewOptions",s.props.fitViewOptions);pt(this,"fitViewResolver",null);ke(this,W,X(()=>s.props.snapGrid??null));ke(this,H,At(!1));ke(this,G,At(null));ke(this,V,At(!1));ke(this,U,At(!1));ke(this,$,At(!1));ke(this,Y,At(!1));ke(this,se,At(!1));ke(this,j,At(null));ke(this,ie,At(""));ke(this,te,X(()=>s.props.selectionMode??DN.Partial));ke(this,pe,X(()=>({...Kne,...s.props.nodeTypes})));ke(this,J,X(()=>({...Gne,...s.props.edgeTypes})));ke(this,le,X(()=>s.props.noPanClass??"nopan"));ke(this,be,X(()=>s.props.noDragClass??"nodrag"));ke(this,Ce,X(()=>s.props.noWheelClass??"nowheel"));ke(this,Je,X(()=>DSe(s.props.ariaLabelConfig)));ke(this,qe,At($xe(this.nodesInitialized,s.props.fitView,s.props.initialViewport,this.width,this.height,this.nodeLookup)));ke(this,mt,At(h9));ke(this,Ke,X(()=>this._connection.inProgress?{...this._connection,to:tk(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection));ke(this,nt,X(()=>s.props.connectionMode??dw.Strict));ke(this,ft,X(()=>s.props.connectionRadius??20));ke(this,Pe,X(()=>s.props.isValidConnection??(()=>!0)));ke(this,Be,X(()=>s.props.selectNodesOnDrag??!0));ke(this,Me,X(()=>s.props.defaultMarkerColor===void 0?"#b1b1b7":s.props.defaultMarkerColor));ke(this,rt,X(()=>VSe(s.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd})));ke(this,Et,X(()=>s.props.onlyRenderVisibleElements??!1));ke(this,qt,X(()=>s.props.onflowerror??xSe));ke(this,Ge,X(()=>s.props.ondelete));ke(this,at,X(()=>s.props.onbeforedelete));ke(this,yt,X(()=>s.props.onbeforeconnect));ke(this,Jt,X(()=>s.props.onconnect));ke(this,li,X(()=>s.props.onconnectstart));ke(this,Vi,X(()=>s.props.onconnectend));ke(this,jt,X(()=>s.props.onbeforereconnect));ke(this,Mi,X(()=>s.props.onreconnect));ke(this,ni,X(()=>s.props.onreconnectstart));ke(this,yn,X(()=>s.props.onreconnectend));ke(this,pi,X(()=>s.props.clickConnect??!0));ke(this,ci,X(()=>s.props.onclickconnectstart));ke(this,Ai,X(()=>s.props.onclickconnectend));ke(this,Li,At(null));ke(this,Yi,X(()=>s.props.onselectiondrag));ke(this,oi,X(()=>s.props.onselectiondragstart));ke(this,$i,X(()=>s.props.onselectiondragstop));pt(this,"resolveFitView",async()=>{var fe;this.panZoom&&(await wSe({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),(fe=this.fitViewResolver)==null||fe.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)});pt(this,"_prefersDark",new Mge("(prefers-color-scheme: dark)",s.props.colorModeSSR==="dark"));ke(this,Ri,X(()=>s.props.colorMode==="system"?this._prefersDark.current?"dark":"light":s.props.colorMode??"light"))}get flowId(){return I(Z(this,t))}set flowId(fe){Le(Z(this,t),fe)}get domNode(){return I(Z(this,i))}set domNode(fe){Le(Z(this,i),fe)}get panZoom(){return I(Z(this,n))}set panZoom(fe){Le(Z(this,n),fe)}get width(){return I(Z(this,o))}set width(fe){Le(Z(this,o),fe)}get height(){return I(Z(this,r))}set height(fe){Le(Z(this,r),fe)}get zIndexMode(){return I(Z(this,a))}set zIndexMode(fe){Le(Z(this,a),fe)}get nodesInitialized(){return I(Z(this,l))}set nodesInitialized(fe){Le(Z(this,l),fe)}get viewportInitialized(){return I(Z(this,c))}set viewportInitialized(fe){Le(Z(this,c),fe)}get _edges(){return I(Z(this,d))}set _edges(fe){Le(Z(this,d),fe)}get nodes(){return this.nodesInitialized,s.nodes}set nodes(fe){s.nodes=fe}get edges(){return this._edges}set edges(fe){s.edges=fe}get selectedNodes(){return I(Z(this,h))}set selectedNodes(fe){Le(Z(this,h),fe)}get selectedEdges(){return I(Z(this,u))}set selectedEdges(fe){Le(Z(this,u),fe)}get visible(){return I(Z(this,f))}set visible(fe){Le(Z(this,f),fe)}get nodesDraggable(){return I(Z(this,g))}set nodesDraggable(fe){Le(Z(this,g),fe)}get nodesConnectable(){return I(Z(this,m))}set nodesConnectable(fe){Le(Z(this,m),fe)}get elementsSelectable(){return I(Z(this,p))}set elementsSelectable(fe){Le(Z(this,p),fe)}get nodesFocusable(){return I(Z(this,v))}set nodesFocusable(fe){Le(Z(this,v),fe)}get edgesFocusable(){return I(Z(this,b))}set edgesFocusable(fe){Le(Z(this,b),fe)}get disableKeyboardA11y(){return I(Z(this,w))}set disableKeyboardA11y(fe){Le(Z(this,w),fe)}get minZoom(){return I(Z(this,C))}set minZoom(fe){Le(Z(this,C),fe)}get maxZoom(){return I(Z(this,y))}set maxZoom(fe){Le(Z(this,y),fe)}get nodeOrigin(){return I(Z(this,x))}set nodeOrigin(fe){Le(Z(this,x),fe)}get nodeExtent(){return I(Z(this,S))}set nodeExtent(fe){Le(Z(this,S),fe)}get translateExtent(){return I(Z(this,L))}set translateExtent(fe){Le(Z(this,L),fe)}get defaultEdgeOptions(){return I(Z(this,E))}set defaultEdgeOptions(fe){Le(Z(this,E),fe)}get nodeDragThreshold(){return I(Z(this,M))}set nodeDragThreshold(fe){Le(Z(this,M),fe)}get autoPanOnNodeDrag(){return I(Z(this,R))}set autoPanOnNodeDrag(fe){Le(Z(this,R),fe)}get autoPanOnConnect(){return I(Z(this,T))}set autoPanOnConnect(fe){Le(Z(this,T),fe)}get autoPanOnNodeFocus(){return I(Z(this,A))}set autoPanOnNodeFocus(fe){Le(Z(this,A),fe)}get autoPanSpeed(){return I(Z(this,N))}set autoPanSpeed(fe){Le(Z(this,N),fe)}get connectionDragThreshold(){return I(Z(this,P))}set connectionDragThreshold(fe){Le(Z(this,P),fe)}get snapGrid(){return I(Z(this,W))}set snapGrid(fe){Le(Z(this,W),fe)}get dragging(){return I(Z(this,H))}set dragging(fe){Le(Z(this,H),fe)}get selectionRect(){return I(Z(this,G))}set selectionRect(fe){Le(Z(this,G),fe)}get selectionKeyPressed(){return I(Z(this,V))}set selectionKeyPressed(fe){Le(Z(this,V),fe)}get multiselectionKeyPressed(){return I(Z(this,U))}set multiselectionKeyPressed(fe){Le(Z(this,U),fe)}get deleteKeyPressed(){return I(Z(this,$))}set deleteKeyPressed(fe){Le(Z(this,$),fe)}get panActivationKeyPressed(){return I(Z(this,Y))}set panActivationKeyPressed(fe){Le(Z(this,Y),fe)}get zoomActivationKeyPressed(){return I(Z(this,se))}set zoomActivationKeyPressed(fe){Le(Z(this,se),fe)}get selectionRectMode(){return I(Z(this,j))}set selectionRectMode(fe){Le(Z(this,j),fe)}get ariaLiveMessage(){return I(Z(this,ie))}set ariaLiveMessage(fe){Le(Z(this,ie),fe)}get selectionMode(){return I(Z(this,te))}set selectionMode(fe){Le(Z(this,te),fe)}get nodeTypes(){return I(Z(this,pe))}set nodeTypes(fe){Le(Z(this,pe),fe)}get edgeTypes(){return I(Z(this,J))}set edgeTypes(fe){Le(Z(this,J),fe)}get noPanClass(){return I(Z(this,le))}set noPanClass(fe){Le(Z(this,le),fe)}get noDragClass(){return I(Z(this,be))}set noDragClass(fe){Le(Z(this,be),fe)}get noWheelClass(){return I(Z(this,Ce))}set noWheelClass(fe){Le(Z(this,Ce),fe)}get ariaLabelConfig(){return I(Z(this,Je))}set ariaLabelConfig(fe){Le(Z(this,Je),fe)}get _viewport(){return I(Z(this,qe))}set _viewport(fe){Le(Z(this,qe),fe)}get viewport(){return s.viewport??this._viewport}set viewport(fe){s.viewport&&(s.viewport=fe),this._viewport=fe}get _connection(){return I(Z(this,mt))}set _connection(fe){Le(Z(this,mt),fe)}get connection(){return I(Z(this,Ke))}set connection(fe){Le(Z(this,Ke),fe)}get connectionMode(){return I(Z(this,nt))}set connectionMode(fe){Le(Z(this,nt),fe)}get connectionRadius(){return I(Z(this,ft))}set connectionRadius(fe){Le(Z(this,ft),fe)}get isValidConnection(){return I(Z(this,Pe))}set isValidConnection(fe){Le(Z(this,Pe),fe)}get selectNodesOnDrag(){return I(Z(this,Be))}set selectNodesOnDrag(fe){Le(Z(this,Be),fe)}get defaultMarkerColor(){return I(Z(this,Me))}set defaultMarkerColor(fe){Le(Z(this,Me),fe)}get markers(){return I(Z(this,rt))}set markers(fe){Le(Z(this,rt),fe)}get onlyRenderVisibleElements(){return I(Z(this,Et))}set onlyRenderVisibleElements(fe){Le(Z(this,Et),fe)}get onerror(){return I(Z(this,qt))}set onerror(fe){Le(Z(this,qt),fe)}get ondelete(){return I(Z(this,Ge))}set ondelete(fe){Le(Z(this,Ge),fe)}get onbeforedelete(){return I(Z(this,at))}set onbeforedelete(fe){Le(Z(this,at),fe)}get onbeforeconnect(){return I(Z(this,yt))}set onbeforeconnect(fe){Le(Z(this,yt),fe)}get onconnect(){return I(Z(this,Jt))}set onconnect(fe){Le(Z(this,Jt),fe)}get onconnectstart(){return I(Z(this,li))}set onconnectstart(fe){Le(Z(this,li),fe)}get onconnectend(){return I(Z(this,Vi))}set onconnectend(fe){Le(Z(this,Vi),fe)}get onbeforereconnect(){return I(Z(this,jt))}set onbeforereconnect(fe){Le(Z(this,jt),fe)}get onreconnect(){return I(Z(this,Mi))}set onreconnect(fe){Le(Z(this,Mi),fe)}get onreconnectstart(){return I(Z(this,ni))}set onreconnectstart(fe){Le(Z(this,ni),fe)}get onreconnectend(){return I(Z(this,yn))}set onreconnectend(fe){Le(Z(this,yn),fe)}get clickConnect(){return I(Z(this,pi))}set clickConnect(fe){Le(Z(this,pi),fe)}get onclickconnectstart(){return I(Z(this,ci))}set onclickconnectstart(fe){Le(Z(this,ci),fe)}get onclickconnectend(){return I(Z(this,Ai))}set onclickconnectend(fe){Le(Z(this,Ai),fe)}get clickConnectStartHandle(){return I(Z(this,Li))}set clickConnectStartHandle(fe){Le(Z(this,Li),fe)}get onselectiondrag(){return I(Z(this,Yi))}set onselectiondrag(fe){Le(Z(this,Yi),fe)}get onselectiondragstart(){return I(Z(this,oi))}set onselectiondragstart(fe){Le(Z(this,oi),fe)}get onselectiondragstop(){return I(Z(this,$i))}set onselectiondragstop(fe){Le(Z(this,$i),fe)}get colorMode(){return I(Z(this,Ri))}set colorMode(fe){Le(Z(this,Ri),fe)}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=h9,this.clickConnectStartHandle=null,this.viewport=s.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}return t=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,u=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,p=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,C=new WeakMap,y=new WeakMap,x=new WeakMap,S=new WeakMap,L=new WeakMap,E=new WeakMap,M=new WeakMap,R=new WeakMap,T=new WeakMap,A=new WeakMap,N=new WeakMap,P=new WeakMap,W=new WeakMap,H=new WeakMap,G=new WeakMap,V=new WeakMap,U=new WeakMap,$=new WeakMap,Y=new WeakMap,se=new WeakMap,j=new WeakMap,ie=new WeakMap,te=new WeakMap,pe=new WeakMap,J=new WeakMap,le=new WeakMap,be=new WeakMap,Ce=new WeakMap,Je=new WeakMap,qe=new WeakMap,mt=new WeakMap,Ke=new WeakMap,nt=new WeakMap,ft=new WeakMap,Pe=new WeakMap,Be=new WeakMap,Me=new WeakMap,rt=new WeakMap,Et=new WeakMap,qt=new WeakMap,Ge=new WeakMap,at=new WeakMap,yt=new WeakMap,Jt=new WeakMap,li=new WeakMap,Vi=new WeakMap,jt=new WeakMap,Mi=new WeakMap,ni=new WeakMap,yn=new WeakMap,pi=new WeakMap,ci=new WeakMap,Ai=new WeakMap,Li=new WeakMap,Yi=new WeakMap,oi=new WeakMap,$i=new WeakMap,Ri=new WeakMap,new e}function Em(){const s=wb(AN);if(!s)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return s.getStore()}const AN=Symbol();function Yne(s){const e=qxe(s);function t(R){e.nodeTypes={...Kne,...R}}function i(R){e.edgeTypes={...Gne,...R}}function n(R){e.edges=OSe(R,e.edges)}const o=(R,T=!1)=>{e.nodes=e.nodes.map(A=>{if(e.connection.inProgress&&e.connection.fromNode.id===A.id){const P=e.nodeLookup.get(A.id);P&&(e.connection={...e.connection,from:Lb(P,e.connection.fromHandle,Ci.Left,!0)})}const N=R.get(A.id);return N?{...A,position:N.position,dragging:T}:A})};function r(R){var P,W,H;const{changes:T,updatedInternals:A}=XSe(R,e.nodeLookup,e.parentLookup,e.domNode,e.nodeOrigin,e.nodeExtent,e.zIndexMode);if(!A)return;$Se(e.nodeLookup,e.parentLookup,{nodeOrigin:e.nodeOrigin,nodeExtent:e.nodeExtent,zIndexMode:e.zIndexMode}),e.fitViewQueued&&e.resolveFitView();const N=new Map;for(const G of T){const V=(P=e.nodeLookup.get(G.id))==null?void 0:P.internals.userNode;if(!V)continue;const U={...V};switch(G.type){case"dimensions":{const $={...U.measured,...G.dimensions};G.setAttributes&&(U.width=((W=G.dimensions)==null?void 0:W.width)??U.width,U.height=((H=G.dimensions)==null?void 0:H.height)??U.height),U.measured=$;break}case"position":U.position=G.position??U.position;break}N.set(G.id,U)}e.nodes=e.nodes.map(G=>N.get(G.id)??G)}function a(R){const T=e.fitViewResolver??Promise.withResolvers();return e.fitViewQueued=!0,e.fitViewOptions=R,e.fitViewResolver=T,e.nodes=[...e.nodes],T.promise}async function l(R,T,A){const N=typeof(A==null?void 0:A.zoom)<"u"?A.zoom:e.maxZoom,P=e.panZoom;return P?(await P.setViewport({x:e.width/2-R*N,y:e.height/2-T*N,zoom:N},{duration:A==null?void 0:A.duration,ease:A==null?void 0:A.ease,interpolate:A==null?void 0:A.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)}function c(R,T){const A=e.panZoom;return A?A.scaleBy(R,T):Promise.resolve(!1)}function d(R){return c(1.2,R)}function h(R){return c(1/1.2,R)}function u(R){const T=e.panZoom;T&&(T.setScaleExtent([R,e.maxZoom]),e.minZoom=R)}function f(R){const T=e.panZoom;T&&(T.setScaleExtent([e.minZoom,R]),e.maxZoom=R)}function g(R){const T=e.panZoom;T&&(T.setTranslateExtent(R),e.translateExtent=R)}function m(R,T=null){let A=!1;const N=R.map(P=>(T?T.has(P.id):!0)&&P.selected?(A=!0,{...P,selected:!1}):P);return[A,N]}function p(R){const T=R!=null&&R.nodes?new Set(R.nodes.map(G=>G.id)):null,[A,N]=m(e.nodes,T);A&&(e.nodes=N);const P=R!=null&&R.edges?new Set(R.edges.map(G=>G.id)):null,[W,H]=m(e.edges,P);W&&(e.edges=H)}function v(R){const T=e.multiselectionKeyPressed;e.nodes=e.nodes.map(A=>{const N=R.includes(A.id),P=T&&A.selected||N;return!!A.selected!==P?{...A,selected:P}:A}),T||p({nodes:[]})}function b(R){const T=e.multiselectionKeyPressed;e.edges=e.edges.map(A=>{const N=R.includes(A.id),P=T&&A.selected||N;return!!A.selected!==P?{...A,selected:P}:A}),T||p({edges:[]})}function w(R,T,A){const N=e.nodeLookup.get(R);if(!N){console.warn("012",lL.error012(R));return}e.selectionRect=null,e.selectionRectMode=null,N.selected?(T||N.selected&&e.multiselectionKeyPressed)&&(p({nodes:[N],edges:[]}),requestAnimationFrame(()=>A==null?void 0:A.blur())):v([R])}function C(R){const T=e.edgeLookup.get(R);if(!T){console.warn("012",lL.error012(R));return}(T.selectable||e.elementsSelectable&&typeof T.selectable>"u")&&(e.selectionRect=null,e.selectionRectMode=null,T.selected?T.selected&&e.multiselectionKeyPressed&&p({nodes:[],edges:[T]}):b([R]))}function y(R,T){const{nodeExtent:A,snapGrid:N,nodeOrigin:P,nodeLookup:W,nodesDraggable:H,onerror:G}=e,V=new Map,U=(N==null?void 0:N[0])??5,$=(N==null?void 0:N[1])??5,Y=R.x*U*T,se=R.y*$*T;for(const j of W.values()){if(!(j.selected&&(j.draggable||H&&typeof j.draggable>"u")))continue;let te={x:j.internals.positionAbsolute.x+Y,y:j.internals.positionAbsolute.y+se};N&&(te=ek(te,N));const{position:pe,positionAbsolute:J}=Lne({nodeId:j.id,nextPosition:te,nodeLookup:W,nodeExtent:A,nodeOrigin:P,onError:G});j.position=pe,j.internals.positionAbsolute=J,V.set(j.id,j)}o(V)}function x(R){return ZSe({delta:R,panZoom:e.panZoom,transform:[e.viewport.x,e.viewport.y,e.viewport.zoom],translateExtent:e.translateExtent,width:e.width,height:e.height})}const S=R=>{e._connection={...R}};function L(){e._connection=h9}function E(){e.resetStoreValues(),p()}return Object.assign(e,{setNodeTypes:t,setEdgeTypes:i,addEdge:n,updateNodePositions:o,updateNodeInternals:r,zoomIn:d,zoomOut:h,fitView:a,setCenter:l,setMinZoom:u,setMaxZoom:f,setTranslateExtent:g,unselectNodesAndEdges:p,addSelectedNodes:v,addSelectedEdges:b,handleNodeSelection:w,handleEdgeSelection:C,moveSelectedNodes:y,panBy:x,updateConnection:S,cancelConnection:L,reset:E})}function v5(s,e){const{minZoom:t,maxZoom:i,initialViewport:n,onPanZoomStart:o,onPanZoom:r,onPanZoomEnd:a,translateExtent:l,setPanZoomInstance:c,onDraggingChange:d,onTransformChange:h}=e,u=gxe({domNode:s,minZoom:t,maxZoom:i,translateExtent:l,viewport:n,onPanZoom:r,onPanZoomStart:o,onPanZoomEnd:a,onDraggingChange:d}),f=u.getViewport();return(n.x!==f.x||n.y!==f.y||n.zoom!==f.zoom)&&h([f.x,f.y,f.zoom]),c(u),u.update(e),{update(g){u.update(g)}}}var jxe=Re('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function Kxe(s,e){Lt(e,!0);let t=Ae(e,"store",15),i=X(()=>t().panActivationKeyPressed||e.panOnDrag),n=X(()=>t().panActivationKeyPressed||e.panOnScroll);const{viewport:o}=t();let r=!1;Br(()=>{var c;!r&&t().viewportInitialized&&((c=e.oninit)==null||c.call(e),r=!0)});var a=jxe(),l=Ee(a);Hi(l,()=>e.children),Ie(a),Aa(a,(c,d)=>v5==null?void 0:v5(c,d),()=>({viewport:t().viewport,minZoom:t().minZoom,maxZoom:t().maxZoom,initialViewport:o,onDraggingChange:c=>{t(t().dragging=c,!0)},setPanZoomInstance:c=>{t(t().panZoom=c,!0)},onPanZoomStart:e.onmovestart,onPanZoom:e.onmove,onPanZoomEnd:e.onmoveend,zoomOnScroll:e.zoomOnScroll,zoomOnDoubleClick:e.zoomOnDoubleClick,zoomOnPinch:e.zoomOnPinch,panOnScroll:I(n),panOnDrag:I(i),panOnScrollSpeed:e.panOnScrollSpeed,panOnScrollMode:e.panOnScrollMode,zoomActivationKeyPressed:t().zoomActivationKeyPressed,preventScrolling:typeof e.preventScrolling=="boolean"?e.preventScrolling:!0,noPanClassName:t().noPanClass,noWheelClassName:t().noWheelClass,userSelectionActive:!!t().selectionRect,translateExtent:t().translateExtent,lib:"svelte",paneClickDistance:e.paneClickDistance,selectionOnDrag:e.selectionOnDrag,onTransformChange:c=>{t(t().viewport={x:c[0],y:c[1],zoom:c[2]},!0)},connectionInProgress:t().connection.inProgress})),Q(s,a),It()}function CG(s,e){return t=>{t.target===e&&(s==null||s(t))}}function wG(s){return e=>{const t=s.has(e.id);return!!e.selected!==t?{...e,selected:t}:e}}function yG(s,e){if(s.size!==e.size)return!1;for(const t of s)if(!e.has(t))return!1;return!0}var Gxe=Re("<div><!></div>");function Yxe(s,e){Lt(e,!0);let t=Ae(e,"store",15),i=Ae(e,"panOnDrag",3,!0),n=Ae(e,"paneClickDistance",3,1),o,r=null,a=new Set,l=new Set,c=X(()=>t().panActivationKeyPressed||i()),d=X(()=>t().selectionKeyPressed||!!t().selectionRect||e.selectionOnDrag&&I(c)!==!0),h=X(()=>t().elementsSelectable&&(I(d)||t().selectionRectMode==="user")),u=!1;function f(L){var N,P;if(r=o==null?void 0:o.getBoundingClientRect(),!r)return;const E=L.target===o,M=!E&&!!L.target.closest(".nokey"),R=e.selectionOnDrag&&E||t().selectionKeyPressed;if(M||!I(d)||!R||L.button!==0||!L.isPrimary)return;(P=(N=L.target)==null?void 0:N.setPointerCapture)==null||P.call(N,L.pointerId),u=!1;const{x:T,y:A}=Qc(L,r);t(t().selectionRect={width:0,height:0,startX:T,startY:A,x:T,y:A},!0),E||(L.stopPropagation(),L.preventDefault())}function g(L){var W;if(!I(d)||!r||!t().selectionRect)return;const E=Qc(L,r),{startX:M=0,startY:R=0}=t().selectionRect;if(!u){const H=t().selectionKeyPressed?0:n();if(Math.hypot(E.x-M,E.y-R)<=H)return;t().unselectNodesAndEdges(),(W=e.onselectionstart)==null||W.call(e,L)}u=!0;const T={...t().selectionRect,x:E.x<M?E.x:M,y:E.y<R?E.y:R,width:Math.abs(E.x-M),height:Math.abs(E.y-R)},A=a,N=l;a=new Set(Zz(t().nodeLookup,T,[t().viewport.x,t().viewport.y,t().viewport.zoom],t().selectionMode===DN.Partial,!0).map(H=>H.id));const P=t().defaultEdgeOptions.selectable??!0;l=new Set;for(const H of a){const G=t().connectionLookup.get(H);if(G)for(const{edgeId:V}of G.values()){const U=t().edgeLookup.get(V);U&&(U.selectable??P)&&l.add(V)}}yG(A,a)||t(t().nodes=t().nodes.map(wG(a)),!0),yG(N,l)||t(t().edges=t().edges.map(wG(l)),!0),t(t().selectionRectMode="user",!0),t(t().selectionRect=T,!0)}function m(L){var E,M,R;L.button===0&&((M=(E=L.target)==null?void 0:E.releasePointerCapture)==null||M.call(E,L.pointerId),!u&&L.target===o&&(b==null||b(L)),t(t().selectionRect=null,!0),u&&t(t().selectionRectMode=a.size>0?"nodes":null,!0),u&&((R=e.onselectionend)==null||R.call(e,L)))}const p=L=>{var E;if(Array.isArray(I(c))&&I(c).includes(2)){L.preventDefault();return}(E=e.onpanecontextmenu)==null||E.call(e,{event:L})},v=L=>{u&&(L.stopPropagation(),u=!1)};function b(L){var E;if(u||t().connection.inProgress){u=!1;return}(E=e.onpaneclick)==null||E.call(e,{event:L}),t().unselectNodesAndEdges(),t(t().selectionRectMode=null,!0),t(t().selectionRect=null,!0)}var w=Gxe();let C;var y=X(()=>I(h)?void 0:CG(b,o));w.__click=function(...L){var E;(E=I(y))==null||E.apply(this,L)},w.__pointermove=function(...L){var E;(E=I(h)?g:void 0)==null||E.apply(this,L)},w.__pointerup=function(...L){var E;(E=I(h)?m:void 0)==null||E.apply(this,L)};var x=X(()=>CG(p,o));w.__contextmenu=function(...L){var E;(E=I(x))==null||E.apply(this,L)};var S=Ee(w);Hi(S,()=>e.children),Ie(w),If(w,L=>o=L,()=>o),ze(L=>C=Qn(w,1,"svelte-flow__pane svelte-flow__container",null,C,L),[()=>({draggable:i()===!0||Array.isArray(i())&&i().includes(0),dragging:t().dragging,selection:I(d)})]),ku("pointerdown",w,function(...L){var E;(E=I(h)?f:void 0)==null||E.apply(this,L)},!0),ku("click",w,function(...L){var E;(E=I(h)?v:void 0)==null||E.apply(this,L)},!0),Q(s,w),It()}dv(["click","pointermove","pointerup","contextmenu"]);var Xxe=Re('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function Zxe(s,e){Lt(e,!0);var t=Xxe();let i;var n=Ee(t);Hi(n,()=>e.children),Ie(t),ze(()=>i=El(t,"",i,{transform:`translate(${e.store.viewport.x??""}px, ${e.store.viewport.y??""}px) scale(${e.store.viewport.zoom??""})`})),Q(s,t),It()}function h1(s,e){const{store:t,onDrag:i,onDragStart:n,onDragStop:o,onNodeMouseDown:r}=e,a=txe({onDrag:i,onDragStart:n,onDragStop:o,onNodeMouseDown:r,getStoreItems:()=>{const{snapGrid:c,viewport:d}=t;return{nodes:t.nodes,nodeLookup:t.nodeLookup,edges:t.edges,nodeExtent:t.nodeExtent,snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:t.nodeOrigin,multiSelectionActive:t.multiselectionKeyPressed,domNode:t.domNode,transform:[d.x,d.y,d.zoom],autoPanOnNodeDrag:t.autoPanOnNodeDrag,nodesDraggable:t.nodesDraggable,selectNodesOnDrag:t.selectNodesOnDrag,nodeDragThreshold:t.nodeDragThreshold,unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,onSelectionDrag:t.onselectiondrag,onSelectionDragStart:t.onselectiondragstart,onSelectionDragStop:t.onselectiondragstop,panBy:t.panBy}}});function l(c,d){if(d.disabled){a.destroy();return}a.update({domNode:c,noDragClassName:d.noDragClass,handleSelector:d.handleSelector,nodeId:d.nodeId,isSelectable:d.isSelectable,nodeClickDistance:d.nodeClickDistance})}return l(s,e),{update(c){l(s,c)},destroy(){a.destroy()}}}var Qxe=Re('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-13pq11u"> </div>'),Jxe=Re('<div class="a11y-hidden svelte-13pq11u"> </div> <div class="a11y-hidden svelte-13pq11u"> </div> <!>',1);function eLe(s,e){Lt(e,!0);var t=Jxe(),i=De(t),n=Ee(i,!0);Ie(i);var o=ue(i,2),r=Ee(o,!0);Ie(o);var a=ue(o,2);{var l=c=>{var d=Qxe(),h=Ee(d,!0);Ie(d),ze(()=>{Xt(d,"id",`${tLe}-${e.store.flowId}`),tt(h,e.store.ariaLiveMessage)}),Q(c,d)};St(a,c=>{e.store.disableKeyboardA11y||c(l)})}ze(()=>{Xt(i,"id",`${Xne}-${e.store.flowId}`),tt(n,e.store.disableKeyboardA11y?e.store.ariaLabelConfig["node.a11yDescription.default"]:e.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),Xt(o,"id",`${Zne}-${e.store.flowId}`),tt(r,e.store.ariaLabelConfig["edge.a11yDescription.default"])}),Q(s,t),It()}const Xne="svelte-flow__node-desc",Zne="svelte-flow__edge-desc",tLe="svelte-flow__aria-live";var iLe=Re("<div><!></div>");function nLe(s,e){Lt(e,!0);let t=Ae(e,"store",15),i=X(()=>Xr(e.node.data,()=>({}),!0)),n=X(()=>Xr(e.node.selected,!1)),o=X(()=>e.node.draggable),r=X(()=>e.node.selectable),a=X(()=>Xr(e.node.deletable,!0)),l=X(()=>e.node.connectable),c=X(()=>e.node.focusable),d=X(()=>Xr(e.node.hidden,!1)),h=X(()=>Xr(e.node.dragging,!1)),u=X(()=>Xr(e.node.style,"")),f=X(()=>e.node.class),g=X(()=>Xr(e.node.type,"default")),m=X(()=>e.node.parentId),p=X(()=>e.node.sourcePosition),v=X(()=>e.node.targetPosition),b=X(()=>Xr(e.node.measured,()=>({width:0,height:0}),!0).width),w=X(()=>Xr(e.node.measured,()=>({width:0,height:0}),!0).height),C=X(()=>e.node.initialWidth),y=X(()=>e.node.initialHeight),x=X(()=>e.node.width),S=X(()=>e.node.height),L=X(()=>e.node.dragHandle),E=X(()=>Xr(e.node.internals.z,0)),M=X(()=>e.node.internals.positionAbsolute.x),R=X(()=>e.node.internals.positionAbsolute.y),T=X(()=>e.node.internals.userNode),{id:A}=e.node,N=X(()=>I(o)??t().nodesDraggable),P=X(()=>I(r)??t().elementsSelectable),W=X(()=>I(l)??t().nodesConnectable),H=X(()=>ESe(e.node)),G=X(()=>!!e.node.internals.handleBounds),V=X(()=>I(H)&&I(G)),U=X(()=>I(c)??t().nodesFocusable);function $(Pe){return t().parentLookup.has(Pe)}let Y=X(()=>$(A)),se=At(null),j=null,ie=I(g),te=I(p),pe=I(v),J=X(()=>t().nodeTypes[I(g)]??qne),le=X(()=>t().ariaLabelConfig),be={get value(){return I(W)}};Sxe(A),Lxe(be);let Ce=X(()=>{const Pe=I(b)===void 0?I(x)??I(C):I(x),Be=I(w)===void 0?I(S)??I(y):I(S);if(!(Pe===void 0&&Be===void 0&&I(u)===void 0))return`${I(u)};${Pe?`width:${wh(Pe)};`:""}${Be?`height:${wh(Be)};`:""}`});Br(()=>{(I(g)!==ie||I(p)!==te||I(v)!==pe)&&I(se)!==null&&requestAnimationFrame(()=>{I(se)!==null&&t().updateNodeInternals(new Map([[A,{id:A,nodeElement:I(se),force:!0}]]))}),ie=I(g),te=I(p),pe=I(v)}),Br(()=>{e.resizeObserver&&(!I(V)||I(se)!==j)&&(j&&e.resizeObserver.unobserve(j),I(se)&&e.resizeObserver.observe(I(se)),j=I(se))}),ty(()=>{var Pe;j&&((Pe=e.resizeObserver)==null||Pe.unobserve(j))});function Je(Pe){var Be;I(P)&&(!t().selectNodesOnDrag||!I(N)||t().nodeDragThreshold>0)&&t().handleNodeSelection(A),(Be=e.onnodeclick)==null||Be.call(e,{node:I(T),event:Pe})}function qe(Pe){if(!(Tne(Pe)||t().disableKeyboardA11y))if(Sne.includes(Pe.key)&&I(P)){const Be=Pe.key==="Escape";t().handleNodeSelection(A,Be,I(se))}else I(N)&&e.node.selected&&Object.prototype.hasOwnProperty.call(MN,Pe.key)&&(Pe.preventDefault(),t(t().ariaLiveMessage=I(le)["node.a11yDescription.ariaLiveMessage"]({direction:Pe.key.replace("Arrow","").toLowerCase(),x:~~e.node.internals.positionAbsolute.x,y:~~e.node.internals.positionAbsolute.y}),!0),t().moveSelectedNodes(MN[Pe.key],Pe.shiftKey?4:1))}const mt=()=>{var Et;if(t().disableKeyboardA11y||!t().autoPanOnNodeFocus||!((Et=I(se))!=null&&Et.matches(":focus-visible")))return;const{width:Pe,height:Be,viewport:Me}=t();Zz(new Map([[A,e.node]]),{x:0,y:0,width:Pe,height:Be},[Me.x,Me.y,Me.zoom],!0).length>0||t().setCenter(e.node.position.x+(e.node.measured.width??0)/2,e.node.position.y+(e.node.measured.height??0)/2,{zoom:Me.zoom})};var Ke=gt(),nt=De(Ke);{var ft=Pe=>{var Be=iLe();vc(Be,()=>({"data-id":A,class:["svelte-flow__node",`svelte-flow__node-${I(g)}`,I(f)],style:I(Ce),onclick:Je,onpointerenter:e.onnodepointerenter?rt=>e.onnodepointerenter({node:I(T),event:rt}):void 0,onpointerleave:e.onnodepointerleave?rt=>e.onnodepointerleave({node:I(T),event:rt}):void 0,onpointermove:e.onnodepointermove?rt=>e.onnodepointermove({node:I(T),event:rt}):void 0,oncontextmenu:e.onnodecontextmenu?rt=>e.onnodecontextmenu({node:I(T),event:rt}):void 0,onkeydown:I(U)?qe:void 0,onfocus:I(U)?mt:void 0,tabIndex:I(U)?0:void 0,role:e.node.ariaRole??(I(U)?"group":void 0),"aria-roledescription":"node","aria-describedby":t().disableKeyboardA11y?void 0:`${Xne}-${t().flowId}`,...e.node.domAttributes,[Vz]:{dragging:I(h),selected:I(n),draggable:I(N),connectable:I(W),selectable:I(P),nopan:I(N),parent:I(Y)},[XE]:{"z-index":I(E),transform:`translate(${I(M)??""}px, ${I(R)??""}px)`,visibility:I(H)?"visible":"hidden"}}));var Me=Ee(Be);Rt(Me,()=>I(J),(rt,Et)=>{Et(rt,{get data(){return I(i)},get id(){return A},get selected(){return I(n)},get selectable(){return I(P)},get deletable(){return I(a)},get sourcePosition(){return I(p)},get targetPosition(){return I(v)},get zIndex(){return I(E)},get dragging(){return I(h)},get draggable(){return I(N)},get dragHandle(){return I(L)},get parentId(){return I(m)},get type(){return I(g)},get isConnectable(){return I(W)},get positionAbsoluteX(){return I(M)},get positionAbsoluteY(){return I(R)},get width(){return I(x)},get height(){return I(S)}})}),Ie(Be),Aa(Be,(rt,Et)=>h1==null?void 0:h1(rt,Et),()=>({nodeId:A,isSelectable:I(P),disabled:!I(N),handleSelector:I(L),noDragClass:t().noDragClass,nodeClickDistance:e.nodeClickDistance,onNodeMouseDown:t().handleNodeSelection,onDrag:(rt,Et,qt,Ge)=>{var at;(at=e.onnodedrag)==null||at.call(e,{event:rt,targetNode:qt,nodes:Ge})},onDragStart:(rt,Et,qt,Ge)=>{var at;(at=e.onnodedragstart)==null||at.call(e,{event:rt,targetNode:qt,nodes:Ge})},onDragStop:(rt,Et,qt,Ge)=>{var at;(at=e.onnodedragstop)==null||at.call(e,{event:rt,targetNode:qt,nodes:Ge})},store:t()})),If(Be,rt=>Le(se,rt),()=>I(se)),Q(Pe,Be)};St(nt,Pe=>{I(d)||Pe(ft)})}Q(s,Ke),It()}var sLe=Re('<div class="svelte-flow__nodes"></div>');function oLe(s,e){Lt(e,!0);let t=Ae(e,"store",15);const i=typeof ResizeObserver>"u"?null:new ResizeObserver(o=>{const r=new Map;o.forEach(a=>{const l=a.target.getAttribute("data-id");r.set(l,{id:l,nodeElement:a.target,force:!0})}),t().updateNodeInternals(r)});ty(()=>{i==null||i.disconnect()});var n=sLe();Xn(n,21,()=>t().visible.nodes.values(),o=>o.id,(o,r)=>{nLe(o,{get node(){return I(r)},get resizeObserver(){return i},get nodeClickDistance(){return e.nodeClickDistance},get onnodeclick(){return e.onnodeclick},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get onnodecontextmenu(){return e.onnodecontextmenu},get store(){return t()},set store(a){t(a)}})}),Ie(n),Q(s,n),It()}var rLe=fs('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');function aLe(s,e){Lt(e,!0);let t=X(()=>e.edge.id),i=X(()=>e.edge.source),n=X(()=>e.edge.target),o=X(()=>e.edge.sourceX),r=X(()=>e.edge.sourceY),a=X(()=>e.edge.targetX),l=X(()=>e.edge.targetY),c=X(()=>e.edge.sourcePosition),d=X(()=>e.edge.targetPosition),h=X(()=>Xr(e.edge.animated,!1)),u=X(()=>Xr(e.edge.selected,!1)),f=X(()=>e.edge.label),g=X(()=>e.edge.labelStyle),m=X(()=>Xr(e.edge.data,()=>({}),!0)),p=X(()=>e.edge.style),v=X(()=>e.edge.interactionWidth),b=X(()=>Xr(e.edge.type,"default")),w=X(()=>e.edge.sourceHandle),C=X(()=>e.edge.targetHandle),y=X(()=>e.edge.markerStart),x=X(()=>e.edge.markerEnd),S=X(()=>e.edge.selectable),L=X(()=>e.edge.focusable),E=X(()=>Xr(e.edge.deletable,!0)),M=X(()=>e.edge.hidden),R=X(()=>e.edge.zIndex),T=X(()=>e.edge.class),A=X(()=>e.edge.ariaLabel);Exe(I(t));let N=null,P=X(()=>I(S)??e.store.elementsSelectable),W=X(()=>I(L)??e.store.edgesFocusable),H=X(()=>e.store.edgeTypes[I(b)]??jne),G=X(()=>I(y)?`url('#${f9(I(y),e.store.flowId)}')`:void 0),V=X(()=>I(x)?`url('#${f9(I(x),e.store.flowId)}')`:void 0);function U(te){var J;const pe=e.store.edgeLookup.get(I(t));pe&&(I(P)&&e.store.handleEdgeSelection(I(t)),(J=e.onedgeclick)==null||J.call(e,{event:te,edge:pe}))}function $(te,pe){const J=e.store.edgeLookup.get(I(t));J&&pe({event:te,edge:J})}function Y(te){if(!e.store.disableKeyboardA11y&&Sne.includes(te.key)&&I(P)){const{unselectNodesAndEdges:pe,addSelectedEdges:J}=e.store;te.key==="Escape"?(N==null||N.blur(),pe({edges:[e.edge]})):J([I(t)])}}var se=gt(),j=De(se);{var ie=te=>{var pe=rLe();let J;var le=Ee(pe);vc(le,()=>({class:["svelte-flow__edge",I(T)],"data-id":I(t),onclick:U,oncontextmenu:e.onedgecontextmenu?Ce=>{$(Ce,e.onedgecontextmenu)}:void 0,onpointerenter:e.onedgepointerenter?Ce=>{$(Ce,e.onedgepointerenter)}:void 0,onpointerleave:e.onedgepointerleave?Ce=>{$(Ce,e.onedgepointerleave)}:void 0,"aria-label":I(A)===null?void 0:I(A)?I(A):`Edge from ${I(i)} to ${I(n)}`,"aria-describedby":I(W)?`${Zne}-${e.store.flowId}`:void 0,role:e.edge.ariaRole??(I(W)?"group":"img"),"aria-roledescription":"edge",onkeydown:I(W)?Y:void 0,tabindex:I(W)?0:void 0,...e.edge.domAttributes,[Vz]:{animated:I(h),selected:I(u),selectable:I(P)}}));var be=Ee(le);Rt(be,()=>I(H),(Ce,Je)=>{Je(Ce,{get id(){return I(t)},get source(){return I(i)},get target(){return I(n)},get sourceX(){return I(o)},get sourceY(){return I(r)},get targetX(){return I(a)},get targetY(){return I(l)},get sourcePosition(){return I(c)},get targetPosition(){return I(d)},get animated(){return I(h)},get selected(){return I(u)},get label(){return I(f)},get labelStyle(){return I(g)},get data(){return I(m)},get style(){return I(p)},get interactionWidth(){return I(v)},get selectable(){return I(P)},get deletable(){return I(E)},get type(){return I(b)},get sourceHandleId(){return I(w)},get targetHandleId(){return I(C)},get markerStart(){return I(G)},get markerEnd(){return I(V)}})}),Ie(le),If(le,Ce=>N=Ce,()=>N),Ie(pe),ze(()=>J=El(pe,"",J,{"z-index":I(R)})),Q(te,pe)};St(j,te=>{I(M)||te(ie)})}Q(s,se),It()}var lLe=fs("<defs></defs>");function cLe(s,e){Lt(e,!1);const t=Em();eme();var i=lLe();Xn(i,5,()=>t.markers,n=>n.id,(n,o)=>{fLe(n,zn(()=>I(o)))}),Ie(i),Q(s,i),It()}var dLe=fs('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),hLe=fs('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),uLe=fs('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function fLe(s,e){Lt(e,!0);let t=Ae(e,"width",3,12.5),i=Ae(e,"height",3,12.5),n=Ae(e,"markerUnits",3,"strokeWidth"),o=Ae(e,"orient",3,"auto-start-reverse"),r=Ae(e,"color",3,"none");var a=uLe(),l=Ee(a);{var c=h=>{var u=dLe();let f;ze(()=>{Xt(u,"stroke-width",e.strokeWidth),f=El(u,"",f,{stroke:r()})}),Q(h,u)},d=h=>{var u=gt(),f=De(u);{var g=m=>{var p=hLe();let v;ze(()=>{Xt(p,"stroke-width",e.strokeWidth),v=El(p,"",v,{stroke:r(),fill:r()})}),Q(m,p)};St(f,m=>{e.type===TN.ArrowClosed&&m(g)},!0)}Q(h,u)};St(l,h=>{e.type===TN.Arrow?h(c):h(d,!1)})}Ie(a),ze(()=>{Xt(a,"id",e.id),Xt(a,"markerWidth",`${t()}`),Xt(a,"markerHeight",`${i()}`),Xt(a,"markerUnits",n()),Xt(a,"orient",o())}),Q(s,a),It()}var gLe=Re('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function mLe(s,e){Lt(e,!0);let t=Ae(e,"store",15);var i=gLe(),n=Ee(i),o=Ee(n);cLe(o,{}),Ie(n);var r=ue(n,2);Xn(r,17,()=>t().visible.edges.values(),a=>a.id,(a,l)=>{aLe(a,{get edge(){return I(l)},get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return t()},set store(c){t(c)}})}),Ie(i),Q(s,i),It()}var pLe=Re('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function Qne(s,e){Lt(e,!0);let t=Ae(e,"x",3,0),i=Ae(e,"y",3,0),n=Ae(e,"width",3,0),o=Ae(e,"height",3,0),r=Ae(e,"isVisible",3,!0);var a=gt(),l=De(a);{var c=d=>{var h=pLe();let u;ze(f=>u=El(h,"",u,f),[()=>({width:typeof n()=="string"?n():wh(n()),height:typeof o()=="string"?o():wh(o()),transform:`translate(${t()}px, ${i()}px)`})]),Q(d,h)};St(l,d=>{r()&&d(c)})}Q(s,a),It()}var _Le=Re("<div><!></div>");function bLe(s,e){Lt(e,!0);let t=At(void 0);Br(()=>{var d;e.store.disableKeyboardA11y||(d=I(t))==null||d.focus({preventScroll:!0})});let i=X(()=>{if(e.store.selectionRectMode==="nodes"){e.store.nodes;const d=rO(e.store.nodeLookup,{filter:h=>!!h.selected});if(d.width>0&&d.height>0)return d}return null});function n(d){var u;const h=e.store.nodes.filter(f=>f.selected);(u=e.onselectioncontextmenu)==null||u.call(e,{nodes:h,event:d})}function o(d){var u;const h=e.store.nodes.filter(f=>f.selected);(u=e.onselectionclick)==null||u.call(e,{nodes:h,event:d})}function r(d){Object.prototype.hasOwnProperty.call(MN,d.key)&&(d.preventDefault(),e.store.moveSelectedNodes(MN[d.key],d.shiftKey?4:1))}var a=gt(),l=De(a);{var c=d=>{var h=_Le();h.__contextmenu=n,h.__click=o,h.__keydown=function(...g){var m;(m=e.store.disableKeyboardA11y?void 0:r)==null||m.apply(this,g)};let u;var f=Ee(h);Qne(f,{width:"100%",height:"100%",x:0,y:0}),Ie(h),Aa(h,(g,m)=>h1==null?void 0:h1(g,m),()=>({disabled:!1,store:e.store,onDrag:(g,m,p,v)=>{var b;(b=e.onnodedrag)==null||b.call(e,{event:g,targetNode:null,nodes:v})},onDragStart:(g,m,p,v)=>{var b;(b=e.onnodedragstart)==null||b.call(e,{event:g,targetNode:null,nodes:v})},onDragStop:(g,m,p,v)=>{var b;(b=e.onnodedragstop)==null||b.call(e,{event:g,targetNode:null,nodes:v})}})),If(h,g=>Le(t,g),()=>I(t)),ze(g=>{Qn(h,1,jo(["svelte-flow__selection-wrapper",e.store.noPanClass]),"svelte-sf2y5e"),Xt(h,"role",e.store.disableKeyboardA11y?void 0:"button"),Xt(h,"tabindex",e.store.disableKeyboardA11y?void 0:-1),u=El(h,"",u,g)},[()=>({width:wh(I(i).width),height:wh(I(i).height),transform:`translate(${I(i).x??""}px, ${I(i).y??""}px)`})]),Q(d,h)};St(l,d=>{e.store.selectionRectMode==="nodes"&&I(i)&&Tu(I(i).x)&&Tu(I(i).y)&&d(c)})}Q(s,a),It()}dv(["contextmenu","click","keydown"]);function vLe(s){switch(s){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function Tn(s,e){let{enabled:t=!0,trigger:i,type:n="keydown"}=e;function o(a){var d;const l=Array.isArray(i)?i:[i],c=[a.metaKey,a.altKey,a.shiftKey,a.ctrlKey].reduce((h,u,f)=>u?h|1<<f:h,0);for(const h of l){const u={preventDefault:!1,enabled:!0,...h},{modifier:f,key:g,callback:m,preventDefault:p,enabled:v}=u;if(v){if(a.key!==g)continue;if(f===null||f===!1){if(c!==0)continue}else if(f!==void 0&&((d=f==null?void 0:f[0])==null?void 0:d.length)>0){const w=Array.isArray(f)?f:[f];let C=!1;for(const y of w)if((Array.isArray(y)?y:[y]).reduce((S,L)=>S|vLe(L),0)===c){C=!0;break}if(!C)continue}p&&a.preventDefault();const b={node:s,trigger:u,originalEvent:a};s.dispatchEvent(new CustomEvent("shortcut",{detail:b})),m==null||m(b)}}}let r;return t&&(r=oc(s,n,o)),{update:a=>{const{enabled:l=!0,type:c="keydown"}=a;t&&(!l||n!==c)?r==null||r():!t&&l&&(r=oc(s,c,o)),t=l,n=c,i=a.trigger},destroy:()=>{r==null||r()}}}function Jne(){const s=X(Em),e=o=>{var c,d;const r=bG(o)?o:I(s).nodeLookup.get(o.id),a=r.parentId?kSe(r.position,r.measured,r.parentId,I(s).nodeLookup,I(s).nodeOrigin):r.position,l={...r,position:a,width:((c=r.measured)==null?void 0:c.width)??r.width,height:((d=r.measured)==null?void 0:d.height)??r.height};return uw(l)};function t(o,r,a={replace:!1}){I(s).nodes=ch(()=>I(s).nodes).map(l=>{if(l.id===o){const c=typeof r=="function"?r(l):r;return a!=null&&a.replace&&bG(c)?c:{...l,...c}}return l})}function i(o,r,a={replace:!1}){I(s).edges=ch(()=>I(s).edges).map(l=>{if(l.id===o){const c=typeof r=="function"?r(l):r;return a.replace&&Oxe(c)?c:{...l,...c}}return l})}const n=o=>I(s).nodeLookup.get(o);return{zoomIn:I(s).zoomIn,zoomOut:I(s).zoomOut,getInternalNode:n,getNode:o=>{var r;return(r=n(o))==null?void 0:r.internals.userNode},getNodes:o=>o===void 0?I(s).nodes:SG(I(s).nodeLookup,o),getEdge:o=>I(s).edgeLookup.get(o),getEdges:o=>o===void 0?I(s).edges:SG(I(s).edgeLookup,o),setZoom:(o,r)=>{const a=I(s).panZoom;return a?a.scaleTo(o,{duration:r==null?void 0:r.duration}):Promise.resolve(!1)},getZoom:()=>I(s).viewport.zoom,setViewport:async(o,r)=>{const a=I(s).viewport;return I(s).panZoom?(await I(s).panZoom.setViewport({x:o.x??a.x,y:o.y??a.y,zoom:o.zoom??a.zoom},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>zz(I(s).viewport),setCenter:async(o,r,a)=>I(s).setCenter(o,r,a),fitView:o=>I(s).fitView(o),fitBounds:async(o,r)=>{if(!I(s).panZoom)return Promise.resolve(!1);const a=Qz(o,I(s).width,I(s).height,I(s).minZoom,I(s).maxZoom,(r==null?void 0:r.padding)??.1);return await I(s).panZoom.setViewport(a,{duration:r==null?void 0:r.duration,ease:r==null?void 0:r.ease,interpolate:r==null?void 0:r.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(o,r=!0,a)=>{const l=oG(o),c=l?o:e(o);return c?(a||I(s).nodes).filter(d=>{const h=I(s).nodeLookup.get(d.id);if(!h||!l&&d.id===o.id)return!1;const u=uw(h),f=cL(u,c);return r&&f>0||f>=u.width*u.height||f>=c.width*c.height}):[]},isNodeIntersecting:(o,r,a=!0)=>{const c=oG(o)?o:e(o);if(!c)return!1;const d=cL(c,r);return a&&d>0||d>=r.width*r.height||d>=c.width*c.height},deleteElements:async({nodes:o=[],edges:r=[]})=>{var c,d;const{nodes:a,edges:l}=await ySe({nodesToRemove:o,edgesToRemove:r,nodes:I(s).nodes,edges:I(s).edges,onBeforeDelete:I(s).onbeforedelete});return a&&(I(s).nodes=ch(()=>I(s).nodes).filter(h=>!a.some(({id:u})=>u===h.id))),l&&(I(s).edges=ch(()=>I(s).edges).filter(h=>!l.some(({id:u})=>u===h.id))),(a.length>0||l.length>0)&&((d=(c=I(s)).ondelete)==null||d.call(c,{nodes:a,edges:l})),{deletedNodes:a,deletedEdges:l}},screenToFlowPosition:(o,r={snapToGrid:!0})=>{if(!I(s).domNode)return o;const a=r.snapToGrid?I(s).snapGrid:!1,{x:l,y:c,zoom:d}=I(s).viewport,{x:h,y:u}=I(s).domNode.getBoundingClientRect(),f={x:o.x-h,y:o.y-u};return tk(f,[l,c,d],a!==null,a||[1,1])},flowToScreenPosition:o=>{if(!I(s).domNode)return o;const{x:r,y:a,zoom:l}=I(s).viewport,{x:c,y:d}=I(s).domNode.getBoundingClientRect(),h=RN(o,[r,a,l]);return{x:h.x+c,y:h.y+d}},toObject:()=>structuredClone({nodes:[...I(s).nodes],edges:[...I(s).edges],viewport:{...I(s).viewport}}),updateNode:t,updateNodeData:(o,r,a)=>{var d;const l=(d=I(s).nodeLookup.get(o))==null?void 0:d.internals.userNode;if(!l)return;const c=typeof r=="function"?r(l):r;t(o,h=>({...h,data:a!=null&&a.replace?c:{...h.data,...c}}))},updateEdge:i,getNodesBounds:o=>bSe(o,{nodeLookup:I(s).nodeLookup,nodeOrigin:I(s).nodeOrigin}),getHandleConnections:({type:o,id:r,nodeId:a})=>{var l;return Array.from(((l=I(s).connectionLookup.get(`${a}-${o}-${r??null}`))==null?void 0:l.values())??[])}}}function SG(s,e){var i;const t=[];for(const n of e){const o=s.get(n);if(o){const r="internals"in o?(i=o.internals)==null?void 0:i.userNode:o;t.push(r)}}return t}function CLe(s,e){Lt(e,!0);let t=Ae(e,"store",15),i=Ae(e,"selectionKey",3,"Shift"),n=Ae(e,"multiSelectionKey",19,()=>dL()?"Meta":"Control"),o=Ae(e,"deleteKey",3,"Backspace"),r=Ae(e,"panActivationKey",3," "),a=Ae(e,"zoomActivationKey",19,()=>dL()?"Meta":"Control"),{deleteElements:l}=Jne();function c(m){return m!==null&&typeof m=="object"}function d(m){return c(m)?m.modifier||[]:[]}function h(m){return m==null?"":c(m)?m.key:m}function u(m,p){return(Array.isArray(m)?m:[m]).map(b=>{const w=h(b);return{key:w,modifier:d(b),enabled:w!==null,callback:p}})}function f(){t(t().selectionRect=null,!0),t(t().selectionKeyPressed=!1,!0),t(t().multiselectionKeyPressed=!1,!0),t(t().deleteKeyPressed=!1,!0),t(t().panActivationKeyPressed=!1,!0),t(t().zoomActivationKeyPressed=!1,!0)}function g(){const m=t().nodes.filter(v=>v.selected),p=t().edges.filter(v=>v.selected);l({nodes:m,edges:p})}ku("blur",jl,f),ku("contextmenu",jl,f),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(i(),()=>t(t().selectionKeyPressed=!0,!0)),type:"keydown"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(i(),()=>t(t().selectionKeyPressed=!1,!0)),type:"keyup"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(n(),()=>{t(t().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(n(),()=>t(t().multiselectionKeyPressed=!1,!0)),type:"keyup"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(o(),m=>{!(m.originalEvent.ctrlKey||m.originalEvent.metaKey||m.originalEvent.shiftKey)&&!Tne(m.originalEvent)&&(t(t().deleteKeyPressed=!0,!0),g())}),type:"keydown"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(o(),()=>t(t().deleteKeyPressed=!1,!0)),type:"keyup"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(r(),()=>t(t().panActivationKeyPressed=!0,!0)),type:"keydown"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(r(),()=>t(t().panActivationKeyPressed=!1,!0)),type:"keyup"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(a(),()=>t(t().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),Aa(jl,(m,p)=>Tn==null?void 0:Tn(m,p),()=>({trigger:u(a(),()=>t(t().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),It()}var wLe=fs('<path fill="none" class="svelte-flow__connection-path"></path>'),yLe=fs('<svg class="svelte-flow__connectionline"><g><!></g></svg>');function SLe(s,e){Lt(e,!0);let t=X(()=>{if(!e.store.connection.inProgress)return"";const r={sourceX:e.store.connection.from.x,sourceY:e.store.connection.from.y,sourcePosition:e.store.connection.fromPosition,targetX:e.store.connection.to.x,targetY:e.store.connection.to.y,targetPosition:e.store.connection.toPosition};switch(e.type){case rg.Bezier:{const[a]=cO(r);return a}case rg.Straight:{const[a]=Mne(r);return a}case rg.Step:case rg.SmoothStep:{const[a]=Jz({...r,borderRadius:e.type===rg.Step?0:void 0});return a}}});var i=gt(),n=De(i);{var o=r=>{var a=yLe(),l=Ee(a),c=Ee(l);{var d=u=>{var f=gt(),g=De(f);Rt(g,()=>e.LineComponent,(m,p)=>{p(m,{})}),Q(u,f)},h=u=>{var f=wLe();ze(()=>{Xt(f,"d",I(t)),El(f,e.style)}),Q(u,f)};St(c,u=>{e.LineComponent?u(d):u(h,!1)})}Ie(l),Ie(a),ze(u=>{Xt(a,"width",e.store.width),Xt(a,"height",e.store.height),El(a,e.containerStyle),Qn(l,0,u)},[()=>jo(["svelte-flow__connection",pSe(e.store.connection.isValid)])]),Q(r,a)};St(n,r=>{e.store.connection.inProgress&&r(o)})}Q(s,i),It()}var xLe=Re("<div><!></div>");function ese(s,e){Lt(e,!0);let t=Ae(e,"position",3,"top-right"),i=vn(e,["$$slots","$$events","$$legacy","position","style","class","children"]),n=X(()=>`${t()}`.split("-"));var o=xLe();vc(o,a=>({class:a,style:e.style,...i}),[()=>["svelte-flow__panel",e.class,...I(n)]]);var r=Ee(o);Hi(r,()=>e.children??jn),Ie(o),Q(s,o),It()}var LLe=Re('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function ILe(s,e){Lt(e,!0);let t=Ae(e,"position",3,"bottom-right");var i=gt(),n=De(i);{var o=r=>{ese(r,{get position(){return t()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(a,l)=>{var c=LLe();Q(a,c)},$$slots:{default:!0}})};St(n,r=>{var a;(a=e.proOptions)!=null&&a.hideAttribution||r(o)})}Q(s,i),It()}var ELe=Re("<div><!></div>");function kLe(s,e){Lt(e,!0);let t=Ae(e,"domNode",15),i=Ae(e,"clientWidth",15),n=Ae(e,"clientHeight",15),o=X(()=>e.rest.class),r=X(()=>Nge(e.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed","zIndexMode"]));function a(d){d.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),e.rest.onscroll&&e.rest.onscroll(d)}var l=ELe();vc(l,d=>({class:["svelte-flow","svelte-flow__container",I(o),e.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:a,...I(r),[XE]:d}),[()=>({width:wh(e.width),height:wh(e.height)})],void 0,void 0,"svelte-mkap6j");var c=Ee(l);Hi(c,()=>e.children??jn),Ie(l),If(l,d=>t(d),()=>t()),PK(l,"clientHeight",n),PK(l,"clientWidth",i),Q(s,l),It()}var DLe=Re('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),TLe=Re("<!> <!>",1),NLe=Re("<!> <!> <!> <!> <!>",1);function RLe(s,e){Lt(e,!0);let t=Ae(e,"paneClickDistance",3,1),i=Ae(e,"nodeClickDistance",3,1),n=Ae(e,"panOnScrollMode",19,()=>d1.Free),o=Ae(e,"preventScrolling",3,!0),r=Ae(e,"zoomOnScroll",3,!0),a=Ae(e,"zoomOnDoubleClick",3,!0),l=Ae(e,"zoomOnPinch",3,!0),c=Ae(e,"panOnScroll",3,!1),d=Ae(e,"panOnScrollSpeed",3,.5),h=Ae(e,"panOnDrag",3,!0),u=Ae(e,"selectionOnDrag",3,!1),f=Ae(e,"connectionLineType",19,()=>rg.Bezier),g=Ae(e,"nodes",31,()=>Dr([])),m=Ae(e,"edges",31,()=>Dr([])),p=Ae(e,"viewport",15,void 0),v=vn(e,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),b=Yne({props:v,width:e.width,height:e.height,get nodes(){return g()},set nodes(C){g(C)},get edges(){return m()},set edges(C){m(C)},get viewport(){return p()},set viewport(C){p(C)}});const w=wb(AN);w&&w.setStore&&w.setStore(b),ey(AN,{provider:!1,getStore(){return b}}),Br(()=>{var y;const C={nodes:b.selectedNodes,edges:b.selectedEdges};(y=ch(()=>e.onselectionchange))==null||y(C);for(const x of b.selectionChangeHandlers.values())x(C)}),ty(()=>{b.reset()}),kLe(s,{get colorMode(){return b.colorMode},get width(){return e.width},get height(){return e.height},get rest(){return v},get domNode(){return b.domNode},set domNode(C){b.domNode=C},get clientWidth(){return b.width},set clientWidth(C){b.width=C},get clientHeight(){return b.height},set clientHeight(C){b.height=C},children:(C,y)=>{var x=NLe(),S=De(x);CLe(S,{get selectionKey(){return e.selectionKey},get deleteKey(){return e.deleteKey},get panActivationKey(){return e.panActivationKey},get multiSelectionKey(){return e.multiSelectionKey},get zoomActivationKey(){return e.zoomActivationKey},get store(){return b},set store(T){b=T}});var L=ue(S,2);Kxe(L,{get panOnScrollMode(){return n()},get preventScrolling(){return o()},get zoomOnScroll(){return r()},get zoomOnDoubleClick(){return a()},get zoomOnPinch(){return l()},get panOnScroll(){return c()},get panOnScrollSpeed(){return d()},get panOnDrag(){return h()},get paneClickDistance(){return t()},get selectionOnDrag(){return u()},get onmovestart(){return e.onmovestart},get onmove(){return e.onmove},get onmoveend(){return e.onmoveend},get oninit(){return e.oninit},get store(){return b},set store(T){b=T},children:(T,A)=>{Yxe(T,{get onpaneclick(){return e.onpaneclick},get onpanecontextmenu(){return e.onpanecontextmenu},get onselectionstart(){return e.onselectionstart},get onselectionend(){return e.onselectionend},get panOnDrag(){return h()},get paneClickDistance(){return t()},get selectionOnDrag(){return u()},get store(){return b},set store(N){b=N},children:(N,P)=>{var W=TLe(),H=De(W);Zxe(H,{get store(){return b},set store(V){b=V},children:(V,U)=>{var $=DLe(),Y=ue(De($),2);mLe(Y,{get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return b},set store(te){b=te}});var se=ue(Y,4);SLe(se,{get type(){return f()},get LineComponent(){return e.connectionLineComponent},get containerStyle(){return e.connectionLineContainerStyle},get style(){return e.connectionLineStyle},get store(){return b},set store(te){b=te}});var j=ue(se,2);oLe(j,{get nodeClickDistance(){return i()},get onnodeclick(){return e.onnodeclick},get onnodecontextmenu(){return e.onnodecontextmenu},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return b},set store(te){b=te}});var ie=ue(j,2);bLe(ie,{get onselectionclick(){return e.onselectionclick},get onselectioncontextmenu(){return e.onselectioncontextmenu},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return b},set store(te){b=te}}),Oi(2),Q(V,$)},$$slots:{default:!0}});var G=ue(H,2);{let V=X(()=>!!(b.selectionRect&&b.selectionRectMode==="user")),U=X(()=>{var j;return(j=b.selectionRect)==null?void 0:j.width}),$=X(()=>{var j;return(j=b.selectionRect)==null?void 0:j.height}),Y=X(()=>{var j;return(j=b.selectionRect)==null?void 0:j.x}),se=X(()=>{var j;return(j=b.selectionRect)==null?void 0:j.y});Qne(G,{get isVisible(){return I(V)},get width(){return I(U)},get height(){return I($)},get x(){return I(Y)},get y(){return I(se)}})}Q(N,W)},$$slots:{default:!0}})},$$slots:{default:!0}});var E=ue(L,2);ILe(E,{get proOptions(){return e.proOptions},get position(){return e.attributionPosition}});var M=ue(E,2);eLe(M,{get store(){return b}});var R=ue(M,2);Hi(R,()=>e.children??jn),Q(C,x)},$$slots:{default:!0}}),It()}function Mct(s,e){Lt(e,!0);let t=At(Yne({props:{},nodes:[],edges:[]}));ey(AN,{provider:!0,getStore(){return I(t)},setStore:o=>{Le(t,o)}}),ty(()=>{I(t).reset()});var i=gt(),n=De(i);Hi(n,()=>e.children??jn),Q(s,i),It()}var MLe=Re("<button><!></button>");function eD(s,e){let t=vn(e,["$$slots","$$events","$$legacy","class","bgColor","bgColorHover","color","colorHover","borderColor","onclick","children"]);var i=MLe();vc(i,()=>({type:"button",onclick:e.onclick,class:["svelte-flow__controls-button",e.class],...t,[XE]:{"--xy-controls-button-background-color-props":e.bgColor,"--xy-controls-button-background-color-hover-props":e.bgColorHover,"--xy-controls-button-color-props":e.color,"--xy-controls-button-color-hover-props":e.colorHover,"--xy-controls-button-border-color-props":e.borderColor}}));var n=Ee(i);Hi(n,()=>e.children??jn),Ie(i),Q(s,i)}var ALe=fs('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"></path></svg>');function PLe(s){var e=ALe();Q(s,e)}var OLe=fs('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 5"><path d="M0 0h32v4.2H0z"></path></svg>');function FLe(s){var e=OLe();Q(s,e)}var BLe=fs('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 30"><path d="M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"></path></svg>');function WLe(s){var e=BLe();Q(s,e)}var HLe=fs('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"></path></svg>');function VLe(s){var e=HLe();Q(s,e)}var zLe=fs('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"></path></svg>');function ULe(s){var e=zLe();Q(s,e)}var $Le=Re("<!> <!>",1),qLe=Re("<!> <!> <!> <!> <!> <!>",1);function jLe(s,e){Lt(e,!0);let t=Ae(e,"position",3,"bottom-left"),i=Ae(e,"orientation",3,"vertical"),n=Ae(e,"showZoom",3,!0),o=Ae(e,"showFitView",3,!0),r=Ae(e,"showLock",3,!0),a=vn(e,["$$slots","$$events","$$legacy","position","orientation","showZoom","showFitView","showLock","style","class","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","fitViewOptions","children","before","after"]),l=X(Em);const c={bgColor:e.buttonBgColor,bgColorHover:e.buttonBgColorHover,color:e.buttonColor,colorHover:e.buttonColorHover,borderColor:e.buttonBorderColor};let d=X(()=>I(l).nodesDraggable||I(l).nodesConnectable||I(l).elementsSelectable),h=X(()=>I(l).viewport.zoom<=I(l).minZoom),u=X(()=>I(l).viewport.zoom>=I(l).maxZoom),f=X(()=>I(l).ariaLabelConfig),g=X(()=>i()==="horizontal"?"horizontal":"vertical");const m=()=>{I(l).zoomIn()},p=()=>{I(l).zoomOut()},v=()=>{I(l).fitView(e.fitViewOptions)},b=()=>{let w=!I(d);I(l).nodesDraggable=w,I(l).nodesConnectable=w,I(l).elementsSelectable=w};{let w=X(()=>["svelte-flow__controls",I(g),e.class]);ese(s,zn({get class(){return I(w)},get position(){return t()},"data-testid":"svelte-flow__controls",get"aria-label"(){return I(f)["controls.ariaLabel"]},get style(){return e.style}},()=>a,{children:(C,y)=>{var x=qLe(),S=De(x);{var L=V=>{var U=gt(),$=De(U);Hi($,()=>e.before),Q(V,U)};St(S,V=>{e.before&&V(L)})}var E=ue(S,2);{var M=V=>{var U=$Le(),$=De(U);eD($,zn({onclick:m,class:"svelte-flow__controls-zoomin",get title(){return I(f)["controls.zoomIn.ariaLabel"]},get"aria-label"(){return I(f)["controls.zoomIn.ariaLabel"]},get disabled(){return I(u)}},()=>c,{children:(se,j)=>{PLe(se)},$$slots:{default:!0}}));var Y=ue($,2);eD(Y,zn({onclick:p,class:"svelte-flow__controls-zoomout",get title(){return I(f)["controls.zoomOut.ariaLabel"]},get"aria-label"(){return I(f)["controls.zoomOut.ariaLabel"]},get disabled(){return I(h)}},()=>c,{children:(se,j)=>{FLe(se)},$$slots:{default:!0}})),Q(V,U)};St(E,V=>{n()&&V(M)})}var R=ue(E,2);{var T=V=>{eD(V,zn({class:"svelte-flow__controls-fitview",onclick:v,get title(){return I(f)["controls.fitView.ariaLabel"]},get"aria-label"(){return I(f)["controls.fitView.ariaLabel"]}},()=>c,{children:(U,$)=>{WLe(U)},$$slots:{default:!0}}))};St(R,V=>{o()&&V(T)})}var A=ue(R,2);{var N=V=>{eD(V,zn({class:"svelte-flow__controls-interactive",onclick:b,get title(){return I(f)["controls.interactive.ariaLabel"]},get"aria-label"(){return I(f)["controls.interactive.ariaLabel"]}},()=>c,{children:(U,$)=>{var Y=gt(),se=De(Y);{var j=te=>{ULe(te)},ie=te=>{VLe(te)};St(se,te=>{I(d)?te(j):te(ie,!1)})}Q(U,Y)},$$slots:{default:!0}}))};St(A,V=>{r()&&V(N)})}var P=ue(A,2);{var W=V=>{var U=gt(),$=De(U);Hi($,()=>e.children),Q(V,U)};St(P,V=>{e.children&&V(W)})}var H=ue(P,2);{var G=V=>{var U=gt(),$=De(U);Hi($,()=>e.after),Q(V,U)};St(H,V=>{e.after&&V(G)})}Q(C,x)},$$slots:{default:!0}}))}It()}var Gu;(function(s){s.Lines="lines",s.Dots="dots",s.Cross="cross"})(Gu||(Gu={}));var KLe=fs("<circle></circle>");function GLe(s,e){var t=KLe();ze(()=>{Xt(t,"cx",e.radius),Xt(t,"cy",e.radius),Xt(t,"r",e.radius),Qn(t,0,jo(["svelte-flow__background-pattern","dots",e.class]))}),Q(s,t)}var YLe=fs("<path></path>");function XLe(s,e){Lt(e,!0);var t=YLe();ze(()=>{Xt(t,"stroke-width",e.lineWidth),Xt(t,"d",`M${e.dimensions[0]/2} 0 V${e.dimensions[1]} M0 ${e.dimensions[1]/2} H${e.dimensions[0]}`),Qn(t,0,jo(["svelte-flow__background-pattern",e.variant,e.class]))}),Q(s,t),It()}const ZLe={[Gu.Dots]:1,[Gu.Lines]:1,[Gu.Cross]:6};var QLe=fs('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function JLe(s,e){Lt(e,!0);let t=Ae(e,"variant",19,()=>Gu.Dots),i=Ae(e,"gap",3,20),n=Ae(e,"lineWidth",3,1),o=X(Em),r=X(()=>t()===Gu.Dots),a=X(()=>t()===Gu.Cross),l=X(()=>Array.isArray(i())?i():[i(),i()]),c=X(()=>`background-pattern-${I(o).flowId}-${e.id??""}`),d=X(()=>[I(l)[0]*I(o).viewport.zoom||1,I(l)[1]*I(o).viewport.zoom||1]),h=X(()=>(e.size??ZLe[t()])*I(o).viewport.zoom),u=X(()=>I(a)?[I(h),I(h)]:I(d)),f=X(()=>I(r)?[I(h)/2,I(h)/2]:[I(u)[0]/2,I(u)[1]/2]);var g=QLe();let m;var p=Ee(g),v=Ee(p);{var b=y=>{{let x=X(()=>I(h)/2);GLe(y,{get radius(){return I(x)},get class(){return e.patternClass}})}},w=y=>{XLe(y,{get dimensions(){return I(u)},get variant(){return t()},get lineWidth(){return n()},get class(){return e.patternClass}})};St(v,y=>{I(r)?y(b):y(w,!1)})}Ie(p);var C=ue(p);Ie(g),ze(()=>{Qn(g,0,jo(["svelte-flow__background","svelte-flow__container",e.class])),m=El(g,"",m,{"--xy-background-color-props":e.bgColor,"--xy-background-pattern-color-props":e.patternColor}),Xt(p,"id",I(c)),Xt(p,"x",I(o).viewport.x%I(d)[0]),Xt(p,"y",I(o).viewport.y%I(d)[1]),Xt(p,"width",I(d)[0]),Xt(p,"height",I(d)[1]),Xt(p,"patternTransform",`translate(-${I(f)[0]},-${I(f)[1]})`),Xt(C,"fill",`url(#${I(c)})`)}),Q(s,g),It()}var eIe=Re("<div><!></div>");function xG(s,e){Lt(e,!0);let t=Ae(e,"variant",19,()=>hL.Handle),i=Ae(e,"minWidth",3,10),n=Ae(e,"minHeight",3,10),o=Ae(e,"maxWidth",19,()=>Number.MAX_VALUE),r=Ae(e,"maxHeight",19,()=>Number.MAX_VALUE),a=Ae(e,"keepAspectRatio",3,!1),l=Ae(e,"autoScale",3,!0),c=vn(e,["$$slots","$$events","$$legacy","nodeId","position","variant","color","minWidth","minHeight","maxWidth","maxHeight","keepAspectRatio","resizeDirection","autoScale","shouldResize","onResizeStart","onResize","onResizeEnd","class","children"]);const d=Em(),h=$ne();let u=X(()=>typeof e.nodeId=="string"?e.nodeId:h);if(!I(u))throw new Error("Either pass a nodeId or use within a Custom Node component");let f,g=At(null),m=X(()=>t()===hL.Line),p=X(()=>{let C=I(m)?"right":"bottom-right";return e.position??C}),v=X(()=>I(p).split("-"));Wz(()=>(f&&Le(g,yxe({domNode:f,nodeId:I(u),getStoreItems:()=>({nodeLookup:d.nodeLookup,transform:[d.viewport.x,d.viewport.y,d.viewport.zoom],snapGrid:d.snapGrid??void 0,snapToGrid:!!d.snapGrid,nodeOrigin:d.nodeOrigin,paneDomNode:d.domNode}),onChange:(C,y)=>{const x=new Map;x.set(I(u),C);for(const S of y)x.set(S.id,{x:S.position.x,y:S.position.y});d.nodes=d.nodes.map(S=>{const L=x.get(S.id),E=!e.resizeDirection||e.resizeDirection==="horizontal",M=!e.resizeDirection||e.resizeDirection==="vertical";return L?{...S,position:{x:E?L.x??S.position.x:S.position.x,y:M?L.y??S.position.y:S.position.y},width:E?L.width??S.width:S.width,height:M?L.height??S.height:S.height}:S})}}),!0),()=>{var C;(C=I(g))==null||C.destroy()})),Bz(()=>{var C;(C=I(g))==null||C.update({controlPosition:I(p),boundaries:{minWidth:i(),minHeight:n(),maxWidth:o(),maxHeight:r()},keepAspectRatio:!!a(),resizeDirection:e.resizeDirection,onResizeStart:e.onResizeStart,onResize:e.onResize,onResizeEnd:e.onResizeEnd,shouldResize:e.shouldResize})});var b=eIe();vc(b,(C,y)=>({class:C,...c,[XE]:y}),[()=>["svelte-flow__resize-control",d.noDragClass,...I(v),t(),e.class],()=>({"border-color":I(m)?e.color:void 0,"background-color":I(m)?void 0:e.color,scale:I(m)||!l()?void 0:Math.max(1/d.viewport.zoom,1)})]);var w=Ee(b);Hi(w,()=>e.children??jn),Ie(b),If(b,C=>f=C,()=>f),Q(s,b),It()}var tIe=Re("<!> <!>",1);function tse(s,e){Lt(e,!0);let t=Ae(e,"isVisible",3,!0),i=Ae(e,"autoScale",3,!0),n=vn(e,["$$slots","$$events","$$legacy","isVisible","nodeId","handleClass","handleStyle","lineClass","lineStyle","autoScale"]);var o=gt(),r=De(o);{var a=l=>{var c=tIe(),d=De(c);Xn(d,16,()=>pxe,u=>u,(u,f)=>{xG(u,zn({get class(){return e.lineClass},get style(){return e.lineStyle},get nodeId(){return e.nodeId},get position(){return f},get autoScale(){return i()},get variant(){return hL.Line}},()=>n))});var h=ue(d,2);Xn(h,16,()=>mxe,u=>u,(u,f)=>{xG(u,zn({get class(){return e.handleClass},get style(){return e.handleStyle},get nodeId(){return e.nodeId},get position(){return f},get autoScale(){return i()}},()=>n))}),Q(l,c)};St(r,l=>{t()&&l(a)})}Q(s,o),It()}const hO=[{name:"categories",columns:[{name:"id",type:"INTEGER",primaryKey:!0},{name:"name",type:"TEXT"},{name:"description",type:"TEXT"}]},{name:"products",columns:[{name:"id",type:"INTEGER",primaryKey:!0},{name:"name",type:"TEXT"},{name:"description",type:"TEXT"},{name:"price",type:"DECIMAL"},{name:"stock",type:"INTEGER"},{name:"category_id",type:"INTEGER",foreignKey:{table:"categories",column:"id"}},{name:"created_at",type:"DATETIME"}]},{name:"customers",columns:[{name:"id",type:"INTEGER",primaryKey:!0},{name:"name",type:"TEXT"},{name:"email",type:"TEXT"},{name:"country",type:"TEXT"},{name:"created_at",type:"DATETIME"}]},{name:"orders",columns:[{name:"id",type:"INTEGER",primaryKey:!0},{name:"customer_id",type:"INTEGER",foreignKey:{table:"customers",column:"id"}},{name:"status",type:"TEXT"},{name:"total",type:"DECIMAL"},{name:"created_at",type:"DATETIME"}]},{name:"order_items",columns:[{name:"id",type:"INTEGER",primaryKey:!0},{name:"order_id",type:"INTEGER",foreignKey:{table:"orders",column:"id"}},{name:"product_id",type:"INTEGER",foreignKey:{table:"products",column:"id"}},{name:"quantity",type:"INTEGER"},{name:"unit_price",type:"DECIMAL"}]},{name:"reviews",columns:[{name:"id",type:"INTEGER",primaryKey:!0},{name:"product_id",type:"INTEGER",foreignKey:{table:"products",column:"id"}},{name:"customer_id",type:"INTEGER",foreignKey:{table:"customers",column:"id"}},{name:"rating",type:"INTEGER"},{name:"comment",type:"TEXT"},{name:"created_at",type:"DATETIME"}]}];function pg(s){return hO.find(e=>e.name===s)}function ise(){return hO.map(s=>s.name)}function nse(s){return s.map(e=>({name:e.name,columns:e.columns.map(t=>({name:t.name,type:t.type,primaryKey:t.primaryKey??!1,foreignKey:t.foreignKey?{table:t.foreignKey.table,column:t.foreignKey.column}:void 0}))}))}function Act(s){return s.map(e=>({name:e.name,columns:e.columns.map(t=>({name:t.name,type:t.type,primaryKey:t.isPrimaryKey,foreignKey:t.foreignKeyRef?{table:t.foreignKeyRef.referencedTable,column:t.foreignKeyRef.referencedColumn}:void 0}))}))}function g9(s,e){return s.find(t=>t.name===e)}function LG(s){return/^\{\{.+\}\}$/.test(s.trim())}function iIe(s,e,t,i,n,o,r,a,l,c){let d="";if(c.length>0){const h=c.filter(u=>u.name&&u.innerQuery.tables.length>0).map(u=>{const g=HS(u.innerQuery).split(`
`).map(m=>"  "+m).join(`
`);return`${u.name} AS (
${g}
)`});h.length>0&&(d=`WITH ${h.join(`,
`)}
`)}return d+=sse(s,e,t,i,n,o,r,a,l),d}function sse(s,e,t,i,n,o,r,a,l){const c=l.filter(w=>w.role==="from");if(s.length===0&&c.length===0)return"";const d=[];for(const w of s)for(const C of w.selectedColumns){const y=w.columnAggregates.get(C);if(y){const x=`${y.function}(${w.tableName}.${C})`;d.push(y.alias?`${x} AS ${y.alias}`:x)}else d.push(`${w.tableName}.${C}`)}for(const w of a){const C=`${w.function}(${w.expression})`;d.push(w.alias?`${C} AS ${w.alias}`:C)}const h=l.filter(w=>w.role==="select");for(const w of h){const C=HS(w.innerQuery);if(C){const y=`(${C})`;d.push(w.alias?`${y} AS ${w.alias}`:y)}}let u;d.length>0?u=d.join(", "):s.length>0?u=`${s[0].tableName}.*`:c.length>0&&c[0].alias?u=`${c[0].alias}.*`:u="*";let f;if(s.length>0)f=s[0].tableName;else if(c.length>0){const w=c[0];f=`(${HS(w.innerQuery)}) AS ${w.alias||"subquery"}`}else f="";for(const w of e)f+=`
  ${w.joinType} JOIN ${w.targetTable} ON ${w.sourceTable}.${w.sourceColumn} = ${w.targetTable}.${w.targetColumn}`;for(let w=s.length>0?0:1;w<c.length;w++){const C=c[w],y=HS(C.innerQuery);y&&(f+=`,
  (${y}) AS ${C.alias||`subquery_${w}`}`)}let g="";t.length>0&&(g=`
WHERE ${t.map((C,y)=>{const x=nIe(C,l);return y===0?x:`${t[y-1].connector} ${x}`}).join(`
  `)}`);let m="";i.length>0&&(m=`
GROUP BY ${i.map(C=>C.column).join(", ")}`);let p="";n.length>0&&(p=`
HAVING ${n.map((C,y)=>{const x=sIe(C);return y===0?x:`${n[y-1].connector} ${x}`}).join(`
  `)}`);let v="";o.length>0&&(v=`
ORDER BY ${o.map(C=>`${C.column} ${C.direction}`).join(", ")}`);let b="";return r!==null&&(b=`
LIMIT ${r}`),`SELECT ${u}
FROM ${f}${g}${m}${p}${v}${b}`}function HS(s){return sse(s.tables,s.joins,s.filters,s.groupBy,s.having,s.orderBy,s.limit,s.selectAggregates,s.subqueries)}function nIe(s,e=[]){const{column:t,operator:i,value:n,subqueryId:o}=s;if(o){const r=e.find(a=>a.id===o);if(r&&r.innerQuery.tables.length>0){const a=HS(r.innerQuery);return i==="IN"?`${t} IN (${a})`:i==="NOT IN"?`${t} NOT IN (${a})`:`${t} ${i} (${a})`}}switch(i){case"IS NULL":return`${t} IS NULL`;case"IS NOT NULL":return`${t} IS NOT NULL`;case"IS TRUE":return`${t} IS TRUE`;case"IS FALSE":return`${t} IS FALSE`;case"IS NOT TRUE":return`${t} IS NOT TRUE`;case"IS NOT FALSE":return`${t} IS NOT FALSE`;case"IN":return`${t} IN (${n})`;case"NOT IN":return`${t} NOT IN (${n})`;case"BETWEEN":return`${t} BETWEEN ${n}`;case"LIKE":case"NOT LIKE":return LG(n)?`${t} ${i} ${n}`:`${t} ${i} '${n}'`;default:{if(LG(n))return`${t} ${i} ${n}`;const a=!isNaN(Number(n))&&n.trim()!==""?n:`'${n}'`;return`${t} ${i} ${a}`}}}function sIe(s){const{aggregateFunction:e,column:t,operator:i,value:n}=s;return`${e}(${t===""?"*":t}) ${i} ${n}`}function ose(s){return s.map(e=>({id:e.id,position:e.position,size:e.size,role:e.role,linkedFilterId:e.linkedFilterId,alias:e.alias,innerQuery:rse(e.innerQuery)}))}function oIe(s){return s.map(e=>({id:e.id,name:e.name,position:e.position,size:e.size,innerQuery:rse(e.innerQuery)}))}function rse(s){return{tables:s.tables.map(e=>({id:e.id,tableName:e.tableName,position:e.position,selectedColumns:Array.from(e.selectedColumns),columnAggregates:Object.fromEntries(e.columnAggregates)})),joins:[...s.joins],filters:[...s.filters],groupBy:[...s.groupBy],having:[...s.having],orderBy:[...s.orderBy],limit:s.limit,selectAggregates:[...s.selectAggregates],subqueries:ose(s.subqueries)}}function ase(s){return s.map(e=>({id:e.id,position:e.position,size:e.size,role:e.role,linkedFilterId:e.linkedFilterId,alias:e.alias,innerQuery:lse(e.innerQuery)}))}function rIe(s){return s.map(e=>({id:e.id,name:e.name,position:e.position,size:e.size,innerQuery:lse(e.innerQuery)}))}function lse(s){return{tables:s.tables.map(e=>({id:e.id,tableName:e.tableName,position:e.position,selectedColumns:new Ch(e.selectedColumns),columnAggregates:new Map(Object.entries(e.columnAggregates??{}))})),joins:s.joins.map(e=>({...e})),filters:s.filters.map(e=>({...e})),groupBy:s.groupBy.map(e=>({...e})),having:s.having.map(e=>({...e})),orderBy:s.orderBy.map(e=>({...e})),limit:s.limit,selectAggregates:s.selectAggregates.map(e=>({...e})),subqueries:ase(s.subqueries??[])}}function aIe(s){return{tables:s.tables.map(e=>({id:e.id,tableName:e.tableName,position:e.position,selectedColumns:Array.from(e.selectedColumns),columnAggregates:Object.fromEntries(e.columnAggregates),cteId:e.cteId})),joins:[...s.joins],filters:[...s.filters],groupBy:[...s.groupBy],having:[...s.having],orderBy:[...s.orderBy],limit:s.limit,customSql:s.customSql,selectAggregates:[...s.selectAggregates],subqueries:ose(s.subqueries),ctes:oIe(s.ctes)}}function lIe(s){return{tables:s.tables.map(e=>({id:e.id,tableName:e.tableName,position:e.position,selectedColumns:new Ch(e.selectedColumns),columnAggregates:new Map(Object.entries(e.columnAggregates??{})),cteId:e.cteId})),joins:s.joins.map(e=>({...e})),filters:s.filters.map(e=>({...e})),groupBy:(s.groupBy??[]).map(e=>({...e})),having:(s.having??[]).map(e=>({...e})),orderBy:s.orderBy.map(e=>({...e})),limit:s.limit,customSql:s.customSql??null,selectAggregates:(s.selectAggregates??[]).map(e=>({...e})),subqueries:ase(s.subqueries??[]),ctes:rIe(s.ctes??[])}}function Ds(){return crypto.randomUUID()}function m9(s,e,t){if(t.includes("*")){const i=s.find(n=>n.name===e);if(i)return i.columns.map(n=>n.name)}return t}function cse(s,e,t,i={x:50,y:50},n=new Map){const o=[],r=new Map;for(let a=0;a<e.length;a++){const l=e[a],c=t[a],d=(c==null?void 0:c.position)??{x:i.x+a*350,y:i.y},h=(c==null?void 0:c.id)??Ds();r.set(a,h);const u=[];for(let b=0;b<l.innerQuery.tables.length;b++){const w=l.innerQuery.tables[b],C=new Map;if(l.innerQuery.columnAggregates)for(const x of l.innerQuery.columnAggregates)x.tableName===w.tableName&&C.set(x.column,{function:x.function,alias:x.alias});const y=n.get(w.tableName);u.push({id:Ds(),tableName:w.tableName,position:{x:20+b*240,y:50},selectedColumns:new Ch(m9(s,w.tableName,w.selectedColumns)),columnAggregates:C,cteId:y})}const f=l.innerQuery.joins.map(b=>({id:Ds(),sourceTable:b.sourceTable,sourceColumn:b.sourceColumn,targetTable:b.targetTable,targetColumn:b.targetColumn,joinType:b.joinType})),g=l.innerQuery.subqueries&&l.innerQuery.subqueries.length>0?cse(s,l.innerQuery.subqueries,(c==null?void 0:c.innerQuery.subqueries)??[],{x:50,y:50},n):{subqueries:[],subqueryIdMap:new Map},m=l.innerQuery.filters.map(b=>{const w={id:Ds(),column:b.column,operator:b.operator,value:b.value,connector:b.connector};if(b.subqueryIndex!==void 0){const C=g.subqueryIdMap.get(b.subqueryIndex);if(C){w.subqueryId=C;const y=g.subqueries.find(x=>x.id===C);y&&(y.linkedFilterId=w.id)}}return w}),p=Math.max(300,20+l.innerQuery.tables.length*240+20),v=Math.max(200,350);o.push({id:h,position:d,size:(c==null?void 0:c.size)??{width:p,height:v},role:l.role,innerQuery:{tables:u,joins:f,filters:m,groupBy:l.innerQuery.groupBy.map(b=>({id:Ds(),column:b.column})),having:l.innerQuery.having.map(b=>({id:Ds(),aggregateFunction:b.aggregateFunction,column:b.column,operator:b.operator,value:b.value,connector:b.connector})),orderBy:l.innerQuery.orderBy.map(b=>({id:Ds(),column:b.column,direction:b.direction})),limit:l.innerQuery.limit,selectAggregates:l.innerQuery.selectAggregates.map(b=>({id:Ds(),function:b.function,expression:b.expression,alias:b.alias})),subqueries:g.subqueries}})}return{subqueries:o,subqueryIdMap:r}}function cIe(s,e,t,i,n){const o=[],r=new Map;if(e.ctes&&e.ctes.length>0){const b=new Map(i.map(w=>[w.name,w]));for(let w=0;w<e.ctes.length;w++){const C=e.ctes[w],y=b.get(C.name),x=C.innerQuery.tables.map((P,W)=>({id:Ds(),tableName:P.tableName,position:{x:20+W*240,y:50},selectedColumns:new Ch(m9(s,P.tableName,P.selectedColumns)),columnAggregates:new Map((C.innerQuery.columnAggregates||[]).filter(H=>H.tableName===P.tableName).map(H=>[H.column,{function:H.function,alias:H.alias}]))})),S=C.innerQuery.joins.map(P=>({id:Ds(),sourceTable:P.sourceTable,sourceColumn:P.sourceColumn,targetTable:P.targetTable,targetColumn:P.targetColumn,joinType:P.joinType})),L=C.innerQuery.filters.map(P=>({id:Ds(),column:P.column,operator:P.operator,value:P.value,connector:P.connector})),E=C.innerQuery.groupBy.map(P=>({id:Ds(),column:P.column})),M=C.innerQuery.having.map(P=>({id:Ds(),aggregateFunction:P.aggregateFunction,column:P.column,operator:P.operator,value:P.value,connector:P.connector})),R=C.innerQuery.orderBy.map(P=>({id:Ds(),column:P.column,direction:P.direction})),T=C.innerQuery.selectAggregates.map(P=>({id:Ds(),function:P.function,expression:P.expression,alias:P.alias})),A=Math.max(300,20+C.innerQuery.tables.length*240+20),N=(y==null?void 0:y.id)??Ds();o.push({id:N,name:C.name,position:(y==null?void 0:y.position)??{x:50+w*350,y:50},size:(y==null?void 0:y.size)??{width:A,height:350},innerQuery:{tables:x,joins:S,filters:L,groupBy:E,having:M,orderBy:R,limit:C.innerQuery.limit,selectAggregates:T,subqueries:[]}}),r.set(C.name,N)}}const a=[],l=new Map(t.map(b=>[b.tableName,b]));for(let b=0;b<e.tables.length;b++){const w=e.tables[b],C=l.get(w.tableName),y=(C==null?void 0:C.position)??{x:50+b*280,y:50+b%2*150},x=new Map;for(const L of e.columnAggregates)L.tableName===w.tableName&&x.set(L.column,{function:L.function,alias:L.alias});const S=r.get(w.tableName);a.push({id:(C==null?void 0:C.id)??Ds(),tableName:w.tableName,position:y,selectedColumns:new Ch(m9(s,w.tableName,w.selectedColumns)),columnAggregates:x,cteId:S})}const c=e.joins.map(b=>({id:Ds(),sourceTable:b.sourceTable,sourceColumn:b.sourceColumn,targetTable:b.targetTable,targetColumn:b.targetColumn,joinType:b.joinType})),d=e.subqueries&&e.subqueries.length>0?cse(s,e.subqueries,n,{x:400,y:300},r):{subqueries:[],subqueryIdMap:new Map},h=d.subqueries,u=d.subqueryIdMap,f=e.filters.map(b=>{const w={id:Ds(),column:b.column,operator:b.operator,value:b.value,connector:b.connector};if(b.subqueryIndex!==void 0){const C=u.get(b.subqueryIndex);if(C){w.subqueryId=C;const y=h.find(x=>x.id===C);y&&(y.linkedFilterId=w.id)}}return w}),g=e.groupBy.map(b=>({id:Ds(),column:b.column})),m=e.having.map(b=>({id:Ds(),aggregateFunction:b.aggregateFunction,column:b.column,operator:b.operator,value:b.value,connector:b.connector})),p=e.orderBy.map(b=>({id:Ds(),column:b.column,direction:b.direction})),v=e.selectAggregates.map(b=>({id:Ds(),function:b.function,expression:b.expression,alias:b.alias}));return{tables:a,joins:c,filters:f,groupBy:g,having:m,orderBy:p,limit:e.limit,selectAggregates:v,subqueries:h,ctes:o}}function uO(){return crypto.randomUUID()}function dse(s){return{tables:s.tables.map(e=>({...e,selectedColumns:new Set(e.selectedColumns),columnAggregates:new Map(e.columnAggregates)})),joins:[...s.joins],filters:[...s.filters],groupBy:[...s.groupBy],having:[...s.having],orderBy:[...s.orderBy],limit:s.limit,selectAggregates:[...s.selectAggregates],subqueries:hse(s.subqueries)}}function hse(s){return s.map(e=>({...e,position:{...e.position},size:{...e.size},innerQuery:dse(e.innerQuery)}))}function dIe(s){return s.map(e=>({...e,position:{...e.position},size:{...e.size},innerQuery:dse(e.innerQuery)}))}function rU(){return{tables:[],joins:[],filters:[],groupBy:[],having:[],orderBy:[],limit:null,selectAggregates:[],subqueries:[]}}function use(s,e){for(const t of e){if(t.id===s)return t;const i=use(s,t.innerQuery.subqueries);if(i)return i}}function fse(s,e,t){for(const i of e){if(i.id===s)return t;const n=fse(s,i.innerQuery.subqueries,i);if(n!==void 0)return n}}function gse(s,e,t){for(let i=0;i<s.length;i++){if(s[i].id===e)return s[i]={...s[i],...t(s[i])},!0;if(gse(s[i].innerQuery.subqueries,e,t))return!0}return!1}function hIe(s,e,t){return{id:uO(),position:e,size:{width:300,height:200},role:s,linkedFilterId:t,innerQuery:rU()}}const mse=220,pse=280,PN=20;function IG(s,e,t){const i={id:uO(),tableName:s,position:e,selectedColumns:new Ch,columnAggregates:new Map},n=e.x+mse+PN,o=e.y+pse+PN;let r=null;return(n>t.width||o>t.height)&&(r={width:Math.max(t.width,n),height:Math.max(t.height,o)}),{table:i,newSize:r}}function EG(s,e){const t=s.tables.find(n=>n.id===e);if(!t)return;const i=t.tableName;s.joins=s.joins.filter(n=>n.sourceTable!==i&&n.targetTable!==i),s.filters=s.filters.filter(n=>!n.column.startsWith(`${i}.`)),s.orderBy=s.orderBy.filter(n=>!n.column.startsWith(`${i}.`)),s.tables=s.tables.filter(n=>n.id!==e)}function kG(s,e,t){const i=s.tables.find(n=>n.id===e);return i?(i.selectedColumns.has(t)?(i.selectedColumns.delete(t),i.columnAggregates.delete(t)):i.selectedColumns.add(t),!0):!1}function uIe(s,e,t,i){const n={id:uO(),function:e,expression:t,alias:i};return s.selectAggregates=[...s.selectAggregates,n],n.id}function DG(s,e,t,i){const n={id:uO(),tableName:s,position:t,selectedColumns:new Ch,columnAggregates:new Map,cteId:e},o=t.x+mse+PN,r=t.y+pse+PN;let a=null;return(o>i.width||r>i.height)&&(a={width:Math.max(i.width,o),height:Math.max(i.height,r)}),{table:n,newSize:a}}function fIe(){return crypto.randomUUID()}function gIe(s,e){return{id:fIe(),name:s,position:e,size:{width:300,height:200},innerQuery:rU()}}function mIe(s,e){const t=[];for(const i of s.innerQuery.tables){const n=g9(e,i.tableName);if(n)for(const o of i.selectedColumns){const r=n.columns.find(a=>a.name===o);if(r){const a=i.columnAggregates.get(o);a?t.push({name:a.alias||`${a.function.toLowerCase()}_${o}`,type:"numeric"}):t.push({name:r.name,type:r.type})}}}for(const i of s.innerQuery.selectAggregates)t.push({name:i.alias||`${i.function.toLowerCase()}_${i.expression.replace(/[^a-zA-Z0-9]/g,"_")}`,type:"numeric"});if(t.length===0&&s.innerQuery.tables.length>0){const i=s.innerQuery.tables[0],n=g9(e,i.tableName);if(n)for(const o of n.columns)t.push({name:o.name,type:o.type})}return t}function pIe(s,e){const t=[];for(const i of s)for(const[n,o]of i.columnAggregates)t.push({id:`col-${i.id}-${n}`,function:o.function,expression:`${i.tableName}.${n}`,alias:o.alias,source:"column",tableId:i.id,columnName:n});for(const i of e)t.push({id:i.id,function:i.function,expression:i.expression,alias:i.alias,source:"select"});return t}function _Ie(s,e,t,i){return{joins:e.filter(n=>n.sourceTable!==s&&n.targetTable!==s),filters:t.filter(n=>!n.column.startsWith(`${s}.`)),orderBy:i.filter(n=>!n.column.startsWith(`${s}.`))}}function Xy(){return crypto.randomUUID()}function bIe(s,e,t,i="AND"){return{id:Xy(),column:s,operator:e,value:t,connector:i}}function D0(s,e){return[...s,e]}function Hv(s,e,t){return s.map(i=>i.id===e?{...i,...t}:i)}function T0(s,e){return s.filter(t=>t.id!==e)}function vIe(s){return{id:Xy(),column:s}}function CIe(s,e,t,i,n="AND"){return{id:Xy(),aggregateFunction:s,column:e,operator:t,value:i,connector:n}}function wIe(s,e="ASC"){return{id:Xy(),column:s,direction:e}}function yIe(s,e,t){return{id:Xy(),function:s,expression:e,alias:t}}function SIe(s,e,t){return{id:Xy(),position:e,size:{width:300,height:200},role:s,linkedFilterId:t,innerQuery:rU()}}function xIe(s,e,t,i,n){const o=s.find(r=>r.id===e);return o?(i===null?o.columnAggregates.delete(t):o.columnAggregates.set(t,{function:i,alias:n}),!0):!1}function TG(){return crypto.randomUUID()}var aE,lE,cE,dE,hE,uE,fE,gE,mE,pE,_E,bE,vE,CE,wE,yE,SE,xE,LE,IE,EE,kE,DE,TE,NE;class LIe{constructor(){ke(this,aE,At(Dr(nse(hO))));ke(this,lE,At(Dr([])));ke(this,cE,At(Dr([])));ke(this,dE,At(Dr([])));ke(this,hE,At(Dr([])));ke(this,uE,At(Dr([])));ke(this,fE,At(Dr([])));ke(this,gE,At(100));ke(this,mE,At(null));ke(this,pE,At(Dr([])));ke(this,_E,At(Dr([])));ke(this,bE,At(Dr([])));ke(this,vE,At(null));ke(this,CE,At(null));ke(this,wE,X(()=>this.selectedSubqueryId?this.findSubqueryById(this.selectedSubqueryId)??null:null));ke(this,yE,X(()=>this.selectedCteId?this.ctes.find(e=>e.id===this.selectedCteId)??null:null));ke(this,SE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.filters:((e=this.selectedSubquery)==null?void 0:e.innerQuery.filters)??this.filters}));ke(this,xE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.groupBy:((e=this.selectedSubquery)==null?void 0:e.innerQuery.groupBy)??this.groupBy}));ke(this,LE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.having:((e=this.selectedSubquery)==null?void 0:e.innerQuery.having)??this.having}));ke(this,IE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.orderBy:((e=this.selectedSubquery)==null?void 0:e.innerQuery.orderBy)??this.orderBy}));ke(this,EE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.limit:((e=this.selectedSubquery)==null?void 0:e.innerQuery.limit)??this.limit}));ke(this,kE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.selectAggregates:((e=this.selectedSubquery)==null?void 0:e.innerQuery.selectAggregates)??this.selectAggregates}));ke(this,DE,X(()=>{var e;return this.selectedCte?this.selectedCte.innerQuery.tables:((e=this.selectedSubquery)==null?void 0:e.innerQuery.tables)??this.tables}));ke(this,TE,X(()=>pIe(this.activeTables,this.activeSelectAggregates)));ke(this,NE,X(()=>this.buildSql()))}get schema(){return I(Z(this,aE))}set schema(e){Le(Z(this,aE),e,!0)}get tables(){return I(Z(this,lE))}set tables(e){Le(Z(this,lE),e,!0)}get joins(){return I(Z(this,cE))}set joins(e){Le(Z(this,cE),e,!0)}get filters(){return I(Z(this,dE))}set filters(e){Le(Z(this,dE),e,!0)}get groupBy(){return I(Z(this,hE))}set groupBy(e){Le(Z(this,hE),e,!0)}get having(){return I(Z(this,uE))}set having(e){Le(Z(this,uE),e,!0)}get orderBy(){return I(Z(this,fE))}set orderBy(e){Le(Z(this,fE),e,!0)}get limit(){return I(Z(this,gE))}set limit(e){Le(Z(this,gE),e,!0)}get customSql(){return I(Z(this,mE))}set customSql(e){Le(Z(this,mE),e,!0)}get selectAggregates(){return I(Z(this,pE))}set selectAggregates(e){Le(Z(this,pE),e,!0)}get subqueries(){return I(Z(this,_E))}set subqueries(e){Le(Z(this,_E),e,!0)}get ctes(){return I(Z(this,bE))}set ctes(e){Le(Z(this,bE),e,!0)}get selectedSubqueryId(){return I(Z(this,vE))}set selectedSubqueryId(e){Le(Z(this,vE),e,!0)}get selectedCteId(){return I(Z(this,CE))}set selectedCteId(e){Le(Z(this,CE),e,!0)}get selectedSubquery(){return I(Z(this,wE))}set selectedSubquery(e){Le(Z(this,wE),e)}get selectedCte(){return I(Z(this,yE))}set selectedCte(e){Le(Z(this,yE),e)}get activeFilters(){return I(Z(this,SE))}set activeFilters(e){Le(Z(this,SE),e)}get activeGroupBy(){return I(Z(this,xE))}set activeGroupBy(e){Le(Z(this,xE),e)}get activeHaving(){return I(Z(this,LE))}set activeHaving(e){Le(Z(this,LE),e)}get activeOrderBy(){return I(Z(this,IE))}set activeOrderBy(e){Le(Z(this,IE),e)}get activeLimit(){return I(Z(this,EE))}set activeLimit(e){Le(Z(this,EE),e)}get activeSelectAggregates(){return I(Z(this,kE))}set activeSelectAggregates(e){Le(Z(this,kE),e)}get activeTables(){return I(Z(this,DE))}set activeTables(e){Le(Z(this,DE),e)}get activeDisplayAggregates(){return I(Z(this,TE))}set activeDisplayAggregates(e){Le(Z(this,TE),e)}get generatedSql(){return I(Z(this,NE))}set generatedSql(e){Le(Z(this,NE),e)}get snapshot(){return{tables:this.tables.map(e=>({...e,selectedColumns:new Set(e.selectedColumns),columnAggregates:new Map(e.columnAggregates)})),joins:[...this.joins],filters:[...this.filters],groupBy:[...this.groupBy],having:[...this.having],orderBy:[...this.orderBy],limit:this.limit,selectAggregates:[...this.selectAggregates],subqueries:hse(this.subqueries),ctes:dIe(this.ctes)}}addTable(e,t){if(!this.getSchemaTable(e))return;const n={id:TG(),tableName:e,position:t,selectedColumns:new Ch,columnAggregates:new Map};return this.tables=[...this.tables,n],this.customSql=null,n}removeTable(e){const t=this.tables.find(n=>n.id===e);if(!t)return;const i=_Ie(t.tableName,this.joins,this.filters,this.orderBy);this.joins=i.joins,this.filters=i.filters,this.orderBy=i.orderBy,this.tables=this.tables.filter(n=>n.id!==e),this.customSql=null}updateTablePosition(e,t){this.tables=this.tables.map(i=>i.id===e?{...i,position:t}:i)}toggleColumn(e,t){const i=this.tables.find(n=>n.id===e);i&&(i.selectedColumns.has(t)?(i.selectedColumns.delete(t),i.columnAggregates.delete(t)):i.selectedColumns.add(t),this.tables=[...this.tables],this.customSql=null)}selectAllColumns(e){const t=this.tables.find(n=>n.id===e);if(!t)return;const i=this.getSchemaTable(t.tableName);if(i){for(const n of i.columns)t.selectedColumns.add(n.name);this.tables=[...this.tables],this.customSql=null}}clearColumns(e){const t=this.tables.find(i=>i.id===e);t&&(t.selectedColumns.clear(),this.tables=[...this.tables],this.customSql=null)}addJoin(e,t,i,n,o="INNER"){const r={id:TG(),sourceTable:e,sourceColumn:t,targetTable:i,targetColumn:n,joinType:o};return this.joins=[...this.joins,r],this.customSql=null,r}updateJoinType(e,t){this.joins=this.joins.map(i=>i.id===e?{...i,joinType:t}:i),this.customSql=null}removeJoin(e){this.joins=this.joins.filter(t=>t.id!==e),this.customSql=null}setColumnAggregate(e,t,i,n){const o=this.tables.find(r=>r.id===e);o&&(i===null?o.columnAggregates.delete(t):o.columnAggregates.set(t,{function:i,alias:n}),this.tables=[...this.tables],this.customSql=null)}clearColumnAggregate(e,t){this.setColumnAggregate(e,t,null)}findSubqueryById(e,t=this.subqueries){return use(e,t)}updateSubqueryRecursive(e,t){gse(this.subqueries,e,t),this.subqueries=[...this.subqueries]}addSubquery(e,t,i){const n=hIe(e,t,i);return this.subqueries=[...this.subqueries,n],this.customSql=null,n}removeSubquery(e){const t=this.findSubqueryById(e);if(!t)return;t.linkedFilterId&&(this.filters=this.filters.map(n=>n.id===t.linkedFilterId?{...n,subqueryId:void 0}:n));const i=fse(e,this.subqueries);i?(i.innerQuery.subqueries=i.innerQuery.subqueries.filter(n=>n.id!==e),this.subqueries=[...this.subqueries]):this.subqueries=this.subqueries.filter(n=>n.id!==e),this.customSql=null}updateSubqueryPosition(e,t){this.updateSubqueryRecursive(e,()=>({position:t}))}updateSubquerySize(e,t){this.updateSubqueryRecursive(e,()=>({size:t})),this.customSql=null}updateSubqueryRole(e,t){this.updateSubqueryRecursive(e,()=>({role:t})),this.customSql=null}updateSubqueryAlias(e,t){this.updateSubqueryRecursive(e,()=>({alias:t||void 0})),this.customSql=null}linkSubqueryToFilter(e,t){this.updateSubqueryRecursive(e,()=>({linkedFilterId:t})),this.customSql=null}getSubquery(e){return this.findSubqueryById(e)}addTableToSubquery(e,t,i){if(!this.getSchemaTable(t))return;const n=this.findSubqueryById(e);if(!n)return;const{table:o,newSize:r}=IG(t,i,n.size);return r&&(n.size=r),n.innerQuery.tables=[...n.innerQuery.tables,o],this.subqueries=[...this.subqueries],this.customSql=null,o}removeTableFromSubquery(e,t){const i=this.findSubqueryById(e);i&&(EG(i.innerQuery,t),this.subqueries=[...this.subqueries],this.customSql=null)}toggleSubqueryColumn(e,t,i){const n=this.findSubqueryById(e);n&&kG(n.innerQuery,t,i)&&(this.subqueries=[...this.subqueries],this.customSql=null)}addSubquerySelectAggregate(e,t,i,n){const o=this.findSubqueryById(e);if(!o)return;const r=uIe(o.innerQuery,t,i,n);return this.subqueries=[...this.subqueries],this.customSql=null,r}applyToActiveClause(e,t){this.selectedCte?(this.selectedCte.innerQuery[e]=t(this.selectedCte.innerQuery[e]),this.ctes=[...this.ctes]):this.selectedSubquery?(this.selectedSubquery.innerQuery[e]=t(this.selectedSubquery.innerQuery[e]),this.subqueries=[...this.subqueries]):this[e]=t(this[e]),this.customSql=null}addActiveFilter(e,t,i,n="AND"){const o=bIe(e,t,i,n);return this.applyToActiveClause("filters",r=>D0(r,o)),o}updateActiveFilter(e,t){this.applyToActiveClause("filters",i=>Hv(i,e,t))}removeActiveFilter(e){this.applyToActiveClause("filters",t=>T0(t,e))}addActiveGroupBy(e){const t=vIe(e);return this.applyToActiveClause("groupBy",i=>D0(i,t)),t}updateActiveGroupBy(e,t){this.applyToActiveClause("groupBy",i=>Hv(i,e,{column:t}))}removeActiveGroupBy(e){this.applyToActiveClause("groupBy",t=>T0(t,e))}addActiveHaving(e,t,i,n,o="AND"){const r=CIe(e,t,i,n,o);return this.applyToActiveClause("having",a=>D0(a,r)),r}updateActiveHaving(e,t){this.applyToActiveClause("having",i=>Hv(i,e,t))}removeActiveHaving(e){this.applyToActiveClause("having",t=>T0(t,e))}addActiveOrderBy(e,t="ASC"){const i=wIe(e,t);return this.applyToActiveClause("orderBy",n=>D0(n,i)),i}updateActiveOrderBy(e,t){this.applyToActiveClause("orderBy",i=>Hv(i,e,{direction:t}))}updateActiveOrderByColumn(e,t){this.applyToActiveClause("orderBy",i=>Hv(i,e,{column:t}))}removeActiveOrderBy(e){this.applyToActiveClause("orderBy",t=>T0(t,e))}setActiveLimit(e){this.applyToActiveClause("limit",()=>e)}addActiveSelectAggregate(e,t,i){const n=yIe(e,t,i);return this.applyToActiveClause("selectAggregates",o=>D0(o,n)),n.id}updateActiveSelectAggregate(e,t){this.applyToActiveClause("selectAggregates",i=>Hv(i,e,t))}removeActiveSelectAggregate(e){this.applyToActiveClause("selectAggregates",t=>T0(t,e))}setActiveColumnAggregate(e,t,i,n){xIe(this.activeTables,e,t,i,n)&&(this.selectedCte?this.ctes=[...this.ctes]:this.selectedSubquery?this.subqueries=[...this.subqueries]:this.tables=[...this.tables],this.customSql=null)}clearActiveColumnAggregate(e,t){this.setActiveColumnAggregate(e,t,null)}addActiveSubquery(e,t,i){const n=SIe(e,t,i);return this.selectedSubquery?(this.selectedSubquery.innerQuery.subqueries=[...this.selectedSubquery.innerQuery.subqueries,n],this.subqueries=[...this.subqueries]):this.subqueries=[...this.subqueries,n],this.customSql=null,n}get activeSubqueries(){var e;return((e=this.selectedSubquery)==null?void 0:e.innerQuery.subqueries)??this.subqueries}removeActiveSubquery(e){if(this.selectedSubquery){const t=this.selectedSubquery.innerQuery.subqueries.find(i=>i.id===e);if(t!=null&&t.linkedFilterId){const i=this.selectedSubquery.innerQuery.filters.find(n=>n.id===t.linkedFilterId);i&&this.updateActiveFilter(i.id,{subqueryId:void 0})}this.selectedSubquery.innerQuery.subqueries=this.selectedSubquery.innerQuery.subqueries.filter(i=>i.id!==e),this.subqueries=[...this.subqueries]}else this.removeSubquery(e);this.customSql=null}linkActiveSubqueryToFilter(e,t){this.selectedSubquery?(this.selectedSubquery.innerQuery.subqueries=this.selectedSubquery.innerQuery.subqueries.map(i=>i.id===e?{...i,linkedFilterId:t}:i),this.subqueries=[...this.subqueries]):this.linkSubqueryToFilter(e,t),this.customSql=null}addCte(e,t){const i=gIe(e,t);return this.ctes=[...this.ctes,i],this.customSql=null,i}removeCte(e){this.ctes.find(i=>i.id===e)&&(this.tables=this.tables.filter(i=>i.cteId!==e),this.ctes=this.ctes.filter(i=>i.id!==e),this.customSql=null)}updateCteName(e,t){this.ctes=this.ctes.map(i=>i.id===e?{...i,name:t}:i),this.customSql=null}updateCtePosition(e,t){this.ctes=this.ctes.map(i=>i.id===e?{...i,position:t}:i)}updateCteSize(e,t){this.ctes=this.ctes.map(i=>i.id===e?{...i,size:t}:i),this.customSql=null}getCte(e){return this.ctes.find(t=>t.id===e)}addTableToCte(e,t,i){if(!this.getSchemaTable(t))return;const n=this.ctes.find(a=>a.id===e);if(!n)return;const{table:o,newSize:r}=IG(t,i,n.size);return r&&(n.size=r),n.innerQuery.tables=[...n.innerQuery.tables,o],this.ctes=[...this.ctes],this.customSql=null,o}removeTableFromCte(e,t){const i=this.ctes.find(n=>n.id===e);i&&(EG(i.innerQuery,t),this.ctes=[...this.ctes],this.customSql=null)}toggleCteColumn(e,t,i){const n=this.ctes.find(o=>o.id===e);n&&kG(n.innerQuery,t,i)&&(this.ctes=[...this.ctes],this.customSql=null)}getCteColumns(e){const t=this.ctes.find(i=>i.id===e);return t?mIe(t,this.schema):[]}addCteReference(e,t){const i=this.ctes.find(o=>o.id===e);if(!i||!i.name)return;const{table:n}=DG(i.name,e,t,{width:0,height:0});return this.tables=[...this.tables,n],this.customSql=null,n}addCteReferenceToSubquery(e,t,i){const n=this.ctes.find(l=>l.id===t);if(!n||!n.name)return;const o=this.findSubqueryById(e);if(!o)return;const{table:r,newSize:a}=DG(n.name,t,i,o.size);return a&&(o.size=a),o.innerQuery.tables=[...o.innerQuery.tables,r],this.subqueries=[...this.subqueries],this.customSql=null,r}buildSql(){return iIe(this.tables,this.joins,this.filters,this.groupBy,this.having,this.orderBy,this.limit,this.selectAggregates,this.subqueries,this.ctes)}applyFromParsedSql(e){const t=cIe(this.schema,e,this.tables,this.ctes,this.subqueries);this.tables=t.tables,this.joins=t.joins,this.filters=t.filters,this.groupBy=t.groupBy,this.having=t.having,this.orderBy=t.orderBy,this.limit=t.limit,this.selectAggregates=t.selectAggregates,this.subqueries=t.subqueries,this.ctes=t.ctes}reset(){this.tables=[],this.joins=[],this.filters=[],this.groupBy=[],this.having=[],this.orderBy=[],this.limit=100,this.customSql=null,this.selectAggregates=[],this.subqueries=[],this.ctes=[],this.selectedCteId=null}setSchema(e){this.schema=e}getSchemaTable(e){return g9(this.schema,e)}toSerializable(){return aIe(this)}fromSerializable(e){const t=lIe(e);this.tables=t.tables,this.joins=t.joins,this.filters=t.filters,this.groupBy=t.groupBy,this.having=t.having,this.orderBy=t.orderBy,this.limit=t.limit,this.customSql=t.customSql,this.selectAggregates=t.selectAggregates,this.subqueries=t.subqueries,this.ctes=t.ctes}}aE=new WeakMap,lE=new WeakMap,cE=new WeakMap,dE=new WeakMap,hE=new WeakMap,uE=new WeakMap,fE=new WeakMap,gE=new WeakMap,mE=new WeakMap,pE=new WeakMap,_E=new WeakMap,bE=new WeakMap,vE=new WeakMap,CE=new WeakMap,wE=new WeakMap,yE=new WeakMap,SE=new WeakMap,xE=new WeakMap,LE=new WeakMap,IE=new WeakMap,EE=new WeakMap,kE=new WeakMap,DE=new WeakMap,TE=new WeakMap,NE=new WeakMap;const _se="query-builder";function Pct(s){const e=s??new LIe;return ey(_se,e),e}function uv(){return wb(_se)}var IIe=Re("<!> <!>",1),EIe=Re("<span><!></span>"),kIe=Re('<div class="px-3 py-1.5 flex items-center gap-2 hover:bg-muted/30 relative"><!> <!> <div class="w-3.5 h-3.5 shrink-0 flex items-center justify-center"><!></div> <div class="w-4 flex items-center justify-center shrink-0"><!></div> <span> </span> <span class="text-muted-foreground shrink-0 font-mono"> </span> <!></div>'),DIe=Re('<div class="text-xs divide-y divide-border"></div>'),TIe=Re('<div class="px-3 py-4 text-sm text-muted-foreground text-center">Table not found in schema</div>'),NIe=Re('<div><div><div class="flex items-center gap-2 min-w-0"><!> <span> </span></div> <div class="flex items-center gap-1 shrink-0"><!> <!></div></div> <!></div>');function RIe(s,e){Lt(e,!0);const t={COUNT:qie,SUM:cme,AVG:ome,MIN:ime,MAX:sme};let i=Ae(e,"isConnectable",3,!0);const n=uv(),o=X(()=>{if(e.data.cteId&&e.data.subqueryId)return e.data.cteId;const M=n.tables.find(R=>R.id===e.data.tableId);return M!=null&&M.cteId?M.cteId:null}),r=[{value:"none",label:"None"},{value:"COUNT",label:"COUNT"},{value:"SUM",label:"SUM"},{value:"AVG",label:"AVG"},{value:"MIN",label:"MIN"},{value:"MAX",label:"MAX"}],a=X(()=>{if(I(o)){const M=n.getCteColumns(I(o));if(M.length>0)return{name:e.data.tableName,columns:M.map(R=>({name:R.name,type:R.type,primaryKey:!1}))}}return n.getSchemaTable(e.data.tableName)});function l(M){e.data.cteId&&!I(o)?n.toggleCteColumn(e.data.cteId,e.data.tableId,M):e.data.subqueryId?n.toggleSubqueryColumn(e.data.subqueryId,e.data.tableId,M):n.toggleColumn(e.data.tableId,M)}function c(){if(e.data.cteId&&!I(o)){if(I(a))for(const R of I(a).columns)e.data.selectedColumns.has(R.name)||n.toggleCteColumn(e.data.cteId,e.data.tableId,R.name)}else if(e.data.subqueryId){const R=n.getSchemaTable(e.data.tableName);if(R)for(const T of R.columns)e.data.selectedColumns.has(T.name)||n.toggleSubqueryColumn(e.data.subqueryId,e.data.tableId,T.name)}else n.selectAllColumns(e.data.tableId)}function d(){if(e.data.cteId&&!I(o))for(const R of e.data.selectedColumns)n.toggleCteColumn(e.data.cteId,e.data.tableId,R);else if(e.data.subqueryId)for(const R of e.data.selectedColumns)n.toggleSubqueryColumn(e.data.subqueryId,e.data.tableId,R);else n.clearColumns(e.data.tableId)}function h(M,R){if(e.data.cteId&&!I(o)){const A=n.getCte(e.data.cteId);if(A){const N=A.innerQuery.tables.find(P=>P.id===e.data.tableId);N&&(R==="none"?N.columnAggregates.delete(M):N.columnAggregates.set(M,{function:R}),n.ctes=[...n.ctes],n.customSql=null)}}else if(e.data.subqueryId){const A=n.getSubquery(e.data.subqueryId);if(A){const N=A.innerQuery.tables.find(P=>P.id===e.data.tableId);N&&(R==="none"?N.columnAggregates.delete(M):N.columnAggregates.set(M,{function:R}),n.subqueries=[...n.subqueries],n.customSql=null)}}else R==="none"?n.clearColumnAggregate(e.data.tableId,M):n.setColumnAggregate(e.data.tableId,M,R)}var u=NIe(),f=Ee(u),g=Ee(f),m=Ee(g);{var p=M=>{nL(M,{class:"size-4 shrink-0 text-violet-500"})},v=M=>{Bie(M,{class:"size-4 shrink-0 text-muted-foreground"})};St(m,M=>{I(o)?M(p):M(v,!1)})}var b=ue(m,2),w=Ee(b,!0);Ie(b),Ie(g);var C=ue(g,2),y=Ee(C);fo(y,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs",onclick:c,children:(M,R)=>{Oi();var T=pn("All");Q(M,T)},$$slots:{default:!0}});var x=ue(y,2);fo(x,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs",onclick:d,children:(M,R)=>{Oi();var T=pn("None");Q(M,T)},$$slots:{default:!0}}),Ie(C),Ie(f);var S=ue(f,2);{var L=M=>{Fie(M,{class:"max-h-[240px] overflow-x-visible",orientation:"vertical",children:(R,T)=>{var A=DIe();Xn(A,21,()=>I(a).columns,N=>N.name,(N,P)=>{const W=X(()=>e.data.selectedColumns.has(I(P).name)),H=X(()=>!!I(P).foreignKey),G=X(()=>e.data.columnAggregates.get(I(P).name));var V=kIe(),U=Ee(V);Ib(U,{type:"target",get position(){return Ci.Left},get id(){return`${I(P).name??""}-target`},get isConnectable(){return i()}});var $=ue(U,2);Oie($,{get checked(){return I(W)},onCheckedChange:()=>l(I(P).name)});var Y=ue($,2),se=Ee(Y);{var j=mt=>{var Ke=gt(),nt=De(Ke);{let ft=X(()=>{var Pe;return((Pe=I(G))==null?void 0:Pe.function)??"none"});Rt(nt,()=>Oc,(Pe,Be)=>{Be(Pe,{type:"single",get value(){return I(ft)},onValueChange:Me=>{Me&&h(I(P).name,Me)},children:(Me,rt)=>{var Et=IIe(),qt=De(Et);{let at=X(()=>I(G)?"bg-primary/15 hover:bg-primary/25":"bg-transparent hover:bg-muted");Rt(qt,()=>Ac,(yt,Jt)=>{Jt(yt,{size:"sm",get class(){return`!h-3.5 !w-3.5 !min-h-0 min-w-0 border-0 shadow-none p-0 rounded-sm [&>svg:last-child]:hidden ${I(at)??""}`},children:(li,Vi)=>{var jt=gt(),Mi=De(jt);{var ni=pi=>{const ci=X(()=>t[I(G).function]);var Ai=gt(),Li=De(Ai);Rt(Li,()=>I(ci),(Yi,oi)=>{oi(Yi,{class:"size-3 text-primary"})}),Q(pi,Ai)},yn=pi=>{dme(pi,{class:"size-3 text-muted-foreground/50"})};St(Mi,pi=>{I(G)?pi(ni):pi(yn,!1)})}Q(li,jt)},$$slots:{default:!0}})})}var Ge=ue(qt,2);Rt(Ge,()=>Pc,(at,yt)=>{yt(at,{children:(Jt,li)=>{var Vi=gt(),jt=De(Vi);Xn(jt,17,()=>r,tc,(Mi,ni)=>{var yn=gt(),pi=De(yn);Rt(pi,()=>hl,(ci,Ai)=>{Ai(ci,{get value(){return I(ni).value},get label(){return I(ni).label},children:(Li,Yi)=>{Oi();var oi=pn();ze(()=>tt(oi,I(ni).label)),Q(Li,oi)},$$slots:{default:!0}})}),Q(Mi,yn)}),Q(Jt,Vi)},$$slots:{default:!0}})}),Q(Me,Et)},$$slots:{default:!0}})})}Q(mt,Ke)};St(se,mt=>{I(W)&&mt(j)})}Ie(Y);var ie=ue(Y,2),te=Ee(ie);{var pe=mt=>{var Ke=EIe(),nt=Ee(Ke);Wge(nt,{class:"size-3 text-blue-500"}),Ie(Ke),ze(()=>{var ft,Pe;return Xt(Ke,"title",`FK -> ${((ft=I(P).foreignKey)==null?void 0:ft.table)??""}.${((Pe=I(P).foreignKey)==null?void 0:Pe.column)??""}`)}),Q(mt,Ke)};St(te,mt=>{I(H)&&mt(pe)})}Ie(ie);var J=ue(ie,2);let le;var be=Ee(J,!0);Ie(J);var Ce=ue(J,2),Je=Ee(Ce,!0);Ie(Ce);var qe=ue(Ce,2);Ib(qe,{type:"source",get position(){return Ci.Right},get id(){return`${I(P).name??""}-source`},get isConnectable(){return i()}}),Ie(V),ze(()=>{le=Qn(J,1,"flex-1 truncate font-mono",null,le,{"text-primary":I(G)}),Xt(J,"title",I(P).name),tt(be,I(P).name),tt(Je,I(P).type)}),Q(N,V)}),Ie(A),Q(R,A)},$$slots:{default:!0}})},E=M=>{var R=TIe();Q(M,R)};St(S,M=>{I(a)?M(L):M(E,!1)})}Ie(u),ze(()=>{Qn(u,1,`bg-card border rounded-lg shadow-md min-w-[220px] ${I(o)?"border-violet-500/30":"border-border"}`),Qn(f,1,`border-b border-border px-3 py-2 flex items-center justify-between gap-2 ${I(o)?"bg-violet-500/10":"bg-muted/50"}`),Qn(b,1,`font-medium text-sm truncate ${I(o)?"text-violet-600 dark:text-violet-400":""}`),Xt(b,"title",e.data.tableName),tt(w,e.data.tableName)}),Q(s,u),It()}var MIe=Re("<!> <!>",1),AIe=Re('<span class="text-xs text-muted-foreground">AS</span> <!>',1),PIe=Re('<span class="text-xs bg-muted/50 rounded px-1.5 py-0.5 text-muted-foreground"> </span>'),OIe=Re('<span class="text-xs bg-indigo-500/20 rounded px-1.5 py-0.5 text-indigo-600 dark:text-indigo-400"> </span>'),FIe=Re('<div class="absolute inset-0 flex items-center justify-center text-muted-foreground text-xs pointer-events-none">Drag tables here to build subquery</div>'),BIe=Re('<!> <div><div><div class="flex items-center gap-2 min-w-0 flex-1"><!> <!> <!></div> <div class="flex items-center gap-1 shrink-0"><!> <!> <!></div> <!></div>  <div class="flex-1 p-2 relative pointer-events-none"><!></div> <!></div>',1);function WIe(s,e){Lt(e,!0);const t={where:"border-indigo-500/50 bg-indigo-500/5",from:"border-emerald-500/50 bg-emerald-500/5",select:"border-amber-500/50 bg-amber-500/5"},i={where:"bg-indigo-500/10 border-indigo-500/30",from:"bg-emerald-500/10 border-emerald-500/30",select:"bg-amber-500/10 border-amber-500/30"},n=[{value:"where",label:"WHERE"},{value:"from",label:"FROM"},{value:"select",label:"SELECT"}];let o=Ae(e,"isConnectable",3,!0),r=Ae(e,"selected",3,!1);const a=uv();function l(H,G,V){for(const U of G){if(U.id===H)return V;const $=l(H,U.innerQuery.subqueries,U);if($!==void 0)return $}}function c(){const H=l(e.data.subqueryId,a.subqueries);H?(H.innerQuery.subqueries=H.innerQuery.subqueries.filter(G=>G.id!==e.data.subqueryId),a.subqueries=[...a.subqueries]):a.removeSubquery(e.data.subqueryId)}function d(H){H&&a.updateSubqueryRole(e.data.subqueryId,H)}function h(H){const G=H.target;a.updateSubqueryAlias(e.data.subqueryId,G.value)}var u=BIe(),f=De(u);tse(f,{minWidth:250,minHeight:150,get isVisible(){return r()},lineStyle:"border-color: var(--color-primary)",handleStyle:"background-color: var(--color-primary); width: 8px; height: 8px;",onResize:(H,G)=>{a.updateSubquerySize(e.data.subqueryId,{width:G.width,height:G.height})}});var g=ue(f,2),m=Ee(g),p=Ee(m),v=Ee(p);CN(v,{class:"size-4 shrink-0 text-muted-foreground"});var b=ue(v,2);Rt(b,()=>Oc,(H,G)=>{G(H,{type:"single",get value(){return e.data.role},onValueChange:d,children:(V,U)=>{var $=MIe(),Y=De($);Rt(Y,()=>Ac,(j,ie)=>{ie(j,{size:"sm",class:"h-6 w-20 text-xs",children:(te,pe)=>{Oi();var J=pn();ze(le=>tt(J,le),[()=>{var le;return(le=n.find(be=>be.value===e.data.role))==null?void 0:le.label}]),Q(te,J)},$$slots:{default:!0}})});var se=ue(Y,2);Rt(se,()=>Pc,(j,ie)=>{ie(j,{children:(te,pe)=>{var J=gt(),le=De(J);Xn(le,17,()=>n,tc,(be,Ce)=>{var Je=gt(),qe=De(Je);Rt(qe,()=>hl,(mt,Ke)=>{Ke(mt,{get value(){return I(Ce).value},get label(){return I(Ce).label},children:(nt,ft)=>{Oi();var Pe=pn();ze(()=>tt(Pe,I(Ce).label)),Q(nt,Pe)},$$slots:{default:!0}})}),Q(be,Je)}),Q(te,J)},$$slots:{default:!0}})}),Q(V,$)},$$slots:{default:!0}})});var w=ue(b,2);{var C=H=>{var G=AIe(),V=ue(De(G),2);{let U=X(()=>e.data.alias??"");ul(V,{type:"text",placeholder:"alias",get value(){return I(U)},oninput:h,class:"h-6 text-xs w-20 font-mono"})}Q(H,G)};St(w,H=>{(e.data.role==="from"||e.data.role==="select")&&H(C)})}Ie(p);var y=ue(p,2),x=Ee(y);{var S=H=>{var G=PIe(),V=Ee(G);Ie(G),ze(()=>tt(V,`${e.data.tableCount??""} ${e.data.tableCount===1?"table":"tables"}`)),Q(H,G)};St(x,H=>{e.data.tableCount>0&&H(S)})}var L=ue(x,2);{var E=H=>{var G=OIe(),V=Ee(G);Ie(G),ze(()=>tt(V,`${e.data.nestedSubqueryCount??""} nested`)),Q(H,G)};St(L,H=>{e.data.nestedSubqueryCount&&e.data.nestedSubqueryCount>0&&H(E)})}var M=ue(L,2);{var R=H=>{wN(H,{class:"size-3 text-muted-foreground"})};St(M,H=>{e.data.hasAggregates&&H(R)})}Ie(y);var T=ue(y,2);fo(T,{variant:"ghost",size:"icon-sm",class:"size-6 text-muted-foreground hover:text-destructive shrink-0",onclick:c,children:(H,G)=>{Yf(H,{class:"size-3"})},$$slots:{default:!0}}),Ie(m);var A=ue(m,2),N=Ee(A);{var P=H=>{var G=FIe();Q(H,G)};St(N,H=>{e.data.tableCount===0&&H(P)})}Ie(A);var W=ue(A,2);Ib(W,{type:"source",get position(){return Ci.Right},id:"subquery-output",get isConnectable(){return o()},class:"!w-3 !h-3 !bg-primary !border-2 !border-background"}),Ie(g),ze(()=>{Qn(g,1,`rounded-lg border-2 border-dashed ${t[e.data.role]??""} min-w-[250px] min-h-[150px] h-full w-full flex flex-col`),Qn(m,1,`flex items-center justify-between gap-2 px-3 py-2 rounded-t-md border-b ${i[e.data.role]??""}`)}),Q(s,u),It()}var HIe=Re('<span class="text-xs bg-violet-500/20 rounded px-1.5 py-0.5 text-violet-600 dark:text-violet-400"> </span>'),VIe=Re('<div class="absolute inset-0 flex items-center justify-center text-muted-foreground text-xs pointer-events-none">Drag tables here to build CTE query</div>'),zIe=Re('<!>  <div><div class="flex items-center justify-between gap-2 px-3 py-2 rounded-t-md border-b bg-violet-500/10 border-violet-500/30"><div class="flex items-center gap-2 min-w-0 flex-1"><!> <span class="text-xs text-muted-foreground font-medium">WITH</span> <!> <span class="text-xs text-muted-foreground font-medium">AS</span></div> <div class="flex items-center gap-1 shrink-0"><!> <!></div> <!></div> <div class="flex-1 p-2 relative pointer-events-none"><!></div></div>',1);function UIe(s,e){Lt(e,!0),Ae(e,"isConnectable",3,!0);let t=Ae(e,"selected",3,!1);const i=uv();function n(){i.removeCte(e.data.cteId)}function o(L){const E=L.target;i.updateCteName(e.data.cteId,E.value)}function r(L){L.stopPropagation()}function a(){i.selectedCteId=e.data.cteId,i.selectedSubqueryId=null}var l=zIe(),c=De(l);tse(c,{minWidth:250,minHeight:150,get isVisible(){return t()},lineStyle:"border-color: var(--color-primary)",handleStyle:"background-color: var(--color-primary); width: 8px; height: 8px;",onResize:(L,E)=>{i.updateCteSize(e.data.cteId,{width:E.width,height:E.height})}});var d=ue(c,2);d.__click=a;var h=Ee(d),u=Ee(h),f=Ee(u);nL(f,{class:"size-4 shrink-0 text-violet-500"});var g=ue(f,4);ul(g,{type:"text",placeholder:"cte_name",get value(){return e.data.name},oninput:o,onkeydown:r,class:"h-6 text-xs w-28 font-mono bg-violet-500/5 border-violet-500/30 focus:border-violet-500"}),Oi(2),Ie(u);var m=ue(u,2),p=Ee(m);{var v=L=>{var E=HIe(),M=Ee(E);Ie(E),ze(()=>tt(M,`${e.data.tableCount??""} ${e.data.tableCount===1?"table":"tables"}`)),Q(L,E)};St(p,L=>{e.data.tableCount>0&&L(v)})}var b=ue(p,2);{var w=L=>{wN(L,{class:"size-3 text-muted-foreground"})};St(b,L=>{e.data.hasAggregates&&L(w)})}Ie(m);var C=ue(m,2);fo(C,{variant:"ghost",size:"icon-sm",class:"size-6 text-muted-foreground hover:text-destructive shrink-0",onclick:n,children:(L,E)=>{Yf(L,{class:"size-3"})},$$slots:{default:!0}}),Ie(h);var y=ue(h,2),x=Ee(y);{var S=L=>{var E=VIe();Q(L,E)};St(x,L=>{e.data.tableCount===0&&L(S)})}Ie(y),Ie(d),ze(()=>Qn(d,1,`rounded-lg border-2 border-dashed bg-violet-500/5 min-w-[250px] min-h-[150px] h-full w-full flex flex-col ${t()?"border-violet-500":"border-violet-500/50"}`)),Q(s,l),It()}dv(["click"]);const C5=(s,e)=>{let t=()=>e==null?void 0:e().type,i=()=>e==null?void 0:e().class;var n=GIe(),o=Ee(n);{var r=l=>{var c=$Ie();Oi(2),Q(l,c)},a=l=>{var c=gt(),d=De(c);{var h=f=>{var g=qIe();Oi(),Q(f,g)},u=f=>{var g=gt(),m=De(g);{var p=b=>{var w=jIe();Oi(),Q(b,w)},v=b=>{var w=gt(),C=De(w);{var y=x=>{var S=KIe();Oi(),Q(x,S)};St(C,x=>{t()==="FULL"&&x(y)},!0)}Q(b,w)};St(m,b=>{t()==="RIGHT"?b(p):b(v,!1)},!0)}Q(f,g)};St(d,f=>{t()==="LEFT"?f(h):f(u,!1)},!0)}Q(l,c)};St(o,l=>{t()==="INNER"?l(r):l(a,!1)})}Ie(n),ze(()=>Qn(n,0,jo(i()))),Q(s,n)};var $Ie=fs('<circle cx="9" cy="12" r="6" class="opacity-30"></circle><circle cx="15" cy="12" r="6" class="opacity-30"></circle><path d="M12 7.5a6 6 0 0 1 0 9 6 6 0 0 1 0-9z" fill="currentColor" stroke="none"></path>',1),qIe=fs('<circle cx="9" cy="12" r="6" fill="currentColor" class="opacity-60"></circle><circle cx="15" cy="12" r="6" class="opacity-30"></circle>',1),jIe=fs('<circle cx="9" cy="12" r="6" class="opacity-30"></circle><circle cx="15" cy="12" r="6" fill="currentColor" class="opacity-60"></circle>',1),KIe=fs('<circle cx="9" cy="12" r="6" fill="currentColor" class="opacity-60"></circle><circle cx="15" cy="12" r="6" fill="currentColor" class="opacity-60"></circle>',1),GIe=fs('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><!></svg>'),YIe=Re('<!> <span class="font-medium"> </span> <!>',1),XIe=Re('<!> <div class="flex-1 min-w-0"><div class="font-medium text-sm"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div> <!>',1),ZIe=fs("<!><!>",1),QIe=Re('<div class="flex items-center gap-2"><!> <div><div class="font-medium"> </div> <div class="text-xs text-muted-foreground"> </div></div></div>'),JIe=fs("<!><!>",1),eEe=fs('<!><circle stroke-width="2"></circle><circle stroke-width="2"></circle><!>',1);function tEe(s,e){Lt(e,!0);const t=uv(),i=[{type:"INNER",short:"INNER",label:"Inner Join",description:"Only matching rows"},{type:"LEFT",short:"LEFT",label:"Left Join",description:"All left + matching right"},{type:"RIGHT",short:"RIGHT",label:"Right Join",description:"All right + matching left"},{type:"FULL",short:"FULL",label:"Full Outer",description:"All rows from both"}],n=X(()=>cO({sourceX:e.sourceX,sourceY:e.sourceY,sourcePosition:e.sourcePosition,targetX:e.targetX,targetY:e.targetY,targetPosition:e.targetPosition})),o=X(()=>I(n)[0]),r=X(()=>I(n)[1]),a=X(()=>I(n)[2]),l=X(()=>{var C;return((C=e.data)==null?void 0:C.joinType)??"INNER"}),c=X(()=>i.find(C=>C.type===I(l))??i[0]),d=X(()=>I(l)==="LEFT"||I(l)==="FULL"),h=X(()=>I(l)==="RIGHT"||I(l)==="FULL"),u=5;function f(C){var y;(y=e.data)!=null&&y.joinId&&t.updateJoinType(e.data.joinId,C)}let g=At(!1);var m=eEe(),p=De(m);Yy(p,{get path(){return I(o)},get markerEnd(){return e.markerEnd},get style(){return e.style}});var v=ue(p);Xt(v,"r",u);var b=ue(v);Xt(b,"r",u);var w=ue(b);oU(w,{get x(){return I(r)},get y(){return I(a)},class:"nodrag nopan pointer-events-auto !bg-transparent",children:(C,y)=>{var x=gt(),S=De(x);{let L=X(()=>I(g)?!1:void 0);Rt(S,()=>Age,(E,M)=>{M(E,{get open(){return I(L)},children:(R,T)=>{var A=JIe(),N=De(A);Rt(N,()=>Pge,(W,H)=>{H(W,{children:(G,V)=>{var U=gt(),$=De(U);Rt($,()=>Wie,(Y,se)=>{se(Y,{get open(){return I(g)},set open(j){Le(g,j,!0)},children:(j,ie)=>{var te=ZIe(),pe=De(te);Rt(pe,()=>Hie,(le,be)=>{be(le,{class:"flex items-center gap-1 px-2 py-1 rounded-md bg-popover text-popover-foreground border border-border text-xs shadow-md hover:bg-accent transition-colors",children:(Ce,Je)=>{var qe=YIe(),mt=De(qe);C5(mt,()=>({type:I(l),class:"size-3.5 opacity-70"}));var Ke=ue(mt,2),nt=Ee(Ke,!0);Ie(Ke);var ft=ue(Ke,2);Jm(ft,{class:"size-3 opacity-50"}),ze(()=>tt(nt,I(c).short)),Q(Ce,qe)},$$slots:{default:!0}})});var J=ue(pe);Rt(J,()=>Vie,(le,be)=>{be(le,{align:"center",class:"w-44",children:(Ce,Je)=>{var qe=gt(),mt=De(qe);Xn(mt,17,()=>i,Ke=>Ke.type,(Ke,nt)=>{var ft=gt(),Pe=De(ft);Rt(Pe,()=>zie,(Be,Me)=>{Me(Be,{onclick:()=>f(I(nt).type),class:"flex items-center gap-2 cursor-pointer",children:(rt,Et)=>{var qt=XIe(),Ge=De(qt);C5(Ge,()=>({type:I(nt).type,class:"size-4 shrink-0"}));var at=ue(Ge,2),yt=Ee(at),Jt=Ee(yt,!0);Ie(yt);var li=ue(yt,2),Vi=Ee(li,!0);Ie(li),Ie(at);var jt=ue(at,2);{var Mi=ni=>{Hge(ni,{class:"size-4 shrink-0 text-primary"})};St(jt,ni=>{I(nt).type===I(l)&&ni(Mi)})}ze(()=>{tt(Jt,I(nt).label),tt(Vi,I(nt).description)}),Q(rt,qt)},$$slots:{default:!0}})}),Q(Ke,ft)}),Q(Ce,qe)},$$slots:{default:!0}})}),Q(j,te)},$$slots:{default:!0}})}),Q(G,U)},$$slots:{default:!0}})});var P=ue(N);Rt(P,()=>Oge,(W,H)=>{H(W,{children:(G,V)=>{var U=QIe(),$=Ee(U);C5($,()=>({type:I(l),class:"size-4 shrink-0"}));var Y=ue($,2),se=Ee(Y),j=Ee(se,!0);Ie(se);var ie=ue(se,2),te=Ee(ie,!0);Ie(ie),Ie(Y),Ie(U),ze(()=>{tt(j,I(c).label),tt(te,I(c).description)}),Q(G,U)},$$slots:{default:!0}})}),Q(R,A)},$$slots:{default:!0}})})}Q(C,x)},$$slots:{default:!0}}),ze(()=>{Xt(v,"cx",e.sourceX),Xt(v,"cy",e.sourceY),Qn(v,0,jo(I(d)?"fill-primary stroke-primary":"fill-background stroke-muted-foreground")),Xt(b,"cx",e.targetX),Xt(b,"cy",e.targetY),Qn(b,0,jo(I(h)?"fill-primary stroke-primary":"fill-background stroke-muted-foreground"))}),Q(s,m),It()}var iEe=Re('<div class="bg-indigo-500/90 text-white text-xs px-1.5 py-0.5 rounded font-medium shadow-sm"> </div>'),nEe=fs('<!><circle class="fill-indigo-500 stroke-background" stroke-width="2"></circle><circle class="fill-indigo-500 stroke-background" stroke-width="2"></circle><!>',1);function sEe(s,e){Lt(e,!0);const t=X(()=>cO({sourceX:e.sourceX,sourceY:e.sourceY,sourcePosition:e.sourcePosition,targetX:e.targetX,targetY:e.targetY,targetPosition:e.targetPosition})),i=X(()=>I(t)[0]),n=X(()=>I(t)[1]),o=X(()=>I(t)[2]),r=X(()=>{var u;return((u=e.data)==null?void 0:u.operator)??""});var a=nEe(),l=De(a);{let u=X(()=>e.style??"");Yy(l,{get path(){return I(i)},get markerEnd(){return e.markerEnd},get style(){return`stroke: rgb(99 102 241); stroke-width: 2; stroke-dasharray: 5 3; ${I(u)??""}`}})}var c=ue(l);Xt(c,"r",4);var d=ue(c);Xt(d,"r",4);var h=ue(d);oU(h,{get x(){return I(n)},get y(){return I(o)},class:"nodrag nopan !bg-transparent",children:(u,f)=>{var g=iEe(),m=Ee(g,!0);Ie(g),ze(()=>tt(m,I(r)||"subquery")),Q(u,g)},$$slots:{default:!0}}),ze(()=>{Xt(c,"cx",e.sourceX),Xt(c,"cy",e.sourceY),Xt(d,"cx",e.targetX),Xt(d,"cy",e.targetY)}),Q(s,a),It()}const bse=()=>wb("dnd");function Oct(s,e){Lt(e,!0);let t=At(null);ey("dnd",{set current(o){Le(t,o,!0)},get current(){return I(t)}}),ty(()=>{Le(t,null)});var i=gt(),n=De(i);Hi(n,()=>e.children),Q(s,i),It()}var oEe=Re("<!> <!>",1),rEe=Re('<div class="flex-1 h-full" aria-label="Query builder canvas" role="application" tabindex="-1"><!></div>');function Fct(s,e){Lt(e,!0);const t=bse(),i=uv(),{screenToFlowPosition:n}=Jne(),o={tableNode:RIe,subqueryNode:WIe,cteNode:UIe},r={joinEdge:tEe,subqueryEdge:sEe};function a(j){for(const ie of i.ctes){j.push({id:ie.id,type:"cteNode",position:ie.position,style:`width: ${ie.size.width}px; height: ${ie.size.height}px;`,selected:ie.id===i.selectedCteId,zIndex:0,data:{cteId:ie.id,name:ie.name,tableCount:ie.innerQuery.tables.length,hasAggregates:ie.innerQuery.selectAggregates.length>0||ie.innerQuery.tables.some(te=>te.columnAggregates.size>0)}});for(const te of ie.innerQuery.tables)j.push({id:te.id,type:"tableNode",position:te.position,parentId:ie.id,extent:"parent",zIndex:5,data:{tableName:te.tableName,tableId:te.id,selectedColumns:te.selectedColumns,columnAggregates:te.columnAggregates,cteId:ie.id}})}}function l(j,ie,te,pe,J=0){for(const le of ie){const be={id:le.id,type:"subqueryNode",position:le.position,style:`width: ${le.size.width}px; height: ${le.size.height}px;`,selected:le.id===i.selectedSubqueryId,zIndex:J*10,data:{subqueryId:le.id,role:le.role,alias:le.alias,tableCount:le.innerQuery.tables.length,hasAggregates:le.innerQuery.selectAggregates.length>0||le.innerQuery.tables.some(Ce=>Ce.columnAggregates.size>0),nestedSubqueryCount:le.innerQuery.subqueries.length,parentSubqueryId:pe}};te&&(be.parentId=te,be.extent="parent"),j.push(be);for(const Ce of le.innerQuery.tables)j.push({id:Ce.id,type:"tableNode",position:Ce.position,parentId:le.id,extent:"parent",zIndex:J*10+5,data:{tableName:Ce.tableName,tableId:Ce.id,selectedColumns:Ce.selectedColumns,columnAggregates:Ce.columnAggregates,subqueryId:le.id,cteId:Ce.cteId}});le.innerQuery.subqueries.length>0&&l(j,le.innerQuery.subqueries,le.id,le.id,J+1)}}let c=X(()=>{const j=[];a(j),l(j,i.subqueries);for(const ie of i.tables)j.push({id:ie.id,type:"tableNode",position:ie.position,data:{tableName:ie.tableName,tableId:ie.id,selectedColumns:ie.selectedColumns,columnAggregates:ie.columnAggregates,cteId:ie.cteId}});return j});function d(j){for(const ie of i.ctes)for(const te of ie.innerQuery.joins){const pe=ie.innerQuery.tables.find(le=>le.tableName===te.sourceTable),J=ie.innerQuery.tables.find(le=>le.tableName===te.targetTable);j.push({id:te.id,type:"joinEdge",source:(pe==null?void 0:pe.id)??"",sourceHandle:`${te.sourceColumn}-source`,target:(J==null?void 0:J.id)??"",targetHandle:`${te.targetColumn}-target`,data:{joinId:te.id,joinType:te.joinType,cteId:ie.id}})}}function h(j,ie,te,pe,J){for(const le of ie){for(const be of le.innerQuery.joins){const Ce=le.innerQuery.tables.find(qe=>qe.tableName===be.sourceTable),Je=le.innerQuery.tables.find(qe=>qe.tableName===be.targetTable);j.push({id:be.id,type:"joinEdge",source:(Ce==null?void 0:Ce.id)??"",sourceHandle:`${be.sourceColumn}-source`,target:(Je==null?void 0:Je.id)??"",targetHandle:`${be.targetColumn}-target`,data:{joinId:be.id,joinType:be.joinType,subqueryId:le.id}})}if(le.role==="where"&&le.linkedFilterId){const be=pe.find(Ce=>Ce.id===le.linkedFilterId);if(be&&be.column){const[Ce,Je]=be.column.split(".");if(Ce&&Je){const qe=te.find(mt=>mt.tableName===Ce);qe&&j.push({id:`subquery-edge-${le.id}`,type:"subqueryEdge",source:le.id,sourceHandle:"subquery-output",target:qe.id,targetHandle:`${Je}-target`,data:{operator:be.operator,subqueryId:le.id,filterId:be.id}})}}}le.innerQuery.subqueries.length>0&&h(j,le.innerQuery.subqueries,le.innerQuery.tables,le.innerQuery.filters,le.id)}}let u=X(()=>{const j=[];d(j);for(const ie of i.joins){const te=i.tables.find(J=>J.tableName===ie.sourceTable),pe=i.tables.find(J=>J.tableName===ie.targetTable);j.push({id:ie.id,type:"joinEdge",source:(te==null?void 0:te.id)??"",sourceHandle:`${ie.sourceColumn}-source`,target:(pe==null?void 0:pe.id)??"",targetHandle:`${ie.targetColumn}-target`,data:{joinId:ie.id,joinType:ie.joinType}})}return h(j,i.subqueries,i.tables,i.filters),j});function f(j){return i.ctes.find(ie=>ie.id===j)}function g(j,ie=i.subqueries){for(const te of ie){if(te.id===j)return te;const pe=g(j,te.innerQuery.subqueries);if(pe)return pe}}function m(j,ie=i.subqueries,te){for(const pe of ie){if(pe.id===j)return te;const J=m(j,pe.innerQuery.subqueries,pe);if(J!==void 0)return J}}const p=220,v=200,b=250,w=150,C=20,y=40,x=100;function S(j){if(j.type==="subqueryNode"){const ie=g(j.id);return(ie==null?void 0:ie.size)??{width:b,height:w}}return{width:p,height:v}}function L(j){const ie=j.parentId;if(!ie)return;const te=g(ie);if(!te||j.position.x<-500||j.position.y<-500||j.position.x>5e3||j.position.y>5e3)return;const pe=S(j),J=j.position.x+pe.width,le=j.position.y+pe.height,be=40,Ce=te.size.height-be;let Je=te.size.width,qe=te.size.height,mt=0,Ke=0;if(j.position.x<C){const Pe=Math.min(C-j.position.x+y,x);Pe>0&&(Je+=Pe,mt=Pe)}if(j.position.y<C){const Pe=Math.min(C-j.position.y+y,x);Pe>0&&(qe+=Pe,Ke=Pe)}if(J+C>te.size.width){const Pe=J+y;Je=Math.max(Je,Math.min(Pe,te.size.width+x))}if(le+C>Ce){const Pe=le+be+y;qe=Math.max(qe,Math.min(Pe,te.size.height+x))}const nt=Je!==te.size.width||qe!==te.size.height,ft=mt>0||Ke>0;if(nt||ft){if(ft){te.position.x-=mt,te.position.y-=Ke;for(const Pe of te.innerQuery.tables)Pe.position.x+=mt,Pe.position.y+=Ke;for(const Pe of te.innerQuery.subqueries)Pe.position.x+=mt,Pe.position.y+=Ke}te.size.width=Je,te.size.height=qe,i.subqueries=[...i.subqueries]}}function E({targetNode:j}){j&&j.parentId&&L(j)}function M({targetNode:j}){if(!j)return;const ie=f(j.id);if(ie){ie.position=j.position,i.ctes=[...i.ctes];return}const te=g(j.id);if(te){te.position=j.position,i.subqueries=[...i.subqueries];return}const pe=j.parentId;if(pe){const J=f(pe);if(J){const be=J.innerQuery.tables.find(Ce=>Ce.id===j.id);be&&(be.position=j.position,i.ctes=[...i.ctes]);return}const le=g(pe);if(le){const be=le.innerQuery.tables.find(Ce=>Ce.id===j.id);be&&(be.position=j.position,i.subqueries=[...i.subqueries]);return}}i.updateTablePosition(j.id,j.position)}function R(j,ie=i.subqueries){if(ie===i.subqueries){const te=i.tables.find(pe=>pe.id===j);if(te)return{tableName:te.tableName};for(const pe of i.ctes){const J=pe.innerQuery.tables.find(le=>le.id===j);if(J)return{tableName:J.tableName,cteId:pe.id}}}for(const te of ie){const pe=te.innerQuery.tables.find(le=>le.id===j);if(pe)return{tableName:pe.tableName,subqueryId:te.id};const J=R(j,te.innerQuery.subqueries);if(J)return J}}function T(j){const{source:ie,sourceHandle:te,target:pe,targetHandle:J}=j;if(!ie||!pe||!te||!J)return;const le=R(ie),be=R(pe);if(!le||!be)return;const Ce=te.replace("-source",""),Je=J.replace("-target","");if(le.cteId&&le.cteId===be.cteId){const qe=f(le.cteId);if(qe){const mt={id:crypto.randomUUID(),sourceTable:le.tableName,sourceColumn:Ce,targetTable:be.tableName,targetColumn:Je,joinType:"INNER"};qe.innerQuery.joins=[...qe.innerQuery.joins,mt],i.ctes=[...i.ctes]}return}if(le.subqueryId&&le.subqueryId===be.subqueryId){const qe=g(le.subqueryId);if(qe){const mt={id:crypto.randomUUID(),sourceTable:le.tableName,sourceColumn:Ce,targetTable:be.tableName,targetColumn:Je,joinType:"INNER"};qe.innerQuery.joins=[...qe.innerQuery.joins,mt],i.subqueries=[...i.subqueries]}return}i.addJoin(le.tableName,Ce,be.tableName,Je,"INNER")}function A(j){j.preventDefault(),j.dataTransfer&&(j.dataTransfer.dropEffect="move")}function N(j,ie=i.subqueries,te={x:0,y:0}){for(const pe of ie){if(pe.id===j)return{x:pe.position.x+te.x,y:pe.position.y+te.y};const J=N(j,pe.innerQuery.subqueries,{x:pe.position.x+te.x,y:pe.position.y+te.y+40});if(J)return J}return null}function P(j){j.preventDefault();const ie=t.current;if(!ie)return;const te=n({x:j.clientX,y:j.clientY}),pe=W(te),J=H(te);if(ie==="__cte__"){te.x-=150,te.y-=100,i.addCte("",te);return}if(ie.startsWith("__cte__")){const le=ie.replace("__cte__","");if(J){const be=N(J.id),Ce={x:te.x-((be==null?void 0:be.x)??0)-10,y:te.y-((be==null?void 0:be.y)??0)-40};i.addCteReferenceToSubquery(J.id,le,Ce);return}te.x-=110,te.y-=20,i.addCteReference(le,te);return}if(ie==="__subquery__")if(J){const le=N(J.id),be={x:te.x-((le==null?void 0:le.x)??0)-10,y:te.y-((le==null?void 0:le.y)??0)-40-50},Ce={id:crypto.randomUUID(),position:be,size:{width:300,height:200},role:"where",innerQuery:{tables:[],joins:[],filters:[],groupBy:[],having:[],orderBy:[],limit:null,selectAggregates:[],subqueries:[]}};J.innerQuery.subqueries=[...J.innerQuery.subqueries,Ce],i.subqueries=[...i.subqueries]}else te.x-=150,te.y-=100,i.addSubquery("from",te);else if(pe){const le={x:te.x-pe.position.x-10,y:te.y-pe.position.y-40};if(i.getSchemaTable(ie)){const Ce={id:crypto.randomUUID(),tableName:ie,position:le,selectedColumns:new Ch,columnAggregates:new Map};pe.innerQuery.tables=[...pe.innerQuery.tables,Ce],i.ctes=[...i.ctes]}}else if(J){const le=N(J.id),be={x:te.x-((le==null?void 0:le.x)??0)-10,y:te.y-((le==null?void 0:le.y)??0)-40};if(i.getSchemaTable(ie)){const Je={id:crypto.randomUUID(),tableName:ie,position:be,selectedColumns:new Ch,columnAggregates:new Map};J.innerQuery.tables=[...J.innerQuery.tables,Je],i.subqueries=[...i.subqueries]}}else te.x-=110,te.y-=20,i.addTable(ie,te)}function W(j){for(const ie of i.ctes){const{width:te,height:pe}=ie.size;if(j.x>=ie.position.x&&j.x<=ie.position.x+te&&j.y>=ie.position.y&&j.y<=ie.position.y+pe)return ie}return null}function H(j,ie=i.subqueries,te={x:0,y:0}){for(const pe of ie){const J=pe.position.x+te.x,le=pe.position.y+te.y,{width:be,height:Ce}=pe.size;if(j.x>=J&&j.x<=J+be&&j.y>=le&&j.y<=le+Ce){const Je=H(j,pe.innerQuery.subqueries,{x:J,y:le+40});return Je||pe}}return null}const G=({nodes:j,edges:ie})=>{for(const te of ie){const pe=te.data,J=pe==null?void 0:pe.cteId,le=pe==null?void 0:pe.subqueryId;if(J){const be=f(J);be&&(be.innerQuery.joins=be.innerQuery.joins.filter(Ce=>Ce.id!==te.id),i.ctes=[...i.ctes])}else if(le){const be=g(le);be&&(be.innerQuery.joins=be.innerQuery.joins.filter(Ce=>Ce.id!==te.id),i.subqueries=[...i.subqueries])}else i.removeJoin(te.id)}for(const te of j){if(f(te.id)){i.removeCte(te.id);continue}if(g(te.id)){const be=m(te.id);be?be.innerQuery.subqueries=be.innerQuery.subqueries.filter(Ce=>Ce.id!==te.id):i.subqueries=i.subqueries.filter(Ce=>Ce.id!==te.id),i.subqueries=[...i.subqueries];continue}const le=te.parentId;if(le){const be=f(le);if(be){be.innerQuery.tables=be.innerQuery.tables.filter(Je=>Je.id!==te.id),i.ctes=[...i.ctes];continue}const Ce=g(le);if(Ce){Ce.innerQuery.tables=Ce.innerQuery.tables.filter(Je=>Je.id!==te.id),i.subqueries=[...i.subqueries];continue}}i.removeTable(te.id)}};function V(j){(j.key==="Delete"||j.key==="Backspace")&&j.preventDefault()}let U=null;const $=({nodes:j})=>{U!==null&&(clearTimeout(U),U=null);const ie=j.find(pe=>pe.type==="subqueryNode"),te=j.find(pe=>pe.type==="cteNode");ie?(i.selectedSubqueryId=ie.id,i.selectedCteId=null):te?(i.selectedCteId=te.data.cteId,i.selectedSubqueryId=null):j.length>0?(i.selectedSubqueryId=null,i.selectedCteId=null):U=setTimeout(()=>{U=null,i.selectedSubqueryId=null,i.selectedCteId=null},0)};var Y=rEe();Y.__keydown=V;var se=Ee(Y);RLe(se,{get nodeTypes(){return o},get edgeTypes(){return r},fitView:!0,onnodedrag:E,onnodedragstop:M,ondrop:P,ondragover:A,onconnect:T,ondelete:G,onselectionchange:$,deleteKey:["Delete","Backspace"],get nodes(){return I(c)},set nodes(j){Le(c,j)},get edges(){return I(u)},set edges(j){Le(u,j)},children:(j,ie)=>{var te=oEe(),pe=De(te);jLe(pe,{});var J=ue(pe,2);JLe(J,{get variant(){return Gu.Dots},gap:16}),Q(j,te)},$$slots:{default:!0}}),Ie(Y),Q(s,Y),It()}dv(["keydown"]);var aEe=Re('<div class="px-2 py-4 text-sm text-muted-foreground text-center"> </div>'),lEe=Re('<div role="listitem" class="flex items-center gap-2 px-2 py-1.5 rounded text-sm cursor-grab hover:bg-muted"><!> <!> <span class="flex-1 truncate"> </span> <span class="text-xs text-muted-foreground shrink-0"> </span></div>'),cEe=Re('<div role="listitem" class="flex items-center gap-2 px-2 py-1.5 rounded text-sm cursor-grab hover:bg-violet-500/10"><!> <!> <span class="flex-1 truncate font-mono text-violet-600 dark:text-violet-400"> </span> <span class="text-xs text-muted-foreground shrink-0"> </span></div>'),dEe=Re('<div class="my-2 border-t border-border"></div> <div class="px-2 py-1 text-xs text-muted-foreground font-medium"> </div> <!>',1),hEe=Re('<div class="my-2 border-t border-border"></div> <div role="listitem" class="flex items-center gap-2 px-2 py-1.5 rounded text-sm cursor-grab hover:bg-indigo-500/10 border border-dashed border-indigo-500/30"><!> <!> <span class="flex-1 truncate text-indigo-600 dark:text-indigo-400"> </span> <span class="text-xs text-muted-foreground shrink-0"> </span></div> <div role="listitem" class="flex items-center gap-2 px-2 py-1.5 rounded text-sm cursor-grab hover:bg-violet-500/10 border border-dashed border-violet-500/30"><!> <!> <span class="flex-1 truncate text-violet-600 dark:text-violet-400"> </span> <span class="text-xs text-muted-foreground shrink-0"> </span></div> <!>',1),uEe=Re('<div class="p-2 space-y-0.5" role="list"><!> <!> <!></div>'),fEe=Re('<div class="h-full flex flex-col bg-muted/30"><div class="p-3 border-b border-border"><h3 class="font-medium text-sm"> </h3> <p class="text-xs text-muted-foreground"> </p></div> <div class="flex-1 overflow-hidden"><!></div></div>');function Bct(s,e){Lt(e,!0);const t=Ae(e,"showAdvancedOptions",3,!0),i=X(()=>e.schema??nse(hO)),n=bse(),o=uv();function r(m,p){m.dataTransfer&&(n.current=p,m.dataTransfer.setData("text/plain",p),m.dataTransfer.effectAllowed="move")}var a=fEe(),l=Ee(a),c=Ee(l),d=Ee(c,!0);Ie(c);var h=ue(c,2),u=Ee(h,!0);Ie(h),Ie(l);var f=ue(l,2),g=Ee(f);Fie(g,{class:"h-full",children:(m,p)=>{var v=uEe(),b=Ee(v);{var w=S=>{var L=aEe(),E=Ee(L,!0);Ie(L),ze(M=>tt(E,M),[()=>QCe()]),Q(S,L)};St(b,S=>{I(i).length===0&&S(w)})}var C=ue(b,2);Xn(C,17,()=>I(i),S=>S.name,(S,L)=>{var E=lEe();Xt(E,"draggable",!0);var M=Ee(E);mS(M,{class:"size-4 text-muted-foreground shrink-0"});var R=ue(M,2);Bie(R,{class:"size-4 text-muted-foreground shrink-0"});var T=ue(R,2),A=Ee(T,!0);Ie(T);var N=ue(T,2),P=Ee(N,!0);Ie(N),Ie(E),ze(()=>{Xt(T,"title",I(L).name),tt(A,I(L).name),tt(P,I(L).columns.length)}),ku("dragstart",E,W=>r(W,I(L).name)),Q(S,E)});var y=ue(C,2);{var x=S=>{var L=hEe(),E=ue(De(L),2);Xt(E,"draggable",!0);var M=Ee(E);mS(M,{class:"size-4 text-indigo-500/70 shrink-0"});var R=ue(M,2);CN(R,{class:"size-4 text-indigo-500 shrink-0"});var T=ue(R,2),A=Ee(T,!0);Ie(T);var N=ue(T,2),P=Ee(N,!0);Ie(N),Ie(E);var W=ue(E,2);Xt(W,"draggable",!0);var H=Ee(W);mS(H,{class:"size-4 text-violet-500/70 shrink-0"});var G=ue(H,2);nL(G,{class:"size-4 text-violet-500 shrink-0"});var V=ue(G,2),U=Ee(V,!0);Ie(V);var $=ue(V,2),Y=Ee($,!0);Ie($),Ie(W);var se=ue(W,2);{var j=ie=>{var te=dEe(),pe=ue(De(te),2),J=Ee(pe,!0);Ie(pe);var le=ue(pe,2);Xn(le,17,()=>o.ctes,be=>be.id,(be,Ce)=>{var Je=gt(),qe=De(Je);{var mt=Ke=>{var nt=cEe();Xt(nt,"draggable",!0);var ft=Ee(nt);mS(ft,{class:"size-4 text-muted-foreground shrink-0"});var Pe=ue(ft,2);nL(Pe,{class:"size-4 text-violet-500 shrink-0"});var Be=ue(Pe,2),Me=Ee(Be,!0);Ie(Be);var rt=ue(Be,2),Et=Ee(rt,!0);Ie(rt),Ie(nt),ze(()=>{tt(Me,I(Ce).name),tt(Et,I(Ce).innerQuery.tables.length)}),ku("dragstart",nt,qt=>r(qt,`__cte__${I(Ce).id}`)),Q(Ke,nt)};St(qe,Ke=>{I(Ce).name&&Ke(mt)})}Q(be,Je)}),ze(be=>tt(J,be),[()=>k1e()]),Q(ie,te)};St(se,ie=>{o.ctes.length>0&&ie(j)})}ze((ie,te,pe,J)=>{tt(A,ie),tt(P,te),tt(U,pe),tt(Y,J)},[()=>s1e(),()=>d1e(),()=>p1e(),()=>y1e()]),ku("dragstart",E,ie=>r(ie,"__subquery__")),ku("dragstart",W,ie=>r(ie,"__cte__")),Q(S,L)};St(y,S=>{t()&&S(x)})}Ie(v),Q(m,v)},$$slots:{default:!0}}),Ie(f),Ie(a),ze((m,p)=>{tt(d,m),tt(u,p)},[()=>HCe(),()=>jCe()]),Q(s,a),It()}var gEe=Re("<div><!> <span> </span> <!></div>"),mEe=Re('<span class="text-xs bg-muted rounded-full px-2 py-0.5 text-muted-foreground"> </span>'),pEe=Re("<!> ",1),_Ee=Re('<div class="flex items-center gap-2"><!> <!> <span class="font-medium text-sm"> </span> <!></div> <!>',1),bEe=Re("<!> <!>",1),vEe=Re("<!> <!>",1),CEe=Re("<!> ",1),wEe=Re("<!> <!>",1),yEe=Re("<!> <!>",1),SEe=Re('<div class="flex items-center gap-1"><!> <!></div>'),xEe=Re('<div class="flex items-center gap-1"><!> <!></div>'),LEe=Re('<div class="flex items-center gap-2 flex-wrap"><!> <!> <!> <!> <!></div>'),IEe=Re('<p class="text-xs text-muted-foreground"> </p>'),EEe=Re('<div class="px-3 pb-3 space-y-2"><!> <!></div>'),kEe=Re('<div class="border-b border-border"><!> <!></div>'),DEe=Re('<span class="text-xs bg-muted rounded-full px-2 py-0.5 text-muted-foreground"> </span>'),TEe=Re("<!> ",1),NEe=Re('<div class="flex items-center gap-2"><!> <!> <span class="font-medium text-sm"> </span> <!></div> <!>',1),REe=Re('<div class="flex items-center gap-2"><!> <!></div>'),MEe=Re('<p class="text-xs text-muted-foreground"> </p>'),AEe=Re('<div class="px-3 pb-3 space-y-2"><!> <!></div>'),PEe=Re('<div class="border-b border-border"><!> <!></div>'),OEe=Re('<span class="text-xs bg-muted rounded-full px-2 py-0.5 text-muted-foreground"> </span>'),FEe=Re("<!> ",1),BEe=Re('<div class="flex items-center gap-2"><!> <!> <span class="font-medium text-sm"> </span> <!></div> <!>',1),WEe=Re("<!> <!>",1),HEe=Re('<div class="flex items-center gap-2 flex-wrap"><!> <span class="text-xs text-muted-foreground">(</span> <!> <span class="text-xs text-muted-foreground">)</span> <span class="text-xs text-muted-foreground"> </span> <!> <!></div>'),VEe=Re('<p class="text-xs text-muted-foreground"> </p>'),zEe=Re('<div class="px-3 pb-3 space-y-2"><!> <!></div>'),UEe=Re('<div class="border-b border-border"><!> <!></div>'),$Ee=Re('<span class="text-xs bg-muted rounded-full px-2 py-0.5 text-muted-foreground"> </span>'),qEe=Re("<!> ",1),jEe=Re('<div class="flex items-center gap-2"><!> <!> <span class="font-medium text-sm"> </span> <!></div> <!>',1),KEe=Re("<!> <!>",1),GEe=Re("<!> <!>",1),YEe=Re("<!> <!>",1),XEe=Re('<div class="flex items-center gap-2 flex-wrap"><!> <!> <span class="text-xs text-muted-foreground">(</span> <!> <span class="text-xs text-muted-foreground">)</span> <!> <!> <!></div>'),ZEe=Re('<p class="text-xs text-muted-foreground"> </p>'),QEe=Re('<div class="px-3 pb-3 space-y-2"><!> <!></div>'),JEe=Re('<div class="border-b border-border"><!> <!></div>'),eke=Re('<span class="text-xs bg-muted rounded-full px-2 py-0.5 text-muted-foreground"> </span>'),tke=Re("<!> ",1),ike=Re('<div class="flex items-center gap-2"><!> <!> <span class="font-medium text-sm"> </span> <!></div> <!>',1),nke=Re("<!> <!>",1),ske=Re('<div class="flex items-center gap-2"><!> <!> <!></div>'),oke=Re('<p class="text-xs text-muted-foreground"> </p>'),rke=Re('<div class="px-3 pb-3 space-y-2"><!> <!></div>'),ake=Re('<div class="border-b border-border"><!> <!></div>'),lke=Re('<div class="flex items-center gap-2"><!> <!> <span class="font-medium text-sm"> </span></div>'),cke=Re('<div class="px-3 pb-3"><div class="flex items-center gap-3"><span class="text-xs text-muted-foreground"> </span> <!> <span class="text-xs text-muted-foreground"> </span> <div class="flex items-center gap-2 ml-4"><!> <!></div></div></div>'),dke=Re("<div><!> <!></div>"),hke=Re('<div class="border-t bg-muted/30 h-full overflow-auto"><!> <!> <!> <!> <!> <!> <!></div>');function Wct(s,e){Lt(e,!0);const t=uv(),i=X(()=>t.selectedSubqueryId!==null),n=X(()=>t.selectedCteId!==null),o=X(()=>I(i)||I(n)),r=X(()=>{var J;return I(n)?R_e({name:((J=t.selectedCte)==null?void 0:J.name)||"unnamed"}):I(i)?c5():U_e()}),a=X(()=>t.activeSubqueries.filter(J=>J.role==="where"));let l=At(!0),c=At(!0),d=At(!0),h=At(!0),u=At(!0),f=At(!0);const g=[{value:"=",label:()=>bve()},{value:"!=",label:()=>xve()},{value:">",label:()=>FK()},{value:"<",label:()=>BK()},{value:">=",label:()=>FK()},{value:"<=",label:()=>BK()},{value:"LIKE",label:()=>Hve()},{value:"IN",label:()=>jve()},{value:"NOT IN",label:()=>Qve()},{value:"IS NULL",label:()=>sCe()},{value:"IS NOT NULL",label:()=>dCe()},{value:"IS TRUE",label:()=>pCe()},{value:"IS FALSE",label:()=>yCe()},{value:"IS NOT TRUE",label:()=>kCe()},{value:"IS NOT FALSE",label:()=>ACe()}];function m(J){const le=g.find(be=>be.value===J);return le?le.label():J}const p=[{value:"ASC",label:"ASC"},{value:"DESC",label:"DESC"}],v=[{value:"AND",label:"AND"},{value:"OR",label:"OR"}],b=[{value:"COUNT",label:"COUNT"},{value:"SUM",label:"SUM"},{value:"AVG",label:"AVG"},{value:"MIN",label:"MIN"},{value:"MAX",label:"MAX"}],w=[{value:"=",label:"="},{value:"!=",label:"!="},{value:">",label:">"},{value:"<",label:"<"},{value:">=",label:">="},{value:"<=",label:"<="}];function C(J){return!["IS NULL","IS NOT NULL","IS TRUE","IS FALSE","IS NOT TRUE","IS NOT FALSE"].includes(J)}function y(J){return!!J.subqueryId}function x(J,le){if(le){const be=t.addActiveSubquery("where",{x:50,y:50},J);t.updateActiveFilter(J,{subqueryId:be.id,value:""})}else{const be=t.activeFilters.find(Ce=>Ce.id===J);be!=null&&be.subqueryId&&t.removeActiveSubquery(be.subqueryId),t.updateActiveFilter(J,{subqueryId:void 0})}}function S(J,le){if(le==="__new__"){const be=t.addActiveSubquery("where",{x:50,y:50},J);t.updateActiveFilter(J,{subqueryId:be.id,value:""})}else t.updateActiveFilter(J,{subqueryId:le,value:""}),t.linkActiveSubqueryToFilter(le,J)}function L(){t.addActiveFilter("","=","","AND")}function E(){t.addActiveGroupBy("")}function M(){t.addActiveHaving("COUNT","",">","","AND")}function R(){t.addActiveOrderBy("","ASC")}function T(){t.addActiveSelectAggregate("COUNT","*","")}function A(J){J.source==="column"&&J.tableId&&J.columnName?t.clearActiveColumnAggregate(J.tableId,J.columnName):J.source==="select"&&t.removeActiveSelectAggregate(J.id)}function N(J,le){J.source==="column"&&J.tableId&&J.columnName?t.setActiveColumnAggregate(J.tableId,J.columnName,le,J.alias):J.source==="select"&&t.updateActiveSelectAggregate(J.id,{function:le})}function P(J,le){J.source==="column"&&J.tableId&&J.columnName?t.setActiveColumnAggregate(J.tableId,J.columnName,J.function,le||void 0):J.source==="select"&&t.updateActiveSelectAggregate(J.id,{alias:le||void 0})}function W(J,le){J.source==="column"&&J.tableId&&J.columnName?(t.clearActiveColumnAggregate(J.tableId,J.columnName),t.addActiveSelectAggregate(J.function,le,J.alias)):J.source==="select"&&t.updateActiveSelectAggregate(J.id,{expression:le})}function H(J){const be=J.target.value.trim();if(/^\{\{.+\}\}$/.test(be)){t.setActiveLimit(be);return}const Ce=parseInt(be,10);!isNaN(Ce)&&Ce>0?t.setActiveLimit(Ce):be===""&&t.setActiveLimit(100)}function G(J){J?t.setActiveLimit(null):t.setActiveLimit(100)}var V=hke(),U=Ee(V);{var $=J=>{var le=gEe(),be=Ee(le);{let mt=X(()=>I(n)?"text-violet-500":"text-indigo-500");nL(be,{get class(){return`size-3.5 ${I(mt)??""}`}})}var Ce=ue(be,2),Je=Ee(Ce,!0);Ie(Ce);var qe=ue(Ce,2);{let mt=X(()=>I(n)?"text-violet-600 hover:text-violet-700 hover:bg-violet-500/10":"text-indigo-600 hover:text-indigo-700 hover:bg-indigo-500/10");fo(qe,{variant:"ghost",size:"sm",get class(){return`h-5 px-2 text-xs ml-auto ${I(mt)??""}`},onclick:()=>{t.selectedSubqueryId=null,t.selectedCteId=null},children:(Ke,nt)=>{Oi();var ft=pn();ze(Pe=>tt(ft,Pe),[()=>C_e()]),Q(Ke,ft)},$$slots:{default:!0}})}Ie(le),ze(mt=>{Qn(le,1,`flex items-center gap-2 px-3 py-1.5 border-b ${I(n)?"bg-violet-500/10 border-violet-500/20":"bg-indigo-500/10 border-indigo-500/20"}`),Qn(Ce,1,`text-xs font-medium ${I(n)?"text-violet-600 dark:text-violet-400":"text-indigo-600 dark:text-indigo-400"}`),tt(Je,mt)},[()=>I_e({context:I(r)})]),Q(J,le)};St(U,J=>{I(o)&&J($)})}var Y=ue(U,2);Ov(Y,{get open(){return I(l)},set open(J){Le(l,J,!0)},children:(J,le)=>{var be=kEe(),Ce=Ee(be);Fv(Ce,{class:"flex items-center justify-between w-full px-3 py-2 hover:bg-muted/50",children:(qe,mt)=>{var Ke=_Ee(),nt=De(Ke),ft=Ee(nt);{let Ge=X(()=>I(l)?"":"-rotate-90");Jm(ft,{get class(){return`size-4 text-muted-foreground transition-transform duration-200 ${I(Ge)??""}`}})}var Pe=ue(ft,2);ame(Pe,{class:"size-4 text-muted-foreground"});var Be=ue(Pe,2),Me=Ee(Be,!0);Ie(Be);var rt=ue(Be,2);{var Et=Ge=>{var at=mEe(),yt=Ee(at,!0);Ie(at),ze(()=>tt(yt,t.activeFilters.length)),Q(Ge,at)};St(rt,Ge=>{t.activeFilters.length>0&&Ge(Et)})}Ie(nt);var qt=ue(nt,2);fo(qt,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs gap-1",onclick:Ge=>{Ge.stopPropagation(),L()},children:(Ge,at)=>{var yt=pEe(),Jt=De(yt);L0(Jt,{class:"size-3"});var li=ue(Jt);ze(Vi=>tt(li,` ${Vi??""}`),[()=>I0()]),Q(Ge,yt)},$$slots:{default:!0}}),ze(Ge=>tt(Me,Ge),[()=>Mpe()]),Q(qe,Ke)},$$slots:{default:!0}});var Je=ue(Ce,2);Bv(Je,{children:(qe,mt)=>{var Ke=EEe(),nt=Ee(Ke);Xn(nt,19,()=>t.activeFilters,Be=>Be.id,(Be,Me,rt)=>{var Et=LEe(),qt=Ee(Et);{var Ge=jt=>{var Mi=gt(),ni=De(Mi);Rt(ni,()=>Oc,(yn,pi)=>{pi(yn,{type:"single",get value(){return t.activeFilters[I(rt)-1].connector},onValueChange:ci=>{ci&&t.updateActiveFilter(t.activeFilters[I(rt)-1].id,{connector:ci})},children:(ci,Ai)=>{var Li=bEe(),Yi=De(Li);Rt(Yi,()=>Ac,($i,Ri)=>{Ri($i,{size:"sm",class:"w-16 h-7 text-xs",children:(gn,fe)=>{Oi();var _i=pn();ze(()=>tt(_i,t.activeFilters[I(rt)-1].connector)),Q(gn,_i)},$$slots:{default:!0}})});var oi=ue(Yi,2);Rt(oi,()=>Pc,($i,Ri)=>{Ri($i,{children:(gn,fe)=>{var _i=gt(),Ii=De(_i);Xn(Ii,17,()=>v,tc,(Xi,Es)=>{var Ys=gt(),Bs=De(Ys);Rt(Bs,()=>hl,(Ca,Xs)=>{Xs(Ca,{get value(){return I(Es).value},get label(){return I(Es).label},children:(Lo,Ws)=>{Oi();var Hs=pn();ze(()=>tt(Hs,I(Es).label)),Q(Lo,Hs)},$$slots:{default:!0}})}),Q(Xi,Ys)}),Q(gn,_i)},$$slots:{default:!0}})}),Q(ci,Li)},$$slots:{default:!0}})}),Q(jt,Mi)};St(qt,jt=>{I(rt)>0&&jt(Ge)})}var at=ue(qt,2);ul(at,{type:"text",placeholder:"table.column",get value(){return I(Me).column},oninput:jt=>{const Mi=jt.target;t.updateActiveFilter(I(Me).id,{column:Mi.value})},class:"h-7 text-xs w-32 font-mono"});var yt=ue(at,2);Rt(yt,()=>Oc,(jt,Mi)=>{Mi(jt,{type:"single",get value(){return I(Me).operator},onValueChange:ni=>{ni&&t.updateActiveFilter(I(Me).id,{operator:ni})},children:(ni,yn)=>{var pi=vEe(),ci=De(pi);Rt(ci,()=>Ac,(Li,Yi)=>{Yi(Li,{size:"sm",class:"w-28 h-7 text-xs",children:(oi,$i)=>{Oi();var Ri=pn();ze(gn=>tt(Ri,gn),[()=>m(I(Me).operator)]),Q(oi,Ri)},$$slots:{default:!0}})});var Ai=ue(ci,2);Rt(Ai,()=>Pc,(Li,Yi)=>{Yi(Li,{children:(oi,$i)=>{var Ri=gt(),gn=De(Ri);Xn(gn,17,()=>g,tc,(fe,_i)=>{var Ii=gt(),Xi=De(Ii);{let Es=X(()=>I(_i).label());Rt(Xi,()=>hl,(Ys,Bs)=>{Bs(Ys,{get value(){return I(_i).value},get label(){return I(Es)},children:(Ca,Xs)=>{Oi();var Lo=pn();ze(Ws=>tt(Lo,Ws),[()=>I(_i).label()]),Q(Ca,Lo)},$$slots:{default:!0}})})}Q(fe,Ii)}),Q(oi,Ri)},$$slots:{default:!0}})}),Q(ni,pi)},$$slots:{default:!0}})});var Jt=ue(yt,2);{var li=jt=>{var Mi=gt(),ni=De(Mi);{var yn=ci=>{var Ai=SEe(),Li=Ee(Ai);{let oi=X(()=>I(Me).subqueryId??"");Rt(Li,()=>Oc,($i,Ri)=>{Ri($i,{type:"single",get value(){return I(oi)},onValueChange:gn=>{gn&&S(I(Me).id,gn)},children:(gn,fe)=>{var _i=yEe(),Ii=De(_i);Rt(Ii,()=>Ac,(Es,Ys)=>{Ys(Es,{size:"sm",class:"h-7 w-32 text-xs border-indigo-500/30 bg-indigo-500/5",children:(Bs,Ca)=>{var Xs=CEe(),Lo=De(Xs);CN(Lo,{class:"size-3 mr-1 text-indigo-500"});var Ws=ue(Lo);ze(Hs=>tt(Ws,` ${Hs??""}`),[()=>I(Me).subqueryId?c5():Y_e()]),Q(Bs,Xs)},$$slots:{default:!0}})});var Xi=ue(Ii,2);Rt(Xi,()=>Pc,(Es,Ys)=>{Ys(Es,{children:(Bs,Ca)=>{var Xs=wEe(),Lo=De(Xs);Xn(Lo,17,()=>I(a),tc,(Hs,xc)=>{var wd=gt(),yd=De(wd);{let Of=X(()=>c5());Rt(yd,()=>hl,(wa,Av)=>{Av(wa,{get value(){return I(xc).id},get label(){return I(Of)},children:(jk,i5)=>{Oi();var x0=pn();ze(n5=>tt(x0,n5),[()=>tbe({count:I(xc).innerQuery.tables.length})]),Q(jk,x0)},$$slots:{default:!0}})})}Q(Hs,wd)});var Ws=ue(Lo,2);{let Hs=X(()=>OK());Rt(Ws,()=>hl,(xc,wd)=>{wd(xc,{value:"__new__",get label(){return I(Hs)},children:(yd,Of)=>{Oi();var wa=pn();ze(Av=>tt(wa,Av),[()=>OK()]),Q(yd,wa)},$$slots:{default:!0}})})}Q(Bs,Xs)},$$slots:{default:!0}})}),Q(gn,_i)},$$slots:{default:!0}})})}var Yi=ue(Li,2);{let oi=X(()=>ube());fo(Yi,{variant:"ghost",size:"icon-sm",class:"size-7 text-muted-foreground hover:text-foreground",get title(){return I(oi)},onclick:()=>x(I(Me).id,!1),children:($i,Ri)=>{Yf($i,{class:"size-3"})},$$slots:{default:!0}})}Ie(Ai),Q(ci,Ai)},pi=ci=>{var Ai=xEe(),Li=Ee(Ai);ul(Li,{type:"text",placeholder:"value",get value(){return I(Me).value},oninput:oi=>{const $i=oi.target;t.updateActiveFilter(I(Me).id,{value:$i.value})},class:"h-7 text-xs w-24"});var Yi=ue(Li,2);{let oi=X(()=>bbe());fo(Yi,{variant:"ghost",size:"icon-sm",class:"size-7 text-indigo-500/70 hover:text-indigo-500 hover:bg-indigo-500/10",get title(){return I(oi)},onclick:()=>x(I(Me).id,!0),children:($i,Ri)=>{CN($i,{class:"size-3"})},$$slots:{default:!0}})}Ie(Ai),Q(ci,Ai)};St(ni,ci=>{y(I(Me))?ci(yn):ci(pi,!1)})}Q(jt,Mi)};St(Jt,jt=>{C(I(Me).operator)&&jt(li)})}var Vi=ue(Jt,2);fo(Vi,{variant:"ghost",size:"icon-sm",class:"size-7 text-muted-foreground hover:text-destructive",onclick:()=>t.removeActiveFilter(I(Me).id),children:(jt,Mi)=>{Yf(jt,{class:"size-3"})},$$slots:{default:!0}}),Ie(Et),Q(Be,Et)});var ft=ue(nt,2);{var Pe=Be=>{var Me=IEe(),rt=Ee(Me,!0);Ie(Me),ze(Et=>tt(rt,Et),[()=>xbe()]),Q(Be,Me)};St(ft,Be=>{t.activeFilters.length===0&&Be(Pe)})}Ie(Ke),Q(qe,Ke)},$$slots:{default:!0}}),Ie(be),Q(J,be)},$$slots:{default:!0}});var se=ue(Y,2);Ov(se,{get open(){return I(c)},set open(J){Le(c,J,!0)},children:(J,le)=>{var be=PEe(),Ce=Ee(be);Fv(Ce,{class:"flex items-center justify-between w-full px-3 py-2 hover:bg-muted/50",children:(qe,mt)=>{var Ke=NEe(),nt=De(Ke),ft=Ee(nt);{let Ge=X(()=>I(c)?"":"-rotate-90");Jm(ft,{get class(){return`size-4 text-muted-foreground transition-transform duration-200 ${I(Ge)??""}`}})}var Pe=ue(ft,2);lme(Pe,{class:"size-4 text-muted-foreground"});var Be=ue(Pe,2),Me=Ee(Be,!0);Ie(Be);var rt=ue(Be,2);{var Et=Ge=>{var at=DEe(),yt=Ee(at,!0);Ie(at),ze(()=>tt(yt,t.activeGroupBy.length)),Q(Ge,at)};St(rt,Ge=>{t.activeGroupBy.length>0&&Ge(Et)})}Ie(nt);var qt=ue(nt,2);fo(qt,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs gap-1",onclick:Ge=>{Ge.stopPropagation(),E()},children:(Ge,at)=>{var yt=TEe(),Jt=De(yt);L0(Jt,{class:"size-3"});var li=ue(Jt);ze(Vi=>tt(li,` ${Vi??""}`),[()=>I0()]),Q(Ge,yt)},$$slots:{default:!0}}),ze(Ge=>tt(Me,Ge),[()=>Wpe()]),Q(qe,Ke)},$$slots:{default:!0}});var Je=ue(Ce,2);Bv(Je,{children:(qe,mt)=>{var Ke=AEe(),nt=Ee(Ke);Xn(nt,17,()=>t.activeGroupBy,Be=>Be.id,(Be,Me)=>{var rt=REe(),Et=Ee(rt);ul(Et,{type:"text",placeholder:"table.column",get value(){return I(Me).column},oninput:Ge=>{const at=Ge.target;t.updateActiveGroupBy(I(Me).id,at.value)},class:"h-7 text-xs w-40 font-mono"});var qt=ue(Et,2);fo(qt,{variant:"ghost",size:"icon-sm",class:"size-7 text-muted-foreground hover:text-destructive",onclick:()=>t.removeActiveGroupBy(I(Me).id),children:(Ge,at)=>{Yf(Ge,{class:"size-3"})},$$slots:{default:!0}}),Ie(rt),Q(Be,rt)});var ft=ue(nt,2);{var Pe=Be=>{var Me=MEe(),rt=Ee(Me,!0);Ie(Me),ze(Et=>tt(rt,Et),[()=>Tbe()]),Q(Be,Me)};St(ft,Be=>{t.activeGroupBy.length===0&&Be(Pe)})}Ie(Ke),Q(qe,Ke)},$$slots:{default:!0}}),Ie(be),Q(J,be)},$$slots:{default:!0}});var j=ue(se,2);Ov(j,{get open(){return I(f)},set open(J){Le(f,J,!0)},children:(J,le)=>{var be=UEe(),Ce=Ee(be);Fv(Ce,{class:"flex items-center justify-between w-full px-3 py-2 hover:bg-muted/50",children:(qe,mt)=>{var Ke=BEe(),nt=De(Ke),ft=Ee(nt);{let Ge=X(()=>I(f)?"":"-rotate-90");Jm(ft,{get class(){return`size-4 text-muted-foreground transition-transform duration-200 ${I(Ge)??""}`}})}var Pe=ue(ft,2);wN(Pe,{class:"size-4 text-muted-foreground"});var Be=ue(Pe,2),Me=Ee(Be,!0);Ie(Be);var rt=ue(Be,2);{var Et=Ge=>{var at=OEe(),yt=Ee(at,!0);Ie(at),ze(()=>tt(yt,t.activeDisplayAggregates.length)),Q(Ge,at)};St(rt,Ge=>{t.activeDisplayAggregates.length>0&&Ge(Et)})}Ie(nt);var qt=ue(nt,2);fo(qt,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs gap-1",onclick:Ge=>{Ge.stopPropagation(),T()},children:(Ge,at)=>{var yt=FEe(),Jt=De(yt);L0(Jt,{class:"size-3"});var li=ue(Jt);ze(Vi=>tt(li,` ${Vi??""}`),[()=>I0()]),Q(Ge,yt)},$$slots:{default:!0}}),ze(Ge=>tt(Me,Ge),[()=>qpe()]),Q(qe,Ke)},$$slots:{default:!0}});var Je=ue(Ce,2);Bv(Je,{children:(qe,mt)=>{var Ke=zEe(),nt=Ee(Ke);Xn(nt,17,()=>t.activeDisplayAggregates,Be=>Be.id,(Be,Me)=>{var rt=HEe(),Et=Ee(rt);Rt(Et,()=>Oc,(li,Vi)=>{Vi(li,{type:"single",get value(){return I(Me).function},onValueChange:jt=>{jt&&N(I(Me),jt)},children:(jt,Mi)=>{var ni=WEe(),yn=De(ni);Rt(yn,()=>Ac,(ci,Ai)=>{Ai(ci,{size:"sm",class:"w-20 h-7 text-xs",children:(Li,Yi)=>{Oi();var oi=pn();ze(()=>tt(oi,I(Me).function)),Q(Li,oi)},$$slots:{default:!0}})});var pi=ue(yn,2);Rt(pi,()=>Pc,(ci,Ai)=>{Ai(ci,{children:(Li,Yi)=>{var oi=gt(),$i=De(oi);Xn($i,17,()=>b,tc,(Ri,gn)=>{var fe=gt(),_i=De(fe);Rt(_i,()=>hl,(Ii,Xi)=>{Xi(Ii,{get value(){return I(gn).value},get label(){return I(gn).label},children:(Es,Ys)=>{Oi();var Bs=pn();ze(()=>tt(Bs,I(gn).label)),Q(Es,Bs)},$$slots:{default:!0}})}),Q(Ri,fe)}),Q(Li,oi)},$$slots:{default:!0}})}),Q(jt,ni)},$$slots:{default:!0}})});var qt=ue(Et,4);{let li=X(()=>I(Me).function==="COUNT"?"*":"expression");ul(qt,{type:"text",get placeholder(){return I(li)},get value(){return I(Me).expression},oninput:Vi=>{const jt=Vi.target;W(I(Me),jt.value)},class:"h-7 text-xs w-28 font-mono"})}var Ge=ue(qt,4),at=Ee(Ge,!0);Ie(Ge);var yt=ue(Ge,2);{let li=X(()=>I(Me).alias??"");ul(yt,{type:"text",placeholder:"alias",get value(){return I(li)},oninput:Vi=>{const jt=Vi.target;P(I(Me),jt.value)},class:"h-7 text-xs w-20 font-mono"})}var Jt=ue(yt,2);fo(Jt,{variant:"ghost",size:"icon-sm",class:"size-7 text-muted-foreground hover:text-destructive",onclick:()=>A(I(Me)),children:(li,Vi)=>{Yf(li,{class:"size-3"})},$$slots:{default:!0}}),Ie(rt),ze(li=>tt(at,li),[()=>A1e()]),Q(Be,rt)});var ft=ue(nt,2);{var Pe=Be=>{var Me=VEe(),rt=Ee(Me,!0);Ie(Me),ze(Et=>tt(rt,Et),[()=>Obe()]),Q(Be,Me)};St(ft,Be=>{t.activeDisplayAggregates.length===0&&Be(Pe)})}Ie(Ke),Q(qe,Ke)},$$slots:{default:!0}}),Ie(be),Q(J,be)},$$slots:{default:!0}});var ie=ue(j,2);Ov(ie,{get open(){return I(d)},set open(J){Le(d,J,!0)},children:(J,le)=>{var be=JEe(),Ce=Ee(be);Fv(Ce,{class:"flex items-center justify-between w-full px-3 py-2 hover:bg-muted/50",children:(qe,mt)=>{var Ke=jEe(),nt=De(Ke),ft=Ee(nt);{let Ge=X(()=>I(d)?"":"-rotate-90");Jm(ft,{get class(){return`size-4 text-muted-foreground transition-transform duration-200 ${I(Ge)??""}`}})}var Pe=ue(ft,2);wN(Pe,{class:"size-4 text-muted-foreground"});var Be=ue(Pe,2),Me=Ee(Be,!0);Ie(Be);var rt=ue(Be,2);{var Et=Ge=>{var at=$Ee(),yt=Ee(at,!0);Ie(at),ze(()=>tt(yt,t.activeHaving.length)),Q(Ge,at)};St(rt,Ge=>{t.activeHaving.length>0&&Ge(Et)})}Ie(nt);var qt=ue(nt,2);fo(qt,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs gap-1",onclick:Ge=>{Ge.stopPropagation(),M()},children:(Ge,at)=>{var yt=qEe(),Jt=De(yt);L0(Jt,{class:"size-3"});var li=ue(Jt);ze(Vi=>tt(li,` ${Vi??""}`),[()=>I0()]),Q(Ge,yt)},$$slots:{default:!0}}),ze(Ge=>tt(Me,Ge),[()=>Zpe()]),Q(qe,Ke)},$$slots:{default:!0}});var Je=ue(Ce,2);Bv(Je,{children:(qe,mt)=>{var Ke=QEe(),nt=Ee(Ke);Xn(nt,19,()=>t.activeHaving,Be=>Be.id,(Be,Me,rt)=>{var Et=XEe(),qt=Ee(Et);{var Ge=jt=>{var Mi=gt(),ni=De(Mi);Rt(ni,()=>Oc,(yn,pi)=>{pi(yn,{type:"single",get value(){return t.activeHaving[I(rt)-1].connector},onValueChange:ci=>{ci&&t.updateActiveHaving(t.activeHaving[I(rt)-1].id,{connector:ci})},children:(ci,Ai)=>{var Li=KEe(),Yi=De(Li);Rt(Yi,()=>Ac,($i,Ri)=>{Ri($i,{size:"sm",class:"w-16 h-7 text-xs",children:(gn,fe)=>{Oi();var _i=pn();ze(()=>tt(_i,t.activeHaving[I(rt)-1].connector)),Q(gn,_i)},$$slots:{default:!0}})});var oi=ue(Yi,2);Rt(oi,()=>Pc,($i,Ri)=>{Ri($i,{children:(gn,fe)=>{var _i=gt(),Ii=De(_i);Xn(Ii,17,()=>v,tc,(Xi,Es)=>{var Ys=gt(),Bs=De(Ys);Rt(Bs,()=>hl,(Ca,Xs)=>{Xs(Ca,{get value(){return I(Es).value},get label(){return I(Es).label},children:(Lo,Ws)=>{Oi();var Hs=pn();ze(()=>tt(Hs,I(Es).label)),Q(Lo,Hs)},$$slots:{default:!0}})}),Q(Xi,Ys)}),Q(gn,_i)},$$slots:{default:!0}})}),Q(ci,Li)},$$slots:{default:!0}})}),Q(jt,Mi)};St(qt,jt=>{I(rt)>0&&jt(Ge)})}var at=ue(qt,2);Rt(at,()=>Oc,(jt,Mi)=>{Mi(jt,{type:"single",get value(){return I(Me).aggregateFunction},onValueChange:ni=>{ni&&t.updateActiveHaving(I(Me).id,{aggregateFunction:ni})},children:(ni,yn)=>{var pi=GEe(),ci=De(pi);Rt(ci,()=>Ac,(Li,Yi)=>{Yi(Li,{size:"sm",class:"w-20 h-7 text-xs",children:(oi,$i)=>{Oi();var Ri=pn();ze(()=>tt(Ri,I(Me).aggregateFunction)),Q(oi,Ri)},$$slots:{default:!0}})});var Ai=ue(ci,2);Rt(Ai,()=>Pc,(Li,Yi)=>{Yi(Li,{children:(oi,$i)=>{var Ri=gt(),gn=De(Ri);Xn(gn,17,()=>b,tc,(fe,_i)=>{var Ii=gt(),Xi=De(Ii);Rt(Xi,()=>hl,(Es,Ys)=>{Ys(Es,{get value(){return I(_i).value},get label(){return I(_i).label},children:(Bs,Ca)=>{Oi();var Xs=pn();ze(()=>tt(Xs,I(_i).label)),Q(Bs,Xs)},$$slots:{default:!0}})}),Q(fe,Ii)}),Q(oi,Ri)},$$slots:{default:!0}})}),Q(ni,pi)},$$slots:{default:!0}})});var yt=ue(at,4);{let jt=X(()=>I(Me).aggregateFunction==="COUNT"?"*":"column");ul(yt,{type:"text",get placeholder(){return I(jt)},get value(){return I(Me).column},oninput:Mi=>{const ni=Mi.target;t.updateActiveHaving(I(Me).id,{column:ni.value})},class:"h-7 text-xs w-20 font-mono"})}var Jt=ue(yt,4);Rt(Jt,()=>Oc,(jt,Mi)=>{Mi(jt,{type:"single",get value(){return I(Me).operator},onValueChange:ni=>{ni&&t.updateActiveHaving(I(Me).id,{operator:ni})},children:(ni,yn)=>{var pi=YEe(),ci=De(pi);Rt(ci,()=>Ac,(Li,Yi)=>{Yi(Li,{size:"sm",class:"w-16 h-7 text-xs",children:(oi,$i)=>{Oi();var Ri=pn();ze(()=>tt(Ri,I(Me).operator)),Q(oi,Ri)},$$slots:{default:!0}})});var Ai=ue(ci,2);Rt(Ai,()=>Pc,(Li,Yi)=>{Yi(Li,{children:(oi,$i)=>{var Ri=gt(),gn=De(Ri);Xn(gn,17,()=>w,tc,(fe,_i)=>{var Ii=gt(),Xi=De(Ii);Rt(Xi,()=>hl,(Es,Ys)=>{Ys(Es,{get value(){return I(_i).value},get label(){return I(_i).label},children:(Bs,Ca)=>{Oi();var Xs=pn();ze(()=>tt(Xs,I(_i).label)),Q(Bs,Xs)},$$slots:{default:!0}})}),Q(fe,Ii)}),Q(oi,Ri)},$$slots:{default:!0}})}),Q(ni,pi)},$$slots:{default:!0}})});var li=ue(Jt,2);ul(li,{type:"text",placeholder:"value",get value(){return I(Me).value},oninput:jt=>{const Mi=jt.target;t.updateActiveHaving(I(Me).id,{value:Mi.value})},class:"h-7 text-xs w-20"});var Vi=ue(li,2);fo(Vi,{variant:"ghost",size:"icon-sm",class:"size-7 text-muted-foreground hover:text-destructive",onclick:()=>t.removeActiveHaving(I(Me).id),children:(jt,Mi)=>{Yf(jt,{class:"size-3"})},$$slots:{default:!0}}),Ie(Et),Q(Be,Et)});var ft=ue(nt,2);{var Pe=Be=>{var Me=ZEe(),rt=Ee(Me,!0);Ie(Me),ze(Et=>tt(rt,Et),[()=>zbe()]),Q(Be,Me)};St(ft,Be=>{t.activeHaving.length===0&&Be(Pe)})}Ie(Ke),Q(qe,Ke)},$$slots:{default:!0}}),Ie(be),Q(J,be)},$$slots:{default:!0}});var te=ue(ie,2);Ov(te,{get open(){return I(h)},set open(J){Le(h,J,!0)},children:(J,le)=>{var be=ake(),Ce=Ee(be);Fv(Ce,{class:"flex items-center justify-between w-full px-3 py-2 hover:bg-muted/50",children:(qe,mt)=>{var Ke=ike(),nt=De(Ke),ft=Ee(nt);{let Ge=X(()=>I(h)?"":"-rotate-90");Jm(ft,{get class(){return`size-4 text-muted-foreground transition-transform duration-200 ${I(Ge)??""}`}})}var Pe=ue(ft,2);nme(Pe,{class:"size-4 text-muted-foreground"});var Be=ue(Pe,2),Me=Ee(Be,!0);Ie(Be);var rt=ue(Be,2);{var Et=Ge=>{var at=eke(),yt=Ee(at,!0);Ie(at),ze(()=>tt(yt,t.activeOrderBy.length)),Q(Ge,at)};St(rt,Ge=>{t.activeOrderBy.length>0&&Ge(Et)})}Ie(nt);var qt=ue(nt,2);fo(qt,{variant:"ghost",size:"sm",class:"h-6 px-2 text-xs gap-1",onclick:Ge=>{Ge.stopPropagation(),R()},children:(Ge,at)=>{var yt=tke(),Jt=De(yt);L0(Jt,{class:"size-3"});var li=ue(Jt);ze(Vi=>tt(li,` ${Vi??""}`),[()=>I0()]),Q(Ge,yt)},$$slots:{default:!0}}),ze(Ge=>tt(Me,Ge),[()=>n_e()]),Q(qe,Ke)},$$slots:{default:!0}});var Je=ue(Ce,2);Bv(Je,{children:(qe,mt)=>{var Ke=rke(),nt=Ee(Ke);Xn(nt,17,()=>t.activeOrderBy,Be=>Be.id,(Be,Me)=>{var rt=ske(),Et=Ee(rt);ul(Et,{type:"text",placeholder:"table.column",get value(){return I(Me).column},oninput:at=>{const yt=at.target;t.updateActiveOrderByColumn(I(Me).id,yt.value)},class:"h-7 text-xs w-40 font-mono"});var qt=ue(Et,2);Rt(qt,()=>Oc,(at,yt)=>{yt(at,{type:"single",get value(){return I(Me).direction},onValueChange:Jt=>{Jt&&t.updateActiveOrderBy(I(Me).id,Jt)},children:(Jt,li)=>{var Vi=nke(),jt=De(Vi);Rt(jt,()=>Ac,(ni,yn)=>{yn(ni,{size:"sm",class:"w-20 h-7 text-xs",children:(pi,ci)=>{Oi();var Ai=pn();ze(()=>tt(Ai,I(Me).direction)),Q(pi,Ai)},$$slots:{default:!0}})});var Mi=ue(jt,2);Rt(Mi,()=>Pc,(ni,yn)=>{yn(ni,{children:(pi,ci)=>{var Ai=gt(),Li=De(Ai);Xn(Li,17,()=>p,tc,(Yi,oi)=>{var $i=gt(),Ri=De($i);Rt(Ri,()=>hl,(gn,fe)=>{fe(gn,{get value(){return I(oi).value},get label(){return I(oi).label},children:(_i,Ii)=>{Oi();var Xi=pn();ze(()=>tt(Xi,I(oi).label)),Q(_i,Xi)},$$slots:{default:!0}})}),Q(Yi,$i)}),Q(pi,Ai)},$$slots:{default:!0}})}),Q(Jt,Vi)},$$slots:{default:!0}})});var Ge=ue(qt,2);fo(Ge,{variant:"ghost",size:"icon-sm",class:"size-7 text-muted-foreground hover:text-destructive",onclick:()=>t.removeActiveOrderBy(I(Me).id),children:(at,yt)=>{Yf(at,{class:"size-3"})},$$slots:{default:!0}}),Ie(rt),Q(Be,rt)});var ft=ue(nt,2);{var Pe=Be=>{var Me=oke(),rt=Ee(Me,!0);Ie(Me),ze(Et=>tt(rt,Et),[()=>Gbe()]),Q(Be,Me)};St(ft,Be=>{t.activeOrderBy.length===0&&Be(Pe)})}Ie(Ke),Q(qe,Ke)},$$slots:{default:!0}}),Ie(be),Q(J,be)},$$slots:{default:!0}});var pe=ue(te,2);Ov(pe,{get open(){return I(u)},set open(J){Le(u,J,!0)},children:(J,le)=>{var be=dke(),Ce=Ee(be);Fv(Ce,{class:"flex items-center justify-between w-full px-3 py-2 hover:bg-muted/50",children:(qe,mt)=>{var Ke=lke(),nt=Ee(Ke);{let Me=X(()=>I(u)?"":"-rotate-90");Jm(nt,{get class(){return`size-4 text-muted-foreground transition-transform duration-200 ${I(Me)??""}`}})}var ft=ue(nt,2);qie(ft,{class:"size-4 text-muted-foreground"});var Pe=ue(ft,2),Be=Ee(Pe,!0);Ie(Pe),Ie(Ke),ze(Me=>tt(Be,Me),[()=>c_e()]),Q(qe,Ke)},$$slots:{default:!0}});var Je=ue(Ce,2);Bv(Je,{children:(qe,mt)=>{var Ke=cke(),nt=Ee(Ke),ft=Ee(nt),Pe=Ee(ft,!0);Ie(ft);var Be=ue(ft,2);{let at=X(()=>t.activeLimit??""),yt=X(()=>t.activeLimit===null);ul(Be,{type:"text",get value(){return I(at)},oninput:H,get disabled(){return I(yt)},placeholder:"100",class:"h-7 text-xs w-24 font-mono"})}var Me=ue(Be,2),rt=Ee(Me,!0);Ie(Me);var Et=ue(Me,2),qt=Ee(Et);{let at=X(()=>t.activeLimit===null);Oie(qt,{id:"no-limit",get checked(){return I(at)},onCheckedChange:G})}var Ge=ue(qt,2);Uie(Ge,{for:"no-limit",class:"text-xs cursor-pointer",children:(at,yt)=>{Oi();var Jt=pn();ze(li=>tt(Jt,li),[()=>uve()]),Q(at,Jt)},$$slots:{default:!0}}),Ie(Et),Ie(nt),Ie(Ke),ze((at,yt)=>{tt(Pe,at),tt(rt,yt)},[()=>eve(),()=>rve()]),Q(qe,Ke)},$$slots:{default:!0}}),Ie(be),Q(J,be)},$$slots:{default:!0}}),Ie(V),Q(s,V),It()}function vse(){return globalThis._VSCODE_NLS_MESSAGES}function aU(){return globalThis._VSCODE_NLS_LANGUAGE}const uke=aU()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function ON(s,e){let t;return e.length===0?t=s:t=s.replace(/\{(\d+)\}/g,(i,n)=>{const o=n[0],r=e[o];let a=i;return typeof r=="string"?a=r:(typeof r=="number"||typeof r=="boolean"||r===void 0||r===null)&&(a=String(r)),a}),uke&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}function _(s,e,...t){return ON(typeof s=="number"?Cse(s,e):e,t)}function Cse(s,e){var i;const t=(i=vse())==null?void 0:i[s];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${s} !!!`)}return t}function ne(s,e,...t){let i;typeof s=="number"?i=Cse(s,e):i=e;const n=ON(i,t);return{value:n,original:e===i?n:ON(e,t)}}function fke(s,e){const t=s;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}const Ti=window,rA=class rA{constructor(){this.mapWindowIdToZoomFactor=new Map}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}getWindowId(e){return e.vscodeWindowId}};rA.INSTANCE=new rA;let p9=rA;function wse(s,e,t){typeof e=="string"&&(e=s.matchMedia(e)),e.addEventListener("change",t)}function _9(s){return p9.INSTANCE.getZoomFactor(s)}const Zy=navigator.userAgent,Wr=Zy.indexOf("Firefox")>=0,fO=Zy.indexOf("AppleWebKit")>=0,ik=Zy.indexOf("Chrome")>=0,Eb=!ik&&Zy.indexOf("Safari")>=0,yse=!ik&&!Eb&&fO;Zy.indexOf("Electron/")>=0;const NG=Zy.indexOf("Android")>=0;let w5=!1;if(typeof Ti.matchMedia=="function"){const s=Ti.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=Ti.matchMedia("(display-mode: fullscreen)");w5=s.matches,wse(Ti,s,({matches:t})=>{w5&&e.matches||(w5=t)})}function lU(){return globalThis.MonacoEnvironment}class gke{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?gw.isErrorNoTelemetry(e)?new gw(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const cU=new gke;function FN(s){cU.onUnexpectedError(s)}function _t(s){il(s)||cU.onUnexpectedError(s)}function as(s){il(s)||cU.onUnexpectedExternalError(s)}function b9(s){if(s instanceof Error){const{name:e,message:t,cause:i}=s,n=s.stacktrace||s.stack;return{$isError:!0,name:e,message:t,stack:n,noTelemetry:gw.isErrorNoTelemetry(s),cause:i?b9(i):void 0,code:s.code}}return s}const BN="Canceled";function il(s){return s instanceof Ml?!0:s instanceof Error&&s.name===BN&&s.message===BN}class Ml extends Error{constructor(){super(BN),this.name=this.message}}function mke(){const s=new Error(BN);return s.name=s.message,s}function kl(s){return s?new Error(`Illegal argument: ${s}`):new Error("Illegal argument")}function WN(s){return s?new Error(`Illegal state: ${s}`):new Error("Illegal state")}class pke extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class gw extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof gw)return e;const t=new gw;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class et extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,et.prototype)}}function y5(s,e){if(!s)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function nk(s,e="Unreachable"){throw new Error(e)}function uL(s,e="unexpected state"){if(!s)throw typeof e=="string"?new et(`Assertion Failed: ${e}`):e}function RG(s,e="Soft Assertion Failed"){s||_t(new et(e))}function dm(s){if(!s()){debugger;s(),_t(new et("Assertion Failed"))}}function sk(s,e){let t=0;for(;t<s.length-1;){const i=s[t],n=s[t+1];if(!e(i,n))return!1;t++}return!0}function As(s){return typeof s=="string"}function _ke(s,e){return Array.isArray(s)&&s.every(e)}function ws(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)&&!(s instanceof RegExp)&&!(s instanceof Date)}function bke(s){const e=Object.getPrototypeOf(Uint8Array);return typeof s=="object"&&s instanceof e}function af(s){return typeof s=="number"&&!isNaN(s)}function v9(s){return!!s&&typeof s[Symbol.iterator]=="function"}function C9(s){return s===!0||s===!1}function Mo(s){return typeof s>"u"}function $s(s){return!vl(s)}function vl(s){return Mo(s)||s===null}function ti(s,e){if(!s)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function _g(s){return uL(s!=null,"Argument is `undefined` or `null`."),s}function kb(s){return typeof s=="function"}function vke(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++)Cke(s[i],e[i])}function Cke(s,e){if(As(e)){if(typeof s!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(kb(e)){try{if(s instanceof e)return}catch{}if(!vl(s)&&s.constructor===e||e.length===1&&e.call(void 0,s)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}const Vp="en";let fL=!1,gL=!1,VS=!1,Sse=!1,dU=!1,hU=!1,xse=!1,tD,AT=Vp,MG=Vp,wke,Ec;const Yu=globalThis;let $o;var Iie;typeof Yu.vscode<"u"&&typeof Yu.vscode.process<"u"?$o=Yu.vscode.process:typeof process<"u"&&typeof((Iie=process==null?void 0:process.versions)==null?void 0:Iie.node)=="string"&&($o=process);var Eie;const yke=typeof((Eie=$o==null?void 0:$o.versions)==null?void 0:Eie.electron)=="string",Ske=yke&&($o==null?void 0:$o.type)==="renderer";var kie;if(typeof $o=="object"){fL=$o.platform==="win32",gL=$o.platform==="darwin",VS=$o.platform==="linux",VS&&$o.env.SNAP&&$o.env.SNAP_REVISION,$o.env.CI||$o.env.BUILD_ARTIFACTSTAGINGDIRECTORY||$o.env.GITHUB_WORKSPACE,tD=Vp,AT=Vp;const s=$o.env.VSCODE_NLS_CONFIG;if(s)try{const e=JSON.parse(s);tD=e.userLocale,MG=e.osLocale,AT=e.resolvedLanguage||Vp,wke=(kie=e.languagePack)==null?void 0:kie.translationsConfigFile}catch{}Sse=!0}else typeof navigator=="object"&&!Ske?(Ec=navigator.userAgent,fL=Ec.indexOf("Windows")>=0,gL=Ec.indexOf("Macintosh")>=0,hU=(Ec.indexOf("Macintosh")>=0||Ec.indexOf("iPad")>=0||Ec.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,VS=Ec.indexOf("Linux")>=0,xse=(Ec==null?void 0:Ec.indexOf("Mobi"))>=0,dU=!0,AT=aU()||Vp,tD=navigator.language.toLowerCase(),MG=tD):console.error("Unable to resolve platform.");let PT=0;gL?PT=1:fL?PT=3:VS&&(PT=2);const no=fL,Bt=gL,Hr=VS,ad=Sse,Ah=dU,xke=dU&&typeof Yu.importScripts=="function",Lke=xke?Yu.origin:void 0,Al=hU,Lse=xse,S5=PT,yh=Ec,Ike=AT,Eke=typeof Yu.postMessage=="function"&&!Yu.importScripts,ok=(()=>{if(Eke){const s=[];Yu.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=s.length;i<n;i++){const o=s[i];if(o.id===t.data.vscodeScheduleAsyncWork){s.splice(i,1),o.callback();return}}});let e=0;return t=>{const i=++e;s.push({id:i,callback:t}),Yu.postMessage({vscodeScheduleAsyncWork:i},"*")}}return s=>setTimeout(s)})(),sa=gL||hU?2:fL?1:3;let AG=!0,PG=!1;function Ise(){if(!PG){PG=!0;const s=new Uint8Array(2);s[0]=1,s[1]=2,AG=new Uint16Array(s.buffer)[0]===513}return AG}const uU=!!(yh&&yh.indexOf("Chrome")>=0),kke=!!(yh&&yh.indexOf("Firefox")>=0),Dke=!!(!uU&&yh&&yh.indexOf("Safari")>=0),Ese=!!(yh&&yh.indexOf("Edg/")>=0),Tke=!!(yh&&yh.indexOf("Android")>=0),rk={clipboard:{writeText:ad||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:ad||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},pointerEvents:Ti.PointerEvent&&("ontouchstart"in Ti||navigator.maxTouchPoints>0)};class fU{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const OT=new fU,w9=new fU,y9=new fU,kse=new Array(230),Nke=Object.create(null),Rke=Object.create(null),gU=[];for(let s=0;s<=193;s++)gU[s]=-1;(function(){const e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN","",""],[1,1,"Hyper",0,"",0,"","",""],[1,2,"Super",0,"",0,"","",""],[1,3,"Fn",0,"",0,"","",""],[1,4,"FnLock",0,"",0,"","",""],[1,5,"Suspend",0,"",0,"","",""],[1,6,"Resume",0,"",0,"","",""],[1,7,"Turbo",0,"",0,"","",""],[1,8,"Sleep",0,"",0,"VK_SLEEP","",""],[1,9,"WakeUp",0,"",0,"","",""],[0,10,"KeyA",31,"A",65,"VK_A","",""],[0,11,"KeyB",32,"B",66,"VK_B","",""],[0,12,"KeyC",33,"C",67,"VK_C","",""],[0,13,"KeyD",34,"D",68,"VK_D","",""],[0,14,"KeyE",35,"E",69,"VK_E","",""],[0,15,"KeyF",36,"F",70,"VK_F","",""],[0,16,"KeyG",37,"G",71,"VK_G","",""],[0,17,"KeyH",38,"H",72,"VK_H","",""],[0,18,"KeyI",39,"I",73,"VK_I","",""],[0,19,"KeyJ",40,"J",74,"VK_J","",""],[0,20,"KeyK",41,"K",75,"VK_K","",""],[0,21,"KeyL",42,"L",76,"VK_L","",""],[0,22,"KeyM",43,"M",77,"VK_M","",""],[0,23,"KeyN",44,"N",78,"VK_N","",""],[0,24,"KeyO",45,"O",79,"VK_O","",""],[0,25,"KeyP",46,"P",80,"VK_P","",""],[0,26,"KeyQ",47,"Q",81,"VK_Q","",""],[0,27,"KeyR",48,"R",82,"VK_R","",""],[0,28,"KeyS",49,"S",83,"VK_S","",""],[0,29,"KeyT",50,"T",84,"VK_T","",""],[0,30,"KeyU",51,"U",85,"VK_U","",""],[0,31,"KeyV",52,"V",86,"VK_V","",""],[0,32,"KeyW",53,"W",87,"VK_W","",""],[0,33,"KeyX",54,"X",88,"VK_X","",""],[0,34,"KeyY",55,"Y",89,"VK_Y","",""],[0,35,"KeyZ",56,"Z",90,"VK_Z","",""],[0,36,"Digit1",22,"1",49,"VK_1","",""],[0,37,"Digit2",23,"2",50,"VK_2","",""],[0,38,"Digit3",24,"3",51,"VK_3","",""],[0,39,"Digit4",25,"4",52,"VK_4","",""],[0,40,"Digit5",26,"5",53,"VK_5","",""],[0,41,"Digit6",27,"6",54,"VK_6","",""],[0,42,"Digit7",28,"7",55,"VK_7","",""],[0,43,"Digit8",29,"8",56,"VK_8","",""],[0,44,"Digit9",30,"9",57,"VK_9","",""],[0,45,"Digit0",21,"0",48,"VK_0","",""],[1,46,"Enter",3,"Enter",13,"VK_RETURN","",""],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE","",""],[1,48,"Backspace",1,"Backspace",8,"VK_BACK","",""],[1,49,"Tab",2,"Tab",9,"VK_TAB","",""],[1,50,"Space",10,"Space",32,"VK_SPACE","",""],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,"",0,"","",""],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL","",""],[1,64,"F1",59,"F1",112,"VK_F1","",""],[1,65,"F2",60,"F2",113,"VK_F2","",""],[1,66,"F3",61,"F3",114,"VK_F3","",""],[1,67,"F4",62,"F4",115,"VK_F4","",""],[1,68,"F5",63,"F5",116,"VK_F5","",""],[1,69,"F6",64,"F6",117,"VK_F6","",""],[1,70,"F7",65,"F7",118,"VK_F7","",""],[1,71,"F8",66,"F8",119,"VK_F8","",""],[1,72,"F9",67,"F9",120,"VK_F9","",""],[1,73,"F10",68,"F10",121,"VK_F10","",""],[1,74,"F11",69,"F11",122,"VK_F11","",""],[1,75,"F12",70,"F12",123,"VK_F12","",""],[1,76,"PrintScreen",0,"",0,"","",""],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL","",""],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE","",""],[1,79,"Insert",19,"Insert",45,"VK_INSERT","",""],[1,80,"Home",14,"Home",36,"VK_HOME","",""],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR","",""],[1,82,"Delete",20,"Delete",46,"VK_DELETE","",""],[1,83,"End",13,"End",35,"VK_END","",""],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT","",""],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",""],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",""],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",""],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",""],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK","",""],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE","",""],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY","",""],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT","",""],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD","",""],[1,94,"NumpadEnter",3,"",0,"","",""],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1","",""],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2","",""],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3","",""],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4","",""],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5","",""],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6","",""],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7","",""],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8","",""],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9","",""],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0","",""],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL","",""],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102","",""],[1,107,"ContextMenu",58,"ContextMenu",93,"","",""],[1,108,"Power",0,"",0,"","",""],[1,109,"NumpadEqual",0,"",0,"","",""],[1,110,"F13",71,"F13",124,"VK_F13","",""],[1,111,"F14",72,"F14",125,"VK_F14","",""],[1,112,"F15",73,"F15",126,"VK_F15","",""],[1,113,"F16",74,"F16",127,"VK_F16","",""],[1,114,"F17",75,"F17",128,"VK_F17","",""],[1,115,"F18",76,"F18",129,"VK_F18","",""],[1,116,"F19",77,"F19",130,"VK_F19","",""],[1,117,"F20",78,"F20",131,"VK_F20","",""],[1,118,"F21",79,"F21",132,"VK_F21","",""],[1,119,"F22",80,"F22",133,"VK_F22","",""],[1,120,"F23",81,"F23",134,"VK_F23","",""],[1,121,"F24",82,"F24",135,"VK_F24","",""],[1,122,"Open",0,"",0,"","",""],[1,123,"Help",0,"",0,"","",""],[1,124,"Select",0,"",0,"","",""],[1,125,"Again",0,"",0,"","",""],[1,126,"Undo",0,"",0,"","",""],[1,127,"Cut",0,"",0,"","",""],[1,128,"Copy",0,"",0,"","",""],[1,129,"Paste",0,"",0,"","",""],[1,130,"Find",0,"",0,"","",""],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE","",""],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP","",""],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN","",""],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR","",""],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1","",""],[1,136,"KanaMode",0,"",0,"","",""],[0,137,"IntlYen",0,"",0,"","",""],[1,138,"Convert",0,"",0,"","",""],[1,139,"NonConvert",0,"",0,"","",""],[1,140,"Lang1",0,"",0,"","",""],[1,141,"Lang2",0,"",0,"","",""],[1,142,"Lang3",0,"",0,"","",""],[1,143,"Lang4",0,"",0,"","",""],[1,144,"Lang5",0,"",0,"","",""],[1,145,"Abort",0,"",0,"","",""],[1,146,"Props",0,"",0,"","",""],[1,147,"NumpadParenLeft",0,"",0,"","",""],[1,148,"NumpadParenRight",0,"",0,"","",""],[1,149,"NumpadBackspace",0,"",0,"","",""],[1,150,"NumpadMemoryStore",0,"",0,"","",""],[1,151,"NumpadMemoryRecall",0,"",0,"","",""],[1,152,"NumpadMemoryClear",0,"",0,"","",""],[1,153,"NumpadMemoryAdd",0,"",0,"","",""],[1,154,"NumpadMemorySubtract",0,"",0,"","",""],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR","",""],[1,156,"NumpadClearEntry",0,"",0,"","",""],[1,0,"",5,"Ctrl",17,"VK_CONTROL","",""],[1,0,"",4,"Shift",16,"VK_SHIFT","",""],[1,0,"",6,"Alt",18,"VK_MENU","",""],[1,0,"",57,"Meta",91,"VK_COMMAND","",""],[1,157,"ControlLeft",5,"",0,"VK_LCONTROL","",""],[1,158,"ShiftLeft",4,"",0,"VK_LSHIFT","",""],[1,159,"AltLeft",6,"",0,"VK_LMENU","",""],[1,160,"MetaLeft",57,"",0,"VK_LWIN","",""],[1,161,"ControlRight",5,"",0,"VK_RCONTROL","",""],[1,162,"ShiftRight",4,"",0,"VK_RSHIFT","",""],[1,163,"AltRight",6,"",0,"VK_RMENU","",""],[1,164,"MetaRight",57,"",0,"VK_RWIN","",""],[1,165,"BrightnessUp",0,"",0,"","",""],[1,166,"BrightnessDown",0,"",0,"","",""],[1,167,"MediaPlay",0,"",0,"","",""],[1,168,"MediaRecord",0,"",0,"","",""],[1,169,"MediaFastForward",0,"",0,"","",""],[1,170,"MediaRewind",0,"",0,"","",""],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK","",""],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK","",""],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP","",""],[1,174,"Eject",0,"",0,"","",""],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE","",""],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT","",""],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL","",""],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2","",""],[1,179,"LaunchApp1",0,"",0,"VK_MEDIA_LAUNCH_APP1","",""],[1,180,"SelectTask",0,"",0,"","",""],[1,181,"LaunchScreenSaver",0,"",0,"","",""],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH","",""],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME","",""],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK","",""],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD","",""],[1,186,"BrowserStop",0,"",0,"VK_BROWSER_STOP","",""],[1,187,"BrowserRefresh",0,"",0,"VK_BROWSER_REFRESH","",""],[1,188,"BrowserFavorites",0,"",0,"VK_BROWSER_FAVORITES","",""],[1,189,"ZoomToggle",0,"",0,"","",""],[1,190,"MailReply",0,"",0,"","",""],[1,191,"MailForward",0,"",0,"","",""],[1,192,"MailSend",0,"",0,"","",""],[1,0,"",114,"KeyInComposition",229,"","",""],[1,0,"",116,"ABNT_C2",194,"VK_ABNT_C2","",""],[1,0,"",96,"OEM_8",223,"VK_OEM_8","",""],[1,0,"",0,"",0,"VK_KANA","",""],[1,0,"",0,"",0,"VK_HANGUL","",""],[1,0,"",0,"",0,"VK_JUNJA","",""],[1,0,"",0,"",0,"VK_FINAL","",""],[1,0,"",0,"",0,"VK_HANJA","",""],[1,0,"",0,"",0,"VK_KANJI","",""],[1,0,"",0,"",0,"VK_CONVERT","",""],[1,0,"",0,"",0,"VK_NONCONVERT","",""],[1,0,"",0,"",0,"VK_ACCEPT","",""],[1,0,"",0,"",0,"VK_MODECHANGE","",""],[1,0,"",0,"",0,"VK_SELECT","",""],[1,0,"",0,"",0,"VK_PRINT","",""],[1,0,"",0,"",0,"VK_EXECUTE","",""],[1,0,"",0,"",0,"VK_SNAPSHOT","",""],[1,0,"",0,"",0,"VK_HELP","",""],[1,0,"",0,"",0,"VK_APPS","",""],[1,0,"",0,"",0,"VK_PROCESSKEY","",""],[1,0,"",0,"",0,"VK_PACKET","",""],[1,0,"",0,"",0,"VK_DBE_SBCSCHAR","",""],[1,0,"",0,"",0,"VK_DBE_DBCSCHAR","",""],[1,0,"",0,"",0,"VK_ATTN","",""],[1,0,"",0,"",0,"VK_CRSEL","",""],[1,0,"",0,"",0,"VK_EXSEL","",""],[1,0,"",0,"",0,"VK_EREOF","",""],[1,0,"",0,"",0,"VK_PLAY","",""],[1,0,"",0,"",0,"VK_ZOOM","",""],[1,0,"",0,"",0,"VK_NONAME","",""],[1,0,"",0,"",0,"VK_PA1","",""],[1,0,"",0,"",0,"VK_OEM_CLEAR","",""]],t=[],i=[];for(const n of e){const[o,r,a,l,c,d,h,u,f]=n;if(i[r]||(i[r]=!0,Nke[a]=r,Rke[a.toLowerCase()]=r,o&&(gU[r]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);OT.define(l,c),w9.define(l,u||c),y9.define(l,f||u||c)}d&&(kse[d]=l)}})();var Su;(function(s){function e(a){return OT.keyCodeToStr(a)}s.toString=e;function t(a){return OT.strToKeyCode(a)}s.fromString=t;function i(a){return w9.keyCodeToStr(a)}s.toUserSettingsUS=i;function n(a){return y9.keyCodeToStr(a)}s.toUserSettingsGeneral=n;function o(a){return w9.strToKeyCode(a)||y9.strToKeyCode(a)}s.fromUserSettings=o;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return OT.keyCodeToStr(a)}s.toElectronAccelerator=r})(Su||(Su={}));function ls(s,e){const t=(e&65535)<<16>>>0;return(s|t)>>>0}function S9(s,e){if(typeof s=="number"){if(s===0)return null;const t=(s&65535)>>>0,i=(s&4294901760)>>>16;return i!==0?new x5([iD(t,e),iD(i,e)]):new x5([iD(t,e)])}else{const t=[];for(let i=0;i<s.length;i++)t.push(iD(s[i],e));return new x5(t)}}function iD(s,e){const t=!!(s&2048),i=!!(s&256),n=e===2?i:t,o=!!(s&1024),r=!!(s&512),a=e===2?t:i,l=s&255;return new lf(n,o,r,a,l)}class lf{constructor(e,t,i,n,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=o}equals(e){return e instanceof lf&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class x5{constructor(e){if(e.length===0)throw kl("chords");this.chords=e}}class Mke{constructor(e,t,i,n,o,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=o,this.keyAriaLabel=r}}class Ake{}function Pke(s){if(s.charCode){const t=String.fromCharCode(s.charCode).toUpperCase();return Su.fromString(t)}const e=s.keyCode;if(e===3)return 7;if(Wr)switch(e){case 59:return 85;case 60:if(Hr)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Bt)return 57;break}else if(fO){if(Bt&&e===93)return 57;if(!Bt&&e===92)return 57}return kse[e]||0}const Oke=Bt?256:2048,Fke=512,Bke=1024,Wke=Bt?2048:256;class Bi{constructor(e){var i;this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=(i=t.getModifierState)==null?void 0:i.call(t,"AltGraph"),this.keyCode=Pke(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=Oke),this.altKey&&(t|=Fke),this.shiftKey&&(t|=Bke),this.metaKey&&(t|=Wke),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new lf(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}const OG=new WeakMap;function Hke(s){if(!s.parent||s.parent===s)return null;try{const e=s.location,t=s.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return s.parent}class Vke{static getSameOriginWindowChain(e){let t=OG.get(e);if(!t){t=[],OG.set(e,t);let i=e,n;do n=Hke(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0;const o=this.getSameOriginWindowChain(e);for(const r of o){const a=r.window.deref();if(i+=(a==null?void 0:a.scrollY)??0,n+=(a==null?void 0:a.scrollX)??0,a===t||!r.iframeElement)break;const l=r.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}}class Co{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.defaultPrevented=t.defaultPrevented,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const i=Vke.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class Db{constructor(e,t=0,i=0){var o;this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(ik){const r=navigator.userAgent.match(/Chrome\/(\d+)/);n=(r?parseInt(r[1]):123)<=122}if(e){const r=e,a=e,l=((o=e.view)==null?void 0:o.devicePixelRatio)||1;if(typeof r.wheelDeltaY<"u")n?this.deltaY=r.wheelDeltaY/(120*l):this.deltaY=r.wheelDeltaY/120;else if(typeof a.VERTICAL_AXIS<"u"&&a.axis===a.VERTICAL_AXIS)this.deltaY=-a.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?Wr&&!Bt?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Eb&&no?this.deltaX=-(r.wheelDeltaX/120):n?this.deltaX=r.wheelDeltaX/(120*l):this.deltaX=r.wheelDeltaX/120;else if(typeof a.HORIZONTAL_AXIS<"u"&&a.axis===a.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const c=e;c.deltaMode===c.DOM_DELTA_LINE?Wr&&!Bt?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*l):this.deltaY=e.wheelDelta/120)}}preventDefault(){var e;(e=this.browserEvent)==null||e.preventDefault()}stopPropagation(){var e;(e=this.browserEvent)==null||e.stopPropagation()}}function Tb(s,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=s.apply(t,arguments)),n}}var Gt;(function(s){function e(S){return!!S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}s.is=e;const t=Object.freeze([]);function i(){return t}s.empty=i;function*n(S){yield S}s.single=n;function o(S){return e(S)?S:n(S)}s.wrap=o;function r(S){return S||t}s.from=r;function*a(S){for(let L=S.length-1;L>=0;L--)yield S[L]}s.reverse=a;function l(S){return!S||S[Symbol.iterator]().next().done===!0}s.isEmpty=l;function c(S){return S[Symbol.iterator]().next().value}s.first=c;function d(S,L){let E=0;for(const M of S)if(L(M,E++))return!0;return!1}s.some=d;function h(S,L){let E=0;for(const M of S)if(!L(M,E++))return!1;return!0}s.every=h;function u(S,L){for(const E of S)if(L(E))return E}s.find=u;function*f(S,L){for(const E of S)L(E)&&(yield E)}s.filter=f;function*g(S,L){let E=0;for(const M of S)yield L(M,E++)}s.map=g;function*m(S,L){let E=0;for(const M of S)yield*L(M,E++)}s.flatMap=m;function*p(...S){for(const L of S)v9(L)?yield*L:yield L}s.concat=p;function v(S,L,E){let M=E;for(const R of S)M=L(M,R);return M}s.reduce=v;function b(S){let L=0;for(const E of S)L++;return L}s.length=b;function*w(S,L,E=S.length){for(L<-S.length&&(L=0),L<0&&(L+=S.length),E<0?E+=S.length:E>S.length&&(E=S.length);L<E;L++)yield S[L]}s.slice=w;function C(S,L=Number.POSITIVE_INFINITY){const E=[];if(L===0)return[E,S];const M=S[Symbol.iterator]();for(let R=0;R<L;R++){const T=M.next();if(T.done)return[E,s.empty()];E.push(T.value)}return[E,{[Symbol.iterator](){return M}}]}s.consume=C;async function y(S){const L=[];for await(const E of S)L.push(E);return L}s.asyncToArray=y;async function x(S){let L=[];for await(const E of S)L=L.concat(E);return L}s.asyncToArrayFlat=x})(Gt||(Gt={}));function fv(s){return typeof s=="object"&&s!==null&&typeof s.dispose=="function"&&s.dispose.length===0}function yi(s){if(Gt.is(s)){const e=[];for(const t of s)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(s)?[]:s}else if(s)return s.dispose(),s}function dc(...s){return Ve(()=>yi(s))}class zke{constructor(e){this._isDisposed=!1,this._fn=e}dispose(){if(!this._isDisposed){if(!this._fn)throw new Error("Unbound disposable context: Need to use an arrow function to preserve the value of this");this._isDisposed=!0,this._fn()}}}function Ve(s){return new zke(s)}var S_;let oe=(S_=class{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{yi(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e||e===K.None)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?S_.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}},S_.DISABLE_DISPOSED_WARNING=!1,S_);const gK=class gK{constructor(){this._store=new oe,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};gK.None=Object.freeze({dispose(){}});let K=gK;class mi{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}}class Uke{constructor(e){this._disposable=e,this._counter=1}acquire(){return this._counter++,this}release(){return--this._counter===0&&this._disposable.dispose(),this}}class $ke{constructor(e){this.object=e}dispose(){}}class gO{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{yi(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){var n;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(n=this._store.get(e))==null||n.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}var zu;let ks=(zu=class{constructor(e){this.element=e,this.next=zu.Undefined,this.prev=zu.Undefined}},zu.Undefined=new zu(void 0),zu);class Zo{constructor(){this._first=ks.Undefined,this._last=ks.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===ks.Undefined}clear(){let e=this._first;for(;e!==ks.Undefined;){const t=e.next;e.prev=ks.Undefined,e.next=ks.Undefined,e=t}this._first=ks.Undefined,this._last=ks.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new ks(e);if(this._first===ks.Undefined)this._first=i,this._last=i;else if(t){const o=this._last;this._last=i,i.prev=o,o.next=i}else{const o=this._first;this._first=i,i.next=o,o.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==ks.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==ks.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==ks.Undefined&&e.next!==ks.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===ks.Undefined&&e.next===ks.Undefined?(this._first=ks.Undefined,this._last=ks.Undefined):e.next===ks.Undefined?(this._last=this._last.prev,this._last.next=ks.Undefined):e.prev===ks.Undefined&&(this._first=this._first.next,this._first.prev=ks.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==ks.Undefined;)yield e.element,e=e.next}}const qke=globalThis.performance.now.bind(globalThis.performance);class Fs{static create(e){return new Fs(e)}constructor(e){this._now=e===!1?Date.now:qke,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var Se;(function(s){s.None=()=>K.None;function e(T,A){return u(T,()=>{},0,void 0,!0,void 0,A)}s.defer=e;function t(T){return(A,N=null,P)=>{let W=!1,H;return H=T(G=>{if(!W)return H?H.dispose():W=!0,A.call(N,G)},null,P),W&&H.dispose(),H}}s.once=t;function i(T,A){return s.once(s.filter(T,A))}s.onceIf=i;function n(T,A,N){return d((P,W=null,H)=>T(G=>P.call(W,A(G)),null,H),N)}s.map=n;function o(T,A,N){return d((P,W=null,H)=>T(G=>{A(G),P.call(W,G)},null,H),N)}s.forEach=o;function r(T,A,N){return d((P,W=null,H)=>T(G=>A(G)&&P.call(W,G),null,H),N)}s.filter=r;function a(T){return T}s.signal=a;function l(...T){return(A,N=null,P)=>{const W=dc(...T.map(H=>H(G=>A.call(N,G))));return h(W,P)}}s.any=l;function c(T,A,N,P){let W=N;return n(T,H=>(W=A(W,H),W),P)}s.reduce=c;function d(T,A){let N;const P={onWillAddFirstListener(){N=T(W.fire,W)},onDidRemoveLastListener(){N==null||N.dispose()}},W=new q(P);return A==null||A.add(W),W.event}function h(T,A){return A instanceof Array?A.push(T):A&&A.add(T),T}function u(T,A,N=100,P=!1,W=!1,H,G){let V,U,$,Y=0,se;const j={leakWarningThreshold:H,onWillAddFirstListener(){V=T(te=>{Y++,U=A(U,te),P&&!$&&(ie.fire(U),U=void 0),se=()=>{const pe=U;U=void 0,$=void 0,(!P||Y>1)&&ie.fire(pe),Y=0},typeof N=="number"?($&&clearTimeout($),$=setTimeout(se,N)):$===void 0&&($=null,queueMicrotask(se))})},onWillRemoveListener(){W&&Y>0&&(se==null||se())},onDidRemoveLastListener(){se=void 0,V.dispose()}},ie=new q(j);return G==null||G.add(ie),ie.event}s.debounce=u;function f(T,A=0,N){return s.debounce(T,(P,W)=>P?(P.push(W),P):[W],A,void 0,!0,void 0,N)}s.accumulate=f;function g(T,A=(P,W)=>P===W,N){let P=!0,W;return r(T,H=>{const G=P||!A(H,W);return P=!1,W=H,G},N)}s.latch=g;function m(T,A,N){return[s.filter(T,A,N),s.filter(T,P=>!A(P),N)]}s.split=m;function p(T,A=!1,N=[],P){let W=N.slice(),H=T(U=>{W?W.push(U):V.fire(U)});P&&P.add(H);const G=()=>{W==null||W.forEach(U=>V.fire(U)),W=null},V=new q({onWillAddFirstListener(){H||(H=T(U=>V.fire(U)),P&&P.add(H))},onDidAddFirstListener(){W&&(A?setTimeout(G):G())},onDidRemoveLastListener(){H&&H.dispose(),H=null}});return P&&P.add(V),V.event}s.buffer=p;function v(T,A){return(P,W,H)=>{const G=A(new w);return T(function(V){const U=G.evaluate(V);U!==b&&P.call(W,U)},void 0,H)}}s.chain=v;const b=Symbol("HaltChainable");class w{constructor(){this.steps=[]}map(A){return this.steps.push(A),this}forEach(A){return this.steps.push(N=>(A(N),N)),this}filter(A){return this.steps.push(N=>A(N)?N:b),this}reduce(A,N){let P=N;return this.steps.push(W=>(P=A(P,W),P)),this}latch(A=(N,P)=>N===P){let N=!0,P;return this.steps.push(W=>{const H=N||!A(W,P);return N=!1,P=W,H?W:b}),this}evaluate(A){for(const N of this.steps)if(A=N(A),A===b)break;return A}}function C(T,A,N=P=>P){const P=(...V)=>G.fire(N(...V)),W=()=>T.on(A,P),H=()=>T.removeListener(A,P),G=new q({onWillAddFirstListener:W,onDidRemoveLastListener:H});return G.event}s.fromNodeEventEmitter=C;function y(T,A,N=P=>P){const P=(...V)=>G.fire(N(...V)),W=()=>T.addEventListener(A,P),H=()=>T.removeEventListener(A,P),G=new q({onWillAddFirstListener:W,onDidRemoveLastListener:H});return G.event}s.fromDOMEventEmitter=y;function x(T,A){let N;const P=new Promise((W,H)=>{const G=t(T)(W,null,A);N=()=>G.dispose()});return P.cancel=N,P}s.toPromise=x;function S(T,A){return T(N=>A.fire(N))}s.forward=S;function L(T,A,N){return A(N),T(P=>A(P))}s.runAndSubscribe=L;class E{constructor(A,N){this._observable=A,this._counter=0,this._hasChanged=!1;const P={onWillAddFirstListener:()=>{A.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{A.removeObserver(this)}};this.emitter=new q(P),N&&N.add(this.emitter)}beginUpdate(A){this._counter++}handlePossibleChange(A){}handleChange(A,N){this._hasChanged=!0}endUpdate(A){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function M(T,A){return new E(T,A).emitter.event}s.fromObservable=M;function R(T){return(A,N,P)=>{let W=0,H=!1;const G={beginUpdate(){W++},endUpdate(){W--,W===0&&(T.reportChanges(),H&&(H=!1,A.call(N)))},handlePossibleChange(){},handleChange(){H=!0}};T.addObserver(G),T.reportChanges();const V={dispose(){T.removeObserver(G)}};return P instanceof oe?P.add(V):Array.isArray(P)&&P.push(V),V}}s.fromObservableLight=R})(Se||(Se={}));const KC=class KC{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${KC._idPool++}`,KC.all.add(this)}start(e){this._stopWatch=new Fs,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};KC.all=new Set,KC._idPool=0;let x9=KC,jke=-1;const aA=class aA{constructor(e,t,i=(aA._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[o,r]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${r}):`;console.warn(a),console.warn(o);const l=new Kke(a,o);this._errorHandler(l)}return()=>{const o=this._stacks.get(e.value)||0;this._stacks.set(e.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}};aA._idPool=1;let L9=aA;class mU{static create(){const e=new Error;return new mU(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class Kke extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class Gke extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}class L5{constructor(e){this.value=e}}const Yke=2;let q=class{constructor(e){var t,i,n,o;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new L9((e==null?void 0:e.onListenerError)??_t,((i=this._options)==null?void 0:i.leakWarningThreshold)??jke):void 0,this._perfMon=(n=this._options)!=null&&n._profName?new x9(this._options._profName):void 0,this._deliveryQueue=(o=this._options)==null?void 0:o.deliveryQueue}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(n=this._leakageMon)==null||n.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,l,c,d,h,u,f;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const g=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(g);const m=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],p=new Gke(`${g}. HINT: Stack shows most frequent listener (${m[1]}-times)`,m[0]);return(((a=this._options)==null?void 0:a.onListenerError)||_t)(p),K.None}if(this._disposed)return K.None;t&&(e=e.bind(t));const n=new L5(e);let o;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=mU.create(),o=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof L5?(this._deliveryQueue??(this._deliveryQueue=new Dse),this._listeners=[this._listeners,n]):this._listeners.push(n):((c=(l=this._options)==null?void 0:l.onWillAddFirstListener)==null||c.call(l,this),this._listeners=n,(h=(d=this._options)==null?void 0:d.onDidAddFirstListener)==null||h.call(d,this)),(f=(u=this._options)==null?void 0:u.onDidAddListener)==null||f.call(u,this),this._size++;const r=Ve(()=>{o==null||o(),this._removeListener(n)});return i instanceof oe?i.add(r):Array.isArray(i)&&i.push(r),r}),this._event}_removeListener(e){var o,r,a,l;if((r=(o=this._options)==null?void 0:o.onWillRemoveListener)==null||r.call(o,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(l=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||l.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*Yke<=t.length){let c=0;for(let d=0;d<t.length;d++)t[d]?t[c++]=t[d]:n&&c<this._deliveryQueue.end&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=c}}_deliver(e,t){var n;if(!e)return;const i=((n=this._options)==null?void 0:n.onListenerError)||_t;if(!i){e.value(t);return}try{e.value(t)}catch(o){i(o)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,n,o;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(n=this._perfMon)==null||n.start(this._size),this._listeners)if(this._listeners instanceof L5)this._deliver(this._listeners,e);else{const r=this._deliveryQueue;r.enqueue(this,e,this._listeners.length),this._deliverQueue(r)}(o=this._perfMon)==null||o.stop()}hasListeners(){return this._size>0}};const Xke=()=>new Dse;class Dse{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class Nb extends q{constructor(e){super(e),this._isPaused=0,this._eventQueue=new Zo,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class Tse extends Nb{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class Zke extends q{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e==null?void 0:e.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class Qke{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new q({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),Ve(Tb(()=>{this.hasListeners&&this.unhook(t);const n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){var t;(t=e.listener)==null||t.dispose(),e.listener=null}dispose(){var e;this.emitter.dispose();for(const t of this.events)(e=t.listener)==null||e.dispose();this.events=[]}}class ak{constructor(){this.data=[]}wrapEvent(e,t,i){return(n,o,r)=>e(a=>{const l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(o,a)):n.call(o,a);return}const c=l;if(!c){n.call(o,t(i,a));return}c.items??(c.items=[]),c.items.push(a),c.buffers.length===0&&l.buffers.push(()=>{c.reducedResult??(c.reducedResult=i?c.items.reduce(t,i):c.items.reduce(t)),n.call(o,c.reducedResult)})},void 0,r)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}}class N0{constructor(){this.listening=!1,this.inputEvent=Se.None,this.inputEventListener=K.None,this.emitter=new q({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const Nse=Object.freeze(function(s,e){const t=setTimeout(s.bind(e),0);return{dispose(){clearTimeout(t)}}});var Ft;(function(s){function e(t){return t===s.None||t===s.Cancelled||t instanceof FT?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}s.isCancellationToken=e,s.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Se.None}),s.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Nse})})(Ft||(Ft={}));class FT{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Nse:(this._emitter||(this._emitter=new q),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let hn=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new FT),this._token}cancel(){this._token?this._token instanceof FT&&this._token.cancel():this._token=Ft.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof FT&&this._token.dispose():this._token=Ft.None}};function I9(s){const e=new hn;return s.add({dispose(){e.cancel()}}),e.token}const Rse=Symbol("MicrotaskDelay");function E9(s){return!!s&&typeof s.then=="function"}function ys(s){const e=new hn,t=s(e.token);let i=!1;const n=new Promise((o,r)=>{const a=e.token.onCancellationRequested(()=>{i=!0,a.dispose(),r(new Ml)});Promise.resolve(t).then(l=>{a.dispose(),e.dispose(),i?fv(l)&&l.dispose():o(l)},l=>{a.dispose(),e.dispose(),r(l)})});return new class{cancel(){e.cancel(),e.dispose()}then(o,r){return n.then(o,r)}catch(o){return this.then(void 0,o)}finally(o){return n.finally(o)}}}function mw(s,e,t){return new Promise((i,n)=>{const o=e.onCancellationRequested(()=>{o.dispose(),i(t)});s.then(i,n).finally(()=>o.dispose())})}function Jke(s,e){return new Promise((t,i)=>{const n=e.onCancellationRequested(()=>{n.dispose(),i(new Ml)});s.then(t,i).finally(()=>n.dispose())})}let eDe=class{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null,this.cancellationTokenSource=new hn}queue(e){if(this.cancellationTokenSource.token.isCancellationRequested)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.cancellationTokenSource.token.isCancellationRequested)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(this.cancellationTokenSource.token),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.cancellationTokenSource.cancel()}};const tDe=(s,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},s);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},iDe=s=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,s())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class Pl{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,o)=>{this.doResolve=n,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const n=this.task;return this.task=null,n()}}));const i=()=>{var n;this.deferred=null,(n=this.doResolve)==null||n.call(this,null)};return this.deferred=t===Rse?iDe(i):tDe(t,i),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Ml),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class Mse{constructor(e){this.delayer=new Pl(e),this.throttler=new eDe}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function Sh(s,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{o.dispose(),t()},s),o=e.onCancellationRequested(()=>{clearTimeout(n),o.dispose(),i(new Ml)})}):ys(t=>Sh(s,t))}function cf(s,e=0,t){const i=setTimeout(()=>{s(),t&&n.dispose()},e),n=Ve(()=>{clearTimeout(i),t==null||t.delete(n)});return t==null||t.add(n),n}function pU(s,e=i=>!!i,t=null){let i=0;const n=s.length,o=()=>{if(i>=n)return Promise.resolve(t);const r=s[i++];return Promise.resolve(r()).then(l=>e(l)?Promise.resolve(l):o())};return o()}let nDe=class{constructor(){this._runningTask=void 0,this._pendingTasks=[]}schedule(e){const t=new gv;return this._pendingTasks.push({task:e,deferred:t,setUndefinedWhenCleared:!1}),this._runIfNotRunning(),t.p}_runIfNotRunning(){this._runningTask===void 0&&this._processQueue()}async _processQueue(){if(this._pendingTasks.length===0)return;const e=this._pendingTasks.shift();if(e){if(this._runningTask)throw new et;this._runningTask=e.task;try{const t=await e.task();e.deferred.complete(t)}catch(t){e.deferred.error(t)}finally{this._runningTask=void 0,this._processQueue()}}}clearPending(){const e=this._pendingTasks;this._pendingTasks=[];for(const t of e)t.setUndefinedWhenCleared?t.deferred.complete(void 0):t.deferred.error(new Ml)}};class ha{constructor(e,t){this._isDisposed=!1,this._token=void 0,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==void 0&&(clearTimeout(this._token),this._token=void 0)}cancelAndSet(e,t){if(this._isDisposed)throw new et("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=void 0,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new et("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===void 0&&(this._token=setTimeout(()=>{this._token=void 0,e()},t))}}class _U{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new et("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=Ve(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class Ni{constructor(e,t){this.timeoutToken=void 0,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=void 0)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==void 0}onTimeout(){this.timeoutToken=void 0,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let bU,zS;(function(){const s=globalThis;typeof s.requestIdleCallback!="function"||typeof s.cancelIdleCallback!="function"?zS=(e,t,i)=>{ok(()=>{if(n)return;const o=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,o-Date.now())}}))});let n=!1;return{dispose(){n||(n=!0)}}}:zS=(e,t,i)=>{const n=e.requestIdleCallback(t,typeof i=="number"?{timeout:i}:void 0);let o=!1;return{dispose(){o||(o=!0,e.cancelIdleCallback(n))}}},bU=(e,t)=>zS(globalThis,e,t)})();class Ase{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=zS(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class sDe extends Ase{constructor(e){super(globalThis,e)}}class gv{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return this.isSettled?Promise.resolve():new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return this.isSettled?Promise.resolve():new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Ml)}}var mL;(function(s){async function e(i){let n;const o=await Promise.all(i.map(r=>r.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return o}s.settled=e;function t(i){return new Promise(async(n,o)=>{try{await i(n,o)}catch(r){o(r)}})}s.withAsyncBody=t})(mL||(mL={}));function oDe(s){const e=new hn,t=s(e.token);return new aDe(e,async i=>{const n=e.token.onCancellationRequested(()=>{n.dispose(),e.dispose(),i.reject(new Ml)});try{for await(const o of t){if(e.token.isCancellationRequested)return;i.emitOne(o)}n.dispose(),e.dispose()}catch(o){n.dispose(),e.dispose(),i.reject(o)}})}class rDe{constructor(){this._unsatisfiedConsumers=[],this._unconsumedValues=[]}get hasFinalValue(){return!!this._finalValue}produce(e){if(this._ensureNoFinalValue(),this._unsatisfiedConsumers.length>0){const t=this._unsatisfiedConsumers.shift();this._resolveOrRejectDeferred(t,e)}else this._unconsumedValues.push(e)}produceFinal(e){this._ensureNoFinalValue(),this._finalValue=e;for(const t of this._unsatisfiedConsumers)this._resolveOrRejectDeferred(t,e);this._unsatisfiedConsumers.length=0}_ensureNoFinalValue(){if(this._finalValue)throw new et("ProducerConsumer: cannot produce after final value has been set")}_resolveOrRejectDeferred(e,t){t.ok?e.complete(t.value):e.error(t.error)}consume(){if(this._unconsumedValues.length>0||this._finalValue){const e=this._unconsumedValues.length>0?this._unconsumedValues.shift():this._finalValue;return e.ok?Promise.resolve(e.value):Promise.reject(e.error)}else{const e=new gv;return this._unsatisfiedConsumers.push(e),e.p}}}const ka=class ka{constructor(e,t){this._onReturn=t,this._producerConsumer=new rDe,this._iterator={next:()=>this._producerConsumer.consume(),return:()=>{var i;return(i=this._onReturn)==null||i.call(this),Promise.resolve({done:!0,value:void 0})},throw:async i=>(this._finishError(i),{done:!0,value:void 0})},queueMicrotask(async()=>{const i=e({emitOne:n=>this._producerConsumer.produce({ok:!0,value:{done:!1,value:n}}),emitMany:n=>{for(const o of n)this._producerConsumer.produce({ok:!0,value:{done:!1,value:o}})},reject:n=>this._finishError(n)});if(!this._producerConsumer.hasFinalValue)try{await i,this._finishOk()}catch(n){this._finishError(n)}})}static fromArray(e){return new ka(t=>{t.emitMany(e)})}static fromPromise(e){return new ka(async t=>{t.emitMany(await e)})}static fromPromisesResolveOrder(e){return new ka(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new ka(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}static map(e,t){return new ka(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return ka.map(this,e)}static coalesce(e){return ka.filter(e,t=>!!t)}coalesce(){return ka.coalesce(this)}static filter(e,t){return new ka(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return ka.filter(this,e)}_finishOk(){this._producerConsumer.hasFinalValue||this._producerConsumer.produceFinal({ok:!0,value:{done:!0,value:void 0}})}_finishError(e){this._producerConsumer.hasFinalValue||this._producerConsumer.produceFinal({ok:!1,error:e})}[Symbol.asyncIterator](){return this._iterator}};ka.EMPTY=ka.fromArray([]);let Dl=ka;class aDe extends Dl{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function Pse(s){return s}class lDe{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=Pse):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}class k9{get cachedValues(){return this._map}constructor(e,t){this._map=new Map,this._map2=new Map,typeof e=="function"?(this._fn=e,this._computeKey=Pse):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);const i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}}var up;(function(s){s[s.Uninitialized=0]="Uninitialized",s[s.Running=1]="Running",s[s.Completed=2]="Completed"})(up||(up={}));class bo{constructor(e){this.executor=e,this._state=up.Uninitialized}get value(){if(this._state===up.Uninitialized){this._state=up.Running;try{this._value=this.executor()}catch(e){this._error=e}finally{this._state=up.Completed}}else if(this._state===up.Running)throw new Error("Cannot read the value of a lazy that is being initialized");if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function Ose(s){return!s||typeof s!="string"?!0:s.trim().length===0}const cDe=/{(\d+)}/g;function Rb(s,...e){return e.length===0?s:s.replace(cDe,function(t,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=e.length?t:e[n]})}function dDe(s){return s.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function hc(s){return s.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function ua(s){return s.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function hDe(s,e=" "){const t=lk(s,e);return Fse(t,e)}function lk(s,e){if(!s||!e)return s;const t=e.length;if(t===0||s.length===0)return s;let i=0;for(;s.indexOf(e,i)===i;)i=i+t;return s.substring(i)}function Fse(s,e){if(!s||!e)return s;const t=e.length,i=s.length;if(t===0||i===0)return s;let n=i,o=-1;for(;o=s.lastIndexOf(e,n-1),!(o===-1||o+t!==n);){if(o===0)return"";n=o}return s.substring(0,n)}function uDe(s){return s.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function Bse(s,e,t={}){if(!s)throw new Error("Cannot create regex from empty string");e||(s=ua(s)),t.wholeWord&&(/\B/.test(s.charAt(0))||(s="\\b"+s),/\B/.test(s.charAt(s.length-1))||(s=s+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(s,i)}function Wse(s){return s.source==="^"||s.source==="^$"||s.source==="$"||s.source==="^\\s*$"?!1:!!(s.exec("")&&s.lastIndex===0)}function fa(s){return s.split(/\r\n|\r|\n/)}function Jo(s){for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Ui(s,e=0,t=s.length){for(let i=e;i<t;i++){const n=s.charCodeAt(i);if(n!==32&&n!==9)return s.substring(e,i)}return s.substring(e,t)}function uc(s,e=s.length-1){for(let t=e;t>=0;t--){const i=s.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function pL(s,e){return s<e?-1:s>e?1:0}function vU(s,e,t=0,i=s.length,n=0,o=e.length){for(;t<i&&n<o;t++,n++){const l=s.charCodeAt(t),c=e.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const r=i-t,a=o-n;return r<a?-1:r>a?1:0}function D9(s,e){return Qy(s,e,0,s.length,0,e.length)}function Qy(s,e,t=0,i=s.length,n=0,o=e.length){for(;t<i&&n<o;t++,n++){let l=s.charCodeAt(t),c=e.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return vU(s.toLowerCase(),e.toLowerCase(),t,i,n,o);bg(l)&&(l-=32),bg(c)&&(c-=32);const d=l-c;if(d!==0)return d}const r=i-t,a=o-n;return r<a?-1:r>a?1:0}function nD(s){return s>=48&&s<=57}function bg(s){return s>=97&&s<=122}function Yd(s){return s>=65&&s<=90}function zp(s,e){return s.length===e.length&&Qy(s,e)===0}function CU(s,e){const t=e.length;return t<=s.length&&Qy(s,e,0,t)===0}function fDe(s,e){const t=s.length,i=t-e.length;return i>=0&&Qy(s,e,i,t)===0}function mc(s,e){const t=Math.min(s.length,e.length);let i;for(i=0;i<t;i++)if(s.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function df(s,e){const t=Math.min(s.length,e.length);let i;const n=s.length-1,o=e.length-1;for(i=0;i<t;i++)if(s.charCodeAt(n-i)!==e.charCodeAt(o-i))return i;return t}function vs(s){return 55296<=s&&s<=56319}function hm(s){return 56320<=s&&s<=57343}function wU(s,e){return(s-55296<<10)+(e-56320)+65536}function HN(s,e,t){const i=s.charCodeAt(t);if(vs(i)&&t+1<e){const n=s.charCodeAt(t+1);if(hm(n))return wU(i,n)}return i}function gDe(s,e){const t=s.charCodeAt(e-1);if(hm(t)&&e>1){const i=s.charCodeAt(e-2);if(vs(i))return wU(i,t)}return t}class yU{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=gDe(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=HN(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class VN{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new yU(e,t)}nextGraphemeLength(){const e=zN.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const o=t.offset,r=e.getGraphemeBreakType(t.nextCodePoint());if(FG(n,r)){t.setOffset(o);break}n=r}return t.offset-i}prevGraphemeLength(){const e=zN.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const o=t.offset,r=e.getGraphemeBreakType(t.prevCodePoint());if(FG(r,n)){t.setOffset(o);break}n=r}return i-t.offset}eol(){return this._iterator.eol()}}function SU(s,e){return new VN(s,e).nextGraphemeLength()}function Hse(s,e){return new VN(s,e).prevGraphemeLength()}function mDe(s,e){e>0&&hm(s.charCodeAt(e))&&e--;const t=e+SU(s,e);return[t-Hse(s,t),t]}let I5;function pDe(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function pw(s){return I5||(I5=pDe()),I5.test(s)}const _De=/^[\t\n\r\x20-\x7E]*$/;function ck(s){return _De.test(s)}const Vse=/[\u2028\u2029]/;function zse(s){return Vse.test(s)}function hf(s){return s>=11904&&s<=55215||s>=63744&&s<=64255||s>=65281&&s<=65374}function xU(s){return s>=127462&&s<=127487||s===8986||s===8987||s===9200||s===9203||s>=9728&&s<=10175||s===11088||s===11093||s>=127744&&s<=128591||s>=128640&&s<=128764||s>=128992&&s<=129008||s>=129280&&s<=129535||s>=129648&&s<=129782}const bDe="\uFEFF";function LU(s){return!!(s&&s.length>0&&s.charCodeAt(0)===65279)}function vDe(s,e=!1){return s?(e&&(s=s.replace(/\\./g,"")),s.toLowerCase()!==s):!1}function Use(s){return s=s%52,s<26?String.fromCharCode(97+s):String.fromCharCode(65+s-26)}function FG(s,e){return s===0?e!==5&&e!==7:s===2&&e===3?!1:s===4||s===2||s===3||e===4||e===2||e===3?!0:!(s===8&&(e===8||e===9||e===11||e===12)||(s===11||s===9)&&(e===9||e===10)||(s===12||s===10)&&e===10||e===5||e===13||e===7||s===1||s===13&&e===14||s===6&&e===6)}const Dp=class Dp{static getInstance(){return Dp._INSTANCE||(Dp._INSTANCE=new Dp),Dp._INSTANCE}constructor(){this._data=CDe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};Dp._INSTANCE=null;let zN=Dp;function CDe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function wDe(s,e){if(s===0)return 0;const t=yDe(s,e);if(t!==void 0)return t;const i=new yU(e,s);return i.prevCodePoint(),i.offset}function yDe(s,e){const t=new yU(e,s);let i=t.prevCodePoint();for(;SDe(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!xU(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function SDe(s){return 127995<=s&&s<=127999}const $se=" ",Bd=class Bd{static getInstance(e){return Bd.cache.get(Array.from(e))}static getLocales(){return Bd._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};Bd.ambiguousCharacterData=new bo(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}')),Bd.cache=new lDe({getCacheKey:JSON.stringify},e=>{function t(d){const h=new Map;for(let u=0;u<d.length;u+=2)h.set(d[u],d[u+1]);return h}function i(d,h){const u=new Map(d);for(const[f,g]of h)u.set(f,g);return u}function n(d,h){if(!d)return h;const u=new Map;for(const[f,g]of d)h.has(f)&&u.set(f,g);return u}const o=Bd.ambiguousCharacterData.value;let r=e.filter(d=>!d.startsWith("_")&&Object.hasOwn(o,d));r.length===0&&(r=["_default"]);let a;for(const d of r){const h=t(o[d]);a=n(a,h)}const l=t(o._common),c=i(l,a);return new Bd(c)}),Bd._locales=new bo(()=>Object.keys(Bd.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let _L=Bd;const GC=class GC{static getRawData(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static getData(){return this._data||(this._data=new Set([...Object.values(GC.getRawData())].flat())),this._data}static isInvisibleCharacter(e){return GC.getData().has(e)}static get codePoints(){return GC.getData()}};GC._data=void 0;let r_=GC;var BG={};let u1;const E5=globalThis.vscode;var Die;if(typeof E5<"u"&&typeof E5.process<"u"){const s=E5.process;u1={get platform(){return s.platform},get arch(){return s.arch},get env(){return s.env},cwd(){return s.cwd()}}}else typeof process<"u"&&typeof((Die=process==null?void 0:process.versions)==null?void 0:Die.node)=="string"?u1={get platform(){return process.platform},get arch(){return process.arch},get env(){return BG},cwd(){return BG.VSCODE_CWD||process.cwd()}}:u1={get platform(){return no?"win32":Bt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const UN=u1.cwd,$N=u1.env,xDe=u1.platform,LDe=65,IDe=97,EDe=90,kDe=122,a_=46,zo=47,La=92,$h=58,DDe=63;class qse extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const o=e.indexOf(".")!==-1?"property":"argument";let r=`The "${e}" ${o} ${n} of type ${t}`;r+=`. Received type ${typeof i}`,super(r),this.code="ERR_INVALID_ARG_TYPE"}}function TDe(s,e){if(s===null||typeof s!="object")throw new qse(e,"Object",s)}function Us(s,e){if(typeof s!="string")throw new qse(e,"string",s)}const km=xDe==="win32";function ki(s){return s===zo||s===La}function T9(s){return s===zo}function qh(s){return s>=LDe&&s<=EDe||s>=IDe&&s<=kDe}function qN(s,e,t,i){let n="",o=0,r=-1,a=0,l=0;for(let c=0;c<=s.length;++c){if(c<s.length)l=s.charCodeAt(c);else{if(i(l))break;l=zo}if(i(l)){if(!(r===c-1||a===1))if(a===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==a_||n.charCodeAt(n.length-2)!==a_){if(n.length>2){const d=n.lastIndexOf(t);d===-1?(n="",o=0):(n=n.slice(0,d),o=n.length-1-n.lastIndexOf(t)),r=c,a=0;continue}else if(n.length!==0){n="",o=0,r=c,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",o=2)}else n.length>0?n+=`${t}${s.slice(r+1,c)}`:n=s.slice(r+1,c),o=c-r-1;r=c,a=0}else l===a_&&a!==-1?++a:a=-1}return n}function NDe(s){return s?`${s[0]==="."?"":"."}${s}`:""}function jse(s,e){TDe(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${NDe(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${s}${i}`:i}const oa={resolve(...s){let e="",t="",i=!1;for(let n=s.length-1;n>=-1;n--){let o;if(n>=0){if(o=s[n],Us(o,`paths[${n}]`),o.length===0)continue}else e.length===0?o=UN():(o=$N[`=${e}`]||UN(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===La)&&(o=`${e}\\`));const r=o.length;let a=0,l="",c=!1;const d=o.charCodeAt(0);if(r===1)ki(d)&&(a=1,c=!0);else if(ki(d))if(c=!0,ki(o.charCodeAt(1))){let h=2,u=h;for(;h<r&&!ki(o.charCodeAt(h));)h++;if(h<r&&h!==u){const f=o.slice(u,h);for(u=h;h<r&&ki(o.charCodeAt(h));)h++;if(h<r&&h!==u){for(u=h;h<r&&!ki(o.charCodeAt(h));)h++;(h===r||h!==u)&&(l=`\\\\${f}\\${o.slice(u,h)}`,a=h)}}}else a=1;else qh(d)&&o.charCodeAt(1)===$h&&(l=o.slice(0,2),a=2,r>2&&ki(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=qN(t,!i,"\\",ki),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(s){Us(s,"path");const e=s.length;if(e===0)return".";let t=0,i,n=!1;const o=s.charCodeAt(0);if(e===1)return T9(o)?"\\":s;if(ki(o))if(n=!0,ki(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ki(s.charCodeAt(a));)a++;if(a<e&&a!==l){const c=s.slice(l,a);for(l=a;a<e&&ki(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ki(s.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${s.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${s.slice(l,a)}`,t=a)}}}else t=1;else qh(o)&&s.charCodeAt(1)===$h&&(i=s.slice(0,2),t=2,e>2&&ki(s.charCodeAt(2))&&(n=!0,t=3));let r=t<e?qN(s.slice(t),!n,"\\",ki):"";if(r.length===0&&!n&&(r="."),r.length>0&&ki(s.charCodeAt(e-1))&&(r+="\\"),!n&&i===void 0&&s.includes(":")){if(r.length>=2&&qh(r.charCodeAt(0))&&r.charCodeAt(1)===$h)return`.\\${r}`;let a=s.indexOf(":");do if(a===e-1||ki(s.charCodeAt(a+1)))return`.\\${r}`;while((a=s.indexOf(":",a+1))!==-1)}return i===void 0?n?`\\${r}`:r:n?`${i}\\${r}`:`${i}${r}`},isAbsolute(s){Us(s,"path");const e=s.length;if(e===0)return!1;const t=s.charCodeAt(0);return ki(t)||e>2&&qh(t)&&s.charCodeAt(1)===$h&&ki(s.charCodeAt(2))},join(...s){if(s.length===0)return".";let e,t;for(let o=0;o<s.length;++o){const r=s[o];Us(r,"path"),r.length>0&&(e===void 0?e=t=r:e+=`\\${r}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&ki(t.charCodeAt(0))){++n;const o=t.length;o>1&&ki(t.charCodeAt(1))&&(++n,o>2&&(ki(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&ki(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return oa.normalize(e)},relative(s,e){if(Us(s,"from"),Us(e,"to"),s===e)return"";const t=oa.resolve(s),i=oa.resolve(e);if(t===i||(s=t.toLowerCase(),e=i.toLowerCase(),s===e))return"";if(t.length!==s.length||i.length!==e.length){const g=t.split("\\"),m=i.split("\\");g[g.length-1]===""&&g.pop(),m[m.length-1]===""&&m.pop();const p=g.length,v=m.length,b=p<v?p:v;let w;for(w=0;w<b&&g[w].toLowerCase()===m[w].toLowerCase();w++);return w===0?i:w===b?v>b?m.slice(w).join("\\"):p>b?"..\\".repeat(p-1-w)+"..":"":"..\\".repeat(p-w)+m.slice(w).join("\\")}let n=0;for(;n<s.length&&s.charCodeAt(n)===La;)n++;let o=s.length;for(;o-1>n&&s.charCodeAt(o-1)===La;)o--;const r=o-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===La;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===La;)l--;const c=l-a,d=r<c?r:c;let h=-1,u=0;for(;u<d;u++){const g=s.charCodeAt(n+u);if(g!==e.charCodeAt(a+u))break;g===La&&(h=u)}if(u!==d){if(h===-1)return i}else{if(c>d){if(e.charCodeAt(a+u)===La)return i.slice(a+u+1);if(u===2)return i.slice(a+u)}r>d&&(s.charCodeAt(n+u)===La?h=u:u===2&&(h=3)),h===-1&&(h=0)}let f="";for(u=n+h+1;u<=o;++u)(u===o||s.charCodeAt(u)===La)&&(f+=f.length===0?"..":"\\..");return a+=h,f.length>0?`${f}${i.slice(a,l)}`:(i.charCodeAt(a)===La&&++a,i.slice(a,l))},toNamespacedPath(s){if(typeof s!="string"||s.length===0)return s;const e=oa.resolve(s);if(e.length<=2)return s;if(e.charCodeAt(0)===La){if(e.charCodeAt(1)===La){const t=e.charCodeAt(2);if(t!==DDe&&t!==a_)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(qh(e.charCodeAt(0))&&e.charCodeAt(1)===$h&&e.charCodeAt(2)===La)return`\\\\?\\${e}`;return e},dirname(s){Us(s,"path");const e=s.length;if(e===0)return".";let t=-1,i=0;const n=s.charCodeAt(0);if(e===1)return ki(n)?s:".";if(ki(n)){if(t=i=1,ki(s.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ki(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&ki(s.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ki(s.charCodeAt(a));)a++;if(a===e)return s;a!==l&&(t=i=a+1)}}}}else qh(n)&&s.charCodeAt(1)===$h&&(t=e>2&&ki(s.charCodeAt(2))?3:2,i=t);let o=-1,r=!0;for(let a=e-1;a>=i;--a)if(ki(s.charCodeAt(a))){if(!r){o=a;break}}else r=!1;if(o===-1){if(t===-1)return".";o=t}return s.slice(0,o)},basename(s,e){e!==void 0&&Us(e,"suffix"),Us(s,"path");let t=0,i=-1,n=!0,o;if(s.length>=2&&qh(s.charCodeAt(0))&&s.charCodeAt(1)===$h&&(t=2),e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let r=e.length-1,a=-1;for(o=s.length-1;o>=t;--o){const l=s.charCodeAt(o);if(ki(l)){if(!n){t=o+1;break}}else a===-1&&(n=!1,a=o+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=o):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(o=s.length-1;o>=t;--o)if(ki(s.charCodeAt(o))){if(!n){t=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":s.slice(t,i)},extname(s){Us(s,"path");let e=0,t=-1,i=0,n=-1,o=!0,r=0;s.length>=2&&s.charCodeAt(1)===$h&&qh(s.charCodeAt(0))&&(e=i=2);for(let a=s.length-1;a>=e;--a){const l=s.charCodeAt(a);if(ki(l)){if(!o){i=a+1;break}continue}n===-1&&(o=!1,n=a+1),l===a_?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||n===-1||r===0||r===1&&t===n-1&&t===i+1?"":s.slice(t,n)},format:jse.bind(null,"\\"),parse(s){Us(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.length;let i=0,n=s.charCodeAt(0);if(t===1)return ki(n)?(e.root=e.dir=s,e):(e.base=e.name=s,e);if(ki(n)){if(i=1,ki(s.charCodeAt(1))){let h=2,u=h;for(;h<t&&!ki(s.charCodeAt(h));)h++;if(h<t&&h!==u){for(u=h;h<t&&ki(s.charCodeAt(h));)h++;if(h<t&&h!==u){for(u=h;h<t&&!ki(s.charCodeAt(h));)h++;h===t?i=h:h!==u&&(i=h+1)}}}}else if(qh(n)&&s.charCodeAt(1)===$h){if(t<=2)return e.root=e.dir=s,e;if(i=2,ki(s.charCodeAt(2))){if(t===3)return e.root=e.dir=s,e;i=3}}i>0&&(e.root=s.slice(0,i));let o=-1,r=i,a=-1,l=!0,c=s.length-1,d=0;for(;c>=i;--c){if(n=s.charCodeAt(c),ki(n)){if(!l){r=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===a_?o===-1?o=c:d!==1&&(d=1):o!==-1&&(d=-1)}return a!==-1&&(o===-1||d===0||d===1&&o===a-1&&o===r+1?e.base=e.name=s.slice(r,a):(e.name=s.slice(r,o),e.base=s.slice(r,a),e.ext=s.slice(o,a))),r>0&&r!==i?e.dir=s.slice(0,r-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},RDe=(()=>{if(km){const s=/\\/g;return()=>{const e=UN().replace(s,"/");return e.slice(e.indexOf("/"))}}return()=>UN()})(),hs={resolve(...s){let e="",t=!1;for(let i=s.length-1;i>=0&&!t;i--){const n=s[i];Us(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===zo)}if(!t){const i=RDe();e=`${i}/${e}`,t=i.charCodeAt(0)===zo}return e=qN(e,!t,"/",T9),t?`/${e}`:e.length>0?e:"."},normalize(s){if(Us(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===zo,t=s.charCodeAt(s.length-1)===zo;return s=qN(s,!e,"/",T9),s.length===0?e?"/":t?"./":".":(t&&(s+="/"),e?`/${s}`:s)},isAbsolute(s){return Us(s,"path"),s.length>0&&s.charCodeAt(0)===zo},join(...s){if(s.length===0)return".";const e=[];for(let t=0;t<s.length;++t){const i=s[t];Us(i,"path"),i.length>0&&e.push(i)}return e.length===0?".":hs.normalize(e.join("/"))},relative(s,e){if(Us(s,"from"),Us(e,"to"),s===e||(s=hs.resolve(s),e=hs.resolve(e),s===e))return"";const t=1,i=s.length,n=i-t,o=1,r=e.length-o,a=n<r?n:r;let l=-1,c=0;for(;c<a;c++){const h=s.charCodeAt(t+c);if(h!==e.charCodeAt(o+c))break;h===zo&&(l=c)}if(c===a)if(r>a){if(e.charCodeAt(o+c)===zo)return e.slice(o+c+1);if(c===0)return e.slice(o+c)}else n>a&&(s.charCodeAt(t+c)===zo?l=c:c===0&&(l=0));let d="";for(c=t+l+1;c<=i;++c)(c===i||s.charCodeAt(c)===zo)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(o+l)}`},toNamespacedPath(s){return s},dirname(s){if(Us(s,"path"),s.length===0)return".";const e=s.charCodeAt(0)===zo;let t=-1,i=!0;for(let n=s.length-1;n>=1;--n)if(s.charCodeAt(n)===zo){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":s.slice(0,t)},basename(s,e){e!==void 0&&Us(e,"suffix"),Us(s,"path");let t=0,i=-1,n=!0,o;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s)return"";let r=e.length-1,a=-1;for(o=s.length-1;o>=0;--o){const l=s.charCodeAt(o);if(l===zo){if(!n){t=o+1;break}}else a===-1&&(n=!1,a=o+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=o):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=s.length),s.slice(t,i)}for(o=s.length-1;o>=0;--o)if(s.charCodeAt(o)===zo){if(!n){t=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":s.slice(t,i)},extname(s){Us(s,"path");let e=-1,t=0,i=-1,n=!0,o=0;for(let r=s.length-1;r>=0;--r){const a=s[r];if(a==="/"){if(!n){t=r+1;break}continue}i===-1&&(n=!1,i=r+1),a==="."?e===-1?e=r:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||i===-1||o===0||o===1&&e===i-1&&e===t+1?"":s.slice(e,i)},format:jse.bind(null,"/"),parse(s){Us(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return e;const t=s.charCodeAt(0)===zo;let i;t?(e.root="/",i=1):i=0;let n=-1,o=0,r=-1,a=!0,l=s.length-1,c=0;for(;l>=i;--l){const d=s.charCodeAt(l);if(d===zo){if(!a){o=l+1;break}continue}r===-1&&(a=!1,r=l+1),d===a_?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(r!==-1){const d=o===0&&t?1:o;n===-1||c===0||c===1&&n===r-1&&n===o+1?e.base=e.name=s.slice(d,r):(e.name=s.slice(d,n),e.base=s.slice(d,r),e.ext=s.slice(n,r))}return o>0?e.dir=s.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};hs.win32=oa.win32=oa;hs.posix=oa.posix=hs;const Kse=km?oa.normalize:hs.normalize,MDe=km?oa.resolve:hs.resolve,ADe=km?oa.relative:hs.relative,BT=km?oa.dirname:hs.dirname,Xu=km?oa.basename:hs.basename,PDe=km?oa.extname:hs.extname,id=km?oa.sep:hs.sep,ODe=/^\w[\w\d+.-]*$/,FDe=/^\//,BDe=/^\/\//;function WDe(s,e){if(!s.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${s.authority}", path: "${s.path}", query: "${s.query}", fragment: "${s.fragment}"}`);if(s.scheme&&!ODe.test(s.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(s.path){if(s.authority){if(!FDe.test(s.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(BDe.test(s.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function HDe(s,e){return!s&&!e?"file":s}function VDe(s,e){switch(s){case"https":case"http":case"file":e?e[0]!==Uc&&(e=Uc+e):e=Uc;break}return e}const ns="",Uc="/",zDe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class Ze{static isUri(e){return e instanceof Ze?!0:!e||typeof e!="object"?!1:typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function"}constructor(e,t,i,n,o,r=!1){typeof e=="object"?(this.scheme=e.scheme||ns,this.authority=e.authority||ns,this.path=e.path||ns,this.query=e.query||ns,this.fragment=e.fragment||ns):(this.scheme=HDe(e,r),this.authority=t||ns,this.path=VDe(this.scheme,i||ns),this.query=n||ns,this.fragment=o||ns,WDe(this,r))}get fsPath(){return jN(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:o,fragment:r}=e;return t===void 0?t=this.scheme:t===null&&(t=ns),i===void 0?i=this.authority:i===null&&(i=ns),n===void 0?n=this.path:n===null&&(n=ns),o===void 0?o=this.query:o===null&&(o=ns),r===void 0?r=this.fragment:r===null&&(r=ns),t===this.scheme&&i===this.authority&&n===this.path&&o===this.query&&r===this.fragment?this:new Vv(t,i,n,o,r)}static parse(e,t=!1){const i=zDe.exec(e);return i?new Vv(i[2]||ns,sD(i[4]||ns),sD(i[5]||ns),sD(i[7]||ns),sD(i[9]||ns),t):new Vv(ns,ns,ns,ns,ns)}static file(e){let t=ns;if(no&&(e=e.replace(/\\/g,Uc)),e[0]===Uc&&e[1]===Uc){const i=e.indexOf(Uc,2);i===-1?(t=e.substring(2),e=Uc):(t=e.substring(2,i),e=e.substring(i)||Uc)}return new Vv("file",t,e,ns,ns)}static from(e,t){return new Vv(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return no&&e.scheme==="file"?i=Ze.file(oa.join(jN(e,!0),...t)).path:i=hs.join(e.path,...t),e.with({path:i})}toString(e=!1){return N9(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof Ze)return e;{const t=new Vv(e);return t._formatted=e.external??null,t._fsPath=e._sep===Gse?e.fsPath??null:null,t}}else return e}}const Gse=no?1:void 0;let Vv=class extends Ze{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=jN(this,!1)),this._fsPath}toString(e=!1){return e?N9(this,!0):(this._formatted||(this._formatted=N9(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Gse),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const Yse={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function WG(s,e,t){let i,n=-1;for(let o=0;o<s.length;o++){const r=s.charCodeAt(o);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r===45||r===46||r===95||r===126||e&&r===47||t&&r===91||t&&r===93||t&&r===58)n!==-1&&(i+=encodeURIComponent(s.substring(n,o)),n=-1),i!==void 0&&(i+=s.charAt(o));else{i===void 0&&(i=s.substr(0,o));const a=Yse[r];a!==void 0?(n!==-1&&(i+=encodeURIComponent(s.substring(n,o)),n=-1),i+=a):n===-1&&(n=o)}}return n!==-1&&(i+=encodeURIComponent(s.substring(n))),i!==void 0?i:s}function UDe(s){let e;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);i===35||i===63?(e===void 0&&(e=s.substr(0,t)),e+=Yse[i]):e!==void 0&&(e+=s[t])}return e!==void 0?e:s}function jN(s,e){let t;return s.authority&&s.path.length>1&&s.scheme==="file"?t=`//${s.authority}${s.path}`:s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58?e?t=s.path.substr(1):t=s.path[1].toLowerCase()+s.path.substr(2):t=s.path,no&&(t=t.replace(/\//g,"\\")),t}function N9(s,e){const t=e?UDe:WG;let i="",{scheme:n,authority:o,path:r,query:a,fragment:l}=s;if(n&&(i+=n,i+=":"),(o||n==="file")&&(i+=Uc,i+=Uc),o){let c=o.indexOf("@");if(c!==-1){const d=o.substr(0,c);o=o.substr(c+1),c=d.lastIndexOf(":"),c===-1?i+=t(d,!1,!1):(i+=t(d.substr(0,c),!1,!1),i+=":",i+=t(d.substr(c+1),!1,!0)),i+="@"}o=o.toLowerCase(),c=o.lastIndexOf(":"),c===-1?i+=t(o,!1,!0):(i+=t(o.substr(0,c),!1,!0),i+=o.substr(c))}if(r){if(r.length>=3&&r.charCodeAt(0)===47&&r.charCodeAt(2)===58){const c=r.charCodeAt(1);c>=65&&c<=90&&(r=`/${String.fromCharCode(c+32)}:${r.substr(3)}`)}else if(r.length>=2&&r.charCodeAt(1)===58){const c=r.charCodeAt(0);c>=65&&c<=90&&(r=`${String.fromCharCode(c+32)}:${r.substr(2)}`)}i+=t(r,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:WG(l,!1,!1)),i}function Xse(s){try{return decodeURIComponent(s)}catch{return s.length>3?s.substr(0,3)+Xse(s.substr(3)):s}}const HG=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function sD(s){return s.match(HG)?s.replace(HG,e=>Xse(e)):s}var ct;(function(s){s.inMemory="inmemory",s.vscode="vscode",s.internal="private",s.walkThrough="walkThrough",s.walkThroughSnippet="walkThroughSnippet",s.http="http",s.https="https",s.file="file",s.mailto="mailto",s.untitled="untitled",s.data="data",s.command="command",s.vscodeRemote="vscode-remote",s.vscodeRemoteResource="vscode-remote-resource",s.vscodeManagedRemoteResource="vscode-managed-remote-resource",s.vscodeUserData="vscode-userdata",s.vscodeCustomEditor="vscode-custom-editor",s.vscodeNotebookCell="vscode-notebook-cell",s.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",s.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",s.vscodeNotebookCellOutput="vscode-notebook-cell-output",s.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",s.vscodeNotebookMetadata="vscode-notebook-metadata",s.vscodeInteractiveInput="vscode-interactive-input",s.vscodeSettings="vscode-settings",s.vscodeWorkspaceTrust="vscode-workspace-trust",s.vscodeTerminal="vscode-terminal",s.vscodeChatCodeBlock="vscode-chat-code-block",s.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",s.vscodeChatEditor="vscode-chat-editor",s.vscodeChatInput="chatSessionInput",s.vscodeLocalChatSession="vscode-chat-session",s.webviewPanel="webview-panel",s.vscodeWebview="vscode-webview",s.extension="extension",s.vscodeFileResource="vscode-file",s.tmp="tmp",s.vsls="vsls",s.vscodeSourceControl="vscode-scm",s.commentsInput="comment",s.codeSetting="code-setting",s.outputChannel="output",s.accessibleView="accessible-view",s.chatEditingSnapshotScheme="chat-editing-snapshot-text-model",s.chatEditingModel="chat-editing-text-model",s.copilotPr="copilot-pr"})(ct||(ct={}));function mO(s,e){return Ze.isUri(s)?zp(s.scheme,e):CU(s,e+":")}function R9(s,...e){return e.some(t=>mO(s,t))}const $De="tkn";class qDe{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}get _remoteResourcesPath(){return hs.join(this._serverRootPath,ct.vscodeRemoteResource)}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return _t(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],o=this._connectionTokens[t];let r=`path=${encodeURIComponent(e.path)}`;return typeof o=="string"&&(r+=`&${$De}=${encodeURIComponent(o)}`),Ze.from({scheme:Ah?this._preferredWebSchema:ct.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:r})}}const Zse=new qDe,jDe="vscode-app",Bx=class Bx{uriToBrowserUri(e){return e.scheme===ct.vscodeRemote?Zse.rewrite(e):e.scheme===ct.file&&(ad||Lke===`${ct.vscodeFileResource}://${Bx.FALLBACK_AUTHORITY}`)?e.with({scheme:ct.vscodeFileResource,authority:e.authority||Bx.FALLBACK_AUTHORITY,query:null,fragment:null}):e}};Bx.FALLBACK_AUTHORITY=jDe;let M9=Bx;const Qse=new M9;var A9;(function(s){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(o){let r;typeof o=="string"?r=new URL(o).searchParams:o instanceof URL?r=o.searchParams:Ze.isUri(o)&&(r=new URL(o.toString(!0)).searchParams);const a=r==null?void 0:r.get(t);if(a)return e.get(a)}s.getHeadersFromQuery=i;function n(o,r,a){if(!globalThis.crossOriginIsolated)return;const l=r&&a?"3":a?"2":"1";o instanceof URLSearchParams?o.set(t,l):o[t]=l}s.addSearchParam=n})(A9||(A9={}));const VG=typeof Buffer<"u";new bo(()=>new Uint8Array(256));let k5;class Og{static wrap(e){return VG&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new Og(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return VG?this.buffer.toString():(k5||(k5=new TextDecoder),k5.decode(this.buffer))}}function KDe(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0}function GDe(s,e,t){s[t+0]=e&255,e=e>>>8,s[t+1]=e&255}function Fc(s,e){return s[e]*2**24+s[e+1]*2**16+s[e+2]*2**8+s[e+3]}function Bc(s,e,t){s[t+3]=e,e=e>>>8,s[t+2]=e,e=e>>>8,s[t+1]=e,e=e>>>8,s[t]=e}function zG(s,e){return s[e]}function UG(s,e,t){s[t]=e}const $G="0123456789abcdef";function YDe({buffer:s}){let e="";for(let t=0;t<s.length;t++){const i=s[t];e+=$G[i>>>4],e+=$G[i&15]}return e}function dk(s){return pO(s,0)}function pO(s,e){switch(typeof s){case"object":return s===null?Nu(349,e):Array.isArray(s)?ZDe(s,e):QDe(s,e);case"string":return IU(s,e);case"boolean":return XDe(s,e);case"number":return Nu(s,e);case"undefined":return Nu(937,e);default:return Nu(617,e)}}function Nu(s,e){return(e<<5)-e+s|0}function XDe(s,e){return Nu(s?433:863,e)}function IU(s,e){e=Nu(149417,e);for(let t=0,i=s.length;t<i;t++)e=Nu(s.charCodeAt(t),e);return e}function ZDe(s,e){return e=Nu(104579,e),s.reduce((t,i)=>pO(i,t),e)}function QDe(s,e){return e=Nu(181387,e),Object.keys(s).sort().reduce((t,i)=>(t=IU(i,t),pO(s[i],t)),e)}function D5(s,e,t=32){const i=t-e,n=~((1<<i)-1);return(s<<e|(n&s)>>>i)>>>0}function R0(s,e=32){return s instanceof ArrayBuffer?YDe(Og.wrap(new Uint8Array(s))):(s>>>0).toString(16).padStart(e/4,"0")}const lA=class lA{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,o=this._leftoverHighSurrogate,r,a;for(o!==0?(r=o,a=-1,o=0):(r=e.charCodeAt(0),a=0);;){let l=r;if(vs(r))if(a+1<t){const c=e.charCodeAt(a+1);hm(c)?(a++,l=wU(r,c)):l=65533}else{o=r;break}else hm(r)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)r=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=o}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),R0(this._h0)+R0(this._h1)+R0(this._h2)+R0(this._h3)+R0(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,this._buff.subarray(this._buffLen).fill(0),this._buffLen>56&&(this._step(),this._buff.fill(0));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=lA._bigBlock32,t=this._buffDV;for(let h=0;h<64;h+=4)e.setUint32(h,t.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)e.setUint32(h,D5(e.getUint32(h-12,!1)^e.getUint32(h-32,!1)^e.getUint32(h-56,!1)^e.getUint32(h-64,!1),1),!1);let i=this._h0,n=this._h1,o=this._h2,r=this._h3,a=this._h4,l,c,d;for(let h=0;h<80;h++)h<20?(l=n&o|~n&r,c=1518500249):h<40?(l=n^o^r,c=1859775393):h<60?(l=n&o|n&r|o&r,c=2400959708):(l=n^o^r,c=3395469782),d=D5(i,5)+l+a+c+e.getUint32(h*4,!1)&4294967295,a=r,r=o,o=D5(n,30),n=i,i=d;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+r&4294967295,this._h4=this._h4+a&4294967295}};lA._bigBlock32=new DataView(new ArrayBuffer(320));let P9=lA;function JDe(s){if(s.length===0)throw new Error("Invalid tail call");return[s.slice(0,s.length-1),s[s.length-1]]}function dn(s,e,t=(i,n)=>i===n){if(s===e)return!0;if(!s||!e||s.length!==e.length)return!1;for(let i=0,n=s.length;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function eTe(s,e){const t=s.length-1;e<t&&(s[e]=s[t]),s.pop()}function KN(s,e,t){return EU(s.length,i=>t(s[i],e))}function EU(s,e){let t=0,i=s-1;for(;t<=i;){const n=(t+i)/2|0,o=e(n);if(o<0)t=n+1;else if(o>0)i=n-1;else return n}return-(t+1)}function O9(s,e,t){if(s=s|0,s>=e.length)throw new TypeError("invalid index");const i=e[Math.floor(e.length*Math.random())],n=[],o=[],r=[];for(const a of e){const l=t(a,i);l<0?n.push(a):l>0?o.push(a):r.push(a)}return s<n.length?O9(s,n,t):s<n.length+r.length?r[0]:O9(s-(n.length+r.length),o,t)}function qG(s,e){const t=[];let i;for(const n of s.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function*kU(s,e){let t,i;for(const n of s)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function Jse(s,e){for(let t=0;t<=s.length;t++)e(t===0?void 0:s[t-1],t===s.length?void 0:s[t])}function tTe(s,e){for(let t=0;t<s.length;t++)e(t===0?void 0:s[t-1],s[t],t+1===s.length?void 0:s[t+1])}function bd(s){return s.filter(e=>!!e)}function jG(s){let e=0;for(let t=0;t<s.length;t++)s[t]&&(s[e]=s[t],e+=1);s.length=e}function eoe(s){return!Array.isArray(s)||s.length===0}function er(s){return Array.isArray(s)&&s.length>0}function uf(s,e=t=>t){const t=new Set;return s.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function cr(s,e){let t=typeof e=="number"?s:0;typeof e=="number"?t=s:(t=0,e=s);const i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function _O(s,e,t){const i=s.slice(0,e),n=s.slice(e);return i.concat(t,n)}function T5(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.unshift(e))}function oD(s,e){const t=s.indexOf(e);t>-1&&(s.splice(t,1),s.push(e))}function F9(s,e){for(const t of e)s.push(t)}function iTe(s,e){const t=[];for(const i of s){const n=e(i);n!==void 0&&t.push(n)}return t}function DU(s){return Array.isArray(s)?s:[s]}function nTe(s,e,t){const i=toe(s,e),n=s.length,o=t.length;s.length=n+o;for(let r=n-1;r>=i;r--)s[r+o]=s[r];for(let r=0;r<o;r++)s[r+i]=t[r]}function GN(s,e,t,i){const n=toe(s,e);let o=s.splice(n,t);return o===void 0&&(o=[]),nTe(s,n,i),o}function toe(s,e){return e<0?Math.max(e+s.length,0):Math.min(e,s.length)}var Fg;(function(s){function e(o){return o<0}s.isLessThan=e;function t(o){return o<=0}s.isLessThanOrEqual=t;function i(o){return o>0}s.isGreaterThan=i;function n(o){return o===0}s.isNeitherLessOrGreaterThan=n,s.greaterThan=1,s.lessThan=-1,s.neitherLessOrGreaterThan=0})(Fg||(Fg={}));function wo(s,e){return(t,i)=>e(s(t),s(i))}function sTe(...s){return(e,t)=>{for(const i of s){const n=i(e,t);if(!Fg.isNeitherLessOrGreaterThan(n))return n}return Fg.neitherLessOrGreaterThan}}const aa=(s,e)=>s-e,ioe=(s,e)=>aa(s?1:0,e?1:0);function noe(s){return(e,t)=>-s(e,t)}function oTe(s){return(e,t)=>e===void 0?t===void 0?Fg.neitherLessOrGreaterThan:Fg.lessThan:t===void 0?Fg.greaterThan:s(e,t)}class ff{constructor(e){this.firstIdx=0,this.items=e,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}const YC=class YC{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new YC(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new YC(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||Fg.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};YC.empty=new YC(e=>{});let l_=YC;class YN{constructor(e){this._indexMap=e}static createSortPermutation(e,t){const i=Array.from(e.keys()).sort((n,o)=>t(e[n],e[o]));return new YN(i)}apply(e){return e.map((t,i)=>e[this._indexMap[i]])}inverse(){const e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new YN(e)}}function XN(s){return s.reduce((e,t)=>e+t,0)}let ep;function rTe(s){ep?ep instanceof KG?ep.loggers.push(s):ep=new KG([ep,s]):ep=s}function Ro(){return ep}class KG{constructor(e){this.loggers=e}handleObservableCreated(e,t){for(const i of this.loggers)i.handleObservableCreated(e,t)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e,t){for(const i of this.loggers)i.handleAutorunCreated(e,t)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const n of this.loggers)n.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const n of this.loggers)n.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}}var Ls;(function(s){let e=!1;function t(){e=!0}s.enable=t;function i(){if(!e)return;const n=Error,o=n.stackTraceLimit;n.stackTraceLimit=3;const r=new Error().stack;return n.stackTraceLimit=o,TU.fromStack(r,2)}s.ofCaller=i})(Ls||(Ls={}));class TU{static fromStack(e,t){const i=e.split(`
`),n=aTe(i[t+1]);if(n)return new TU(n.fileName,n.line,n.column,n.id)}constructor(e,t,i,n){this.fileName=e,this.line=t,this.column=i,this.id=n}}function aTe(s){const e=s.match(/\((.*):(\d+):(\d+)\)/);if(e)return{fileName:e[1],line:parseInt(e[2]),column:parseInt(e[3]),id:s};const t=s.match(/at ([^\(\)]*):(\d+):(\d+)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:s}}const Ja=(s,e)=>s===e;function bL(s=Ja){return(e,t)=>dn(e,t,s)}function NU(){return(s,e)=>s.equals(e)}function Up(s,e,t){if(t!==void 0){const i=s;return i==null||e===void 0||e===null?e===i:t(i,e)}else{const i=s;return(n,o)=>n==null||o===void 0||o===null?o===n:i(n,o)}}function B9(s,e){if(s===e)return!0;if(Array.isArray(s)&&Array.isArray(e)){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!B9(s[t],e[t]))return!1;return!0}if(s&&typeof s=="object"&&e&&typeof e=="object"&&Object.getPrototypeOf(s)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const t=s,i=e,n=Object.keys(t),o=Object.keys(i),r=new Set(o);if(n.length!==o.length)return!1;for(const a of n)if(!r.has(a)||!B9(t[a],i[a]))return!1;return!0}return!1}class So{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return lTe(e,this)}}const GG=new Map,W9=new WeakMap;function lTe(s,e){const t=W9.get(s);if(t)return t;const i=cTe(s,e);if(i){let n=GG.get(i)??0;n++,GG.set(i,n);const o=n===1?i:`${i}#${n}`;return W9.set(s,o),o}}function cTe(s,e){const t=W9.get(s);if(t)return t;const i=e.owner?hTe(e.owner)+".":"";let n;const o=e.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(n=o(),n!==void 0)return i+n}else return i+o;const r=e.referenceFn;if(r!==void 0&&(n=RU(r),n!==void 0))return i+n;if(e.owner!==void 0){const a=dTe(e.owner,s);if(a!==void 0)return i+a}}function dTe(s,e){for(const t in s)if(s[t]===e)return t}const YG=new Map,XG=new WeakMap;function hTe(s){const e=XG.get(s);if(e)return e;const t=soe(s)??"Object";let i=YG.get(t)??0;i++,YG.set(t,i);const n=i===1?t:`${t}#${i}`;return XG.set(s,n),n}function soe(s){const e=s.constructor;if(e)return e.name==="Object"?void 0:e.name}function RU(s){const e=s.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),n=i?i[1]:void 0;return n==null?void 0:n.trim()}let H9;function uTe(s){H9=s}let ooe;function fTe(s){ooe=s}class roe{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t,i=Ls.ofCaller()){const n=t===void 0?void 0:e,o=t===void 0?e:t;return H9({owner:n,debugName:()=>{const r=RU(o);if(r!==void 0)return r;const l=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(o.toString());if(l)return`${this.debugName}.${l[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:o},r=>o(this.read(r),r),i)}flatten(){return H9({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(ooe(this,t)),this}}class Jy extends roe{constructor(e){var t;super(),this._observers=new Set,(t=Ro())==null||t.handleObservableCreated(this,e)}addObserver(e){var i;const t=this._observers.size;this._observers.add(e),t===0&&this.onFirstObserverAdded(),t!==this._observers.size&&((i=Ro())==null||i.handleOnListenerCountChanged(this,this._observers.size))}removeObserver(e){var i;const t=this._observers.delete(e);t&&this._observers.size===0&&this.onLastObserverRemoved(),t&&((i=Ro())==null||i.handleOnListenerCountChanged(this,this._observers.size))}onFirstObserverAdded(){}onLastObserverRemoved(){}debugGetObservers(){return this._observers}}function gTe(s){switch(s){case 0:return"initial";case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}class ml extends Jy{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n=void 0,o,r){var a;super(r),this._debugNameData=e,this._computeFn=t,this._changeTracker=i,this._handleLastObserverRemoved=n,this._equalityComparator=o,this._state=0,this._value=void 0,this._updateCount=0,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._didReportChange=!1,this._isInBeforeUpdate=!1,this._isReaderValid=!1,this._store=void 0,this._delayedStore=void 0,this._removedObserverToCallEndUpdateOn=null,this._changeSummary=(a=this._changeTracker)==null?void 0:a.createChangeSummary(void 0)}onLastObserverRemoved(){var e,t;this._state=0,this._value=void 0,(e=Ro())==null||e.handleDerivedCleared(this);for(const i of this._dependencies)i.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._delayedStore!==void 0&&(this._delayedStore.dispose(),this._delayedStore=void 0),(t=this._handleLastObserverRemoved)==null||t.call(this)}get(){var t,i;if(this._isComputing,this._observers.size===0){let n;try{this._isReaderValid=!0;let o;this._changeTracker&&(o=this._changeTracker.createChangeSummary(void 0),(i=(t=this._changeTracker).beforeUpdate)==null||i.call(t,this,o)),n=this._computeFn(this,o)}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),n}else{do{if(this._state===1){for(const n of this._dependencies)if(n.reportChanges(),this._state===2)break}this._state===1&&(this._state=3),this._state!==3&&this._recompute()}while(this._state!==3);return this._value}}_recompute(){var i,n,o,r;let e=!1;this._isComputing=!0,this._didReportChange=!1;const t=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=t;try{const a=this._changeSummary;this._isReaderValid=!0,this._changeTracker&&(this._isInBeforeUpdate=!0,(n=(i=this._changeTracker).beforeUpdate)==null||n.call(i,this,a),this._isInBeforeUpdate=!1,this._changeSummary=(o=this._changeTracker)==null?void 0:o.createChangeSummary(a));const l=this._state!==0,c=this._value;this._state=3;const d=this._delayedStore;d!==void 0&&(this._delayedStore=void 0);try{this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._value=this._computeFn(this,a)}finally{this._isReaderValid=!1;for(const h of this._dependenciesToBeRemoved)h.removeObserver(this);this._dependenciesToBeRemoved.clear(),d!==void 0&&d.dispose()}e=this._didReportChange||l&&!this._equalityComparator(c,this._value),(r=Ro())==null||r.handleObservableUpdated(this,{oldValue:c,newValue:this._value,change:void 0,didChange:e,hadValue:l})}catch(a){FN(a)}if(this._isComputing=!1,!this._didReportChange&&e)for(const a of this._observers)a.handleChange(this,void 0);else this._didReportChange=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new et("Cyclic deriveds are not supported yet!");this._updateCount++,this._isUpdating=!0;try{const t=this._updateCount===1;if(this._state===3&&(this._state=1,!t))for(const i of this._observers)i.handlePossibleChange(this);if(t)for(const i of this._observers)i.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this._updateCount--,this._updateCount===0){const t=[...this._observers];for(const i of t)i.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){const i=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const n of i)n.endUpdate(this)}}dm(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===3&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=1;for(const t of this._observers)t.handlePossibleChange(this)}}handleChange(e,t){var i;if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)||this._isInBeforeUpdate){(i=Ro())==null||i.handleDerivedDependencyChanged(this,e,t);let n=!1;try{n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this._changeSummary):!0}catch(r){FN(r)}const o=this._state===3;if(n&&(this._state===1||o)&&(this._state=2,o))for(const r of this._observers)r.handlePossibleChange(this)}}_ensureReaderValid(){if(!this._isReaderValid)throw new et("The reader object cannot be used outside its compute function!")}readObservable(e){this._ensureReaderValid(),e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){return this._ensureReaderValid(),this._store===void 0&&(this._store=new oe),this._store}addObserver(e){const t=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e),t&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)?this._removedObserverToCallEndUpdateOn.delete(e):e.beginUpdate(this))}removeObserver(e){this._observers.has(e)&&this._updateCount>0&&(this._removedObserverToCallEndUpdateOn||(this._removedObserverToCallEndUpdateOn=new Set),this._removedObserverToCallEndUpdateOn.add(e)),super.removeObserver(e)}debugGetState(){return{state:this._state,stateStr:gTe(this._state),updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}debugRecompute(){this._isComputing?this._state=2:this._recompute()}setValue(e,t,i){this._value=e;const n=this._observers;t.updateObserver(this,this);for(const o of n)o.handleChange(this,i)}}class aoe extends ml{constructor(e,t,i,n=void 0,o,r,a){super(e,t,i,n,o,a),this.set=r}}function ae(s,e,t=Ls.ofCaller()){return e!==void 0?new ml(new So(s,void 0,e),e,void 0,void 0,Ja,t):new ml(new So(void 0,void 0,s),s,void 0,void 0,Ja,t)}function MU(s,e,t,i=Ls.ofCaller()){return new aoe(new So(s,void 0,e),e,void 0,void 0,Ja,t,i)}function _o(s,e,t=Ls.ofCaller()){return new ml(new So(s.owner,s.debugName,s.debugReferenceFn),e,void 0,s.onLastObserverRemoved,s.equalsFn??Ja,t)}uTe(_o);function ZG(s,e,t=Ls.ofCaller()){return new ml(new So(s.owner,s.debugName,void 0),e,s.changeTracker,void 0,s.equalityComparer??Ja,t)}function gl(s,e,t=Ls.ofCaller()){let i,n;e===void 0?(i=s,n=void 0):(n=s,i=e);let o;return new ml(new So(n,void 0,i),r=>{o?o.clear():o=new oe;const a=i(r);return a&&o.add(a),a},void 0,()=>{o&&(o.dispose(),o=void 0)},Ja,t)}function mTe(s){switch(s){case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}class vL{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n){var o,r;this._debugNameData=e,this._runFn=t,this._changeTracker=i,this._state=2,this._updateCount=0,this._disposed=!1,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._isRunning=!1,this._store=void 0,this._delayedStore=void 0,this._changeSummary=(o=this._changeTracker)==null?void 0:o.createChangeSummary(void 0),(r=Ro())==null||r.handleAutorunCreated(this,n),this._run()}dispose(){var e;if(!this._disposed){this._disposed=!0;for(const t of this._dependencies)t.removeObserver(this);this._dependencies.clear(),this._store!==void 0&&this._store.dispose(),this._delayedStore!==void 0&&this._delayedStore.dispose(),(e=Ro())==null||e.handleAutorunDisposed(this)}}_run(){var t,i,n,o;const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e,this._state=3;try{if(!this._disposed){(t=Ro())==null||t.handleAutorunStarted(this);const r=this._changeSummary,a=this._delayedStore;a!==void 0&&(this._delayedStore=void 0);try{this._isRunning=!0,this._changeTracker&&((n=(i=this._changeTracker).beforeUpdate)==null||n.call(i,this,r),this._changeSummary=this._changeTracker.createChangeSummary(r)),this._store!==void 0&&(this._store.dispose(),this._store=void 0),this._runFn(this,r)}catch(l){FN(l)}finally{this._isRunning=!1,a!==void 0&&a.dispose()}}}finally{this._disposed||(o=Ro())==null||o.handleAutorunFinished(this);for(const r of this._dependenciesToBeRemoved)r.removeObserver(this);this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this._state===3&&(this._state=1),this._updateCount++}endUpdate(e){try{if(this._updateCount===1)do{if(this._state===1){this._state=3;for(const t of this._dependencies)if(t.reportChanges(),this._state===2)break}this._state!==3&&this._run()}while(this._state!==3)}finally{this._updateCount--}dm(()=>this._updateCount>=0)}handlePossibleChange(e){this._state===3&&this._isDependency(e)&&(this._state=1)}handleChange(e,t){var i;if(this._isDependency(e)){(i=Ro())==null||i.handleAutorunDependencyChanged(this,e,t);try{(this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:t,didChange:o=>o===e},this._changeSummary):!0)&&(this._state=2)}catch(n){FN(n)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}_ensureNoRunning(){if(!this._isRunning)throw new et("The reader object cannot be used outside its compute function!")}readObservable(e){if(this._ensureNoRunning(),this._disposed)return e.get();e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}get store(){if(this._ensureNoRunning(),this._disposed)throw new et("Cannot access store after dispose");return this._store===void 0&&(this._store=new oe),this._store}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state,stateStr:mTe(this._state)}}debugRerun(){this._isRunning?this._state=2:this._run()}}function lt(s,e=Ls.ofCaller()){return new vL(new So(void 0,void 0,s),s,void 0,e)}function bO(s,e,t=Ls.ofCaller()){return new vL(new So(s.owner,s.debugName,s.debugReferenceFn??e),e,void 0,t)}function e0(s,e,t=Ls.ofCaller()){return new vL(new So(s.owner,s.debugName,s.debugReferenceFn??e),e,s.changeTracker,t)}function pTe(s,e){const t=new oe,i=e0({owner:s.owner,debugName:s.debugName,debugReferenceFn:s.debugReferenceFn??e,changeTracker:s.changeTracker},(n,o)=>{t.clear(),e(n,o,t)});return Ve(()=>{i.dispose(),t.dispose()})}function Ao(s){const e=new oe,t=bO({owner:void 0,debugName:void 0,debugReferenceFn:s},i=>{e.clear(),s(i,e)});return Ve(()=>{t.dispose(),e.dispose()})}function _Te(s,e){let t;return bO({debugReferenceFn:e},i=>{const n=s.read(i),o=t;t=n,e({lastValue:o,newValue:n})})}function QG(s){const e=new Error("BugIndicatingErrorRecovery: "+s);_t(e),console.error("recovered from an error that indicates a bug",e)}function Ki(s,e){const t=new t0(s,e);try{s(t)}finally{t.finish()}}let rD;function bS(s){if(rD)s(rD);else{const e=new t0(s,void 0);rD=e;try{s(e)}finally{e.finish(),rD=void 0}}}async function bTe(s,e){const t=new t0(s,e);try{await s(t)}finally{t.finish()}}function _w(s,e,t){s?e(s):Ki(e,t)}class t0{constructor(e,t){var i;this._fn=e,this._getDebugName=t,this._updatingObservers=[],(i=Ro())==null||i.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():RU(this._fn)}updateObserver(e,t){if(!this._updatingObservers){QG("Transaction already finished!"),Ki(i=>{i.updateObserver(e,t)});return}this._updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){var t;const e=this._updatingObservers;if(!e){QG("transaction.finish() has already been called!");return}for(let i=0;i<e.length;i++){const{observer:n,observable:o}=e[i];n.endUpdate(o)}this._updatingObservers=null,(t=Ro())==null||t.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}}function fi(...s){let e,t,i,n;return s.length===2?[t,i]=s:[e,t,i,n]=s,new Ru(new So(e,void 0,i),t,i,()=>Ru.globalTransaction,Ja,n??Ls.ofCaller())}function loe(s,e,t,i=Ls.ofCaller()){return new Ru(new So(s.owner,s.debugName,s.debugReferenceFn??t),e,t,()=>Ru.globalTransaction,s.equalsFn??Ja,i)}class Ru extends Jy{constructor(e,t,i,n,o,r){super(r),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=n,this._equalityComparator=o,this._hasValue=!1,this.handleEvent=a=>{var u;const l=this._getValue(a),c=this._value,d=!this._hasValue||!this._equalityComparator(c,l);let h=!1;d&&(this._value=l,this._hasValue&&(h=!0,_w(this._getTransaction(),f=>{var g;(g=Ro())==null||g.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:d,hadValue:this._hasValue});for(const m of this._observers)f.updateObserver(m,this),m.handleChange(this,void 0)},()=>{const f=this.getDebugName();return"Event fired"+(f?`: ${f}`:"")})),this._hasValue=!0),h||(u=Ro())==null||u.handleObservableUpdated(this,{oldValue:c,newValue:l,change:void 0,didChange:d,hadValue:this._hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose(),this._subscription=void 0,this._hasValue=!1,this._value=void 0}get(){return this._subscription?(this._hasValue||this.handleEvent(void 0),this._value):this._getValue(void 0)}debugSetValue(e){this._value=e}debugGetState(){return{value:this._value,hasValue:this._hasValue}}}(function(s){s.Observer=Ru;function e(t,i){let n=!1;Ru.globalTransaction===void 0&&(Ru.globalTransaction=t,n=!0);try{i()}finally{n&&(Ru.globalTransaction=void 0)}}s.batchEventsGlobally=e})(fi||(fi={}));function JG(s,e){let t=!1,i,n;return fi(o=>{const r=lt(a=>{const l=s.read(a);t?(n&&clearTimeout(n),n=setTimeout(()=>{i=l,o()},e)):(t=!0,i=l)});return{dispose(){r.dispose(),t=!1,i=void 0}}},()=>t?i:s.get())}function bw(s,e){const t=new vTe(!0,e);s.addObserver(t);try{t.beginUpdate(s)}finally{t.endUpdate(s)}return Ve(()=>{s.removeObserver(t)})}fTe(bw);class vTe{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter===1&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges()),this._counter--}handlePossibleChange(e){}handleChange(e,t){}}function Ef(s,e){let t;return _o({owner:s,debugReferenceFn:e},n=>(t=e(n,t),t))}function AU(s,e,t,i){let n=new eY(t,i);return _o({debugReferenceFn:t,owner:s,onLastObserverRemoved:()=>{n.dispose(),n=new eY(t)}},r=>(n.setItems(e.read(r)),n.getItems()))}let eY=class{constructor(e,t){this._map=e,this._keySelector=t,this._cache=new Map,this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){const t=[],i=new Set(this._cache.keys());for(const n of e){const o=this._keySelector?this._keySelector(n):n;let r=this._cache.get(o);if(r)i.delete(o);else{const a=new oe;r={out:this._map(n,a),store:a},this._cache.set(o,r)}t.push(r.out)}for(const n of i)this._cache.get(n).store.dispose(),this._cache.delete(n);this._items=t}getItems(){return this._items}};function xC(s,e){switch(typeof s){case"number":return""+s;case"string":return s.length+2<=e?`"${s}"`:`"${s.substr(0,e-7)}"+...`;case"boolean":return s?"true":"false";case"undefined":return"undefined";case"object":return s===null?"null":Array.isArray(s)?CTe(s,e):wTe(s,e);case"symbol":return s.toString();case"function":return`[[Function${s.name?" "+s.name:""}]]`;default:return""+s}}function CTe(s,e){let t="[ ",i=!0;for(const n of s){if(i||(t+=", "),t.length-5>e){t+="...";break}i=!1,t+=`${xC(n,e-t.length)}`}return t+=" ]",t}function wTe(s,e){if(typeof s.toString=="function"&&s.toString!==Object.prototype.toString){const o=s.toString();return o.length<=e?o:o.substring(0,e-3)+"..."}const t=soe(s);let i=t?t+"(":"{ ",n=!0;for(const[o,r]of Object.entries(s)){if(n||(i+=", "),i.length-5>e){i+="...";break}n=!1,i+=`${o}: ${xC(r,e-i.length)}`}return i+=t?")":" }",i}class PU{static createClient(e,t){return new PU(e,t)}constructor(e,t){this._channelFactory=e,this._getHandler=t,this._channel=this._channelFactory({handleNotification:o=>{const r=o,a=this._getHandler().notifications[r[0]];if(!a)throw new Error(`Unknown notification "${r[0]}"!`);a(...r[1])},handleRequest:o=>{const r=o;try{return{type:"result",value:this._getHandler().requests[r[0]](...r[1])}}catch(a){return{type:"error",value:a}}}});const i=new Proxy({},{get:(o,r)=>async(...a)=>{const l=await this._channel.sendRequest([r,a]);if(l.type==="error")throw l.value;return l.value}}),n=new Proxy({},{get:(o,r)=>(...a)=>{this._channel.sendNotification([r,a])}});this.api={notifications:n,requests:i}}}function yTe(s,e){const t=globalThis;let i=[],n;const{channel:o,handler:r}=STe({sendNotification:l=>{n?n.sendNotification(l):i.push(l)}});let a;return(t.$$debugValueEditor_debugChannels??(t.$$debugValueEditor_debugChannels={}))[s]=l=>{a=e(),n=l;for(const c of i)l.sendNotification(c);return i=[],r},PU.createClient(o,()=>{if(!a)throw new Error("Not supported");return a})}function STe(s){let e;return{channel:i=>(e=i,{sendNotification:n=>{s.sendNotification(n)},sendRequest:n=>{throw new Error("not supported")}}),handler:{handleRequest:i=>i.type==="notification"?e==null?void 0:e.handleNotification(i.data):e==null?void 0:e.handleRequest(i.data)}}}class xTe{constructor(){this._timeout=void 0}throttle(e,t){this._timeout===void 0&&(this._timeout=setTimeout(()=>{this._timeout=void 0,e()},t))}dispose(){this._timeout!==void 0&&clearTimeout(this._timeout)}}function coe(s,e){for(const t in e)s[t]&&typeof s[t]=="object"&&e[t]&&typeof e[t]=="object"?coe(s[t],e[t]):s[t]=e[t]}function doe(s,e){for(const t in e)e[t]===null?delete s[t]:s[t]&&typeof s[t]=="object"&&e[t]&&typeof e[t]=="object"?doe(s[t],e[t]):s[t]=e[t]}function ht(s,e,t=Ls.ofCaller()){let i;return typeof s=="string"?i=new So(void 0,s,void 0):i=new So(s,void 0,void 0),new CL(i,e,Ja,t)}class CL extends Jy{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i,n){var o;super(n),this._debugNameData=e,this._equalityComparator=i,this._value=t,(o=Ro())==null||o.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this._value}set(e,t,i){var o;if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new t0(()=>{},()=>`Setting ${this.debugName}`));try{const r=this._value;this._setValue(e),(o=Ro())==null||o.handleObservableUpdated(this,{oldValue:r,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this._observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}}function OU(s,e,t=Ls.ofCaller()){let i;return typeof s=="string"?i=new So(void 0,s,void 0):i=new So(s,void 0,void 0),new LTe(i,e,Ja,t)}class LTe extends CL{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){var e;(e=this._value)==null||e.dispose()}}const Tp=class Tp{static getInstance(){return Tp._instance===void 0&&(Tp._instance=new Tp),Tp._instance}getTransactionState(){const e=[],t=[...this._activeTransactions];if(t.length===0)return;const i=t.flatMap(o=>o.debugGetUpdatingObservers()??[]).map(o=>o.observer),n=new Set;for(;i.length>0;){const o=i.shift();if(n.has(o))continue;n.add(o);const r=this._getInfo(o,a=>{n.has(a)||i.push(a)});r&&e.push(r)}return{names:t.map(o=>o.getDebugName()??"tx"),affected:e}}_getObservableInfo(e){const t=this._instanceInfos.get(e);if(!t){_t(new et("No info found"));return}return t}_getAutorunInfo(e){const t=this._instanceInfos.get(e);if(!t){_t(new et("No info found"));return}return t}_getInfo(e,t){if(e instanceof ml){const i=[...e.debugGetObservers()];for(const l of i)t(l);const n=this._getObservableInfo(e);if(!n)return;const o=e.debugGetState(),r={name:e.debugName,instanceId:n.instanceId,updateCount:o.updateCount},a=[...n.changedObservables].map(l=>{var c;return(c=this._instanceInfos.get(l))==null?void 0:c.instanceId}).filter($s);if(o.isComputing)return{...r,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(o.state){case 0:return{...r,type:"observable/derived",state:"noValue"};case 3:return{...r,type:"observable/derived",state:"upToDate"};case 2:return{...r,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...r,type:"observable/derived",state:"possiblyStale"}}}else if(e instanceof vL){const i=this._getAutorunInfo(e);if(!i)return;const n={name:e.debugName,instanceId:i.instanceId,updateCount:i.updateCount},o=[...i.changedObservables].map(r=>this._instanceInfos.get(r).instanceId);if(e.debugGetState().isRunning)return{...n,type:"autorun",state:"updating",changedDependencies:o};switch(e.debugGetState().state){case 3:return{...n,type:"autorun",state:"upToDate"};case 2:return{...n,type:"autorun",state:"stale",changedDependencies:o};case 1:return{...n,type:"autorun",state:"possiblyStale"}}}}_formatObservable(e){const t=this._getObservableInfo(e);if(t)return{name:e.debugName,instanceId:t.instanceId}}_formatObserver(e){var i;if(e instanceof ml)return{name:e.toString(),instanceId:(i=this._getObservableInfo(e))==null?void 0:i.instanceId};const t=this._getAutorunInfo(e);if(t)return{name:e.toString(),instanceId:t.instanceId}}constructor(){this._declarationId=0,this._instanceId=0,this._declarations=new Map,this._instanceInfos=new WeakMap,this._aliveInstances=new Map,this._activeTransactions=new Set,this._channel=yTe("observableDevTools",()=>({notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log("logObservableValue",e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null,this._channel.api.notifications.handleChange(this._fullState,!0)}},requests:{getDeclarations:()=>{const e={};for(const t of this._declarations.values())e[t.id]=t;return{decls:e}},getSummarizedInstances:()=>null,getObservableValueInfo:e=>({observers:[...this._aliveInstances.get(e).debugGetObservers()].map(i=>this._formatObserver(i)).filter($s)}),getDerivedInfo:e=>{const t=this._aliveInstances.get(e);return{dependencies:[...t.debugGetState().dependencies].map(i=>this._formatObservable(i)).filter($s),observers:[...t.debugGetObservers()].map(i=>this._formatObserver(i)).filter($s)}},getAutorunInfo:e=>({dependencies:[...this._aliveInstances.get(e).debugGetState().dependencies].map(i=>this._formatObservable(i)).filter($s)}),getTransactionState:()=>this.getTransactionState(),setValue:(e,t)=>{const i=this._aliveInstances.get(e);if(i instanceof ml)i.debugSetValue(t);else if(i instanceof CL)i.debugSetValue(t);else if(i instanceof Ru)i.debugSetValue(t);else throw new et("Observable is not supported");const n=[...i.debugGetObservers()];for(const o of n)o.beginUpdate(i);for(const o of n)o.handleChange(i,void 0);for(const o of n)o.endUpdate(i)},getValue:e=>{const t=this._aliveInstances.get(e);if(t instanceof ml)return xC(t.debugGetState().value,200);if(t instanceof CL)return xC(t.debugGetState().value,200)},logValue:e=>{const t=this._aliveInstances.get(e);if(t&&"get"in t)console.log("Logged Value:",t.get());else throw new et("Observable is not supported")},rerun:e=>{const t=this._aliveInstances.get(e);if(t instanceof ml)t.debugRecompute();else if(t instanceof vL)t.debugRerun();else throw new et("Observable is not supported")}}})),this._pendingChanges=null,this._changeThrottler=new xTe,this._fullState={},this._flushUpdates=()=>{this._pendingChanges!==null&&(this._channel.api.notifications.handleChange(this._pendingChanges,!1),this._pendingChanges=null)},Ls.enable()}_handleChange(e){doe(this._fullState,e),this._pendingChanges===null?this._pendingChanges=e:coe(this._pendingChanges,e),this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e,t){if(!t)return-1;let i=this._declarations.get(t.id);return i===void 0&&(i={id:this._declarationId++,type:e,url:t.fileName,line:t.line,column:t.column},this._declarations.set(t.id,i),this._handleChange({decls:{[i.id]:i}})),i.id}handleObservableCreated(e,t){const n={declarationId:this._getDeclarationId("observable/value",t),instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n)}handleOnListenerCountChanged(e,t){const i=this._getObservableInfo(e);if(i){if(i.listenerCount===0&&t>0){const n=e instanceof ml?"observable/derived":"observable/value";this._aliveInstances.set(i.instanceId,e),this._handleChange({instances:{[i.instanceId]:{instanceId:i.instanceId,declarationId:i.declarationId,formattedValue:i.lastValue,type:n,name:e.debugName}}})}else i.listenerCount>0&&t===0&&(this._handleChange({instances:{[i.instanceId]:null}}),this._aliveInstances.delete(i.instanceId));i.listenerCount=t}}handleObservableUpdated(e,t){if(e instanceof ml){this._handleDerivedRecomputed(e,t);return}const i=this._getObservableInfo(e);i&&t.didChange&&(i.lastValue=xC(t.newValue,30),i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:i.lastValue}}}))}handleAutorunCreated(e,t){const n={declarationId:this._getDeclarationId("autorun",t),instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n),this._aliveInstances.set(n.instanceId,e),n&&this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,runCount:0,type:"autorun",name:e.debugName}}})}handleAutorunDisposed(e){const t=this._getAutorunInfo(e);t&&(this._handleChange({instances:{[t.instanceId]:null}}),this._instanceInfos.delete(e),this._aliveInstances.delete(t.instanceId))}handleAutorunDependencyChanged(e,t,i){const n=this._getAutorunInfo(e);n&&n.changedObservables.add(t)}handleAutorunStarted(e){}handleAutorunFinished(e){const t=this._getAutorunInfo(e);t&&(t.changedObservables.clear(),t.updateCount++,this._handleChange({instances:{[t.instanceId]:{runCount:t.updateCount}}}))}handleDerivedDependencyChanged(e,t,i){const n=this._getObservableInfo(e);n&&n.changedObservables.add(t)}_handleDerivedRecomputed(e,t){const i=this._getObservableInfo(e);if(!i)return;const n=xC(t.newValue,30);i.updateCount++,i.changedObservables.clear(),i.lastValue=n,i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:n,recomputationCount:i.updateCount}}})}handleDerivedCleared(e){const t=this._getObservableInfo(e);t&&(t.lastValue=void 0,t.changedObservables.clear(),t.listenerCount>0&&this._handleChange({instances:{[t.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}};Tp._instance=void 0;let V9=Tp;$N&&$N.VSCODE_DEV_DEBUG_OBSERVABLES&&rTe(V9.getInstance());const{getWindow:je,getDocument:ITe,getWindows:hoe,getWindowsCount:ETe,getWindowId:wL,getWindowById:tY,onDidRegisterWindow:hk,onWillUnregisterWindow:kTe,onDidUnregisterWindow:DTe}=(function(){const s=new Map;fke(Ti,1);const e={window:Ti,disposables:new oe};s.set(Ti.vscodeWindowId,e);const t=new q,i=new q,n=new q;function o(r,a){return(typeof r=="number"?s.get(r):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(r){if(s.has(r.vscodeWindowId))return K.None;const a=new oe,l={window:r,disposables:a.add(new oe)};return s.set(r.vscodeWindowId,l),a.add(Ve(()=>{s.delete(r.vscodeWindowId),i.fire(r)})),a.add(ee(r,ye.BEFORE_UNLOAD,()=>{n.fire(r)})),t.fire(l),a},getWindows(){return s.values()},getWindowsCount(){return s.size},getWindowId(r){return r.vscodeWindowId},hasWindow(r){return s.has(r)},getWindowById:o,getWindow(r){var c;const a=r;if((c=a==null?void 0:a.ownerDocument)!=null&&c.defaultView)return a.ownerDocument.defaultView.window;const l=r;return l!=null&&l.view?l.view.window:Ti},getDocument(r){return je(r).document}}})();function io(s){for(;s.firstChild;)s.firstChild.remove()}class TTe{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function ee(s,e,t,i){return new TTe(s,e,t,i)}function uoe(s,e){return function(t){return e(new Co(s,t))}}function NTe(s){return function(e){return s(new Bi(e))}}const Jn=function(e,t,i,n){let o=i;return t==="click"||t==="mousedown"||t==="contextmenu"?o=uoe(je(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(o=NTe(i)),ee(e,t,o,n)},RTe=function(e,t,i){const n=uoe(je(e),t);return foe(e,n,i)};function foe(s,e,t){return ee(s,Al&&rk.pointerEvents?ye.POINTER_DOWN:ye.MOUSE_DOWN,e,t)}function MTe(s,e,t){return ee(s,Al&&rk.pointerEvents?ye.POINTER_MOVE:ye.MOUSE_MOVE,e,t)}function iY(s,e,t){return ee(s,Al&&rk.pointerEvents?ye.POINTER_UP:ye.MOUSE_UP,e,t)}function vS(s,e,t){return zS(s,e,t)}class N5 extends Ase{constructor(e,t){super(e,t)}}let ZN,Vr;class FU extends _U{constructor(e){super(),this.defaultTarget=e&&je(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}}class R5{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){_t(e)}}static sort(e,t){return t.priority-e.priority}}(function(){const s=new Map,e=new Map,t=new Map,i=new Map,n=o=>{t.set(o,!1);const r=s.get(o)??[];for(e.set(o,r),s.set(o,[]),i.set(o,!0);r.length>0;)r.sort(R5.sort),r.shift().execute();i.set(o,!1)};Vr=(o,r,a=0)=>{const l=wL(o),c=new R5(r,a);let d=s.get(l);return d||(d=[],s.set(l,d)),d.push(c),t.get(l)||(t.set(l,!0),o.requestAnimationFrame(()=>n(l))),c},ZN=(o,r,a)=>{const l=wL(o);if(i.get(l)){const c=new R5(r,a);let d=e.get(l);return d||(d=[],e.set(l,d)),d.push(c),c}else return Vr(o,r,a)}})();function vO(s){return je(s).getComputedStyle(s,null)}function um(s,e,t){const i=je(s),n=i.document;if(s!==n.body)return new wi(s.clientWidth,s.clientHeight);if(Al&&(i!=null&&i.visualViewport))return new wi(i.visualViewport.width,i.visualViewport.height);if(i!=null&&i.innerWidth&&i.innerHeight)return new wi(i.innerWidth,i.innerHeight);if(n.body&&n.body.clientWidth&&n.body.clientHeight)return new wi(n.body.clientWidth,n.body.clientHeight);if(n.documentElement&&n.documentElement.clientWidth&&n.documentElement.clientHeight)return new wi(n.documentElement.clientWidth,n.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class Zn{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t){const i=vO(e),n=i?i.getPropertyValue(t):"0";return Zn.convertToPixels(e,n)}static getBorderLeftWidth(e){return Zn.getDimension(e,"border-left-width")}static getBorderRightWidth(e){return Zn.getDimension(e,"border-right-width")}static getBorderTopWidth(e){return Zn.getDimension(e,"border-top-width")}static getBorderBottomWidth(e){return Zn.getDimension(e,"border-bottom-width")}static getPaddingLeft(e){return Zn.getDimension(e,"padding-left")}static getPaddingRight(e){return Zn.getDimension(e,"padding-right")}static getPaddingTop(e){return Zn.getDimension(e,"padding-top")}static getPaddingBottom(e){return Zn.getDimension(e,"padding-bottom")}static getMarginLeft(e){return Zn.getDimension(e,"margin-left")}static getMarginTop(e){return Zn.getDimension(e,"margin-top")}static getMarginRight(e){return Zn.getDimension(e,"margin-right")}static getMarginBottom(e){return Zn.getDimension(e,"margin-bottom")}}const Np=class Np{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Np(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof Np?e:new Np(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};Np.None=new Np(0,0);let wi=Np;function goe(s){let e=s.offsetParent,t=s.offsetTop,i=s.offsetLeft;for(;(s=s.parentNode)!==null&&s!==s.ownerDocument.body&&s!==s.ownerDocument.documentElement;){t-=s.scrollTop;const n=poe(s)?null:vO(s);n&&(i-=n.direction!=="rtl"?s.scrollLeft:-s.scrollLeft),s===e&&(i+=Zn.getBorderLeftWidth(s),t+=Zn.getBorderTopWidth(s),t+=s.offsetTop,i+=s.offsetLeft,e=s.offsetParent)}return{left:i,top:t}}function ATe(s,e,t){typeof e=="number"&&(s.style.width=`${e}px`),typeof t=="number"&&(s.style.height=`${t}px`)}function Fn(s){const e=s.getBoundingClientRect(),t=je(s);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function moe(s){let e=s,t=1;do{const i=vO(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function Jr(s){const e=Zn.getMarginLeft(s)+Zn.getMarginRight(s);return s.offsetWidth+e}function M5(s){const e=Zn.getBorderLeftWidth(s)+Zn.getBorderRightWidth(s),t=Zn.getPaddingLeft(s)+Zn.getPaddingRight(s);return s.offsetWidth-e-t}function PTe(s){const e=Zn.getBorderTopWidth(s)+Zn.getBorderBottomWidth(s),t=Zn.getPaddingTop(s)+Zn.getPaddingBottom(s);return s.offsetHeight-e-t}function Mu(s){const e=Zn.getMarginTop(s)+Zn.getMarginBottom(s);return s.offsetHeight+e}function Ps(s,e){return!!(e!=null&&e.contains(s))}function OTe(s,e,t){for(;s&&s.nodeType===s.ELEMENT_NODE;){if(s.classList.contains(e))return s;if(t){if(typeof t=="string"){if(s.classList.contains(t))return null}else if(s===t)return null}s=s.parentNode}return null}function A5(s,e,t){return!!OTe(s,e,t)}function poe(s){return s&&!!s.host&&!!s.mode}function QN(s){return!!fm(s)}function fm(s){var e;for(;s.parentNode;){if(s===((e=s.ownerDocument)==null?void 0:e.body))return null;s=s.parentNode}return poe(s)?s:null}function Ss(){let s=uk().activeElement;for(;s!=null&&s.shadowRoot;)s=s.shadowRoot.activeElement;return s}function CO(s){return Ss()===s}function _oe(s){return Ps(Ss(),s)}function uk(){return ETe()<=1?Ti.document:Array.from(hoe()).map(({window:e})=>e.document).find(e=>e.hasFocus())??Ti.document}function xi(){var e;return((e=uk().defaultView)==null?void 0:e.window)??Ti}const FTe=new class{constructor(){this.mutationObservers=new Map}observe(s,e,t){let i=this.mutationObservers.get(s);i||(i=new Map,this.mutationObservers.set(s,i));const n=dk(t);let o=i.get(n);if(o)o.users+=1;else{const r=new q,a=new MutationObserver(c=>r.fire(c));a.observe(s,t);const l=o={users:1,observer:a,onDidMutate:r.event};e.add(Ve(()=>{l.users-=1,l.users===0&&(r.dispose(),a.disconnect(),i==null||i.delete(n),(i==null?void 0:i.size)===0&&this.mutationObservers.delete(s))})),i.set(n,o)}return o.onDidMutate}};function Bn(s){return s instanceof HTMLElement||s instanceof je(s).HTMLElement}function nY(s){return s instanceof HTMLAnchorElement||s instanceof je(s).HTMLAnchorElement}function boe(s){return s instanceof SVGElement||s instanceof je(s).SVGElement}function BU(s){return s instanceof MouseEvent||s instanceof je(s).MouseEvent}function pu(s){return s instanceof KeyboardEvent||s instanceof je(s).KeyboardEvent}const ye={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"};function BTe(s){const e=s;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const ri={stop:(s,e)=>(s.preventDefault(),e&&s.stopPropagation(),s)};function WTe(s){const e=[];for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)e[t]=s.scrollTop,s=s.parentNode;return e}function HTe(s,e){for(let t=0;s&&s.nodeType===s.ELEMENT_NODE;t++)s.scrollTop!==e[t]&&(s.scrollTop=e[t]),s=s.parentNode}let VTe=class z9 extends K{get onDidFocus(){return this._onDidFocus.event}get onDidBlur(){return this._onDidBlur.event}static hasFocusWithin(e){if(Bn(e)){const t=fm(e),i=t?t.activeElement:e.ownerDocument.activeElement;return Ps(i,e)}else{const t=e;return Ps(t.document.activeElement,t.document)}}constructor(e){super(),this._onDidFocus=this._register(new q),this._onDidBlur=this._register(new q);let t=z9.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},o=()=>{t&&(i=!0,(Bn(e)?je(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{z9.hasFocusWithin(e)!==t&&(t?o():n())},this._register(ee(e,ye.FOCUS,n,!0)),this._register(ee(e,ye.BLUR,o,!0)),Bn(e)&&(this._register(ee(e,ye.FOCUS_IN,()=>this._refreshStateHandler())),this._register(ee(e,ye.FOCUS_OUT,()=>this._refreshStateHandler())))}};function Ol(s){return new VTe(s)}function zTe(s,e){return s.after(e),e}function me(s,...e){if(s.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function wO(s,e){return s.insertBefore(e,s.firstChild),e}function Os(s,...e){s.textContent="",me(s,...e)}const UTe=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var yL;(function(s){s.HTML="http://www.w3.org/1999/xhtml",s.SVG="http://www.w3.org/2000/svg"})(yL||(yL={}));function voe(s,e,t,...i){const n=UTe.exec(e);if(!n)throw new Error("Bad use of emmet");const o=n[1]||"div";let r;return s!==yL.HTML?r=document.createElementNS(s,o):r=document.createElement(o),n[3]&&(r.id=n[3]),n[4]&&(r.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?r[a]=l:a==="selected"?l&&r.setAttribute(a,"true"):r.setAttribute(a,l))}),r.append(...i),r}function we(s,e,...t){return voe(yL.HTML,s,e,...t)}we.SVG=function(s,e,...t){return voe(yL.SVG,s,e,...t)};function $Te(s,...e){s?ta(...e):hr(...e)}function ta(...s){for(const e of s)e.style.display="",e.removeAttribute("aria-hidden")}function hr(...s){for(const e of s)e.style.display="none",e.setAttribute("aria-hidden","true")}function sY(s,e){const t=s.devicePixelRatio*e;return Math.max(1,Math.floor(t))/s.devicePixelRatio}function Coe(s){Ti.open(s,"_blank","noopener")}function qTe(s,e){const t=()=>{e(),i=Vr(s,t)};let i=Vr(s,t);return Ve(()=>i.dispose())}Zse.setPreferredWebSchema(/^https:/.test(Ti.location.href)?"https":"http");class Au extends q{constructor(){super(),this._subscriptions=new oe,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(Se.runAndSubscribe(hk,({window:e,disposables:t})=>this.registerListeners(e,t),{window:Ti,disposables:this._subscriptions}))}registerListeners(e,t){t.add(ee(e,"keydown",i=>{if(i.defaultPrevented)return;const n=new Bi(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(ee(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(ee(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(ee(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(ee(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(ee(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return Au.instance||(Au.instance=new Au),Au.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class jTe extends K{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(ee(this.element,ye.DRAG_START,e=>{var t,i;(i=(t=this.callbacks).onDragStart)==null||i.call(t,e)})),this.callbacks.onDrag&&this._register(ee(this.element,ye.DRAG,e=>{var t,i;(i=(t=this.callbacks).onDrag)==null||i.call(t,e)})),this._register(ee(this.element,ye.DRAG_ENTER,e=>{var t,i;this.counter++,this.dragStartTime=e.timeStamp,(i=(t=this.callbacks).onDragEnter)==null||i.call(t,e)})),this._register(ee(this.element,ye.DRAG_OVER,e=>{var t,i;e.preventDefault(),(i=(t=this.callbacks).onDragOver)==null||i.call(t,e,e.timeStamp-this.dragStartTime)})),this._register(ee(this.element,ye.DRAG_LEAVE,e=>{var t,i;this.counter--,this.counter===0&&(this.dragStartTime=0,(i=(t=this.callbacks).onDragLeave)==null||i.call(t,e))})),this._register(ee(this.element,ye.DRAG_END,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDragEnd)==null||i.call(t,e)})),this._register(ee(this.element,ye.DROP,e=>{var t,i;this.counter=0,this.dragStartTime=0,(i=(t=this.callbacks).onDrop)==null||i.call(t,e)}))}}const KTe=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function ei(s,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=KTe.exec(s);if(!n||!n.groups)throw new Error("Bad use of h");const o=n.groups.tag||"div",r=document.createElement(o);n.groups.id&&(r.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(r.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=r),i)for(const c of i)Bn(c)?r.appendChild(c):typeof c=="string"?r.append(c):"root"in c&&(Object.assign(l,c),r.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[h,u]of Object.entries(d))r.style.setProperty(SL(h),typeof u=="number"?u+"px":""+u);else c==="tabIndex"?r.tabIndex=d:r.setAttribute(SL(c),d.toString());return l.root=r,l}function SL(s){return s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function nd(s){return s.tagName.toLowerCase()==="input"||s.tagName.toLowerCase()==="textarea"||Bn(s)&&!!s.editContext}var kt;(function(s){function e(n=void 0){return(o,r,a)=>{const l=r.class;delete r.class;const c=r.ref;delete r.ref;const d=r.obsRef;return delete r.obsRef,new YTe(o,c,d,n,l,r,a)}}function t(n,o=void 0){const r=e(o);return(a,l)=>r(n,a,l)}s.div=t("div"),s.elem=e(void 0),s.svg=t("svg","http://www.w3.org/2000/svg"),s.svgElem=e("http://www.w3.org/2000/svg");function i(){let n;const o=function(r){n=r};return Object.defineProperty(o,"element",{get(){if(!n)throw new et("Make sure the ref is set before accessing the element. Maybe wrong initialization order?");return n}}),o}s.ref=i})(kt||(kt={}));class WU{constructor(e,t,i,n,o,r,a){this._deriveds=[],this._element=n?document.createElementNS(n,e):document.createElement(e),t&&t(this._element),i&&this._deriveds.push(ae(l=>{i(this),l.store.add({dispose:()=>{i(null)}})})),o&&(yoe(o)?this._deriveds.push(ae(this,l=>{oY(this._element,rY(o,l))})):oY(this._element,rY(o,void 0)));for(const[l,c]of Object.entries(r))if(l==="style")for(const[d,h]of Object.entries(c)){const u=SL(d);$p(h)?this._deriveds.push(_o({owner:this,debugName:()=>`set.style.${u}`},f=>{this._element.style.setProperty(u,aY(h.read(f)))})):this._element.style.setProperty(u,aY(h))}else l==="tabIndex"?$p(c)?this._deriveds.push(ae(this,d=>{this._element.tabIndex=c.read(d)})):this._element.tabIndex=c:l.startsWith("on")?this._element[l]=c:$p(c)?this._deriveds.push(_o({owner:this,debugName:()=>`set.${l}`},d=>{lY(this._element,l,c.read(d))})):lY(this._element,l,c);if(a){let l=function(d,h){return $p(h)?l(d,h.read(d)):Array.isArray(h)?h.flatMap(u=>l(d,u)):h instanceof WU?(d&&h.readEffect(d),[h._element]):h?[h]:[]};const c=ae(this,d=>{this._element.replaceChildren(...l(d,a))});this._deriveds.push(c),Soe(a)||c.get()}}readEffect(e){for(const t of this._deriveds)t.read(e)}keepUpdated(e){return ae(t=>{this.readEffect(t)}).recomputeInitiallyAndOnChange(e),this}toDisposableLiveElement(){const e=new oe;return this.keepUpdated(e),new GTe(this._element,e)}}function oY(s,e){boe(s)?s.setAttribute("class",e):s.className=e}function woe(s,e,t){if($p(s)){t(s.read(e));return}if(Array.isArray(s)){for(const i of s)woe(i,e,t);return}t(s)}function rY(s,e){let t="";return woe(s,e,i=>{i&&(t.length===0?t=i:t+=" "+i)}),t}function yoe(s){return $p(s)?!0:Array.isArray(s)?s.some(e=>yoe(e)):!1}function aY(s){return typeof s=="number"?s+"px":s}function Soe(s){return $p(s)?!0:Array.isArray(s)?s.some(e=>Soe(e)):!1}class GTe{constructor(e,t){this.element=e,this._disposable=t}dispose(){this._disposable.dispose()}}class YTe extends WU{constructor(){super(...arguments),this._isHovered=void 0,this._didMouseMoveDuringHover=void 0}get element(){return this._element}get isHovered(){if(!this._isHovered){const e=ht("hovered",!1);this._element.addEventListener("mouseenter",t=>e.set(!0,void 0)),this._element.addEventListener("mouseleave",t=>e.set(!1,void 0)),this._isHovered=e}return this._isHovered}get didMouseMoveDuringHover(){if(!this._didMouseMoveDuringHover){let e=!1;const t=ht("didMouseMoveDuringHover",!1);this._element.addEventListener("mouseenter",i=>{e=!0}),this._element.addEventListener("mousemove",i=>{e&&t.set(!0,void 0)}),this._element.addEventListener("mouseleave",i=>{e=!1,t.set(!1,void 0)}),this._didMouseMoveDuringHover=t}return this._didMouseMoveDuringHover}}function lY(s,e,t){t==null?s.removeAttribute(SL(e)):s.setAttribute(SL(e),String(t))}function $p(s){return!!s&&s.read!==void 0&&s.reportChanges!==void 0}const cY=2e4;let fp,WT,U9,HT,$9;function XTe(s){fp=document.createElement("div"),fp.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),fp.appendChild(i),i};WT=e(),U9=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),fp.appendChild(i),i};HT=t(),$9=t(),s.appendChild(fp)}function br(s){fp&&(WT.textContent!==s?(io(U9),JN(WT,s)):(io(WT),JN(U9,s)))}function ld(s){fp&&(HT.textContent!==s?(io($9),JN(HT,s)):(io(HT),JN($9,s)))}function JN(s,e){io(s),e.length>cY&&(e=e.substr(0,cY)),s.textContent=e,s.style.visibility="hidden",s.style.visibility="visible"}var Jc;(function(s){s.serviceIds=new Map,s.DI_TARGET="$di$target",s.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[s.DI_DEPENDENCIES]||[]}s.getServiceDependencies=e})(Jc||(Jc={}));const $e=Mt("instantiationService");function ZTe(s,e,t){e[Jc.DI_TARGET]===e?e[Jc.DI_DEPENDENCIES].push({id:s,index:t}):(e[Jc.DI_DEPENDENCIES]=[{id:s,index:t}],e[Jc.DI_TARGET]=e)}function Mt(s){if(Jc.serviceIds.has(s))return Jc.serviceIds.get(s);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");ZTe(e,t,n)};return e.toString=()=>s,Jc.serviceIds.set(s,e),e}const ii=Mt("codeEditorService");let z=class tp{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new tp(e,t)}delta(e=0,t=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+t))}equals(e){return tp.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return tp.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return tp.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const o=e.column|0,r=t.column|0;return o-r}return i-n}clone(){return new tp(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new tp(e.lineNumber,e.column)}static isIPosition(e){return!!e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};const Cn=Mt("modelService"),nr=Mt("textModelService");class Ga extends K{get onDidChange(){return this._onDidChange.event}constructor(e,t="",i="",n=!0,o){super(),this._onDidChange=this._register(new q),this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class Mb extends K{constructor(){super(...arguments),this._onWillRun=this._register(new q),this._onDidRun=this._register(new q)}get onWillRun(){return this._onWillRun.event}get onDidRun(){return this._onDidRun.event}async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}}const Wx=class Wx{constructor(){this.id=Wx.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new Wx,...i]:t=i);return t}async run(){}};Wx.ID="vs.actions.separator";let _s=Wx;class vw{get actions(){return this._actions}constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}}const cA=class cA extends Ga{constructor(){super(cA.ID,_(28,"(empty)"),void 0,!1)}};cA.ID="vs.actions.empty";let q9=cA;function c_(s){return{id:s.id,label:s.label,tooltip:s.tooltip??s.label,class:s.class,enabled:s.enabled??!0,checked:s.checked,run:async(...e)=>s.run(...e)}}const j9=Object.create(null);function k(s,e){if(As(e)){const t=j9[e];if(t===void 0)throw new Error(`${s} references an unknown codicon: ${e}`);e=t}return j9[s]=e,{id:s}}function xoe(){return j9}const QTe={add:k("add",6e4),plus:k("plus",6e4),gistNew:k("gist-new",6e4),repoCreate:k("repo-create",6e4),lightbulb:k("lightbulb",60001),lightBulb:k("light-bulb",60001),repo:k("repo",60002),repoDelete:k("repo-delete",60002),gistFork:k("gist-fork",60003),repoForked:k("repo-forked",60003),gitPullRequest:k("git-pull-request",60004),gitPullRequestAbandoned:k("git-pull-request-abandoned",60004),recordKeys:k("record-keys",60005),keyboard:k("keyboard",60005),tag:k("tag",60006),gitPullRequestLabel:k("git-pull-request-label",60006),tagAdd:k("tag-add",60006),tagRemove:k("tag-remove",60006),person:k("person",60007),personFollow:k("person-follow",60007),personOutline:k("person-outline",60007),personFilled:k("person-filled",60007),sourceControl:k("source-control",60008),mirror:k("mirror",60009),mirrorPublic:k("mirror-public",60009),star:k("star",60010),starAdd:k("star-add",60010),starDelete:k("star-delete",60010),starEmpty:k("star-empty",60010),comment:k("comment",60011),commentAdd:k("comment-add",60011),alert:k("alert",60012),warning:k("warning",60012),search:k("search",60013),searchSave:k("search-save",60013),logOut:k("log-out",60014),signOut:k("sign-out",60014),logIn:k("log-in",60015),signIn:k("sign-in",60015),eye:k("eye",60016),eyeUnwatch:k("eye-unwatch",60016),eyeWatch:k("eye-watch",60016),circleFilled:k("circle-filled",60017),primitiveDot:k("primitive-dot",60017),closeDirty:k("close-dirty",60017),debugBreakpoint:k("debug-breakpoint",60017),debugBreakpointDisabled:k("debug-breakpoint-disabled",60017),debugHint:k("debug-hint",60017),terminalDecorationSuccess:k("terminal-decoration-success",60017),primitiveSquare:k("primitive-square",60018),edit:k("edit",60019),pencil:k("pencil",60019),info:k("info",60020),issueOpened:k("issue-opened",60020),gistPrivate:k("gist-private",60021),gitForkPrivate:k("git-fork-private",60021),lock:k("lock",60021),mirrorPrivate:k("mirror-private",60021),close:k("close",60022),removeClose:k("remove-close",60022),x:k("x",60022),repoSync:k("repo-sync",60023),sync:k("sync",60023),clone:k("clone",60024),desktopDownload:k("desktop-download",60024),beaker:k("beaker",60025),microscope:k("microscope",60025),vm:k("vm",60026),deviceDesktop:k("device-desktop",60026),file:k("file",60027),more:k("more",60028),ellipsis:k("ellipsis",60028),kebabHorizontal:k("kebab-horizontal",60028),mailReply:k("mail-reply",60029),reply:k("reply",60029),organization:k("organization",60030),organizationFilled:k("organization-filled",60030),organizationOutline:k("organization-outline",60030),newFile:k("new-file",60031),fileAdd:k("file-add",60031),newFolder:k("new-folder",60032),fileDirectoryCreate:k("file-directory-create",60032),trash:k("trash",60033),trashcan:k("trashcan",60033),history:k("history",60034),clock:k("clock",60034),folder:k("folder",60035),fileDirectory:k("file-directory",60035),symbolFolder:k("symbol-folder",60035),logoGithub:k("logo-github",60036),markGithub:k("mark-github",60036),github:k("github",60036),terminal:k("terminal",60037),console:k("console",60037),repl:k("repl",60037),zap:k("zap",60038),symbolEvent:k("symbol-event",60038),error:k("error",60039),stop:k("stop",60039),variable:k("variable",60040),symbolVariable:k("symbol-variable",60040),array:k("array",60042),symbolArray:k("symbol-array",60042),symbolModule:k("symbol-module",60043),symbolPackage:k("symbol-package",60043),symbolNamespace:k("symbol-namespace",60043),symbolObject:k("symbol-object",60043),symbolMethod:k("symbol-method",60044),symbolFunction:k("symbol-function",60044),symbolConstructor:k("symbol-constructor",60044),symbolBoolean:k("symbol-boolean",60047),symbolNull:k("symbol-null",60047),symbolNumeric:k("symbol-numeric",60048),symbolNumber:k("symbol-number",60048),symbolStructure:k("symbol-structure",60049),symbolStruct:k("symbol-struct",60049),symbolParameter:k("symbol-parameter",60050),symbolTypeParameter:k("symbol-type-parameter",60050),symbolKey:k("symbol-key",60051),symbolText:k("symbol-text",60051),symbolReference:k("symbol-reference",60052),goToFile:k("go-to-file",60052),symbolEnum:k("symbol-enum",60053),symbolValue:k("symbol-value",60053),symbolRuler:k("symbol-ruler",60054),symbolUnit:k("symbol-unit",60054),activateBreakpoints:k("activate-breakpoints",60055),archive:k("archive",60056),arrowBoth:k("arrow-both",60057),arrowDown:k("arrow-down",60058),arrowLeft:k("arrow-left",60059),arrowRight:k("arrow-right",60060),arrowSmallDown:k("arrow-small-down",60061),arrowSmallLeft:k("arrow-small-left",60062),arrowSmallRight:k("arrow-small-right",60063),arrowSmallUp:k("arrow-small-up",60064),arrowUp:k("arrow-up",60065),bell:k("bell",60066),bold:k("bold",60067),book:k("book",60068),bookmark:k("bookmark",60069),debugBreakpointConditionalUnverified:k("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:k("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:k("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:k("debug-breakpoint-data-unverified",60072),debugBreakpointData:k("debug-breakpoint-data",60073),debugBreakpointDataDisabled:k("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:k("debug-breakpoint-log-unverified",60074),debugBreakpointLog:k("debug-breakpoint-log",60075),debugBreakpointLogDisabled:k("debug-breakpoint-log-disabled",60075),briefcase:k("briefcase",60076),broadcast:k("broadcast",60077),browser:k("browser",60078),bug:k("bug",60079),calendar:k("calendar",60080),caseSensitive:k("case-sensitive",60081),check:k("check",60082),checklist:k("checklist",60083),chevronDown:k("chevron-down",60084),chevronLeft:k("chevron-left",60085),chevronRight:k("chevron-right",60086),chevronUp:k("chevron-up",60087),chromeClose:k("chrome-close",60088),chromeMaximize:k("chrome-maximize",60089),chromeMinimize:k("chrome-minimize",60090),chromeRestore:k("chrome-restore",60091),circleOutline:k("circle-outline",60092),circle:k("circle",60092),debugBreakpointUnverified:k("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:k("terminal-decoration-incomplete",60092),circleSlash:k("circle-slash",60093),circuitBoard:k("circuit-board",60094),clearAll:k("clear-all",60095),clippy:k("clippy",60096),closeAll:k("close-all",60097),cloudDownload:k("cloud-download",60098),cloudUpload:k("cloud-upload",60099),code:k("code",60100),collapseAll:k("collapse-all",60101),colorMode:k("color-mode",60102),commentDiscussion:k("comment-discussion",60103),creditCard:k("credit-card",60105),dash:k("dash",60108),dashboard:k("dashboard",60109),database:k("database",60110),debugContinue:k("debug-continue",60111),debugDisconnect:k("debug-disconnect",60112),debugPause:k("debug-pause",60113),debugRestart:k("debug-restart",60114),debugStart:k("debug-start",60115),debugStepInto:k("debug-step-into",60116),debugStepOut:k("debug-step-out",60117),debugStepOver:k("debug-step-over",60118),debugStop:k("debug-stop",60119),debug:k("debug",60120),deviceCameraVideo:k("device-camera-video",60121),deviceCamera:k("device-camera",60122),deviceMobile:k("device-mobile",60123),diffAdded:k("diff-added",60124),diffIgnored:k("diff-ignored",60125),diffModified:k("diff-modified",60126),diffRemoved:k("diff-removed",60127),diffRenamed:k("diff-renamed",60128),diff:k("diff",60129),diffSidebyside:k("diff-sidebyside",60129),discard:k("discard",60130),editorLayout:k("editor-layout",60131),emptyWindow:k("empty-window",60132),exclude:k("exclude",60133),extensions:k("extensions",60134),eyeClosed:k("eye-closed",60135),fileBinary:k("file-binary",60136),fileCode:k("file-code",60137),fileMedia:k("file-media",60138),filePdf:k("file-pdf",60139),fileSubmodule:k("file-submodule",60140),fileSymlinkDirectory:k("file-symlink-directory",60141),fileSymlinkFile:k("file-symlink-file",60142),fileZip:k("file-zip",60143),files:k("files",60144),filter:k("filter",60145),flame:k("flame",60146),foldDown:k("fold-down",60147),foldUp:k("fold-up",60148),fold:k("fold",60149),folderActive:k("folder-active",60150),folderOpened:k("folder-opened",60151),gear:k("gear",60152),gift:k("gift",60153),gistSecret:k("gist-secret",60154),gist:k("gist",60155),gitCommit:k("git-commit",60156),gitCompare:k("git-compare",60157),compareChanges:k("compare-changes",60157),gitMerge:k("git-merge",60158),githubAction:k("github-action",60159),githubAlt:k("github-alt",60160),globe:k("globe",60161),grabber:k("grabber",60162),graph:k("graph",60163),gripper:k("gripper",60164),heart:k("heart",60165),home:k("home",60166),horizontalRule:k("horizontal-rule",60167),hubot:k("hubot",60168),inbox:k("inbox",60169),issueReopened:k("issue-reopened",60171),issues:k("issues",60172),italic:k("italic",60173),jersey:k("jersey",60174),json:k("json",60175),kebabVertical:k("kebab-vertical",60176),key:k("key",60177),law:k("law",60178),lightbulbAutofix:k("lightbulb-autofix",60179),linkExternal:k("link-external",60180),link:k("link",60181),listOrdered:k("list-ordered",60182),listUnordered:k("list-unordered",60183),liveShare:k("live-share",60184),loading:k("loading",60185),location:k("location",60186),mailRead:k("mail-read",60187),mail:k("mail",60188),markdown:k("markdown",60189),megaphone:k("megaphone",60190),mention:k("mention",60191),milestone:k("milestone",60192),gitPullRequestMilestone:k("git-pull-request-milestone",60192),mortarBoard:k("mortar-board",60193),move:k("move",60194),multipleWindows:k("multiple-windows",60195),mute:k("mute",60196),noNewline:k("no-newline",60197),note:k("note",60198),octoface:k("octoface",60199),openPreview:k("open-preview",60200),package:k("package",60201),paintcan:k("paintcan",60202),pin:k("pin",60203),play:k("play",60204),run:k("run",60204),plug:k("plug",60205),preserveCase:k("preserve-case",60206),preview:k("preview",60207),project:k("project",60208),pulse:k("pulse",60209),question:k("question",60210),quote:k("quote",60211),radioTower:k("radio-tower",60212),reactions:k("reactions",60213),references:k("references",60214),refresh:k("refresh",60215),regex:k("regex",60216),remoteExplorer:k("remote-explorer",60217),remote:k("remote",60218),remove:k("remove",60219),replaceAll:k("replace-all",60220),replace:k("replace",60221),repoClone:k("repo-clone",60222),repoForcePush:k("repo-force-push",60223),repoPull:k("repo-pull",60224),repoPush:k("repo-push",60225),report:k("report",60226),requestChanges:k("request-changes",60227),rocket:k("rocket",60228),rootFolderOpened:k("root-folder-opened",60229),rootFolder:k("root-folder",60230),rss:k("rss",60231),ruby:k("ruby",60232),saveAll:k("save-all",60233),saveAs:k("save-as",60234),save:k("save",60235),screenFull:k("screen-full",60236),screenNormal:k("screen-normal",60237),searchStop:k("search-stop",60238),server:k("server",60240),settingsGear:k("settings-gear",60241),settings:k("settings",60242),shield:k("shield",60243),smiley:k("smiley",60244),sortPrecedence:k("sort-precedence",60245),splitHorizontal:k("split-horizontal",60246),splitVertical:k("split-vertical",60247),squirrel:k("squirrel",60248),starFull:k("star-full",60249),starHalf:k("star-half",60250),symbolClass:k("symbol-class",60251),symbolColor:k("symbol-color",60252),symbolConstant:k("symbol-constant",60253),symbolEnumMember:k("symbol-enum-member",60254),symbolField:k("symbol-field",60255),symbolFile:k("symbol-file",60256),symbolInterface:k("symbol-interface",60257),symbolKeyword:k("symbol-keyword",60258),symbolMisc:k("symbol-misc",60259),symbolOperator:k("symbol-operator",60260),symbolProperty:k("symbol-property",60261),wrench:k("wrench",60261),wrenchSubaction:k("wrench-subaction",60261),symbolSnippet:k("symbol-snippet",60262),tasklist:k("tasklist",60263),telescope:k("telescope",60264),textSize:k("text-size",60265),threeBars:k("three-bars",60266),thumbsdown:k("thumbsdown",60267),thumbsup:k("thumbsup",60268),tools:k("tools",60269),triangleDown:k("triangle-down",60270),triangleLeft:k("triangle-left",60271),triangleRight:k("triangle-right",60272),triangleUp:k("triangle-up",60273),twitter:k("twitter",60274),unfold:k("unfold",60275),unlock:k("unlock",60276),unmute:k("unmute",60277),unverified:k("unverified",60278),verified:k("verified",60279),versions:k("versions",60280),vmActive:k("vm-active",60281),vmOutline:k("vm-outline",60282),vmRunning:k("vm-running",60283),watch:k("watch",60284),whitespace:k("whitespace",60285),wholeWord:k("whole-word",60286),window:k("window",60287),wordWrap:k("word-wrap",60288),zoomIn:k("zoom-in",60289),zoomOut:k("zoom-out",60290),listFilter:k("list-filter",60291),listFlat:k("list-flat",60292),listSelection:k("list-selection",60293),selection:k("selection",60293),listTree:k("list-tree",60294),debugBreakpointFunctionUnverified:k("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:k("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:k("debug-breakpoint-function-disabled",60296),debugStackframeActive:k("debug-stackframe-active",60297),circleSmallFilled:k("circle-small-filled",60298),debugStackframeDot:k("debug-stackframe-dot",60298),terminalDecorationMark:k("terminal-decoration-mark",60298),debugStackframe:k("debug-stackframe",60299),debugStackframeFocused:k("debug-stackframe-focused",60299),debugBreakpointUnsupported:k("debug-breakpoint-unsupported",60300),symbolString:k("symbol-string",60301),debugReverseContinue:k("debug-reverse-continue",60302),debugStepBack:k("debug-step-back",60303),debugRestartFrame:k("debug-restart-frame",60304),debugAlt:k("debug-alt",60305),callIncoming:k("call-incoming",60306),callOutgoing:k("call-outgoing",60307),menu:k("menu",60308),expandAll:k("expand-all",60309),feedback:k("feedback",60310),gitPullRequestReviewer:k("git-pull-request-reviewer",60310),groupByRefType:k("group-by-ref-type",60311),ungroupByRefType:k("ungroup-by-ref-type",60312),account:k("account",60313),gitPullRequestAssignee:k("git-pull-request-assignee",60313),bellDot:k("bell-dot",60314),debugConsole:k("debug-console",60315),library:k("library",60316),output:k("output",60317),runAll:k("run-all",60318),syncIgnored:k("sync-ignored",60319),pinned:k("pinned",60320),githubInverted:k("github-inverted",60321),serverProcess:k("server-process",60322),serverEnvironment:k("server-environment",60323),pass:k("pass",60324),issueClosed:k("issue-closed",60324),stopCircle:k("stop-circle",60325),playCircle:k("play-circle",60326),record:k("record",60327),debugAltSmall:k("debug-alt-small",60328),vmConnect:k("vm-connect",60329),cloud:k("cloud",60330),merge:k("merge",60331),export:k("export",60332),graphLeft:k("graph-left",60333),magnet:k("magnet",60334),notebook:k("notebook",60335),redo:k("redo",60336),checkAll:k("check-all",60337),pinnedDirty:k("pinned-dirty",60338),passFilled:k("pass-filled",60339),circleLargeFilled:k("circle-large-filled",60340),circleLarge:k("circle-large",60341),circleLargeOutline:k("circle-large-outline",60341),combine:k("combine",60342),gather:k("gather",60342),table:k("table",60343),variableGroup:k("variable-group",60344),typeHierarchy:k("type-hierarchy",60345),typeHierarchySub:k("type-hierarchy-sub",60346),typeHierarchySuper:k("type-hierarchy-super",60347),gitPullRequestCreate:k("git-pull-request-create",60348),runAbove:k("run-above",60349),runBelow:k("run-below",60350),notebookTemplate:k("notebook-template",60351),debugRerun:k("debug-rerun",60352),workspaceTrusted:k("workspace-trusted",60353),workspaceUntrusted:k("workspace-untrusted",60354),workspaceUnknown:k("workspace-unknown",60355),terminalCmd:k("terminal-cmd",60356),terminalDebian:k("terminal-debian",60357),terminalLinux:k("terminal-linux",60358),terminalPowershell:k("terminal-powershell",60359),terminalTmux:k("terminal-tmux",60360),terminalUbuntu:k("terminal-ubuntu",60361),terminalBash:k("terminal-bash",60362),arrowSwap:k("arrow-swap",60363),copy:k("copy",60364),personAdd:k("person-add",60365),filterFilled:k("filter-filled",60366),wand:k("wand",60367),debugLineByLine:k("debug-line-by-line",60368),inspect:k("inspect",60369),layers:k("layers",60370),layersDot:k("layers-dot",60371),layersActive:k("layers-active",60372),compass:k("compass",60373),compassDot:k("compass-dot",60374),compassActive:k("compass-active",60375),azure:k("azure",60376),issueDraft:k("issue-draft",60377),gitPullRequestClosed:k("git-pull-request-closed",60378),gitPullRequestDraft:k("git-pull-request-draft",60379),debugAll:k("debug-all",60380),debugCoverage:k("debug-coverage",60381),runErrors:k("run-errors",60382),folderLibrary:k("folder-library",60383),debugContinueSmall:k("debug-continue-small",60384),beakerStop:k("beaker-stop",60385),graphLine:k("graph-line",60386),graphScatter:k("graph-scatter",60387),pieChart:k("pie-chart",60388),bracket:k("bracket",60175),bracketDot:k("bracket-dot",60389),bracketError:k("bracket-error",60390),lockSmall:k("lock-small",60391),azureDevops:k("azure-devops",60392),verifiedFilled:k("verified-filled",60393),newline:k("newline",60394),layout:k("layout",60395),layoutActivitybarLeft:k("layout-activitybar-left",60396),layoutActivitybarRight:k("layout-activitybar-right",60397),layoutPanelLeft:k("layout-panel-left",60398),layoutPanelCenter:k("layout-panel-center",60399),layoutPanelJustify:k("layout-panel-justify",60400),layoutPanelRight:k("layout-panel-right",60401),layoutPanel:k("layout-panel",60402),layoutSidebarLeft:k("layout-sidebar-left",60403),layoutSidebarRight:k("layout-sidebar-right",60404),layoutStatusbar:k("layout-statusbar",60405),layoutMenubar:k("layout-menubar",60406),layoutCentered:k("layout-centered",60407),target:k("target",60408),indent:k("indent",60409),recordSmall:k("record-small",60410),errorSmall:k("error-small",60411),terminalDecorationError:k("terminal-decoration-error",60411),arrowCircleDown:k("arrow-circle-down",60412),arrowCircleLeft:k("arrow-circle-left",60413),arrowCircleRight:k("arrow-circle-right",60414),arrowCircleUp:k("arrow-circle-up",60415),layoutSidebarRightOff:k("layout-sidebar-right-off",60416),layoutPanelOff:k("layout-panel-off",60417),layoutSidebarLeftOff:k("layout-sidebar-left-off",60418),blank:k("blank",60419),heartFilled:k("heart-filled",60420),map:k("map",60421),mapHorizontal:k("map-horizontal",60421),foldHorizontal:k("fold-horizontal",60421),mapFilled:k("map-filled",60422),mapHorizontalFilled:k("map-horizontal-filled",60422),foldHorizontalFilled:k("fold-horizontal-filled",60422),circleSmall:k("circle-small",60423),bellSlash:k("bell-slash",60424),bellSlashDot:k("bell-slash-dot",60425),commentUnresolved:k("comment-unresolved",60426),gitPullRequestGoToChanges:k("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:k("git-pull-request-new-changes",60428),searchFuzzy:k("search-fuzzy",60429),commentDraft:k("comment-draft",60430),send:k("send",60431),sparkle:k("sparkle",60432),insert:k("insert",60433),mic:k("mic",60434),thumbsdownFilled:k("thumbsdown-filled",60435),thumbsupFilled:k("thumbsup-filled",60436),coffee:k("coffee",60437),snake:k("snake",60438),game:k("game",60439),vr:k("vr",60440),chip:k("chip",60441),piano:k("piano",60442),music:k("music",60443),micFilled:k("mic-filled",60444),repoFetch:k("repo-fetch",60445),copilot:k("copilot",60446),lightbulbSparkle:k("lightbulb-sparkle",60447),robot:k("robot",60448),sparkleFilled:k("sparkle-filled",60449),diffSingle:k("diff-single",60450),diffMultiple:k("diff-multiple",60451),surroundWith:k("surround-with",60452),share:k("share",60453),gitStash:k("git-stash",60454),gitStashApply:k("git-stash-apply",60455),gitStashPop:k("git-stash-pop",60456),vscode:k("vscode",60457),vscodeInsiders:k("vscode-insiders",60458),codeOss:k("code-oss",60459),runCoverage:k("run-coverage",60460),runAllCoverage:k("run-all-coverage",60461),coverage:k("coverage",60462),githubProject:k("github-project",60463),mapVertical:k("map-vertical",60464),foldVertical:k("fold-vertical",60464),mapVerticalFilled:k("map-vertical-filled",60465),foldVerticalFilled:k("fold-vertical-filled",60465),goToSearch:k("go-to-search",60466),percentage:k("percentage",60467),sortPercentage:k("sort-percentage",60467),attach:k("attach",60468),goToEditingSession:k("go-to-editing-session",60469),editSession:k("edit-session",60470),codeReview:k("code-review",60471),copilotWarning:k("copilot-warning",60472),python:k("python",60473),copilotLarge:k("copilot-large",60474),copilotWarningLarge:k("copilot-warning-large",60475),keyboardTab:k("keyboard-tab",60476),copilotBlocked:k("copilot-blocked",60477),copilotNotConnected:k("copilot-not-connected",60478),flag:k("flag",60479),lightbulbEmpty:k("lightbulb-empty",60480),symbolMethodArrow:k("symbol-method-arrow",60481),copilotUnavailable:k("copilot-unavailable",60482),repoPinned:k("repo-pinned",60483),keyboardTabAbove:k("keyboard-tab-above",60484),keyboardTabBelow:k("keyboard-tab-below",60485),gitPullRequestDone:k("git-pull-request-done",60486),mcp:k("mcp",60487),extensionsLarge:k("extensions-large",60488),layoutPanelDock:k("layout-panel-dock",60489),layoutSidebarLeftDock:k("layout-sidebar-left-dock",60490),layoutSidebarRightDock:k("layout-sidebar-right-dock",60491),copilotInProgress:k("copilot-in-progress",60492),copilotError:k("copilot-error",60493),copilotSuccess:k("copilot-success",60494),chatSparkle:k("chat-sparkle",60495),searchSparkle:k("search-sparkle",60496),editSparkle:k("edit-sparkle",60497),copilotSnooze:k("copilot-snooze",60498),sendToRemoteAgent:k("send-to-remote-agent",60499),commentDiscussionSparkle:k("comment-discussion-sparkle",60500),chatSparkleWarning:k("chat-sparkle-warning",60501),chatSparkleError:k("chat-sparkle-error",60502),collection:k("collection",60503),newCollection:k("new-collection",60504),thinking:k("thinking",60505),build:k("build",60506),commentDiscussionQuote:k("comment-discussion-quote",60507),cursor:k("cursor",60508),eraser:k("eraser",60509),fileText:k("file-text",60510),gitLens:k("git-lens",60511),quotes:k("quotes",60512),rename:k("rename",60513),runWithDeps:k("run-with-deps",60514),debugConnected:k("debug-connected",60515),strikethrough:k("strikethrough",60516),openInProduct:k("open-in-product",60517),indexZero:k("index-zero",60518),agent:k("agent",60519),editCode:k("edit-code",60520),repoSelected:k("repo-selected",60521),skip:k("skip",60522),mergeInto:k("merge-into",60523),gitBranchChanges:k("git-branch-changes",60524),gitBranchStagedChanges:k("git-branch-staged-changes",60525),gitBranchConflicts:k("git-branch-conflicts",60526),gitBranch:k("git-branch",60527),gitBranchCreate:k("git-branch-create",60527),gitBranchDelete:k("git-branch-delete",60527),searchLarge:k("search-large",60528),terminalGitBash:k("terminal-git-bash",60529)},JTe={dialogError:k("dialog-error","error"),dialogWarning:k("dialog-warning","warning"),dialogInfo:k("dialog-info","info"),dialogClose:k("dialog-close","close"),treeItemExpanded:k("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:k("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:k("tree-filter-on-type-off","list-selection"),treeFilterClear:k("tree-filter-clear","close"),treeItemLoading:k("tree-item-loading","loading"),menuSelection:k("menu-selection","check"),menuSubmenu:k("menu-submenu","chevron-right"),menuBarMore:k("menubar-more","more"),scrollbarButtonLeft:k("scrollbar-button-left","triangle-left"),scrollbarButtonRight:k("scrollbar-button-right","triangle-right"),scrollbarButtonUp:k("scrollbar-button-up","triangle-up"),scrollbarButtonDown:k("scrollbar-button-down","triangle-down"),toolBarMore:k("toolbar-more","more"),quickInputBack:k("quick-input-back","arrow-left"),dropDownButton:k("drop-down-button",60084),symbolCustomColor:k("symbol-customcolor",60252),exportIcon:k("export",60332),workspaceUnspecified:k("workspace-unspecified",60355),newLine:k("newline",60394),thumbsDownFilled:k("thumbsdown-filled",60435),thumbsUpFilled:k("thumbsup-filled",60436),gitFetch:k("git-fetch",60445),lightbulbSparkleAutofix:k("lightbulb-sparkle-autofix",60447),debugBreakpointPending:k("debug-breakpoint-pending",60377)},ge={...QTe,...JTe};var K9;(function(s){function e(t){return!!t&&typeof t=="object"&&typeof t.id=="string"}s.isThemeColor=e})(K9||(K9={}));var it;(function(s){s.iconNameSegment="[A-Za-z0-9]+",s.iconNameExpression="[A-Za-z0-9-]+",s.iconModifierExpression="~[A-Za-z]+",s.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${s.iconNameExpression})(${s.iconModifierExpression})?$`);function t(g){const m=e.exec(g.id);if(!m)return t(ge.error);const[,p,v]=m,b=["codicon","codicon-"+p];return v&&b.push("codicon-modifier-"+v.substring(1)),b}s.asClassNameArray=t;function i(g){return t(g).join(" ")}s.asClassName=i;function n(g){return"."+t(g).join(".")}s.asCSSSelector=n;function o(g){return!!g&&typeof g=="object"&&typeof g.id=="string"&&(typeof g.color>"u"||K9.isThemeColor(g.color))}s.isThemeIcon=o;const r=new RegExp(`^\\$\\((${s.iconNameExpression}(?:${s.iconModifierExpression})?)\\)$`);function a(g){const m=r.exec(g);if(!m)return;const[,p]=m;return{id:p}}s.fromString=a;function l(g){return{id:g}}s.fromId=l;function c(g,m){let p=g.id;const v=p.lastIndexOf("~");return v!==-1&&(p=p.substring(0,v)),m&&(p=`${p}~${m}`),{id:p}}s.modify=c;function d(g){const m=g.id.lastIndexOf("~");if(m!==-1)return g.id.substring(m+1)}s.getModifier=d;function h(g,m){var p,v;return g.id===m.id&&((p=g.color)==null?void 0:p.id)===((v=m.color)==null?void 0:v.id)}s.isEqual=h;function u(g){return(g==null?void 0:g.id)===ge.file.id}s.isFile=u;function f(g){return(g==null?void 0:g.id)===ge.folder.id}s.isFolder=f})(it||(it={}));const en=Mt("commandService"),Zt=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new q,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(s,e){if(!s)throw new Error("invalid command");if(typeof s=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:s,handler:e})}if(s.metadata&&Array.isArray(s.metadata.args)){const r=[];for(const l of s.metadata.args)r.push(l.constraint);const a=s.handler;s.handler=function(l,...c){return vke(c,r),a(l,...c)}}const{id:t}=s;let i=this._commands.get(t);i||(i=new Zo,this._commands.set(t,i));const n=i.unshift(s),o=Ve(()=>{n();const r=this._commands.get(t);r!=null&&r.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),o}registerCommandAlias(s,e){return Zt.registerCommand(s,(t,...i)=>t.get(en).executeCommand(e,...i))}getCommand(s){const e=this._commands.get(s);if(!(!e||e.isEmpty()))return Gt.first(e)}getCommands(){const s=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&s.set(e,t)}return s}};Zt.registerCommand("noop",()=>{});function P5(...s){switch(s.length){case 1:return _(1693,"Did you mean {0}?",s[0]);case 2:return _(1694,"Did you mean {0} or {1}?",s[0],s[1]);case 3:return _(1695,"Did you mean {0}, {1} or {2}?",s[0],s[1],s[2]);default:return}}const eNe=_(1696,"Did you forget to open or close the quote?"),tNe=_(1697,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");var Uu;let M0=(Uu=class{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw WN(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(P5("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(P5("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(P5("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=Uu._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(eNe);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(tNe);return}const o=this._input.charCodeAt(e);if(t)t=!1;else if(o===47&&!i){e++;break}else o===91?i=!0:o===92?t=!0:o===93&&(i=!1);e++}for(;e<this._input.length&&Uu._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}},Uu._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),Uu._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]),Uu);const Po=new Map;Po.set("false",!1);Po.set("true",!0);Po.set("isMac",Bt);Po.set("isLinux",Hr);Po.set("isWindows",no);Po.set("isWeb",Ah);Po.set("isMacNative",Bt&&!Ah);Po.set("isEdge",Ese);Po.set("isFirefox",kke);Po.set("isChrome",uU);Po.set("isSafari",Dke);const iNe=Object.prototype.hasOwnProperty,nNe={regexParsingWithErrorRecovery:!0},sNe=_(1675,"Empty context key expression"),oNe=_(1676,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),rNe=_(1677,"'in' after 'not'."),dY=_(1678,"closing parenthesis ')'"),aNe=_(1679,"Unexpected token"),lNe=_(1680,"Did you forget to put && or || before the token?"),cNe=_(1681,"Unexpected end of expression"),dNe=_(1682,"Did you forget to put a context key?");var sh;let hNe=(sh=class{constructor(e=nNe){this._config=e,this._scanner=new M0,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:sNe,offset:0,lexeme:"",additionalInfo:oNe});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?lNe:void 0;throw this._parsingErrors.push({message:aNe,offset:i.offset,lexeme:M0.getLexeme(i),additionalInfo:n}),sh._parseError}return t}catch(t){if(t!==sh._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:de.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:de.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),vr.INSTANCE;case 12:return this._advance(),zr.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,dY),t==null?void 0:t.negate()}case 17:return this._advance(),pv.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),de.true();case 12:return this._advance(),de.false();case 0:{this._advance();const t=this._expr();return this._consume(1,dY),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const o=n.lexeme,r=o.lastIndexOf("/"),a=r===o.length-1?void 0:this._removeFlagsGY(o.substring(r+1));let l;try{l=new RegExp(o.substring(1,r),a)}catch{throw this._errExpectedButGot("REGEX",n)}return xL.create(t,l)}switch(n.type){case 10:case 19:{const o=[n.lexeme];this._advance();let r=this._peek(),a=0;for(let u=0;u<n.lexeme.length;u++)n.lexeme.charCodeAt(u)===40?a++:n.lexeme.charCodeAt(u)===41&&a--;for(;!this._isAtEnd()&&r.type!==15&&r.type!==16;){switch(r.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let u=0;u<r.lexeme.length;u++)r.lexeme.charCodeAt(u)===40?a++:n.lexeme.charCodeAt(u)===41&&a--}if(a<0)break;o.push(M0.getLexeme(r)),this._advance(),r=this._peek()}const l=o.join(""),c=l.lastIndexOf("/"),d=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let h;try{h=new RegExp(l.substring(1,c),d)}catch{throw this._errExpectedButGot("REGEX",n)}return de.regex(t,h)}case 18:{const o=n.lexeme;this._advance();let r=null;if(!Ose(o)){const a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){const c=o.slice(a+1,l),d=o[l+1]==="i"?"i":"";try{r=new RegExp(c,d)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(r===null)throw this._errExpectedButGot("REGEX",n);return xL.create(t,r)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,rNe);const n=this._value();return de.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return de.equals(t,n);switch(n){case"true":return de.has(t);case"false":return de.not(t);default:return de.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return de.notEquals(t,n);switch(n){case"true":return de.not(t);case"false":return de.has(t);default:return de.notEquals(t,n)}}case 5:return this._advance(),kO.create(t,this._value());case 6:return this._advance(),DO.create(t,this._value());case 7:return this._advance(),IO.create(t,this._value());case 8:return this._advance(),EO.create(t,this._value());case 13:return this._advance(),de.in(t,this._value());default:return de.has(t)}}case 20:throw this._parsingErrors.push({message:cNe,offset:e.offset,lexeme:"",additionalInfo:dNe}),sh._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=_(1683,`Expected: {0}
Received: '{1}'.`,e,M0.getLexeme(t)),o=t.offset,r=M0.getLexeme(t);return this._parsingErrors.push({message:n,offset:o,lexeme:r,additionalInfo:i}),sh._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},sh._parseError=new Error,sh);const mK=class mK{static false(){return vr.INSTANCE}static true(){return zr.INSTANCE}static has(e){return mv.create(e)}static equals(e,t){return i0.create(e,t)}static notEquals(e,t){return xO.create(e,t)}static regex(e,t){return xL.create(e,t)}static in(e,t){return yO.create(e,t)}static notIn(e,t){return SO.create(e,t)}static not(e){return pv.create(e)}static and(...e){return qp.create(e,null,!0)}static or(...e){return xu.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};mK._parser=new hNe({regexParsingWithErrorRecovery:!1});let de=mK;function uNe(s,e){const t=s?s.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function US(s,e){return s.cmp(e)}const dA=class dA{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return zr.INSTANCE}};dA.INSTANCE=new dA;let vr=dA;const hA=class hA{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return vr.INSTANCE}};hA.INSTANCE=new hA;let zr=hA;class mv{static create(e,t=null){const i=Po.get(e);return typeof i=="boolean"?i?zr.INSTANCE:vr.INSTANCE:new mv(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:Ioe(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Po.get(this.key);return typeof e=="boolean"?e?zr.INSTANCE:vr.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=pv.create(this.key,this)),this.negated}}class i0{static create(e,t,i=null){if(typeof t=="boolean")return t?mv.create(e,i):pv.create(e,i);const n=Po.get(e);return typeof n=="boolean"?t===(n?"true":"false")?zr.INSTANCE:vr.INSTANCE:new i0(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Po.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?zr.INSTANCE:vr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=xO.create(this.key,this.value,this)),this.negated}}class yO{static create(e,t){return new yO(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?iNe.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=SO.create(this.key,this.valueKey)),this.negated}}class SO{static create(e,t){return new SO(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=yO.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class xO{static create(e,t,i=null){if(typeof t=="boolean")return t?pv.create(e,i):mv.create(e,i);const n=Po.get(e);return typeof n=="boolean"?t===(n?"true":"false")?vr.INSTANCE:zr.INSTANCE:new xO(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Po.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?vr.INSTANCE:zr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=i0.create(this.key,this.value,this)),this.negated}}class pv{static create(e,t=null){const i=Po.get(e);return typeof i=="boolean"?i?vr.INSTANCE:zr.INSTANCE:new pv(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:Ioe(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Po.get(this.key);return typeof e=="boolean"?e?vr.INSTANCE:zr.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=mv.create(this.key,this)),this.negated}}function LO(s,e){if(typeof s=="string"){const t=parseFloat(s);isNaN(t)||(s=t)}return typeof s=="string"||typeof s=="number"?e(s):vr.INSTANCE}class IO{static create(e,t,i=null){return LO(t,n=>new IO(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=DO.create(this.key,this.value,this)),this.negated}}class EO{static create(e,t,i=null){return LO(t,n=>new EO(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=kO.create(this.key,this.value,this)),this.negated}}class kO{static create(e,t,i=null){return LO(t,n=>new kO(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=EO.create(this.key,this.value,this)),this.negated}}class DO{static create(e,t,i=null){return LO(t,n=>new DO(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:_v(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=IO.create(this.key,this.value,this)),this.negated}}class xL{static create(e,t){return new xL(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=HU.create(this)),this.negated}}class HU{static create(e){return new HU(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function Loe(s){let e=null;for(let t=0,i=s.length;t<i;t++){const n=s[t].substituteConstants();if(s[t]!==n&&e===null){e=[];for(let o=0;o<t;o++)e[o]=s[o]}e!==null&&(e[t]=n)}return e===null?s:e}class qp{static create(e,t,i){return qp._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=US(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=Loe(this.expr);return e===this.expr?this:qp.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let o=!1;for(const r of e)if(r){if(r.type===1){o=!0;continue}if(r.type===0)return vr.INSTANCE;if(r.type===6){n.push(...r.expr);continue}n.push(r)}if(n.length===0&&o)return zr.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(US);for(let r=1;r<n.length;r++)n[r-1].equals(n[r])&&(n.splice(r,1),r--);if(n.length===1)return n[0];for(;n.length>1;){const r=n[n.length-1];if(r.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=xu.create(r.expr.map(d=>qp.create([d,a],null,i)),null,l);c&&(n.push(c),n.sort(US))}if(n.length===1)return n[0];if(i){for(let r=0;r<n.length;r++)for(let a=r+1;a<n.length;a++)if(n[r].negate().equals(n[a]))return vr.INSTANCE;if(n.length===1)return n[0]}return new qp(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=xu.create(e,this,!0)}return this.negated}}class xu{static create(e,t,i){return xu._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=US(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=Loe(this.expr);return e===this.expr?this:xu.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],o=!1;if(e){for(let r=0,a=e.length;r<a;r++){const l=e[r];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return zr.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&o)return vr.INSTANCE;n.sort(US)}if(n.length!==0){if(n.length===1)return n[0];for(let r=1;r<n.length;r++)n[r-1].equals(n[r])&&(n.splice(r,1),r--);if(n.length===1)return n[0];if(i){for(let r=0;r<n.length;r++)for(let a=r+1;a<n.length;a++)if(n[r].negate().equals(n[a]))return zr.INSTANCE;if(n.length===1)return n[0]}return new xu(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const o of uY(t))for(const r of uY(i))n.push(qp.create([o,r],null,!1));e.unshift(xu.create(n,null,!1))}this.negated=xu.create(e,this,!0)}return this.negated}}const XC=class XC extends mv{static all(){return XC._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?XC._info.push({...i,key:e}):i!==!0&&XC._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return i0.create(this.key,e)}};XC._info=[];let Ne=XC;const ut=Mt("contextKeyService");function Ioe(s,e){return s<e?-1:s>e?1:0}function _v(s,e,t,i){return s<t?-1:s>t?1:e<i?-1:e>i?1:0}function G9(s,e){if(s.type===0||e.type===1)return!0;if(s.type===9)return e.type===9?hY(s.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(G9(s,t))return!0;return!1}if(s.type===6){if(e.type===6)return hY(e.expr,s.expr);for(const t of s.expr)if(G9(t,e))return!0;return!1}return s.equals(e)}function hY(s,e){let t=0,i=0;for(;t<s.length&&i<e.length;){const n=s[t].cmp(e[i]);if(n<0)return!1;n===0&&t++,i++}return t===s.length}function uY(s){return s.type===9?s.expr:[s]}class fNe{constructor(){this.data=new Map}add(e,t){y5(As(e)),y5(ws(t)),y5(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{kb(e.dispose)&&e.dispose()}),this.data.clear()}}const kn=new fNe;class VU{constructor(){this._coreKeybindings=new Zo,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(sa===1){if(e&&e.win)return e.win}else if(sa===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=VU.bindToCurrentPlatform(e),i=new oe;if(t&&t.primary){const n=S9(t.primary,sa);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,o=t.secondary.length;n<o;n++){const r=t.secondary[n],a=S9(r,sa);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}registerCommandAndKeybindingRule(e){return dc(this.registerKeybindingRule(e),Zt.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,o,r){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:r,weight1:n,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Ve(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(mNe)),this._cachedMergedKeybindings.slice(0)}}const Ks=new VU,gNe={EditorModes:"platform.keybindingsRegistry"};kn.add(gNe.EditorModes,Ks);function mNe(s,e){if(s.weight1!==e.weight1)return s.weight1-e.weight1;if(s.command&&e.command){if(s.command<e.command)return-1;if(s.command>e.command)return 1}return s.weight2-e.weight2}var pNe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},fY=function(s,e){return function(t,i){e(t,i,s)}},VT;function f1(s){return s.command!==void 0}function _Ne(s){return s.submenu!==void 0}const O=class O{constructor(e){if(O._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);O._instances.set(e,this),this.id=e}};O._instances=new Map,O.CommandPalette=new O("CommandPalette"),O.DebugBreakpointsContext=new O("DebugBreakpointsContext"),O.DebugCallStackContext=new O("DebugCallStackContext"),O.DebugConsoleContext=new O("DebugConsoleContext"),O.DebugVariablesContext=new O("DebugVariablesContext"),O.NotebookVariablesContext=new O("NotebookVariablesContext"),O.DebugHoverContext=new O("DebugHoverContext"),O.DebugWatchContext=new O("DebugWatchContext"),O.DebugToolBar=new O("DebugToolBar"),O.DebugToolBarStop=new O("DebugToolBarStop"),O.DebugDisassemblyContext=new O("DebugDisassemblyContext"),O.DebugCallStackToolbar=new O("DebugCallStackToolbar"),O.DebugCreateConfiguration=new O("DebugCreateConfiguration"),O.EditorContext=new O("EditorContext"),O.SimpleEditorContext=new O("SimpleEditorContext"),O.EditorContent=new O("EditorContent"),O.EditorLineNumberContext=new O("EditorLineNumberContext"),O.EditorContextCopy=new O("EditorContextCopy"),O.EditorContextPeek=new O("EditorContextPeek"),O.EditorContextShare=new O("EditorContextShare"),O.EditorTitle=new O("EditorTitle"),O.CompactWindowEditorTitle=new O("CompactWindowEditorTitle"),O.EditorTitleRun=new O("EditorTitleRun"),O.EditorTitleContext=new O("EditorTitleContext"),O.EditorTitleContextShare=new O("EditorTitleContextShare"),O.EmptyEditorGroup=new O("EmptyEditorGroup"),O.EmptyEditorGroupContext=new O("EmptyEditorGroupContext"),O.EditorTabsBarContext=new O("EditorTabsBarContext"),O.EditorTabsBarShowTabsSubmenu=new O("EditorTabsBarShowTabsSubmenu"),O.EditorTabsBarShowTabsZenModeSubmenu=new O("EditorTabsBarShowTabsZenModeSubmenu"),O.EditorActionsPositionSubmenu=new O("EditorActionsPositionSubmenu"),O.EditorSplitMoveSubmenu=new O("EditorSplitMoveSubmenu"),O.ExplorerContext=new O("ExplorerContext"),O.ExplorerContextShare=new O("ExplorerContextShare"),O.ExtensionContext=new O("ExtensionContext"),O.ExtensionEditorContextMenu=new O("ExtensionEditorContextMenu"),O.GlobalActivity=new O("GlobalActivity"),O.CommandCenter=new O("CommandCenter"),O.CommandCenterCenter=new O("CommandCenterCenter"),O.LayoutControlMenuSubmenu=new O("LayoutControlMenuSubmenu"),O.LayoutControlMenu=new O("LayoutControlMenu"),O.MenubarMainMenu=new O("MenubarMainMenu"),O.MenubarAppearanceMenu=new O("MenubarAppearanceMenu"),O.MenubarDebugMenu=new O("MenubarDebugMenu"),O.MenubarEditMenu=new O("MenubarEditMenu"),O.MenubarCopy=new O("MenubarCopy"),O.MenubarFileMenu=new O("MenubarFileMenu"),O.MenubarGoMenu=new O("MenubarGoMenu"),O.MenubarHelpMenu=new O("MenubarHelpMenu"),O.MenubarLayoutMenu=new O("MenubarLayoutMenu"),O.MenubarNewBreakpointMenu=new O("MenubarNewBreakpointMenu"),O.PanelAlignmentMenu=new O("PanelAlignmentMenu"),O.PanelPositionMenu=new O("PanelPositionMenu"),O.ActivityBarPositionMenu=new O("ActivityBarPositionMenu"),O.MenubarPreferencesMenu=new O("MenubarPreferencesMenu"),O.MenubarRecentMenu=new O("MenubarRecentMenu"),O.MenubarSelectionMenu=new O("MenubarSelectionMenu"),O.MenubarShare=new O("MenubarShare"),O.MenubarSwitchEditorMenu=new O("MenubarSwitchEditorMenu"),O.MenubarSwitchGroupMenu=new O("MenubarSwitchGroupMenu"),O.MenubarTerminalMenu=new O("MenubarTerminalMenu"),O.MenubarTerminalSuggestStatusMenu=new O("MenubarTerminalSuggestStatusMenu"),O.MenubarViewMenu=new O("MenubarViewMenu"),O.MenubarHomeMenu=new O("MenubarHomeMenu"),O.OpenEditorsContext=new O("OpenEditorsContext"),O.OpenEditorsContextShare=new O("OpenEditorsContextShare"),O.ProblemsPanelContext=new O("ProblemsPanelContext"),O.SCMInputBox=new O("SCMInputBox"),O.SCMChangeContext=new O("SCMChangeContext"),O.SCMResourceContext=new O("SCMResourceContext"),O.SCMResourceContextShare=new O("SCMResourceContextShare"),O.SCMResourceFolderContext=new O("SCMResourceFolderContext"),O.SCMResourceGroupContext=new O("SCMResourceGroupContext"),O.SCMSourceControl=new O("SCMSourceControl"),O.SCMSourceControlInline=new O("SCMSourceControlInline"),O.SCMSourceControlTitle=new O("SCMSourceControlTitle"),O.SCMHistoryTitle=new O("SCMHistoryTitle"),O.SCMHistoryItemContext=new O("SCMHistoryItemContext"),O.SCMHistoryItemChangeContext=new O("SCMHistoryItemChangeContext"),O.SCMHistoryItemRefContext=new O("SCMHistoryItemRefContext"),O.SCMArtifactGroupContext=new O("SCMArtifactGroupContext"),O.SCMArtifactContext=new O("SCMArtifactContext"),O.SCMQuickDiffDecorations=new O("SCMQuickDiffDecorations"),O.SCMTitle=new O("SCMTitle"),O.SearchContext=new O("SearchContext"),O.SearchActionMenu=new O("SearchActionContext"),O.StatusBarWindowIndicatorMenu=new O("StatusBarWindowIndicatorMenu"),O.StatusBarRemoteIndicatorMenu=new O("StatusBarRemoteIndicatorMenu"),O.StickyScrollContext=new O("StickyScrollContext"),O.TestItem=new O("TestItem"),O.TestItemGutter=new O("TestItemGutter"),O.TestProfilesContext=new O("TestProfilesContext"),O.TestMessageContext=new O("TestMessageContext"),O.TestMessageContent=new O("TestMessageContent"),O.TestPeekElement=new O("TestPeekElement"),O.TestPeekTitle=new O("TestPeekTitle"),O.TestCallStack=new O("TestCallStack"),O.TestCoverageFilterItem=new O("TestCoverageFilterItem"),O.TouchBarContext=new O("TouchBarContext"),O.TitleBar=new O("TitleBar"),O.TitleBarContext=new O("TitleBarContext"),O.TitleBarTitleContext=new O("TitleBarTitleContext"),O.TunnelContext=new O("TunnelContext"),O.TunnelPrivacy=new O("TunnelPrivacy"),O.TunnelProtocol=new O("TunnelProtocol"),O.TunnelPortInline=new O("TunnelInline"),O.TunnelTitle=new O("TunnelTitle"),O.TunnelLocalAddressInline=new O("TunnelLocalAddressInline"),O.TunnelOriginInline=new O("TunnelOriginInline"),O.ViewItemContext=new O("ViewItemContext"),O.ViewContainerTitle=new O("ViewContainerTitle"),O.ViewContainerTitleContext=new O("ViewContainerTitleContext"),O.ViewTitle=new O("ViewTitle"),O.ViewTitleContext=new O("ViewTitleContext"),O.CommentEditorActions=new O("CommentEditorActions"),O.CommentThreadTitle=new O("CommentThreadTitle"),O.CommentThreadActions=new O("CommentThreadActions"),O.CommentThreadAdditionalActions=new O("CommentThreadAdditionalActions"),O.CommentThreadTitleContext=new O("CommentThreadTitleContext"),O.CommentThreadCommentContext=new O("CommentThreadCommentContext"),O.CommentTitle=new O("CommentTitle"),O.CommentActions=new O("CommentActions"),O.CommentsViewThreadActions=new O("CommentsViewThreadActions"),O.InteractiveToolbar=new O("InteractiveToolbar"),O.InteractiveCellTitle=new O("InteractiveCellTitle"),O.InteractiveCellDelete=new O("InteractiveCellDelete"),O.InteractiveCellExecute=new O("InteractiveCellExecute"),O.InteractiveInputExecute=new O("InteractiveInputExecute"),O.InteractiveInputConfig=new O("InteractiveInputConfig"),O.ReplInputExecute=new O("ReplInputExecute"),O.IssueReporter=new O("IssueReporter"),O.NotebookToolbar=new O("NotebookToolbar"),O.NotebookToolbarContext=new O("NotebookToolbarContext"),O.NotebookStickyScrollContext=new O("NotebookStickyScrollContext"),O.NotebookCellTitle=new O("NotebookCellTitle"),O.NotebookCellDelete=new O("NotebookCellDelete"),O.NotebookCellInsert=new O("NotebookCellInsert"),O.NotebookCellBetween=new O("NotebookCellBetween"),O.NotebookCellListTop=new O("NotebookCellTop"),O.NotebookCellExecute=new O("NotebookCellExecute"),O.NotebookCellExecuteGoTo=new O("NotebookCellExecuteGoTo"),O.NotebookCellExecutePrimary=new O("NotebookCellExecutePrimary"),O.NotebookDiffCellInputTitle=new O("NotebookDiffCellInputTitle"),O.NotebookDiffDocumentMetadata=new O("NotebookDiffDocumentMetadata"),O.NotebookDiffCellMetadataTitle=new O("NotebookDiffCellMetadataTitle"),O.NotebookDiffCellOutputsTitle=new O("NotebookDiffCellOutputsTitle"),O.NotebookOutputToolbar=new O("NotebookOutputToolbar"),O.NotebookOutlineFilter=new O("NotebookOutlineFilter"),O.NotebookOutlineActionMenu=new O("NotebookOutlineActionMenu"),O.NotebookEditorLayoutConfigure=new O("NotebookEditorLayoutConfigure"),O.NotebookKernelSource=new O("NotebookKernelSource"),O.BulkEditTitle=new O("BulkEditTitle"),O.BulkEditContext=new O("BulkEditContext"),O.TimelineItemContext=new O("TimelineItemContext"),O.TimelineTitle=new O("TimelineTitle"),O.TimelineTitleContext=new O("TimelineTitleContext"),O.TimelineFilterSubMenu=new O("TimelineFilterSubMenu"),O.AccountsContext=new O("AccountsContext"),O.SidebarTitle=new O("SidebarTitle"),O.PanelTitle=new O("PanelTitle"),O.AuxiliaryBarTitle=new O("AuxiliaryBarTitle"),O.TerminalInstanceContext=new O("TerminalInstanceContext"),O.TerminalEditorInstanceContext=new O("TerminalEditorInstanceContext"),O.TerminalNewDropdownContext=new O("TerminalNewDropdownContext"),O.TerminalTabContext=new O("TerminalTabContext"),O.TerminalTabEmptyAreaContext=new O("TerminalTabEmptyAreaContext"),O.TerminalStickyScrollContext=new O("TerminalStickyScrollContext"),O.WebviewContext=new O("WebviewContext"),O.InlineCompletionsActions=new O("InlineCompletionsActions"),O.InlineEditsActions=new O("InlineEditsActions"),O.NewFile=new O("NewFile"),O.MergeInput1Toolbar=new O("MergeToolbar1Toolbar"),O.MergeInput2Toolbar=new O("MergeToolbar2Toolbar"),O.MergeBaseToolbar=new O("MergeBaseToolbar"),O.MergeInputResultToolbar=new O("MergeToolbarResultToolbar"),O.InlineSuggestionToolbar=new O("InlineSuggestionToolbar"),O.InlineEditToolbar=new O("InlineEditToolbar"),O.ChatContext=new O("ChatContext"),O.ChatCodeBlock=new O("ChatCodeblock"),O.ChatCompareBlock=new O("ChatCompareBlock"),O.ChatMessageTitle=new O("ChatMessageTitle"),O.ChatHistory=new O("ChatHistory"),O.ChatWelcomeContext=new O("ChatWelcomeContext"),O.ChatMessageFooter=new O("ChatMessageFooter"),O.ChatExecute=new O("ChatExecute"),O.ChatInput=new O("ChatInput"),O.ChatInputSide=new O("ChatInputSide"),O.ChatModePicker=new O("ChatModePicker"),O.ChatEditingWidgetToolbar=new O("ChatEditingWidgetToolbar"),O.ChatEditingEditorContent=new O("ChatEditingEditorContent"),O.ChatEditingEditorHunk=new O("ChatEditingEditorHunk"),O.ChatEditingDeletedNotebookCell=new O("ChatEditingDeletedNotebookCell"),O.ChatInputAttachmentToolbar=new O("ChatInputAttachmentToolbar"),O.ChatEditingWidgetModifiedFilesToolbar=new O("ChatEditingWidgetModifiedFilesToolbar"),O.ChatInputResourceAttachmentContext=new O("ChatInputResourceAttachmentContext"),O.ChatInputSymbolAttachmentContext=new O("ChatInputSymbolAttachmentContext"),O.ChatInlineResourceAnchorContext=new O("ChatInlineResourceAnchorContext"),O.ChatInlineSymbolAnchorContext=new O("ChatInlineSymbolAnchorContext"),O.ChatMessageCheckpoint=new O("ChatMessageCheckpoint"),O.ChatMessageRestoreCheckpoint=new O("ChatMessageRestoreCheckpoint"),O.ChatNewMenu=new O("ChatNewMenu"),O.ChatEditingCodeBlockContext=new O("ChatEditingCodeBlockContext"),O.ChatTitleBarMenu=new O("ChatTitleBarMenu"),O.ChatAttachmentsContext=new O("ChatAttachmentsContext"),O.ChatToolOutputResourceToolbar=new O("ChatToolOutputResourceToolbar"),O.ChatTextEditorMenu=new O("ChatTextEditorMenu"),O.ChatToolOutputResourceContext=new O("ChatToolOutputResourceContext"),O.ChatMultiDiffContext=new O("ChatMultiDiffContext"),O.ChatSessionsMenu=new O("ChatSessionsMenu"),O.ChatSessionsCreateSubMenu=new O("ChatSessionsCreateSubMenu"),O.ChatConfirmationMenu=new O("ChatConfirmationMenu"),O.ChatEditorInlineExecute=new O("ChatEditorInputExecute"),O.ChatEditorInlineInputSide=new O("ChatEditorInputSide"),O.AccessibleView=new O("AccessibleView"),O.MultiDiffEditorFileToolbar=new O("MultiDiffEditorFileToolbar"),O.DiffEditorHunkToolbar=new O("DiffEditorHunkToolbar"),O.DiffEditorSelectionToolbar=new O("DiffEditorSelectionToolbar");let He=O;const Vl=Mt("menuService"),Hx=class Hx{static for(e){let t=this._all.get(e);return t||(t=new Hx(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof Hx&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}};Hx._all=new Map;let gp=Hx;const qs=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new Zke({merge:gp.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(s){return this._commands.set(s.id,s),this._onDidChangeMenu.fire(gp.for(He.CommandPalette)),Ve(()=>{this._commands.delete(s.id)&&this._onDidChangeMenu.fire(gp.for(He.CommandPalette))})}getCommand(s){return this._commands.get(s)}getCommands(){const s=new Map;return this._commands.forEach((e,t)=>s.set(t,e)),s}appendMenuItem(s,e){let t=this._menuItems.get(s);t||(t=new Zo,this._menuItems.set(s,t));const i=t.push(e);return this._onDidChangeMenu.fire(gp.for(s)),Ve(()=>{i(),this._onDidChangeMenu.fire(gp.for(s))})}appendMenuItems(s){const e=new oe;for(const{id:t,item:i}of s)e.add(this.appendMenuItem(t,i));return e}getMenuItems(s){let e;return this._menuItems.has(s)?e=[...this._menuItems.get(s)]:e=[],s===He.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(s){const e=new Set;for(const t of s)f1(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||s.push({command:t})})}};class d_ extends vw{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let Ya=VT=class{static label(e,t){return t!=null&&t.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,n,o,r,a){var c;this.hideActions=n,this.menuKeybinding=o,this._commandService=a,this.id=e.id,this.label=VT.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:(c=e.tooltip)==null?void 0:c.value)??"",this.enabled=!e.precondition||r.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){const d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=r.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&it.isThemeIcon(d.icon)&&(l=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}l||(l=it.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new VT(t,void 0,i,n,void 0,r,a):void 0,this._options=i,this.class=l&&it.asClassName(l)}run(...e){var i,n;let t=[];return(i=this._options)!=null&&i.arg&&(t=[...t,this._options.arg]),(n=this._options)!=null&&n.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};Ya=VT=pNe([fY(5,ut),fY(6,en)],Ya);class Gs{constructor(e){this.desc=e}}function Ei(s){const e=[],t=new s,{f1:i,menu:n,keybinding:o,...r}=t.desc;if(Zt.getCommand(r.id))throw new Error(`Cannot register two commands with the same id: ${r.id}`);if(e.push(Zt.registerCommand({id:r.id,handler:(a,...l)=>t.run(a,...l),metadata:r.metadata??{description:t.desc.title}})),Array.isArray(n))for(const a of n)e.push(qs.appendMenuItem(a.id,{command:{...r,precondition:a.precondition===null?void 0:r.precondition},...a}));else n&&e.push(qs.appendMenuItem(n.id,{command:{...r,precondition:n.precondition===null?void 0:r.precondition},...n}));if(i&&(e.push(qs.appendMenuItem(He.CommandPalette,{command:r,when:r.precondition})),e.push(qs.addCommand(r))),Array.isArray(o))for(const a of o)e.push(Ks.registerKeybindingRule({...a,id:r.id,when:r.precondition?de.and(r.precondition,a.when):a.when}));else o&&e.push(Ks.registerKeybindingRule({...o,id:r.id,when:r.precondition?de.and(r.precondition,o.when):o.when}));return{dispose(){yi(e)}}}const Wo=Mt("telemetryService");var gY,mY,pY;class bNe{constructor(e,t){this.uri=e,this.value=t}}function vNe(s){return Array.isArray(s)}const Rp=class Rp{constructor(e,t){if(this[gY]="ResourceMap",e instanceof Rp)this.map=new Map(e.map),this.toKey=t??Rp.defaultToKey;else if(vNe(e)){this.map=new Map,this.toKey=t??Rp.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Rp.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new bNe(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(gY=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};Rp.defaultToKey=e=>e.toString();let ts=Rp;class CNe{constructor(e,t){this[mY]="ResourceSet",!e||typeof e=="function"?this._map=new ts(e):(this._map=new ts(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,n)=>e.call(t,n,n,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(mY=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}class wNe{constructor(){this[pY]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return n}[(pY=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class yNe extends wNe{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class Cc extends yNe{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class SNe{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class Eoe{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}}class TO{constructor(){this._data=new Map}set(e,...t){let i=this._data;for(let n=0;n<t.length-1;n++)i.has(t[n])||i.set(t[n],new Map),i=i.get(t[n]);i.set(t[t.length-1],e)}get(...e){let t=this._data;for(let i=0;i<e.length-1;i++){if(!t.has(e[i]))return;t=t.get(e[i])}return t.get(e[e.length-1])}clear(){this._data.clear()}toString(){const e=(t,i)=>{let n="";for(const[o,r]of t)n+=`${"  ".repeat(i)}${o}: `,r instanceof Map?n+=`
`+e(r,i+1):n+=`${r}
`;return n};return e(this._data,0)}}function Wf(s){return s===47||s===92}function koe(s){return s.replace(/[\\/]/g,hs.sep)}function xNe(s){return s.indexOf("/")===-1&&(s=koe(s)),/^[a-zA-Z]:(\/|$)/.test(s)&&(s="/"+s),s}function _Y(s,e=hs.sep){if(!s)return"";const t=s.length,i=s.charCodeAt(0);if(Wf(i)){if(Wf(s.charCodeAt(1))&&!Wf(s.charCodeAt(2))){let o=3;const r=o;for(;o<t&&!Wf(s.charCodeAt(o));o++);if(r!==o&&!Wf(s.charCodeAt(o+1))){for(o+=1;o<t;o++)if(Wf(s.charCodeAt(o)))return s.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(Doe(i)&&s.charCodeAt(1)===58)return Wf(s.charCodeAt(2))?s.slice(0,2)+e:s.slice(0,2);let n=s.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(Wf(s.charCodeAt(n)))return s.slice(0,n+1)}return""}function Y9(s,e,t,i=id){if(s===e)return!0;if(!s||!e||e.length>s.length)return!1;if(t){if(!CU(s,e))return!1;if(e.length===s.length)return!0;let o=e.length;return e.charAt(e.length-1)===i&&o--,s.charAt(o)===i}return e.charAt(e.length-1)!==i&&(e+=i),s.indexOf(e)===0}function Doe(s){return s>=65&&s<=90||s>=97&&s<=122}function LNe(s,e=no){return e?Doe(s.charCodeAt(0))&&s.charCodeAt(1)===58:!1}function Nd(s){return jN(s,!0)}class INe{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:pL(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===ct.file)return Y9(Nd(e),Nd(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(vY(e.authority,t.authority))return Y9(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return Ze.joinPath(e,...t)}basenameOrAuthority(e){return Fl(e)||e.authority}basename(e){return hs.basename(e.path)}extname(e){return hs.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===ct.file?t=Ze.file(BT(Nd(e))).path:(t=hs.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===ct.file?t=Ze.file(Kse(Nd(e))).path:t=hs.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!vY(e.authority,t.authority))return;if(e.scheme===ct.file){const o=ADe(Nd(e),Nd(t));return no?koe(o):o}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(const r=Math.min(i.length,n.length);o<r&&!(i.charCodeAt(o)!==n.charCodeAt(o)&&i.charAt(o).toLowerCase()!==n.charAt(o).toLowerCase());o++);i=n.substr(0,o)+i.substr(o)}return hs.relative(i,n)}resolvePath(e,t){if(e.scheme===ct.file){const i=Ze.file(MDe(Nd(e),t));return e.with({authority:i.authority,path:i.path})}return t=xNe(t),e.with({path:hs.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&zp(e,t)}hasTrailingPathSeparator(e,t=id){if(e.scheme===ct.file){const i=Nd(e);return i.length>_Y(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=id){return CY(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=id){let i=!1;if(e.scheme===ct.file){const n=Nd(e);i=n!==void 0&&n.length===_Y(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!CY(e,t)?e.with({path:e.path+"/"}):e}}const un=new INe(()=>!1),gm=un.isEqual.bind(un);un.isEqualOrParent.bind(un);un.getComparisonKey.bind(un);const ENe=un.basenameOrAuthority.bind(un),Fl=un.basename.bind(un),kNe=un.extname.bind(un),NO=un.dirname.bind(un),Toe=un.joinPath.bind(un),DNe=un.normalizePath.bind(un),TNe=un.relativePath.bind(un),bY=un.resolvePath.bind(un);un.isAbsolutePath.bind(un);const vY=un.isEqualAuthority.bind(un),CY=un.hasTrailingPathSeparator.bind(un);un.removeTrailingPathSeparator.bind(un);un.addTrailingPathSeparator.bind(un);var mm;(function(s){s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(r=>{const[a,l]=r.split(":");a&&l&&i.set(a,l)});const o=t.path.substring(0,t.path.indexOf(";"));return o&&i.set(s.META_DATA_MIME,o),i}s.parseMetaData=e})(mm||(mm={}));const Ji=Mt("logService"),Noe=Mt("loggerService");var Ns;(function(s){s[s.Off=0]="Off",s[s.Trace=1]="Trace",s[s.Debug=2]="Debug",s[s.Info=3]="Info",s[s.Warning=4]="Warning",s[s.Error=5]="Error"})(Ns||(Ns={}));const Roe=Ns.Info;function Moe(s,e){return s!==Ns.Off&&s<=e}class Aoe extends K{constructor(){super(...arguments),this.level=Roe,this._onDidChangeLogLevel=this._register(new q)}get onDidChangeLogLevel(){return this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return Moe(this.level,e)}canLog(e){return this._store.isDisposed?!1:this.checkLogLevel(e)}}class NNe extends Aoe{constructor(e=Roe,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.canLog(Ns.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.canLog(Ns.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.canLog(Ns.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.canLog(Ns.Warning)&&(this.useColors?console.warn("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.canLog(Ns.Error)&&(this.useColors?console.error("%c  ERR","color: #f33",e,...t):console.error(e,...t))}}class RNe extends Aoe{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class MNe extends K{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new ts,this._onDidChangeLoggers=this._register(new q),this._onDidChangeVisibility=this._register(new q),i)for(const n of i)this._loggers.set(n.resource,{logger:void 0,info:n})}getLoggerEntry(e){return As(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}createLogger(e,t){var l;const i=this.toResource(e),n=As(e)?e:(t==null?void 0:t.id)??dk(i.toString()).toString(16);let o=(l=this._loggers.get(i))==null?void 0:l.logger;const r=(t==null?void 0:t.logLevel)==="always"?Ns.Trace:t==null?void 0:t.logLevel;o||(o=this.doCreateLogger(i,r??this.getLogLevel(i)??this.logLevel,{...t,id:n}));const a={logger:o,info:{resource:i,id:n,logLevel:r,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,group:t==null?void 0:t.group,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(i,a),o}toResource(e){return As(e)?Toe(this.logsHome,`${e}.log`):e}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){var i;let t;return e&&(t=(i=this._loggers.get(e))==null?void 0:i.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}class ANe{constructor(){this.onDidChangeLogLevel=new q().event}setLevel(e){}getLevel(){return Ns.Info}trace(e,...t){}debug(e,...t){}info(e,...t){}warn(e,...t){}error(e,...t){}dispose(){}}class PNe extends MNe{constructor(){super(Ns.Off,Ze.parse("log:///log"))}doCreateLogger(e,t,i){return new ANe}}function ONe(s){switch(s){case Ns.Trace:return"trace";case Ns.Debug:return"debug";case Ns.Info:return"info";case Ns.Warning:return"warn";case Ns.Error:return"error";case Ns.Off:return"off"}}new Ne("logLevel",ONe(Ns.Info));const Vx=class Vx{static getRegisteredCommands(){return[...Vx.REGISTERED_COMMANDS]}static registerCommand(e){Vx.REGISTERED_COMMANDS.add(e)}};Vx.REGISTERED_COMMANDS=new Set;let eR=Vx,RO=class{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata,this.canTriggerInlineEdits=e.canTriggerInlineEdits}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=de.and(i,this.precondition):i=this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Ks.registerKeybindingRule(n)}}Zt.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata}),this.canTriggerInlineEdits&&eR.registerCommand(this.id)}_registerMenuItem(e){qs.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}};class n0 extends RO{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((o,r)=>r.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===i){this._implementations.splice(o,1);return}}}}runCommand(e,t){const i=e.get(Ji),n=e.get(ut);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const o of this._implementations){if(o.when){const a=n.getContext(Ss());if(!o.when.evaluate(a))continue}const r=o.implementation(e,t);if(r)return i.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof r=="boolean"?void 0:r}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class Poe extends RO{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class Is extends RO{static bindToContribution(e){return class extends Is{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,o){const r=e(n);r&&this._callback(r,o)}}}static runEditorCommand(e,t,i,n){const o=e.get(ii),r=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(r)return r.invokeWithinContext(a=>{if(a.get(ut).contextMatchesRules(i??void 0))return n(a,r,t)})}runCommand(e,t){return Is.runEditorCommand(e,t,this.precondition,(i,n,o)=>this.runEditorCommand(i,n,o))}}class Fe extends Is{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(n){return n.menuId||(n.menuId=He.EditorContext),n.title||(n.title=typeof e.label=="string"?e.label:e.label.value),n.when=de.and(e.precondition,n.when),n}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}constructor(e){super(Fe.convertOptions(e)),typeof e.label=="string"?(this.label=e.label,this.alias=e.alias??e.label):(this.label=e.label.value,this.alias=e.alias??e.label.original)}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(Wo).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class MO extends Fe{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,n)=>n[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const n of this._implementations){const o=n[1](e,t,i);if(o)return typeof o=="boolean"?void 0:o}}}class wc extends Gs{run(e,...t){const i=e.get(ii),n=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(n)return n.invokeWithinContext(o=>{var c;const r=o.get(ut),a=o.get(Ji);if(!r.contextMatchesRules(this.desc.precondition??void 0)){a.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,(c=this.desc.precondition)==null?void 0:c.serialize());return}return this.runEditorCommand(o,n,...t)})}}function qr(s,e){Zt.registerCommand(s,function(t,...i){const n=t.get($e),[o,r]=i;ti(Ze.isUri(o)),ti(z.isIPosition(r));const a=t.get(Cn).getModel(o);if(a){const l=z.lift(r);return n.invokeFunction(e,a,l,...i.slice(2))}return t.get(nr).createModelReference(o).then(l=>new Promise((c,d)=>{try{const h=n.invokeFunction(e,l.object.textEditorModel,z.lift(r),i.slice(2));c(h)}catch(h){d(h)}}).finally(()=>{l.dispose()}))})}function Te(s){return Cl.INSTANCE.registerEditorCommand(s),s}function xe(s){const e=new s;return Cl.INSTANCE.registerEditorAction(e),e}function AO(s){return Cl.INSTANCE.registerEditorAction(s),s}function FNe(s){Cl.INSTANCE.registerEditorAction(s)}function Qt(s,e,t){Cl.INSTANCE.registerEditorContribution(s,e,t)}var g1;(function(s){function e(r){return Cl.INSTANCE.getEditorCommand(r)}s.getEditorCommand=e;function t(){return Cl.INSTANCE.getEditorActions()}s.getEditorActions=t;function i(){return Cl.INSTANCE.getEditorContributions()}s.getEditorContributions=i;function n(r){return Cl.INSTANCE.getEditorContributions().filter(a=>r.indexOf(a.id)>=0)}s.getSomeEditorContributions=n;function o(){return Cl.INSTANCE.getDiffEditorContributions()}s.getDiffEditorContributions=o})(g1||(g1={}));const BNe={EditorCommonContributions:"editor.contributions"},uA=class uA{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};uA.INSTANCE=new uA;let Cl=uA;kn.add(BNe.EditorCommonContributions,Cl.INSTANCE);function fk(s){return s.register(),s}const Ooe=fk(new n0({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:He.MenubarEditMenu,group:"1_do",title:_(69,"&&Undo"),order:1},{menuId:He.CommandPalette,group:"",title:_(70,"Undo"),order:1},{menuId:He.SimpleEditorContext,group:"1_do",title:_(71,"Undo"),order:1}]}));fk(new Poe(Ooe,{id:"default:undo",precondition:void 0}));const Foe=fk(new n0({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:He.MenubarEditMenu,group:"1_do",title:_(72,"&&Redo"),order:2},{menuId:He.CommandPalette,group:"",title:_(73,"Redo"),order:1},{menuId:He.SimpleEditorContext,group:"1_do",title:_(74,"Redo"),order:2}]}));fk(new Poe(Foe,{id:"default:redo",precondition:void 0}));const WNe=fk(new n0({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:He.MenubarSelectionMenu,group:"1_basic",title:_(75,"&&Select All"),order:1},{menuId:He.CommandPalette,group:"",title:_(76,"Select All"),order:1},{menuId:He.SimpleEditorContext,group:"9_select",title:_(77,"Select All"),order:1}]}));let D=class Zs{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return Zs.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return Zs.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return Zs.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return Zs.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return Zs.plusRange(this,e)}static plusRange(e,t){let i,n,o,r;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(o=t.endLineNumber,r=t.endColumn):t.endLineNumber===e.endLineNumber?(o=t.endLineNumber,r=Math.max(t.endColumn,e.endColumn)):(o=e.endLineNumber,r=e.endColumn),new Zs(i,n,o,r)}intersectRanges(e){return Zs.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,d=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),o>c?(o=c,r=d):o===c&&(r=Math.min(r,d)),i>o||i===o&&n>r?null:new Zs(i,n,o,r)}equalsRange(e){return Zs.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return Zs.getEndPosition(this)}static getEndPosition(e){return new z(e.endLineNumber,e.endColumn)}getStartPosition(){return Zs.getStartPosition(this)}static getStartPosition(e){return new z(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new Zs(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new Zs(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return Zs.collapseToStart(this)}static collapseToStart(e){return new Zs(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return Zs.collapseToEnd(this)}static collapseToEnd(e){return new Zs(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new Zs(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,t=e){return new Zs(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new Zs(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return!!e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static areOnlyIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber-1||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn-1||t.endLineNumber<e.startLineNumber-1||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn-1)}static compareRangesUsingStarts(e,t){if(e&&t){const o=e.startLineNumber|0,r=t.startLineNumber|0;if(o===r){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,d=t.endLineNumber|0;if(c===d){const h=e.endColumn|0,u=t.endColumn|0;return h-u}return c-d}return a-l}return o-r}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},Oe=class Gl extends D{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return Gl.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new Gl(this.startLineNumber,this.startColumn,e,t):new Gl(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new z(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new z(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new Gl(e,t,this.endLineNumber,this.endColumn):new Gl(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new Gl(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new Gl(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new Gl(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new Gl(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return!!e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,o){return o===0?new Gl(e,t,i,n):new Gl(i,n,e,t)}};function jp(s,e){const t=s.getCount(),i=s.findTokenIndexAtOffset(e),n=s.getLanguageId(i);let o=i;for(;o+1<t&&s.getLanguageId(o+1)===n;)o++;let r=i;for(;r>0&&s.getLanguageId(r-1)===n;)r--;return new HNe(s,n,r,o+1,s.getStartOffset(r),s.getEndOffset(o))}class HNe{constructor(e,t,i,n,o,r){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=o,this._lastCharOffset=r,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function Rd(s){return(s&3)!==0}class Ln{static _nextVisibleColumn(e,t,i){return e===9?Ln.nextRenderTabStop(t,i):hf(e)||xU(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),o=e.substring(0,n),r=new VN(o);let a=0;for(;!r.eol();){const l=HN(o,n,r.offset);r.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,o=new VN(e);let r=0,a=1;for(;!o.eol();){const l=HN(e,n,o.offset);o.nextGraphemeLength();const c=this._nextVisibleColumn(l,r,i),d=o.offset+1;if(c>=t){const h=t-r;return c-t<h?d:a}r=c,a=d}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return Ln.nextRenderTabStop(e,t)}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Ln.prevRenderTabStop(e,t)}}function VNe(s,e,t){let i=0;for(let o=0;o<s.length;o++)s.charAt(o)==="	"?i=Ln.nextIndentTabStop(i,e):i++;let n="";if(!t){const o=Math.floor(i/e);i=i%e;for(let r=0;r<o;r++)n+="	"}for(let o=0;o<i;o++)n+=" ";return n}function zU(s,e,t){let i=Jo(s);return i===-1&&(i=s.length),VNe(s.substring(0,i),e,t)+s.substring(i)}class zNe{constructor(){this._inputMode="insert",this._onDidChangeInputMode=new q,this.onDidChangeInputMode=this._onDidChangeInputMode.event}getInputMode(){return this._inputMode}}const X9=new zNe,UNe=()=>!0,$Ne=()=>!1,qNe=s=>s===" "||s==="	";class zv{static shouldRecreate(e){return e.hasChanged(165)||e.hasChanged(148)||e.hasChanged(45)||e.hasChanged(85)||e.hasChanged(88)||e.hasChanged(89)||e.hasChanged(10)||e.hasChanged(11)||e.hasChanged(15)||e.hasChanged(13)||e.hasChanged(14)||e.hasChanged(20)||e.hasChanged(145)||e.hasChanged(141)||e.hasChanged(59)||e.hasChanged(104)||e.hasChanged(147)||e.hasChanged(93)}constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const o=i.options,r=o.get(165),a=o.get(59);this.readOnly=o.get(104),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=o.get(132),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(r.height/this.lineHeight)-2),this.useTabStops=o.get(145),this.trimWhitespaceOnDelete=o.get(141),this.wordSeparators=o.get(148),this.emptySelectionClipboard=o.get(45),this.copyWithSyntaxHighlighting=o.get(31),this.multiCursorMergeOverlapping=o.get(85),this.multiCursorPaste=o.get(88),this.multiCursorLimit=o.get(89),this.autoClosingBrackets=o.get(10),this.autoClosingComments=o.get(11),this.autoClosingQuotes=o.get(15),this.autoClosingDelete=o.get(13),this.autoClosingOvertype=o.get(14),this.autoSurround=o.get(20),this.autoIndent=o.get(16),this.wordSegmenterLocales=o.get(147),this.overtypeOnPaste=o.get(93),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(const d of l)this.surroundingPairs[d.open]=d.close;const c=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=(c==null?void 0:c.blockCommentStartToken)??null}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)==null?void 0:e.getElectricCharacters();if(t)for(const i of t)this._electricChars[i]=!0}return this._electricChars}get inputMode(){return X9.getInputMode()}onElectricCharacter(e,t,i){const n=jp(t,i-1),o=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return o?o.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return zU(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return qNe;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return UNe;case"never":return $Ne}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return Ln.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=Ln.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),o=e.getLineMinColumn(t);if(n<o)return o;const r=e.getLineMaxColumn(t);return n>r?r:n}}let si=class Boe{static fromModelState(e){return new jNe(e)}static fromViewState(e){return new KNe(e)}static fromModelSelection(e){const t=Oe.liftSelection(e),i=new Js(D.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return Boe.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}};class jNe{constructor(e){this.modelState=e,this.viewState=null}}class KNe{constructor(e){this.modelState=null,this.viewState=e}}class Js{constructor(e,t,i,n,o){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=n,this.leftoverVisibleColumns=o,this._singleCursorStateBrand=void 0,this.selection=Js._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new Js(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new z(t,i),n):new Js(new D(t,i,t,i),0,n,new z(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Oe.fromPositions(e.getStartPosition(),t):Oe.fromPositions(e.getEndPosition(),t)}}class Cr{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function pm(s){return s==="'"||s==='"'||s==="`"}class mp{static columnSelect(e,t,i,n,o,r){const a=Math.abs(o-i)+1,l=i>o,c=n>r,d=n<r,h=[];for(let u=0;u<a;u++){const f=i+(l?-u:u),g=e.columnFromVisibleColumn(t,f,n),m=e.columnFromVisibleColumn(t,f,r),p=e.visibleColumnFromColumn(t,new z(f,g)),v=e.visibleColumnFromColumn(t,new z(f,m));d&&(p>r||v<n)||c&&(v>n||p<r)||h.push(new Js(new D(f,g,f,g),0,0,new z(f,m),0))}if(h.length===0)for(let u=0;u<a;u++){const f=i+(l?-u:u),g=t.getLineMaxColumn(f);h.push(new Js(new D(f,g,f,g),0,0,new z(f,g),0))}return{viewStates:h,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:o,toVisualColumn:r}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,mp.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),r=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=o;l<=r;l++){const c=t.getLineMaxColumn(l),d=e.visibleColumnFromColumn(t,new z(l,c));n=Math.max(n,d)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){const o=n?e.pageSize:1,r=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const o=n?e.pageSize:1,r=Math.min(t.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}}class vo{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Oe.fromPositions(n.getEndPosition())}}class Z9{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){const i=this._range.getStartPosition(),n=this._range.getEndPosition(),o=n.lineNumber,r=this._text.length+(this._range.isEmpty()?0:-1);let a=Woe(e,n,r);a.lineNumber>o&&(a=new z(o,e.getLineMaxColumn(o)));const l=D.fromPositions(i,a);t.addTrackedEditOperation(l,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Oe.fromPositions(n.getEndPosition())}}class GNe{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Oe.fromRange(n,0)}}class zT{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Oe.fromPositions(n.getStartPosition())}}class tR{constructor(e,t,i,n,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Oe.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class YNe{constructor(e){this._range=e}getEditOperations(e,t){const i=e.getValueInRange(this._range),n=this._range.getEndPosition(),o=n.lineNumber;let r=Woe(e,n,i.length);r.lineNumber>o&&(r=new z(o,e.getLineMaxColumn(o)));const a=D.fromPositions(n,r);t.addTrackedEditOperation(a,"")}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return Oe.fromPositions(n.getEndPosition())}}class UU{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function Woe(s,e,t){if(t<0)throw new Error("Unexpected negative delta");const i=s.getLineCount();let n=new z(i,s.getLineMaxColumn(i));for(let o=e.lineNumber;o<=i;o++)if(o===e.lineNumber){const r=t-s.getLineMaxColumn(e.lineNumber)+e.column;if(r<=0){n=new z(e.lineNumber,e.column+t);break}t=r}else{const r=t-s.getLineMaxColumn(o);if(r<=0){n=new z(o,t);break}t=r}return n}class LL{static whitespaceVisibleColumn(e,t,i){const n=e.length;let o=0,r=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[r,a,o];switch(o%i===0&&(r=l,a=o),e.charCodeAt(l)){case 32:o+=1;break;case 9:o=Ln.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return t===n?[r,a,o]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const o=e.length,[r,a,l]=LL.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(n){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(r===-1)return-1;let u=a;for(let f=r;f<o;++f){if(u===a+i)return r;switch(e.charCodeAt(f)){case 32:u+=1;break;case 9:u=Ln.nextRenderTabStop(u,i);break;default:return-1}}return u===a+i?r:-1}const d=Ln.nextRenderTabStop(l,i);let h=l;for(let u=t;u<o;u++){if(h===d)return u;switch(e.charCodeAt(u)){case 32:h+=1;break;case 9:h=Ln.nextRenderTabStop(h,i);break;default:return-1}}return h===d?o:-1}}class O5{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class bi{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Hse(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new z(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),o=e.getLineContent(t.lineNumber),r=LL.atomicPosition(o,t.column-1,i,0);if(r!==-1&&r+1>=n)return new z(t.lineNumber,r+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?bi.leftPositionAtomicSoftTabs(t,i,e.tabSize):bi.leftPosition(t,i);return new O5(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,o){let r,a;if(i.hasSelection()&&!n)r=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(o-1)),c=t.normalizePosition(bi.clipPositionColumn(l,t),0),d=bi.left(e,t,c);r=d.lineNumber,a=d.column}return i.move(n,r,a,0)}static clipPositionColumn(e,t){return new z(e.lineNumber,bi.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+SU(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new z(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,o){if(i<e.getLineIndentColumn(t)){const r=e.getLineContent(t),a=LL.atomicPosition(r,i-1,n,1);if(a!==-1)return new z(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?bi.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):bi.rightPosition(t,i.lineNumber,i.column);return new O5(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,o){let r,a;if(i.hasSelection()&&!n)r=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,o-1),c=t.normalizePosition(bi.clipPositionColumn(l,t),1),d=bi.right(e,t,c);r=d.lineNumber,a=d.column}return i.move(n,r,a,0)}static vertical(e,t,i,n,o,r,a,l){const c=Ln.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+o,d=t.getLineCount(),h=i===1&&n===1,u=i===d&&n===t.getLineMaxColumn(i),f=r<i?h:u;if(i=r,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>d?(i=d,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,c),f?o=0:o=c-Ln.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){const g=new z(i,n),m=t.normalizePosition(g,l);o=o+(n-m.column),i=m.lineNumber,n=m.column}return new O5(i,n,o)}static down(e,t,i,n,o,r,a){return this.vertical(e,t,i,n,o,i+r,a,4)}static moveDown(e,t,i,n,o){let r,a;i.hasSelection()&&!n?(r=i.selection.endLineNumber,a=i.selection.endColumn):(r=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=bi.down(e,t,r+l,a,i.leftoverVisibleColumns,o,!0),t.normalizePosition(new z(c.lineNumber,c.column),2).lineNumber>r)break;while(l++<10&&r+l<t.getLineCount());return i.move(n,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,o=bi.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=bi.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new Js(new D(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new z(r.lineNumber,r.column),r.leftoverVisibleColumns)}static up(e,t,i,n,o,r,a){return this.vertical(e,t,i,n,o,i-r,a,3)}static moveUp(e,t,i,n,o){let r,a;i.hasSelection()&&!n?(r=i.selection.startLineNumber,a=i.selection.startColumn):(r=i.position.lineNumber,a=i.position.column);const l=bi.up(e,t,r,a,i.leftoverVisibleColumns,o,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,o=bi.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=bi.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new Js(new D(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new z(r.lineNumber,r.column),r.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(t,o);)o--;for(;o>1&&!this._isBlankLine(t,o);)o--;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToNextBlankLine(e,t,i,n){const o=t.getLineCount();let r=i.position.lineNumber;for(;r<o&&this._isBlankLine(t,r);)r++;for(;r<o&&!this._isBlankLine(t,r);)r++;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToBeginningOfLine(e,t,i,n){const o=i.position.lineNumber,r=t.getLineMinColumn(o),a=t.getLineFirstNonWhitespaceColumn(o)||r;let l;return i.position.column===a?l=r:l=a,i.move(n,o,l,0)}static moveToEndOfLine(e,t,i,n,o){const r=i.position.lineNumber,a=t.getLineMaxColumn(r);return i.move(n,r,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const o=t.getLineCount(),r=t.getLineMaxColumn(o);return i.move(n,o,r,0)}}class Ab{static deleteRight(e,t,i,n){const o=[];let r=e!==3;for(let a=0,l=n.length;a<l;a++){const c=n[a],d=this.getDeleteRightRange(c,i,t);if(d.isEmpty()){o[a]=null;continue}d.startLineNumber!==d.endLineNumber&&(r=!0),o[a]=new vo(d,"")}return[r,o]}static getDeleteRightRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition(),o=bi.right(i,t,n);if(i.trimWhitespaceOnDelete&&o.lineNumber!==n.lineNumber){const r=t.getLineFirstNonWhitespaceColumn(n.lineNumber)>0,a=t.getLineFirstNonWhitespaceColumn(o.lineNumber);if(r&&a>0)return new D(o.lineNumber,a,n.lineNumber,n.column)}return new D(o.lineNumber,o.column,n.lineNumber,n.column)}static isAutoClosingPairDelete(e,t,i,n,o,r,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=r.length;l<c;l++){const d=r[l],h=d.getPosition();if(!d.isEmpty())return!1;const u=o.getLineContent(h.lineNumber);if(h.column<2||h.column>=u.length+1)return!1;const f=u.charAt(h.column-2),g=n.get(f);if(!g)return!1;if(pm(f)){if(i==="never")return!1}else if(t==="never")return!1;const m=u.charAt(h.column-1);let p=!1;for(const v of g)v.open===f&&v.close===m&&(p=!0);if(!p)return!1;if(e==="auto"){let v=!1;for(let b=0,w=a.length;b<w;b++){const C=a[b];if(h.lineNumber===C.startLineNumber&&h.column===C.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++){const a=i[o].getPosition(),l=new D(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[o]=new vo(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,o){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,o))return this._runAutoClosingPairDelete(t,i,n);const r=[];let a=e!==2;for(let l=0,c=n.length;l<c;l++){const d=Ab.getDeleteLeftRange(n[l],i,t);if(d.isEmpty()){r[l]=null;continue}d.startLineNumber!==d.endLineNumber&&(a=!0),r[l]=new vo(d,"")}return[a,r]}static getDeleteLeftRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const o=t.getLineContent(n.lineNumber),r=Jo(o),a=r===-1?o.length+1:r+1;if(n.column<=a){const l=i.visibleColumnFromColumn(t,n),c=Ln.prevIndentTabStop(l,i.indentSize),d=i.columnFromVisibleColumn(t,n.lineNumber,c);return new D(n.lineNumber,d,n.lineNumber,n.column)}}return D.fromPositions(Ab.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=wDe(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new z(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const n=[];let o=null;i.sort((r,a)=>z.compare(r.getStartPosition(),a.getEndPosition()));for(let r=0,a=i.length;r<a;r++){const l=i[r];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let d,h,u,f;c.lineNumber<t.getLineCount()?(d=c.lineNumber,h=1,u=c.lineNumber+1,f=1):c.lineNumber>1&&(o==null?void 0:o.endLineNumber)!==c.lineNumber?(d=c.lineNumber-1,h=t.getLineMaxColumn(c.lineNumber-1),u=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber)):(d=c.lineNumber,h=1,u=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber));const g=new D(d,h,u,f);o=g,g.isEmpty()?n[r]=null:n[r]=new vo(g,"")}else n[r]=null;else n[r]=new vo(l,"")}return new Cr(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}const bv={DateTimeFormat(s,e){return new bo(()=>{try{return new Intl.DateTimeFormat(s,e)}catch{return new Intl.DateTimeFormat(void 0,e)}})},Collator(s,e){return new bo(()=>{try{return new Intl.Collator(s,e)}catch{return new Intl.Collator(void 0,e)}})},Segmenter(s,e){return new bo(()=>{try{return new Intl.Segmenter(s,e)}catch{return new Intl.Segmenter(void 0,e)}})},Locale(s,e){return new bo(()=>{try{return new Intl.Locale(s,e)}catch{return new Intl.Locale(Vp,e)}})},NumberFormat(s,e){return new bo(()=>{try{return new Intl.NumberFormat(s,e)}catch{return new Intl.NumberFormat(void 0,e)}})}};function iR(s){return s<0?0:s>255?255:s|0}function Uv(s){return s<0?0:s>4294967295?4294967295:s|0}class s0{constructor(e){const t=iR(e);this._defaultValue=t,this._asciiMap=s0._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=iR(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class nR{constructor(){this._actual=new s0(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}clear(){return this._actual.clear()}}class XNe extends s0{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=bv.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.value.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const wY=new Cc(10);function Bl(s,e){const t=`${s}/${e.join(",")}`;let i=wY.get(t);return i||(i=new XNe(s,e),wY.set(t,i)),i}class vi{static _createWord(e,t,i,n,o){return{start:n,end:o,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;const o=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let r=i.column-2;r>=0;r--){const a=e.charCodeAt(r),l=t.get(a);if(o&&r===o.index)return this._createIntlWord(o,l);if(l===0){if(n===2)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const o=t.findNextIntlWordAtOrAfterOffset(e,n),r=e.length;for(let a=n;a<r;a++){const l=e.charCodeAt(a),c=t.get(l);if(o&&a===o.index+o.segment.length||c===1||i===1&&c===2||i===2&&c===0)return a}return r}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const o=e.length,r=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<o;a++){const l=e.charCodeAt(a),c=t.get(l);if(r&&a===r.index)return this._createIntlWord(r,c);if(c===0){if(n===2)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(c===2){if(n===1)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(c===1&&n!==0)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,o-1),o):null}static _findStartOfWord(e,t,i,n){const o=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let r=n;r>=0;r--){const a=e.charCodeAt(r),l=t.get(a);if(o&&r===o.index)return r;if(l===1||i===1&&l===2||i===2&&l===0)return r+1}return 0}static moveWordLeft(e,t,i,n,o){let r=i.lineNumber,a=i.column;a===1&&r>1&&(r=r-1,a=t.getLineMaxColumn(r));let l=vi._findPreviousWordOnLine(e,t,new z(r,a));if(n===0)return new z(r,l?l.start+1:1);if(n===1)return!o&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=vi._findPreviousWordOnLine(e,t,new z(r,l.start+1))),new z(r,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=vi._findPreviousWordOnLine(e,t,new z(r,l.start+1));return new z(r,l?l.start+1:1)}return l&&a<=l.end+1&&(l=vi._findPreviousWordOnLine(e,t,new z(r,l.start+1))),new z(r,l?l.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new z(i-1,e.getLineMaxColumn(i-1)):t;const o=e.getLineContent(i);for(let r=t.column-1;r>1;r--){const a=o.charCodeAt(r-2),l=o.charCodeAt(r-1);if(a===95&&l!==95)return new z(i,r);if(a===45&&l!==45)return new z(i,r);if((bg(a)||nD(a))&&Yd(l))return new z(i,r);if(Yd(a)&&Yd(l)&&r+1<n){const c=o.charCodeAt(r);if(bg(c)||nD(c))return new z(i,r)}}return new z(i,1)}static moveWordRight(e,t,i,n){let o=i.lineNumber,r=i.column,a=!1;r===t.getLineMaxColumn(o)&&o<t.getLineCount()&&(a=!0,o=o+1,r=1);let l=vi._findNextWordOnLine(e,t,new z(o,r));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=vi._findNextWordOnLine(e,t,new z(o,l.end+1))),l?r=l.end+1:r=t.getLineMaxColumn(o);else if(n===3){for(a&&(r=0);l&&(l.wordType===2||l.start+1<=r);)l=vi._findNextWordOnLine(e,t,new z(o,l.end+1));l?r=l.start+1:r=t.getLineMaxColumn(o)}else l&&!a&&r>=l.start+1&&(l=vi._findNextWordOnLine(e,t,new z(o,l.end+1))),l?r=l.start+1:r=t.getLineMaxColumn(o);return new z(o,r)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new z(i+1,1):t;const o=e.getLineContent(i);for(let r=t.column+1;r<n;r++){const a=o.charCodeAt(r-2),l=o.charCodeAt(r-1);if(a!==95&&l===95)return new z(i,r);if(a!==45&&l===45)return new z(i,r);if((bg(a)||nD(a))&&Yd(l))return new z(i,r);if(Yd(a)&&Yd(l)&&r+1<n){const c=o.charCodeAt(r);if(bg(c)||nD(c))return new z(i,r)}}return new z(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,o=uc(i,n);return o+1<n?new D(t.lineNumber,o+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;if(Ab.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const h=e.selection.getPosition();return new D(h.lineNumber,h.column-1,h.lineNumber,h.column+1)}const a=new z(o.positionLineNumber,o.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(r){const h=this._deleteWordLeftWhitespace(n,a);if(h)return h}let d=vi._findPreviousWordOnLine(i,n,a);return t===0?d?c=d.start+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l)):(d&&c<=d.end+1&&(d=vi._findPreviousWordOnLine(i,n,new z(l,d.start+1))),d?c=d.end+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l))),new D(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new z(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(t,n);return o||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let o=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let r=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,r))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;r+1<n&&this._charAtIsWhitespace(i,r+1);)r++;return new D(t.lineNumber,o+1,t.lineNumber,r+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),o=n.length;if(o===0)return i.lineNumber>1?new D(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new D(i.lineNumber,1,i.lineNumber+1,1):new D(i.lineNumber,1,i.lineNumber,1);const r=h=>h.start+1<=i.column&&i.column<=h.end+1,a=(h,u)=>(h=Math.min(h,i.column),u=Math.max(u,i.column),new D(i.lineNumber,h,i.lineNumber,u)),l=h=>{let u=h.start+1,f=h.end+1,g=!1;for(;f-1<o&&this._charAtIsWhitespace(n,f-1);)g=!0,f++;if(!g)for(;u>1&&this._charAtIsWhitespace(n,u-2);)u--;return a(u,f)},c=vi._findPreviousWordOnLine(e,t,i);if(c&&r(c))return l(c);const d=vi._findNextWordOnLine(e,t,i);return d&&r(d)?l(d):c&&d?a(c.end+1,d.start+1):c?a(c.start+1,c.end+1):d?a(d.start+1,d.end+1):a(1,o+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=vi._moveWordPartLeft(e,i);return new D(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const o=e.charAt(n);if(o!==" "&&o!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,o=this._findFirstNonWhitespaceChar(i,n);return n+1<o?new D(t.lineNumber,t.column,t.lineNumber,o+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;const a=new z(o.positionLineNumber,o.positionColumn);let l=a.lineNumber,c=a.column;const d=n.getLineCount(),h=n.getLineMaxColumn(l);if(l===d&&c===h)return null;if(r){const f=this._deleteWordRightWhitespace(n,a);if(f)return f}let u=vi._findNextWordOnLine(i,n,a);return t===2?u?c=u.end+1:c<h||l===d?c=h:(l++,u=vi._findNextWordOnLine(i,n,new z(l,1)),u?c=u.start+1:c=n.getLineMaxColumn(l)):(u&&c>=u.start+1&&(u=vi._findNextWordOnLine(i,n,new z(l,u.end+1))),u?c=u.start+1:c<h||l===d?c=h:(l++,u=vi._findNextWordOnLine(i,n,new z(l,1)),u?c=u.start+1:c=n.getLineMaxColumn(l))),new D(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=vi._moveWordPartRight(e,i);return new D(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new D(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){const o=Bl(t,i),r=vi._findPreviousWordOnLine(o,e,n);if(r&&r.wordType===1&&r.start<=n.column-1&&n.column-1<=r.end)return vi._createWordAtPosition(e,n.lineNumber,r);const a=vi._findNextWordOnLine(o,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?vi._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,o){const r=Bl(e.wordSeparators,e.wordSegmenterLocales),a=vi._findPreviousWordOnLine(r,t,o),l=vi._findNextWordOnLine(r,t,o);if(!n){let f,g;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end||a&&a.wordType===2&&a.start<=o.column-1&&o.column-1<a.end?(f=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end||l&&l.wordType===2&&l.start<=o.column-1&&o.column-1<l.end?(f=l.start+1,g=l.end+1):(a?f=a.end+1:f=1,l?g=l.start+1:g=t.getLineMaxColumn(o.lineNumber)),new Js(new D(o.lineNumber,f,o.lineNumber,g),1,0,new z(o.lineNumber,g),0)}let c,d;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(c=a.start+1,d=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(c=l.start+1,d=l.end+1):(c=o.column,d=o.column);const h=o.lineNumber;let u;if(i.selectionStart.containsPosition(o))u=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){u=c;const f=new z(h,u);i.selectionStart.containsPosition(f)&&(u=i.selectionStart.endColumn)}else{u=d;const f=new z(h,u);i.selectionStart.containsPosition(f)&&(u=i.selectionStart.startColumn)}return i.move(!0,h,u,0)}}class PO extends vi{static deleteWordPartLeft(e){const t=aD([vi.deleteWordLeft(e,0),vi.deleteWordLeft(e,2),vi._deleteWordPartLeft(e.model,e.selection)]);return t.sort(D.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=aD([vi.deleteWordRight(e,0),vi.deleteWordRight(e,2),vi._deleteWordPartRight(e.model,e.selection)]);return t.sort(D.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,i,n){const o=aD([vi.moveWordLeft(e,t,i,0,n),vi.moveWordLeft(e,t,i,2,n),vi._moveWordPartLeft(t,i)]);return o.sort(z.compare),o[2]}static moveWordPartRight(e,t,i){const n=aD([vi.moveWordRight(e,t,i,0),vi.moveWordRight(e,t,i,2),vi._moveWordPartRight(t,i)]);return n.sort(z.compare),n[0]}}function aD(s){return s.filter(e=>!!e)}function Xd(s){if(!s||typeof s!="object"||s instanceof RegExp)return s;const e=Array.isArray(s)?[]:{};return Object.entries(s).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?Xd(i):i}),e}function ZNe(s){if(!s||typeof s!="object")return s;const e=[s];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(Hoe.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!bke(n)&&e.push(n)}}return s}const Hoe=Object.prototype.hasOwnProperty;function Voe(s,e){return Q9(s,e,new Set)}function Q9(s,e,t){if(vl(s))return s;const i=e(s);if(typeof i<"u")return i;if(Array.isArray(s)){const n=[];for(const o of s)n.push(Q9(o,e,t));return n}if(ws(s)){if(t.has(s))throw new Error("Cannot clone recursive data-structure");t.add(s);const n={};for(const o in s)Hoe.call(s,o)&&(n[o]=Q9(s[o],e,t));return t.delete(s),n}return s}function OO(s,e,t=!0){return ws(s)?(ws(e)&&Object.keys(e).forEach(i=>{i in s?t&&(ws(s[i])&&ws(e[i])?OO(s[i],e[i],t):s[i]=e[i]):s[i]=e[i]}),s):e}function la(s,e){if(s===e)return!0;if(s==null||e===null||e===void 0||typeof s!=typeof e||typeof s!="object"||Array.isArray(s)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(s)){if(s.length!==e.length)return!1;for(t=0;t<s.length;t++)if(!la(s[t],e[t]))return!1}else{const n=[];for(i in s)n.push(i);n.sort();const o=[];for(i in e)o.push(i);if(o.sort(),!la(n,o))return!1;for(t=0;t<n.length;t++)if(!la(s[n[t]],e[n[t]]))return!1}return!0}var Xa;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(Xa||(Xa={}));var cd;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(cd||(cd={}));var qa;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(qa||(qa={}));var wl;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(wl||(wl={}));class UT{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&la(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class IL{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function QNe(s){return!!s&&typeof s.read=="function"}class F5{constructor(e,t,i,n,o,r){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=o,this._isTracked=r}}class JNe{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class eRe{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function zoe(s){return!s.isTooLargeForSyncing()&&!s.isForSimpleWidget}class Qs{static addCursorDown(e,t,i){const n=[];let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];n[o++]=new si(l.modelState,l.viewState),i?n[o++]=si.fromModelState(bi.translateDown(e.cursorConfig,e.model,l.modelState)):n[o++]=si.fromViewState(bi.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){const n=[];let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];n[o++]=new si(l.modelState,l.viewState),i?n[o++]=si.fromModelState(bi.translateUp(e.cursorConfig,e.model,l.modelState)):n[o++]=si.fromViewState(bi.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];n[o]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,o=t.modelState.position.column,r=n===o,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!r&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return si.fromViewState(bi.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return si.fromModelState(bi.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=this._moveToLineEnd(e,l,i,n)}return o}static _moveToLineEnd(e,t,i,n){const o=t.viewState.position,r=e.getLineMaxColumn(o.lineNumber),a=o.column===r,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),d=r-o.column===c-l.column;return a||d?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return si.fromViewState(bi.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return si.fromModelState(bi.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const r=t[n],a=r.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=r.modelState.selection.endLineNumber,d;c===l?d=e.model.getLineMaxColumn(l):(c++,d=1),i[n]=si.fromModelState(new Js(new D(a,1,a,1),0,0,new z(c,d),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];n[o]=si.fromModelState(bi.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];n[o]=si.fromModelState(bi.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return si.fromModelState(new Js(new D(1,1,1,1),0,0,new z(i,n),0))}static line(e,t,i,n,o){const r=e.model.validatePosition(n),a=o?e.coordinatesConverter.validateViewPosition(new z(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);if(!i){const c=e.model.getLineCount();let d=r.lineNumber+1,h=1;return d>c&&(d=c,h=e.model.getLineMaxColumn(d)),si.fromModelState(new Js(new D(r.lineNumber,1,d,h),2,0,new z(d,h),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(r.lineNumber<l)return si.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(r.lineNumber>l){const c=e.getLineCount();let d=a.lineNumber+1,h=1;return d>c&&(d=c,h=e.getLineMaxColumn(d)),si.fromViewState(t.viewState.move(!0,d,h,0))}else{const c=t.modelState.selectionStart.getEndPosition();return si.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,n){const o=e.model.validatePosition(n);return si.fromModelState(vi.word(e.cursorConfig,e.model,t.modelState,i,o))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new si(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return si.fromViewState(new Js(new D(i,n,i,n),0,0,new z(i,n),0))}static moveTo(e,t,i,n,o){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,o)}const r=e.model.validatePosition(n),a=o?e.coordinatesConverter.validateViewPosition(new z(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);return si.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,o,r){switch(i){case 0:return r===4?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,o);case 1:return r===4?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,o);case 2:return r===2?this._moveUpByViewLines(e,t,n,o):this._moveUpByModelLines(e,t,n,o);case 3:return r===2?this._moveDownByViewLines(e,t,n,o):this._moveDownByModelLines(e,t,n,o);case 4:return r===2?t.map(a=>si.fromViewState(bi.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>si.fromModelState(bi.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 5:return r===2?t.map(a=>si.fromViewState(bi.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>si.fromModelState(bi.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,o){const r=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(r);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,o),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,o),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 14:{const l=[];for(let c=0,d=t.length;c<d;c++){const h=t[c];l[c]=this.findPositionInViewportIfOutside(e,h,r,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const o=t.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new si(t.modelState,t.viewState);{let r;o>i.endLineNumber-1?r=i.endLineNumber-1:o<i.startLineNumber?r=i.startLineNumber:r=o;const a=bi.vertical(e.cursorConfig,e,o,t.viewState.position.column,t.viewState.leftoverVisibleColumns,r,!1);return si.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(o=>{const a=e.getTextDirection(o.viewState.position.lineNumber)===qa.RTL;return si.fromViewState(a?bi.moveRight(e.cursorConfig,e,o.viewState,i,n):bi.moveLeft(e.cursorConfig,e,o.viewState,i,n))})}static _moveHalfLineLeft(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[o]=si.fromViewState(bi.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveRight(e,t,i,n){return t.map(o=>{const a=e.getTextDirection(o.viewState.position.lineNumber)===qa.RTL;return si.fromViewState(a?bi.moveLeft(e.cursorConfig,e,o.viewState,i,n):bi.moveRight(e.cursorConfig,e,o.viewState,i,n))})}static _moveHalfLineRight(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[o]=si.fromViewState(bi.moveRight(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveDownByViewLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=si.fromViewState(bi.moveDown(e.cursorConfig,e,l.viewState,i,n))}return o}static _moveDownByModelLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=si.fromModelState(bi.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return o}static _moveUpByViewLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=si.fromViewState(bi.moveUp(e.cursorConfig,e,l.viewState,i,n))}return o}static _moveUpByModelLines(e,t,i,n){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=si.fromModelState(bi.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return o}static _moveToViewPosition(e,t,i,n,o){return si.fromViewState(t.viewState.move(i,n,o,0))}static _moveToModelPosition(e,t,i,n,o){return si.fromModelState(t.modelState.move(i,n,o,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);n[o]=this._moveToViewPosition(e,a,i,l,c)}return n}}var sR;(function(s){const e=function(i){if(!ws(i))return!1;const n=i;return!(!As(n.to)||!Mo(n.select)&&!C9(n.select)||!Mo(n.by)&&!As(n.by)||!Mo(n.value)&&!af(n.value)||!Mo(n.noHistory)&&!C9(n.noHistory))};s.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
					* 'noHistory': If 'true' does not add the movement to navigation history. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1},noHistory:{type:"boolean",default:!1}}}}]},s.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let n;switch(i.to){case s.RawDirection.Left:n=0;break;case s.RawDirection.Right:n=1;break;case s.RawDirection.Up:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.PrevBlankLine:n=4;break;case s.RawDirection.NextBlankLine:n=5;break;case s.RawDirection.WrappedLineStart:n=6;break;case s.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case s.RawDirection.WrappedLineColumnCenter:n=8;break;case s.RawDirection.WrappedLineEnd:n=9;break;case s.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case s.RawDirection.ViewPortTop:n=11;break;case s.RawDirection.ViewPortBottom:n=13;break;case s.RawDirection.ViewPortCenter:n=12;break;case s.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let o=0;switch(i.by){case s.RawUnit.Line:o=1;break;case s.RawUnit.WrappedLine:o=2;break;case s.RawUnit.Character:o=3;break;case s.RawUnit.HalfLine:o=4;break}return{direction:n,unit:o,select:!!i.select,value:i.value||1,noHistory:!!i.noHistory}}s.parse=t})(sR||(sR={}));var us;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(us||(us={}));class B5{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class tRe{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)A0(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),A0(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),A0(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),A0(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&A0(this.autoClosingPairsCloseSingleChar,t.close,t)}}function A0(s,e,t){s.has(e)?s.get(e).push(t):s.set(e,[t])}const oR="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function iRe(s=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of oR)s.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const $U=iRe();function qU(s){let e=$U;if(s&&s instanceof RegExp)if(s.global)e=s;else{let t="g";s.ignoreCase&&(t+="i"),s.multiline&&(t+="m"),s.unicode&&(t+="u"),e=new RegExp(s.source,t)}return e.lastIndex=0,e}const Uoe=new Zo;Uoe.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function EL(s,e,t,i,n){if(e=qU(e),n||(n=Gt.first(Uoe)),t.length>n.maxLen){let c=s-n.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,s+n.maxLen/2),EL(s,e,t,i,n)}const o=Date.now(),r=s-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-o>=n.timeBudget);c++){const d=r-n.windowSize*c;e.lastIndex=Math.max(0,d);const h=nRe(e,t,r,a);if(!h&&l||(l=h,d<=0))break;a=d}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function nRe(s,e,t,i){let n;for(;n=s.exec(e);){const o=n.index||0;if(o<=t&&s.lastIndex>=t)return n;if(i>0&&o>i)return null}return null}const ZC=class ZC{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new B5(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new B5({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new B5({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:ZC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:ZC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};ZC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`,ZC.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;let J9=ZC,W5;function $oe(){return W5||(W5=new TextDecoder("UTF-16LE")),W5}let H5;function sRe(){return H5||(H5=new TextDecoder("UTF-16BE")),H5}let V5;function qoe(){return V5||(V5=Ise()?$oe():sRe()),V5}function oRe(s,e,t){const i=new Uint16Array(s.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?rRe(s,e,t):$oe().decode(i)}function rRe(s,e,t){const i=[];let n=0;for(let o=0;o<t;o++){const r=KDe(s,e);e+=2,i[n++]=String.fromCharCode(r)}return i.join("")}class Dm{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return qoe().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||vs(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class rR{constructor(e,t,i,n,o,r){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=o,this.reversedRegex=r,this._openSet=rR._toSet(this.open),this._closeSet=rR._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function aRe(s){const e=s.length;s=s.map(r=>[r[0].toLowerCase(),r[1].toLowerCase()]);const t=[];for(let r=0;r<e;r++)t[r]=r;const i=(r,a)=>{const[l,c]=r,[d,h]=a;return l===d||l===h||c===d||c===h},n=(r,a)=>{const l=Math.min(r,a),c=Math.max(r,a);for(let d=0;d<e;d++)t[d]===c&&(t[d]=l)};for(let r=0;r<e;r++){const a=s[r];for(let l=r+1;l<e;l++){const c=s[l];i(a,c)&&n(t[r],t[l])}}const o=[];for(let r=0;r<e;r++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===r){const[d,h]=s[c];a.push(d),l.push(h)}a.length>0&&o.push({open:a,close:l})}return o}class lRe{constructor(e,t){this._richEditBracketsBrand=void 0;const i=aRe(t);this.brackets=i.map((n,o)=>new rR(e,o,n.open,n.close,cRe(n.open,n.close,i,o),dRe(n.open,n.close,i,o))),this.forwardRegex=hRe(this.brackets),this.reversedRegex=uRe(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const o of n.open)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(const o of n.close)this.textIsBracket[o]=n,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}}function joe(s,e,t,i){for(let n=0,o=e.length;n<o;n++){if(n===t)continue;const r=e[n];for(const a of r.open)a.indexOf(s)>=0&&i.push(a);for(const a of r.close)a.indexOf(s)>=0&&i.push(a)}}function Koe(s,e){return s.length-e.length}function FO(s){if(s.length<=1)return s;const e=[],t=new Set;for(const i of s)t.has(i)||(e.push(i),t.add(i));return e}function cRe(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let o=0,r=n.length;o<r;o++)joe(n[o],t,i,n);return n=FO(n),n.sort(Koe),n.reverse(),gk(n)}function dRe(s,e,t,i){let n=[];n=n.concat(s),n=n.concat(e);for(let o=0,r=n.length;o<r;o++)joe(n[o],t,i,n);return n=FO(n),n.sort(Koe),n.reverse(),gk(n.map(jU))}function hRe(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=FO(e),gk(e)}function uRe(s){let e=[];for(const t of s){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=FO(e),gk(e.map(jU))}function fRe(s){const e=/^[\w ]+$/.test(s);return s=ua(s),e?`\\b${s}\\b`:s}function gk(s,e){const t=`(${s.map(fRe).join(")|(")})`;return Bse(t,!0,e)}const jU=(function(){function s(i){const n=new Uint16Array(i.length);let o=0;for(let r=i.length-1;r>=0;r--)n[o++]=i.charCodeAt(r);return qoe().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=s(e)),t}})();class Yl{static _findPrevBracketInText(e,t,i,n){const o=i.match(e);if(!o)return null;const r=i.length-(o.index||0),a=o[0].length,l=n+r;return new D(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,o){const a=jU(i).substring(i.length-o,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){const o=i.match(e);if(!o)return null;const r=o.index||0,a=o[0].length;if(a===0)return null;const l=n+r;return new D(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,o){const r=i.substring(n,o);return this.findNextBracketInText(e,t,r,n)}}class gRe{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const n=i.charAt(i.length-1);e.push(n)}return uf(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const n=t.findTokenIndexAtOffset(i-1);if(Rd(t.getStandardTokenType(n)))return null;const o=this._richEditBrackets.reversedRegex,r=t.getLineContent().substring(0,i-1)+e,a=Yl.findPrevBracketInRange(o,1,r,0,r.length);if(!a)return null;const l=r.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const d=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(d)?{matchOpenBracket:l}:null}}function lD(s){return s.global&&(s.lastIndex=0),!0}class mRe{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&lD(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&lD(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&lD(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&lD(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class LC{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=LC._createOpenBracketRegExp(t[0]),n=LC._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let o=0,r=this._regExpRules.length;o<r;o++){const a=this._regExpRules[o];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let o=0,r=this._brackets.length;o<r;o++){const a=this._brackets[o];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:us.IndentOutdent}}if(e>=2&&i.length>0){for(let o=0,r=this._brackets.length;o<r;o++)if(this._brackets[o].openRegExp.test(i))return{indentAction:us.Indent}}return null}static _createOpenBracketRegExp(e){let t=ua(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",LC._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=ua(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,LC._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return _t(t),null}}}const xt=Mt("configurationService");function eB(s,e){const t=Object.create(null);for(const i in s)Goe(t,i,s[i],e);return t}function Goe(s,e,t,i){const n=e.split("."),o=n.pop();let r=s;for(let a=0;a<n.length;a++){const l=n[a];let c=r[l];switch(typeof c){case"undefined":c=r[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}r=c}if(typeof r=="object"&&r!==null)try{r[o]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(r)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(r)}`)}function pRe(s,e){const t=e.split(".");Yoe(s,t)}function Yoe(s,e){if(!s)return;const t=e.shift();if(e.length===0){delete s[t];return}if(Object.keys(s).indexOf(t)!==-1){const i=s[t];typeof i=="object"&&!Array.isArray(i)&&(Yoe(i,e),Object.keys(i).length===0&&delete s[t])}}function yY(s,e,t){function i(r,a){let l=r;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=e.split("."),o=i(s,n);return typeof o>"u"?t:o}function _Re(s){return s.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}const Wn=Mt("languageService");class Zd{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const Xoe=[];function Vt(s,e,t){e instanceof Zd||(e=new Zd(e,[],!!t)),Xoe.push([s,e])}function SY(){return Xoe}const Un=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),BO={JSONContribution:"base.contributions.json"};function bRe(s){return s.length>0&&s.charAt(s.length-1)==="#"?s.substring(0,s.length-1):s}class vRe extends K{constructor(){super(...arguments),this.schemasById={},this._onDidChangeSchema=this._register(new q)}registerSchema(e,t,i){const n=bRe(e);this.schemasById[n]=t,this._onDidChangeSchema.fire(e),i&&i.add(Ve(()=>{delete this.schemasById[n],this._onDidChangeSchema.fire(e)}))}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const CRe=new vRe;kn.add(BO.JSONContribution,CRe);let Ia;const z5=globalThis.vscode;if(typeof z5<"u"&&typeof z5.context<"u"){const s=z5.context.configuration();if(s)Ia=s.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Ia=globalThis._VSCODE_PRODUCT_JSON,$N.VSCODE_DEV&&Object.assign(Ia,{nameShort:`${Ia.nameShort} Dev`,nameLong:`${Ia.nameLong} Dev`,dataFolderName:`${Ia.dataFolderName}-dev`,serverDataFolderName:Ia.serverDataFolderName?`${Ia.serverDataFolderName}-dev`:void 0}),!Ia.version){const s=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Ia,{version:s.version})}}else Ia={},Object.keys(Ia).length===0&&Object.assign(Ia,{version:"1.104.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var $T=Ia;const vd={Configuration:"base.contributions.configuration"},cD="vscode://schemas/settings/resourceLanguage",xY=kn.as(BO.JSONContribution);class wRe extends K{constructor(){super(),this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=this._register(new q),this._onDidUpdateConfiguration=this._register(new q),this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:_(1664,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},xY.registerSchema(cD,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),xY.registerSchema(cD,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:n,source:o}of e)for(const r in n){t.add(r);const a=this.configurationDefaultsOverrides.get(r)??this.configurationDefaultsOverrides.set(r,{configurationDefaultOverrides:[]}).get(r),l=n[r];if(a.configurationDefaultOverrides.push({value:l,source:o}),_m.test(r)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(r,l,o,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(r,c,o),i.push(...aR(r))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(r,l,o,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}}this.doRegisterOverrideIdentifiers(i)}updateDefaultOverrideProperty(e,t,i){const n={section:{id:this.defaultLanguageConfigurationOverridesNode.id,title:this.defaultLanguageConfigurationOverridesNode.title,order:this.defaultLanguageConfigurationOverridesNode.order,extensionInfo:this.defaultLanguageConfigurationOverridesNode.extensionInfo},type:"object",default:t.value,description:_(1665,"Configure settings to be overridden for {0}.",_Re(e)),$ref:cD,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){const o=(n==null?void 0:n.value)||{},r=(n==null?void 0:n.source)??new Map;if(!(r instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(ws(l)&&(Mo(o[a])||ws(o[a]))){if(o[a]={...o[a]??{},...l},i)for(const d in l)r.set(`${a}.${d}`,i)}else o[a]=l,i?r.set(a,i):r.delete(a)}return{value:o,source:r}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){const o=this.configurationProperties[e],r=(n==null?void 0:n.value)??(o==null?void 0:o.defaultDefaultValue);let a=i;if(ws(t)&&(o!==void 0&&o.type==="object"||o===void 0&&(Mo(r)||ws(r)))){if(a=(n==null?void 0:n.source)??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...ws(r)?r:{},...t}}return{value:t,source:a}}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}validateAndRegisterProperties(e,t=!0,i,n,o=4,r){var c,d,h;o=vl(e.scope)?o:e.scope;const a=e.properties;if(a)for(const u in a){const f=a[u];if(f.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo},t&&xRe(u,f,i==null?void 0:i.id)){delete a[u];continue}f.source=i,f.defaultDefaultValue=a[u].default,this.updatePropertyDefaultValue(u,f),_m.test(u)?f.scope=void 0:(f.scope=vl(f.scope)?o:f.scope,f.restricted=vl(f.restricted)?!!(n!=null&&n.includes(u)):f.restricted),f.experiment?(c=f.tags)!=null&&c.some(p=>p.toLowerCase()==="onexp")||(f.tags=f.tags??[],f.tags.push("onExP")):(d=f.tags)!=null&&d.some(p=>p.toLowerCase()==="onexp")&&(console.error(`Invalid tag 'onExP' found for property '${u}'. Please use 'experiment' property instead.`),f.experiment={mode:"startup"});const g=a[u].hasOwnProperty("included")&&!a[u].included,m=(h=a[u].policy)==null?void 0:h.name;g?(this.excludedConfigurationProperties[u]=a[u],m&&(this.policyConfigurations.set(m,u),r.add(u)),delete a[u]):(r.add(u),m&&this.policyConfigurations.set(m,u),this.configurationProperties[u]=a[u],!a[u].deprecationMessage&&a[u].markdownDeprecationMessage&&(a[u].deprecationMessage=a[u].markdownDeprecationMessage))}const l=e.allOf;if(l)for(const u of l)this.validateAndRegisterProperties(u,t,i,n,o,r)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const r in n)this.updateSchema(r,n[r]);const o=i.allOf;o==null||o.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 3:break;case 7:break;case 4:break;case 5:break;case 6:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:_(1666,"Configure editor settings to be overridden for a language."),errorMessage:_(1667,"This setting does not support per-language configuration."),$ref:cD};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){_(1668,"Configure editor settings to be overridden for a language."),_(1669,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){var r;const i=(r=this.configurationDefaultsOverrides.get(e))==null?void 0:r.configurationDefaultOverrideValue;let n,o;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,o=i.source),Mo(n)&&(n=t.defaultDefaultValue,o=void 0),Mo(n)&&(n=SRe(t.type)),t.default=n,t.defaultValueSource=o}}const Zoe="\\[([^\\]]+)\\]",LY=new RegExp(Zoe,"g"),yRe=`^(${Zoe})+$`,_m=new RegExp(yRe);function aR(s){const e=[];if(_m.test(s)){let t=LY.exec(s);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=LY.exec(s)}}return uf(e)}function SRe(s){switch(Array.isArray(s)?s[0]:s){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const qT=new wRe;kn.add(vd.Configuration,qT);function xRe(s,e,t){var i,n,o,r;return s.trim()?_m.test(s)?_(1671,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",s):qT.getConfigurationProperties()[s]!==void 0&&(!t||!LRe.has(t.toLowerCase()))?_(1672,"Cannot register '{0}'. This property is already registered.",s):(i=e.policy)!=null&&i.name&&qT.getPolicyConfigurations().get((n=e.policy)==null?void 0:n.name)!==void 0?_(1673,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",s,(o=e.policy)==null?void 0:o.name,qT.getPolicyConfigurations().get((r=e.policy)==null?void 0:r.name)):null:_(1670,"Cannot register an empty property")}const LRe=new Set($T.defaultChatAgent?[$T.defaultChatAgent.extensionId,$T.defaultChatAgent.chatExtensionId].map(s=>s.toLowerCase()):[]),IRe={ModesRegistry:"editor.modesRegistry"};class ERe extends K{constructor(){super(),this._onDidChangeLanguages=this._register(new q),this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const Cw=new ERe;kn.add(IRe.ModesRegistry,Cw);const Za="plaintext",kRe=".txt";Cw.registerLanguage({id:Za,extensions:[kRe],aliases:[_(784,"Plain Text"),"text"],mimetypes:[Un.text]});kn.as(vd.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);class DRe{constructor(e,t){this.languageId=e;const i=t.brackets?IY(t.brackets):[],n=new k9(a=>{const l=new Set;return{info:new TRe(this,a,l),closing:l}}),o=new k9(a=>{const l=new Set,c=new Set;return{info:new NRe(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=n.get(a),d=o.get(l);c.closing.add(d.info),d.opening.add(c.info)}const r=t.colorizedBracketPairs?IY(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of r){const c=n.get(a),d=o.get(l);c.closing.add(d.info),d.openingColorized.add(c.info),d.opening.add(c.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){const t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return gk(t,e)}}function IY(s){return s.filter(([e,t])=>e!==""&&t!=="")}class Qoe{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class TRe extends Qoe{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class NRe extends Qoe{constructor(e,t,i,n){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=n,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var RRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},EY=function(s,e){return function(t,i){e(t,i,s)}};class U5{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const wn=Mt("languageConfigurationService");let tB=class extends K{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new ORe),this.onDidChangeEmitter=this._register(new q),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(iB));this._register(this.configurationService.onDidChangeConfiguration(n=>{const o=n.change.keys.some(a=>i.has(a)),r=n.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(o)this.configurations.clear(),this.onDidChangeEmitter.fire(new U5(void 0));else for(const a of r)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new U5(a)))})),this._register(this._registry.onDidChange(n=>{this.configurations.delete(n.languageId),this.onDidChangeEmitter.fire(new U5(n.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=MRe(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};tB=RRe([EY(0,xt),EY(1,Wn)],tB);function MRe(s,e,t,i){let n=e.getLanguageConfiguration(s);if(!n){if(!i.isRegisteredLanguageId(s))return new m1(s,{});n=new m1(s,{})}const o=ARe(n.languageId,t),r=ere([n.underlyingConfig,o]);return new m1(n.languageId,r)}const iB={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function ARe(s,e){const t=e.getValue(iB.brackets,{overrideIdentifier:s}),i=e.getValue(iB.colorizedBracketPairs,{overrideIdentifier:s});return{brackets:kY(t),colorizedBracketPairs:kY(i)}}function kY(s){if(Array.isArray(s))return s.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function Joe(s,e,t){const i=s.getLineContent(e);let n=Ui(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}class PRe{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new DY(e,t,++this._order);return this._entries.push(i),this._resolved=null,Ve(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new m1(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(DY.cmp),ere(this._entries.map(e=>e.configuration)))}}function ere(s){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of s)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class DY{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class TY{constructor(e){this.languageId=e}}class ORe extends K{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this._register(this.register(Za,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new PRe(e),this._entries.set(e,n));const o=n.register(t,i);return this._onDidChange.fire(new TY(e)),Ve(()=>{o.dispose(),this._onDidChange.fire(new TY(e))})}getLanguageConfiguration(e){const t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}}class m1{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new LC(this.underlyingConfig):null,this.comments=m1._handleComments(this.underlyingConfig),this.characterPair=new J9(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||$U,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new mRe(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new DRe(e,this.underlyingConfig)}getWordDefinition(){return qU(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new lRe(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new gRe(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new tRe(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(typeof t.lineComment=="string"?i.lineCommentToken=t.lineComment:(i.lineCommentToken=t.lineComment.comment,i.lineCommentNoIndent=t.lineComment.noIndent)),t.blockComment){const[n,o]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=o}return i}}Vt(wn,tB,1);class Do{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let o=`color: ${t[i]};`;n&1&&(o+="font-style: italic;"),n&2&&(o+="font-weight: bold;");let r="";return n&4&&(r+=" underline"),n&8&&(r+=" line-through"),r&&(o+=`text-decoration:${r};`),o}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}class Ue{static fromTo(e,t){return new Ue(e,t)}static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{const o=Math.min(e.start,t[i].start),r=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new Ue(o,r))}}static tryCreate(e,t){if(!(e>t))return new Ue(e,t)}static ofLength(e){return new Ue(0,e)}static ofStartAndLength(e,t){return new Ue(e,e+t)}static emptyAt(e){return new Ue(e,e)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new et(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new Ue(this.start+e,this.endExclusive+e)}deltaStart(e){return new Ue(this.start+e,this.endExclusive)}deltaEnd(e){return new Ue(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new Ue(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new Ue(t,i)}intersectionLength(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,i-t)}intersects(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}intersectsOrTouches(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<=i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new et(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new et(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}joinRightTouching(e){if(this.endExclusive!==e.start)throw new et(`Invalid join: ${this.toString()} and ${e.toString()}`);return new Ue(this.start,e.endExclusive)}}class KU{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const n=Math.min(e.start,this._sortedRanges[t].start),o=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new Ue(n,o))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new KU;for(const i of this._sortedRanges){const n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}const hu=class hu{static createEmpty(e,t){const i=hu.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new hu(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="";const o=new Array;for(const{text:r,metadata:a}of e)o.push(i+r.length,a),i+=r.length,n+=r;return new hu(new Uint32Array(o),n,t)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let o=0;o<n;o++)e[o<<1]=e[o+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const o=i+Math.floor((n-i)/2),r=e[o<<1];if(r===t)return o+1;r<t?i=o+1:r>t&&(n=o)}return i}constructor(e,t,i){this._lineTokensBrand=void 0,(e.length>1?e[e.length-2]:0)!==t.length&&_t(new Error("Token length and text length do not match!")),this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}getTextLength(){return this._text.length}equals(e){return e instanceof hu?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const n=t<<1,o=n+(i<<1);for(let r=n;r<o;r++)if(this._tokens[r]!==e._tokens[r])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Do.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Do.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Do.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Do.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Do.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return Do.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return hu.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new GU(this,e,t,i)}sliceZeroCopy(e){return this.sliceAndInflate(e.start,e.endExclusive,0)}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="";const o=new Array;let r=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(r,a);const c=this._tokens[(t<<1)+1];o.push(n.length,c),t++,r=a}else if(l){if(l.offset>r){n+=this._text.substring(r,l.offset);const c=this._tokens[(t<<1)+1];o.push(n.length,c),r=l.offset}n+=l.text,o.push(n.length,l.tokenMetadata),i++}else break}return new hu(new Uint32Array(o),n,this.languageIdCodec)}getTokensInRange(e){const t=new BRe,i=this.findTokenIndexAtOffset(e.start),n=this.findTokenIndexAtOffset(e.endExclusive);for(let o=i;o<=n;o++){const a=new Ue(this.getStartOffset(o),this.getEndOffset(o)).intersectionLength(e);a>0&&t.add(a,this.getMetadata(o))}return t.build()}getTokenText(e){const t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){const t=this.getCount();for(let i=0;i<t;i++)e(i)}toString(){let e="";return this.forEach(t=>{e+=`[${this.getTokenText(t)}]{${this.getClassName(t)}}`}),e}};hu.defaultTokenMetadata=(32768|2<<24)>>>0;let qn=hu;class GU{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let o=this._firstTokenIndex,r=e.getCount();o<r&&!(e.getStartOffset(o)>=i);o++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof GU?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){const t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t);let o=this._source.getTokenText(t);return i<this._startOffset&&(o=o.substring(this._startOffset-i)),n>this._endOffset&&(o=o.substring(0,o.length-(n-this._endOffset))),o}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}function FRe(s,e){const t=e.lineNumber;if(!s.tokenization.isCheapToTokenize(t))return;s.tokenization.forceTokenization(t);const i=s.tokenization.getLineTokens(t),n=i.findTokenIndexAtOffset(e.column-1);return i.getStandardTokenType(n)}class Zu{static fromLineTokens(e){const t=[];for(let i=0;i<e.getCount();i++)t.push(new nB(e.getEndOffset(i)-e.getStartOffset(i),e.getMetadata(i)));return Zu.create(t)}static create(e){return new Zu(e)}constructor(e){this._tokenInfo=e}toLineTokens(e,t){return qn.createFromTextAndMetadata(this.map((i,n)=>({text:i.substring(e),metadata:n.metadata})),t)}forEach(e){let t=0;for(const i of this._tokenInfo){const n=new Ue(t,t+i.length);e(n,i),t+=i.length}}map(e){const t=[];let i=0;for(const n of this._tokenInfo){const o=new Ue(i,i+n.length);t.push(e(o,n)),i+=n.length}return t}slice(e){const t=[];let i=0;for(const n of this._tokenInfo){const o=i,r=o+n.length;if(r>e.start){if(o>=e.endExclusive)break;const a=Math.max(0,e.start-o),l=Math.max(0,r-e.endExclusive);t.push(new nB(n.length-a-l,n.metadata))}i+=n.length}return Zu.create(t)}}class nB{constructor(e,t){this.length=e,this.metadata=t}}class BRe{constructor(){this._tokens=[]}add(e,t){this._tokens.push(new nB(e,t))}build(){return Zu.create(this._tokens)}}class YU{constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new tre(e,i)}shouldIncrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}}class XU{constructor(e,t){this.model=e,this.indentationLineProcessor=new tre(e,t)}getProcessedTokenContextAroundRange(e){const t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);const t=this.model.tokenization.getLineTokens(e.startLineNumber),i=jp(t,e.startColumn-1);let n;if(ZU(this.model,e.getStartPosition())){const r=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+r;n=t.sliceAndInflate(a,l,0)}else{const r=e.startColumn-1;n=t.sliceAndInflate(0,r,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){const t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);const i=this.model.tokenization.getLineTokens(t.lineNumber),n=jp(i,t.column-1),o=t.column-1-n.firstCharOffset,r=n.firstCharOffset+o,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(r,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){const t=f=>{this.model.tokenization.forceTokenization(f);const g=this.model.tokenization.getLineTokens(f),m=this.model.getLineMaxColumn(f)-1;return jp(g,m)};this.model.tokenization.forceTokenization(e.startLineNumber);const i=this.model.tokenization.getLineTokens(e.startLineNumber),n=jp(i,e.startColumn-1),o=qn.createEmpty("",n.languageIdCodec),r=e.startLineNumber-1;if(r===0||!(n.firstCharOffset===0))return o;const c=t(r);if(!(n.languageId===c.languageId))return o;const h=c.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(h)}}class tre{constructor(e,t){this.model=e,this.languageConfigurationService=t}getProcessedLine(e,t){var r,a;const i=(l,c)=>{const d=Ui(l);return c+l.substring(d.length)};(a=(r=this.model.tokenization).forceTokenization)==null||a.call(r,e);const n=this.model.tokenization.getLineTokens(e);let o=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(o=i(o,t)),o}getProcessedTokens(e){const t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),r=[];return e.forEach(l=>{const c=e.getStandardTokenType(l);let d=e.getTokenText(l);t(c)&&(d=d.replace(o,""));const h=e.getMetadata(l);r.push({text:d,metadata:h})}),qn.createFromTextAndMetadata(r,e.languageIdCodec)}}function ZU(s,e){s.tokenization.forceTokenization(e.lineNumber);const t=s.tokenization.getLineTokens(e.lineNumber),i=jp(t,e.column-1),n=i.firstCharOffset===0,o=t.getLanguageId(0)===i.languageId;return!n&&!o}function p1(s,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);const n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),o=i.getLanguageConfiguration(n);if(!o)return null;const a=new XU(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),c=a.beforeRangeProcessedTokens.getLineContent(),d=a.afterRangeProcessedTokens.getLineContent(),h=o.onEnter(s,l,c,d);if(!h)return null;const u=h.indentAction;let f=h.appendText;const g=h.removeText||0;f?u===us.Indent&&(f="	"+f):u===us.Indent||u===us.IndentOutdent?f="	":f="";let m=Joe(e,t.startLineNumber,t.startColumn);return g&&(m=m.substring(0,m.length-g)),{indentAction:u,appendText:f,removeText:g,indentation:m}}var WRe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},HRe=function(s,e){return function(t,i){e(t,i,s)}},jT;const $5=Object.create(null);function Bm(s,e){if(e<=0)return"";$5[s]||($5[s]=["",s]);const t=$5[s];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+s;return t[e]}let Wl=jT=class{static unshiftIndent(e,t,i,n,o){const r=Ln.visibleColumnFromColumn(e,t,i);if(o){const a=Bm(" ",n),c=Ln.prevIndentTabStop(r,n)/n;return Bm(a,c)}else{const c=Ln.prevRenderTabStop(r,i)/i;return Bm("	",c)}}static shiftIndent(e,t,i,n,o){const r=Ln.visibleColumnFromColumn(e,t,i);if(o){const a=Bm(" ",n),c=Ln.nextIndentTabStop(r,n)/n;return Bm(a,c)}else{const c=Ln.nextRenderTabStop(r,i)/i;return Bm("	",c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);const{tabSize:o,indentSize:r,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,d=0;for(let h=i;h<=n;h++,c=d){d=0;const u=e.getLineContent(h);let f=Jo(u);if(this._opts.isUnshift&&(u.length===0||f===0)||!l&&!this._opts.isUnshift&&u.length===0)continue;if(f===-1&&(f=u.length),h>1&&Ln.visibleColumnFromColumn(u,f+1,o)%r!==0&&e.tokenization.isCheapToTokenize(h-1)){const p=p1(this._opts.autoIndent,e,new D(h-1,e.getLineMaxColumn(h-1),h-1,e.getLineMaxColumn(h-1)),this._languageConfigurationService);if(p){if(d=c,p.appendText)for(let v=0,b=p.appendText.length;v<b&&d<r&&p.appendText.charCodeAt(v)===32;v++)d++;p.removeText&&(d=Math.max(0,d-p.removeText));for(let v=0;v<d&&!(f===0||u.charCodeAt(f-1)!==32);v++)f--}}if(this._opts.isUnshift&&f===0)continue;let g;this._opts.isUnshift?g=jT.unshiftIndent(u,f+1,o,r,a):g=jT.shiftIndent(u,f+1,o,r,a),this._addEditOperation(t,new D(h,1,h,f+1),g),h===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=f+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?Bm(" ",r):"	";for(let d=i;d<=n;d++){const h=e.getLineContent(d);let u=Jo(h);if(!(this._opts.isUnshift&&(h.length===0||u===0))&&!(!l&&!this._opts.isUnshift&&h.length===0)&&(u===-1&&(u=h.length),!(this._opts.isUnshift&&u===0)))if(this._opts.isUnshift){u=Math.min(u,r);for(let f=0;f<u;f++)if(h.charCodeAt(f)===9){u=f+1;break}this._addEditOperation(t,new D(d,1,d,u+1),"")}else this._addEditOperation(t,new D(d,1,d,1),c),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const n=t.getInverseEditOperations()[0];return new Oe(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new Oe(i.startLineNumber,n,i.endLineNumber,i.endColumn):new Oe(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};Wl=jT=WRe([HRe(2,wn)],Wl);class VRe{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new D(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new D(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection||null)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,o=i[1].range;return new Oe(n.endLineNumber,n.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}}class zRe{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new D(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new Oe(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}function URe(s,e,t){const i=s.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,o=-1;for(n=e-1;n>=1;n--){if(s.tokenization.getLanguageIdAtPosition(n,0)!==i)return o;const r=s.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(r)||r===""){o=n;continue}return n}}return-1}function kL(s,e,t,i=!0,n){if(s<4)return null;const o=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;const r=new YU(e,o,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const a=URe(e,t,r);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(r.shouldIncrease(a)||r.shouldIndentNextLine(a)){const l=e.getLineContent(a);return{indentation:Ui(l),action:us.Indent,line:a}}else if(r.shouldDecrease(a)){const l=e.getLineContent(a);return{indentation:Ui(l),action:null,line:a}}else{if(a===1)return{indentation:Ui(e.getLineContent(a)),action:null,line:a};const l=a-1,c=o.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let d=0;for(let h=l-1;h>0;h--)if(!r.shouldIndentNextLine(h)){d=h;break}return{indentation:Ui(e.getLineContent(d+1)),action:null,line:d+1}}if(i)return{indentation:Ui(e.getLineContent(a)),action:null,line:a};for(let d=a;d>0;d--){if(r.shouldIncrease(d))return{indentation:Ui(e.getLineContent(d)),action:us.Indent,line:d};if(r.shouldIndentNextLine(d)){let h=0;for(let u=d-1;u>0;u--)if(!r.shouldIndentNextLine(d)){h=u;break}return{indentation:Ui(e.getLineContent(h+1)),action:null,line:h+1}}else if(r.shouldDecrease(d))return{indentation:Ui(e.getLineContent(d)),action:null,line:d}}return{indentation:Ui(e.getLineContent(1)),action:null,line:1}}}function $S(s,e,t,i,n,o){if(s<4)return null;const r=o.getLanguageConfiguration(t);if(!r)return null;const a=o.getLanguageConfiguration(t).indentRulesSupport;if(!a)return null;const l=new YU(e,a,o),c=kL(s,e,i,void 0,o);if(c){const d=c.line;if(d!==void 0){let h=!0;for(let u=d;u<i-1;u++)if(!/^\s*$/.test(e.getLineContent(u))){h=!1;break}if(h){const u=r.onEnter(s,"",e.getLineContent(d),"");if(u){let f=Ui(e.getLineContent(d));return u.removeText&&(f=f.substring(0,f.length-u.removeText)),u.indentAction===us.Indent||u.indentAction===us.IndentOutdent?f=n.shiftIndent(f):u.indentAction===us.Outdent&&(f=n.unshiftIndent(f)),l.shouldDecrease(i)&&(f=n.unshiftIndent(f)),u.appendText&&(f+=u.appendText),Ui(f)}}}return l.shouldDecrease(i)?c.action===us.Indent?c.indentation:n.unshiftIndent(c.indentation):c.action===us.Indent?n.shiftIndent(c.indentation):c.indentation}return null}function $Re(s,e,t,i,n){if(s<4)return null;const o=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(o).indentRulesSupport;if(!r)return null;e.tokenization.forceTokenization(t.startLineNumber);const l=new XU(e,n).getProcessedTokenContextAroundRange(t),c=l.afterRangeProcessedTokens,d=l.beforeRangeProcessedTokens,h=Ui(d.getLineContent()),u=jRe(e,t.startLineNumber,d),f=ZU(e,t.getStartPosition()),g=e.getLineContent(t.startLineNumber),m=Ui(g),p=kL(s,u,t.startLineNumber+1,void 0,n);if(!p){const b=f?m:h;return{beforeEnter:b,afterEnter:b}}let v=f?m:p.indentation;return p.action===us.Indent&&(v=i.shiftIndent(v)),r.shouldDecrease(c.getLineContent())&&(v=i.unshiftIndent(v)),{beforeEnter:f?m:h,afterEnter:v}}function qRe(s,e,t,i,n,o){const r=s.autoIndent;if(r<4||ZU(e,t.getStartPosition()))return null;const l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),c=o.getLanguageConfiguration(l).indentRulesSupport;if(!c)return null;const h=new XU(e,o).getProcessedTokenContextAroundRange(t),u=h.beforeRangeProcessedTokens.getLineContent(),f=h.afterRangeProcessedTokens.getLineContent(),g=u+f,m=u+i+f;if(!c.shouldDecrease(g)&&c.shouldDecrease(m)){const v=kL(r,e,t.startLineNumber,!1,o);if(!v)return null;let b=v.indentation;return v.action!==us.Indent&&(b=n.unshiftIndent(b)),b}const p=t.startLineNumber-1;if(p>0){const v=e.getLineContent(p);if(c.shouldIndentNextLine(v)&&c.shouldIncrease(m)){const b=kL(r,e,t.startLineNumber,!1,o),w=b==null?void 0:b.indentation;if(w!==void 0){const C=e.getLineContent(t.startLineNumber),y=Ui(C),S=n.shiftIndent(w)===y,L=/^\s*$/.test(g),E=s.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),R=E&&E.length>0&&L;if(S&&R)return w}}}return null}function ire(s,e,t){const i=t.getLanguageConfiguration(s.getLanguageId()).indentRulesSupport;return!i||e<1||e>s.getLineCount()?null:i.getIndentMetadata(s.getLineContent(e))}function jRe(s,e,t){return{tokenization:{getLineTokens:n=>n===e?t:s.tokenization.getLineTokens(n),getLanguageId:()=>s.getLanguageId(),getLanguageIdAtPosition:(n,o)=>s.getLanguageIdAtPosition(n,o)},getLineContent:n=>n===e?t.getLineContent():s.getLineContent(n)}}class KRe{static getEdits(e,t,i,n,o){if(!o&&this._isAutoIndentType(e,t,i)){const r=[];for(const l of i){const c=this._findActualIndentationForSelection(e,t,l,n);if(c===null)return;r.push({selection:l,indentation:c})}const a=sB.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,r,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,o=i.length;n<o;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){const o=qRe(e,t,i,n,{shiftIndent:a=>e$(e,a),unshiftIndent:a=>lR(e,a)},e.languageConfigurationService);if(o===null)return null;const r=Joe(t,i.startLineNumber,i.startColumn);return o===e.normalizeIndentation(r)?null:o}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,o){const r=i.map(({selection:l,indentation:c})=>{if(o!==null){const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!1);return new s2e(d,l,n,o)}else{const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!0);return ip(d.range,d.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Cr(4,r,a)}static _getEditFromIndentationAndSelection(e,t,i,n,o,r=!0){const a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a);let c=e.normalizeIndentation(i);if(l!==0){const h=t.getLineContent(a);c+=h.substring(l-1,n.startColumn-1)}return c+=r?o:"",{range:new D(a,1,n.endLineNumber,n.endColumn),text:c}}}class GRe{static getEdits(e,t,i,n,o,r){if(nre(t,i,n,o,r))return this._runAutoClosingOvertype(e,n,r)}static _runAutoClosingOvertype(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const l=t[o].getPosition(),c=new D(l.lineNumber,l.column,l.lineNumber,l.column+1);n[o]=new vo(c,i)}return new Cr(4,n,{shouldPushStackElementBefore:HO(e,4),shouldPushStackElementAfter:!1})}}class YRe{static getEdits(e,t,i,n,o){if(nre(e,t,i,n,o)){const r=i.map(a=>new vo(new D(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Cr(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class sB{static getEdits(e,t,i,n,o,r){if(!r){const a=this.getAutoClosingPairClose(e,t,i,n,o);if(a!==null)return this._runAutoClosingOpenCharType(i,n,o,a)}}static _runAutoClosingOpenCharType(e,t,i,n){const o=[];for(let r=0,a=e.length;r<a;r++){const l=e[r];o[r]=new n2e(l,t,!i,n)}return new Cr(4,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,o){for(const g of i)if(!g.isEmpty())return null;const r=i.map(g=>{const m=g.getPosition();return o?{lineNumber:m.lineNumber,beforeColumn:m.column-n.length,afterColumn:m.column}:{lineNumber:m.lineNumber,beforeColumn:m.column,afterColumn:m.column}}),a=this._findAutoClosingPairOpen(e,t,r.map(g=>new z(g.lineNumber,g.beforeColumn)),n);if(!a)return null;let l,c;if(pm(n)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const h=this._findContainedAutoClosingPair(e,a),u=h?h.close:"";let f=!0;for(const g of r){const{lineNumber:m,beforeColumn:p,afterColumn:v}=g,b=t.getLineContent(m),w=b.substring(0,p-1),C=b.substring(v-1);if(C.startsWith(u)||(f=!1),C.length>0){const L=C.charAt(0);if(!this._isBeforeClosingBrace(e,C)&&!c(L))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){const L=Bl(e.wordSeparators,[]);if(w.length>0){const E=w.charCodeAt(w.length-1);if(L.get(E)===0)return null}}if(!t.tokenization.isCheapToTokenize(m))return null;t.tokenization.forceTokenization(m);const y=t.tokenization.getLineTokens(m),x=jp(y,p-1);if(!a.shouldAutoClose(x,p-x.firstCharOffset))return null;const S=a.findNeutralCharacter();if(S){const L=t.tokenization.getTokenTypeIfInsertingCharacter(m,p,S);if(!a.isOK(L))return null}}return f?a.close.substring(0,a.close.length-u.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let o=null;for(const r of n)r.open!==t.open&&t.open.includes(r.open)&&t.close.endsWith(r.close)&&(!o||r.open.length>o.open.length)&&(o=r);return o}static _findAutoClosingPairOpen(e,t,i,n){const o=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!o)return null;let r=null;for(const a of o)if(r===null||a.open.length>r.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new D(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+n!==a.open){l=!1;break}l&&(r=a)}return r}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],r=n.some(l=>t.startsWith(l.open)),a=o.some(l=>t.startsWith(l.close));return!r&&a}}class NY{static getEdits(e,t){if(!(e.inputMode==="overtype"))return null;const n=t.map(o=>new YNe(o.insertedTextRange));return new Cr(4,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}class XRe{static getEdits(e,t,i,n,o){if(!o&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=e.surroundingPairs[i];n[o]=new VRe(a,i,l)}return new Cr(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!sre(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const o=pm(n);for(const r of i){if(r.isEmpty())return!1;let a=!0;for(let l=r.startLineNumber;l<=r.endLineNumber;l++){const c=t.getLineContent(l),d=l===r.startLineNumber?r.startColumn-1:0,h=l===r.endLineNumber?r.endColumn-1:c.length,u=c.substring(d,h);if(/[^ \t]/.test(u)){a=!1;break}}if(a)return!1;if(o&&r.startLineNumber===r.endLineNumber&&r.startColumn+1===r.endColumn){const l=t.getValueInRange(r);if(pm(l))return!1}}return!0}}class ZRe{static getEdits(e,t,i,n,o,r){if(!r&&this._isTypeInterceptorElectricChar(t,i,n)){const a=this._typeInterceptorElectricChar(e,t,i,n[0],o);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,o){if(!t.electricChars.hasOwnProperty(o)||!n.isEmpty())return null;const r=n.getPosition();i.tokenization.forceTokenization(r.lineNumber);const a=i.tokenization.getLineTokens(r.lineNumber);let l;try{l=t.onElectricCharacter(o,a,r.column)}catch(c){return _t(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,d=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:r.lineNumber,column:c},500);if(d){if(d.startLineNumber===r.lineNumber)return null;const h=i.getLineContent(d.startLineNumber),u=Ui(h),f=t.normalizeIndentation(u),g=i.getLineContent(r.lineNumber),m=i.getLineFirstNonWhitespaceColumn(r.lineNumber)||r.column,p=g.substring(m-1,r.column-1),v=f+p+o,b=new D(r.lineNumber,1,r.lineNumber,r.column),w=new vo(b,v);return new Cr(JU(v,e),[w],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class QRe{static getEdits(e,t,i,n,o){const r=[];for(let l=0,c=i.length;l<c;l++){const d=e.inputMode==="overtype"&&!o?Z9:vo;r[l]=new d(i[l],n)}const a=JU(n,t);return new Cr(a,r,{shouldPushStackElementBefore:HO(t,a),shouldPushStackElementAfter:!1})}}class WO{static getEdits(e,t,i,n,o){if(!o&&n===`
`){const r=[];for(let a=0,l=i.length;a<l;a++)r[a]=this._enter(e,t,!1,i[a]);return new Cr(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return ip(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(n.startLineNumber),c=Ui(l).substring(0,n.startColumn-1);return ip(n,`
`+e.normalizeIndentation(c),i)}const o=p1(e.autoIndent,t,n,e.languageConfigurationService);if(o){if(o.indentAction===us.None)return ip(n,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===us.Indent)return ip(n,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===us.IndentOutdent){const l=e.normalizeIndentation(o.indentation),c=e.normalizeIndentation(o.indentation+o.appendText),d=`
`+c+`
`+l;return i?new zT(n,d,!0):new tR(n,d,-1,c.length-l.length,!0)}else if(o.indentAction===us.Outdent){const l=lR(e,o.indentation);return ip(n,`
`+e.normalizeIndentation(l+o.appendText),i)}}const r=t.getLineContent(n.startLineNumber),a=Ui(r).substring(0,n.startColumn-1);if(e.autoIndent>=4){const l=$Re(e.autoIndent,t,n,{unshiftIndent:c=>lR(e,c),shiftIndent:c=>e$(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,n.getEndPosition());const d=n.endColumn,h=t.getLineContent(n.endLineNumber),u=Jo(h);if(u>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,u+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new zT(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let f=0;return d<=u+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),f=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new tR(n,`
`+e.normalizeIndentation(l.afterEnter),0,f,!0)}}}return ip(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const n=[];for(let o=0,r=i.length;o<r;o++){let a=i[o].positionLineNumber;if(a===1)n[o]=new zT(new D(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);n[o]=this._enter(e,t,!1,new D(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const n=[];for(let o=0,r=i.length;o<r;o++){const a=i[o].positionLineNumber,l=t.getLineMaxColumn(a);n[o]=this._enter(e,t,!1,new D(a,l,a,l))}return n}static lineBreakInsert(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=this._enter(e,t,!0,i[o]);return n}}class JRe{static getEdits(e,t,i,n,o,r){const a=this._distributePasteToCursors(e,i,n,o,r);return a?(i=i.sort(D.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,o)}static _distributePasteToCursors(e,t,i,n,o){if(n||t.length===1)return null;if(o&&o.length===t.length)return o;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));const r=fa(i);if(r.length===t.length)return r}return null}static _distributedPaste(e,t,i,n){const o=[];for(let r=0,a=i.length;r<a;r++){const c=e.overtypeOnPaste&&e.inputMode==="overtype"?Z9:vo;o[r]=new c(i[r],n[r])}return new Cr(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,o){const r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.getPosition();if(o&&!c.isEmpty()&&(o=!1),o&&n.indexOf(`
`)!==n.length-1&&(o=!1),o){const h=new D(d.lineNumber,1,d.lineNumber,1);r[a]=new UU(h,n,c,!0)}else{const u=e.overtypeOnPaste&&e.inputMode==="overtype"?Z9:vo;r[a]=new u(c,n)}}return new Cr(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class e2e{static getEdits(e,t,i,n,o,r,a,l){const c=n.map(d=>this._compositionType(i,d,o,r,a,l));return new Cr(4,c,{shouldPushStackElementBefore:HO(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,o,r){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-n),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+o),d=new D(a.lineNumber,l,a.lineNumber,c);return new tR(d,i,0,r)}}class t2e{static getEdits(e,t,i){const n=[];for(let r=0,a=t.length;r<a;r++)n[r]=new vo(t[r],i);const o=JU(i,e);return new Cr(o,n,{shouldPushStackElementBefore:HO(e,o),shouldPushStackElementAfter:!1})}}class i2e{static getCommands(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++){const a=i[o];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const d=e.normalizeIndentation(c);if(!l.startsWith(d)){n[o]=new vo(new D(a.startLineNumber,1,a.startLineNumber,l.length+1),d,!0);continue}}n[o]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[o]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[o]=new Wl(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,o="";const r=kL(e.autoIndent,t,i,!1,e.languageConfigurationService);if(r)n=r.action,o=r.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const d=t.getLineContent(a);if(uc(d)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=p1(e.autoIndent,t,new D(a,l,a,l),e.languageConfigurationService);c&&(o=c.indentation+c.appendText)}return n&&(n===us.Indent&&(o=e$(e,o)),n===us.Outdent&&(o=lR(e,o)),o=e.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(e,t,i,n){let o="";const r=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,r),l=e.indentSize,c=l-a%l;for(let d=0;d<c;d++)o+=" "}else o="	";return new vo(i,o,n)}}class QU extends tR{constructor(e,t,i,n,o,r){super(e,t,i,n),this._openCharacter=o,this._closeCharacter=r,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new D(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new D(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}}class n2e extends QU{constructor(e,t,i,n){const o=(i?t:"")+n,r=0,a=-n.length;super(e,o,r,a,t,n)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}}class s2e extends QU{constructor(e,t,i,n){const o=i+n,r=0,a=i.length;super(t,o,r,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:o}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");const n=i[0].range,o=i[1].range,r=n.plusRange(o);return this._computeCursorStateWithRange(e,r,t)}}function JU(s,e){return s===" "?e===5||e===6?6:5:4}function HO(s,e){return MY(s)&&!MY(e)?!0:s===5?!1:RY(s)!==RY(e)}function RY(s){return s===6||s===5?"space":s}function MY(s){return s===4||s===5||s===6}function nre(s,e,t,i,n){if(s.autoClosingOvertype==="never"||!s.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let o=0,r=t.length;o<r;o++){const a=t[o];if(!a.isEmpty())return!1;const l=a.getPosition(),c=e.getLineContent(l.lineNumber);if(c.charAt(l.column-1)!==n)return!1;const h=pm(n);if((l.column>2?c.charCodeAt(l.column-2):0)===92&&h)return!1;if(s.autoClosingOvertype==="auto"){let f=!1;for(let g=0,m=i.length;g<m;g++){const p=i[g];if(l.lineNumber===p.startLineNumber&&l.column===p.startColumn){f=!0;break}}if(!f)return!1}}return!0}function ip(s,e,t){return t?new zT(s,e,!0):new vo(s,e,!0)}function e$(s,e,t){return t=t||1,Wl.shiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function lR(s,e,t){return t=t||1,Wl.unshiftIndent(e,e.length+t,s.tabSize,s.indentSize,s.insertSpaces)}function sre(s,e){return pm(e)?s.autoSurround==="quotes"||s.autoSurround==="languageDefined":s.autoSurround==="brackets"||s.autoSurround==="languageDefined"}class ag{static indent(e,t,i){if(t===null||i===null)return[];const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new Wl(i[o],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new Wl(i[o],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static paste(e,t,i,n,o,r){return JRe.getEdits(e,t,i,n,o,r)}static tab(e,t,i){return i2e.getCommands(e,t,i)}static compositionType(e,t,i,n,o,r,a,l){return e2e.getEdits(e,t,i,n,o,r,a,l)}static compositionEndWithInterceptors(e,t,i,n,o,r){if(!n)return null;let a=null;for(const u of n)if(a===null)a=u.insertedText;else if(a!==u.insertedText)return null;if(!a||a.length!==1)return NY.getEdits(t,n);const l=a;let c=!1;for(const u of n)if(u.deletedText.length!==0){c=!0;break}if(c){if(!sre(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const u=pm(l);for(const m of n)if(m.deletedSelectionStart!==0||m.deletedSelectionEnd!==m.deletedText.length||/^[ \t]+$/.test(m.deletedText)||u&&pm(m.deletedText))return null;const f=[];for(const m of o){if(!m.isEmpty())return null;f.push(m.getPosition())}if(f.length!==n.length)return null;const g=[];for(let m=0,p=f.length;m<p;m++)g.push(new zRe(f[m],n[m].deletedText,t.surroundingPairs[l]));return new Cr(4,g,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const d=YRe.getEdits(t,i,o,r,l);if(d!==void 0)return d;const h=sB.getEdits(t,i,o,l,!0,!1);return h!==void 0?h:NY.getEdits(t,n)}static typeWithInterceptors(e,t,i,n,o,r,a){const l=WO.getEdits(i,n,o,a,e);if(l!==void 0)return l;const c=KRe.getEdits(i,n,o,a,e);if(c!==void 0)return c;const d=GRe.getEdits(t,i,n,o,r,a);if(d!==void 0)return d;const h=sB.getEdits(i,n,o,a,!1,e);if(h!==void 0)return h;const u=XRe.getEdits(i,n,o,a,e);if(u!==void 0)return u;const f=ZRe.getEdits(t,i,n,o,a,e);return f!==void 0?f:QRe.getEdits(i,t,o,a,e)}static typeWithoutInterceptors(e,t,i,n,o){return t2e.getEdits(e,n,o)}}class o2e{constructor(e,t,i,n,o,r,a){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=n,this.insertedSelectionStart=o,this.insertedSelectionEnd=r,this.insertedTextRange=a}}var B;(function(s){s.editorSimpleInput=new Ne("editorSimpleInput",!1,!0),s.editorTextFocus=new Ne("editorTextFocus",!1,_(681,"Whether the editor text has focus (cursor is blinking)")),s.focus=new Ne("editorFocus",!1,_(682,"Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),s.textInputFocus=new Ne("textInputFocus",!1,_(683,"Whether an editor or a rich text input has focus (cursor is blinking)")),s.readOnly=new Ne("editorReadonly",!1,_(684,"Whether the editor is read-only")),s.inDiffEditor=new Ne("inDiffEditor",!1,_(685,"Whether the context is a diff editor")),s.isEmbeddedDiffEditor=new Ne("isEmbeddedDiffEditor",!1,_(686,"Whether the context is an embedded diff editor")),s.inMultiDiffEditor=new Ne("inMultiDiffEditor",!1,_(687,"Whether the context is a multi diff editor")),s.multiDiffEditorAllCollapsed=new Ne("multiDiffEditorAllCollapsed",void 0,_(688,"Whether all files in multi diff editor are collapsed")),s.hasChanges=new Ne("diffEditorHasChanges",!1,_(689,"Whether the diff editor has changes")),s.comparingMovedCode=new Ne("comparingMovedCode",!1,_(690,"Whether a moved code block is selected for comparison")),s.accessibleDiffViewerVisible=new Ne("accessibleDiffViewerVisible",!1,_(691,"Whether the accessible diff viewer is visible")),s.diffEditorRenderSideBySideInlineBreakpointReached=new Ne("diffEditorRenderSideBySideInlineBreakpointReached",!1,_(692,"Whether the diff editor render side by side inline breakpoint is reached")),s.diffEditorInlineMode=new Ne("diffEditorInlineMode",!1,_(693,"Whether inline mode is active")),s.diffEditorOriginalWritable=new Ne("diffEditorOriginalWritable",!1,_(694,"Whether modified is writable in the diff editor")),s.diffEditorModifiedWritable=new Ne("diffEditorModifiedWritable",!1,_(695,"Whether modified is writable in the diff editor")),s.diffEditorOriginalUri=new Ne("diffEditorOriginalUri","",_(696,"The uri of the original document")),s.diffEditorModifiedUri=new Ne("diffEditorModifiedUri","",_(697,"The uri of the modified document")),s.columnSelection=new Ne("editorColumnSelection",!1,_(698,"Whether `editor.columnSelection` is enabled")),s.writable=s.readOnly.toNegated(),s.hasNonEmptySelection=new Ne("editorHasSelection",!1,_(699,"Whether the editor has text selected")),s.hasOnlyEmptySelection=s.hasNonEmptySelection.toNegated(),s.hasMultipleSelections=new Ne("editorHasMultipleSelections",!1,_(700,"Whether the editor has multiple selections")),s.hasSingleSelection=s.hasMultipleSelections.toNegated(),s.tabMovesFocus=new Ne("editorTabMovesFocus",!1,_(701,"Whether `Tab` will move focus out of the editor")),s.tabDoesNotMoveFocus=s.tabMovesFocus.toNegated(),s.isInEmbeddedEditor=new Ne("isInEmbeddedEditor",!1,!0),s.canUndo=new Ne("canUndo",!1,!0),s.canRedo=new Ne("canRedo",!1,!0),s.hoverVisible=new Ne("editorHoverVisible",!1,_(702,"Whether the editor hover is visible")),s.hoverFocused=new Ne("editorHoverFocused",!1,_(703,"Whether the editor hover is focused")),s.stickyScrollFocused=new Ne("stickyScrollFocused",!1,_(704,"Whether the sticky scroll is focused")),s.stickyScrollVisible=new Ne("stickyScrollVisible",!1,_(705,"Whether the sticky scroll is visible")),s.standaloneColorPickerVisible=new Ne("standaloneColorPickerVisible",!1,_(706,"Whether the standalone color picker is visible")),s.standaloneColorPickerFocused=new Ne("standaloneColorPickerFocused",!1,_(707,"Whether the standalone color picker is focused")),s.inCompositeEditor=new Ne("inCompositeEditor",void 0,_(708,"Whether the editor is part of a larger editor (e.g. notebooks)")),s.notInCompositeEditor=s.inCompositeEditor.toNegated(),s.languageId=new Ne("editorLangId","",_(709,"The language identifier of the editor")),s.hasCompletionItemProvider=new Ne("editorHasCompletionItemProvider",!1,_(710,"Whether the editor has a completion item provider")),s.hasCodeActionsProvider=new Ne("editorHasCodeActionsProvider",!1,_(711,"Whether the editor has a code actions provider")),s.hasCodeLensProvider=new Ne("editorHasCodeLensProvider",!1,_(712,"Whether the editor has a code lens provider")),s.hasDefinitionProvider=new Ne("editorHasDefinitionProvider",!1,_(713,"Whether the editor has a definition provider")),s.hasDeclarationProvider=new Ne("editorHasDeclarationProvider",!1,_(714,"Whether the editor has a declaration provider")),s.hasImplementationProvider=new Ne("editorHasImplementationProvider",!1,_(715,"Whether the editor has an implementation provider")),s.hasTypeDefinitionProvider=new Ne("editorHasTypeDefinitionProvider",!1,_(716,"Whether the editor has a type definition provider")),s.hasHoverProvider=new Ne("editorHasHoverProvider",!1,_(717,"Whether the editor has a hover provider")),s.hasDocumentHighlightProvider=new Ne("editorHasDocumentHighlightProvider",!1,_(718,"Whether the editor has a document highlight provider")),s.hasDocumentSymbolProvider=new Ne("editorHasDocumentSymbolProvider",!1,_(719,"Whether the editor has a document symbol provider")),s.hasReferenceProvider=new Ne("editorHasReferenceProvider",!1,_(720,"Whether the editor has a reference provider")),s.hasRenameProvider=new Ne("editorHasRenameProvider",!1,_(721,"Whether the editor has a rename provider")),s.hasSignatureHelpProvider=new Ne("editorHasSignatureHelpProvider",!1,_(722,"Whether the editor has a signature help provider")),s.hasInlayHintsProvider=new Ne("editorHasInlayHintsProvider",!1,_(723,"Whether the editor has an inline hints provider")),s.hasDocumentFormattingProvider=new Ne("editorHasDocumentFormattingProvider",!1,_(724,"Whether the editor has a document formatting provider")),s.hasDocumentSelectionFormattingProvider=new Ne("editorHasDocumentSelectionFormattingProvider",!1,_(725,"Whether the editor has a document selection formatting provider")),s.hasMultipleDocumentFormattingProvider=new Ne("editorHasMultipleDocumentFormattingProvider",!1,_(726,"Whether the editor has multiple document formatting providers")),s.hasMultipleDocumentSelectionFormattingProvider=new Ne("editorHasMultipleDocumentSelectionFormattingProvider",!1,_(727,"Whether the editor has multiple document selection formatting providers"))})(B||(B={}));const ui=0;class Vn extends Is{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var lo;(function(s){const e=function(i){if(!ws(i))return!1;const n=i;return!(!As(n.to)||!Mo(n.by)&&!As(n.by)||!Mo(n.value)&&!af(n.value)||!Mo(n.revealCursor)&&!C9(n.revealCursor))};s.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},s.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},s.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let n;switch(i.to){case s.RawDirection.Up:n=1;break;case s.RawDirection.Right:n=2;break;case s.RawDirection.Down:n=3;break;case s.RawDirection.Left:n=4;break;default:return null}let o;switch(i.by){case s.RawUnit.Line:o=1;break;case s.RawUnit.WrappedLine:o=2;break;case s.RawUnit.Page:o=3;break;case s.RawUnit.HalfPage:o=4;break;case s.RawUnit.Editor:o=5;break;case s.RawUnit.Column:o=6;break;default:o=2}const r=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:n,unit:o,value:r,revealCursor:a,select:!!i.select}}s.parse=t})(lo||(lo={}));var IC;(function(s){const e=function(t){if(!ws(t))return!1;const i=t;return!(!af(i.lineNumber)&&!As(i.lineNumber)||!Mo(i.at)&&!As(i.at))};s.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},s.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(IC||(IC={}));class oB{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(ii).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const n=Ss();return n&&nd(n)?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(ii).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}var Vs;(function(s){class e extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){if(!w.position)return;b.model.pushStackElement(),b.setCursorStates(w.source,3,[Qs.moveTo(b,b.getPrimaryCursorState(),this._inSelectionMode,w.position,w.viewPosition)])&&w.revealType!==2&&b.revealAllCursors(w.source,!0,!0)}}s.MoveTo=Te(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),s.MoveToSelect=Te(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends Vn{runCoreEditorCommand(b,w){b.model.pushStackElement();const C=this._getColumnSelectResult(b,b.getPrimaryCursorState(),b.getCursorColumnSelectData(),w);C!==null&&(b.setCursorStates(w.source,3,C.viewStates.map(y=>si.fromViewState(y))),b.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:C.fromLineNumber,fromViewVisualColumn:C.fromVisualColumn,toViewLineNumber:C.toLineNumber,toViewVisualColumn:C.toVisualColumn}),C.reversed?b.revealTopMostCursor(w.source):b.revealBottomMostCursor(w.source))}}s.ColumnSelect=Te(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(v,b,w,C){if(typeof C.position>"u"||typeof C.viewPosition>"u"||typeof C.mouseColumn>"u")return null;const y=v.model.validatePosition(C.position),x=v.coordinatesConverter.validateViewPosition(new z(C.viewPosition.lineNumber,C.viewPosition.column),y),S=C.doColumnSelect?w.fromViewLineNumber:x.lineNumber,L=C.doColumnSelect?w.fromViewVisualColumn:C.mouseColumn-1;return mp.columnSelect(v.cursorConfig,v,S,L,x.lineNumber,C.mouseColumn-1)}}),s.CursorColumnSelectLeft=Te(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(v,b,w,C){return mp.columnSelectLeft(v.cursorConfig,v,w)}}),s.CursorColumnSelectRight=Te(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(v,b,w,C){return mp.columnSelectRight(v.cursorConfig,v,w)}});class i extends t{constructor(b){super(b),this._isPaged=b.isPaged}_getColumnSelectResult(b,w,C,y){return mp.columnSelectUp(b.cursorConfig,b,C,this._isPaged)}}s.CursorColumnSelectUp=Te(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3600,linux:{primary:0}}})),s.CursorColumnSelectPageUp=Te(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends t{constructor(b){super(b),this._isPaged=b.isPaged}_getColumnSelectResult(b,w,C,y){return mp.columnSelectDown(b.cursorConfig,b,C,this._isPaged)}}s.CursorColumnSelectDown=Te(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3602,linux:{primary:0}}})),s.CursorColumnSelectPageDown=Te(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3596,linux:{primary:0}}}));class o extends Vn{constructor(){super({id:"cursorMove",precondition:void 0,metadata:sR.metadata})}runCoreEditorCommand(b,w){const C=sR.parse(w);C&&this._runCursorMove(b,w.source,C)}_runCursorMove(b,w,C){const y=C.noHistory?"api":w;b.model.pushStackElement(),b.setCursorStates(y,3,o._move(b,b.getCursorStates(),C)),b.revealAllCursors(y,!0)}static _move(b,w,C){const y=C.select,x=C.value;switch(C.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return Qs.simpleMove(b,w,C.direction,y,x,C.unit);case 11:case 13:case 12:case 14:return Qs.viewportMove(b,w,C.direction,y,x);default:return null}}}s.CursorMoveImpl=o,s.CursorMove=Te(new o);class r extends Vn{constructor(b){super(b),this._staticArgs=b.args}runCoreEditorCommand(b,w){let C=this._staticArgs;this._staticArgs.value===-1&&(C={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:w.pageSize||b.cursorConfig.pageSize}),b.model.pushStackElement(),b.setCursorStates(w.source,3,Qs.simpleMove(b,b.getCursorStates(),C.direction,C.select,C.value,C.unit)),b.revealAllCursors(w.source,!0)}}s.CursorLeft=Te(new r({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),s.CursorLeftSelect=Te(new r({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1039}})),s.CursorRight=Te(new r({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),s.CursorRightSelect=Te(new r({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1041}})),s.CursorUp=Te(new r({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),s.CursorUpSelect=Te(new r({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),s.CursorPageUp=Te(new r({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:11}})),s.CursorPageUpSelect=Te(new r({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1035}})),s.CursorDown=Te(new r({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),s.CursorDownSelect=Te(new r({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),s.CursorPageDown=Te(new r({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:12}})),s.CursorPageDownSelect=Te(new r({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1036}})),s.CreateCursor=Te(new class extends Vn{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(v,b){if(!b.position)return;let w;b.wholeLine?w=Qs.line(v,v.getPrimaryCursorState(),!1,b.position,b.viewPosition):w=Qs.moveTo(v,v.getPrimaryCursorState(),!1,b.position,b.viewPosition);const C=v.getCursorStates();if(C.length>1){const y=w.modelState?w.modelState.position:null,x=w.viewState?w.viewState.position:null;for(let S=0,L=C.length;S<L;S++){const E=C[S];if(!(y&&!E.modelState.selection.containsPosition(y))&&!(x&&!E.viewState.selection.containsPosition(x))){C.splice(S,1),v.model.pushStackElement(),v.setCursorStates(b.source,3,C);return}}}C.push(w),v.model.pushStackElement(),v.setCursorStates(b.source,3,C)}}),s.LastCursorMoveToSelect=Te(new class extends Vn{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(v,b){if(!b.position)return;const w=v.getLastAddedCursorIndex(),C=v.getCursorStates(),y=C.slice(0);y[w]=Qs.moveTo(v,C[w],!0,b.position,b.viewPosition),v.model.pushStackElement(),v.setCursorStates(b.source,3,y)}});class a extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){b.model.pushStackElement(),b.setCursorStates(w.source,3,Qs.moveToBeginningOfLine(b,b.getCursorStates(),this._inSelectionMode)),b.revealAllCursors(w.source,!0)}}s.CursorHome=Te(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),s.CursorHomeSelect=Te(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){b.model.pushStackElement(),b.setCursorStates(w.source,3,this._exec(b.getCursorStates())),b.revealAllCursors(w.source,!0)}_exec(b){const w=[];for(let C=0,y=b.length;C<y;C++){const x=b[C],S=x.modelState.position.lineNumber;w[C]=si.fromModelState(x.modelState.move(this._inSelectionMode,S,1,0))}return w}}s.CursorLineStart=Te(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:0,mac:{primary:287}}})),s.CursorLineStartSelect=Te(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){b.model.pushStackElement(),b.setCursorStates(w.source,3,Qs.moveToEndOfLine(b,b.getCursorStates(),this._inSelectionMode,w.sticky||!1)),b.revealAllCursors(w.source,!0)}}s.CursorEnd=Te(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ui,kbExpr:B.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:_(66,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),s.CursorEndSelect=Te(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ui,kbExpr:B.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:_(67,"Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class d extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){b.model.pushStackElement(),b.setCursorStates(w.source,3,this._exec(b,b.getCursorStates())),b.revealAllCursors(w.source,!0)}_exec(b,w){const C=[];for(let y=0,x=w.length;y<x;y++){const S=w[y],L=S.modelState.position.lineNumber,E=b.model.getLineMaxColumn(L);C[y]=si.fromModelState(S.modelState.move(this._inSelectionMode,L,E,0))}return C}}s.CursorLineEnd=Te(new d({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:0,mac:{primary:291}}})),s.CursorLineEndSelect=Te(new d({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:0,mac:{primary:1315}}}));class h extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){b.model.pushStackElement(),b.setCursorStates(w.source,3,Qs.moveToBeginningOfBuffer(b,b.getCursorStates(),this._inSelectionMode)),b.revealAllCursors(w.source,!0)}}s.CursorTop=Te(new h({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:2062,mac:{primary:2064}}})),s.CursorTopSelect=Te(new h({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3086,mac:{primary:3088}}}));class u extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){b.model.pushStackElement(),b.setCursorStates(w.source,3,Qs.moveToEndOfBuffer(b,b.getCursorStates(),this._inSelectionMode)),b.revealAllCursors(w.source,!0)}}s.CursorBottom=Te(new u({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:2061,mac:{primary:2066}}})),s.CursorBottomSelect=Te(new u({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:3085,mac:{primary:3090}}}));class f extends Vn{constructor(){super({id:"editorScroll",precondition:void 0,metadata:lo.metadata})}determineScrollMethod(b){const w=[6],C=[1,2,3,4,5,6],y=[4,2],x=[1,3];return w.includes(b.unit)&&y.includes(b.direction)?this._runHorizontalEditorScroll.bind(this):C.includes(b.unit)&&x.includes(b.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(b,w){const C=lo.parse(w);if(!C)return;const y=this.determineScrollMethod(C);y&&y(b,w.source,C)}_runVerticalEditorScroll(b,w,C){const y=this._computeDesiredScrollTop(b,C);if(C.revealCursor){const x=b.getCompletelyVisibleViewRangeAtScrollTop(y);b.setCursorStates(w,3,[Qs.findPositionInViewportIfOutside(b,b.getPrimaryCursorState(),x,C.select)])}b.viewLayout.setScrollPosition({scrollTop:y},0)}_computeDesiredScrollTop(b,w){if(w.unit===1){const x=b.viewLayout.getFutureViewport(),S=b.getCompletelyVisibleViewRangeAtScrollTop(x.top),L=b.coordinatesConverter.convertViewRangeToModelRange(S);let E;w.direction===1?E=Math.max(1,L.startLineNumber-w.value):E=Math.min(b.model.getLineCount(),L.startLineNumber+w.value);const M=b.coordinatesConverter.convertModelPositionToViewPosition(new z(E,1));return b.viewLayout.getVerticalOffsetForLineNumber(M.lineNumber)}if(w.unit===5){let x=0;return w.direction===3&&(x=b.model.getLineCount()-b.cursorConfig.pageSize),b.viewLayout.getVerticalOffsetForLineNumber(x)}let C;w.unit===3?C=b.cursorConfig.pageSize*w.value:w.unit===4?C=Math.round(b.cursorConfig.pageSize/2)*w.value:C=w.value;const y=(w.direction===1?-1:1)*C;return b.viewLayout.getCurrentScrollTop()+y*b.cursorConfig.lineHeight}_runHorizontalEditorScroll(b,w,C){const y=this._computeDesiredScrollLeft(b,C);b.viewLayout.setScrollPosition({scrollLeft:y},0)}_computeDesiredScrollLeft(b,w){const C=(w.direction===4?-1:1)*w.value;return b.viewLayout.getCurrentScrollLeft()+C*b.cursorConfig.typicalHalfwidthCharacterWidth}}s.EditorScrollImpl=f,s.EditorScroll=Te(new f),s.ScrollLineUp=Te(new class extends Vn{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Up,by:lo.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollPageUp=Te(new class extends Vn{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Up,by:lo.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollEditorTop=Te(new class extends Vn{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Up,by:lo.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollLineDown=Te(new class extends Vn{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Down,by:lo.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollPageDown=Te(new class extends Vn{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Down,by:lo.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollEditorBottom=Te(new class extends Vn{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Down,by:lo.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollLeft=Te(new class extends Vn{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Left,by:lo.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:b.source})}}),s.ScrollRight=Te(new class extends Vn{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus}})}runCoreEditorCommand(v,b){s.EditorScroll.runCoreEditorCommand(v,{to:lo.RawDirection.Right,by:lo.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:b.source})}});class g extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){w.position&&(b.model.pushStackElement(),b.setCursorStates(w.source,3,[Qs.word(b,b.getPrimaryCursorState(),this._inSelectionMode,w.position)]),w.revealType!==2&&b.revealAllCursors(w.source,!0,!0))}}s.WordSelect=Te(new g({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),s.WordSelectDrag=Te(new g({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),s.LastCursorWordSelect=Te(new class extends Vn{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(v,b){if(!b.position)return;const w=v.getLastAddedCursorIndex(),C=v.getCursorStates(),y=C.slice(0),x=C[w];y[w]=Qs.word(v,x,x.modelState.hasSelection(),b.position),v.model.pushStackElement(),v.setCursorStates(b.source,3,y)}});class m extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){w.position&&(b.model.pushStackElement(),b.setCursorStates(w.source,3,[Qs.line(b,b.getPrimaryCursorState(),this._inSelectionMode,w.position,w.viewPosition)]),w.revealType!==2&&b.revealAllCursors(w.source,!1,!0))}}s.LineSelect=Te(new m({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),s.LineSelectDrag=Te(new m({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class p extends Vn{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,w){if(!w.position)return;const C=b.getLastAddedCursorIndex(),y=b.getCursorStates(),x=y.slice(0);x[C]=Qs.line(b,y[C],this._inSelectionMode,w.position,w.viewPosition),b.model.pushStackElement(),b.setCursorStates(w.source,3,x)}}s.LastCursorLineSelect=Te(new p({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),s.LastCursorLineSelectDrag=Te(new p({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),s.CancelSelection=Te(new class extends Vn{constructor(){super({id:"cancelSelection",precondition:B.hasNonEmptySelection,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(v,b){v.model.pushStackElement(),v.setCursorStates(b.source,3,[Qs.cancelSelection(v,v.getPrimaryCursorState())]),v.revealAllCursors(b.source,!0)}}),s.RemoveSecondaryCursors=Te(new class extends Vn{constructor(){super({id:"removeSecondaryCursors",precondition:B.hasMultipleSelections,kbOpts:{weight:ui+1,kbExpr:B.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(v,b){v.model.pushStackElement(),v.setCursorStates(b.source,3,[v.getPrimaryCursorState()]),v.revealAllCursors(b.source,!0),ld(_(68,"Removed secondary cursors"))}}),s.RevealLine=Te(new class extends Vn{constructor(){super({id:"revealLine",precondition:void 0,metadata:IC.metadata})}runCoreEditorCommand(v,b){const w=b,C=w.lineNumber||0;let y=typeof C=="number"?C+1:parseInt(C)+1;y<1&&(y=1);const x=v.model.getLineCount();y>x&&(y=x);const S=new D(y,1,y,v.model.getLineMaxColumn(y));let L=0;if(w.at)switch(w.at){case IC.RawAtArgument.Top:L=3;break;case IC.RawAtArgument.Center:L=1;break;case IC.RawAtArgument.Bottom:L=4;break}const E=v.coordinatesConverter.convertModelRangeToViewRange(S);v.revealRange(b.source,!1,E,L,0)}}),s.SelectAll=new class extends oB{constructor(){super(WNe)}runDOMCommand(v){Wr&&(v.focus(),v.select()),v.ownerDocument.execCommand("selectAll")}runEditorCommand(v,b,w){const C=b._getViewModel();C&&this.runCoreEditorCommand(C,w)}runCoreEditorCommand(v,b){v.model.pushStackElement(),v.setCursorStates("keyboard",3,[Qs.selectAll(v,v.getPrimaryCursorState())])}},s.SetSelection=Te(new class extends Vn{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(v,b){b.selection&&(v.model.pushStackElement(),v.setCursorStates(b.source,3,[si.fromModelSelection(b.selection)]))}})})(Vs||(Vs={}));const r2e=de.and(B.textInputFocus,B.columnSelection);function o0(s,e){Ks.registerKeybindingRule({id:s,primary:e,when:r2e,weight:ui+1})}o0(Vs.CursorColumnSelectLeft.id,1039);o0(Vs.CursorColumnSelectRight.id,1041);o0(Vs.CursorColumnSelectUp.id,1040);o0(Vs.CursorColumnSelectPageUp.id,1035);o0(Vs.CursorColumnSelectDown.id,1042);o0(Vs.CursorColumnSelectPageDown.id,1036);function AY(s){return s.register(),s}var _1;(function(s){class e extends Is{runEditorCommand(i,n,o){const r=n._getViewModel();r&&this.runCoreEditingCommand(n,r,o||{})}}s.CoreEditingCommand=e,s.LineBreakInsert=Te(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:B.writable,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,WO.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection)))}}),s.Outdent=Te(new class extends e{constructor(){super({id:"outdent",precondition:B.writable,kbOpts:{weight:ui,kbExpr:de.and(B.editorTextFocus,B.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,ag.outdent(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection))),t.pushUndoStop()}}),s.Tab=Te(new class extends e{constructor(){super({id:"tab",precondition:B.writable,kbOpts:{weight:ui,kbExpr:de.and(B.editorTextFocus,B.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,ag.tab(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection))),t.pushUndoStop()}}),s.DeleteLeft=Te(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,n){const[o,r]=Ab.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());o&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(2)}}),s.DeleteRight=Te(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:ui,kbExpr:B.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,n){const[o,r]=Ab.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));o&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(3)}}),s.Undo=new class extends oB{constructor(){super(Ooe)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(104)===!0))return i.getModel().undo()}},s.Redo=new class extends oB{constructor(){super(Foe)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(104)===!0))return i.getModel().redo()}}})(_1||(_1={}));class PY extends RO{constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){const i=e.get(ii).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function vv(s,e){AY(new PY("default:"+s,s)),AY(new PY(s,s,e))}vv("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});vv("replacePreviousChar");vv("compositionType");vv("compositionStart");vv("compositionEnd");vv("paste");vv("cut");const t$=Mt("markerDecorationsService");var a2e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},l2e=function(s,e){return function(t,i){e(t,i,s)}},U1;let cR=(U1=class{constructor(e,t){}dispose(){}},U1.ID="editor.contrib.markerDecorations",U1);cR=a2e([l2e(1,t$)],cR);Qt(cR.ID,cR,0);class dR{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}focus(){this.domNode.focus()}setMaxWidth(e){const t=Lc(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=Lc(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=Lc(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=Lc(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=Lc(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=Lc(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=Lc(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=Lc(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=Lc(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=Lc(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=Lc(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Lc(s){return typeof s=="number"?`${s}px`:s}function gi(s){return new dR(s)}function js(s,e){s instanceof dR?(s.setFontFamily(e.getMassagedFontFamily()),s.setFontWeight(e.fontWeight),s.setFontSize(e.fontSize),s.setFontFeatureSettings(e.fontFeatureSettings),s.setFontVariationSettings(e.fontVariationSettings),s.setLineHeight(e.lineHeight),s.setLetterSpacing(e.letterSpacing)):(s.style.fontFamily=e.getMassagedFontFamily(),s.style.fontWeight=e.fontWeight,s.style.fontSize=e.fontSize+"px",s.style.fontFeatureSettings=e.fontFeatureSettings,s.style.fontVariationSettings=e.fontVariationSettings,s.style.lineHeight=e.lineHeight+"px",s.style.letterSpacing=e.letterSpacing+"px")}class ore extends K{constructor(e,t){super(),this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,n=!1;const o=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{Vr(je(this._referenceDomElement),()=>{n=!1,o()})}};this._resizeObserver=new ResizeObserver(r=>{r&&r[0]&&r[0].contentRect?e={width:r[0].contentRect.width,height:r[0].contentRect.height}:e=null,i=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}}class c2e extends K{constructor(e){super(),this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){var i;(i=this._mediaQueryList)==null||i.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}}class d2e extends K{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const t=this._register(new c2e(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}class h2e{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const t=wL(e);let i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=new d2e(e),this.mapWindowIdToPixelRatioMonitor.set(t,i),Se.once(DTe)(({vscodeWindowId:n})=>{n===t&&(i==null||i.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))})),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const DL=new h2e;class u2e{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class i${constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){var t;this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),(t=this._container)==null||t.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");js(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");js(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");js(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const o=[];for(const r of this._requests){let a;r.type===0&&(a=t),r.type===2&&(a=i),r.type===1&&(a=n),a.appendChild(document.createElement("br"));const l=document.createElement("span");i$._render(l,r),a.appendChild(l),o.push(l)}this._container=e,this._testElements=o}static _render(e,t){if(t.chr===" "){let i=" ";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}}function f2e(s,e,t){new i$(e,t).read(s)}const yl=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new q,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(s){s=Math.min(Math.max(-5,s),20),this._zoomLevel!==s&&(this._zoomLevel=s,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},g2e=Bt?1.5:1.35,q5=8;class Pb{static _create(e,t,i,n,o,r,a,l,c){r===0?r=g2e*i:r<q5&&(r=r*i),r=Math.round(r),r<q5&&(r=q5);const d=1+(c?0:yl.getZoomLevel()*.1);return i*=d,r*=d,o===are&&(t==="normal"||t==="bold"?o=rre:(o=`'wght' ${parseInt(t,10)}`,t="normal")),new Pb({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:o,lineHeight:r,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=Or.fontFamily,t=Pb._wrapInQuotes(this.fontFamily);return this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const m2e=2;class hR extends Pb{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=m2e,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}const rre="normal",are="translate",p2e="Consolas, 'Courier New', monospace",_2e="Menlo, Monaco, 'Courier New', monospace",b2e="'Droid Sans Mono', 'monospace', monospace",Or={fontFamily:Bt?_2e:no?p2e:b2e,fontWeight:"normal",fontSize:Bt?12:14,lineHeight:0,letterSpacing:0},po={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},Md=8;class lre{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class cre{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class _n{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return VO(e,t)}compute(e,t,i){return i}}class qS{constructor(e,t){this.newValue=e,this.didChange=t}}function VO(s,e){if(typeof s!="object"||typeof e!="object"||!s||!e)return new qS(e,s!==e);if(Array.isArray(s)||Array.isArray(e)){const i=Array.isArray(s)&&Array.isArray(e)&&dn(s,e);return new qS(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=VO(s[i],e[i]);n.didChange&&(s[i]=n.newValue,t=!0)}return new qS(s,t)}class Tm{constructor(e,t){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=t}applyUpdate(e,t){return VO(e,t)}validate(e){return this.defaultValue}}class r0{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return VO(e,t)}compute(e,t,i){return i}}function Ye(s,e){return typeof s>"u"?e:s==="false"?!1:!!s}class Ot extends r0{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return Ye(e,this.defaultValue)}}function _u(s,e,t,i){if(typeof s=="string"&&(s=parseInt(s,10)),typeof s!="number"||isNaN(s))return e;let n=s;return n=Math.max(t,n),n=Math.min(i,n),n|0}class Di extends r0{static clampedInt(e,t,i,n){return _u(e,t,i,n)}constructor(e,t,i,n,o,r=void 0){typeof r<"u"&&(r.type="integer",r.default=i,r.minimum=n,r.maximum=o),super(e,t,i,r),this.minimum=n,this.maximum=o}validate(e){return Di.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function v2e(s,e,t,i){if(typeof s>"u")return e;const n=Ar.float(s,e);return Ar.clamp(n,t,i)}class Ar extends r0{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){return typeof e=="string"&&(e=parseFloat(e)),typeof e!="number"||isNaN(e)?t:e}constructor(e,t,i,n,o,r,a){typeof o<"u"&&(o.type="number",o.default=i,o.minimum=r,o.maximum=a),super(e,t,i,o),this.validationFn=n,this.minimum=r,this.maximum=a}validate(e){return this.validationFn(Ar.float(e,this.defaultValue))}}class Ko extends r0{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return Ko.string(e,this.defaultValue)}}function nn(s,e,t,i){return typeof s!="string"?e:i&&s in i?i[s]:t.indexOf(s)===-1?e:s}class mn extends r0{constructor(e,t,i,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=n.slice(0),o.default=i),super(e,t,i,o),this._allowedValues=n}validate(e){return nn(e,this.defaultValue,this._allowedValues)}}class P0 extends _n{constructor(e,t,i,n,o,r,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=n),super(e,t,i,a),this._allowedValues=o,this._convert=r}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function C2e(s){switch(s){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class w2e extends _n{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[_(201,"Use platform APIs to detect when a Screen Reader is attached."),_(202,"Optimize for usage with a Screen Reader."),_(203,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:_(204,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class y2e extends _n{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(29,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:_(205,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:_(206,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Ye(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Ye(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function S2e(s){switch(s){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var Rs;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(Rs||(Rs={}));function OY(s){switch(s){case"line":return Rs.Line;case"block":return Rs.Block;case"underline":return Rs.Underline;case"line-thin":return Rs.LineThin;case"block-outline":return Rs.BlockOutline;case"underline-thin":return Rs.UnderlineThin}}class x2e extends Tm{constructor(){super(162,"")}compute(e,t,i){const n=["monaco-editor"];return t.get(48)&&n.push(t.get(48)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(82)==="default"?n.push("mouse-default"):t.get(82)==="copy"&&n.push("mouse-copy"),t.get(127)&&n.push("showUnused"),t.get(157)&&n.push("showDeprecated"),n.join(" ")}}class L2e extends Ot{constructor(){super(45,"emptySelectionClipboard",!0,{description:_(207,"Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class I2e extends _n{constructor(){const e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(50,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:_(208,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[_(209,"Never seed search string from the editor selection."),_(210,"Always seed search string from the editor selection, including word at cursor position."),_(211,"Only seed search string from the editor selection.")],description:_(212,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[_(213,"Never turn on Find in Selection automatically (default)."),_(214,"Always turn on Find in Selection automatically."),_(215,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:_(216,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:_(217,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Bt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:_(218,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:_(219,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[_(220,"Do not store search history from the find widget."),_(221,"Store search history across the active workspace")],description:_(222,"Controls how the find widget history should be stored")},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[_(223,"Do not store history from the replace widget."),_(224,"Store replace history across the active workspace")],description:_(225,"Controls how the replace widget history should be stored")},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:_(226,"Controls whether the Find Widget should search as you type.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Ye(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:Ye(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":nn(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":nn(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Ye(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Ye(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Ye(t.loop,this.defaultValue.loop),history:nn(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:nn(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}}const uu=class uu extends _n{constructor(){super(60,"fontLigatures",uu.OFF,{anyOf:[{type:"boolean",description:_(227,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:_(228,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:_(229,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?uu.OFF:e==="true"?uu.ON:e:e?uu.ON:uu.OFF}};uu.OFF='"liga" off, "calt" off',uu.ON='"liga" on, "calt" on';let gf=uu;const fu=class fu extends _n{constructor(){super(63,"fontVariations",fu.OFF,{anyOf:[{type:"boolean",description:_(230,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:_(231,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:_(232,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?fu.OFF:e==="true"?fu.TRANSLATE:e:e?fu.TRANSLATE:fu.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};fu.OFF=rre,fu.TRANSLATE=are;let rB=fu;class E2e extends Tm{constructor(){super(59,new hR({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:!1,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:!1,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},!1))}compute(e,t,i){return e.fontInfo}}class k2e extends Tm{constructor(){super(161,Rs.Line)}compute(e,t,i){return e.inputMode==="overtype"?t.get(92):t.get(34)}}class D2e extends Tm{constructor(){super(170,!1)}compute(e,t){return e.editContextSupported&&t.get(44)}}class T2e extends Tm{constructor(){super(172,!1)}compute(e,t){return e.accessibilitySupport===2?t.get(7):t.get(6)}}class N2e extends r0{constructor(){super(61,"fontSize",Or.fontSize,{type:"number",minimum:6,maximum:100,default:Or.fontSize,description:_(233,"Controls the font size in pixels.")})}validate(e){const t=Ar.float(e,this.defaultValue);return t===0?Or.fontSize:Ar.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const Wd=class Wd extends _n{constructor(){super(62,"fontWeight",Or.fontWeight,{anyOf:[{type:"number",minimum:Wd.MINIMUM_VALUE,maximum:Wd.MAXIMUM_VALUE,errorMessage:_(234,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Wd.SUGGESTION_VALUES}],default:Or.fontWeight,description:_(235,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Di.clampedInt(e,Or.fontWeight,Wd.MINIMUM_VALUE,Wd.MAXIMUM_VALUE))}};Wd.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],Wd.MINIMUM_VALUE=1,Wd.MAXIMUM_VALUE=1e3;let aB=Wd;class R2e extends _n{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[_(236,"Show Peek view of the results (default)"),_(237,"Go to the primary result and show a Peek view"),_(238,"Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(67,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:_(239,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:_(240,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:_(241,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:_(242,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:_(243,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:_(244,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:_(245,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:_(246,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:_(247,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:_(248,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:_(249,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:nn(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:nn(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:nn(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:nn(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:nn(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:nn(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:nn(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Ko.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Ko.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Ko.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Ko.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Ko.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Ko.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class M2e extends _n{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(69,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:_(250,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:_(251,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:_(252,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:_(253,"Controls the delay in milliseconds after which the hover is hidden. Requires `#editor.hover.sticky#` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:_(254,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),delay:Di.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Ye(t.sticky,this.defaultValue.sticky),hidingDelay:Di.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Ye(t.above,this.defaultValue.above)}}}class b1 extends Tm{constructor(){super(165,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(e,t,i){return b1.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const o=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),r=Math.floor(e.viewLineCount/o);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:o,minimapLineCount:r}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,o=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const r=t.stableMinimapLayoutInput,a=r&&e.outerHeight===r.outerHeight&&e.lineHeight===r.lineHeight&&e.typicalHalfwidthCharacterWidth===r.typicalHalfwidthCharacterWidth&&e.pixelRatio===r.pixelRatio&&e.scrollBeyondLastLine===r.scrollBeyondLastLine&&e.paddingTop===r.paddingTop&&e.paddingBottom===r.paddingBottom&&e.minimap.enabled===r.minimap.enabled&&e.minimap.side===r.minimap.side&&e.minimap.size===r.minimap.size&&e.minimap.showSlider===r.minimap.showSlider&&e.minimap.renderCharacters===r.minimap.renderCharacters&&e.minimap.maxColumn===r.minimap.maxColumn&&e.minimap.scale===r.minimap.scale&&e.verticalScrollbarWidth===r.verticalScrollbarWidth&&e.isViewportWrapping===r.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,d=e.scrollBeyondLastLine,h=e.minimap.renderCharacters;let u=o>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const f=e.minimap.maxColumn,g=e.minimap.size,m=e.minimap.side,p=e.verticalScrollbarWidth,v=e.viewLineCount,b=e.remainingWidth,w=e.isViewportWrapping,C=h?2:3;let y=Math.floor(o*n);const x=y/o;let S=!1,L=!1,E=C*u,M=u/o,R=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:G,extraLinesBeforeFirstLine:V,extraLinesBeyondLastLine:U,desiredRatio:$,minimapLineCount:Y}=b1.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:d,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:o});if(v/Y>1)S=!0,L=!0,u=1,E=1,M=u/o;else{let j=!1,ie=u+1;if(g==="fit"){const te=Math.ceil((V+v+U)*E);w&&a&&b<=t.stableFitRemainingWidth?(j=!0,ie=t.stableFitMaxMinimapScale):j=te>y}if(g==="fill"||j){S=!0;const te=u;E=Math.min(l*o,Math.max(1,Math.floor(1/$))),w&&a&&b<=t.stableFitRemainingWidth&&(ie=t.stableFitMaxMinimapScale),u=Math.min(ie,Math.max(1,Math.floor(E/C))),u>te&&(R=Math.min(2,u/te)),M=u/o/R,y=Math.ceil(Math.max(G,V+v+U)*E),w?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=b,t.stableFitMaxMinimapScale=u):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const T=Math.floor(f*M),A=Math.min(T,Math.max(0,Math.floor((b-p-2)*M/(c+M)))+Md);let N=Math.floor(o*A);const P=N/o;N=Math.floor(N*R);const W=h?1:2,H=m==="left"?0:i-A-p;return{renderMinimap:W,minimapLeft:H,minimapWidth:A,minimapHeightIsEditorHeight:S,minimapIsSampling:L,minimapScale:u,minimapLineHeight:E,minimapCanvasInnerWidth:N,minimapCanvasInnerHeight:y,minimapCanvasOuterWidth:P,minimapCanvasOuterHeight:x}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,o=t.lineHeight|0,r=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,d=t.viewLineCount,h=e.get(154),u=h==="inherit"?e.get(153):h,f=u==="inherit"?e.get(149):u,g=e.get(152),m=t.isDominatedByLongLines,p=e.get(66),v=e.get(76).renderType!==0,b=e.get(77),w=e.get(119),C=e.get(96),y=e.get(81),x=e.get(117),S=x.verticalScrollbarSize,L=x.verticalHasArrows,E=x.arrowSize,M=x.horizontalScrollbarSize,R=e.get(52),T=e.get(126)!=="never";let A=e.get(74);R&&T&&(A+=16);let N=0;if(v){const J=Math.max(r,b);N=Math.round(J*l)}let P=0;p&&(P=o*t.glyphMarginDecorationLaneCount);let W=0,H=W+P,G=H+N,V=G+A;const U=i-P-N-A;let $=!1,Y=!1,se=-1;e.get(2)===2&&u==="inherit"&&m?($=!0,Y=!0):f==="on"||f==="bounded"?Y=!0:f==="wordWrapColumn"&&(se=g);const j=b1._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:w,paddingTop:C.top,paddingBottom:C.bottom,minimap:y,verticalScrollbarWidth:S,viewLineCount:d,remainingWidth:U,isViewportWrapping:Y},t.memory||new cre);j.renderMinimap!==0&&j.minimapLeft===0&&(W+=j.minimapWidth,H+=j.minimapWidth,G+=j.minimapWidth,V+=j.minimapWidth);const ie=U-j.minimapWidth,te=Math.max(1,Math.floor((ie-S-2)/a)),pe=L?E:0;return Y&&(se=Math.max(1,te),f==="bounded"&&(se=Math.min(se,g))),{width:i,height:n,glyphMarginLeft:W,glyphMarginWidth:P,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:H,lineNumbersWidth:N,decorationsLeft:G,decorationsWidth:A,contentLeft:V,contentWidth:ie,minimap:j,viewportColumn:te,isWordWrapMinified:$,isViewportWrapping:Y,wrappingColumn:se,verticalScrollbarWidth:S,horizontalScrollbarHeight:M,overviewRuler:{top:pe,width:S,height:n-2*pe,right:0}}}}class A2e extends _n{constructor(){super(156,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[_(255,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),_(256,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:_(257,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return nn(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var ic;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(ic||(ic={}));class P2e extends _n{constructor(){const e={enabled:ic.OnCode};super(73,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[ic.Off,ic.OnCode,ic.On],default:e.enabled,enumDescriptions:[_(258,"Disable the code action menu."),_(259,"Show the code action menu when the cursor is on lines with code."),_(260,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:_(261,"Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:nn(e.enabled,this.defaultValue.enabled,[ic.Off,ic.OnCode,ic.On])}}}class O2e extends _n{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(131,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:_(262,"Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:_(263,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:_(264,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:_(265,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),maxLineCount:Di.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:nn(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Ye(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class F2e extends _n{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(159,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:_(266,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[_(267,"Inlay hints are enabled"),_(268,"Inlay hints are showing by default and hide when holding {0}",Bt?"Ctrl+Option":"Ctrl+Alt"),_(269,"Inlay hints are hidden by default and show when holding {0}",Bt?"Ctrl+Option":"Ctrl+Alt"),_(270,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:_(271,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:_(272,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:_(273,"Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:_(274,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:nn(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Di.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Ko.string(t.fontFamily,this.defaultValue.fontFamily),padding:Ye(t.padding,this.defaultValue.padding),maximumLength:Di.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}}class B2e extends _n{constructor(){super(74,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Di.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Di.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class W2e extends Ar{constructor(){super(75,"lineHeight",Or.lineHeight,e=>Ar.clamp(e,0,150),{markdownDescription:_(275,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)},0,150)}compute(e,t,i){return e.fontInfo.lineHeight}}class H2e extends _n{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(81,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:_(276,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[_(277,"The minimap is always shown."),_(278,"The minimap is hidden when mouse is not over the minimap and shown when mouse is over the minimap."),_(279,"The minimap is only shown when the editor is scrolled")],default:e.autohide,description:_(280,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[_(281,"The minimap has the same size as the editor contents (and might scroll)."),_(282,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),_(283,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:_(284,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:_(285,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:_(286,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:_(287,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:_(288,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:_(289,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:_(290,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:_(291,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:_(292,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:_(293,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:_(294,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const n=t.markSectionHeaderRegex;if(typeof n=="string")try{new RegExp(n,"d"),i=n}catch{}return{enabled:Ye(t.enabled,this.defaultValue.enabled),autohide:nn(t.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:nn(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:nn(t.side,this.defaultValue.side,["right","left"]),showSlider:nn(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Ye(t.renderCharacters,this.defaultValue.renderCharacters),scale:Di.clampedInt(t.scale,1,1,3),maxColumn:Di.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:Ye(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:Ye(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:Ar.clamp(Ar.float(t.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:Ar.clamp(Ar.float(t.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}}function V2e(s){return s==="ctrlCmd"?Bt?"metaKey":"ctrlKey":"altKey"}class z2e extends _n{constructor(){super(96,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:_(295,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:_(296,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Di.clampedInt(t.top,0,0,1e3),bottom:Di.clampedInt(t.bottom,0,0,1e3)}}}class U2e extends _n{constructor(){const e={enabled:!0,cycle:!0};super(98,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:_(297,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:_(298,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),cycle:Ye(t.cycle,this.defaultValue.cycle)}}}class $2e extends Tm{constructor(){super(163,1)}compute(e,t,i){return e.pixelRatio}}class q2e extends _n{constructor(){super(100,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class j2e extends _n{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[_(299,"Quick suggestions show inside the suggest widget"),_(300,"Quick suggestions show as ghost text"),_(301,"Quick suggestions are disabled")]}];super(102,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:_(302,"Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:_(303,"Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:_(304,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:_(305,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,o=["on","inline","off"];let r,a,l;return typeof t=="boolean"?r=t?"on":"off":r=nn(t,this.defaultValue.other,o),typeof i=="boolean"?a=i?"on":"off":a=nn(i,this.defaultValue.comments,o),typeof n=="boolean"?l=n?"on":"off":l=nn(n,this.defaultValue.strings,o),{other:r,comments:a,strings:l}}}class K2e extends _n{constructor(){super(76,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[_(306,"Line numbers are not rendered."),_(307,"Line numbers are rendered as absolute number."),_(308,"Line numbers are rendered as distance in lines to cursor position."),_(309,"Line numbers are rendered every 10 lines.")],default:"on",description:_(310,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function uR(s){const e=s.get(112);return e==="editable"?s.get(104):e!=="on"}function fR(s){return!s.get(172)}class G2e extends _n{constructor(){const e=[],t={type:"number",description:_(311,"Number of monospace characters at which this editor ruler will render.")};super(116,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:_(312,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:_(313,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Di.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Di.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class Y2e extends _n{constructor(){super(105,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function FY(s,e){if(typeof s!="string")return e;switch(s){case"hidden":return 2;case"visible":return 3;default:return 1}}let X2e=class extends _n{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(117,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[_(314,"The vertical scrollbar will be visible only when necessary."),_(315,"The vertical scrollbar will always be visible."),_(316,"The vertical scrollbar will always be hidden.")],default:"auto",description:_(317,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[_(318,"The horizontal scrollbar will be visible only when necessary."),_(319,"The horizontal scrollbar will always be visible."),_(320,"The horizontal scrollbar will always be hidden.")],default:"auto",description:_(321,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:_(322,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:_(323,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:_(324,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:_(325,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Di.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Di.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Di.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:FY(t.vertical,this.defaultValue.vertical),horizontal:FY(t.horizontal,this.defaultValue.horizontal),useShadows:Ye(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Ye(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Ye(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Ye(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Ye(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Di.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Di.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:Ye(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:Ye(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const Na="inUntrustedWorkspace",Rr={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class Z2e extends _n{constructor(){const e={nonBasicASCII:Na,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Na,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(142,"unicodeHighlight",e,{[Rr.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Na],default:e.nonBasicASCII,description:_(326,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Rr.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:_(327,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[Rr.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:_(328,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Rr.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Na],default:e.includeComments,description:_(329,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[Rr.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Na],default:e.includeStrings,description:_(330,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[Rr.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:_(331,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Rr.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:_(332,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(la(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(la(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new qS(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:v1(t.nonBasicASCII,Na,[!0,!1,Na]),invisibleCharacters:Ye(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Ye(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:v1(t.includeComments,Na,[!0,!1,Na]),includeStrings:v1(t.includeStrings,Na,[!0,!1,Na]),allowedCharacters:this.validateBooleanMap(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(t.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,o]of Object.entries(e))o===!0&&(i[n]=!0);return i}}class Q2e extends _n{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,minShowDelay:0,suppressInSnippetMode:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always"},triggerCommandOnProviderChange:!1,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:!0}};super(71,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:_(333,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[_(334,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),_(335,"Show the inline suggestion toolbar when hovering over an inline suggestion."),_(336,"Never show the inline suggestion toolbar.")],description:_(337,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:_(338,"Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:_(339,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:_(340,"Controls whether inline suggestions are suppressed when in snippet mode.")},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:_(341,"Controls the minimal delay in milliseconds after which inline suggestions are shown after typing.")},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:_(342,"Suppresses inline completions for specified extension IDs -- comma separated."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:_(343,"Controls whether to send request information from the inline suggestion provider."),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:_(344,"Controls whether to trigger a command when the inline suggestion provider changes."),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:_(345,"Controls whether to show inline suggestions when there is a suggest conflict."),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:_(346,"Controls the font family of the inline suggestions.")},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:_(347,"Controls whether showing a suggestion will shift the code to make space for the suggestion inline."),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:_(348,"Controls whether larger suggestions can be shown side by side."),enum:["auto","never"],enumDescriptions:[_(349,"Larger suggestions will show side by side if there is enough space, otherwise they will be shown below."),_(350,"Larger suggestions are never shown side by side and will always be shown below.")],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:_(351,"Controls whether the suggestion will show as collapsed until jumping to it."),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),mode:nn(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:nn(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:Ye(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Ye(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Ko.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:Ye(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:Di.clampedInt(t.minShowDelay,0,0,1e4),suppressInSnippetMode:Ye(t.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this._validateEdits(t.edits),triggerCommandOnProviderChange:Ye(t.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this._validateExperimental(t.experimental)}}_validateEdits(e){if(!e||typeof e!="object")return this.defaultValue.edits;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.edits.enabled),showCollapsed:Ye(t.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:nn(t.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),renderSideBySide:nn(t.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}_validateExperimental(e){if(!e||typeof e!="object")return this.defaultValue.experimental;const t=e;return{suppressInlineSuggestions:Ko.string(t.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:nn(t.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:Ye(t.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}}class J2e extends _n{constructor(){const e={enabled:po.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:po.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(21,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:_(352,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:_(353,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Ye(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class eMe extends _n{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(22,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[_(354,"Enables bracket pair guides."),_(355,"Enables bracket pair guides only for the active bracket pair."),_(356,"Disables bracket pair guides.")],default:e.bracketPairs,description:_(357,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[_(358,"Enables horizontal guides as addition to vertical bracket pair guides."),_(359,"Enables horizontal guides only for the active bracket pair."),_(360,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:_(361,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:_(362,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:_(363,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[_(364,"Highlights the active indent guide."),_(365,"Highlights the active indent guide even if bracket guides are highlighted."),_(366,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:_(367,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:v1(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:v1(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Ye(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Ye(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:v1(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function v1(s,e,t){const i=t.indexOf(s);return i===-1?e:t[i]}class tMe extends _n{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(134,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[_(368,"Insert suggestion without overwriting text right of the cursor."),_(369,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:_(370,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:_(371,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:_(372,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:_(373,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[_(374,"Always select a suggestion when automatically triggering IntelliSense."),_(375,"Never select a suggestion when automatically triggering IntelliSense."),_(376,"Select a suggestion only when triggering IntelliSense from a trigger character."),_(377,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:_(378,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:_(379,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:_(380,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:_(381,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:_(382,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:_(383,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:_(384,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:_(385,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:_(386,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:_(387,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:_(388,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:_(389,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:_(390,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:_(391,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:_(392,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:_(393,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:_(394,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:_(395,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:_(396,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:_(397,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:_(398,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:_(399,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:_(400,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:_(401,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:_(402,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:_(403,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:_(404,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:_(405,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:_(406,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:_(407,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:_(408,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:_(409,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:_(410,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:_(411,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:_(412,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:_(413,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:_(414,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:_(415,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:nn(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Ye(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Ye(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Ye(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Ye(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:nn(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Ye(t.showIcons,this.defaultValue.showIcons),showStatusBar:Ye(t.showStatusBar,this.defaultValue.showStatusBar),preview:Ye(t.preview,this.defaultValue.preview),previewMode:nn(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Ye(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Ye(t.showMethods,this.defaultValue.showMethods),showFunctions:Ye(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Ye(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Ye(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Ye(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Ye(t.showFields,this.defaultValue.showFields),showVariables:Ye(t.showVariables,this.defaultValue.showVariables),showClasses:Ye(t.showClasses,this.defaultValue.showClasses),showStructs:Ye(t.showStructs,this.defaultValue.showStructs),showInterfaces:Ye(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Ye(t.showModules,this.defaultValue.showModules),showProperties:Ye(t.showProperties,this.defaultValue.showProperties),showEvents:Ye(t.showEvents,this.defaultValue.showEvents),showOperators:Ye(t.showOperators,this.defaultValue.showOperators),showUnits:Ye(t.showUnits,this.defaultValue.showUnits),showValues:Ye(t.showValues,this.defaultValue.showValues),showConstants:Ye(t.showConstants,this.defaultValue.showConstants),showEnums:Ye(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Ye(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Ye(t.showKeywords,this.defaultValue.showKeywords),showWords:Ye(t.showWords,this.defaultValue.showWords),showColors:Ye(t.showColors,this.defaultValue.showColors),showFiles:Ye(t.showFiles,this.defaultValue.showFiles),showReferences:Ye(t.showReferences,this.defaultValue.showReferences),showFolders:Ye(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Ye(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Ye(t.showSnippets,this.defaultValue.showSnippets),showUsers:Ye(t.showUsers,this.defaultValue.showUsers),showIssues:Ye(t.showIssues,this.defaultValue.showIssues)}}}class iMe extends _n{constructor(){super(129,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:_(416,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:_(417,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Ye(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Ye(e.selectSubwords,this.defaultValue.selectSubwords)}}}class nMe extends _n{constructor(){const e=[];super(147,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:_(418,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class sMe extends _n{constructor(){super(155,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[_(419,"No indentation. Wrapped lines begin at column 1."),_(420,"Wrapped lines get the same indentation as the parent."),_(421,"Wrapped lines get +1 indentation toward the parent."),_(422,"Wrapped lines get +2 indentation toward the parent.")],description:_(423,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class oMe extends Tm{constructor(){super(166,{isDominatedByLongLines:!1,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1})}compute(e,t,i){const n=t.get(165);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class rMe extends _n{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(43,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:_(424,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:_(425,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[_(426,"Show the drop selector widget after a file is dropped into the editor."),_(427,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),showDropSelector:nn(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class aMe extends _n{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(97,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:_(428,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:_(429,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[_(430,"Show the paste selector widget after content is pasted into the editor."),_(431,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Ye(t.enabled,this.defaultValue.enabled),showPasteSelector:nn(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const EC=[];function _e(s){return EC[s.id]=s,s}const Go={acceptSuggestionOnCommitCharacter:_e(new Ot(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:_(432,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:_e(new mn(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",_(433,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:_(434,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:_e(new w2e),accessibilityPageSize:_e(new Di(3,"accessibilityPageSize",500,1,1073741824,{description:_(435,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),allowOverflow:_e(new Ot(4,"allowOverflow",!0)),allowVariableLineHeights:_e(new Ot(5,"allowVariableLineHeights",!0,{description:_(436,"Controls whether to allow using variable line heights in the editor.")})),allowVariableFonts:_e(new Ot(6,"allowVariableFonts",!0,{description:_(437,"Controls whether to allow using variable fonts in the editor.")})),allowVariableFontsInAccessibilityMode:_e(new Ot(7,"allowVariableFontsInAccessibilityMode",!1,{description:_(438,"Controls whether to allow using variable fonts in the editor in the accessibility mode."),tags:["accessibility"]})),ariaLabel:_e(new Ko(8,"ariaLabel",_(439,"Editor content"))),ariaRequired:_e(new Ot(9,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:_e(new Ot(12,"screenReaderAnnounceInlineSuggestion",!0,{description:_(440,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:_e(new mn(10,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",_(441,"Use language configurations to determine when to autoclose brackets."),_(442,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:_(443,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:_e(new mn(11,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",_(444,"Use language configurations to determine when to autoclose comments."),_(445,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:_(446,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:_e(new mn(13,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",_(447,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:_(448,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:_e(new mn(14,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",_(449,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:_(450,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:_e(new mn(15,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",_(451,"Use language configurations to determine when to autoclose quotes."),_(452,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:_(453,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:_e(new P0(16,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],C2e,{enumDescriptions:[_(454,"The editor will not insert indentation automatically."),_(455,"The editor will keep the current line's indentation."),_(456,"The editor will keep the current line's indentation and honor language defined brackets."),_(457,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),_(458,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:_(459,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),autoIndentOnPaste:_e(new Ot(17,"autoIndentOnPaste",!1,{description:_(460,"Controls whether the editor should automatically auto-indent the pasted content.")})),autoIndentOnPasteWithinString:_e(new Ot(18,"autoIndentOnPasteWithinString",!0,{description:_(461,"Controls whether the editor should automatically auto-indent the pasted content when pasted within a string. This takes effect when autoIndentOnPaste is true.")})),automaticLayout:_e(new Ot(19,"automaticLayout",!1)),autoSurround:_e(new mn(20,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[_(462,"Use language configurations to determine when to automatically surround selections."),_(463,"Surround with quotes but not brackets."),_(464,"Surround with brackets but not quotes."),""],description:_(465,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:_e(new J2e),bracketPairGuides:_e(new eMe),stickyTabStops:_e(new Ot(132,"stickyTabStops",!1,{description:_(466,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:_e(new Ot(23,"codeLens",!0,{description:_(467,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:_e(new Ko(24,"codeLensFontFamily","",{description:_(468,"Controls the font family for CodeLens.")})),codeLensFontSize:_e(new Di(25,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:_(469,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:_e(new Ot(26,"colorDecorators",!0,{description:_(470,"Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:_e(new mn(168,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[_(471,"Make the color picker appear both on click and hover of the color decorator"),_(472,"Make the color picker appear on hover of the color decorator"),_(473,"Make the color picker appear on click of the color decorator")],description:_(474,"Controls the condition to make a color picker appear from a color decorator.")})),colorDecoratorsLimit:_e(new Di(27,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:_(475,"Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:_e(new Ot(28,"columnSelection",!1,{description:_(476,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:_e(new y2e),contextmenu:_e(new Ot(30,"contextmenu",!0)),copyWithSyntaxHighlighting:_e(new Ot(31,"copyWithSyntaxHighlighting",!0,{description:_(477,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:_e(new P0(32,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],S2e,{description:_(478,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:_e(new mn(33,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[_(479,"Smooth caret animation is disabled."),_(480,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),_(481,"Smooth caret animation is always enabled.")],description:_(482,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:_e(new P0(34,"cursorStyle",Rs.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],OY,{description:_(483,"Controls the cursor style in insert input mode.")})),overtypeCursorStyle:_e(new P0(92,"overtypeCursorStyle",Rs.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],OY,{description:_(484,"Controls the cursor style in overtype input mode.")})),cursorSurroundingLines:_e(new Di(35,"cursorSurroundingLines",0,0,1073741824,{description:_(485,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:_e(new mn(36,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[_(486,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),_(487,"`cursorSurroundingLines` is enforced always.")],markdownDescription:_(488,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:_e(new Di(37,"cursorWidth",0,0,1073741824,{markdownDescription:_(489,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),cursorHeight:_e(new Di(38,"cursorHeight",0,0,1073741824,{markdownDescription:_(490,"Controls the height of the cursor when `#editor.cursorStyle#` is set to `line`. Cursor's max height depends on line height.")})),disableLayerHinting:_e(new Ot(39,"disableLayerHinting",!1)),disableMonospaceOptimizations:_e(new Ot(40,"disableMonospaceOptimizations",!1)),domReadOnly:_e(new Ot(41,"domReadOnly",!1)),dragAndDrop:_e(new Ot(42,"dragAndDrop",!0,{description:_(491,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:_e(new L2e),dropIntoEditor:_e(new rMe),editContext:_e(new Ot(44,"editContext",!0,{description:_(492,"Sets whether the EditContext API should be used instead of the text area to power input in the editor."),included:uU||Ese||ad})),renderRichScreenReaderContent:_e(new Ot(107,"renderRichScreenReaderContent",!1,{markdownDescription:_(493,"Whether to render rich screen reader content when the `#editor.editContext#` setting is enabled.")})),stickyScroll:_e(new O2e),experimentalGpuAcceleration:_e(new mn(46,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[_(494,"Use regular DOM-based rendering."),_(495,"Use GPU acceleration.")],description:_(496,"Controls whether to use the experimental GPU acceleration to render the editor.")})),experimentalWhitespaceRendering:_e(new mn(47,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[_(497,"Use a new rendering method with svgs."),_(498,"Use a new rendering method with font characters."),_(499,"Use the stable rendering method.")],description:_(500,"Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:_e(new Ko(48,"extraEditorClassName","")),fastScrollSensitivity:_e(new Ar(49,"fastScrollSensitivity",5,s=>s<=0?5:s,{markdownDescription:_(501,"Scrolling speed multiplier when pressing `Alt`.")})),find:_e(new I2e),fixedOverflowWidgets:_e(new Ot(51,"fixedOverflowWidgets",!1)),folding:_e(new Ot(52,"folding",!0,{description:_(502,"Controls whether the editor has code folding enabled.")})),foldingStrategy:_e(new mn(53,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[_(503,"Use a language-specific folding strategy if available, else the indentation-based one."),_(504,"Use the indentation-based folding strategy.")],description:_(505,"Controls the strategy for computing folding ranges.")})),foldingHighlight:_e(new Ot(54,"foldingHighlight",!0,{description:_(506,"Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:_e(new Ot(55,"foldingImportsByDefault",!1,{description:_(507,"Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:_e(new Di(56,"foldingMaximumRegions",5e3,10,65e3,{description:_(508,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:_e(new Ot(57,"unfoldOnClickAfterEndOfLine",!1,{description:_(509,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:_e(new Ko(58,"fontFamily",Or.fontFamily,{description:_(510,"Controls the font family.")})),fontInfo:_e(new E2e),fontLigatures2:_e(new gf),fontSize:_e(new N2e),fontWeight:_e(new aB),fontVariations:_e(new rB),formatOnPaste:_e(new Ot(64,"formatOnPaste",!1,{description:_(511,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:_e(new Ot(65,"formatOnType",!1,{description:_(512,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:_e(new Ot(66,"glyphMargin",!0,{description:_(513,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:_e(new R2e),hideCursorInOverviewRuler:_e(new Ot(68,"hideCursorInOverviewRuler",!1,{description:_(514,"Controls whether the cursor should be hidden in the overview ruler.")})),hover:_e(new M2e),inDiffEditor:_e(new Ot(70,"inDiffEditor",!1)),inertialScroll:_e(new Ot(158,"inertialScroll",!1,{description:_(515,"Make scrolling inertial - mostly useful with touchpad on linux.")})),letterSpacing:_e(new Ar(72,"letterSpacing",Or.letterSpacing,s=>Ar.clamp(s,-5,20),{description:_(516,"Controls the letter spacing in pixels.")})),lightbulb:_e(new P2e),lineDecorationsWidth:_e(new B2e),lineHeight:_e(new W2e),lineNumbers:_e(new K2e),lineNumbersMinChars:_e(new Di(77,"lineNumbersMinChars",5,1,300)),linkedEditing:_e(new Ot(78,"linkedEditing",!1,{description:_(517,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:_e(new Ot(79,"links",!0,{description:_(518,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:_e(new mn(80,"matchBrackets","always",["always","near","never"],{description:_(519,"Highlight matching brackets.")})),minimap:_e(new H2e),mouseStyle:_e(new mn(82,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:_e(new Ar(83,"mouseWheelScrollSensitivity",1,s=>s===0?1:s,{markdownDescription:_(520,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:_e(new Ot(84,"mouseWheelZoom",!1,{markdownDescription:Bt?_(521,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):_(522,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:_e(new Ot(85,"multiCursorMergeOverlapping",!0,{description:_(523,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:_e(new P0(86,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],V2e,{markdownEnumDescriptions:[_(524,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),_(525,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:_(526,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),mouseMiddleClickAction:_e(new mn(87,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:_(527,"Controls what happens when middle mouse button is clicked in the editor.")})),multiCursorPaste:_e(new mn(88,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[_(528,"Each cursor pastes a single line of the text."),_(529,"Each cursor pastes the full text.")],markdownDescription:_(530,"Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:_e(new Di(89,"multiCursorLimit",1e4,1,1e5,{markdownDescription:_(531,"Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:_e(new mn(90,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[_(532,"Does not highlight occurrences."),_(533,"Highlights occurrences only in the current file."),_(534,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:_(535,"Controls whether occurrences should be highlighted across open files.")})),occurrencesHighlightDelay:_e(new Di(91,"occurrencesHighlightDelay",0,0,2e3,{description:_(536,"Controls the delay in milliseconds after which occurrences are highlighted."),tags:["preview"]})),overtypeOnPaste:_e(new Ot(93,"overtypeOnPaste",!0,{description:_(537,"Controls whether pasting should overtype.")})),overviewRulerBorder:_e(new Ot(94,"overviewRulerBorder",!0,{description:_(538,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:_e(new Di(95,"overviewRulerLanes",3,0,3)),padding:_e(new z2e),pasteAs:_e(new aMe),parameterHints:_e(new U2e),peekWidgetDefaultFocus:_e(new mn(99,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[_(539,"Focus the tree when opening peek"),_(540,"Focus the editor when opening peek")],description:_(541,"Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:_e(new q2e),definitionLinkOpensInPeek:_e(new Ot(101,"definitionLinkOpensInPeek",!1,{description:_(542,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:_e(new j2e),quickSuggestionsDelay:_e(new Di(103,"quickSuggestionsDelay",10,0,1073741824,{description:_(543,"Controls the delay in milliseconds after which quick suggestions will show up."),experiment:{mode:"auto"}})),readOnly:_e(new Ot(104,"readOnly",!1)),readOnlyMessage:_e(new Y2e),renameOnType:_e(new Ot(106,"renameOnType",!1,{description:_(544,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:_(545,"Deprecated, use `#editor.linkedEditing#` instead.")})),renderControlCharacters:_e(new Ot(108,"renderControlCharacters",!0,{description:_(546,"Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:_e(new mn(109,"renderFinalNewline",Hr?"dimmed":"on",["off","on","dimmed"],{description:_(547,"Render last line number when the file ends with a newline.")})),renderLineHighlight:_e(new mn(110,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",_(548,"Highlights both the gutter and the current line.")],description:_(549,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:_e(new Ot(111,"renderLineHighlightOnlyWhenFocus",!1,{description:_(550,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:_e(new mn(112,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:_e(new mn(113,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",_(551,"Render whitespace characters except for single spaces between words."),_(552,"Render whitespace characters only on selected text."),_(553,"Render only trailing whitespace characters."),""],description:_(554,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:_e(new Di(114,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:_e(new Ot(115,"roundedSelection",!0,{description:_(555,"Controls whether selections should have rounded corners.")})),rulers:_e(new G2e),scrollbar:_e(new X2e),scrollBeyondLastColumn:_e(new Di(118,"scrollBeyondLastColumn",4,0,1073741824,{description:_(556,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:_e(new Ot(119,"scrollBeyondLastLine",!0,{description:_(557,"Controls whether the editor will scroll beyond the last line.")})),scrollOnMiddleClick:_e(new Ot(171,"scrollOnMiddleClick",!1,{description:_(558,"Controls whether the editor will scroll when the middle button is pressed.")})),scrollPredominantAxis:_e(new Ot(120,"scrollPredominantAxis",!0,{description:_(559,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:_e(new Ot(121,"selectionClipboard",!0,{description:_(560,"Controls whether the Linux primary clipboard should be supported."),included:Hr})),selectionHighlight:_e(new Ot(122,"selectionHighlight",!0,{description:_(561,"Controls whether the editor should highlight matches similar to the selection.")})),selectionHighlightMaxLength:_e(new Di(123,"selectionHighlightMaxLength",200,0,1073741824,{description:_(562,"Controls how many characters can be in the selection before similiar matches are not highlighted. Set to zero for unlimited.")})),selectionHighlightMultiline:_e(new Ot(124,"selectionHighlightMultiline",!1,{description:_(563,"Controls whether the editor should highlight selection matches that span multiple lines.")})),selectOnLineNumbers:_e(new Ot(125,"selectOnLineNumbers",!0)),showFoldingControls:_e(new mn(126,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[_(564,"Always show the folding controls."),_(565,"Never show the folding controls and reduce the gutter size."),_(566,"Only show the folding controls when the mouse is over the gutter.")],description:_(567,"Controls when the folding controls on the gutter are shown.")})),showUnused:_e(new Ot(127,"showUnused",!0,{description:_(568,"Controls fading out of unused code.")})),showDeprecated:_e(new Ot(157,"showDeprecated",!0,{description:_(569,"Controls strikethrough deprecated variables.")})),inlayHints:_e(new F2e),snippetSuggestions:_e(new mn(128,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[_(570,"Show snippet suggestions on top of other suggestions."),_(571,"Show snippet suggestions below other suggestions."),_(572,"Show snippets suggestions with other suggestions."),_(573,"Do not show snippet suggestions.")],description:_(574,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:_e(new iMe),smoothScrolling:_e(new Ot(130,"smoothScrolling",!1,{description:_(575,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:_e(new Di(133,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:_e(new tMe),inlineSuggest:_e(new Q2e),inlineCompletionsAccessibilityVerbose:_e(new Ot(169,"inlineCompletionsAccessibilityVerbose",!1,{description:_(576,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:_e(new Di(135,"suggestFontSize",0,0,1e3,{markdownDescription:_(577,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:_e(new Di(136,"suggestLineHeight",0,0,1e3,{markdownDescription:_(578,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:_e(new Ot(137,"suggestOnTriggerCharacters",!0,{description:_(579,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:_e(new mn(138,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[_(580,"Always select the first suggestion."),_(581,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),_(582,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:_(583,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:_e(new mn(139,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[_(584,"Tab complete will insert the best matching suggestion when pressing tab."),_(585,"Disable tab completions."),_(586,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:_(587,"Enables tab completions.")})),tabIndex:_e(new Di(140,"tabIndex",0,-1,1073741824)),trimWhitespaceOnDelete:_e(new Ot(141,"trimWhitespaceOnDelete",!1,{description:_(588,"Controls whether the editor will also delete the next line's indentation whitespace when deleting a newline.")})),unicodeHighlight:_e(new Z2e),unusualLineTerminators:_e(new mn(143,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[_(589,"Unusual line terminators are automatically removed."),_(590,"Unusual line terminators are ignored."),_(591,"Unusual line terminators prompt to be removed.")],description:_(592,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:_e(new Ot(144,"useShadowDOM",!0)),useTabStops:_e(new Ot(145,"useTabStops",!0,{description:_(593,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:_e(new mn(146,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[_(594,"Use the default line break rule."),_(595,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:_(596,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:_e(new nMe),wordSeparators:_e(new Ko(148,"wordSeparators",oR,{description:_(597,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:_e(new mn(149,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[_(598,"Lines will never wrap."),_(599,"Lines will wrap at the viewport width."),_(600,"Lines will wrap at `#editor.wordWrapColumn#`."),_(601,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:_(602,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:_e(new Ko(150,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:_e(new Ko(151,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:_e(new Di(152,"wordWrapColumn",80,1,1073741824,{markdownDescription:_(603,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:_e(new mn(153,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:_e(new mn(154,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:_e(new Ot(160,"wrapOnEscapedLineFeeds",!1,{markdownDescription:_(604,'Controls whether literal `\\n` shall trigger a wordWrap when `#editor.wordWrap#` is enabled.\n\nFor example:\n```c\nchar* str="hello\\nworld"\n```\nwill be displayed as\n```c\nchar* str="hello\\n\n           world"\n```')})),effectiveCursorStyle:_e(new k2e),editorClassName:_e(new x2e),defaultColorDecorators:_e(new mn(167,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[_(605,"Show default color decorators only when no extension provides colors decorators."),_(606,"Always show default color decorators."),_(607,"Never show default color decorators.")],description:_(608,"Controls whether inline color decorations should be shown using the default document color provider.")})),pixelRatio:_e(new $2e),tabFocusMode:_e(new Ot(164,"tabFocusMode",!1,{markdownDescription:_(609,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:_e(new b1),wrappingInfo:_e(new oMe),wrappingIndent:_e(new sMe),wrappingStrategy:_e(new A2e),effectiveEditContextEnabled:_e(new D2e),effectiveAllowVariableFonts:_e(new T2e)};class lMe extends K{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){const t=wL(e);let i=this._cache.get(t);return i||(i=new cMe,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){const t=this._ensureCache(e),i=t.getValues();let n=!1;for(const o of i)o.isTrusted||(n=!0,t.remove(o));n&&this._onDidChange.fire()}readFontInfo(e,t){const i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new hR({pixelRatio:DL.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){const o=new u2e(e,t);return i.push(o),n==null||n.push(o),o}_actualReadFontInfo(e,t){const i=[],n=[],o=this._createRequest("n",0,i,n),r=this._createRequest("ｍ",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),c=this._createRequest("1",0,i,n),d=this._createRequest("2",0,i,n),h=this._createRequest("3",0,i,n),u=this._createRequest("4",0,i,n),f=this._createRequest("5",0,i,n),g=this._createRequest("6",0,i,n),m=this._createRequest("7",0,i,n),p=this._createRequest("8",0,i,n),v=this._createRequest("9",0,i,n),b=this._createRequest("→",0,i,n),w=this._createRequest("￫",0,i,null),C=this._createRequest("·",0,i,n),y=this._createRequest("⸱",0,i,null),x="|/-_ilm%";for(let R=0,T=x.length;R<T;R++)this._createRequest(x.charAt(R),0,i,n),this._createRequest(x.charAt(R),1,i,n),this._createRequest(x.charAt(R),2,i,n);f2e(e,t,i);const S=Math.max(l.width,c.width,d.width,h.width,u.width,f.width,g.width,m.width,p.width,v.width);let L=t.fontFeatureSettings===gf.OFF;const E=n[0].width;for(let R=1,T=n.length;L&&R<T;R++){const A=E-n[R].width;if(A<-.001||A>.001){L=!1;break}}let M=!0;return L&&w.width!==E&&(M=!1),w.width>b.width&&(M=!1),new hR({pixelRatio:DL.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:L,typicalHalfwidthCharacterWidth:o.width,typicalFullwidthCharacterWidth:r.width,canUseHalfwidthRightwardsArrow:M,spaceWidth:a.width,middotWidth:C.width,wsmiddotWidth:y.width,maxDigitWidth:S},!0)}}class cMe{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const lB=new lMe,QC=class QC{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=QC._read(e,this.key),i=o=>QC._read(e,o),n=(o,r)=>QC._write(e,o,r);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u"||e===null)return;const i=t.indexOf(".");if(i>=0){const n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){const n=t.indexOf(".");if(n>=0){const o=t.substring(0,n);e[o]=e[o]||{},this._write(e[o],t.substring(n+1),i);return}e[t]=i}};QC.items=[];let TL=QC;function zl(s,e){TL.items.push(new TL(s,e))}function wr(s,e){zl(s,(t,i,n)=>{if(typeof t<"u"){for(const[o,r]of e)if(t===o){n(s,r);return}}})}function dMe(s){TL.items.forEach(e=>e.apply(s))}wr("wordWrap",[[!0,"on"],[!1,"off"]]);wr("lineNumbers",[[!0,"on"],[!1,"off"]]);wr("cursorBlinking",[["visible","solid"]]);wr("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);wr("renderLineHighlight",[[!0,"line"],[!1,"none"]]);wr("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);wr("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);wr("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);wr("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);wr("autoIndent",[[!1,"advanced"],[!0,"full"]]);wr("matchBrackets",[[!0,"always"],[!1,"never"]]);wr("renderFinalNewline",[[!0,"on"],[!1,"off"]]);wr("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);wr("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);wr("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);wr("defaultColorDecorators",[[!0,"auto"],[!1,"never"]]);wr("minimap.autohide",[[!0,"mouseover"],[!1,"none"]]);zl("autoClosingBrackets",(s,e,t)=>{s===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});zl("renderIndentGuides",(s,e,t)=>{typeof s<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!s))});zl("highlightActiveIndentGuide",(s,e,t)=>{typeof s<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!s))});const hMe={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};zl("suggest.filteredTypes",(s,e,t)=>{if(s&&typeof s=="object"){for(const i of Object.entries(hMe))s[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});zl("quickSuggestions",(s,e,t)=>{if(typeof s=="boolean"){const i=s?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});zl("experimental.stickyScroll.enabled",(s,e,t)=>{typeof s=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",s))});zl("experimental.stickyScroll.maxLineCount",(s,e,t)=>{typeof s=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",s))});zl("editor.experimentalEditContextEnabled",(s,e,t)=>{typeof s=="boolean"&&(t("editor.experimentalEditContextEnabled",void 0),typeof e("editor.editContext")>"u"&&t("editor.editContext",s))});zl("codeActionsOnSave",(s,e,t)=>{if(s&&typeof s=="object"){let i=!1;const n={};for(const o of Object.entries(s))typeof o[1]=="boolean"?(i=!0,n[o[0]]=o[1]?"explicit":"never"):n[o[0]]=o[1];i&&t("codeActionsOnSave",n)}});zl("codeActionWidget.includeNearbyQuickfixes",(s,e,t)=>{typeof s=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",s))});zl("lightbulb.enabled",(s,e,t)=>{typeof s=="boolean"&&t("lightbulb.enabled",s?void 0:"off")});zl("inlineSuggest.edits.codeShifting",(s,e,t)=>{typeof s=="boolean"&&(t("inlineSuggest.edits.codeShifting",void 0),t("inlineSuggest.edits.allowCodeShifting",s?"always":"never"))});class uMe{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new q,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const ww=new uMe;function fMe(s,e,t){const i=s.get(58),n=s.get(62),o=s.get(61),r=s.get(60),a=s.get(63),l=s.get(75),c=s.get(72);return Pb._create(i,n,o,r,a,l,c,e,t)}function gMe(s,e,t=!1){const i=Go.fontFamily.validate(s.fontFamily),n=Go.fontWeight.validate(s.fontWeight),o=Go.fontSize.validate(s.fontSize),r=Go.fontLigatures2.validate(s.fontLigatures),a=Go.fontVariations.validate(s.fontVariations),l=Go.lineHeight.validate(s.lineHeight),c=Go.letterSpacing.validate(s.letterSpacing);return Pb._create(i,n,o,r,a,l,c,e,t)}const so=Mt("accessibilityService"),a0=new Ne("accessibilityModeEnabled",!1);var mMe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},pMe=function(s,e){return function(t,i){e(t,i,s)}};let cB=class extends K{constructor(e,t,i,n,o){super(),this._accessibilityService=o,this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new q),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new cre,this.isSimpleWidget=e,this.contextMenuId=t,this._containerObserver=this._register(new ore(n,i.dimension)),this._targetWindowId=je(n).vscodeWindowId,this._rawOptions=BY(i),this._validatedOptions=lg.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(19)&&this._containerObserver.startObserving(),this._register(yl.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(ww.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(lB.onDidChange(()=>this._recomputeOptions())),this._register(DL.getInstance(je(n)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions())),this._register(X9.onDidChangeInputMode(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=lg.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=fMe(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:this._validatedOptions.get(164)||ww.getTabFocusMode(),inputMode:X9.getInputMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount,editContextSupported:e.editContextSupported};return lg.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:bMe(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:fO||Wr,pixelRatio:DL.getInstance(tY(this._targetWindowId,!0).window).value,editContextSupported:typeof globalThis.EditContext=="function",accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return lB.readFontInfo(tY(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=BY(e);lg.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=lg.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=_Me(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};cB=mMe([pMe(4,so)],cB);function _Me(s){let e=0;for(;s;)s=Math.floor(s/10),e++;return e||1}function bMe(){let s="";return Eb||yse?(s+="no-minimap-shadow ",s+="enable-user-select "):s+="no-user-select ",Bt&&(s+="mac "),s}class vMe{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class CMe{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class lg{static validateOptions(e){const t=new vMe;for(const i of EC){const n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new CMe;for(const n of EC)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?dn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!lg._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const o of EC){const r=!lg._deepEquals(e._read(o.id),t._read(o.id));i[o.id]=r,r&&(n=!0)}return n?new lre(i):null}static applyUpdate(e,t){let i=!1;for(const n of EC)if(t.hasOwnProperty(n.name)){const o=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=o.newValue,i=i||o.didChange}return i}}function BY(s){const e=Xd(s);return dMe(e),e}var vg;(function(s){const e={total:0,min:Number.MAX_VALUE,max:0},t={...e},i={...e},n={...e};let o=0;const r={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),r.keydown=1,queueMicrotask(l)}s.onKeyDown=a;function l(){r.keydown===1&&(performance.mark("keydown/end"),r.keydown=2)}function c(){performance.mark("input/start"),r.input=1,p()}s.onBeforeInput=c;function d(){r.input===0&&c(),queueMicrotask(h)}s.onInput=d;function h(){r.input===1&&(performance.mark("input/end"),r.input=2)}function u(){v()}s.onKeyUp=u;function f(){v()}s.onSelectionChange=f;function g(){r.keydown===2&&r.input===2&&r.render===0&&(performance.mark("render/start"),r.render=1,queueMicrotask(m),p())}s.onRenderStart=g;function m(){r.render===1&&(performance.mark("render/end"),r.render=2)}function p(){setTimeout(v)}function v(){r.keydown===2&&r.input===2&&r.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),b("keydown",e),b("input",t),b("render",i),b("inputlatency",n),o++,w())}function b(S,L){const E=performance.getEntriesByName(S)[0].duration;L.total+=E,L.min=Math.min(L.min,E),L.max=Math.max(L.max,E)}function w(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),r.keydown=0,r.input=0,r.render=0}function C(){if(o===0)return;const S={keydown:y(e),input:y(t),render:y(i),total:y(n),sampleCount:o};return x(e),x(t),x(i),x(n),o=0,S}s.getAndClearMeasurements=C;function y(S){return{average:S.total/o,max:S.max,min:S.min}}function x(S){S.total=0,S.min=Number.MAX_VALUE,S.max=0}})(vg||(vg={}));const gR=new Map;function wMe(){return new yMe}class yMe{constructor(){this._currentCssStyle="",this._styleSheet=void 0}setStyle(e){e!==this._currentCssStyle&&(this._currentCssStyle=e,this._styleSheet?this._styleSheet.textContent=e:this._styleSheet=Hl(Ti.document.head,t=>t.textContent=e))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}}function Hl(s=Ti.document.head,e,t){const i=document.createElement("style");if(i.type="text/css",i.media="screen",e==null||e(i),s.appendChild(i),t&&t.add(Ve(()=>i.remove())),s===Ti.document.head){const n=new Set;gR.set(i,n),t&&t.add(Ve(()=>gR.delete(i)));for(const{window:o,disposables:r}of hoe()){if(o===Ti)continue;const a=r.add(SMe(i,n,o));t==null||t.add(a)}}return i}function SMe(s,e,t){var o,r;const i=new oe,n=s.cloneNode(!0);t.document.head.appendChild(n),i.add(Ve(()=>n.remove()));for(const a of hre(s))(r=n.sheet)==null||r.insertRule(a.cssText,(o=n.sheet)==null?void 0:o.cssRules.length);return i.add(FTe.observe(s,i,{childList:!0,subtree:Wr,characterData:Wr})(()=>{n.textContent=s.textContent})),e.add(n),i.add(Ve(()=>e.delete(n))),i}let j5=null;function dre(){return j5||(j5=Hl()),j5}function hre(s){var e,t;return(e=s==null?void 0:s.sheet)!=null&&e.rules?s.sheet.rules:(t=s==null?void 0:s.sheet)!=null&&t.cssRules?s.sheet.cssRules:[]}function mR(s,e,t=dre()){var i;if(!(!t||!e)){(i=t.sheet)==null||i.insertRule(`${s} {${e}}`,0);for(const n of gR.get(t)??[])mR(s,e,n)}}function dB(s,e=dre()){var n;if(!e)return;const t=hre(e),i=[];for(let o=0;o<t.length;o++){const r=t[o];xMe(r)&&r.selectorText.indexOf(s)!==-1&&i.push(o)}for(let o=i.length-1;o>=0;o--)(n=e.sheet)==null||n.deleteRule(i[o]);for(const o of gR.get(e)??[])dB(s,o)}function xMe(s){return typeof s.selectorText=="string"}function LMe(s){const e=new oe,t=e.add(wMe());return e.add(lt(i=>{t.setStyle(s.read(i))})),e}class l0{constructor(){this._hooks=new oe,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=o;let r=e;try{e.setPointerCapture(t),this._hooks.add(Ve(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{r=je(e)}this._hooks.add(ee(r,ye.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(ee(r,ye.POINTER_UP,a=>this.stopMonitoring(!0)))}}function Bg(s,e){const t=Math.pow(10,e);return Math.round(s*t)/t}class ce{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Bg(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class rc{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Bg(Math.max(Math.min(1,t),0),3),this.l=Bg(Math.max(Math.min(1,i),0),3),this.a=Bg(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,o=e.a,r=Math.max(t,i,n),a=Math.min(t,i,n);let l=0,c=0;const d=(a+r)/2,h=r-a;if(h>0){switch(c=Math.min(d<=.5?h/(2*d):h/(2-2*d),1),r){case t:l=(i-n)/h+(i<n?6:0);break;case i:l=(n-t)/h+2;break;case n:l=(t-i)/h+4;break}l*=60,l=Math.round(l)}return new rc(l,c,d,o)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:o}=e;let r,a,l;if(i===0)r=a=l=n;else{const c=n<.5?n*(1+i):n+i-n*i,d=2*n-c;r=rc._hue2rgb(d,c,t+1/3),a=rc._hue2rgb(d,c,t),l=rc._hue2rgb(d,c,t-1/3)}return new ce(Math.round(r*255),Math.round(a*255),Math.round(l*255),o)}}class dh{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Bg(Math.max(Math.min(1,t),0),3),this.v=Bg(Math.max(Math.min(1,i),0),3),this.a=Bg(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,o=Math.max(t,i,n),r=Math.min(t,i,n),a=o-r,l=o===0?0:a/o;let c;return a===0?c=0:o===t?c=((i-n)/a%6+6)%6:o===i?c=(n-t)/a+2:c=(t-i)/a+4,new dh(Math.round(c*60),l,o,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:o}=e,r=n*i,a=r*(1-Math.abs(t/60%2-1)),l=n-r;let[c,d,h]=[0,0,0];return t<60?(c=r,d=a):t<120?(c=a,d=r):t<180?(d=r,h=a):t<240?(d=a,h=r):t<300?(c=a,h=r):t<=360&&(c=r,h=a),c=Math.round((c+l)*255),d=Math.round((d+l)*255),h=Math.round((h+l)*255),new ce(c,d,h,o)}}const Rn=class Rn{static fromHex(e){return Rn.Format.CSS.parseHex(e)||Rn.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:rc.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:dh.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof ce)this.rgba=e;else if(e instanceof rc)this._hsla=e,this.rgba=rc.toRGBA(e);else if(e instanceof dh)this._hsva=e,this.rgba=dh.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&ce.equals(this.rgba,e.rgba)&&rc.equals(this.hsla,e.hsla)&&dh.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=Rn._relativeLuminanceForComponent(this.rgba.r),t=Rn._relativeLuminanceForComponent(this.rgba.g),i=Rn._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return Bg(n,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new Rn(new rc(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Rn(new rc(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:o}=this.rgba;return new Rn(new ce(t,i,n,o*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new Rn(new ce(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}mix(e,t=.5){const i=Math.min(Math.max(t,0),1),n=this.rgba,o=e.rgba,r=n.r+(o.r-n.r)*i,a=n.g+(o.g-n.g)*i,l=n.b+(o.b-n.b)*i,c=n.a+(o.a-n.a)*i;return new Rn(new ce(r,a,l,c))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:n,a:o}=this.rgba;return new Rn(new ce(e.rgba.r-o*(e.rgba.r-t),e.rgba.g-o*(e.rgba.g-i),e.rgba.b-o*(e.rgba.b-n),1))}toString(){return this._toString||(this._toString=Rn.Format.CSS.format(this)),this._toString}toNumber32Bit(){return this._toNumber32Bit||(this._toNumber32Bit=(this.rgba.r<<24|this.rgba.g<<16|this.rgba.b<<8|this.rgba.a*255<<0)>>>0),this._toNumber32Bit}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(o-n)/o,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(n-o)/n,e.darken(i)}};Rn.white=new Rn(new ce(255,255,255,1)),Rn.black=new Rn(new ce(0,0,0,1)),Rn.red=new Rn(new ce(255,0,0,1)),Rn.blue=new Rn(new ce(0,0,255,1)),Rn.green=new Rn(new ce(0,255,0,1)),Rn.cyan=new Rn(new ce(0,255,255,1)),Rn.lightgrey=new Rn(new ce(211,211,211,1)),Rn.transparent=new Rn(new ce(0,0,0,0));let re=Rn;(function(s){(function(e){(function(t){function i(m){return m.rgba.a===1?`rgb(${m.rgba.r}, ${m.rgba.g}, ${m.rgba.b})`:s.Format.CSS.formatRGBA(m)}t.formatRGB=i;function n(m){return`rgba(${m.rgba.r}, ${m.rgba.g}, ${m.rgba.b}, ${+m.rgba.a.toFixed(2)})`}t.formatRGBA=n;function o(m){return m.hsla.a===1?`hsl(${m.hsla.h}, ${Math.round(m.hsla.s*100)}%, ${Math.round(m.hsla.l*100)}%)`:s.Format.CSS.formatHSLA(m)}t.formatHSL=o;function r(m){return`hsla(${m.hsla.h}, ${Math.round(m.hsla.s*100)}%, ${Math.round(m.hsla.l*100)}%, ${m.hsla.a.toFixed(2)})`}t.formatHSLA=r;function a(m){const p=m.toString(16);return p.length!==2?"0"+p:p}function l(m){return`#${a(m.rgba.r)}${a(m.rgba.g)}${a(m.rgba.b)}`}t.formatHex=l;function c(m,p=!1){return p&&m.rgba.a===1?s.Format.CSS.formatHex(m):`#${a(m.rgba.r)}${a(m.rgba.g)}${a(m.rgba.b)}${a(Math.round(m.rgba.a*255))}`}t.formatHexA=c;function d(m){return m.isOpaque()?s.Format.CSS.formatHex(m):s.Format.CSS.formatRGBA(m)}t.format=d;function h(m){var p,v,b,w,C,y,x;if(m==="transparent")return s.transparent;if(m.startsWith("#"))return f(m);if(m.startsWith("rgba(")){const S=m.match(/rgba\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+), *(?<a>(?:\+|-)?\d+(\.\d+)?)\)/);if(!S)throw new Error("Invalid color format "+m);const L=parseInt(((p=S.groups)==null?void 0:p.r)??"0"),E=parseInt(((v=S.groups)==null?void 0:v.g)??"0"),M=parseInt(((b=S.groups)==null?void 0:b.b)??"0"),R=parseFloat(((w=S.groups)==null?void 0:w.a)??"0");return new s(new ce(L,E,M,R))}if(m.startsWith("rgb(")){const S=m.match(/rgb\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+)\)/);if(!S)throw new Error("Invalid color format "+m);const L=parseInt(((C=S.groups)==null?void 0:C.r)??"0"),E=parseInt(((y=S.groups)==null?void 0:y.g)??"0"),M=parseInt(((x=S.groups)==null?void 0:x.b)??"0");return new s(new ce(L,E,M))}return u(m)}t.parse=h;function u(m){switch(m){case"aliceblue":return new s(new ce(240,248,255,1));case"antiquewhite":return new s(new ce(250,235,215,1));case"aqua":return new s(new ce(0,255,255,1));case"aquamarine":return new s(new ce(127,255,212,1));case"azure":return new s(new ce(240,255,255,1));case"beige":return new s(new ce(245,245,220,1));case"bisque":return new s(new ce(255,228,196,1));case"black":return new s(new ce(0,0,0,1));case"blanchedalmond":return new s(new ce(255,235,205,1));case"blue":return new s(new ce(0,0,255,1));case"blueviolet":return new s(new ce(138,43,226,1));case"brown":return new s(new ce(165,42,42,1));case"burlywood":return new s(new ce(222,184,135,1));case"cadetblue":return new s(new ce(95,158,160,1));case"chartreuse":return new s(new ce(127,255,0,1));case"chocolate":return new s(new ce(210,105,30,1));case"coral":return new s(new ce(255,127,80,1));case"cornflowerblue":return new s(new ce(100,149,237,1));case"cornsilk":return new s(new ce(255,248,220,1));case"crimson":return new s(new ce(220,20,60,1));case"cyan":return new s(new ce(0,255,255,1));case"darkblue":return new s(new ce(0,0,139,1));case"darkcyan":return new s(new ce(0,139,139,1));case"darkgoldenrod":return new s(new ce(184,134,11,1));case"darkgray":return new s(new ce(169,169,169,1));case"darkgreen":return new s(new ce(0,100,0,1));case"darkgrey":return new s(new ce(169,169,169,1));case"darkkhaki":return new s(new ce(189,183,107,1));case"darkmagenta":return new s(new ce(139,0,139,1));case"darkolivegreen":return new s(new ce(85,107,47,1));case"darkorange":return new s(new ce(255,140,0,1));case"darkorchid":return new s(new ce(153,50,204,1));case"darkred":return new s(new ce(139,0,0,1));case"darksalmon":return new s(new ce(233,150,122,1));case"darkseagreen":return new s(new ce(143,188,143,1));case"darkslateblue":return new s(new ce(72,61,139,1));case"darkslategray":return new s(new ce(47,79,79,1));case"darkslategrey":return new s(new ce(47,79,79,1));case"darkturquoise":return new s(new ce(0,206,209,1));case"darkviolet":return new s(new ce(148,0,211,1));case"deeppink":return new s(new ce(255,20,147,1));case"deepskyblue":return new s(new ce(0,191,255,1));case"dimgray":return new s(new ce(105,105,105,1));case"dimgrey":return new s(new ce(105,105,105,1));case"dodgerblue":return new s(new ce(30,144,255,1));case"firebrick":return new s(new ce(178,34,34,1));case"floralwhite":return new s(new ce(255,250,240,1));case"forestgreen":return new s(new ce(34,139,34,1));case"fuchsia":return new s(new ce(255,0,255,1));case"gainsboro":return new s(new ce(220,220,220,1));case"ghostwhite":return new s(new ce(248,248,255,1));case"gold":return new s(new ce(255,215,0,1));case"goldenrod":return new s(new ce(218,165,32,1));case"gray":return new s(new ce(128,128,128,1));case"green":return new s(new ce(0,128,0,1));case"greenyellow":return new s(new ce(173,255,47,1));case"grey":return new s(new ce(128,128,128,1));case"honeydew":return new s(new ce(240,255,240,1));case"hotpink":return new s(new ce(255,105,180,1));case"indianred":return new s(new ce(205,92,92,1));case"indigo":return new s(new ce(75,0,130,1));case"ivory":return new s(new ce(255,255,240,1));case"khaki":return new s(new ce(240,230,140,1));case"lavender":return new s(new ce(230,230,250,1));case"lavenderblush":return new s(new ce(255,240,245,1));case"lawngreen":return new s(new ce(124,252,0,1));case"lemonchiffon":return new s(new ce(255,250,205,1));case"lightblue":return new s(new ce(173,216,230,1));case"lightcoral":return new s(new ce(240,128,128,1));case"lightcyan":return new s(new ce(224,255,255,1));case"lightgoldenrodyellow":return new s(new ce(250,250,210,1));case"lightgray":return new s(new ce(211,211,211,1));case"lightgreen":return new s(new ce(144,238,144,1));case"lightgrey":return new s(new ce(211,211,211,1));case"lightpink":return new s(new ce(255,182,193,1));case"lightsalmon":return new s(new ce(255,160,122,1));case"lightseagreen":return new s(new ce(32,178,170,1));case"lightskyblue":return new s(new ce(135,206,250,1));case"lightslategray":return new s(new ce(119,136,153,1));case"lightslategrey":return new s(new ce(119,136,153,1));case"lightsteelblue":return new s(new ce(176,196,222,1));case"lightyellow":return new s(new ce(255,255,224,1));case"lime":return new s(new ce(0,255,0,1));case"limegreen":return new s(new ce(50,205,50,1));case"linen":return new s(new ce(250,240,230,1));case"magenta":return new s(new ce(255,0,255,1));case"maroon":return new s(new ce(128,0,0,1));case"mediumaquamarine":return new s(new ce(102,205,170,1));case"mediumblue":return new s(new ce(0,0,205,1));case"mediumorchid":return new s(new ce(186,85,211,1));case"mediumpurple":return new s(new ce(147,112,219,1));case"mediumseagreen":return new s(new ce(60,179,113,1));case"mediumslateblue":return new s(new ce(123,104,238,1));case"mediumspringgreen":return new s(new ce(0,250,154,1));case"mediumturquoise":return new s(new ce(72,209,204,1));case"mediumvioletred":return new s(new ce(199,21,133,1));case"midnightblue":return new s(new ce(25,25,112,1));case"mintcream":return new s(new ce(245,255,250,1));case"mistyrose":return new s(new ce(255,228,225,1));case"moccasin":return new s(new ce(255,228,181,1));case"navajowhite":return new s(new ce(255,222,173,1));case"navy":return new s(new ce(0,0,128,1));case"oldlace":return new s(new ce(253,245,230,1));case"olive":return new s(new ce(128,128,0,1));case"olivedrab":return new s(new ce(107,142,35,1));case"orange":return new s(new ce(255,165,0,1));case"orangered":return new s(new ce(255,69,0,1));case"orchid":return new s(new ce(218,112,214,1));case"palegoldenrod":return new s(new ce(238,232,170,1));case"palegreen":return new s(new ce(152,251,152,1));case"paleturquoise":return new s(new ce(175,238,238,1));case"palevioletred":return new s(new ce(219,112,147,1));case"papayawhip":return new s(new ce(255,239,213,1));case"peachpuff":return new s(new ce(255,218,185,1));case"peru":return new s(new ce(205,133,63,1));case"pink":return new s(new ce(255,192,203,1));case"plum":return new s(new ce(221,160,221,1));case"powderblue":return new s(new ce(176,224,230,1));case"purple":return new s(new ce(128,0,128,1));case"rebeccapurple":return new s(new ce(102,51,153,1));case"red":return new s(new ce(255,0,0,1));case"rosybrown":return new s(new ce(188,143,143,1));case"royalblue":return new s(new ce(65,105,225,1));case"saddlebrown":return new s(new ce(139,69,19,1));case"salmon":return new s(new ce(250,128,114,1));case"sandybrown":return new s(new ce(244,164,96,1));case"seagreen":return new s(new ce(46,139,87,1));case"seashell":return new s(new ce(255,245,238,1));case"sienna":return new s(new ce(160,82,45,1));case"silver":return new s(new ce(192,192,192,1));case"skyblue":return new s(new ce(135,206,235,1));case"slateblue":return new s(new ce(106,90,205,1));case"slategray":return new s(new ce(112,128,144,1));case"slategrey":return new s(new ce(112,128,144,1));case"snow":return new s(new ce(255,250,250,1));case"springgreen":return new s(new ce(0,255,127,1));case"steelblue":return new s(new ce(70,130,180,1));case"tan":return new s(new ce(210,180,140,1));case"teal":return new s(new ce(0,128,128,1));case"thistle":return new s(new ce(216,191,216,1));case"tomato":return new s(new ce(255,99,71,1));case"turquoise":return new s(new ce(64,224,208,1));case"violet":return new s(new ce(238,130,238,1));case"wheat":return new s(new ce(245,222,179,1));case"white":return new s(new ce(255,255,255,1));case"whitesmoke":return new s(new ce(245,245,245,1));case"yellow":return new s(new ce(255,255,0,1));case"yellowgreen":return new s(new ce(154,205,50,1));default:return null}}function f(m){const p=m.length;if(p===0||m.charCodeAt(0)!==35)return null;if(p===7){const v=16*g(m.charCodeAt(1))+g(m.charCodeAt(2)),b=16*g(m.charCodeAt(3))+g(m.charCodeAt(4)),w=16*g(m.charCodeAt(5))+g(m.charCodeAt(6));return new s(new ce(v,b,w,1))}if(p===9){const v=16*g(m.charCodeAt(1))+g(m.charCodeAt(2)),b=16*g(m.charCodeAt(3))+g(m.charCodeAt(4)),w=16*g(m.charCodeAt(5))+g(m.charCodeAt(6)),C=16*g(m.charCodeAt(7))+g(m.charCodeAt(8));return new s(new ce(v,b,w,C/255))}if(p===4){const v=g(m.charCodeAt(1)),b=g(m.charCodeAt(2)),w=g(m.charCodeAt(3));return new s(new ce(16*v+v,16*b+b,16*w+w))}if(p===5){const v=g(m.charCodeAt(1)),b=g(m.charCodeAt(2)),w=g(m.charCodeAt(3)),C=g(m.charCodeAt(4));return new s(new ce(16*v+v,16*b+b,16*w+w,(16*C+C)/255))}return null}t.parseHex=f;function g(m){switch(m){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(s.Format||(s.Format={}))})(re||(re={}));function n$(s){return`--vscode-${s.replace(/\./g,"-")}`}function ve(s){return`var(${n$(s)})`}function ure(s,e){return`var(${n$(s)}, ${e})`}function IMe(s){return s!==null&&typeof s=="object"&&"light"in s&&"dark"in s}const fre={ColorContribution:"base.contributions.colors"},EMe="default";class kMe extends K{constructor(){super(),this._onDidChangeSchema=this._register(new q),this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,o){const r={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:o};this.colorsById[e]=r;const a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=_(2022,"This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:EMe,description:_(2023,"Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i!=null&&i.defaults){const n=IMe(i.defaults)?i.defaults[t.type]:i.defaults;return rl(n,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const n=t.indexOf(".")===-1?0:1,o=i.indexOf(".")===-1?0:1;return n!==o?n-o:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const zO=new kMe;kn.add(fre.ColorContribution,zO);function F(s,e,t,i,n){return zO.registerColor(s,e,t,i,n)}function DMe(s,e){var t,i,n,o;switch(s.op){case 0:return(t=rl(s.value,e))==null?void 0:t.darken(s.factor);case 1:return(i=rl(s.value,e))==null?void 0:i.lighten(s.factor);case 2:return(n=rl(s.value,e))==null?void 0:n.transparent(s.factor);case 7:{const r=rl(s.color,e)||re.transparent,a=rl(s.with,e)||re.transparent;return r.mix(a,s.ratio)}case 3:{const r=rl(s.background,e);return r?(o=rl(s.value,e))==null?void 0:o.makeOpaque(r):rl(s.value,e)}case 4:for(const r of s.values){const a=rl(r,e);if(a)return a}return;case 6:return rl(e.defines(s.if)?s.then:s.else,e);case 5:{const r=rl(s.value,e);if(!r)return;const a=rl(s.background,e);return a?r.isDarkerThan(a)?re.getLighterColor(r,a,s.factor).transparent(s.transparency):re.getDarkerColor(r,a,s.factor).transparent(s.transparency):r.transparent(s.factor*s.transparency)}default:throw nk()}}function Pr(s,e){return{op:0,value:s,factor:e}}function sd(s,e){return{op:1,value:s,factor:e}}function Ct(s,e){return{op:2,value:s,factor:e}}function NL(...s){return{op:4,values:s}}function TMe(s,e,t){return{op:6,if:s,then:e,else:t}}function WY(s,e,t,i){return{op:5,value:s,background:e,factor:t,transparency:i}}function rl(s,e){if(s!==null){if(typeof s=="string")return s[0]==="#"?re.fromHex(s):e.getColor(s);if(s instanceof re)return s;if(typeof s=="object")return DMe(s,e)}}const gre="vscode://schemas/workbench-colors",mre=kn.as(BO.JSONContribution);mre.registerSchema(gre,zO.getColorSchema());const HY=new Ni(()=>mre.notifySchemaChanged(gre),200);zO.onDidChangeSchema(()=>{HY.isScheduled()||HY.schedule()});const Ht=F("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},_(1773,"Overall foreground color. This color is only used if not overridden by a component."));F("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},_(1774,"Overall foreground for disabled elements. This color is only used if not overridden by a component."));F("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},_(1775,"Overall foreground color for error messages. This color is only used if not overridden by a component."));const pre=F("descriptionForeground",{light:"#717171",dark:Ct(Ht,.7),hcDark:Ct(Ht,.7),hcLight:Ct(Ht,.7)},_(1776,"Foreground color for description text providing additional information, for example for a label.")),pR=F("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},_(1777,"The default color for icons in the workbench.")),xh=F("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},_(1778,"Overall border color for focused elements. This color is only used if not overridden by a component.")),Yt=F("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},_(1779,"An extra border around elements to separate them from others for greater contrast.")),fn=F("contrastActiveBorder",{light:null,dark:null,hcDark:xh,hcLight:xh},_(1780,"An extra border around active elements to separate them from others for greater contrast."));F("selection.background",null,_(1781,"The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const NMe=F("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},_(1782,"Foreground color for links in text."));F("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},_(1783,"Foreground color for links in text when clicked on and on mouse hover."));F("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:re.black,hcLight:"#292929"},_(1784,"Color for text separators."));F("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},_(1785,"Foreground color for preformatted text segments."));F("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},_(1786,"Background color for preformatted text segments."));F("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},_(1787,"Background color for block quotes in text."));F("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:re.white,hcLight:"#292929"},_(1788,"Border color for block quotes in text."));F("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:re.black,hcLight:"#F2F2F2"},_(1789,"Background color for code blocks in text."));F("sash.hoverBorder",xh,_(1994,"Border color of active sashes."));const KT=F("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:re.black,hcLight:"#0F4A85"},_(1995,"Badge background color. Badges are small information labels, e.g. for search results count.")),RMe=F("badge.foreground",{dark:re.white,light:"#333",hcDark:re.white,hcLight:re.white},_(1996,"Badge foreground color. Badges are small information labels, e.g. for search results count."));F("activityWarningBadge.foreground",{dark:re.black.lighten(.2),light:re.white,hcDark:null,hcLight:re.black.lighten(.2)},_(1997,"Foreground color of the warning activity badge"));F("activityWarningBadge.background",{dark:"#CCA700",light:"#BF8803",hcDark:null,hcLight:"#CCA700"},_(1998,"Background color of the warning activity badge"));F("activityErrorBadge.foreground",{dark:re.black.lighten(.2),light:re.white,hcDark:null,hcLight:re.black.lighten(.2)},_(1999,"Foreground color of the error activity badge"));F("activityErrorBadge.background",{dark:"#F14C4C",light:"#E51400",hcDark:null,hcLight:"#F14C4C"},_(2e3,"Background color of the error activity badge"));const UO=F("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},_(2001,"Scrollbar shadow to indicate that the view is scrolled.")),_re=F("scrollbarSlider.background",{dark:re.fromHex("#797979").transparent(.4),light:re.fromHex("#646464").transparent(.4),hcDark:Ct(Yt,.6),hcLight:Ct(Yt,.4)},_(2002,"Scrollbar slider background color.")),bre=F("scrollbarSlider.hoverBackground",{dark:re.fromHex("#646464").transparent(.7),light:re.fromHex("#646464").transparent(.7),hcDark:Ct(Yt,.8),hcLight:Ct(Yt,.8)},_(2003,"Scrollbar slider background color when hovering.")),vre=F("scrollbarSlider.activeBackground",{dark:re.fromHex("#BFBFBF").transparent(.4),light:re.fromHex("#000000").transparent(.6),hcDark:Yt,hcLight:Yt},_(2004,"Scrollbar slider background color when clicked on."));F("scrollbar.background",null,_(2005,"Scrollbar track background color."));const MMe=F("progressBar.background",{dark:re.fromHex("#0E70C0"),light:re.fromHex("#0E70C0"),hcDark:Yt,hcLight:Yt},_(2006,"Background color of the progress bar that can show for long running operations."));F("chart.line",{dark:"#236B8E",light:"#236B8E",hcDark:"#236B8E",hcLight:"#236B8E"},_(2007,"Line color for the chart."));F("chart.axis",{dark:re.fromHex("#BFBFBF").transparent(.4),light:re.fromHex("#000000").transparent(.6),hcDark:Yt,hcLight:Yt},_(2008,"Axis color for the chart."));F("chart.guide",{dark:re.fromHex("#BFBFBF").transparent(.2),light:re.fromHex("#000000").transparent(.2),hcDark:Yt,hcLight:Yt},_(2009,"Guide line for the chart."));const es=F("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:re.black,hcLight:re.white},_(1798,"Editor background color.")),Ph=F("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:re.white,hcLight:Ht},_(1799,"Editor default foreground color."));F("editorStickyScroll.background",es,_(1800,"Background color of sticky scroll in the editor"));F("editorStickyScrollGutter.background",es,_(1801,"Background color of the gutter part of sticky scroll in the editor"));F("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:re.fromHex("#0F4A85").transparent(.1)},_(1802,"Background color of sticky scroll on hover in the editor"));F("editorStickyScroll.border",{dark:null,light:null,hcDark:Yt,hcLight:Yt},_(1803,"Border color of sticky scroll in the editor"));F("editorStickyScroll.shadow",UO,_(1804," Shadow color of sticky scroll in the editor"));const ja=F("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:re.white},_(1805,"Background color of editor widgets, such as find/replace.")),$O=F("editorWidget.foreground",Ht,_(1806,"Foreground color of editor widgets, such as find/replace.")),s$=F("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Yt,hcLight:Yt},_(1807,"Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));F("editorWidget.resizeBorder",null,_(1808,"Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));F("editorError.background",null,_(1809,"Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const qO=F("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},_(1810,"Foreground color of error squigglies in the editor.")),AMe=F("editorError.border",{dark:null,light:null,hcDark:re.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},_(1811,"If set, color of double underlines for errors in the editor.")),PMe=F("editorWarning.background",null,_(1812,"Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),mf=F("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},_(1813,"Foreground color of warning squigglies in the editor.")),RL=F("editorWarning.border",{dark:null,light:null,hcDark:re.fromHex("#FFCC00").transparent(.8),hcLight:re.fromHex("#FFCC00").transparent(.8)},_(1814,"If set, color of double underlines for warnings in the editor."));F("editorInfo.background",null,_(1815,"Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const Lh=F("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},_(1816,"Foreground color of info squigglies in the editor.")),ML=F("editorInfo.border",{dark:null,light:null,hcDark:re.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},_(1817,"If set, color of double underlines for infos in the editor.")),OMe=F("editorHint.foreground",{dark:re.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},_(1818,"Foreground color of hint squigglies in the editor."));F("editorHint.border",{dark:null,light:null,hcDark:re.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},_(1819,"If set, color of double underlines for hints in the editor."));const FMe=F("editorLink.activeForeground",{dark:"#4E94CE",light:re.blue,hcDark:re.cyan,hcLight:"#292929"},_(1820,"Color of active links.")),Cg=F("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},_(1821,"Color of the editor selection.")),BMe=F("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:re.white},_(1822,"Color of the selected text for high contrast.")),Cre=F("editor.inactiveSelectionBackground",{light:Ct(Cg,.5),dark:Ct(Cg,.5),hcDark:Ct(Cg,.7),hcLight:Ct(Cg,.5)},_(1823,"Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),o$=F("editor.selectionHighlightBackground",{light:WY(Cg,es,.3,.6),dark:WY(Cg,es,.3,.6),hcDark:null,hcLight:null},_(1824,"Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:fn,hcLight:fn},_(1825,"Border color for regions with the same content as the selection."));F("editor.compositionBorder",{light:"#000000",dark:"#ffffff",hcLight:"#000000",hcDark:"#ffffff"},_(1826,"The border color for an IME composition."));F("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},_(1827,"Color of the current search match."));const WMe=F("editor.findMatchForeground",null,_(1828,"Text color of the current search match.")),Pu=F("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},_(1829,"Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),HMe=F("editor.findMatchHighlightForeground",null,_(1830,"Foreground color of the other search matches."),!0);F("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},_(1831,"Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.findMatchBorder",{light:null,dark:null,hcDark:fn,hcLight:fn},_(1832,"Border color of the current search match."));const wg=F("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:fn,hcLight:fn},_(1833,"Border color of the other search matches.")),VMe=F("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Ct(fn,.4),hcLight:Ct(fn,.4)},_(1834,"Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},_(1835,"Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const _R=F("editorHoverWidget.background",ja,_(1836,"Background color of the editor hover.")),VY=F("editorHoverWidget.foreground",$O,_(1837,"Foreground color of the editor hover.")),r$=F("editorHoverWidget.border",s$,_(1838,"Border color of the editor hover."));F("editorHoverWidget.statusBarBackground",{dark:sd(_R,.2),light:Pr(_R,.05),hcDark:ja,hcLight:ja},_(1839,"Background color of the editor hover status bar."));const a$=F("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:re.white,hcLight:re.black},_(1840,"Foreground color of inline hints")),l$=F("editorInlayHint.background",{dark:Ct(KT,.1),light:Ct(KT,.1),hcDark:Ct(re.white,.1),hcLight:Ct(KT,.1)},_(1841,"Background color of inline hints")),zMe=F("editorInlayHint.typeForeground",a$,_(1842,"Foreground color of inline hints for types")),UMe=F("editorInlayHint.typeBackground",l$,_(1843,"Background color of inline hints for types")),$Me=F("editorInlayHint.parameterForeground",a$,_(1844,"Foreground color of inline hints for parameters")),qMe=F("editorInlayHint.parameterBackground",l$,_(1845,"Background color of inline hints for parameters")),jMe=F("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},_(1846,"The color used for the lightbulb actions icon."));F("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_(1847,"The color used for the lightbulb auto fix actions icon."));F("editorLightBulbAi.foreground",jMe,_(1848,"The color used for the lightbulb AI icon."));F("editor.snippetTabstopHighlightBackground",{dark:new re(new ce(124,124,124,.3)),light:new re(new ce(10,50,100,.2)),hcDark:new re(new ce(124,124,124,.3)),hcLight:new re(new ce(10,50,100,.2))},_(1849,"Highlight background color of a snippet tabstop."));F("editor.snippetTabstopHighlightBorder",null,_(1850,"Highlight border color of a snippet tabstop."));F("editor.snippetFinalTabstopHighlightBackground",null,_(1851,"Highlight background color of the final tabstop of a snippet."));F("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new re(new ce(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},_(1852,"Highlight border color of the final tabstop of a snippet."));const hB=new re(new ce(155,185,85,.2)),uB=new re(new ce(255,0,0,.2)),Kp=F("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},_(1853,"Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),yg=F("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},_(1854,"Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),dD=F("diffEditor.insertedLineBackground",{dark:hB,light:hB,hcDark:null,hcLight:null},_(1855,"Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);F("diffEditor.removedLineBackground",{dark:uB,light:uB,hcDark:null,hcLight:null},_(1856,"Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);F("diffEditorGutter.insertedLineBackground",null,_(1857,"Background color for the margin where lines got inserted."));F("diffEditorGutter.removedLineBackground",null,_(1858,"Background color for the margin where lines got removed."));const KMe=F("diffEditorOverview.insertedForeground",null,_(1859,"Diff overview ruler foreground for inserted content.")),GMe=F("diffEditorOverview.removedForeground",null,_(1860,"Diff overview ruler foreground for removed content."));F("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},_(1861,"Outline color for the text that got inserted."));F("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},_(1862,"Outline color for text that got removed."));F("diffEditor.border",{dark:null,light:null,hcDark:Yt,hcLight:Yt},_(1863,"Border color between the two text editors."));F("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},_(1864,"Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));F("diffEditor.unchangedRegionBackground","sideBar.background",_(1865,"The background color of unchanged blocks in the diff editor."));F("diffEditor.unchangedRegionForeground","foreground",_(1866,"The foreground color of unchanged blocks in the diff editor."));F("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},_(1867,"The background color of unchanged code in the diff editor."));const c0=F("widget.shadow",{dark:Ct(re.black,.36),light:Ct(re.black,.16),hcDark:null,hcLight:null},_(1868,"Shadow color of widgets such as find/replace inside the editor.")),c$=F("widget.border",{dark:null,light:null,hcDark:Yt,hcLight:Yt},_(1869,"Border color of widgets such as find/replace inside the editor.")),zY=F("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},_(1870,"Toolbar background when hovering over actions using the mouse"));F("toolbar.hoverOutline",{dark:null,light:null,hcDark:fn,hcLight:fn},_(1871,"Toolbar outline when hovering over actions using the mouse"));F("toolbar.activeBackground",{dark:sd(zY,.1),light:Pr(zY,.1),hcDark:null,hcLight:null},_(1872,"Toolbar background when holding the mouse over actions"));const YMe=F("breadcrumb.foreground",Ct(Ht,.8),_(1873,"Color of focused breadcrumb items.")),XMe=F("breadcrumb.background",es,_(1874,"Background color of breadcrumb items.")),UY=F("breadcrumb.focusForeground",{light:Pr(Ht,.2),dark:sd(Ht,.1),hcDark:sd(Ht,.1),hcLight:sd(Ht,.1)},_(1875,"Color of focused breadcrumb items.")),ZMe=F("breadcrumb.activeSelectionForeground",{light:Pr(Ht,.2),dark:sd(Ht,.1),hcDark:sd(Ht,.1),hcLight:sd(Ht,.1)},_(1876,"Color of selected breadcrumb items."));F("breadcrumbPicker.background",ja,_(1877,"Background color of breadcrumb item picker."));const wre=.5,$Y=re.fromHex("#40C8AE").transparent(wre),qY=re.fromHex("#40A6FF").transparent(wre),jY=re.fromHex("#606060").transparent(.4),d$=.4,yw=1,fB=F("merge.currentHeaderBackground",{dark:$Y,light:$Y,hcDark:null,hcLight:null},_(1878,"Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);F("merge.currentContentBackground",Ct(fB,d$),_(1879,"Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const gB=F("merge.incomingHeaderBackground",{dark:qY,light:qY,hcDark:null,hcLight:null},_(1880,"Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);F("merge.incomingContentBackground",Ct(gB,d$),_(1881,"Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mB=F("merge.commonHeaderBackground",{dark:jY,light:jY,hcDark:null,hcLight:null},_(1882,"Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);F("merge.commonContentBackground",Ct(mB,d$),_(1883,"Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Sw=F("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},_(1884,"Border color on headers and the splitter in inline merge-conflicts."));F("editorOverviewRuler.currentContentForeground",{dark:Ct(fB,yw),light:Ct(fB,yw),hcDark:Sw,hcLight:Sw},_(1885,"Current overview ruler foreground for inline merge-conflicts."));F("editorOverviewRuler.incomingContentForeground",{dark:Ct(gB,yw),light:Ct(gB,yw),hcDark:Sw,hcLight:Sw},_(1886,"Incoming overview ruler foreground for inline merge-conflicts."));F("editorOverviewRuler.commonContentForeground",{dark:Ct(mB,yw),light:Ct(mB,yw),hcDark:Sw,hcLight:Sw},_(1887,"Common ancestor overview ruler foreground for inline merge-conflicts."));const K5=F("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},_(1888,"Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),yre=F("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",_(1889,"Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),QMe=F("problemsErrorIcon.foreground",qO,_(1890,"The color used for the problems error icon.")),JMe=F("problemsWarningIcon.foreground",mf,_(1891,"The color used for the problems warning icon.")),eAe=F("problemsInfoIcon.foreground",Lh,_(1892,"The color used for the problems info icon.")),pB=F("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},_(1983,"Minimap marker color for find matches."),!0),jO=F("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},_(1984,"Minimap marker color for repeating editor selections."),!0),KY=F("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},_(1985,"Minimap marker color for the editor selection."),!0),tAe=F("minimap.infoHighlight",{dark:Lh,light:Lh,hcDark:ML,hcLight:ML},_(1986,"Minimap marker color for infos.")),iAe=F("minimap.warningHighlight",{dark:mf,light:mf,hcDark:RL,hcLight:RL},_(1987,"Minimap marker color for warnings.")),nAe=F("minimap.errorHighlight",{dark:new re(new ce(255,18,18,.7)),light:new re(new ce(255,18,18,.7)),hcDark:new re(new ce(255,50,50,1)),hcLight:"#B5200D"},_(1988,"Minimap marker color for errors.")),sAe=F("minimap.background",null,_(1989,"Minimap background color.")),oAe=F("minimap.foregroundOpacity",re.fromHex("#000f"),_(1990,'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));F("minimapSlider.background",Ct(_re,.5),_(1991,"Minimap slider background color."));F("minimapSlider.hoverBackground",Ct(bre,.5),_(1992,"Minimap slider background color when hovering."));F("minimapSlider.activeBackground",Ct(vre,.5),_(1993,"Minimap slider background color when clicked on."));F("charts.foreground",Ht,_(1790,"The foreground color used in charts."));F("charts.lines",Ct(Ht,.5),_(1791,"The color used for horizontal lines in charts."));F("charts.red",qO,_(1792,"The red color used in chart visualizations."));F("charts.blue",Lh,_(1793,"The blue color used in chart visualizations."));F("charts.yellow",mf,_(1794,"The yellow color used in chart visualizations."));F("charts.orange",pB,_(1795,"The orange color used in chart visualizations."));F("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},_(1796,"The green color used in chart visualizations."));F("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_(1797,"The purple color used in chart visualizations."));const _B=F("input.background",{dark:"#3C3C3C",light:re.white,hcDark:re.black,hcLight:re.white},_(1893,"Input box background.")),Sre=F("input.foreground",Ht,_(1894,"Input box foreground.")),xre=F("input.border",{dark:null,light:null,hcDark:Yt,hcLight:Yt},_(1895,"Input box border.")),mk=F("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Yt,hcLight:Yt},_(1896,"Border color of activated options in input fields.")),rAe=F("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},_(1897,"Background color of activated options in input fields.")),d0=F("inputOption.activeBackground",{dark:Ct(xh,.4),light:Ct(xh,.2),hcDark:re.transparent,hcLight:re.transparent},_(1898,"Background hover color of options in input fields.")),pk=F("inputOption.activeForeground",{dark:re.white,light:re.black,hcDark:Ht,hcLight:Ht},_(1899,"Foreground color of activated options in input fields."));F("input.placeholderForeground",{light:Ct(Ht,.5),dark:Ct(Ht,.5),hcDark:Ct(Ht,.7),hcLight:Ct(Ht,.7)},_(1900,"Input box foreground color for placeholder text."));const aAe=F("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:re.black,hcLight:re.white},_(1901,"Input validation background color for information severity.")),lAe=F("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:Ht},_(1902,"Input validation foreground color for information severity.")),cAe=F("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Yt,hcLight:Yt},_(1903,"Input validation border color for information severity.")),dAe=F("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:re.black,hcLight:re.white},_(1904,"Input validation background color for warning severity.")),hAe=F("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:Ht},_(1905,"Input validation foreground color for warning severity.")),uAe=F("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Yt,hcLight:Yt},_(1906,"Input validation border color for warning severity.")),fAe=F("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:re.black,hcLight:re.white},_(1907,"Input validation background color for error severity.")),gAe=F("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:Ht},_(1908,"Input validation foreground color for error severity.")),mAe=F("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Yt,hcLight:Yt},_(1909,"Input validation border color for error severity.")),KO=F("dropdown.background",{dark:"#3C3C3C",light:re.white,hcDark:re.black,hcLight:re.white},_(1910,"Dropdown background.")),pAe=F("dropdown.listBackground",{dark:null,light:null,hcDark:re.black,hcLight:re.white},_(1911,"Dropdown list background.")),h$=F("dropdown.foreground",{dark:"#F0F0F0",light:Ht,hcDark:re.white,hcLight:Ht},_(1912,"Dropdown foreground.")),u$=F("dropdown.border",{dark:KO,light:"#CECECE",hcDark:Yt,hcLight:Yt},_(1913,"Dropdown border.")),GO=F("button.foreground",re.white,_(1914,"Button foreground color.")),_Ae=F("button.separator",Ct(GO,.4),_(1915,"Button separator color.")),Gp=F("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:re.black,hcLight:"#0F4A85"},_(1916,"Button background color.")),bAe=F("button.hoverBackground",{dark:sd(Gp,.2),light:Pr(Gp,.2),hcDark:Gp,hcLight:Gp},_(1917,"Button background color when hovering.")),vAe=F("button.border",Yt,_(1918,"Button border color.")),Lre=F("button.secondaryForeground",{dark:re.white,light:re.white,hcDark:re.white,hcLight:Ht},_(1919,"Secondary button foreground color.")),bR=F("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:re.white},_(1920,"Secondary button background color.")),CAe=F("button.secondaryHoverBackground",{dark:sd(bR,.2),light:Pr(bR,.2),hcDark:null,hcLight:null},_(1921,"Secondary button background color when hovering.")),CS=F("radio.activeForeground",pk,_(1922,"Foreground color of active radio option.")),wAe=F("radio.activeBackground",d0,_(1923,"Background color of active radio option.")),yAe=F("radio.activeBorder",mk,_(1924,"Border color of the active radio option.")),SAe=F("radio.inactiveForeground",null,_(1925,"Foreground color of inactive radio option.")),xAe=F("radio.inactiveBackground",null,_(1926,"Background color of inactive radio option.")),LAe=F("radio.inactiveBorder",{light:Ct(CS,.2),dark:Ct(CS,.2),hcDark:Ct(CS,.4),hcLight:Ct(CS,.2)},_(1927,"Border color of the inactive radio option.")),IAe=F("radio.inactiveHoverBackground",rAe,_(1928,"Background color of inactive active radio option when hovering.")),f$=F("checkbox.background",KO,_(1929,"Background color of checkbox widget."));F("checkbox.selectBackground",ja,_(1930,"Background color of checkbox widget when the element it's in is selected."));const g$=F("checkbox.foreground",h$,_(1931,"Foreground color of checkbox widget.")),EAe=F("checkbox.border",u$,_(1932,"Border color of checkbox widget."));F("checkbox.selectBorder",pR,_(1933,"Border color of checkbox widget when the element it's in is selected."));const kAe=F("checkbox.disabled.background",{op:7,color:f$,with:g$,ratio:.33},_(1934,"Background of a disabled checkbox.")),DAe=F("checkbox.disabled.foreground",{op:7,color:g$,with:f$,ratio:.33},_(1935,"Foreground of a disabled checkbox.")),TAe=F("keybindingLabel.background",{dark:new re(new ce(128,128,128,.17)),light:new re(new ce(221,221,221,.4)),hcDark:re.transparent,hcLight:re.transparent},_(1936,"Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),NAe=F("keybindingLabel.foreground",{dark:re.fromHex("#CCCCCC"),light:re.fromHex("#555555"),hcDark:re.white,hcLight:Ht},_(1937,"Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),RAe=F("keybindingLabel.border",{dark:new re(new ce(51,51,51,.6)),light:new re(new ce(204,204,204,.4)),hcDark:new re(new ce(111,195,223)),hcLight:Yt},_(1938,"Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),MAe=F("keybindingLabel.bottomBorder",{dark:new re(new ce(68,68,68,.6)),light:new re(new ce(187,187,187,.4)),hcDark:new re(new ce(111,195,223)),hcLight:Ht},_(1939,"Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),AAe=F("list.focusBackground",null,_(1940,"List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),PAe=F("list.focusForeground",null,_(1941,"List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),OAe=F("list.focusOutline",{dark:xh,light:xh,hcDark:fn,hcLight:fn},_(1942,"List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),FAe=F("list.focusAndSelectionOutline",null,_(1943,"List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Ob=F("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:re.fromHex("#0F4A85").transparent(.1)},_(1944,"List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),AL=F("list.activeSelectionForeground",{dark:re.white,light:re.white,hcDark:null,hcLight:null},_(1945,"List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Ire=F("list.activeSelectionIconForeground",null,_(1946,"List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),BAe=F("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:re.fromHex("#0F4A85").transparent(.1)},_(1947,"List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),WAe=F("list.inactiveSelectionForeground",null,_(1948,"List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),HAe=F("list.inactiveSelectionIconForeground",null,_(1949,"List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),VAe=F("list.inactiveFocusBackground",null,_(1950,"List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),zAe=F("list.inactiveFocusOutline",null,_(1951,"List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Ere=F("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:re.white.transparent(.1),hcLight:re.fromHex("#0F4A85").transparent(.1)},_(1952,"List/Tree background when hovering over items using the mouse.")),kre=F("list.hoverForeground",null,_(1953,"List/Tree foreground when hovering over items using the mouse.")),UAe=F("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},_(1954,"List/Tree drag and drop background when moving items over other items when using the mouse.")),$Ae=F("list.dropBetweenBackground",{dark:pR,light:pR,hcDark:null,hcLight:null},_(1955,"List/Tree drag and drop border color when moving items between items when using the mouse.")),kC=F("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:xh,hcLight:xh},_(1956,"List/Tree foreground color of the match highlights when searching inside the list/tree.")),qAe=F("list.focusHighlightForeground",{dark:kC,light:TMe(Ob,kC,"#BBE7FF"),hcDark:kC,hcLight:kC},_(1957,"List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));F("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},_(1958,"List/Tree foreground color for invalid items, for example an unresolved root in explorer."));F("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},_(1959,"Foreground color of list items containing errors."));F("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},_(1960,"Foreground color of list items containing warnings."));const jAe=F("listFilterWidget.background",{light:Pr(ja,0),dark:sd(ja,0),hcDark:ja,hcLight:ja},_(1961,"Background color of the type filter widget in lists and trees.")),KAe=F("listFilterWidget.outline",{dark:re.transparent,light:re.transparent,hcDark:"#f38518",hcLight:"#007ACC"},_(1962,"Outline color of the type filter widget in lists and trees.")),GAe=F("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Yt,hcLight:Yt},_(1963,"Outline color of the type filter widget in lists and trees, when there are no matches.")),YAe=F("listFilterWidget.shadow",c0,_(1964,"Shadow color of the type filter widget in lists and trees."));F("list.filterMatchBackground",{dark:Pu,light:Pu,hcDark:null,hcLight:null},_(1965,"Background color of the filtered match."));F("list.filterMatchBorder",{dark:wg,light:wg,hcDark:Yt,hcLight:fn},_(1966,"Border color of the filtered match."));F("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},_(1967,"List/Tree foreground color for items that are deemphasized."));const Dre=F("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},_(1968,"Tree stroke color for the indentation guides.")),XAe=F("tree.inactiveIndentGuidesStroke",Ct(Dre,.4),_(1969,"Tree stroke color for the indentation guides that are not active.")),ZAe=F("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},_(1970,"Table border color between columns.")),QAe=F("tree.tableOddRowsBackground",{dark:Ct(Ht,.04),light:Ct(Ht,.04),hcDark:null,hcLight:null},_(1971,"Background color for odd table rows."));F("editorActionList.background",ja,_(1972,"Action List background color."));const JAe=F("editorActionList.foreground",$O,_(1973,"Action List foreground color."));F("editorActionList.focusForeground",AL,_(1974,"Action List foreground color for the focused item."));F("editorActionList.focusBackground",Ob,_(1975,"Action List background color for the focused item."));const ePe=F("menu.border",{dark:null,light:null,hcDark:Yt,hcLight:Yt},_(1976,"Border color of menus.")),tPe=F("menu.foreground",h$,_(1977,"Foreground color of menu items.")),iPe=F("menu.background",KO,_(1978,"Background color of menu items.")),nPe=F("menu.selectionForeground",AL,_(1979,"Foreground color of the selected menu item in menus.")),sPe=F("menu.selectionBackground",Ob,_(1980,"Background color of the selected menu item in menus.")),oPe=F("menu.selectionBorder",{dark:null,light:null,hcDark:fn,hcLight:fn},_(1981,"Border color of the selected menu item in menus.")),rPe=F("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Yt,hcLight:Yt},_(1982,"Color of a separator menu item in menus.")),G5=F("quickInput.background",ja,_(2010,"Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),aPe=F("quickInput.foreground",$O,_(2011,"Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),lPe=F("quickInputTitle.background",{dark:new re(new ce(255,255,255,.105)),light:new re(new ce(0,0,0,.06)),hcDark:"#000000",hcLight:re.white},_(2012,"Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),Tre=F("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:re.white,hcLight:"#0F4A85"},_(2013,"Quick picker color for grouping labels.")),cPe=F("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:re.white,hcLight:"#0F4A85"},_(2014,"Quick picker color for grouping borders.")),GY=F("quickInput.list.focusBackground",null,"",void 0,_(2015,"Please use quickInputList.focusBackground instead")),PL=F("quickInputList.focusForeground",AL,_(2016,"Quick picker foreground color for the focused item.")),m$=F("quickInputList.focusIconForeground",Ire,_(2017,"Quick picker icon foreground color for the focused item.")),OL=F("quickInputList.focusBackground",{dark:NL(GY,Ob),light:NL(GY,Ob),hcDark:null,hcLight:null},_(2018,"Quick picker background color for the focused item."));F("search.resultsInfoForeground",{light:Ht,dark:Ct(Ht,.65),hcDark:Ht,hcLight:Ht},_(2019,"Color of the text in the search viewlet's completion message."));F("searchEditor.findMatchBackground",{light:Ct(Pu,.66),dark:Ct(Pu,.66),hcDark:Pu,hcLight:Pu},_(2020,"Color of the Search Editor query matches."));F("searchEditor.findMatchBorder",{light:Ct(wg,.66),dark:Ct(wg,.66),hcDark:wg,hcLight:wg},_(2021,"Border color of the Search Editor query matches."));class _k{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(e){return new Nre(this.x-e.scrollX,this.y-e.scrollY)}}class Nre{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(e){return new _k(this.clientX+e.scrollX,this.clientY+e.scrollY)}}class dPe{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class hPe{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function YO(s){const e=Fn(s);return new dPe(e.left,e.top,e.width,e.height)}function XO(s,e,t){const i=e.width/s.offsetWidth,n=e.height/s.offsetHeight,o=(t.x-e.x)/i,r=(t.y-e.y)/n;return new hPe(o,r)}class pf extends Co{constructor(e,t,i){super(je(i),e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new _k(this.posx,this.posy),this.editorPos=YO(i),this.relativePos=XO(i,this.editorPos,this.pos)}}class uPe{constructor(e){this._editorViewDomNode=e}_create(e){return new pf(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return ee(e,ye.CONTEXT_MENU,i=>{t(this._create(i))})}onMouseUp(e,t){return ee(e,ye.MOUSE_UP,i=>{t(this._create(i))})}onMouseDown(e,t){return ee(e,ye.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return ee(e,ye.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return ee(e,ye.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return ee(e,ye.MOUSE_MOVE,i=>t(this._create(i)))}}class fPe{constructor(e){this._editorViewDomNode=e}_create(e){return new pf(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return ee(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return ee(e,ye.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return ee(e,ye.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return ee(e,"pointermove",i=>t(this._create(i)))}}class gPe extends K{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new l0),this._keydownListener=null}startMonitoring(e,t,i,n,o){this._keydownListener=Jn(e.ownerDocument,"keydown",r=>{r.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,r.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,r=>{n(new pf(r,!0,this._editorViewDomNode))},r=>{this._keydownListener.dispose(),o(r)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}const fA=class fA{constructor(e){this._editor=e,this._instanceId=++fA._idPool,this._counter=0,this._rules=new gO,this._garbageCollectionScheduler=new Ni(()=>this.garbageCollect(),1e3)}dispose(){this._rules.dispose(),this._garbageCollectionScheduler.dispose()}createClassNameRef(e){const t=this.getOrCreateRule(e);return t.increaseRefCount(),{className:t.className,dispose:()=>{t.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(e){const t=this.computeUniqueKey(e);let i=this._rules.get(t);if(!i){const n=this._counter++;i=new mPe(t,`dyn-rule-${this._instanceId}-${n}`,QN(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,e),this._rules.set(t,i)}return i}computeUniqueKey(e){return JSON.stringify(e)}garbageCollect(){for(const e of this._rules.values())e.hasReferences()||this._rules.deleteAndDispose(e.key)}};fA._idPool=0;let vR=fA;class mPe{constructor(e,t,i,n){this.key=e,this.className=t,this.properties=n,this._referenceCount=0,this._styleElementDisposables=new oe,this._styleElement=Hl(i,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(e,t){let i=`.${e} {`;for(const n in t){const o=t[n];let r;typeof o=="object"?r=ve(o.id):r=o;const a=pPe(n);i+=`
	${a}: ${r};`}return i+=`
}`,i}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function pPe(s){return s.replace(/(^[A-Z])/,([e])=>e.toLowerCase()).replace(/([A-Z])/g,([e])=>`-${e.toLowerCase()}`)}class Cv extends K{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const o=e[i];switch(o.type){case 0:this.onCompositionStart(o)&&(t=!0);break;case 1:this.onCompositionEnd(o)&&(t=!0);break;case 2:this.onConfigurationChanged(o)&&(t=!0);break;case 3:this.onCursorStateChanged(o)&&(t=!0);break;case 4:this.onDecorationsChanged(o)&&(t=!0);break;case 5:this.onFlushed(o)&&(t=!0);break;case 6:this.onFocusChanged(o)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(t=!0);break;case 8:this.onLineMappingChanged(o)&&(t=!0);break;case 9:this.onLinesChanged(o)&&(t=!0);break;case 10:this.onLinesDeleted(o)&&(t=!0);break;case 11:this.onLinesInserted(o)&&(t=!0);break;case 12:this.onRevealRangeRequest(o)&&(t=!0);break;case 13:this.onScrollChanged(o)&&(t=!0);break;case 15:this.onTokensChanged(o)&&(t=!0);break;case 14:this.onThemeChanged(o)&&(t=!0);break;case 16:this.onTokensColorsChanged(o)&&(t=!0);break;case 17:this.onZonesChanged(o)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(o)}}t&&(this._shouldRender=!0)}}class yr extends Cv{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class dd{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const o=new Uint8Array(n);for(let r=0;r<n;r++)o[r]=i[n-r-1];return o}}class _Pe{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getLineHeightForLineNumber(e){return this._viewLayout.getLineHeightForLineNumber(e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class bPe extends _Pe{constructor(e,t,i,n){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i,this._viewLinesGpu=n}linesVisibleRangesForRange(e,t){const i=this._viewLines.linesVisibleRangesForRange(e,t);if(!this._viewLinesGpu)return i??null;const n=this._viewLinesGpu.linesVisibleRangesForRange(e,t);return i?n?i.concat(n).sort((o,r)=>o.lineNumber-r.lineNumber):i:n}visibleRangeForPosition(e){var t;return this._viewLines.visibleRangeForPosition(e)??((t=this._viewLinesGpu)==null?void 0:t.visibleRangeForPosition(e))??null}}class Rre{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class bk{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const o=e[i];t[i]=new bk(o.left,o.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class Wg{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class Mre{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class bB{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class GT{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,o){const r=this._createRange();try{return r.setStart(e,t),r.setEnd(i,n),r.getClientRects()}catch{return null}finally{this._detachRange(r,o)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Wg.compare);const t=[];let i=0,n=e[0];for(let o=1,r=e.length;o<r;o++){const a=e[o];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const n=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];n[o]=new Wg(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,o,r){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===o&&i===0&&!e.children[t].firstChild){const u=e.children[t].getClientRects();return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,r.clientRectDeltaLeft,r.clientRectScale)}t!==n&&n>0&&o===0&&(n--,o=1073741824);let c=e.children[t].firstChild,d=e.children[n].firstChild;if((!c||!d)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!d&&o===0&&n>0&&(d=e.children[n-1].firstChild,o=1073741824)),!c||!d)return null;i=Math.min(c.textContent.length,Math.max(0,i)),o=Math.min(d.textContent.length,Math.max(0,o));const h=this._readClientRects(c,i,d,o,r.endNode);return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,r.clientRectDeltaLeft,r.clientRectScale)}}class Qo{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,n=t.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!Qo._equals(e[o],t[o]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const n=t+1,o=i+1,r=i-t,a=[];let l=0;for(const c of e)c.endColumn<=n||c.startColumn>=o||(a[l++]=new Qo(Math.max(1,c.startColumn-n+1),Math.min(r+1,c.endColumn-n+1),c.className,c.type));return a}static filter(e,t,i,n){if(e.length===0)return[];const o=[];let r=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.range;if(d.endLineNumber<t||d.startLineNumber>t||d.isEmpty()&&(c.type===0||c.type===3))continue;const h=d.startLineNumber===t?d.startColumn:i,u=d.endLineNumber===t?d.endColumn:n;o[r++]=new Qo(h,u,c.inlineClassName,c.type)}return o}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=Qo._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class YY{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class CR{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new YY(t,this.stopOffsets[n],this.classNames.join(" "),CR._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new YY(t,e-1,this.classNames.join(" "),CR._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class vPe{static normalize(e,t){if(t.length===0)return[];const i=[],n=new CR;let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];let c=l.startColumn,d=l.endColumn;const h=l.className,u=l.type===1?2:l.type===2?4:0;if(c>1){const m=e.charCodeAt(c-2);vs(m)&&c--}if(d>1){const m=e.charCodeAt(d-2);vs(m)&&d--}const f=c-1,g=d-2;o=n.consumeLowerThan(f,o,i),n.count===0&&(o=f),n.insert(g,h,u)}return n.consumeLowerThan(1073741824,o,i),i}}class Cs{constructor(e,t,i,n){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=n,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class kf{get isLTR(){return!this.containsRTL&&this.textDirection!==qa.RTL}constructor(e,t,i,n,o,r,a,l,c,d,h,u,f,g,m,p,v,b,w,C,y,x=!1){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=o,this.containsRTL=r,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(Qo.compare),this.tabSize=d,this.startVisibleColumn=h,this.spaceWidth=u,this.stopRenderingLineAfter=m,this.renderWhitespace=p==="all"?4:p==="boundary"?1:p==="selection"?2:p==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=b,this.selectionsOnLine=w&&w.sort((E,M)=>E.start<M.start?-1:1),this.renderNewLineWhenEmpty=x,this.textDirection=C,this.verticalScrollbarSize=y;const S=Math.abs(g-u),L=Math.abs(f-u);S<L?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=f,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&Qo.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)&&this.textDirection===e.textDirection&&this.verticalScrollbarSize===e.verticalScrollbarSize&&this.renderNewLineWhenEmpty===e.renderNewLineWhenEmpty}}class Are{constructor(e,t){this.partIndex=e,this.charIndex=t}}class Qd{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){const o=(t<<16|i<<0)>>>0;this._data[e-1]=o,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=Qd.getPartIndex(t),n=Qd.getCharIndex(t);return new Are(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const n=(e<<16|i<<0)>>>0;let o=0,r=this.length-1;for(;o+1<r;){const m=o+r>>>1,p=this._data[m];if(p===n)return m;p>n?r=m:o=m}if(o===r)return o;const a=this._data[o],l=this._data[r];if(a===n)return o;if(l===n)return r;const c=Qd.getPartIndex(a),d=Qd.getCharIndex(a),h=Qd.getPartIndex(l);let u;c!==h?u=t:u=Qd.getCharIndex(l);const f=i-d,g=u-i;return f<=g?o:r}}class wR{constructor(e,t){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsForeignElements=t}}function h0(s,e){if(s.lineContent.length===0){if(s.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(const r of s.lineDecorations)(r.type===1||r.type===2)&&(e.appendString('<span class="'),e.appendString(r.className),e.appendString('"></span>'),r.type===1&&(n|=1,t++),r.type===2&&(n|=2,i++));e.appendString("</span>");const o=new Qd(1,t+i);return o.setColumnInfo(1,t,0,0),new wR(o,n)}return s.renderNewLineWhenEmpty?e.appendString(`<span><span>
</span></span>`):e.appendString("<span><span></span></span>"),new wR(new Qd(0,0),0)}return DPe(yPe(s),e)}class CPe{constructor(e,t,i){this.characterMapping=e,this.html=t,this.containsForeignElements=i}}function ZO(s){const e=new Dm(1e4),t=h0(s,e);return new CPe(t.characterMapping,e.build(),t.containsForeignElements)}class wPe{constructor(e,t,i,n,o,r,a,l,c,d,h,u,f,g,m){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=o,this.overflowingCharCount=r,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=d,this.startVisibleColumn=h,this.spaceWidth=u,this.renderSpaceCharCode=f,this.renderWhitespace=g,this.renderControlCharacters=m}}function yPe(s){const e=s.lineContent;let t,i,n;s.stopRenderingLineAfter!==-1&&s.stopRenderingLineAfter<e.length?(t=!0,i=e.length-s.stopRenderingLineAfter,n=s.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let o=SPe(e,s.containsRTL,s.lineTokens,s.fauxIndentLength,n);s.renderControlCharacters&&!s.isBasicASCII&&(o=IPe(e,o)),(s.renderWhitespace===4||s.renderWhitespace===1||s.renderWhitespace===2&&s.selectionsOnLine||s.renderWhitespace===3&&!s.continuesWithWrappedLine)&&(o=EPe(s,e,n,o));let r=0;if(s.lineDecorations.length>0){for(let a=0,l=s.lineDecorations.length;a<l;a++){const c=s.lineDecorations[a];c.type===3||c.type===1?r|=1:c.type===2&&(r|=2)}o=kPe(e,n,o,s.lineDecorations)}return s.containsRTL?o=LPe(e,o):o=xPe(e,o,!s.isBasicASCII||s.fontLigatures),new wPe(s.useMonospaceOptimizations,s.canUseHalfwidthRightwardsArrow,e,n,t,i,o,r,s.fauxIndentLength,s.tabSize,s.startVisibleColumn,s.spaceWidth,s.renderSpaceCharCode,s.renderWhitespace,s.renderControlCharacters)}function SPe(s,e,t,i,n){const o=[];let r=0;i>0&&(o[r++]=new Cs(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const d=t.getEndOffset(l);if(d<=i)continue;const h=t.getClassName(l);if(d>=n){const f=e?pw(s.substring(a,n)):!1;o[r++]=new Cs(n,h,0,f);break}const u=e?pw(s.substring(a,d)):!1;o[r++]=new Cs(d,h,0,u),a=d}return o}function xPe(s,e,t){let i=0;const n=[];let o=0;if(t)for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex;if(i+50<c){const d=l.type,h=l.metadata,u=l.containsRTL;let f=-1,g=i;for(let m=i;m<c;m++)s.charCodeAt(m)===32&&(f=m),f!==-1&&m-g>=50&&(n[o++]=new Cs(f+1,d,h,u),g=f+1,f=-1);g!==c&&(n[o++]=new Cs(c,d,h,u))}else n[o++]=l;i=c}else for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex,d=c-i;if(d>50){const h=l.type,u=l.metadata,f=l.containsRTL,g=Math.ceil(d/50);for(let m=1;m<g;m++){const p=i+m*50;n[o++]=new Cs(p,h,u,f)}n[o++]=new Cs(c,h,u,f)}else n[o++]=l;i=c}return n}function LPe(s,e){if(e.length===0)return e;const t=e[0];if(!t.containsRTL)return e;const i=t.endIndex;let n=0;for(let r=0;r<i;r++){const a=s.charCodeAt(r);if(a!==32&&a!==9){n=r;break}}if(n===0)return e;const o=[];o.push(new Cs(n,t.type,t.metadata,!1)),o.push(new Cs(i,t.type,t.metadata,t.containsRTL));for(let r=1;r<e.length;r++)o.push(e[r]);return o}function Pre(s){return s<32?s!==9:s===127||s>=8234&&s<=8238||s>=8294&&s<=8297||s>=8206&&s<=8207||s===1564}function IPe(s,e){const t=[];let i=new Cs(0,"",0,!1),n=0;for(const o of e){const r=o.endIndex;for(;n<r;n++){const a=s.charCodeAt(n);Pre(a)&&(n>i.endIndex&&(i=new Cs(n,o.type,o.metadata,o.containsRTL),t.push(i)),i=new Cs(n+1,"mtkcontrol",o.metadata,!1),t.push(i))}n>i.endIndex&&(i=new Cs(r,o.type,o.metadata,o.containsRTL),t.push(i))}return t}function EPe(s,e,t,i){const n=s.continuesWithWrappedLine,o=s.fauxIndentLength,r=s.tabSize,a=s.startVisibleColumn,l=s.useMonospaceOptimizations,c=s.selectionsOnLine,d=s.renderWhitespace===1,h=s.renderWhitespace===3,u=s.renderSpaceWidth!==s.spaceWidth,f=[];let g=0,m=0,p=i[m].type,v=i[m].containsRTL,b=i[m].endIndex;const w=i.length;let C=!1,y=Jo(e),x;y===-1?(C=!0,y=t,x=t):x=uc(e);let S=!1,L=0,E=c&&c[L],M=a%r;for(let T=o;T<t;T++){const A=e.charCodeAt(T);E&&E.endExclusive<=T&&(L++,E=c&&c[L]);let N;if(T<y||T>x)N=!0;else if(A===9)N=!0;else if(A===32)if(d)if(S)N=!0;else{const P=T+1<t?e.charCodeAt(T+1):0;N=P===32||P===9}else N=!0;else N=!1;if(N&&c&&(N=!!E&&E.start<=T&&T<E.endExclusive),N&&h&&(N=C||T>x),N&&v&&T>=y&&T<=x&&(N=!1),S){if(!N||!l&&M>=r){if(u){const P=g>0?f[g-1].endIndex:o;for(let W=P+1;W<=T;W++)f[g++]=new Cs(W,"mtkw",1,!1)}else f[g++]=new Cs(T,"mtkw",1,!1);M=M%r}}else(T===b||N&&T>o)&&(f[g++]=new Cs(T,p,0,v),M=M%r);for(A===9?M=r:hf(A)?M+=2:M++,S=N;T===b&&(m++,m<w);)p=i[m].type,v=i[m].containsRTL,b=i[m].endIndex}let R=!1;if(S)if(n&&d){const T=t>0?e.charCodeAt(t-1):0,A=t>1?e.charCodeAt(t-2):0;T===32&&A!==32&&A!==9||(R=!0)}else R=!0;if(R)if(u){const T=g>0?f[g-1].endIndex:o;for(let A=T+1;A<=t;A++)f[g++]=new Cs(A,"mtkw",1,!1)}else f[g++]=new Cs(t,"mtkw",1,!1);else f[g++]=new Cs(t,p,0,v);return f}function kPe(s,e,t,i){i.sort(Qo.compare);const n=vPe.normalize(s,i),o=n.length;let r=0;const a=[];let l=0,c=0;for(let h=0,u=t.length;h<u;h++){const f=t[h],g=f.endIndex,m=f.type,p=f.metadata,v=f.containsRTL;for(;r<o&&n[r].startOffset<g;){const b=n[r];if(b.startOffset>c&&(c=b.startOffset,a[l++]=new Cs(c,m,p,v)),b.endOffset+1<=g)c=b.endOffset+1,a[l++]=new Cs(c,m+" "+b.className,p|b.metadata,v),r++;else{c=g,a[l++]=new Cs(c,m+" "+b.className,p|b.metadata,v);break}}g>c&&(c=g,a[l++]=new Cs(c,m,p,v))}const d=t[t.length-1].endIndex;if(r<o&&n[r].startOffset===d)for(;r<o&&n[r].startOffset===d;){const h=n[r];a[l++]=new Cs(c,h.className,h.metadata,!1),r++}return a}function DPe(s,e){const t=s.fontIsMonospace,i=s.canUseHalfwidthRightwardsArrow,n=s.containsForeignElements,o=s.lineContent,r=s.len,a=s.isOverflowing,l=s.overflowingCharCount,c=s.parts,d=s.fauxIndentLength,h=s.tabSize,u=s.startVisibleColumn,f=s.spaceWidth,g=s.renderSpaceCharCode,m=s.renderWhitespace,p=s.renderControlCharacters,v=new Qd(r+1,c.length);let b=!1,w=0,C=u,y=0,x=0,S=0;e.appendString("<span>");for(let L=0,E=c.length;L<E;L++){const M=c[L],R=M.endIndex,T=M.type,A=M.containsRTL,N=m!==0&&M.isWhitespace(),P=N&&!t&&(T==="mtkw"||!n),W=w===R&&M.isPseudoAfter();if(y=0,e.appendString("<span "),A&&e.appendString('dir="rtl" style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(P?"mtkz":T),e.appendASCIICharCode(34),N){let H=0;{let G=w,V=C;for(;G<R;G++){const $=(o.charCodeAt(G)===9?h-V%h:1)|0;H+=$,G>=d&&(V+=$)}}for(P&&(e.appendString(' style="width:'),e.appendString(String(f*H)),e.appendString('px"')),e.appendASCIICharCode(62);w<R;w++){v.setColumnInfo(w+1,L-S,y,x),S=0;const G=o.charCodeAt(w);let V,U;if(G===9){V=h-C%h|0,U=V,!i||U>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let $=2;$<=U;$++)e.appendCharCode(160)}else V=2,U=1,e.appendCharCode(g),e.appendCharCode(8204);y+=V,x+=U,w>=d&&(C+=U)}}else for(e.appendASCIICharCode(62);w<R;w++){v.setColumnInfo(w+1,L-S,y,x),S=0;const H=o.charCodeAt(w);let G=1,V=1;switch(H){case 9:G=h-C%h,V=G;for(let U=1;U<=G;U++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:p?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:hf(H)&&V++,p&&H<32?e.appendCharCode(9216+H):p&&H===127?e.appendCharCode(9249):p&&Pre(H)?(e.appendString("[U+"),e.appendString(TPe(H)),e.appendString("]"),G=8,V=G):e.appendCharCode(H)}y+=G,x+=V,w>=d&&(C+=V)}W?S++:S=0,w>=r&&!b&&M.isPseudoAfter()&&(b=!0,v.setColumnInfo(w+1,L,y,x)),e.appendString("</span>")}return b||v.setColumnInfo(r+1,c.length-1,y,x),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(_(796,"Show more ({0})",NPe(l))),e.appendString("</span>")),e.appendString("</span>"),new wR(v,n)}function TPe(s){return s.toString(16).toUpperCase().padStart(4,"0")}function NPe(s){return s<1024?_(797,"{0} chars",s):s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/1024/1024).toFixed(1)} MB`}var Il;(function(s){s.DARK="dark",s.LIGHT="light",s.HIGH_CONTRAST_DARK="hcDark",s.HIGH_CONTRAST_LIGHT="hcLight"})(Il||(Il={}));var DC;(function(s){s.VS="vs",s.VS_DARK="vs-dark",s.HC_BLACK="hc-black",s.HC_LIGHT="hc-light"})(DC||(DC={}));function od(s){return s===Il.HIGH_CONTRAST_DARK||s===Il.HIGH_CONTRAST_LIGHT}function _f(s){return s===Il.DARK||s===Il.HIGH_CONTRAST_DARK}const RPe=(function(){return ad?!0:!(Hr||Wr||Eb)})();let C1=!0;const gA=class gA{constructor(e,t){this._viewGpuContext=e,this._options=t,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=gi(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){var e;return od(this._options.themeType)||((e=this._renderedViewLine)==null?void 0:e.input.renderWhitespace)===2?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,o){var m,p,v;if(this._options.useGpu&&((m=this._viewGpuContext)!=null&&m.canRender(this._options,n,e)))return(v=(p=this._renderedViewLine)==null?void 0:p.domNode)==null||v.domNode.remove(),this._renderedViewLine=null,!1;if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const r=n.getViewLineRenderingData(e),a=this._options,l=Qo.filter(r.inlineDecorations,e,r.minColumn,r.maxColumn),c=r.hasVariableFonts||a.experimentalWhitespaceRendering==="off"?a.renderWhitespace:"none",d=!r.hasVariableFonts;let h=null;if(od(a.themeType)||c==="selection"){const b=n.selections;for(const w of b){if(w.endLineNumber<e||w.startLineNumber>e)continue;const C=w.startLineNumber===e?w.startColumn:r.minColumn,y=w.endLineNumber===e?w.endColumn:r.maxColumn;C<y&&(od(a.themeType)&&l.push(new Qo(C,y,"inline-selected-text",0)),c==="selection"&&(h||(h=[]),h.push(new Ue(C-1,y-1))))}}const u=new kf(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,r.content,r.continuesWithWrappedLine,r.isBasicASCII,r.containsRTL,r.minColumn-1,r.tokens,l,r.tabSize,r.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,c,a.renderControlCharacters,a.fontLigatures!==gf.OFF,h,r.textDirection,a.verticalScrollbarSize);if(this._renderedViewLine&&this._renderedViewLine.input.equals(u))return!1;o.appendString("<div "),r.textDirection===qa.RTL?o.appendString('dir="rtl" '):r.containsRTL&&o.appendString('dir="ltr" '),o.appendString('style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString("px;line-height:"),o.appendString(String(i)),r.textDirection===qa.RTL&&(o.appendString("px;padding-right:"),o.appendString(String(a.verticalScrollbarSize))),o.appendString('px;" class="'),o.appendString(gA.CLASS_NAME),o.appendString('">');const f=h0(u,o);o.appendString("</div>");let g=null;return d&&C1&&RPe&&r.isBasicASCII&&u.isLTR&&a.useMonospaceOptimizations&&f.containsForeignElements===0&&(g=new hD(this._renderedViewLine?this._renderedViewLine.domNode:null,u,f.characterMapping)),g||(g=Fre(this._renderedViewLine?this._renderedViewLine.domNode:null,u,f.characterMapping,f.containsForeignElements)),this._renderedViewLine=g,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i),this._renderedViewLine.domNode.setLineHeight(i))}isRenderedRTL(){return this._renderedViewLine?this._renderedViewLine.input.textDirection===qa.RTL:!1}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof hD:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof hD?this._renderedViewLine.monospaceAssumptionsAreValid():C1}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof hD&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&t>o+1&&i>o+1)return new bB(!0,[new Wg(this.getWidth(n),0)]);o!==-1&&t>o+1&&(t=o+1),o!==-1&&i>o+1&&(i=o+1);const r=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return r&&r.length>0?new bB(!1,r):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};gA.CLASS_NAME="view-line";let Lu=gA;class hD{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let o=0;o<n;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return C1;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),C1=!1)}return C1}toSlowRenderedLine(){return Fre(this.domNode,this.input,this._characterMapping,0)}getVisibleRangesForRange(e,t,i,n){const o=this._getColumnPixelOffset(e,t,n),r=this._getColumnPixelOffset(e,i,n);return[new Wg(o,r-o)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const n=Math.floor((t-1)/300)-1,o=(n+1)*300+1;let r=-1;if(this._keyColumnPixelOffsetCache&&(r=this._keyColumnPixelOffsetCache[n],r===-1&&(r=this._actualReadPixelOffset(e,o,i),this._keyColumnPixelOffsetCache[n]=r)),r===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(t);return r+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const n=this._characterMapping.getDomPosition(t),o=GT.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(e,t){return xw(this._characterMapping,e,t)}}class Ore{constructor(e,t,i,n){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=n,this._cachedWidth=-1,this._pixelOffsetCache=null,t.isLTR){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let o=0,r=this._characterMapping.length;o<=r;o++)this._pixelOffsetCache[o]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const o=this._readPixelOffset(this.domNode,e,t,n);if(o===-1)return null;const r=this._readPixelOffset(this.domNode,e,i,n);return r===-1?null:[new Wg(o,r-o)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,o){if(i===n){const r=this._readPixelOffset(e,t,i,o);return r===-1?null:[new Wg(r,0)]}else return this._readRawVisibleRangesForRange(e,i,n,o)}_readPixelOffset(e,t,i,n){if(this.input.isLTR&&this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);const o=this._getReadingTarget(e);return o.firstChild?(n.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const o=this._pixelOffsetCache[i];if(o!==-1)return o;const r=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=r,r}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){const l=GT.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(this.input.isLTR&&i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);const o=this._characterMapping.getDomPosition(i),r=GT.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,o.partIndex,o.charIndex,n);if(!r||r.length===0)return-1;const a=r[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,n){if(this.input.isLTR&&t===1&&i===this._characterMapping.length)return[new Wg(0,this.getWidth(n))];const o=this._characterMapping.getDomPosition(t),r=this._characterMapping.getDomPosition(i);return GT.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,r.partIndex,r.charIndex,n)}getColumnOfNodeOffset(e,t){return xw(this._characterMapping,e,t)}}class MPe extends Ore{_readVisibleRangesForRange(e,t,i,n,o){const r=super._readVisibleRangesForRange(e,t,i,n,o);if(!r||r.length===0||i===n||i===1&&n===this._characterMapping.length)return r;if(this.input.isLTR){const a=this._readPixelOffset(e,t,n,o);if(a!==-1){const l=r[r.length-1];l.left<a&&(l.width=a-l.left)}}return r}}const Fre=(function(){return fO?APe:PPe})();function APe(s,e,t,i){return new MPe(s,e,t,i)}function PPe(s,e,t,i){return new Ore(s,e,t,i)}function xw(s,e,t){const i=e.textContent.length;let n=-1;for(;e;)e=e.previousSibling,n++;return s.getColumn(new Are(n,t),i)}class Uf{constructor(e=null){this.hitTarget=e,this.type=0}}class Bre{get hitTarget(){return this.spanNode}constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var pp;(function(s){function e(t,i,n){const o=t.getPositionFromDOMInfo(i,n);return o?new Bre(o,i,null):new Uf(i)}s.createFromDOMInfo=e})(pp||(pp={}));class OPe{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class go{static _deduceRage(e,t=null){return!t&&e?new D(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,o,r){return{type:e,element:t,mouseColumn:i,position:n,range:o,detail:r}}static createViewZone(e,t,i,n,o){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:o}}static createContentText(e,t,i,n,o){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:o}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class rr{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}}class Lw{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(165),this.viewDomNode=t.viewDomNode,this.viewLinesGpu=t.viewLinesGpu,this.lineHeight=n.get(75),this.stickyTabStops=n.get(132),this.typicalHalfwidthCharacterWidth=n.get(59).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return Lw.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,o=e.viewModel.getLineCount();let r=null,a,l=null;return i.afterLineNumber!==o&&(l=new z(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(r=new z(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=r:r===null?a=l:t<n?a=r:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:r,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const n=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(n);return{range:new D(n,o,n,o),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new D(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return Lw._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}isRtl(e){return this.viewModel.getTextDirection(e)===qa.RTL}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class FPe{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Uo._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class BPe extends FPe{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=dd.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,o){super(e,t,i,n),this.hitTestResult=new bo(()=>Uo.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=e,this._eventTarget=o;const r=!!this._eventTarget;this._useHitTestTarget=!r}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Ln.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return go.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return go.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return go.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return go.createViewZone(e,this.target,this._getMouseColumn(),t,i)}fulfillContentText(e,t,i){return go.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return go.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return go.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return go.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return go.createOverlayWidget(this.target,this._getMouseColumn(),e)}}const XY={isAfterLines:!0};function Wm(s){return{isAfterLines:!1,horizontalDistanceToText:s}}class Uo{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=dd.collect(t,this._viewHelper.viewDomNode);return!!(rr.isChildOfContentWidgets(i)||rr.isChildOfOverflowingContentWidgets(i)||rr.isChildOfOverlayWidgets(i)||rr.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,o){const r=new Lw(this._context,this._viewHelper,e),a=new BPe(r,t,i,n,o);try{const l=Uo._createMouseTarget(r,a);if(l.type===6&&r.stickyTabStops&&l.position!==null){const c=Uo._snapToSoftTabBoundary(l.position,r.viewModel),d=D.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,d,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();const i=t;let n=null;return!rr.isChildOfOverflowGuard(t.targetPath)&&!rr.isChildOfOverflowingContentWidgets(t.targetPath)&&!rr.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||Uo._hitTestContentWidget(e,i),n=n||Uo._hitTestOverlayWidget(e,i),n=n||Uo._hitTestMinimap(e,i),n=n||Uo._hitTestScrollbarSlider(e,i),n=n||Uo._hitTestViewZone(e,i),n=n||Uo._hitTestMargin(e,i),n=n||Uo._hitTestViewCursor(e,i),n=n||Uo._hitTestTextArea(e,i),n=n||Uo._hitTestViewLines(e,i),n=n||Uo._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(rr.isChildOfContentWidgets(t.targetPath)||rr.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(rr.isChildOfOverlayWidgets(t.targetPath)||rr.isChildOfOverflowingOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,o=t.mouseVerticalOffset;for(const r of i){if(n<r.contentLeft||n>r.contentLeft+r.width)continue;const a=e.getVerticalOffsetForLineNumber(r.position.lineNumber);if(a<=o&&o<=a+r.height)return t.fulfillContentText(r.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return rr.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let o=Math.abs(t.relativePos.x);const r={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:o};if(o-=e.layoutInfo.glyphMarginLeft,o<=e.layoutInfo.glyphMarginWidth){const a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return r.glyphMarginLane=l[Math.floor(o/e.lineHeight)],t.fulfillMargin(2,n,i.range,r)}return o-=e.layoutInfo.glyphMarginWidth,o<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,r):(o-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,r))}return null}static _hitTestViewLines(e,t){if(!rr.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new z(1,1),XY);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.viewModel.getLineCount(),o=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new z(n,o),XY)}if(rr.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),o=e.viewModel.getLineLength(n),r=e.getLineWidth(n);if(o===0){const l=Wm(t.mouseContentHorizontalOffset-r);return t.fulfillContentEmpty(new z(n,1),l)}if(e.isRtl(n)){if(t.mouseContentHorizontalOffset+r<=e.layoutInfo.contentWidth-e.layoutInfo.verticalScrollbarWidth){const l=Wm(t.mouseContentHorizontalOffset-r),c=new z(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(t.mouseContentHorizontalOffset>=r){const l=Wm(t.mouseContentHorizontalOffset-r),c=new z(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(e.viewLinesGpu){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){const l=e.getLineWidth(n),c=Wm(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(new z(n,1),c)}const o=e.getLineWidth(n);if(e.isRtl(n)){if(t.mouseContentHorizontalOffset+o<=e.layoutInfo.contentWidth-e.layoutInfo.verticalScrollbarWidth){const l=Wm(t.mouseContentHorizontalOffset-o),c=new z(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}}else if(t.mouseContentHorizontalOffset>=o){const l=Wm(t.mouseContentHorizontalOffset-o),c=new z(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(c,l)}const a=e.viewLinesGpu.getPositionAtCoordinate(n,t.mouseContentHorizontalOffset);if(a){const l={injectedText:null,mightBeForeignElement:!1};return t.fulfillContentText(a,D.fromPositions(a,a),l)}}const i=t.hitTestResult.value;return i.type===1?Uo.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(rr.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new z(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(rr.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),o=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new z(n,o))}}return null}static _hitTestScrollbar(e,t){if(rr.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new z(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(165),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return Uo._getMouseColumn(n,t.get(59).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,o){const r=n.lineNumber,a=n.column,l=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>l){const v=Wm(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,v)}const c=e.visibleRangeForPosition(r,a);if(!c)return t.fulfillUnknown(n);const d=c.left;if(Math.abs(t.mouseContentHorizontalOffset-d)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!o,injectedText:o});const h=[];if(h.push({offset:c.left,column:a}),a>1){const v=e.visibleRangeForPosition(r,a-1);v&&h.push({offset:v.left,column:a-1})}const u=e.viewModel.getLineMaxColumn(r);if(a<u){const v=e.visibleRangeForPosition(r,a+1);v&&h.push({offset:v.left,column:a+1})}h.sort((v,b)=>v.offset-b.offset);const f=t.pos.toClientCoordinates(je(e.viewDomNode)),g=i.getBoundingClientRect(),m=g.left<=f.clientX&&f.clientX<=g.right;let p=null;for(let v=1;v<h.length;v++){const b=h[v-1],w=h[v];if(b.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=w.offset){p=new D(r,b.column,r,w.column);const C=Math.abs(b.offset-t.mouseContentHorizontalOffset),y=Math.abs(w.offset-t.mouseContentHorizontalOffset);n=C<y?new z(r,b.column):new z(r,w.column);break}}return t.fulfillContentText(n,p,{mightBeForeignElement:!m||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),o=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>o)){const a=Math.floor((n+o)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new _k(t.pos.x,l),d=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates(je(e.viewDomNode)));if(d.type===1)return d}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(je(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=fm(e.viewDomNode);let n;if(i?typeof i.caretRangeFromPoint>"u"?n=WPe(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new Uf;const o=n.startContainer;if(o.nodeType===o.TEXT_NODE){const r=o.parentNode,a=r?r.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Lu.CLASS_NAME?pp.createFromDOMInfo(e,r,n.startOffset):new Uf(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){const r=o.parentNode,a=r?r.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Lu.CLASS_NAME?pp.createFromDOMInfo(e,o,o.textContent.length):new Uf(o)}return new Uf}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const n=i.offsetNode.parentNode,o=n?n.parentNode:null,r=o?o.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===Lu.CLASS_NAME?pp.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new Uf(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const n=i.offsetNode.parentNode,o=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,r=n?n.parentNode:null,a=r&&r.nodeType===r.ELEMENT_NODE?r.className:null;if(o===Lu.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return pp.createFromDOMInfo(e,l,0)}else if(a===Lu.CLASS_NAME)return pp.createFromDOMInfo(e,i.offsetNode,0)}return new Uf(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),o=LL.atomicPosition(i,e.column-1,n,2);return o!==-1?new z(e.lineNumber,o+1):e}static doHitTest(e,t){let i=new Uf;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(je(e.viewDomNode)))),i.type===1){const n=e.viewModel.getInjectedTextAt(i.position),o=e.viewModel.normalizePosition(i.position,2);(n||!o.equals(i.position))&&(i=new Bre(o,i.spanNode,n))}return i}}function WPe(s,e,t){const i=document.createRange();let n=s.elementFromPoint(e,t);if(n!=null&&n.hasChildNodes()){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const o=n.getBoundingClientRect(),r=je(n),a=r.getComputedStyle(n,null).getPropertyValue("font-style"),l=r.getComputedStyle(n,null).getPropertyValue("font-variant"),c=r.getComputedStyle(n,null).getPropertyValue("font-weight"),d=r.getComputedStyle(n,null).getPropertyValue("font-size"),h=r.getComputedStyle(n,null).getPropertyValue("line-height"),u=r.getComputedStyle(n,null).getPropertyValue("font-family"),f=`${a} ${l} ${c} ${d}/${h} ${u}`,g=n.innerText;let m=o.left,p=0,v;if(e>o.left+o.width)p=g.length;else{const b=vB.getInstance();for(let w=0;w<g.length+1;w++){if(v=b.getCharWidth(g.charAt(w),f)/2,m+=v,e<m){p=w;break}m+=v}}i.setStart(n.firstChild,p),i.setEnd(n.firstChild,p)}return i}const Mp=class Mp{static getInstance(){return Mp._INSTANCE||(Mp._INSTANCE=new Mp),Mp._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const r=n.measureText(e).width;return this._cache[i]=r,r}};Mp._INSTANCE=null;let vB=Mp;function Kn(s,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");const o=`$memoize$${e}`;t[i]=function(...r){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,r)}),this[o]}}var HPe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Qi;(function(s){s.Tap="-monaco-gesturetap",s.Change="-monaco-gesturechange",s.Start="-monaco-gesturestart",s.End="-monaco-gesturesend",s.Contextmenu="-monaco-gesturecontextmenu"})(Qi||(Qi={}));const ho=class ho extends K{constructor(){super(),this.dispatched=!1,this.targets=new Zo,this.ignoreTargets=new Zo,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Se.runAndSubscribe(hk,({window:e,disposables:t})=>{t.add(ee(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(ee(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(ee(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:Ti,disposables:this._store}))}static addTarget(e){if(!ho.isTouchDevice())return K.None;ho.INSTANCE||(ho.INSTANCE=new ho);const t=ho.INSTANCE.targets.push(e);return Ve(t)}static ignoreTarget(e){if(!ho.isTouchDevice())return K.None;ho.INSTANCE||(ho.INSTANCE=new ho);const t=ho.INSTANCE.ignoreTargets.push(e);return Ve(t)}static isTouchDevice(){return"ontouchstart"in Ti||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){const o=e.targetTouches.item(i);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:t,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[t],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};const r=this.newGestureEvent(Qi.Start,o.target);r.pageX=o.pageX,r.pageY=o.pageY,this.dispatchEvent(r)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){const i=Date.now(),n=Object.keys(this.activeTouches).length;for(let o=0,r=t.changedTouches.length;o<r;o++){const a=t.changedTouches.item(o);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}const l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<ho.HOLD_DELAY&&Math.abs(l.initialPageX-l.rollingPageX.at(-1))<30&&Math.abs(l.initialPageY-l.rollingPageY.at(-1))<30){const d=this.newGestureEvent(Qi.Tap,l.initialTarget);d.pageX=l.rollingPageX.at(-1),d.pageY=l.rollingPageY.at(-1),this.dispatchEvent(d)}else if(c>=ho.HOLD_DELAY&&Math.abs(l.initialPageX-l.rollingPageX.at(-1))<30&&Math.abs(l.initialPageY-l.rollingPageY.at(-1))<30){const d=this.newGestureEvent(Qi.Contextmenu,l.initialTarget);d.pageX=l.rollingPageX.at(-1),d.pageY=l.rollingPageY.at(-1),this.dispatchEvent(d)}else if(n===1){const d=l.rollingPageX.at(-1),h=l.rollingPageY.at(-1),u=l.rollingTimestamps.at(-1)-l.rollingTimestamps[0],f=d-l.rollingPageX[0],g=h-l.rollingPageY[0],m=[...this.targets].filter(p=>l.initialTarget instanceof Node&&p.contains(l.initialTarget));this.inertia(e,m,i,Math.abs(f)/u,f>0?1:-1,d,Math.abs(g)/u,g>0?1:-1,h)}this.dispatchEvent(this.newGestureEvent(Qi.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Qi.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>ho.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Qi.Change||e.type===Qi.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(e.initialTarget))return;const t=[];for(const i of this.targets)if(i.contains(e.initialTarget)){let n=0,o=e.initialTarget;for(;o&&o!==i;)n++,o=o.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(const[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,o,r,a,l,c){this.handle=Vr(e,()=>{const d=Date.now(),h=d-i;let u=0,f=0,g=!0;n+=ho.SCROLL_FRICTION*h,a+=ho.SCROLL_FRICTION*h,n>0&&(g=!1,u=o*n*h),a>0&&(g=!1,f=l*a*h);const m=this.newGestureEvent(Qi.Change);m.translationX=u,m.translationY=f,t.forEach(p=>p.dispatchEvent(m)),g||this.inertia(e,t,d,n,o,r+u,a,l,c+f)})}onTouchMove(e){const t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){const o=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}const r=this.activeTouches[o.identifier],a=this.newGestureEvent(Qi.Change,r.initialTarget);a.translationX=o.pageX-r.rollingPageX.at(-1),a.translationY=o.pageY-r.rollingPageY.at(-1),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),r.rollingPageX.length>3&&(r.rollingPageX.shift(),r.rollingPageY.shift(),r.rollingTimestamps.shift()),r.rollingPageX.push(o.pageX),r.rollingPageY.push(o.pageY),r.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};ho.SCROLL_FRICTION=-.005,ho.HOLD_DELAY=700,ho.CLEAR_TAP_COUNT_TIME=400;let Oo=ho;HPe([Kn],Oo,"isTouchDevice",null);let va=class extends K{onclick(e,t){this._register(ee(e,ye.CLICK,i=>t(new Co(je(e),i))))}onmousedown(e,t){this._register(ee(e,ye.MOUSE_DOWN,i=>t(new Co(je(e),i))))}onmouseover(e,t){this._register(ee(e,ye.MOUSE_OVER,i=>t(new Co(je(e),i))))}onmouseleave(e,t){this._register(ee(e,ye.MOUSE_LEAVE,i=>t(new Co(je(e),i))))}onkeydown(e,t){this._register(ee(e,ye.KEY_DOWN,i=>t(new Bi(i))))}onkeyup(e,t){this._register(ee(e,ye.KEY_UP,i=>t(new Bi(i))))}oninput(e,t){this._register(ee(e,ye.INPUT,t))}onblur(e,t){this._register(ee(e,ye.BLUR,t))}onfocus(e,t){this._register(ee(e,ye.FOCUS,t))}ignoreGesture(e){return Oo.ignoreTarget(e)}};const Iw=11;class VPe extends va{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...it.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=Iw+"px",this.domNode.style.height=Iw+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new l0),this._register(Jn(this.bgDomNode,ye.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Jn(this.domNode,ye.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new FU),this._pointerdownScheduleRepeatTimer=this._register(new ha)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,je(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class zPe extends K{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new ha)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var e;(e=this._domNode)==null||e.setClassName(this._visibleClassName)},0))}_hide(e){var t;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(t=this._domNode)==null||t.setClassName(this._invisibleClassName+(e?" fade":"")))}}const UPe=140;class Wre extends va{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new zPe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new l0),this._shouldRender=!0,this.domNode=gi(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(ee(this.domNode.domNode,ye.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new VPe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=gi(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(ee(this.slider.domNode,ye.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(e);i<=o&&o<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const r=Fn(this.domNode.domNode);t=e.pageX-r.left,i=e.pageY-r.top}const n=e.pointerType==="mouse",o=e.button===0;if(o||!n){const r=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(r):this._scrollbarState.getDesiredScrollPositionFromOffset(r))}o&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>{const r=this._sliderOrthogonalPointerPosition(o),a=Math.abs(r-i);if(no&&a>UPe){this._setDesiredScrollPositionNow(n.getScrollPosition());return}const c=this._sliderPointerPosition(o)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const $Pe=20;class Ew{constructor(e,t,i,n,o,r){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=o,this._scrollPosition=r,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new Ew(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,o){const r=Math.max(0,i-e),a=Math.max(0,r-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max($Pe,Math.floor(i*a/n))),d=(a-c)/(n-i),h=o*d;return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:d,computedSliderPosition:Math.round(h)}}_refreshComputedValues(){const e=Ew._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class qPe extends Wre{constructor(e,t,i){const n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Ew(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,o.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const r=(t.arrowSize-Iw)/2,a=(t.horizontalScrollbarSize-Iw)/2;this._createArrow({className:"scra",icon:ge.scrollbarButtonLeft,top:a,left:r,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Db(null,1,0))}),this._createArrow({className:"scra",icon:ge.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:r,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new Db(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class jPe extends Wre{constructor(e,t,i){const n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Ew(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,o.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const r=(t.arrowSize-Iw)/2,a=(t.verticalScrollbarSize-Iw)/2;this._createArrow({className:"scra",icon:ge.scrollbarButtonUp,top:r,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Db(null,0,1))}),this._createArrow({className:"scra",icon:ge.scrollbarButtonDown,top:void 0,left:a,bottom:r,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new Db(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class yR{constructor(e,t,i,n,o,r,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,o=o|0,r=r|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),o<0&&(o=0),a+o>r&&(a=r-o),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=o,this.scrollHeight=r,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new yR(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new yR(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,o=this.scrollLeft!==e.scrollLeft,r=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:o,heightChanged:r,scrollHeightChanged:a,scrollTopChanged:l}}}class u0 extends K{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new q),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new yR(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){var n;const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),(n=this._smoothScrolling)==null||n.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new FL(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=FL.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class ZY{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function Y5(s,e){const t=e-s;return function(i){return s+t*YPe(i)}}function KPe(s,e,t){return function(i){return i<t?s(i/t):e((i-t)/(1-t))}}class FL{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let o,r;return e<t?(o=e+.75*i,r=t-.75*i):(o=e-.75*i,r=t+.75*i),KPe(Y5(e,o),Y5(r,t),.33)}return Y5(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),n=this.scrollTop(t);return new ZY(i,n,!1)}return new ZY(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return FL.start(e,t,i)}static start(e,t,i){i=i+10;const n=Date.now()-10;return new FL(e,t,n,i)}}function GPe(s){return Math.pow(s,3)}function YPe(s){return 1-GPe(1-s)}const XPe=500,QY=50;class ZPe{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}const mA=class mA{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{const o=n===this._front?e:Math.pow(2,-i);if(e-=o,t+=this._memory[n].score*o,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(ik){const t=je(e.browserEvent),i=_9(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null;const o=new ZPe(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=o,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=o),o.score=this._computeScore(o,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){const n=Math.abs(e.deltaX),o=Math.abs(e.deltaY),r=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,r),1),c=Math.max(Math.min(o,a),1),d=Math.max(n,r),h=Math.max(o,a);d%l===0&&h%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){const t=Number.EPSILON*100;return Math.abs(Math.round(e)-e)<.01+t}};mA.INSTANCE=new mA;let SR=mA;class p$ extends va{get onScroll(){return this._onScroll.event}get options(){return this._options}constructor(e,t,i){super(),this._inertialTimeout=null,this._inertialSpeed={X:0,Y:0},this._onScroll=this._register(new q),this._onWillScroll=this._register(new q),e.style.overflow="hidden",this._options=QPe(t),this._scrollable=i,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));const n={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new jPe(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new qPe(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=gi(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=gi(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=gi(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new ha),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=yi(this._mouseWheelToDispose),this._inertialTimeout&&(this._inertialTimeout.dispose(),this._inertialTimeout=null),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Bt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new Db(e))}async _periodicSync(){var t;let e=!1;(this._inertialSpeed.X!==0||this._inertialSpeed.Y!==0)&&(this._scrollable.setScrollPositionNow({scrollTop:this._scrollable.getCurrentScrollPosition().scrollTop-this._inertialSpeed.Y*100,scrollLeft:this._scrollable.getCurrentScrollPosition().scrollLeft-this._inertialSpeed.X*100}),this._inertialSpeed.X*=.9,this._inertialSpeed.Y*=.9,Math.abs(this._inertialSpeed.X)<.01&&(this._inertialSpeed.X=0),Math.abs(this._inertialSpeed.Y)<.01&&(this._inertialSpeed.Y=0),e=this._inertialSpeed.X!==0||this._inertialSpeed.Y!==0),e?(this._inertialTimeout||(this._inertialTimeout=new ha),this._inertialTimeout.cancelAndSet(()=>this._periodicSync(),1e3/60)):((t=this._inertialTimeout)==null||t.dispose(),this._inertialTimeout=null)}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=yi(this._mouseWheelToDispose),e)){const i=n=>{this._onMouseWheel(new Db(n))};this._mouseWheelToDispose.push(ee(this._listenOnDomNode,ye.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){var o;if((o=e.browserEvent)!=null&&o.defaultPrevented)return;const t=SR.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&a+r===0?a=r=0:Math.abs(r)>=Math.abs(a)?a=0:r=0),this._options.flipAxes&&([r,a]=[a,r]);const l=!Bt&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||l)&&!a&&(a=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(a=a*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);const c=this._scrollable.getFutureScrollPosition();let d={};if(r){const h=QY*r,u=c.scrollTop-(h<0?Math.floor(h):Math.ceil(h));this._verticalScrollbar.writeScrollPosition(d,u)}if(a){const h=QY*a,u=c.scrollLeft-(h<0?Math.floor(h):Math.ceil(h));this._horizontalScrollbar.writeScrollPosition(d,u)}if(d=this._scrollable.validateScrollPosition(d),this._options.inertialScroll&&(a||r)&&!t.isPhysicalMouseWheel()){let h=!1;this._inertialSpeed.X===0&&this._inertialSpeed.Y===0&&(h=!0),this._inertialSpeed.Y=(r<0?-1:1)*Math.abs(r)**1.02,this._inertialSpeed.X=(a<0?-1:1)*Math.abs(a)**1.02,h&&this._periodicSync()}(c.scrollLeft!==d.scrollLeft||c.scrollTop!==d.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",o=t?" top":"",r=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${r}${o}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),XPe)}}class Hre extends p${constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new u0({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Vr(je(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class QO extends p${constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class vk extends p${constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new u0({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>Vr(je(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function QPe(s){const e={lazyRender:typeof s.lazyRender<"u"?s.lazyRender:!1,className:typeof s.className<"u"?s.className:"",useShadows:typeof s.useShadows<"u"?s.useShadows:!0,handleMouseWheel:typeof s.handleMouseWheel<"u"?s.handleMouseWheel:!0,flipAxes:typeof s.flipAxes<"u"?s.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof s.consumeMouseWheelIfScrollbarIsNeeded<"u"?s.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof s.alwaysConsumeMouseWheel<"u"?s.alwaysConsumeMouseWheel:!1,scrollYToX:typeof s.scrollYToX<"u"?s.scrollYToX:!1,mouseWheelScrollSensitivity:typeof s.mouseWheelScrollSensitivity<"u"?s.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof s.fastScrollSensitivity<"u"?s.fastScrollSensitivity:5,scrollPredominantAxis:typeof s.scrollPredominantAxis<"u"?s.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof s.mouseWheelSmoothScroll<"u"?s.mouseWheelSmoothScroll:!0,inertialScroll:typeof s.inertialScroll<"u"?s.inertialScroll:!1,arrowSize:typeof s.arrowSize<"u"?s.arrowSize:11,listenOnDomNode:typeof s.listenOnDomNode<"u"?s.listenOnDomNode:null,horizontal:typeof s.horizontal<"u"?s.horizontal:1,horizontalScrollbarSize:typeof s.horizontalScrollbarSize<"u"?s.horizontalScrollbarSize:10,horizontalSliderSize:typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:0,horizontalHasArrows:typeof s.horizontalHasArrows<"u"?s.horizontalHasArrows:!1,vertical:typeof s.vertical<"u"?s.vertical:1,verticalScrollbarSize:typeof s.verticalScrollbarSize<"u"?s.verticalScrollbarSize:10,verticalHasArrows:typeof s.verticalHasArrows<"u"?s.verticalHasArrows:!1,verticalSliderSize:typeof s.verticalSliderSize<"u"?s.verticalSliderSize:0,scrollByPage:typeof s.scrollByPage<"u"?s.scrollByPage:!1};return e.horizontalSliderSize=typeof s.horizontalSliderSize<"u"?s.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof s.verticalSliderSize<"u"?s.verticalSliderSize:e.verticalScrollbarSize,Bt&&(e.className+=" mac"),e}class Vre extends K{constructor(e,t,i,n){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=this._createDragScrollingOperation(e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class zre extends K{constructor(e,t,i,n,o,r){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._position=o,this._mouseEvent=r,this._lastTime=Date.now(),this._animationFrameDisposable=Vr(je(r.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}}class JPe extends Vre{_createDragScrollingOperation(e,t){return new eOe(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}}class eOe extends zre{_getScrollSpeed(){const e=this._context.configuration.options.get(75),t=this._context.configuration.options.get(165).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(75),t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e,o=this._position.outsidePosition==="above"?-n:n;this._context.viewModel.viewLayout.deltaScrollNow(0,o),this._viewHelper.renderNow();const r=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?r.startLineNumber:r.endLineNumber;let l;{const c=YO(this._viewHelper.viewDomNode),d=this._context.configuration.options.get(165).horizontalScrollbarHeight,h=new _k(this._mouseEvent.pos.x,c.y+c.height-d-.1),u=XO(this._viewHelper.viewDomNode,c,h);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,u,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=go.createOutsideEditor(this._position.mouseColumn,new z(a,1),"above",this._position.outsideDistance):l=go.createOutsideEditor(this._position.mouseColumn,new z(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=Vr(je(l.element),()=>this._execute())}}class tOe extends Vre{_createDragScrollingOperation(e,t){return new iOe(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}}class iOe extends zre{_getScrollSpeed(){const e=this._context.configuration.options.get(59).typicalFullwidthCharacterWidth,t=this._context.configuration.options.get(165).contentWidth/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(59).typicalFullwidthCharacterWidth,t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e*.5,o=this._position.outsidePosition==="left"?-n:n;if(this._context.viewModel.viewLayout.deltaScrollNow(o,0),this._viewHelper.renderNow(),!this._position.position)return;const r=this._position.position.lineNumber;let a;{const l=YO(this._viewHelper.viewDomNode),c=this._context.configuration.options.get(165).horizontalScrollbarHeight,d=new _k(this._mouseEvent.pos.x,l.y+l.height-c-.1),h=XO(this._viewHelper.viewDomNode,l,d);a=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),l,d,h,null)}this._position.outsidePosition==="left"?a=go.createOutsideEditor(a.mouseColumn,new z(r,a.mouseColumn),"left",this._position.outsideDistance):a=go.createOutsideEditor(a.mouseColumn,new z(r,a.mouseColumn),"right",this._position.outsideDistance),this._dispatchMouse(a,!0,2),this._animationFrameDisposable=Vr(je(a.element),()=>this._execute())}}class _$ extends Cv{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Uo(this._context,i),this._mouseDownOperation=this._register(new nOe(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(r,a)=>this._createMouseTarget(r,a),r=>this._getMouseColumn(r))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(165).height;const n=new uPe(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,r=>this._onContextMenu(r,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,r=>{this._onMouseMove(r),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=ee(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new pf(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r)));let o=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(r,a)=>{o=a})),this._register(ee(this.viewHelper.viewDomNode,ye.POINTER_UP,r=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,r=>this._onMouseDown(r,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=SR.INSTANCE;let t=0,i=yl.getZoomLevel(),n=!1,o=0;const r=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(84))return;const c=new Db(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const d=yl.getZoomLevel(),h=c.deltaY>0?1:-1;yl.setZoomLevel(d+h),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=yl.getZoomLevel(),n=a(l),o=0),t=Date.now(),o+=c.deltaY,n&&(yl.setZoomLevel(i+o/5),c.preventDefault(),c.stopPropagation())};this._register(ee(this.viewHelper.viewDomNode,ye.MOUSE_WHEEL,r,{capture:!0,passive:!1}));function a(l){return Bt?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(165)){const t=this._context.configuration.options.get(165).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const n=new Nre(e,t).toPageCoordinates(je(this.viewHelper.viewDomNode)),o=YO(this.viewHelper.viewDomNode);if(n.y<o.y||n.y>o.y+o.height||n.x<o.x||n.x>o.x+o.width)return null;const r=XO(this.viewHelper.viewDomNode,o,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,n,r,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const n=fm(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r))??null)}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,o=i.type===2||i.type===3||i.type===4,r=i.type===3,a=this._context.configuration.options.get(125),l=i.type===8||i.type===5,c=i.type===9;let d=e.leftButton||e.middleButton;Bt&&e.leftButton&&e.ctrlKey&&(d=!1);const h=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(d&&(n||r&&a))h(),this._mouseDownOperation.start(i.type,e,t);else if(o)e.preventDefault();else if(l){const u=i.detail;d&&this.viewHelper.shouldSuppressMouseDownOnViewZone(u.viewZoneId)&&(h(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(h(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class nOe extends K{constructor(e,t,i,n,o,r){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=n,this._createMouseTarget=o,this._getMouseColumn=r,this._mouseMoveMonitor=this._register(new gPe(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new JPe(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._leftRightDragScrolling=this._register(new tOe(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new CB,this._currentSelection=new Oe(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13?t.outsidePosition==="above"||t.outsidePosition==="below"?(this._topBottomDragScrolling.start(t,e),this._leftRightDragScrolling.stop()):(this._leftRightDragScrolling.start(t,e),this._topBottomDragScrolling.stop()):(this._topBottomDragScrolling.stop(),this._leftRightDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const o=this._context.configuration.options;if(!o.get(104)&&o.get(42)&&!o.get(28)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&n.type===6&&n.position&&this._currentSelection.containsPosition(n.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),r=>{const a=this._findMousePosition(this._lastMouseEvent,!1);pu(r)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop(),this._leftRightDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,o=this._getMouseColumn(e);if(e.posy<t.y){const h=t.y-e.posy,u=Math.max(n.getCurrentScrollTop()-h,0),f=Lw.getZoneAtCoord(this._context,u);if(f){const m=this._helpPositionJumpOverViewZone(f);if(m)return go.createOutsideEditor(o,m,"above",h)}const g=n.getLineNumberAtVerticalOffset(u);return go.createOutsideEditor(o,new z(g,1),"above",h)}if(e.posy>t.y+t.height){const h=e.posy-t.y-t.height,u=n.getCurrentScrollTop()+e.relativePos.y,f=Lw.getZoneAtCoord(this._context,u);if(f){const m=this._helpPositionJumpOverViewZone(f);if(m)return go.createOutsideEditor(o,m,"below",h)}const g=n.getLineNumberAtVerticalOffset(u);return go.createOutsideEditor(o,new z(g,i.getLineMaxColumn(g)),"below",h)}const r=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y),a=this._context.configuration.options.get(165),l=a.contentLeft;if(e.relativePos.x<=l){const h=l-e.relativePos.x;return go.createOutsideEditor(o,new z(r,1),"left",h)}const d=a.minimap.minimapLeft===0?a.width-a.verticalScrollbarWidth:a.minimap.minimapLeft;if(e.relativePos.x>=d){const h=e.relativePos.x-d;return go.createOutsideEditor(o,new z(r,i.getLineMaxColumn(r)),"right",h)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(n.type===8||n.type===5){const r=this._helpPositionJumpOverViewZone(n.detail);if(r)return go.createViewZone(n.type,n.element,n.mouseColumn,r,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new z(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}const pA=class pA{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>pA.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};pA.CLEAR_MOUSE_DOWN_COUNT_TIME=400;let CB=pA;class Si{get event(){return this.emitter.event}constructor(e,t,i){const n=o=>this.emitter.fire(o);this.emitter=new q({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}}function Ure(s,e,t,i){const n=s.getPlainTextToCopy(e,t,no),o=s.model.getEOL(),r=t&&e.length===1&&e[0].isEmpty(),a=Array.isArray(n)?n:null,l=Array.isArray(n)?n.join(o):n;let c,d=null;if(wB.forceCopyWithSyntaxHighlighting||i&&l.length<65536){const u=s.getRichTextToCopy(e,t);u&&(c=u.html,d=u.mode)}return{isFromEmptySelection:r,multicursorText:a,text:l,html:c,mode:d}}const _A=class _A{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}};_A.INSTANCE=new _A;let mh=_A;const wB={forceCopyWithSyntaxHighlighting:!1},h_={getTextData(s){const e=s.getData(Un.text);let t=null;const i=s.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&s.files.length>0?[Array.prototype.slice.call(s.files,0).map(o=>o.name).join(`
`),null]:[e,t]},setTextData(s,e,t,i){s.setData(Un.text,e),typeof t=="string"&&s.setData("text/html",t),s.setData("vscode-editor-data",JSON.stringify(i))}},Ap=class Ap{constructor(e,t,i,n,o){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=n,this.newlineCountBeforeSelection=o}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),n=e.getSelectionStart(),o=e.getSelectionEnd();let r;if(t){const a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(r=t.newlineCountBeforeSelection)}return new Ap(i,n,o,null,r)}collapseSelection(){return this.selectionStart===this.value.length?this:new Ap(this.value,this.value.length,this.value.length,null,void 0)}isWrittenToTextArea(e,t){const i=this.value===e.getValue();return t?this.selectionStart===e.getSelectionStart()&&this.selectionEnd===e.getSelectionEnd()&&i:i}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){var n,o,r,a;if(e<=this.selectionStart){const l=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(((n=this.selection)==null?void 0:n.getStartPosition())??null,l,-1)}if(e>=this.selectionEnd){const l=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(((o=this.selection)==null?void 0:o.getEndPosition())??null,l,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf("…")===-1)return this._finishDeduceEditorPosition(((r=this.selection)==null?void 0:r.getStartPosition())??null,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(((a=this.selection)==null?void 0:a.getEndPosition())??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,o=-1;for(;(o=t.indexOf(`
`,o+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(mc(e.value,t.value),e.selectionStart,t.selectionStart),o=Math.min(df(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-o);const r=t.value.substring(n,t.value.length-o),a=e.selectionStart-n,l=e.selectionEnd-n,c=t.selectionStart-n,d=t.selectionEnd-n;if(c===d){const u=e.selectionStart-n;return{text:r,replacePrevCharCnt:u,replaceNextCharCnt:0,positionDelta:0}}const h=l-a;return{text:r,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(mc(e.value,t.value),e.selectionEnd),n=Math.min(df(e.value,t.value),e.value.length-e.selectionEnd),o=e.value.substring(i,e.value.length-n),r=t.value.substring(i,t.value.length-n);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:r,replacePrevCharCnt:a,replaceNextCharCnt:o.length-a,positionDelta:l-r.length}}static fromScreenReaderContentState(e){return new Ap(e.value,e.selectionStart,e.selectionEnd,e.selection,e.newlineCountBeforeSelection)}};Ap.EMPTY=new Ap("",0,0,null,void 0);let qo=Ap;const wv=(function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const s=new Uint8Array(16),e=[];for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(s),s[6]=s[6]&15|64,s[8]=s[8]&63|128;let i=0,n="";return n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+="-",n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n+=e[s[i++]],n}})();function $re(s){return`${s}-${wv()}`}var sOe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},JY=function(s,e){return function(t,i){e(t,i,s)}},xR;(function(s){s.Tap="-monaco-textarea-synthetic-tap"})(xR||(xR={}));class oOe{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}let yB=class extends K{get textAreaState(){return this._textAreaState}constructor(e,t,i,n,o,r){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._accessibilityService=o,this._logService=r,this._onFocus=this._register(new q),this.onFocus=this._onFocus.event,this._onBlur=this._register(new q),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new q),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new q),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new q),this.onCut=this._onCut.event,this._onPaste=this._register(new q),this.onPaste=this._onPaste.event,this._onType=this._register(new q),this.onType=this._onType.event,this._onCompositionStart=this._register(new q),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new q),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new q),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new q),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new mi),this._asyncTriggerCut=this._register(new Ni(()=>this._onCut.fire(),0)),this._textAreaState=qo.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(Se.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new Ni(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let a=null;this._register(this._textArea.onKeyDown(l=>{const c=new Bi(l);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),a=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(l=>{const c=new Bi(l);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(l=>{const c=new oOe;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&a&&a.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===l.data&&(a.code==="ArrowRight"||a.code==="ArrowLeft")){c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:l.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:l.data});return}this._onCompositionStart.fire({data:l.data})})),this._register(this._textArea.onCompositionUpdate(l=>{const c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){const h=qo.readFromTextArea(this._textArea,this._textAreaState),u=qo.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(u),this._onCompositionUpdate.fire(l);return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=qo.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionUpdate.fire(l)})),this._register(this._textArea.onCompositionEnd(l=>{const c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){const h=qo.readFromTextArea(this._textArea,this._textAreaState),u=qo.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(u),this._onCompositionEnd.fire();return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=qo.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const c=qo.readFromTextArea(this._textArea,this._textAreaState),d=qo.deduceInput(this._textAreaState,c,this._OS===2);d.replacePrevCharCnt===0&&d.text.length===1&&(vs(d.text.charCodeAt(0))||d.text.charCodeAt(0)===127)||(this._textAreaState=c,(d.text!==""||d.replacePrevCharCnt!==0||d.replaceNextCharCnt!==0||d.positionDelta!==0)&&(l.inputType==="insertFromPaste"?this._onPaste.fire({text:d.text,metadata:mh.INSTANCE.get(d.text)}):this._onType.fire(d)))})),this._register(this._textArea.onCut(l=>{this._logService.trace("TextAreaInput#onCut",l),this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(l),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(l=>{this._logService.trace("TextAreaInput#onCopy",l),this._ensureClipboardGetsEditorSelection(l)})),this._register(this._textArea.onPaste(l=>{if(this._logService.trace("TextAreaInput#onPaste",l),this._textArea.setIgnoreSelectionChangeTime("received paste event"),l.preventDefault(),!l.clipboardData)return;let[c,d]=h_.getTextData(l.clipboardData);this._logService.trace("TextAreaInput#onPaste with id : ",d==null?void 0:d.id," with text.length: ",c.length),c&&(d=d||mh.INSTANCE.get(c),this._logService.trace("TextAreaInput#onPaste (before onPaste)"),this._onPaste.fire({text:c,metadata:d}))})),this._register(this._textArea.onFocus(()=>{const l=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!l&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new Ni(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return ee(this._textArea.ownerDocument,"selectionchange",t=>{if(vg.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const o=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),o<100||!this._textAreaState.selection)return;const r=this._textArea.getValue();if(this._textAreaState.value!==r)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),d=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(h[0],h[1],h[2]),f=new Oe(d.lineNumber,d.column,u.lineNumber,u.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.isWrittenToTextArea(this._textArea,this._hasFocus)||this._logService.trace(`writeTextAreaState(reason: ${e})`),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent())}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy();let i;this._logService.getLevel()===Ns.Trace&&(i=wv());const n={version:1,id:i,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};mh.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,n),e.preventDefault(),e.clipboardData&&h_.setTextData(e.clipboardData,t.text,t.html,n),this._logService.trace("TextAreaEditContextInput#_ensureClipboardGetsEditorSelection with id : ",i," with text.length: ",t.text.length)}};yB=sOe([JY(4,so),JY(5,Ji)],yB);class rOe extends K{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this._onSyntheticTap=this._register(new q),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this.onKeyDown=this._register(new Si(this._actual,"keydown")).event,this.onKeyPress=this._register(new Si(this._actual,"keypress")).event,this.onKeyUp=this._register(new Si(this._actual,"keyup")).event,this.onCompositionStart=this._register(new Si(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new Si(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new Si(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new Si(this._actual,"beforeinput")).event,this.onInput=this._register(new Si(this._actual,"input")).event,this.onCut=this._register(new Si(this._actual,"cut")).event,this.onCopy=this._register(new Si(this._actual,"copy")).event,this.onPaste=this._register(new Si(this._actual,"paste")).event,this.onFocus=this._register(new Si(this._actual,"focus")).event,this.onBlur=this._register(new Si(this._actual,"blur")).event,this._register(this.onKeyDown(()=>vg.onKeyDown())),this._register(this.onBeforeInput(()=>vg.onBeforeInput())),this._register(this.onInput(()=>vg.onInput())),this._register(this.onKeyUp(()=>vg.onKeyUp())),this._register(ee(this._actual,xR.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=fm(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?Ss()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let o=null;const r=fm(n);r?o=r.activeElement:o=Ss();const a=je(o),l=o===n,c=n.selectionStart,d=n.selectionEnd;if(l&&c===t&&d===i){Wr&&a.parent!==a&&n.focus();return}if(l){this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),Wr&&a.parent!==a&&n.focus();return}try{const h=WTe(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),HTe(n,h)}catch{}}}class aOe extends _${constructor(e,t,i){super(e,t,i),this._register(Oo.addTarget(this.viewHelper.linesContentDomNode)),this._register(ee(this.viewHelper.linesContentDomNode,Qi.Tap,o=>this.onTap(o))),this._register(ee(this.viewHelper.linesContentDomNode,Qi.Change,o=>this.onChange(o))),this._register(ee(this.viewHelper.linesContentDomNode,Qi.Contextmenu,o=>this._onContextMenu(new pf(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(ee(this.viewHelper.linesContentDomNode,"pointerdown",o=>{const r=o.pointerType;if(r==="mouse"){this._lastPointerType="mouse";return}else r==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const n=new fPe(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(o,r)=>this._onMouseDown(o,r)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){const i=this._createMouseTarget(new pf(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class lOe extends _${constructor(e,t,i){super(e,t,i),this._register(Oo.addTarget(this.viewHelper.linesContentDomNode)),this._register(ee(this.viewHelper.linesContentDomNode,Qi.Tap,n=>this.onTap(n))),this._register(ee(this.viewHelper.linesContentDomNode,Qi.Change,n=>this.onChange(n))),this._register(ee(this.viewHelper.linesContentDomNode,Qi.Contextmenu,n=>this._onContextMenu(new pf(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new pf(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(xR.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class cOe extends K{constructor(e,t,i){super(),(Al||Tke&&Lse)&&rk.pointerEvents?this.handler=this._register(new aOe(e,t,i)):Ti.TouchEvent?this.handler=this._register(new lOe(e,t,i)):this.handler=this._register(new _$(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class dOe{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Vs.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new z(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(86)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(86)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=Hr&&t.get(121),n=t.get(28),o=t.get(171);e.middleButton&&!i?o||this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Vs.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Vs.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Vs.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Vs.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Vs.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Vs.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Vs.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Vs.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Vs.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Vs.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Vs.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Vs.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Vs.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}function Oh(s,e){var i;const t=lU();if(t!=null&&t.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(s,e)}catch(n){_t(n);return}try{return(i=globalThis.trustedTypes)==null?void 0:i.createPolicy(s,e)}catch(n){_t(n);return}}class qre{constructor(e){this._lineFactory=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new et("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let o=0,r=0;for(let l=i;l<=n;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(r===0?(o=c,r=1):r++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(o,r)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const n=this.getStartLineNumber(),o=this.getEndLineNumber();let r=!1;for(let a=e;a<=i;a++)a>=n&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>o)return null;if(i+e>o)return this._lines.splice(e-this._rendLineNumberStart,o-e+1);const r=[];for(let h=0;h<i;h++)r[h]=this._lineFactory.createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),d=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(r).concat(c),d}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let o=0,r=e.length;o<r;o++){const a=e[o];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let d=l;d<=c;d++){const h=d-this._rendLineNumberStart;this._lines[h].onTokensChanged(),n=!0}}return n}}class jre{constructor(e,t){this._viewContext=e,this._lineFactory=t,this.domNode=this._createDomNode(),this._linesCollection=new qre(this._lineFactory)}_createDomNode(){const e=gi(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(165)}onFlushed(e,t){var i;if(t){const n=this._linesCollection.getStartLineNumber(),o=this._linesCollection.getEndLineNumber();for(let r=n;r<=o;r++)(i=this._linesCollection.getLine(r).getDomNode())==null||i.remove()}return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const o=t[i].getDomNode();o==null||o.remove()}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const o=t[i].getDomNode();o==null||o.remove()}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new SB(this.domNode.domNode,this._lineFactory,e,this._viewContext),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}}const gu=class gu{constructor(e,t,i,n){this._domNode=e,this._lineFactory=t,this._viewportData=i,this._viewContext=n}render(e,t,i,n){const o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||i<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=i-t+1,o.lines=[];for(let r=t;r<=i;r++)o.lines[r-t]=this._lineFactory.createLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,t),o.rendLineNumberStart>t){const r=t,a=Math.min(i,o.rendLineNumberStart-1);r<=a&&(this._insertLinesBefore(o,r,a,n,t),o.linesLength+=a-r+1)}else if(o.rendLineNumberStart<t){const r=Math.min(o.linesLength,t-o.rendLineNumberStart);r>0&&(this._removeLinesBefore(o,r),o.linesLength-=r)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<i){const r=o.rendLineNumberStart+o.linesLength,a=i;r<=a&&(this._insertLinesAfter(o,r,a,n,t),o.linesLength+=a-r+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){const r=Math.max(0,i-o.rendLineNumberStart+1),l=o.linesLength-1-r+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(e,t,i,n,o){const r=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=r+l;a[l].layoutLine(c,n[c-o],this._lineHeightForLineNumber(c))}}_insertLinesBefore(e,t,i,n,o){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this._lineFactory.createLine();e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const n=e.lines[i].getDomNode();n==null||n.remove()}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,o){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++){const o=e.lines[i+n].getDomNode();o==null||o.remove()}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){gu._ttPolicy&&(i=gu._ttPolicy.createHTML(i));const o=this._domNode.lastChild;t||!o?this._domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let r=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];n[a]&&(l.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");gu._ttPolicy&&(t=gu._ttPolicy.createHTML(t)),n.innerHTML=t;for(let o=0;o<e.linesLength;o++){const r=e.lines[o];if(i[o]){const a=n.firstChild;r.getDomNode().replaceWith(a),r.setDomNode(a)}}}_finishRendering(e,t,i){const n=gu._sb,o=e.linesLength,r=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let c=!1;for(let d=0;d<o;d++){const h=r[d];if(l[d]=!1,h.getDomNode())continue;const f=d+a;h.renderLine(f,i[d],this._lineHeightForLineNumber(f),this._viewportData,n)&&(l[d]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let c=!1;const d=[];for(let h=0;h<o;h++){const u=r[h];if(d[h]=!1,l[h])continue;const f=h+a;u.renderLine(f,i[h],this._lineHeightForLineNumber(f),this._viewportData,n)&&(d[h]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,n.build(),d)}}_lineHeightForLineNumber(e){return this._viewContext.viewLayout.getLineHeightForLineNumber(e)}};gu._ttPolicy=Oh("editorViewLayer",{createHTML:e=>e}),gu._sb=new Dm(1e5);let SB=gu;class Kre extends yr{constructor(e){super(e),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new jre(this._context,{createLine:()=>new hOe(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(59);js(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._context.configuration.options.get(59);return js(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){const o=t[i];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class hOe{constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=gi(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,o){let r="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){const c=this._dynamicOverlays[a];r+=c.render(n.startLineNumber,e)}return this._renderedContent===r?!1:(this._renderedContent=r,o.appendString('<div style="top:'),o.appendString(String(t)),o.appendString("px;height:"),o.appendString(String(i)),o.appendString("px;line-height:"),o.appendString(String(i)),o.appendString('px;">'),o.appendString(r),o.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i),this._domNode.setLineHeight(i))}}class uOe extends Kre{constructor(e){super(e);const i=this._context.configuration.options.get(165);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class fOe extends Kre{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),js(this.domNode,t.get(59))}onConfigurationChanged(e){const t=this._context.configuration.options;js(this.domNode,t.get(59));const i=t.get(165);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class JO{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;(t=this.onKeyDown)==null||t.call(this,e)}emitKeyUp(e){var t;(t=this.onKeyUp)==null||t.call(this,e)}emitContextMenu(e){var t;(t=this.onContextMenu)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;(t=this.onMouseMove)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;(t=this.onMouseLeave)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;(t=this.onMouseDown)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;(t=this.onMouseUp)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;(t=this.onMouseDrag)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;(t=this.onMouseDrop)==null||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;(e=this.onMouseDropCanceled)==null||e.call(this)}emitMouseWheel(e){var t;(t=this.onMouseWheel)==null||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return JO.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new z(e.afterLineNumber,1)).lineNumber}}}class gOe extends yr{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=gi(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(165),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);const o=i.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0;const i=e.getDecorationsInViewport();for(const n of i){if(!n.options.blockClassName)continue;let o=this.blocks[t];o||(o=this.blocks[t]=gi(document.createElement("div")),this.domNode.appendChild(o));let r,a;n.options.blockIsAfterEnd?(r=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(r=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[l,c,d,h]=n.options.blockPadding??[0,0,0,0];o.setClassName("blockDecorations-block "+n.options.blockClassName),o.setLeft(this.contentLeft-h),o.setWidth(this.contentWidth+h+c),o.setTop(r-e.scrollTop-l),o.setHeight(a-r+l+d),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}}class mOe extends yr{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=gi(document.createElement("div")),dd.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=gi(document.createElement("div")),dd.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new pOe(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,o){this._widgets[e.getId()].setPosition(t,i,n,o),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class pOe{constructor(e,t,i){this._primaryAnchor=new O0(null,null),this._secondaryAnchor=new O0(null,null),this._context=e,this._viewDomNode=t,this._actual=i;const n=this._context.configuration.options,o=n.get(165),r=n.get(4);this.domNode=gi(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=(this._actual.allowEditorOverflow||!1)&&r,this.suppressMouseDown=this._actual.suppressMouseDown||!1,this._fixedOverflowWidgets=n.get(51),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(e.hasChanged(165)){const i=t.get(165);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(o,r,a){if(!o)return new O0(null,null);const l=r.model.validatePosition(o);if(r.coordinatesConverter.modelPositionIsVisible(l)){const c=r.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new O0(o,c)}return new O0(o,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?(t==null?void 0:t.innerWidth)||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){const o=e.top,r=o,a=e.top+e.height,l=n.viewportHeight-a,c=o-i,d=r>=i,h=a,u=l>=i;let f=e.left;return f+t>n.scrollLeft+n.viewportWidth&&(f=n.scrollLeft+n.viewportWidth-t),f<n.scrollLeft&&(f=n.scrollLeft),{fitsAbove:d,aboveTop:c,fitsBelow:u,belowTop:h,left:f}}_layoutHorizontalSegmentInPage(e,t,i,n){const a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),d=this._viewDomNode.domNode.ownerDocument.defaultView;let h=t.left+i-((d==null?void 0:d.scrollX)??0);if(h+n>l){const u=h-(l-n);h-=u,i-=u}if(h<a){const u=h-a;h-=u,i-=u}return[i,h]}_layoutBoxInPage(e,t,i,n){const o=e.top-i,r=e.top+e.height,a=Fn(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,c=l.defaultView,d=a.top+o-((c==null?void 0:c.scrollY)??0),h=a.top+r-((c==null?void 0:c.scrollY)??0),u=um(l.body),[f,g]=this._layoutHorizontalSegmentInPage(u,a,e.left-n.scrollLeft+this._contentLeft,t),m=22,p=22,v=d>=m,b=h+i<=u.height-p;return this._fixedOverflowWidgets?{fitsAbove:v,aboveTop:Math.max(d,m),fitsBelow:b,belowTop:h,left:g}:{fitsAbove:v,aboveTop:o,fitsBelow:b,belowTop:r,left:f}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new F0(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){var r,a;const t=o(this._primaryAnchor.viewPosition,this._affinity),i=((r=this._secondaryAnchor.viewPosition)==null?void 0:r.lineNumber)===((a=this._primaryAnchor.viewPosition)==null?void 0:a.lineNumber)?this._secondaryAnchor.viewPosition:null,n=o(i,this._affinity);return{primary:t,secondary:n};function o(l,c){if(!l)return null;const d=e.visibleRangeForPosition(l);if(!d)return null;const h=l.column===1&&c===3?0:d.left,u=e.getVerticalOffsetForLineNumber(l.lineNumber)-e.scrollTop,f=e.getLineHeightForLineNumber(l.lineNumber);return new eX(u,h,f)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const n=this._context.configuration.options.get(59);let o=t.left;return o<e.left?o=Math.max(o,e.left-i+n.typicalFullwidthCharacterWidth):o=Math.min(o,e.left+i-n.typicalFullwidthCharacterWidth),new eX(e.top,o,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let r=null;if(typeof this._actual.beforeRender=="function"&&(r=X5(this._actual.beforeRender,this._actual)),r)this._cachedDomNodeOffsetWidth=r.width,this._cachedDomNodeOffsetHeight=r.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let o;this.allowEditorOverflow?o=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):o=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let r=1;r<=2;r++)for(const a of this._preference)if(a===1){if(!o)return null;if(r===2||o.fitsAbove)return{kind:"inViewport",coordinate:new F0(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(r===2||o.fitsBelow)return{kind:"inViewport",coordinate:new F0(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new F0(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new F0(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){var t;if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,((t=this._renderData)==null?void 0:t.kind)==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&X5(this._actual.afterRender,this._actual,null,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&X5(this._actual.afterRender,this._actual,this._renderData.position,this._renderData.coordinate)}}class O0{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class F0{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class eX{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function X5(s,e,...t){try{return s.call(e,...t)}catch{return null}}class Nm extends Cv{}const Dn=Mt("themeService");function Mn(s){return{id:s}}function xB(s){switch(s){case Il.DARK:return DC.VS_DARK;case Il.HIGH_CONTRAST_DARK:return DC.HC_BLACK;case Il.HIGH_CONTRAST_LIGHT:return DC.HC_LIGHT;default:return DC.VS}}const Gre={ThemingContribution:"base.contributions.theming"};class _Oe extends K{constructor(){super(),this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=this._register(new q)}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Ve(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const Yre=new _Oe;kn.add(Gre.ThemingContribution,Yre);function Ul(s){return Yre.onColorThemeChange(s)}class bOe extends K{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}const Xre=F("editor.lineHighlightBackground",null,_(610,"Background color for the highlight of line at the cursor position.")),tX=F("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Yt},_(611,"Background color for the border around the line at the cursor position."));F("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},_(612,"Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:fn,hcLight:fn},_(613,"Background color of the border around highlighted ranges."));F("editor.symbolHighlightBackground",{dark:Pu,light:Pu,hcDark:null,hcLight:null},_(614,"Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:fn,hcLight:fn},_(615,"Background color of the border around highlighted symbols."));const e4=F("editorCursor.foreground",{dark:"#AEAFAD",light:re.black,hcDark:re.white,hcLight:"#0F4A85"},_(616,"Color of the editor cursor.")),b$=F("editorCursor.background",null,_(617,"The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),Zre=F("editorMultiCursor.primary.foreground",e4,_(618,"Color of the primary editor cursor when multiple cursors are present.")),vOe=F("editorMultiCursor.primary.background",b$,_(619,"The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),Qre=F("editorMultiCursor.secondary.foreground",e4,_(620,"Color of secondary editor cursors when multiple cursors are present.")),COe=F("editorMultiCursor.secondary.background",b$,_(621,"The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),v$=F("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},_(622,"Color of whitespace characters in the editor.")),wOe=F("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:re.white,hcLight:"#292929"},_(623,"Color of editor line numbers.")),yOe=F("editorIndentGuide.background",v$,_(624,"Color of the editor indentation guides."),!1,_(625,"'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),SOe=F("editorIndentGuide.activeBackground",v$,_(626,"Color of the active editor indentation guides."),!1,_(627,"'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),Ck=F("editorIndentGuide.background1",yOe,_(628,"Color of the editor indentation guides (1).")),xOe=F("editorIndentGuide.background2","#00000000",_(629,"Color of the editor indentation guides (2).")),LOe=F("editorIndentGuide.background3","#00000000",_(630,"Color of the editor indentation guides (3).")),IOe=F("editorIndentGuide.background4","#00000000",_(631,"Color of the editor indentation guides (4).")),EOe=F("editorIndentGuide.background5","#00000000",_(632,"Color of the editor indentation guides (5).")),kOe=F("editorIndentGuide.background6","#00000000",_(633,"Color of the editor indentation guides (6).")),wk=F("editorIndentGuide.activeBackground1",SOe,_(634,"Color of the active editor indentation guides (1).")),DOe=F("editorIndentGuide.activeBackground2","#00000000",_(635,"Color of the active editor indentation guides (2).")),TOe=F("editorIndentGuide.activeBackground3","#00000000",_(636,"Color of the active editor indentation guides (3).")),NOe=F("editorIndentGuide.activeBackground4","#00000000",_(637,"Color of the active editor indentation guides (4).")),ROe=F("editorIndentGuide.activeBackground5","#00000000",_(638,"Color of the active editor indentation guides (5).")),MOe=F("editorIndentGuide.activeBackground6","#00000000",_(639,"Color of the active editor indentation guides (6).")),AOe=F("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:fn,hcLight:fn},_(640,"Color of editor active line number"),!1,_(641,"Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));F("editorLineNumber.activeForeground",AOe,_(642,"Color of editor active line number"));const POe=F("editorLineNumber.dimmedForeground",null,_(643,"Color of the final editor line when editor.renderFinalNewline is set to dimmed.")),OOe=F("editorRuler.foreground",{dark:"#5A5A5A",light:re.lightgrey,hcDark:re.white,hcLight:"#292929"},_(644,"Color of the editor rulers."));F("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},_(645,"Foreground color of editor CodeLens"));F("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},_(646,"Background color behind matching brackets"));F("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Yt,hcLight:Yt},_(647,"Color for matching brackets boxes"));const FOe=F("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},_(648,"Color of the overview ruler border.")),BOe=F("editorOverviewRuler.background",null,_(649,"Background color of the editor overview ruler."));F("editorGutter.background",es,_(650,"Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));F("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:re.fromHex("#fff").transparent(.8),hcLight:Yt},_(651,"Border color of unnecessary (unused) source code in the editor."));const WOe=F("editorUnnecessaryCode.opacity",{dark:re.fromHex("#000a"),light:re.fromHex("#0007"),hcDark:null,hcLight:null},_(652,`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));F("editorGhostText.border",{dark:null,light:null,hcDark:re.fromHex("#fff").transparent(.8),hcLight:re.fromHex("#292929").transparent(.8)},_(653,"Border color of ghost text in the editor."));const HOe=F("editorGhostText.foreground",{dark:re.fromHex("#ffffff56"),light:re.fromHex("#0007"),hcDark:null,hcLight:null},_(654,"Foreground color of the ghost text in the editor."));F("editorGhostText.background",null,_(655,"Background color of the ghost text in the editor."));const VOe=new re(new ce(0,122,204,.6)),Jre=F("editorOverviewRuler.rangeHighlightForeground",VOe,_(656,"Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),zOe=F("editorOverviewRuler.errorForeground",{dark:new re(new ce(255,18,18,.7)),light:new re(new ce(255,18,18,.7)),hcDark:new re(new ce(255,50,50,1)),hcLight:"#B5200D"},_(657,"Overview ruler marker color for errors.")),UOe=F("editorOverviewRuler.warningForeground",{dark:mf,light:mf,hcDark:RL,hcLight:RL},_(658,"Overview ruler marker color for warnings.")),$Oe=F("editorOverviewRuler.infoForeground",{dark:Lh,light:Lh,hcDark:ML,hcLight:ML},_(659,"Overview ruler marker color for infos.")),eae=F("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},_(660,"Foreground color of brackets (1). Requires enabling bracket pair colorization.")),tae=F("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},_(661,"Foreground color of brackets (2). Requires enabling bracket pair colorization.")),iae=F("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},_(662,"Foreground color of brackets (3). Requires enabling bracket pair colorization.")),nae=F("editorBracketHighlight.foreground4","#00000000",_(663,"Foreground color of brackets (4). Requires enabling bracket pair colorization.")),sae=F("editorBracketHighlight.foreground5","#00000000",_(664,"Foreground color of brackets (5). Requires enabling bracket pair colorization.")),oae=F("editorBracketHighlight.foreground6","#00000000",_(665,"Foreground color of brackets (6). Requires enabling bracket pair colorization.")),qOe=F("editorBracketHighlight.unexpectedBracket.foreground",{dark:new re(new ce(255,18,18,.8)),light:new re(new ce(255,18,18,.8)),hcDark:new re(new ce(255,50,50,1)),hcLight:"#B5200D"},_(666,"Foreground color of unexpected brackets.")),jOe=F("editorBracketPairGuide.background1","#00000000",_(667,"Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),KOe=F("editorBracketPairGuide.background2","#00000000",_(668,"Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),GOe=F("editorBracketPairGuide.background3","#00000000",_(669,"Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),YOe=F("editorBracketPairGuide.background4","#00000000",_(670,"Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),XOe=F("editorBracketPairGuide.background5","#00000000",_(671,"Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),ZOe=F("editorBracketPairGuide.background6","#00000000",_(672,"Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),QOe=F("editorBracketPairGuide.activeBackground1","#00000000",_(673,"Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),JOe=F("editorBracketPairGuide.activeBackground2","#00000000",_(674,"Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),e4e=F("editorBracketPairGuide.activeBackground3","#00000000",_(675,"Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),t4e=F("editorBracketPairGuide.activeBackground4","#00000000",_(676,"Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),i4e=F("editorBracketPairGuide.activeBackground5","#00000000",_(677,"Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),n4e=F("editorBracketPairGuide.activeBackground6","#00000000",_(678,"Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));F("editorUnicodeHighlight.border",mf,_(679,"Border color used to highlight unicode characters."));F("editorUnicodeHighlight.background",PMe,_(680,"Background color used to highlight unicode characters."));Ul((s,e)=>{const t=s.getColor(es),i=s.getColor(Xre),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});class rae extends Nm{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(165);this._renderLineHighlight=t.get(110),this._renderLineHighlightOnlyWhenFocus=t.get(111),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Oe(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=new Set;for(const o of this._selections)t.add(o.positionLineNumber);const i=Array.from(t);i.sort((o,r)=>o-r),dn(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const n=this._selections.every(o=>o.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._renderLineHighlight=t.get(110),this._renderLineHighlightOnlyWhenFocus=t.get(111),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let r=t;r<=i;r++){const a=r-t;n[a]=""}if(this._wordWrap){const r=this._renderOne(e,!1);for(const a of this._cursorLineNumbers){const l=this._context.viewModel.coordinatesConverter,c=l.convertViewPositionToModelPosition(new z(a,1)).lineNumber,d=l.convertModelPositionToViewPosition(new z(c,1)).lineNumber,h=l.convertModelPositionToViewPosition(new z(c,this._context.viewModel.model.getLineMaxColumn(c))).lineNumber,u=Math.max(d,t),f=Math.min(h,i);for(let g=u;g<=f;g++){const m=g-t;n[m]=r}}}const o=this._renderOne(e,!0);for(const r of this._cursorLineNumbers){if(r<t||r>i)continue;const a=r-t;n[a]=o}this._renderData=n}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class s4e extends rae{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class o4e extends rae{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}Ul((s,e)=>{const t=s.getColor(Xre);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||s.defines(tX)){const i=s.getColor(tX);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),od(s.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class r4e extends Nm{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let l=0,c=t.length;l<c;l++){const d=t[l];d.options.className&&(i[n++]=d)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const d=l.options.className,h=c.options.className;return d<h?-1:d>h?1:D.compareRangesUsingStarts(l.range,c.range)});const o=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,a=[];for(let l=o;l<=r;l++){const c=l-o;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const n=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let r=0,a=t.length;r<a;r++){const l=t[r];if(!l.options.isWholeLine)continue;const c='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',d=Math.max(l.range.startLineNumber,n),h=Math.min(l.range.endLineNumber,o);for(let u=d;u<=h;u++){const f=u-n;i[f]+=c}}}_renderNormalDecorations(e,t,i){const n=e.visibleRange.startLineNumber;let o=null,r=!1,a=null,l=!1;for(let c=0,d=t.length;c<d;c++){const h=t[c];if(h.options.isWholeLine)continue;const u=h.options.className,f=!!h.options.showIfCollapsed;let g=h.range;if(f&&g.endColumn===1&&g.endLineNumber!==g.startLineNumber&&(g=new D(g.startLineNumber,g.startColumn,g.endLineNumber-1,this._context.viewModel.getLineMaxColumn(g.endLineNumber-1))),o===u&&r===f&&D.areIntersectingOrTouching(a,g)){a=D.plusRange(a,g);continue}o!==null&&this._renderNormalDecoration(e,a,o,l,r,n,i),o=u,r=f,a=g,l=h.options.shouldFillLineOnLineBreak??!1}o!==null&&this._renderNormalDecoration(e,a,o,l,r,n,i)}_renderNormalDecoration(e,t,i,n,o,r,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,d=l.length;c<d;c++){const h=l[c];if(h.outsideRenderedLine)continue;const u=h.lineNumber-r;if(o&&h.ranges.length===1){const f=h.ranges[0];if(f.width<this._typicalHalfwidthCharacterWidth){const g=Math.round(f.left+f.width/2),m=Math.max(0,Math.round(g-this._typicalHalfwidthCharacterWidth/2));h.ranges[0]=new bk(m,this._typicalHalfwidthCharacterWidth)}}for(let f=0,g=h.ranges.length;f<g;f++){const m=n&&h.continuesOnNextLine&&g===1,p=h.ranges[f],v='<div class="cdr '+i+'" style="left:'+String(p.left)+"px;width:"+(m?"100%;":String(p.width)+"px;")+'"></div>';a[u]+=v}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class a4e extends yr{constructor(e,t,i,n){super(e);const o=this._context.configuration.options,r=o.get(117),a=o.get(83),l=o.get(49),c=o.get(120),d=o.get(158),h={listenOnDomNode:i.domNode,className:"editor-scrollable "+xB(e.theme.type),useShadows:!1,lazyRender:!0,vertical:r.vertical,horizontal:r.horizontal,verticalHasArrows:r.verticalHasArrows,horizontalHasArrows:r.horizontalHasArrows,verticalScrollbarSize:r.verticalScrollbarSize,verticalSliderSize:r.verticalSliderSize,horizontalScrollbarSize:r.horizontalScrollbarSize,horizontalSliderSize:r.horizontalSliderSize,handleMouseWheel:r.handleMouseWheel,alwaysConsumeMouseWheel:r.alwaysConsumeMouseWheel,arrowSize:r.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:r.scrollByPage,inertialScroll:d};this.scrollbar=this._register(new QO(t.domNode,h,this._context.viewLayout.getScrollable())),dd.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=gi(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const u=(f,g,m)=>{const p={};{const v=f.scrollTop;v&&(p.scrollTop=this._context.viewLayout.getCurrentScrollTop()+v,f.scrollTop=0)}if(m){const v=f.scrollLeft;v&&(p.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+v,f.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(p,1)};this._register(ee(i.domNode,"scroll",f=>u(i.domNode,!0,!0))),this._register(ee(t.domNode,"scroll",f=>u(t.domNode,!0,!1))),this._register(ee(n.domNode,"scroll",f=>u(n.domNode,!0,!1))),this._register(ee(this.scrollbarDomNode.domNode,"scroll",f=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(165);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(81).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(117)||e.hasChanged(83)||e.hasChanged(49)){const t=this._context.configuration.options,i=t.get(117),n=t.get(83),o=t.get(49),r=t.get(120),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:o,scrollPredominantAxis:r};this.scrollbar.updateOptions(a)}return e.hasChanged(165)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+xB(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class LB{constructor(e,t,i,n,o){this.startLineNumber=e,this.endLineNumber=t,this.className=i,this.tooltip=n,this._decorationToRenderBrand=void 0,this.zIndex=o??0}}class l4e{constructor(e,t,i){this.className=e,this.zIndex=t,this.tooltip=i}}class c4e{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class aae extends Nm{_render(e,t,i){const n=[];for(let a=e;a<=t;a++){const l=a-e;n[l]=new c4e}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,r=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.className,h=c.zIndex;let u=Math.max(c.startLineNumber,e)-e;const f=Math.min(c.endLineNumber,t)-e;o===d?(u=Math.max(r+1,u),r=Math.max(r,f)):(o=d,r=f);for(let g=u;g<=r;g++)n[g].add(new l4e(d,h,c.tooltip))}return n}}class d4e extends yr{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(165);this.domNode=gi(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(75),this._glyphMargin=t.get(66),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._lineHeight=t.get(75),this._glyphMargin=t.get(66),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=gi(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&D.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets[t]){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){var r;const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=e.getDecorationsInViewport();for(const a of o){const l=a.options.glyphMarginClassName;if(!l)continue;const c=Math.max(a.range.startLineNumber,i),d=Math.min(a.range.endLineNumber,n),h=((r=a.options.glyphMargin)==null?void 0:r.position)??cd.Center,u=a.options.zIndex??0;for(let f=c;f<=d;f++){const g=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(f,0)),m=this._context.viewModel.glyphLanes.getLanesAtLine(g.lineNumber).indexOf(h);t.push(new h4e(f,m,u,l))}}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(const o of Object.values(this._widgets)){const r=o.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(D.lift(r));if(!a||!l||l<i||a>n)continue;const c=Math.max(a,i),d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(c,0)),h=this._context.viewModel.glyphLanes.getLanesAtLine(d.lineNumber).indexOf(o.preference.lane);t.push(new u4e(c,h,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const n of Object.values(this._widgets))n.renderInfo=null;const t=new ff(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const n=t.peek();if(!n)break;const o=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!o||o.length===0)break;const r=o[0];if(r.type===0){const a=[];for(const l of o){if(l.zIndex!==r.zIndex||l.type!==r.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(r.accept(a.join(" ")))}else r.widget.renderInfo={lineNumber:r.lineNumber,laneIndex:r.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(o),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const n=this._decorationGlyphsToRender[i],o=n.lineNumber,r=e.viewportData.relativeVerticalOffset[o-e.viewportData.startLineNumber],a=this._glyphMarginLeft+n.laneIndex*this._lineHeight;let l;i<this._managedDomNodes.length?l=this._managedDomNodes[i]:(l=gi(document.createElement("div")),this._managedDomNodes.push(l),this.domNode.appendChild(l));const c=this._context.viewLayout.getLineHeightForLineNumber(o);l.setClassName("cgmr codicon "+n.combinedClassName),l.setPosition("absolute"),l.setTop(r),l.setLeft(a),l.setWidth(t),l.setHeight(c)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}}}class h4e{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.className=n,this.type=0}accept(e){return new f4e(this.lineNumber,this.laneIndex,e)}}class u4e{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.widget=n,this.type=1}}class f4e{constructor(e,t,i){this.lineNumber=e,this.laneIndex=t,this.combinedClassName=i}}function BL(s,e,t=s.length-1){const i=g4e(s,e,t);if(i!==-1)return s[i]}function g4e(s,e,t=s.length-1){for(let i=t;i>=0;i--){const n=s[i];if(e(n,i))return i}return-1}function kw(s,e){const t=Dw(s,e);return t===-1?void 0:s[t]}function Dw(s,e,t=0,i=s.length){let n=t,o=i;for(;n<o;){const r=Math.floor((n+o)/2);e(s[r])?n=r+1:o=r}return n-1}function m4e(s,e){const t=WL(s,e);return t===s.length?void 0:s[t]}function WL(s,e,t=0,i=s.length){let n=t,o=i;for(;n<o;){const r=Math.floor((n+o)/2);e(s[r])?o=r:n=r+1}return n}const bA=class bA{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(bA.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=Dw(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};bA.assertInvariants=!1;let LR=bA;function C$(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>0&&(t=n)}return t}function lae(s,e){if(s.length===0)return;let t=s[0];for(let i=1;i<s.length;i++){const n=s[i];e(n,t)>=0&&(t=n)}return t}function cae(s,e){return C$(s,(t,i)=>-e(t,i))}function p4e(s,e){if(s.length===0)return-1;let t=0;for(let i=1;i<s.length;i++){const n=s[i];e(n,s[t])>0&&(t=i)}return t}function _4e(s,e){for(const t of s){const i=e(t);if(i!==void 0)return i}}class dae extends K{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function t4(s,e){let t=0,i=0;const n=s.length;for(;i<n;){const o=s.charCodeAt(i);if(o===32)t++;else if(o===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var u_;(function(s){s[s.Disabled=0]="Disabled",s[s.EnabledForActive=1]="EnabledForActive",s[s.Enabled=2]="Enabled"})(u_||(u_={}));class Yp{constructor(e,t,i,n,o,r){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=n,this.forWrappedLinesAfterColumn=o,this.forWrappedLinesBeforeOrAtColumn=r,e!==-1==(t!==-1))throw new Error}}class jS{constructor(e,t){this.top=e,this.endColumn=t}}class b4e extends dae{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return t4(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new et("Illegal value for lineNumber");const o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(o&&o.offSide);let a=-2,l=-1,c=-2,d=-1;const h=S=>{if(a!==-1&&(a===-2||a>S-1)){a=-1,l=-1;for(let L=S-2;L>=0;L--){const E=this._computeIndentLevel(L);if(E>=0){a=L,l=E;break}}}if(c===-2){c=-1,d=-1;for(let L=S;L<n;L++){const E=this._computeIndentLevel(L);if(E>=0){c=L,d=E;break}}}};let u=-2,f=-1,g=-2,m=-1;const p=S=>{if(u===-2){u=-1,f=-1;for(let L=S-2;L>=0;L--){const E=this._computeIndentLevel(L);if(E>=0){u=L,f=E;break}}}if(g!==-1&&(g===-2||g<S-1)){g=-1,m=-1;for(let L=S;L<n;L++){const E=this._computeIndentLevel(L);if(E>=0){g=L,m=E;break}}}};let v=0,b=!0,w=0,C=!0,y=0,x=0;for(let S=0;b||C;S++){const L=e-S,E=e+S;S>1&&(L<1||L<t)&&(b=!1),S>1&&(E>n||E>i)&&(C=!1),S>5e4&&(b=!1,C=!1);let M=-1;if(b&&L>=1){const T=this._computeIndentLevel(L-1);T>=0?(c=L-1,d=T,M=Math.ceil(T/this.textModel.getOptions().indentSize)):(h(L),M=this._getIndentLevelForWhitespaceLine(r,l,d))}let R=-1;if(C&&E<=n){const T=this._computeIndentLevel(E-1);T>=0?(u=E-1,f=T,R=Math.ceil(T/this.textModel.getOptions().indentSize)):(p(E),R=this._getIndentLevelForWhitespaceLine(r,f,m))}if(S===0){x=M;continue}if(S===1){if(E<=n&&R>=0&&x+1===R){b=!1,v=E,w=E,y=R;continue}if(L>=1&&M>=0&&M-1===x){C=!1,v=L,w=L,y=M;continue}if(v=e,w=e,y=x,y===0)return{startLineNumber:v,endLineNumber:w,indent:y}}b&&(M>=y?v=L:b=!1),C&&(R>=y?w=E:C=!1)}return{startLineNumber:v,endLineNumber:w,indent:y}}getLinesBracketGuides(e,t,i,n){var h;const o=[];for(let u=e;u<=t;u++)o.push([]);const r=!0,a=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new D(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let l;if(i&&a.length>0){const u=(e<=i.lineNumber&&i.lineNumber<=t?a:this.textModel.bracketPairs.getBracketPairsInRange(D.fromPositions(i)).toArray()).filter(f=>D.strictContainsPosition(f.range,i));l=(h=BL(u,f=>r))==null?void 0:h.range}const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,d=new hae;for(const u of a){if(!u.closingBracketRange)continue;const f=l&&u.range.equalsRange(l);if(!f&&!n.includeInactive)continue;const g=d.getInlineClassName(u.nestingLevel,u.nestingLevelOfEqualBracketType,c)+(n.highlightActive&&f?" "+d.activeClassName:""),m=u.openingBracketRange.getStartPosition(),p=u.closingBracketRange.getStartPosition(),v=n.horizontalGuides===u_.Enabled||n.horizontalGuides===u_.EnabledForActive&&f;if(u.range.startLineNumber===u.range.endLineNumber){v&&o[u.range.startLineNumber-e].push(new Yp(-1,u.openingBracketRange.getEndPosition().column,g,new jS(!1,p.column),-1,-1));continue}const b=this.getVisibleColumnFromPosition(p),w=this.getVisibleColumnFromPosition(u.openingBracketRange.getStartPosition()),C=Math.min(w,b,u.minVisibleColumnIndentation+1);let y=!1;Jo(this.textModel.getLineContent(u.closingBracketRange.startLineNumber))<u.closingBracketRange.startColumn-1&&(y=!0);const L=Math.max(m.lineNumber,e),E=Math.min(p.lineNumber,t),M=y?1:0;for(let R=L;R<E+M;R++)o[R-e].push(new Yp(C,-1,g,null,R===m.lineNumber?m.column:-1,R===p.lineNumber?p.column:-1));v&&(m.lineNumber>=e&&w>C&&o[m.lineNumber-e].push(new Yp(C,-1,g,new jS(!1,m.column),-1,-1)),p.lineNumber<=t&&b>C&&o[p.lineNumber-e].push(new Yp(C,-1,g,new jS(!y,p.column),-1,-1)))}for(const u of o)u.sort((f,g)=>f.visibleColumn-g.visibleColumn);return o}getVisibleColumnFromPosition(e){return Ln.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(o&&o.offSide),a=new Array(t-e+1);let l=-2,c=-1,d=-2,h=-1;for(let u=e;u<=t;u++){const f=u-e,g=this._computeIndentLevel(u-1);if(g>=0){l=u-1,c=g,a[f]=Math.ceil(g/n.indentSize);continue}if(l===-2){l=-1,c=-1;for(let m=u-2;m>=0;m--){const p=this._computeIndentLevel(m);if(p>=0){l=m,c=p;break}}}if(d!==-1&&(d===-2||d<u-1)){d=-1,h=-1;for(let m=u;m<i;m++){const p=this._computeIndentLevel(m);if(p>=0){d=m,h=p;break}}}a[f]=this._getIndentLevelForWhitespaceLine(r,c,h)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class hae{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class v4e extends Nm{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(166),n=t.get(59);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(22),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(166),n=t.get(59);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(22),!0}onCursorStateChanged(e){var n;const i=e.selections[0].getPosition();return(n=this._primaryPosition)!=null&&n.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var l,c;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,o=this._primaryPosition,r=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),o),a=[];for(let d=t;d<=i;d++){const h=d-t,u=r[h];let f="";const g=((l=e.visibleRangeForPosition(new z(d,1)))==null?void 0:l.left)??0;for(const m of u){const p=m.column===-1?g+(m.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new z(d,m.column)).left;if(p>n||this._maxIndentLeft>0&&p>this._maxIndentLeft)break;const v=m.horizontalLine?m.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",b=m.horizontalLine?(((c=e.visibleRangeForPosition(new z(d,m.horizontalLine.endColumn)))==null?void 0:c.left)??p+this._spaceWidth)-p:this._spaceWidth;f+=`<div class="core-guide ${m.className} ${v}" style="left:${p}px;width:${b}px"></div>`}a[h]=f}this._renderResult=a}getGuidesByLine(e,t,i){const n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?u_.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?u_.EnabledForActive:u_.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let r=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const h=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);r=h.startLineNumber,a=h.endLineNumber,l=h.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),d=[];for(let h=e;h<=t;h++){const u=new Array;d.push(u);const f=n?n[h-e]:[],g=new ff(f),m=o?o[h-e]:0;for(let p=1;p<=m;p++){const v=(p-1)*c+1,b=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||f.length===0)&&r<=h&&h<=a&&p===l;u.push(...g.takeWhile(C=>C.visibleColumn<v)||[]);const w=g.peek();(!w||w.visibleColumn!==v||w.horizontalLine)&&u.push(new Yp(v,-1,`core-guide-indent lvl-${(p-1)%30}`+(b?" indent-active":""),null,-1,-1))}u.push(...g.takeWhile(p=>!0)||[])}return d}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function $v(s){if(!(s&&s.isTransparent()))return s}Ul((s,e)=>{const t=[{bracketColor:eae,guideColor:jOe,guideColorActive:QOe},{bracketColor:tae,guideColor:KOe,guideColorActive:JOe},{bracketColor:iae,guideColor:GOe,guideColorActive:e4e},{bracketColor:nae,guideColor:YOe,guideColorActive:t4e},{bracketColor:sae,guideColor:XOe,guideColorActive:i4e},{bracketColor:oae,guideColor:ZOe,guideColorActive:n4e}],i=new hae,n=[{indentColor:Ck,indentColorActive:wk},{indentColor:xOe,indentColorActive:DOe},{indentColor:LOe,indentColorActive:TOe},{indentColor:IOe,indentColorActive:NOe},{indentColor:EOe,indentColorActive:ROe},{indentColor:kOe,indentColorActive:MOe}],o=t.map(a=>{const l=s.getColor(a.bracketColor),c=s.getColor(a.guideColor),d=s.getColor(a.guideColorActive),h=$v($v(c)??(l==null?void 0:l.transparent(.3))),u=$v($v(d)??l);if(!(!h||!u))return{guideColor:h,guideColorActive:u}}).filter($s),r=n.map(a=>{const l=s.getColor(a.indentColor),c=s.getColor(a.indentColorActive),d=$v(l),h=$v(c);if(!(!d||!h))return{indentColor:d,indentColorActive:h}}).filter($s);if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});const vA=class vA extends Nm{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new z(1,1),this._renderResult=null,this._activeModelLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(75);const t=e.get(76);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(109);const i=e.get(165);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeModelLineNumber!==this._lastCursorModelPosition.lineNumber&&(this._activeModelLineNumber=this._lastCursorModelPosition.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);const n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=Hr?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(c=>!!c.options.lineNumberClassName);o.sort((c,d)=>D.compareRangesUsingEnds(c.range,d.range));let r=0;const a=this._context.viewModel.getLineCount(),l=[];for(let c=i;c<=n;c++){const d=c-i,h=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(c,1)).lineNumber;let u=this._getLineRenderLineNumber(c),f="";for(;r<o.length&&o[r].range.endLineNumber<c;)r++;for(let g=r;g<o.length;g++){const{range:m,options:p}=o[g];m.startLineNumber<=c&&(f+=" "+p.lineNumberClassName)}if(!u&&!f){l[d]="";continue}c===a&&this._context.viewModel.getLineLength(c)===0&&(this._renderFinalNewline==="off"&&(u=""),this._renderFinalNewline==="dimmed"&&(f+=" dimmed-line-number")),h===this._activeModelLineNumber&&(f+=" active-line-number"),l[d]=`<div class="${vA.CLASS_NAME}${t}${f}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${u}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};vA.CLASS_NAME="line-numbers";let IR=vA;Ul((s,e)=>{const t=s.getColor(wOe),i=s.getColor(POe);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});const w1="monaco-mouse-cursor-text";class Z5{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class ER{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(59);this.renderWhitespace=i.get(113),this.experimentalWhitespaceRendering=i.get(47),this.renderControlCharacters=i.get(108),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(40),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(75),this.stopRenderingLineAfter=i.get(133),this.fontLigatures=i.get(60),this.verticalScrollbarSize=i.get(117).verticalScrollbarSize,this.useGpu=i.get(46)==="on"}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.experimentalWhitespaceRendering===e.experimentalWhitespaceRendering&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures&&this.verticalScrollbarSize===e.verticalScrollbarSize&&this.useGpu===e.useGpu}}class C4e{constructor(){this._currentVisibleRange=new D(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class w4e{constructor(e,t,i,n,o,r,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=o,this.stopScrollTop=r,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class y4e{constructor(e,t,i,n,o){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=o,this.type="selections";let r=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const d=t[l];r=Math.min(r,d.startLineNumber),a=Math.max(a,d.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=a}}const CA=class CA extends yr{constructor(e,t,i){super(e);const n=this._context.configuration,o=this._context.configuration.options,r=o.get(59),a=o.get(166);this._lineHeight=o.get(75),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=a.isViewportWrapping,this._revealHorizontalRightPadding=o.get(114),this._cursorSurroundingLines=o.get(35),this._cursorSurroundingLinesStyle=o.get(36),this._canUseLayerHinting=!o.get(39),this._viewLineOptions=new ER(n,this._context.theme.type),this._linesContent=i,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new jre(this._context,{createLine:()=>new Lu(t,this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,dd.write(this.domNode,8),this.domNode.setClassName(`view-lines ${w1}`),js(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Ni(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Ni(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new C4e,this._horizontalRevealRequest=null,this._stickyScrollEnabled=o.get(131).enabled,this._maxNumberStickyLines=o.get(131).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(166)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(59),n=t.get(166);return this._lineHeight=t.get(75),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(114),this._cursorSurroundingLines=t.get(35),this._cursorSurroundingLinesStyle=t.get(36),this._canUseLayerHinting=!t.get(39),this._stickyScrollEnabled=t.get(131).enabled,this._maxNumberStickyLines=t.get(131).maxLineCount,js(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(165)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new ER(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let o=t;o<=i;o++)n=this._visibleLines.getVisibleLine(o).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e,this._viewLineOptions.useGpu);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new w4e(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new y4e(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,o),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new z(n,1);const o=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();if(n<o||n>r)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new z(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Lu.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){const o=this._visibleLines.getVisibleLine(n);if(e===o.getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const n=new Z5(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=D.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;const o=[];let r=0;const a=new Z5(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(n.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber();for(let h=n.startLineNumber;h<=n.endLineNumber;h++){if(h<c||h>d)continue;const u=h===n.startLineNumber?n.startColumn:1,f=h!==i,g=f?this._context.viewModel.getLineMaxColumn(h):n.endColumn,p=this._visibleLines.getVisibleLine(h).getVisibleRangesForRange(h,u,g,a);if(p){if(t&&h<i){const v=l;if(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(h+1,1)).lineNumber,v!==l){const b=p.ranges[p.ranges.length-1];b.width+=this._typicalHalfwidthCharacterWidth,this._context.viewModel.getTextDirection(v)===qa.RTL&&(b.left-=this._typicalHalfwidthCharacterWidth)}}o[r++]=new Rre(p.outsideRenderedLine,h,bk.from(p.ranges),f)}}return this._updateLineWidthsSlowIfDomDidLayout(a),r===0?null:o}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const n=new Z5(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),o}_lineIsRenderedRTL(e){return e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber()?!1:this._visibleLines.getVisibleLine(e).isRenderedRTL()}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new Mre(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,o=!0;for(let r=t;r<=i;r++){const a=this._visibleLines.getVisibleLine(r);if(e&&!a.getWidthIsFast()){o=!1;continue}n=Math.max(n,a.getWidth(null))}return o&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),o}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++){const r=this._visibleLines.getVisibleLine(o);if(r.needsMonospaceFontCheck()){const a=r.getWidth(null);a>t&&(t=a,e=o)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let o=i;o<=n;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const n=this._computeScrollLeftToReveal(i);n&&(!this._isViewportWrapping&&!n.hasRTL&&this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Hr&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,o,r){const a=e.top,l=e.height,c=a+l;let d,h,u;if(o&&o.length>0){let v=o[0].startLineNumber,b=o[0].endLineNumber;for(let w=1,C=o.length;w<C;w++){const y=o[w];v=Math.min(v,y.startLineNumber),b=Math.max(b,y.endLineNumber)}d=!1,h=this._context.viewLayout.getVerticalOffsetForLineNumber(v),u=this._context.viewLayout.getVerticalOffsetForLineNumber(b)+this._lineHeight}else if(n)d=!0,h=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;const f=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let g=0,m=0;if(f)i||(g=this._lineHeight);else{const v=l/this._lineHeight,b=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),w=Math.min(v/2,b);g=w*this._lineHeight,m=Math.max(0,w-1)*this._lineHeight}i||(r===0||r===4)&&(m+=this._lineHeight),h-=g,u+=m;let p;if(u-h>l){if(!d)return-1;p=h}else if(r===5||r===6)if(r===6&&a<=h&&u<=c)p=a;else{const v=Math.max(5*this._lineHeight,l*.2),b=h-v,w=u-l;p=Math.max(w,b)}else if(r===1||r===2)if(r===2&&a<=h&&u<=c)p=a;else{const v=(h+u)/2;p=Math.max(0,v-l/2)}else p=this._computeMinimumScrolling(a,c,h,u,r===3,r===4);return p}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(165),n=t.left,o=n+t.width-i.verticalScrollbarWidth;let r=1073741824,a=0,l=!1;if(e.type==="range"){l=this._lineIsRenderedRTL(e.lineNumber);const d=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!d)return null;for(const h of d.ranges)r=Math.min(r,Math.round(h.left)),a=Math.max(a,Math.round(h.left+h.width))}else for(const d of e.selections){if(d.startLineNumber!==d.endLineNumber)return null;const h=this._visibleRangesForLineRange(d.startLineNumber,d.startColumn,d.endColumn);if(l||(l=this._lineIsRenderedRTL(d.startLineNumber)),!h)return null;for(const u of h.ranges)r=Math.min(r,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(r=Math.max(0,r-CA.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-r>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,o,r,a),maxHorizontalOffset:a,hasRTL:l}}_computeMinimumScrolling(e,t,i,n,o,r){e=e|0,t=t|0,i=i|0,n=n|0,o=!!o,r=!!r;const a=t-e;if(n-i<a){if(o)return i;if(r)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}};CA.HORIZONTAL_EXTRA_PX=30;let IB=CA;class S4e extends aae{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(165);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[n++]=new LB(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,c));const d=a.options.firstLineDecorationClassName;d&&(i[n++]=new LB(a.range.startLineNumber,a.range.startLineNumber,d,a.options.linesDecorationsTooltip??null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=this._decorationsLeft.toString(),r=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+r+'px;"></div>',l=[];for(let c=t;c<=i;c++){const d=c-t,h=n[d].getDecorations();let u="";for(const f of h){let g='<div class="cldr '+f.className;f.tooltip!==null&&(g+='" title="'+f.tooltip),g+=a,u+=g}l[d]=u}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const JC=class JC extends yr{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._canUseLayerHinting=!t.get(39),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=gi(document.createElement("div")),this._domNode.setClassName(JC.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=gi(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(JC.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._canUseLayerHinting=!t.get(39),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};JC.CLASS_NAME="glyph-margin",JC.OUTER_CLASS_NAME="margin";let kR=JC;class x4e extends aae{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[n++]=new LB(a.range.startLineNumber,a.range.endLineNumber,l,null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=[];for(let r=t;r<=i;r++){const a=r-t,l=n[a].getDecorations();let c="";for(const d of l)c+='<div class="cmdr '+d.className+'" style=""></div>';o[a]=c}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const Qf=class Qf{constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=Qf._clamp(e),this.g=Qf._clamp(t),this.b=Qf._clamp(i),this.a=Qf._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};Qf.Empty=new Qf(0,0,0,0);let Qu=Qf,L4e=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Ve(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var n;(n=this._factories.get(e))==null||n.dispose();const i=new I4e(this,e,t);return this._factories.set(e,i),Ve(()=>{const o=this._factories.get(e);!o||o!==i||(this._factories.delete(e),o.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class I4e extends K{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}let HL=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class w${constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class i4{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var ea;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(ea||(ea={}));var Tw;(function(s){const e=new Map;e.set(0,ge.symbolMethod),e.set(1,ge.symbolFunction),e.set(2,ge.symbolConstructor),e.set(3,ge.symbolField),e.set(4,ge.symbolVariable),e.set(5,ge.symbolClass),e.set(6,ge.symbolStruct),e.set(7,ge.symbolInterface),e.set(8,ge.symbolModule),e.set(9,ge.symbolProperty),e.set(10,ge.symbolEvent),e.set(11,ge.symbolOperator),e.set(12,ge.symbolUnit),e.set(13,ge.symbolValue),e.set(15,ge.symbolEnum),e.set(14,ge.symbolConstant),e.set(15,ge.symbolEnum),e.set(16,ge.symbolEnumMember),e.set(17,ge.symbolKeyword),e.set(28,ge.symbolSnippet),e.set(18,ge.symbolText),e.set(19,ge.symbolColor),e.set(20,ge.symbolFile),e.set(21,ge.symbolReference),e.set(22,ge.symbolCustomColor),e.set(23,ge.symbolFolder),e.set(24,ge.symbolTypeParameter),e.set(25,ge.account),e.set(26,ge.issues),e.set(27,ge.tools);function t(r){let a=e.get(r);return a||(console.info("No codicon found for CompletionItemKind "+r),a=ge.symbolProperty),a}s.toIcon=t;function i(r){switch(r){case 0:return _(728,"Method");case 1:return _(729,"Function");case 2:return _(730,"Constructor");case 3:return _(731,"Field");case 4:return _(732,"Variable");case 5:return _(733,"Class");case 6:return _(734,"Struct");case 7:return _(735,"Interface");case 8:return _(736,"Module");case 9:return _(737,"Property");case 10:return _(738,"Event");case 11:return _(739,"Operator");case 12:return _(740,"Unit");case 13:return _(741,"Value");case 14:return _(742,"Constant");case 15:return _(743,"Enum");case 16:return _(744,"Enum Member");case 17:return _(745,"Keyword");case 18:return _(746,"Text");case 19:return _(747,"Color");case 20:return _(748,"File");case 21:return _(749,"Reference");case 22:return _(750,"Custom Color");case 23:return _(751,"Folder");case 24:return _(752,"Type Parameter");case 25:return _(753,"User");case 26:return _(754,"Issue");case 27:return _(755,"Tool");case 28:return _(756,"Snippet");default:return""}}s.toLabel=i;const n=new Map;n.set("method",0),n.set("function",1),n.set("constructor",2),n.set("field",3),n.set("variable",4),n.set("class",5),n.set("struct",6),n.set("interface",7),n.set("module",8),n.set("property",9),n.set("event",10),n.set("operator",11),n.set("unit",12),n.set("value",13),n.set("constant",14),n.set("enum",15),n.set("enum-member",16),n.set("enumMember",16),n.set("keyword",17),n.set("snippet",28),n.set("text",18),n.set("color",19),n.set("file",20),n.set("reference",21),n.set("customcolor",22),n.set("folder",23),n.set("type-parameter",24),n.set("typeParameter",24),n.set("account",25),n.set("issue",26),n.set("tool",27);function o(r,a){let l=n.get(r);return typeof l>"u"&&!a&&(l=9),l}s.fromString=o})(Tw||(Tw={}));var Tr;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(Tr||(Tr={}));class uae{constructor(e,t,i,n){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=n}equals(e){return D.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var EB;(function(s){s[s.Code=1]="Code",s[s.Label=2]="Label"})(EB||(EB={}));class n4{static fromExtensionId(e){return new n4(e,void 0,void 0)}constructor(e,t,i){this.extensionId=e,this.extensionVersion=t,this.providerId=i}toString(){let e="";return this.extensionId&&(e+=this.extensionId),this.extensionVersion&&(e+=`@${this.extensionVersion}`),this.providerId&&(e+=`:${this.providerId}`),e.length===0&&(e="unknown"),e}toStringWithoutVersion(){let e="";return this.extensionId&&(e+=this.extensionId),this.providerId&&(e+=`:${this.providerId}`),e}}var Fb;(function(s){s[s.Accepted=0]="Accepted",s[s.Rejected=1]="Rejected",s[s.Ignored=2]="Ignored"})(Fb||(Fb={}));var VL;(function(s){s[s.Automatic=0]="Automatic",s[s.PasteAs=1]="PasteAs"})(VL||(VL={}));var ph;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(ph||(ph={}));var Nw;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(Nw||(Nw={}));function E4e(s){return!!s&&Ze.isUri(s.uri)&&D.isIRange(s.range)&&(D.isIRange(s.originSelectionRange)||D.isIRange(s.targetSelectionRange))}const k4e={17:_(757,"array"),16:_(758,"boolean"),4:_(759,"class"),13:_(760,"constant"),8:_(761,"constructor"),9:_(762,"enumeration"),21:_(763,"enumeration member"),23:_(764,"event"),7:_(765,"field"),0:_(766,"file"),11:_(767,"function"),10:_(768,"interface"),19:_(769,"key"),5:_(770,"method"),1:_(771,"module"),2:_(772,"namespace"),20:_(773,"null"),15:_(774,"number"),18:_(775,"object"),24:_(776,"operator"),3:_(777,"package"),6:_(778,"property"),14:_(779,"string"),22:_(780,"struct"),25:_(781,"type parameter"),12:_(782,"variable")};function D4e(s,e){return _(783,"{0} ({1})",s,k4e[e])}var DR;(function(s){const e=new Map;e.set(0,ge.symbolFile),e.set(1,ge.symbolModule),e.set(2,ge.symbolNamespace),e.set(3,ge.symbolPackage),e.set(4,ge.symbolClass),e.set(5,ge.symbolMethod),e.set(6,ge.symbolProperty),e.set(7,ge.symbolField),e.set(8,ge.symbolConstructor),e.set(9,ge.symbolEnum),e.set(10,ge.symbolInterface),e.set(11,ge.symbolFunction),e.set(12,ge.symbolVariable),e.set(13,ge.symbolConstant),e.set(14,ge.symbolString),e.set(15,ge.symbolNumber),e.set(16,ge.symbolBoolean),e.set(17,ge.symbolArray),e.set(18,ge.symbolObject),e.set(19,ge.symbolKey),e.set(20,ge.symbolNull),e.set(21,ge.symbolEnumMember),e.set(22,ge.symbolStruct),e.set(23,ge.symbolEvent),e.set(24,ge.symbolOperator),e.set(25,ge.symbolTypeParameter);function t(o){let r=e.get(o);return r||(console.info("No codicon found for SymbolKind "+o),r=ge.symbolProperty),r}s.toIcon=t;const i=new Map;i.set(0,20),i.set(1,8),i.set(2,8),i.set(3,8),i.set(4,5),i.set(5,0),i.set(6,9),i.set(7,3),i.set(8,2),i.set(9,15),i.set(10,7),i.set(11,1),i.set(12,4),i.set(13,14),i.set(14,18),i.set(15,13),i.set(16,13),i.set(17,13),i.set(18,13),i.set(19,17),i.set(20,13),i.set(21,16),i.set(22,6),i.set(23,10),i.set(24,11),i.set(25,24);function n(o){let r=i.get(o);return r===void 0&&(console.info("No completion kind found for SymbolKind "+o),r=20),r}s.toCompletionKind=n})(DR||(DR={}));var Qr;let yv=(Qr=class{static fromValue(e){switch(e){case"comment":return Qr.Comment;case"imports":return Qr.Imports;case"region":return Qr.Region}return new Qr(e)}constructor(e){this.value=e}},Qr.Comment=new Qr("comment"),Qr.Imports=new Qr("imports"),Qr.Region=new Qr("region"),Qr);var kB;(function(s){s[s.AIGenerated=1]="AIGenerated"})(kB||(kB={}));var zL;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(zL||(zL={}));var DB;(function(s){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}s.is=e})(DB||(DB={}));var TR;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(TR||(TR={}));class T4e{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const An=new L4e,wA=class wA extends K{static getInstance(){return this._INSTANCE||(this._INSTANCE=new wA),this._INSTANCE}constructor(){super(),this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(An.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=An.getColorMap();if(!e){this._colors=[Qu.Empty],this._backgroundIsLight=!0;return}this._colors=[Qu.Empty];for(let i=1;i<e.length;i++){const n=e[i].rgba;this._colors[i]=new Qu(n.r,n.g,n.b,Math.round(n.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};wA._INSTANCE=null;let NR=wA;const N4e=(()=>{const s=[];for(let e=32;e<=126;e++)s.push(e);return s.push(65533),s})(),R4e=(s,e)=>(s-=32,s<0||s>96?e<=2?(s+96)%96:95:s);class UL{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=UL.soften(e,12/15),this.charDataLight=UL.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=iR(e[n]*t);return i}renderChar(e,t,i,n,o,r,a,l,c,d,h){const u=1*this.scale,f=2*this.scale,g=h?1:f;if(t+u>e.width||i+g>e.height){console.warn("bad render request outside image data");return}const m=d?this.charDataLight:this.charDataNormal,p=R4e(n,c),v=e.width*4,b=a.r,w=a.g,C=a.b,y=o.r-b,x=o.g-w,S=o.b-C,L=Math.max(r,l),E=e.data;let M=p*u*f,R=i*v+t*4;for(let T=0;T<g;T++){let A=R;for(let N=0;N<u;N++){const P=m[M++]/255*(r/255);E[A++]=b+y*P,E[A++]=w+x*P,E[A++]=C+S*P,E[A++]=L}R+=v}}blockRenderChar(e,t,i,n,o,r,a,l){const c=1*this.scale,d=2*this.scale,h=l?1:d;if(t+c>e.width||i+h>e.height){console.warn("bad render request outside image data");return}const u=e.width*4,f=.5*(o/255),g=r.r,m=r.g,p=r.b,v=n.r-g,b=n.g-m,w=n.b-p,C=g+v*f,y=m+b*f,x=p+w*f,S=Math.max(o,a),L=e.data;let E=i*u+t*4;for(let M=0;M<h;M++){let R=E;for(let T=0;T<c;T++)L[R++]=C,L[R++]=y,L[R++]=x,L[R++]=S;E+=u}}}const iX={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},nX=s=>{const e=new Uint8ClampedArray(s.length/2);for(let t=0;t<s.length;t+=2)e[t>>1]=iX[s[t]]<<4|iX[s[t+1]]&15;return e},sX={1:Tb(()=>nX("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:Tb(()=>nX("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class KS{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return sX[e]?i=new UL(sX[e](),e):i=KS.createFromSampleData(KS.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=960,t.style.width="960px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const o of N4e)i.fillText(String.fromCharCode(o),n,16/2),n+=10;return i.getImageData(0,0,960,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const n=KS._downsample(e,t);return new UL(n,t)}static _downsampleChar(e,t,i,n,o){const r=1*o,a=2*o;let l=n,c=0;for(let d=0;d<a;d++){const h=d/a*16,u=(d+1)/a*16;for(let f=0;f<r;f++){const g=f/r*10,m=(f+1)/r*10;let p=0,v=0;for(let w=h;w<u;w++){const C=t+Math.floor(w)*3840,y=1-(w-Math.floor(w));for(let x=g;x<m;x++){const S=1-(x-Math.floor(x)),L=C+Math.floor(x)*4,E=S*y;v+=E,p+=e[L]*e[L+3]/255*E}}const b=p/v;c=Math.max(c,b),i[l++]=iR(b)}}return c}static _downsample(e,t){const i=2*t*1*t,n=i*96,o=new Uint8ClampedArray(n);let r=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,o,r,t)),r+=i,a+=40;if(l>0){const c=255/l;for(let d=0;d<n;d++)o[d]*=c}return o}}const M4e=no?'"Segoe WPC", "Segoe UI", sans-serif':Bt?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif';class fae{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}function y$(s,e){return!(e.options.hideInCommentTokens&&S$(s,e)||e.options.hideInStringTokens&&x$(s,e))}function S$(s,e){return gae(s,e.range,t=>t===1)}function x$(s,e){return gae(s,e.range,t=>t===2)}function gae(s,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const n=s.tokenization.getLineTokens(i),o=i===e.startLineNumber,r=i===e.endLineNumber;let a=o?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(r&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}const A4e=140,P4e=2;class y1{constructor(e,t,i){const n=e.options,o=n.get(163),r=n.get(165),a=r.minimap,l=n.get(59),c=n.get(81);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(119),this.paddingTop=n.get(96).top,this.paddingBottom=n.get(96).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(75),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=r.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=r.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=M4e,this.sectionHeaderFontSize=c.sectionHeaderFontSize*o,this.sectionHeaderLetterSpacing=c.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=y1._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=Tb(()=>KS.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=y1._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=y1._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(sAe);return i?new Qu(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(oAe);return t?Qu._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){const i=e.getColor(Ph);return i?new Qu(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class GS{constructor(e,t,i,n,o,r,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=o,this.sliderHeight=r,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,o,r,a,l,c,d,h){const u=e.pixelRatio,f=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/f),m=e.lineHeight;if(e.minimapHeightIsEditorHeight){let x=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(x+=Math.max(0,o-e.lineHeight-e.paddingBottom));const S=Math.max(1,Math.floor(o*o/x)),L=Math.max(0,e.minimapHeight-S),E=L/(d-o),M=c*E,R=L>0,T=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),A=Math.floor(e.paddingTop/e.lineHeight);return new GS(c,d,R,E,M,S,A,1,Math.min(a,T))}let p;if(r&&i!==a){const x=i-t+1;p=Math.floor(x*f/u)}else{const x=o/m;p=Math.floor(x*f/u)}const v=Math.floor(e.paddingTop/m);let b=Math.floor(e.paddingBottom/m);if(e.scrollBeyondLastLine){const x=o/m;b=Math.max(b,x-1)}let w;if(b>0){const x=o/m;w=(v+a+b-x-1)*f/u}else w=Math.max(0,(v+a)*f/u-p);w=Math.min(e.minimapHeight-p,w);const C=w/(d-o),y=c*C;if(g>=v+a+b){const x=w>0;return new GS(c,d,x,C,y,p,v,1,a)}else{let x;t>1?x=t+v:x=Math.max(1,c/m);let S,L=Math.max(1,Math.floor(x-y*u/f));L<v?(S=v-L+1,L=1):(S=0,L=Math.max(1,L-v)),h&&h.scrollHeight===d&&(h.scrollTop>c&&(L=Math.min(L,h.startLineNumber),S=Math.max(S,h.topPaddingLineCount)),h.scrollTop<c&&(L=Math.max(L,h.startLineNumber),S=Math.min(S,h.topPaddingLineCount)));const E=Math.min(a,L-S+g-1),M=(c-n)/m;let R;return c>=e.paddingTop?R=(t-L+S+M)*f/u:R=c/e.paddingTop*(S+M)*f/u,new GS(c,d,!0,C,R,p,S,L,E)}}}const yA=class yA{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}};yA.INVALID=new yA(-1);let RR=yA;class oX{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new qre({createLine:()=>RR.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let n=0,o=i.length;n<o;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class L${constructor(e,t,i,n){this._backgroundFillData=L$._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,o=i.g,r=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let d=0;d<t;d++)for(let h=0;h<e;h++)l[c]=n,l[c+1]=o,l[c+2]=r,l[c+3]=a,c+=4;return l}}class $L{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:n}=b1.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),o=t/n,r=o/2;if(!i||i.minimapLines.length===0){const p=[];if(p[0]=1,n>1){for(let v=0,b=n-1;v<b;v++)p[v]=Math.round(v*o+r);p[n-1]=t}return[new $L(o,p),[]]}const a=i.minimapLines,l=a.length,c=[];let d=0,h=0,u=1;const f=10;let g=[],m=null;for(let p=0;p<n;p++){const v=Math.max(u,Math.round(p*o)),b=Math.max(v,Math.round((p+1)*o));for(;d<l&&a[d]<v;){if(g.length<f){const C=d+1+h;m&&m.type==="deleted"&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:C,deleteToLineNumber:C},g.push(m)),h--}d++}let w;if(d<l&&a[d]<=b)w=a[d],d++;else if(p===0?w=1:p+1===n?w=t:w=Math.round(p*o+r),g.length<f){const C=d+1+h;m&&m.type==="inserted"&&m._i===p-1?m.insertToLineNumber++:(m={type:"inserted",_i:p,insertFromLineNumber:C,insertToLineNumber:C},g.push(m)),h++}c[p]=w,u=w}if(g.length<f)for(;d<l;){const p=d+1+h;m&&m.type==="deleted"&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:p,deleteToLineNumber:p},g.push(m)),h--,d++}else g=[{type:"flush"}];return[new $L(o,c),g]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const o=this.minimapLines[i];if(o<e||o>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<e.fromLineNumber);o--)this.minimapLines[o]<=e.toLineNumber?(this.minimapLines[o]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,o),n=Math.max(n,o)):this.minimapLines[o]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class O4e extends yr{constructor(e){super(e),this._sectionHeaderCache=new Cc(10,1.5),this.tokensColorTracker=NR.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new y1(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=$L.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new TC(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new y1(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged(e)}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=$L.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let o=0,r=t-e+1;o<r;o++)i[o]?n[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+o-1]):n[o]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Oe(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){return this._getMinimapDecorationsInViewport(e,t).filter(i=>{var n;return!((n=i.options.minimap)!=null&&n.sectionHeaderStyle)})}getSectionHeaderDecorationsInViewport(e,t){const i=this.options.sectionHeaderFontSize/this.options.minimapLineHeight;return e=Math.floor(Math.max(1,e-i)),this._getMinimapDecorationsInViewport(e,t).filter(n=>{var o;return!!((o=n.options.minimap)!=null&&o.sectionHeaderStyle)})}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const o=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];i=new D(o,1,r,this._context.viewModel.getLineMaxColumn(r))}else i=new D(e,1,t,this._context.viewModel.getLineMaxColumn(t));const n=this._context.viewModel.getMinimapDecorationsInRange(i);if(this._samplingState){const o=[];for(const r of n){if(!r.options.minimap)continue;const a=r.range,l=this._samplingState.modelLineToMinimapLine(a.startLineNumber),c=this._samplingState.modelLineToMinimapLine(a.endLineNumber);o.push(new fae(new D(l,a.startColumn,c,a.endColumn),r.options))}return o}return n}getSectionHeaderText(e,t){var r;const i=(r=e.options.minimap)==null?void 0:r.sectionHeaderText;if(!i)return null;const n=this._sectionHeaderCache.get(i);if(n)return n;const o=t(i);return this._sectionHeaderCache.set(i,o),o}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new D(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class TC extends K{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._isMouseOverMinimap=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(KY),this._domNode=gi(document.createElement("div")),dd.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=gi(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=gi(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=gi(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=gi(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=gi(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._hideDelayedScheduler=this._register(new Ni(()=>this._hideImmediatelyIfMouseIsOutside(),500)),this._register(Jn(this._domNode.domNode,ye.MOUSE_OVER,()=>{this._isMouseOverMinimap=!0})),this._register(Jn(this._domNode.domNode,ye.MOUSE_LEAVE,()=>{this._isMouseOverMinimap=!1})),this._pointerDownListener=Jn(this._domNode.domNode,ye.POINTER_DOWN,i=>{i.preventDefault();const n=i.pointerType==="mouse",o=i.button===0;if(this._model.options.renderMinimap!==0&&this._lastRenderData){if(this._model.options.size!=="proportional"){if(o&&this._lastRenderData){const a=Fn(this._slider.domNode),l=a.top+a.height/2;this._startSliderDragging(i,l,this._lastRenderData.renderedLayout)}return}if(o||!n){const a=this._model.options.minimapLineHeight,l=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let d=Math.floor(l/a)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;d=Math.min(d,this._model.getLineCount()),this._model.revealLineNumber(d)}}}),this._sliderPointerMoveMonitor=new l0,this._sliderPointerDownListener=Jn(this._slider.domNode,ye.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Oo.addTarget(this._domNode.domNode),this._sliderTouchStartListener=ee(this._domNode.domNode,Qi.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=ee(this._domNode.domNode,Qi.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=Jn(this._domNode.domNode,Qi.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_hideSoon(){this._hideDelayedScheduler.cancel(),this._hideDelayedScheduler.schedule()}_hideImmediatelyIfMouseIsOutside(){if(this._isMouseOverMinimap){this._hideSoon();return}this._domNode.toggleClassName("active",!1)}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const n=e.pageX;this._slider.toggleClassName("active",!0);const o=(r,a)=>{const l=Fn(this._domNode.domNode),c=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(no&&c>A4e){this._model.setScrollTop(i.scrollTop);return}const d=r-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(d))};e.pageY!==t&&o(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>o(r.pageY,r.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide==="mouseover"?e.push("minimap-autohide-mouseover"):this._model.options.autohide==="scroll"&&e.push("minimap-autohide-scroll"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new L$(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesDeleted(e,t),!0}onLinesInserted(e,t){var i;return(i=this._lastRenderData)==null||i.onLinesInserted(e,t),!0}onScrollChanged(e){return this._model.options.autohide==="scroll"&&(e.scrollTopChanged||e.scrollHeightChanged)&&(this._domNode.toggleClassName("active",!0),this._hideSoon()),this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(KY),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=GS.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(D.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((u,f)=>(u.options.zIndex||0)-(f.options.zIndex||0));const{canvasInnerWidth:n,canvasInnerHeight:o}=this._model.options,r=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,n,o);const d=new rX(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,d,e,r),this._renderDecorationsLineHighlights(c,i,d,e,r);const h=new rX(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,h,e,r,l,a,n),this._renderDecorationsHighlights(c,i,h,e,r,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let r=0,a=0;for(const l of t){const c=n.intersectWithViewport(l);if(!c)continue;const[d,h]=c;for(let g=d;g<=h;g++)i.set(g,!0);const u=n.getYForLineNumber(d,o),f=n.getYForLineNumber(h,o);a>=u||(a>r&&e.fillRect(Md,r,e.canvas.width,a-r),r=u),a=f}a>r&&e.fillRect(Md,r,e.canvas.width,a-r)}_renderDecorationsLineHighlights(e,t,i,n,o){const r=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==1)continue;const d=n.intersectWithViewport(l.range);if(!d)continue;const[h,u]=d,f=c.getColor(this._theme.value);if(!f||f.isTransparent())continue;let g=r.get(f.toString());g||(g=f.transparent(.5).toString(),r.set(f.toString(),g)),e.fillStyle=g;for(let m=h;m<=u;m++){if(i.has(m))continue;i.set(m,!0);const p=n.getYForLineNumber(h,o);e.fillRect(Md,p,e.canvas.width,o)}}}_renderSelectionsHighlights(e,t,i,n,o,r,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const d=n.intersectWithViewport(c);if(!d)continue;const[h,u]=d;for(let f=h;f<=u;f++)this.renderDecorationOnLine(e,i,c,this._selectionColor,n,f,o,o,r,a,l)}}_renderDecorationsHighlights(e,t,i,n,o,r,a,l){for(const c of t){const d=c.options.minimap;if(!d)continue;const h=n.intersectWithViewport(c.range);if(!h)continue;const[u,f]=h,g=d.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let m=u;m<=f;m++)switch(d.position){case 1:this.renderDecorationOnLine(e,i,c.range,g,n,m,o,o,r,a,l);continue;case 2:{const p=n.getYForLineNumber(m,o);this.renderDecoration(e,g,2,p,P4e,o);continue}}}}renderDecorationOnLine(e,t,i,n,o,r,a,l,c,d,h){const u=o.getYForLineNumber(r,l);if(u+a<0||u>this._model.options.canvasInnerHeight)return;const{startLineNumber:f,endLineNumber:g}=i,m=f===r?i.startColumn:1,p=g===r?i.endColumn:this._model.getLineMaxColumn(r),v=this.getXOffsetForPosition(t,r,m,c,d,h),b=this.getXOffsetForPosition(t,r,p,c,d,h);this.renderDecoration(e,n,v,u,b-v,a)}getXOffsetForPosition(e,t,i,n,o,r){if(i===1)return Md;if((i-1)*o>=r)return r;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Md];let d=Md;for(let h=1;h<c.length+1;h++){const u=c.charCodeAt(h-1),f=u===9?n*o:hf(u)?2*o:o,g=d+f;if(g>=r){l[h]=r;break}l[h]=g,d=g}e.set(t,l)}return i-1<l.length?l[i-1]:r}renderDecoration(e,t,i,n,o,r){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,o,r)}_renderSectionHeaders(e){var m;const t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,o=i*1.5,{canvasInnerWidth:r}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,c=this._model.options.sectionHeaderFontColor,d=`rgb(${c.r} ${c.g} ${c.b})`,h=d,u=this._decorationsCanvas.domNode.getContext("2d");u.letterSpacing=n+"px",u.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,u.strokeStyle=h,u.lineWidth=.4;const f=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);f.sort((p,v)=>p.range.startLineNumber-v.range.startLineNumber);const g=TC._fitSectionHeader.bind(null,u,r-Md);for(const p of f){const v=e.getYForLineNumber(p.range.startLineNumber,t)+i,b=v-i,w=b+2,C=this._model.getSectionHeaderText(p,g);TC._renderSectionLabel(u,C,((m=p.options.minimap)==null?void 0:m.sectionHeaderStyle)===2,l,d,r,b,o,v,w)}}static _fitSectionHeader(e,t,i){if(!i)return i;const n="…",o=e.measureText(i).width,r=e.measureText(n).width;if(o<=t||o<=r)return i;const a=i.length,l=o/i.length,c=Math.floor((t-r)/l)-1;let d=Math.ceil(c/2);for(;d>0&&/\s/.test(i[d-1]);)--d;return i.substring(0,d)+n+i.substring(a-(c-d))}static _renderSectionLabel(e,t,i,n,o,r,a,l,c,d){t&&(e.fillStyle=n,e.fillRect(0,a,r,l),e.fillStyle=o,e.fillText(t,Md,c)),i&&(e.beginPath(),e.moveTo(0,d),e.lineTo(r,d),e.closePath(),e.stroke())}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const P=this._lastRenderData._get();return new oX(e,P.imageData,P.lines)}const o=this._getBuffer();if(!o)return null;const[r,a,l]=TC._renderUntouchedLines(o,e.topPaddingLineCount,t,i,n,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),d=this._model.getOptions().tabSize,h=this._model.options.defaultBackgroundColor,u=this._model.options.backgroundColor,f=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,m=g.backgroundIsLight(),p=this._model.options.renderMinimap,v=this._model.options.charRenderer(),b=this._model.options.fontScale,w=this._model.options.minimapCharWidth,y=(p===1?2:3)*b,x=n>y?Math.floor((n-y)/2):0,S=u.a/255,L=new Qu(Math.round((u.r-h.r)*S+h.r),Math.round((u.g-h.g)*S+h.g),Math.round((u.b-h.b)*S+h.b),255);let E=e.topPaddingLineCount*n;const M=[];for(let P=0,W=i-t+1;P<W;P++)l[P]&&TC._renderLine(o,L,u.a,m,p,w,g,f,v,E,x,d,c[P],b,n),M[P]=new RR(E),E+=n;const R=r===-1?0:r,A=(a===-1?o.height:a)-R;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,R,o.width,A),new oX(e,o,M)}static _renderUntouchedLines(e,t,i,n,o,r){const a=[];if(!r){for(let E=0,M=n-i+1;E<M;E++)a[E]=!0;return[-1,-1,a]}const l=r._get(),c=l.imageData.data,d=l.rendLineNumberStart,h=l.lines,u=h.length,f=e.width,g=e.data,m=(n-i+1)*o*f*4;let p=-1,v=-1,b=-1,w=-1,C=-1,y=-1,x=t*o;for(let E=i;E<=n;E++){const M=E-i,R=E-d,T=R>=0&&R<u?h[R].dy:-1;if(T===-1){a[M]=!0,x+=o;continue}const A=T*f*4,N=(T+o)*f*4,P=x*f*4,W=(x+o)*f*4;w===A&&y===P?(w=N,y=W):(b!==-1&&(g.set(c.subarray(b,w),C),p===-1&&b===0&&b===C&&(p=w),v===-1&&w===m&&b===C&&(v=b)),b=A,w=N,C=P,y=W),a[M]=!1,x+=o}b!==-1&&(g.set(c.subarray(b,w),C),p===-1&&b===0&&b===C&&(p=w),v===-1&&w===m&&b===C&&(v=b));const S=p===-1?-1:p/(f*4),L=v===-1?-1:v/(f*4);return[S,L,a]}static _renderLine(e,t,i,n,o,r,a,l,c,d,h,u,f,g,m){const p=f.content,v=f.tokens,b=e.width-r,w=m===1;let C=Md,y=0,x=0;for(let S=0,L=v.getCount();S<L;S++){const E=v.getEndOffset(S),M=v.getForeground(S),R=a.getColor(M);for(;y<E;y++){if(C>b)return;const T=p.charCodeAt(y);if(T===9){const A=u-(y+x)%u;x+=A-1,C+=A*r}else if(T===32)C+=r;else{const A=hf(T)?2:1;for(let N=0;N<A;N++)if(o===2?c.blockRenderChar(e,C,d+h,R,l,t,i,w):c.renderChar(e,C,d+h,T,R,l,t,i,g,n,w),C+=r,C>b)return}}}}}class rX{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,o=this._endLineNumber-this._startLineNumber+1;n<o;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class F4e extends yr{constructor(e,t){super(e),this._viewDomNode=t;const n=this._context.configuration.options.get(165);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=gi(document.createElement("div")),dd.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=gi(document.createElement("div")),dd.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(165);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}_widgetCanOverflow(e){const i=this._context.configuration.options.get(4);return(e.allowEditorOverflow||!1)&&i}addWidget(e){const t=gi(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._widgetCanOverflow(e)?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()],n=t?t.preference:null,o=t==null?void 0:t.stackOridinal;return i.preference===n&&i.stack===o?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=o,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var i,n;let e=0;const t=Object.keys(this._widgets);for(let o=0,r=t.length;o<r;o++){const a=t[o],c=(n=(i=this._widgets[a].widget).getMinContentWidthInPx)==null?void 0:n.call(i);typeof c<"u"&&(e=Math.max(e,c))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){const i=e.domNode;if(e.preference===null){i.setTop("");return}const n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){const o=i.domNode.clientHeight;i.setTop(this._editorHeight-o-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{const{top:o,left:r}=e.preference;if(this._context.configuration.options.get(51)&&this._widgetCanOverflow(e.widget)){const l=this._viewDomNodeRect;i.setTop(o+l.top),i.setLeft(r+l.left),i.setPosition("fixed")}else i.setTop(o),i.setLeft(r),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Fn(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,o)=>(this._widgets[n].stack||0)-(this._widgets[o].stack||0));for(let n=0,o=t.length;n<o;n++){const r=t[n];this._renderWidget(this._widgets[r],i)}}}class aX{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}}class B4e{constructor(e,t){this.tabSize=e,this.data=t}}class I${constructor(e,t,i,n,o,r,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=o,this.tokens=r,this.inlineDecorations=a}}class el{constructor(e,t,i,n,o,r,a,l,c,d,h,u){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=el.isBasicASCII(i,r),this.containsRTL=el.containsRTL(i,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=d,this.textDirection=h,this.hasVariableFonts=u}static isBasicASCII(e,t){return t?ck(e):!0}static containsRTL(e,t,i){return!t&&i?pw(e):!1}}class qL{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&dn(e.data,t.data)}static equalsArr(e,t){return dn(e,t,qL.equals)}}class W4e{constructor(e,t){const i=e.options;this.lineHeight=i.get(75),this.pixelRatio=i.get(163),this.overviewRulerLanes=i.get(95),this.renderBorder=i.get(94);const n=t.getColor(FOe);this.borderColor=n?n.toString():null,this.hideCursor=i.get(68);const o=t.getColor(e4);this.cursorColorSingle=o?o.transparent(.7).toString():null;const r=t.getColor(Zre);this.cursorColorPrimary=r?r.transparent(.7).toString():null;const a=t.getColor(Qre);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;const l=i.get(81),c=l.enabled,d=l.side,h=t.getColor(BOe),u=An.getDefaultBackground();h?this.backgroundColor=h:c&&d==="right"?this.backgroundColor=u:this.backgroundColor=null;const g=i.get(165).overviewRuler;this.top=g.top,this.right=g.right,this.domWidth=g.width,this.domHeight=g.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[m,p]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=m,this.w=p}_initLanes(e,t,i){const n=t-e;if(i>=3){const o=Math.floor(n/3),r=Math.floor(n/3),a=n-o-r,l=e,c=l+o,d=l+o+a;return[[0,l,c,l,d,l,c,l],[0,o,a,o+a,r,o+a+r,a+r,o+a+r]]}else if(i===2){const o=Math.floor(n/2),r=n-o,a=e,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,r,o+r,o+r,o+r]]}else{const o=e,r=n;return[[0,o,o,o,o,o,o,o],[0,r,r,r,r,r,r,r]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&re.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class H4e extends yr{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=gi(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=An.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new z(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new W4e(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>z.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?re.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(qL.compareByRenderingProps),this._actualShouldRender===1&&!qL.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!dn(this._renderedCursorPositions,this._cursorPositions,(g,m)=>g.position.lineNumber===m.position.lineNumber&&g.color===m.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,n=this._settings.canvasHeight,o=this._settings.lineHeight,r=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,c=6*this._settings.pixelRatio|0,d=c/2|0,h=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(h.fillStyle=re.Format.CSS.formatHexA(e),h.fillRect(0,0,i,n)):(h.clearRect(0,0,i,n),h.fillStyle=re.Format.CSS.formatHexA(e),h.fillRect(0,0,i,n)):h.clearRect(0,0,i,n);const u=this._settings.x,f=this._settings.w;for(const g of t){const m=g.color,p=g.data;h.fillStyle=m;let v=0,b=0,w=0;for(let C=0,y=p.length/3;C<y;C++){const x=p[3*C],S=p[3*C+1],L=p[3*C+2];let E=r.getVerticalOffsetForLineNumber(S)*l|0,M=(r.getVerticalOffsetForLineNumber(L)+o)*l|0;if(M-E<c){let T=(E+M)/2|0;T<d?T=d:T+d>n&&(T=n-d),E=T-d,M=T+d}E>w+1||x!==v?(C!==0&&h.fillRect(u[v],b,f[v],w-b),v=x,b=E,w=M):M>w&&(w=M)}h.fillRect(u[v],b,f[v],w-b)}if(!this._settings.hideCursor){const g=2*this._settings.pixelRatio|0,m=g/2|0,p=this._settings.x[7],v=this._settings.w[7];let b=-100,w=-100,C=null;for(let y=0,x=this._cursorPositions.length;y<x;y++){const S=this._cursorPositions[y].color;if(!S)continue;const L=this._cursorPositions[y].position;let E=r.getVerticalOffsetForLineNumber(L.lineNumber)*l|0;E<m?E=m:E+m>n&&(E=n-m);const M=E-m,R=M+g;M>w+1||S!==C?(y!==0&&C&&h.fillRect(p,b,v,w-b),b=M,w=R):R>w&&(w=R),C=S,h.fillStyle=S}C&&h.fillRect(p,b,v,w-b)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(h.beginPath(),h.lineWidth=1,h.strokeStyle=this._settings.borderColor,h.moveTo(0,0),h.lineTo(0,n),h.moveTo(1,0),h.lineTo(i,0),h.stroke())}}class lX{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class mae{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class V4e{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(mae.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),o=i/n,r=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const d=this._zones[l];if(!e){const C=d.getColorZones();if(C){a.push(C);continue}}const h=this._getVerticalOffsetForLine(d.startLineNumber),u=d.heightInLines===0?this._getVerticalOffsetForLine(d.endLineNumber)+t:h+d.heightInLines*t,f=Math.floor(o*h),g=Math.floor(o*u);let m=Math.floor((f+g)/2),p=g-m;p<r&&(p=r),m-p<0&&(m=p),m+p>i&&(m=i-p);const v=d.color;let b=this._color2Id[v];b||(b=++this._lastAssignedId,this._color2Id[v]=b,this._id2Color[b]=v);const w=new lX(m-p,m+p,b);d.setColorZone(w),a.push(w)}return this._colorZonesInvalid=!1,a.sort(lX.compare),a}}class z4e extends Cv{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=gi(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new V4e(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(75)),this._zoneManager.setPixelRatio(i.get(163)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(75)&&(this._zoneManager.setLineHeight(t.get(75)),this._render()),e.hasChanged(163)&&(this._zoneManager.setPixelRatio(t.get(163)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(o,i,n,e),!0}_renderOneLane(e,t,i,n){let o=0,r=0,a=0;for(const l of t){const c=l.colorId,d=l.from,h=l.to;c!==o?(e.fillRect(0,r,n,a-r),o=c,e.fillStyle=i[o],r=d,a=h):a>=d?a=Math.max(a,h):(e.fillRect(0,r,n,a-r),r=d,a=h)}e.fillRect(0,r,n,a-r)}}class U4e extends yr{constructor(e){super(e),this.domNode=gi(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(116),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(116),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.viewModel.model.getOptions(),o=n;let r=t-e;for(;r>0;){const a=gi(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),r--}return}let i=e-t;for(;i>0;){const n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const n=this._renderedRulers[t],o=this._rulers[t];n.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}}class $4e extends yr{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(117);this._useShadows=i.useShadows,this._domNode=gi(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(165);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(117);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class q4e{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class j4e{constructor(e,t){this.lineNumber=e,this.ranges=t}}function K4e(s){return new q4e(s)}function G4e(s){return new j4e(s.lineNumber,s.ranges.map(K4e))}const Yn=class Yn extends Nm{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._roundedSelection=t.get(115),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._roundedSelection=t.get(115),this._typicalHalfwidthCharacterWidth=t.get(59).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let o=null,r=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!o&&c<i.length;c++)i[c].lineNumber===a&&(o=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!r&&c>=0;c--)i[c].lineNumber===l&&(r=i[c].ranges[0]);o&&!o.startStyle&&(o=null),r&&!r.startStyle&&(r=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],d=c.left,h=c.left+c.width,u={top:0,bottom:0},f={top:0,bottom:0};if(a>0){const g=t[a-1].ranges[0].left,m=t[a-1].ranges[0].left+t[a-1].ranges[0].width;uD(d-g)<n?u.top=2:d>g&&(u.top=1),uD(h-m)<n?f.top=2:g<h&&h<m&&(f.top=1)}else o&&(u.top=o.startStyle.top,f.top=o.endStyle.top);if(a+1<l){const g=t[a+1].ranges[0].left,m=t[a+1].ranges[0].left+t[a+1].ranges[0].width;uD(d-g)<n?u.bottom=2:g<d&&d<m&&(u.bottom=1),uD(h-m)<n?f.bottom=2:h<m&&(f.bottom=1)}else r&&(u.bottom=r.startStyle.bottom,f.bottom=r.endStyle.bottom);c.startStyle=u,c.endStyle=f}}_getVisibleRangesWithStyle(e,t,i){const o=(t.linesVisibleRangesForRange(e,!0)||[]).map(G4e);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,o,i),o}_createSelectionPiece(e,t,i,n,o){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+o.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;const o=!!n[0].ranges[0].startStyle,r=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,c=n.length;l<c;l++){const d=n[l],h=d.lineNumber,u=h-t,f=i&&h===r?1:0,g=i&&h!==r&&h===a?1:0;let m="",p="";for(let v=0,b=d.ranges.length;v<b;v++){const w=d.ranges[v];if(o){const y=w.startStyle,x=w.endStyle;if(y.top===1||y.bottom===1){m+=this._createSelectionPiece(f,g,Yn.SELECTION_CLASS_NAME,w.left-Yn.ROUNDED_PIECE_WIDTH,Yn.ROUNDED_PIECE_WIDTH);let S=Yn.EDITOR_BACKGROUND_CLASS_NAME;y.top===1&&(S+=" "+Yn.SELECTION_TOP_RIGHT),y.bottom===1&&(S+=" "+Yn.SELECTION_BOTTOM_RIGHT),m+=this._createSelectionPiece(f,g,S,w.left-Yn.ROUNDED_PIECE_WIDTH,Yn.ROUNDED_PIECE_WIDTH)}if(x.top===1||x.bottom===1){m+=this._createSelectionPiece(f,g,Yn.SELECTION_CLASS_NAME,w.left+w.width,Yn.ROUNDED_PIECE_WIDTH);let S=Yn.EDITOR_BACKGROUND_CLASS_NAME;x.top===1&&(S+=" "+Yn.SELECTION_TOP_LEFT),x.bottom===1&&(S+=" "+Yn.SELECTION_BOTTOM_LEFT),m+=this._createSelectionPiece(f,g,S,w.left+w.width,Yn.ROUNDED_PIECE_WIDTH)}}let C=Yn.SELECTION_CLASS_NAME;if(o){const y=w.startStyle,x=w.endStyle;y.top===0&&(C+=" "+Yn.SELECTION_TOP_LEFT),y.bottom===0&&(C+=" "+Yn.SELECTION_BOTTOM_LEFT),x.top===0&&(C+=" "+Yn.SELECTION_TOP_RIGHT),x.bottom===0&&(C+=" "+Yn.SELECTION_BOTTOM_RIGHT)}p+=this._createSelectionPiece(f,g,C,w.left,w.width)}e[u][0]+=m,e[u][1]+=p}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let r=i;r<=n;r++){const a=r-i;t[a]=["",""]}const o=[];for(let r=0,a=this._selections.length;r<a;r++){const l=this._selections[r];if(l.isEmpty()){o[r]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[r]);o[r]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=t.map(([r,a])=>r+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Yn.SELECTION_CLASS_NAME="selected-text",Yn.SELECTION_TOP_LEFT="top-left-radius",Yn.SELECTION_BOTTOM_LEFT="bottom-left-radius",Yn.SELECTION_TOP_RIGHT="top-right-radius",Yn.SELECTION_BOTTOM_RIGHT="bottom-right-radius",Yn.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",Yn.ROUNDED_PIECE_WIDTH=10;let TB=Yn;Ul((s,e)=>{const t=s.getColor(BMe);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function uD(s){return s<0?-s:s}class cX{constructor(e,t,i,n,o,r,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=n,this.height=o,this.textContent=r,this.textContentClassName=a}}var Ou;(function(s){s[s.Single=0]="Single",s[s.MultiPrimary=1]="MultiPrimary",s[s.MultiSecondary=2]="MultiSecondary"})(Ou||(Ou={}));class dX{constructor(e,t){this._context=e;const i=this._context.configuration.options,n=i.get(59);this._cursorStyle=i.get(161),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(37),this._typicalHalfwidthCharacterWidth),this._lineCursorHeight=i.get(38),this._isVisible=!0,this._domNode=gi(document.createElement("div")),this._domNode.setClassName(`cursor ${w1}`),this._domNode.setHeight(this._context.viewLayout.getLineHeightForLineNumber(1)),this._domNode.setTop(0),this._domNode.setLeft(0),js(this._domNode,n),this._domNode.setDisplay("none"),this._position=new z(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case Ou.Single:this._pluralityClass="";break;case Ou.MultiPrimary:this._pluralityClass="cursor-primary";break;case Ou.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(59);return this._cursorStyle=t.get(161),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(37),this._typicalHalfwidthCharacterWidth),this._lineCursorHeight=t.get(38),js(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,o]=mDe(i,t-1);return[new z(e,n+1),i.substring(n,o)]}_prepareRender(e){let t="",i="";const[n,o]=this._getGraphemeAwarePosition(),r=this._context.viewLayout.getLineHeightForLineNumber(n.lineNumber),a=this._lineCursorHeight===0?r:Math.min(r,this._lineCursorHeight),l=(r-a)/2;if(this._cursorStyle===Rs.Line||this._cursorStyle===Rs.LineThin){const m=e.visibleRangeForPosition(n);if(!m||m.outsideRenderedLine)return null;const p=je(this._domNode.domNode);let v;this._cursorStyle===Rs.Line?(v=sY(p,this._lineCursorWidth>0?this._lineCursorWidth:2),v>2&&(t=o,i=this._getTokenClassName(n))):v=sY(p,1);let b=m.left,w=0;v>=2&&b>=1&&(w=1,b-=w);const C=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta+l;return new cX(C,b,w,v,a,t,i)}const c=e.linesVisibleRangesForRange(new D(n.lineNumber,n.column,n.lineNumber,n.column+o.length),!1);if(!c||c.length===0)return null;const d=c[0];if(d.outsideRenderedLine||d.ranges.length===0)return null;const h=d.ranges[0],u=o==="	"?this._typicalHalfwidthCharacterWidth:h.width<1?this._typicalHalfwidthCharacterWidth:h.width;this._cursorStyle===Rs.Block&&(t=o,i=this._getTokenClassName(n));let f=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,g=r;return(this._cursorStyle===Rs.Underline||this._cursorStyle===Rs.UnderlineThin)&&(f+=r-2,g=2),new cX(f,h.left,0,u,g,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${w1} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}const zx=class zx extends yr{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(104),this._cursorBlinking=t.get(32),this._cursorStyle=t.get(161),this._cursorSmoothCaretAnimation=t.get(33),this._editContextEnabled=t.get(170),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new dX(this._context,Ou.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=gi(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new ha,this._cursorFlatBlinkInterval=new FU,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(104),this._cursorBlinking=t.get(32),this._cursorStyle=t.get(161),this._cursorSmoothCaretAnimation=t.get(33),this._editContextEnabled=t.get(170),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?Ou.MultiPrimary:Ou.Single),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){const o=t.length-this._secondaryCursors.length;for(let r=0;r<o;r++){const a=new dX(this._context,Ou.MultiSecondary);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const o=this._secondaryCursors.length-t.length;for(let r=0;r<o;r++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<t.length;o++)this._secondaryCursors[o].onCursorPositionChanged(t[o],n)}onCursorStateChanged(e){const t=[];for(let n=0,o=e.selections.length;n<o;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let n=0,o=e.ranges.length;n<o;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput&&!this._editContextEnabled||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},zx.BLINK_INTERVAL,je(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},zx.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case Rs.Line:e+=" cursor-line-style";break;case Rs.Block:e+=" cursor-block-style";break;case Rs.Underline:e+=" cursor-underline-style";break;case Rs.LineThin:e+=" cursor-line-thin-style";break;case Rs.BlockOutline:e+=" cursor-block-outline-style";break;case Rs.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let o=0,r=this._secondaryCursors.length;o<r;o++){const a=this._secondaryCursors[o].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};zx.BLINK_INTERVAL=500;let NB=zx;Ul((s,e)=>{const t=[{class:".cursor",foreground:e4,background:b$},{class:".cursor-primary",foreground:Zre,background:vOe},{class:".cursor-secondary",foreground:Qre,background:COe}];for(const i of t){const n=s.getColor(i.foreground);if(n){let o=s.getColor(i.background);o||(o=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${o}; }`),od(s.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${o}; border-right: 1px solid ${o}; }`)}}});const Q5=()=>{throw new Error("Invalid change accessor")};class Y4e extends yr{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(165);this._lineHeight=t.get(75),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=gi(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=gi(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{const o=Object.keys(this._zones);for(let r=0,a=o.length;r<a;r++){const l=o[r],c=this._zones[l],d=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=d.isInHiddenArea;const h=t.get(l);h&&(h.afterLineNumber!==d.afterViewLineNumber||h.height!==d.heightInPx)&&(n.changeOneWhitespace(l,d.afterViewLineNumber,d.heightInPx),this._safeCallOnComputedHeight(c.delegate,d.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);return this._lineHeight=t.get(75),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(75)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const r=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new z(r,this._context.viewModel.model.getLineMaxColumn(r))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),o=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:n.lineNumber,heightInPx:o?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const n={addZone:o=>(t=!0,this._addZone(i,o)),removeZone:o=>{o&&(t=this._removeZone(i,o)||t)},layoutZone:o=>{o&&(t=this._layoutZone(i,o)||t)}};X4e(e,n),n.addZone=Q5,n.removeZone=Q5,n.layoutZone=Q5}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),o={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:gi(t.domNode),marginDomNode:t.marginDomNode?gi(t.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,i.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){_t(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){_t(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const r of t)this._zones[r.id].isInHiddenArea||(i[r.id]=r,n=!0);const o=Object.keys(this._zones);for(let r=0,a=o.length;r<a;r++){const l=o[r],c=this._zones[l];let d=0,h=0,u="none";i.hasOwnProperty(l)?(d=i[l].verticalOffset-e.bigNumbersDelta,h=i[l].height,u="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(d),c.domNode.setHeight(h),c.domNode.setDisplay(u),c.marginDomNode&&(c.marginDomNode.setTop(d),c.marginDomNode.setHeight(h),c.marginDomNode.setDisplay(u))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function X4e(s,e){try{return s(e)}catch(t){_t(t);return}}class Z4e extends Nm{constructor(e){super(),this._context=e,this._options=new hX(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new hX(this._context.configuration);return this._options.equals(t)?e.hasChanged(165):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,o=new Array(n);for(let r=0;r<n;r++)o[r]=!0;this._renderResult=[];for(let r=e.viewportData.startLineNumber;r<=e.viewportData.endLineNumber;r++){const a=r-e.viewportData.startLineNumber,l=this._context.viewModel.getViewLineRenderingData(r);let c=null;if(this._options.renderWhitespace==="selection"){const d=this._selection;for(const h of d){if(h.endLineNumber<r||h.startLineNumber>r)continue;const u=h.startLineNumber===r?h.startColumn:l.minColumn,f=h.endLineNumber===r?h.endColumn:l.maxColumn;u<f&&(c||(c=[]),c.push(new Ue(u-1,f-1)))}}this._renderResult[a]=this._applyRenderWhitespace(e,r,c,l)}}_applyRenderWhitespace(e,t,i,n){if(n.hasVariableFonts||this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";const o=this._context.theme.getColor(v$),r=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=n.continuesWithWrappedLine,d=n.minColumn-1,h=this._options.renderWhitespace==="boundary",u=this._options.renderWhitespace==="trailing",f=e.getLineHeightForLineNumber(t),g=this._options.middotWidth,m=this._options.wsmiddotWidth,p=this._options.spaceWidth,v=Math.abs(m-p),b=Math.abs(g-p),w=v<b?11825:183,C=this._options.canUseHalfwidthRightwardsArrow;let y="",x=!1,S=Jo(a),L;S===-1?(x=!0,S=l,L=l):L=uc(a);let E=0,M=i&&i[E],R=0;for(let T=d;T<l;T++){const A=a.charCodeAt(T);if(M&&M.endExclusive<=T&&(E++,M=i&&i[E]),A!==9&&A!==32||u&&!x&&T<=L)continue;if(h&&T>=S&&T<=L&&A===32){const P=T-1>=0?a.charCodeAt(T-1):0,W=T+1<l?a.charCodeAt(T+1):0;if(P!==32&&W!==32)continue}if(h&&c&&T===l-1){const P=T-1>=0?a.charCodeAt(T-1):0;if(A===32&&P!==32&&P!==9)continue}if(i&&!(M&&M.start<=T&&T<M.endExclusive))continue;const N=e.visibleRangeForPosition(new z(t,T+1));N&&(r?(R=Math.max(R,N.left),A===9?y+=this._renderArrow(f,p,N.left):y+=`<circle cx="${(N.left+p/2).toFixed(2)}" cy="${(f/2).toFixed(2)}" r="${(p/7).toFixed(2)}" />`):A===9?y+=`<div class="mwh" style="left:${N.left}px;height:${f}px;">${C?"￫":"→"}</div>`:y+=`<div class="mwh" style="left:${N.left}px;height:${f}px;">${String.fromCharCode(w)}</div>`)}return r?(R=Math.round(R+p),`<svg style="bottom:0;position:absolute;width:${R}px;height:${f}px" viewBox="0 0 ${R} ${f}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+y+"</svg>"):y}_renderArrow(e,t,i){const n=t/7,o=t,r=e/2,a=i,l={x:0,y:n/2},c={x:100/125*o,y:l.y},d={x:c.x-.2*c.x,y:c.y+.2*c.x},h={x:d.x+.1*c.x,y:d.y+.1*c.x},u={x:h.x+.35*c.x,y:h.y-.35*c.x},f={x:u.x,y:-u.y},g={x:h.x,y:-h.y},m={x:d.x,y:-d.y},p={x:c.x,y:-c.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,c,d,h,u,f,g,m,p,v].map(C=>`${(a+C.x).toFixed(2)} ${(r+C.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class hX{constructor(e){const t=e.options,i=t.get(59),n=t.get(47);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(113),this.renderWithSVG=!0):(this.renderWhitespace=t.get(113),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(75),this.stopRenderingLineAfter=t.get(133)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}class Q4e{constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new D(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class J4e{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class e5e{constructor(e,t,i){this.configuration=e,this.theme=new J4e(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}const f_=new Float32Array([1,0,1,1,0,1,0,0,0,1,1,0]);function Bb(s){if(!s)throw new Error(`Value "${s}" cannot be null`);return s}function pae(s,e,t){let i=new e.ResizeObserver(n=>{const o=n.find(l=>l.target===s);if(!o)return;if(!("devicePixelContentBoxSize"in o)){i==null||i.disconnect(),i=void 0;return}const r=o.devicePixelContentBoxSize[0].inlineSize,a=o.devicePixelContentBoxSize[0].blockSize;r>0&&a>0&&t(r,a)});try{i.observe(s,{box:["device-pixel-content-box"]})}catch{throw i.disconnect(),i=void 0,new et("Could not observe device pixel dimensions")}return Ve(()=>i==null?void 0:i.disconnect())}var t5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};let i5e=0;class jL extends K{get cacheKey(){return`${this.fontFamily}_${this.fontSize}px`}constructor(e,t,i,n){super(),this.fontSize=e,this.fontFamily=t,this.devicePixelRatio=i,this._decorationStyleCache=n,this.id=i5e++,this._workGlyph={source:null,boundingBox:{left:0,bottom:0,right:0,top:0},originOffset:{x:0,y:0},fontBoundingBoxAscent:0,fontBoundingBoxDescent:0},this._workGlyphConfig={chars:void 0,tokenMetadata:0,decorationStyleSetId:0},this._antiAliasing=Bt?"greyscale":"subpixel";const o=Math.ceil(this.fontSize*i);this._canvas=new OffscreenCanvas(o*3,o*3),this._ctx=Bb(this._canvas.getContext("2d",{willReadFrequently:!0,alpha:this._antiAliasing==="greyscale"})),this._ctx.textBaseline="top",this._ctx.fillStyle="#FFFFFF",this._ctx.font=`${o}px ${this.fontFamily}`,this._textMetrics=this._ctx.measureText("A")}rasterizeGlyph(e,t,i,n){return e===""?{source:this._canvas,boundingBox:{top:0,left:0,bottom:-1,right:-1},originOffset:{x:0,y:0},fontBoundingBoxAscent:0,fontBoundingBoxDescent:0}:this._workGlyphConfig.chars===e&&this._workGlyphConfig.tokenMetadata===t&&this._workGlyphConfig.decorationStyleSetId===i?this._workGlyph:(this._workGlyphConfig.chars=e,this._workGlyphConfig.tokenMetadata=t,this._workGlyphConfig.decorationStyleSetId=i,this._rasterizeGlyph(e,t,i,n))}_rasterizeGlyph(e,t,i,n){const o=Math.ceil(this.fontSize*this.devicePixelRatio),r=o*3;this._canvas.width!==r&&(this._canvas.width=r,this._canvas.height=r),this._ctx.save();const a=(t&15)/10,l=Do.getBackground(t),c=n[l],d=this._decorationStyleCache.getStyleSet(i);this._antiAliasing==="subpixel"?(this._ctx.fillStyle=c,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)):this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);const h=new Dm(200),u=Do.getFontStyle(t);u&1&&h.appendString("italic "),(d==null?void 0:d.bold)!==void 0?d.bold&&h.appendString("bold "):u&2&&h.appendString("bold "),h.appendString(`${o}px ${this.fontFamily}`),this._ctx.font=h.build();const f=o,g=o;(d==null?void 0:d.color)!==void 0?this._ctx.fillStyle=`#${d.color.toString(16).padStart(8,"0")}`:this._ctx.fillStyle=n[Do.getForeground(t)],this._ctx.textBaseline="top",(d==null?void 0:d.opacity)!==void 0&&(this._ctx.globalAlpha=d.opacity),this._ctx.fillText(e,f+a,g),this._ctx.restore();const m=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height);if(this._antiAliasing==="subpixel"){const p=parseInt(c.substring(1,3),16),v=parseInt(c.substring(3,5),16),b=parseInt(c.substring(5,7),16);this._clearColor(m,p,v,b),this._ctx.putImageData(m,0,0)}return this._findGlyphBoundingBox(m,this._workGlyph.boundingBox),this._workGlyph.source=this._canvas,this._workGlyph.originOffset.x=this._workGlyph.boundingBox.left-f,this._workGlyph.originOffset.y=this._workGlyph.boundingBox.top-g,this._workGlyph.fontBoundingBoxAscent=this._textMetrics.fontBoundingBoxAscent,this._workGlyph.fontBoundingBoxDescent=this._textMetrics.fontBoundingBoxDescent,this._workGlyph}_clearColor(e,t,i,n){for(let o=0;o<e.data.length;o+=4)e.data[o]===t&&e.data[o+1]===i&&e.data[o+2]===n&&(e.data[o+3]=0)}_findGlyphBoundingBox(e,t){const i=this._canvas.height,n=this._canvas.width;let o=!1;for(let r=0;r<i;r++){for(let a=0;a<n;a++){const l=r*n*4+a*4+3;if(e.data[l]!==0){t.top=r,o=!0;break}}if(o)break}t.left=0,o=!1;for(let r=0;r<n;r++){for(let a=0;a<i;a++){const l=a*n*4+r*4+3;if(e.data[l]!==0){t.left=r,o=!0;break}}if(o)break}t.right=n,o=!1;for(let r=n-1;r>=t.left;r--){for(let a=0;a<i;a++){const l=a*n*4+r*4+3;if(e.data[l]!==0){t.right=r,o=!0;break}}if(o)break}t.bottom=t.top,o=!1;for(let r=i-1;r>=0;r--){for(let a=0;a<n;a++){const l=r*n*4+a*4+3;if(e.data[l]!==0){t.bottom=r,o=!0;break}}if(o)break}}getTextMetrics(e){return this._ctx.measureText(e)}}t5e([Kn],jL.prototype,"cacheKey",null);var n5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},s5e=function(s,e){return function(t,i){e(t,i,s)}};let MR=class extends K{constructor(e){super(),this._logService=e,this._tasks=[],this._i=0,this._register(Ve(()=>this.clear()))}enqueue(e){this._tasks.push(e),this._start()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,n=e.timeRemaining(),o=0;for(;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),i=Math.max(t,i),o=e.timeRemaining(),i*1.5>o){n-t<-20&&this._logService.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),this._start();return}n=o}this.clear()}};MR=n5e([s5e(0,Ji)],MR);class o5e extends MR{_requestCallback(e){return xi().setTimeout(()=>e(this._createDeadline(16)))}_cancelCallback(e){xi().clearTimeout(e)}_createDeadline(e){const t=Date.now()+e;return{timeRemaining:()=>Math.max(0,t-Date.now())}}}class r5e extends MR{_requestCallback(e){return xi().requestIdleCallback(e)}_cancelCallback(e){xi().cancelIdleCallback(e)}}const a5e="requestIdleCallback"in xi()?r5e:o5e;class l5e{constructor(e,t){this._canvas=e,this._textureIndex=t,this._currentRow={x:0,y:0,h:0},this._allocatedGlyphs=new Set,this._nextIndex=0,this._ctx=Bb(this._canvas.getContext("2d",{willReadFrequently:!0}))}allocate(e){const t=e.boundingBox.right-e.boundingBox.left+1,i=e.boundingBox.bottom-e.boundingBox.top+1;if(t>this._canvas.width||i>this._canvas.height)throw new et("Glyph is too large for the atlas page");if(e.boundingBox.right-e.boundingBox.left+1>this._canvas.width-this._currentRow.x&&(this._currentRow.x=0,this._currentRow.y+=this._currentRow.h,this._currentRow.h=1),this._currentRow.y+e.boundingBox.bottom-e.boundingBox.top+1>this._canvas.height)return;this._ctx.drawImage(e.source,e.boundingBox.left,e.boundingBox.top,t,i,this._currentRow.x,this._currentRow.y,t,i);const n={pageIndex:this._textureIndex,glyphIndex:this._nextIndex++,x:this._currentRow.x,y:this._currentRow.y,w:t,h:i,originOffsetX:e.originOffset.x,originOffsetY:e.originOffset.y,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent};return this._currentRow.x+=t,this._currentRow.h=Math.max(this._currentRow.h,i),this._allocatedGlyphs.add(n),n}getUsagePreview(){const e=this._canvas.width,t=this._canvas.height,i=new OffscreenCanvas(e,t),n=Bb(i.getContext("2d"));n.fillStyle="#808080",n.fillRect(0,0,e,t);const o=new Map,r=new Map;for(const a of this._allocatedGlyphs)o.set(a.y,Math.max(o.get(a.y)??0,a.h)),r.set(a.y,Math.max(r.get(a.y)??0,a.x+a.w));for(const a of this._allocatedGlyphs)n.fillStyle="#4040FF",n.fillRect(a.x,a.y,a.w,a.h),n.fillStyle="#FF0000",n.fillRect(a.x,a.y+a.h,a.w,o.get(a.y)-a.h);for(const[a,l]of r.entries())a!==this._currentRow.y&&(n.fillStyle="#FF0000",n.fillRect(l,a,e-l,o.get(a)));return i.convertToBlob()}getStats(){const e=this._canvas.width,t=this._canvas.height;let i=0,n=0;const o=e*t,r=new Map,a=new Map;for(const l of this._allocatedGlyphs)r.set(l.y,Math.max(r.get(l.y)??0,l.h)),a.set(l.y,Math.max(a.get(l.y)??0,l.x+l.w));for(const l of this._allocatedGlyphs)i+=l.w*l.h,n+=l.w*(r.get(l.y)-l.h);for(const[l,c]of a.entries())l!==this._currentRow.y&&(n+=(e-c)*r.get(l));return[`page${this._textureIndex}:`,`     Total: ${o} (${e}x${t})`,`      Used: ${i} (${(i/o*100).toPrecision(2)}%)`,`    Wasted: ${n} (${(n/o*100).toPrecision(2)}%)`,`Efficiency: ${(i/(i+n)*100).toPrecision(2)}%`].join(`
`)}}class c5e{constructor(e,t,i){this._canvas=e,this._textureIndex=t,this._slabs=[],this._activeSlabsByDims=new TO,this._unusedRects=[],this._openRegionsByHeight=new Map,this._openRegionsByWidth=new Map,this._allocatedGlyphs=new Set,this._nextIndex=0,this._ctx=Bb(this._canvas.getContext("2d",{willReadFrequently:!0})),this._slabW=Math.min((i==null?void 0:i.slabW)??64<<Math.max(Math.floor(xi().devicePixelRatio)-1,0),this._canvas.width),this._slabH=Math.min((i==null?void 0:i.slabH)??this._slabW,this._canvas.height),this._slabsPerRow=Math.floor(this._canvas.width/this._slabW),this._slabsPerColumn=Math.floor(this._canvas.height/this._slabH)}allocate(e){const t=e.boundingBox.right-e.boundingBox.left+1,i=e.boundingBox.bottom-e.boundingBox.top+1;if(t>this._canvas.width||i>this._canvas.height)throw new et("Glyph is too large for the atlas page");if(t>this._slabW||i>this._slabH){if(this._allocatedGlyphs.size>0)return;let c=this._canvas.width;for(;t<c/2&&i<c/2;)c/=2;this._slabW=c,this._slabH=c,this._slabsPerRow=Math.floor(this._canvas.width/this._slabW),this._slabsPerColumn=Math.floor(this._canvas.height/this._slabH)}const n={w:t,h:i};let o=this._activeSlabsByDims.get(n.w,n.h);if(o){const c=Math.floor(this._slabW/o.entryW)*Math.floor(this._slabH/o.entryH);o.count>=c&&(o=void 0)}let r,a;if(!o)if(t<i){const c=this._openRegionsByWidth.get(t);if(c!=null&&c.length)for(let d=c.length-1;d>=0;d--){const h=c[d];if(h.w>=t&&h.h>=i){r=h.x,a=h.y,t<h.w&&this._unusedRects.push({x:h.x+t,y:h.y,w:h.w-t,h:i}),h.y+=i,h.h-=i,h.h===0&&(d===c.length-1?c.pop():this._unusedRects.splice(d,1));break}}}else{const c=this._openRegionsByHeight.get(i);if(c!=null&&c.length)for(let d=c.length-1;d>=0;d--){const h=c[d];if(h.w>=t&&h.h>=i){r=h.x,a=h.y,i<h.h&&this._unusedRects.push({x:h.x,y:h.y+i,w:t,h:h.h-i}),h.x+=t,h.w-=t,h.h===0&&(d===c.length-1?c.pop():this._unusedRects.splice(d,1));break}}}if(r===void 0||a===void 0){if(!o){if(this._slabs.length>=this._slabsPerRow*this._slabsPerColumn)return;o={x:Math.floor(this._slabs.length%this._slabsPerRow)*this._slabW,y:Math.floor(this._slabs.length/this._slabsPerRow)*this._slabH,entryW:n.w,entryH:n.h,count:0};const d=this._slabW%o.entryW,h=this._slabH%o.entryH;d&&uX(this._openRegionsByWidth,d,{x:o.x+this._slabW-d,w:d,y:o.y,h:this._slabH-(h??0)}),h&&uX(this._openRegionsByHeight,h,{x:o.x,w:this._slabW,y:o.y+this._slabH-h,h}),this._slabs.push(o),this._activeSlabsByDims.set(o,n.w,n.h)}const c=Math.floor(this._slabW/o.entryW);r=o.x+Math.floor(o.count%c)*o.entryW,a=o.y+Math.floor(o.count/c)*o.entryH,o.count++}this._ctx.drawImage(e.source,e.boundingBox.left,e.boundingBox.top,t,i,r,a,t,i);const l={pageIndex:this._textureIndex,glyphIndex:this._nextIndex++,x:r,y:a,w:t,h:i,originOffsetX:e.originOffset.x,originOffsetY:e.originOffset.y,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent};return this._allocatedGlyphs.add(l),l}getUsagePreview(){const e=this._canvas.width,t=this._canvas.height,i=new OffscreenCanvas(e,t),n=Bb(i.getContext("2d"));n.fillStyle="#808080",n.fillRect(0,0,e,t);let o=0,r=0,a=0;const l=64<<Math.floor(xi().devicePixelRatio)-1,c=l;for(const h of this._slabs){let u=0,f=0;for(let p=0;p<h.count;p++)u+h.entryW>l&&(u=0,f+=h.entryH),n.fillStyle="#FF0000",n.fillRect(h.x+u,h.y+f,h.entryW,h.entryH),o+=h.entryW*h.entryH,u+=h.entryW;const g=Math.floor(l/h.entryW),m=Math.floor(c/h.entryH);h.entryW*g*h.entryH*m}for(const h of this._allocatedGlyphs)r+=h.w*h.h,n.fillStyle="#4040FF",n.fillRect(h.x,h.y,h.w,h.h);const d=Array.from(this._openRegionsByWidth.values()).flat().concat(Array.from(this._openRegionsByHeight.values()).flat());for(const h of d)n.fillStyle="#FF000088",n.fillRect(h.x,h.y,h.w,h.h),a+=h.w*h.h;return n.globalAlpha=.5,n.drawImage(this._canvas,0,0),n.globalAlpha=1,i.convertToBlob()}getStats(){const e=this._canvas.width,t=this._canvas.height;let i=0,n=0,o=0,r=0,a=0;const l=e*t,c=64<<Math.floor(xi().devicePixelRatio)-1,d=c;for(const g of this._slabs){let m=0,p=0;for(let C=0;C<g.count;C++)m+g.entryW>c&&(m=0,p+=g.entryH),i+=g.entryW*g.entryH,m+=g.entryW;const v=Math.floor(c/g.entryW),b=Math.floor(d/g.entryH),w=g.entryW*v*g.entryH*b;o+=c*d-w}for(const g of this._allocatedGlyphs)n+=g.w*g.h;const h=Array.from(this._openRegionsByWidth.values()).flat().concat(Array.from(this._openRegionsByHeight.values()).flat());for(const g of h)a+=g.w*g.h;const u=o-a;r=i-(n-u);const f=n/(n+r+a);return[`page[${this._textureIndex}]:`,`     Total: ${l}px (${e}x${t})`,`      Used: ${n}px (${(n/l*100).toFixed(2)}%)`,`    Wasted: ${r}px (${(r/l*100).toFixed(2)}%)`,`Restricted: ${a}px (${(a/l*100).toFixed(2)}%) (hard to allocate)`,`Efficiency: ${f===1?"100":(f*100).toFixed(2)}%`,`     Slabs: ${this._slabs.length} of ${Math.floor(this._canvas.width/c)*Math.floor(this._canvas.height/d)}`].join(`
`)}}function uX(s,e,t){let i=s.get(e);i||(i=[],s.set(e,i)),i.push(t)}var d5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},fX=function(s,e){return function(t,i){e(t,i,s)}},RB,x_;let $c=(x_=class extends K{get version(){return this._version}get usedArea(){return this._usedArea}get source(){return this._canvas}get glyphs(){return this._glyphInOrderSet.values()}constructor(e,t,i,n,o){switch(super(),this._logService=n,this._version=0,this._usedArea={left:0,top:0,right:0,bottom:0},this._glyphMap=new TO,this._glyphInOrderSet=new Set,this._canvas=new OffscreenCanvas(t,t),this._colorMap=o.getColorTheme().tokenColorMap,i){case"shelf":this._allocator=new l5e(this._canvas,e);break;case"slab":this._allocator=new c5e(this._canvas,e);break;default:this._allocator=i(this._canvas,e);break}this._register(Ve(()=>{this._canvas.width=1,this._canvas.height=1}))}getGlyph(e,t,i,n){return this._glyphMap.get(t,i,n,e.cacheKey)??this._createGlyph(e,t,i,n)}_createGlyph(e,t,i,n){if(this._glyphInOrderSet.size>=RB.maximumGlyphCount)return;const o=e.rasterizeGlyph(t,i,n,this._colorMap),r=this._allocator.allocate(o);if(r!==void 0)return this._glyphMap.set(r,t,i,n,e.cacheKey),this._glyphInOrderSet.add(r),this._version++,this._usedArea.right=Math.max(this._usedArea.right,r.x+r.w-1),this._usedArea.bottom=Math.max(this._usedArea.bottom,r.y+r.h-1),this._logService.getLevel()===Ns.Trace&&this._logService.trace("New glyph",{chars:t,tokenMetadata:i,decorationStyleSetId:n,rasterizedGlyph:o,glyph:r}),r}getUsagePreview(){return this._allocator.getUsagePreview()}getStats(){return this._allocator.getStats()}},RB=x_,x_.maximumGlyphCount=5e3,x_);$c=RB=d5e([fX(3,Ji),fX(4,Dn)],$c);var h5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},gX=function(s,e){return function(t,i){e(t,i,s)}},YT,L_;let Sg=(L_=class extends K{get pages(){return this._pages}constructor(e,t,i,n,o){super(),this._maxTextureSize=e,this._decorationStyleCache=i,this._themeService=n,this._instantiationService=o,this._warmUpTask=this._register(new mi),this._warmedUpRasterizers=new Set,this._pages=[],this._glyphPageIndex=new TO,this._onDidDeleteGlyphs=this._register(new q),this.onDidDeleteGlyphs=this._onDidDeleteGlyphs.event,this._allocatorType=(t==null?void 0:t.allocatorType)??"slab",this._register(Se.runAndSubscribe(this._themeService.onDidColorThemeChange,()=>{this._colorMap&&this.clear(),this._colorMap=this._themeService.getColorTheme().tokenColorMap}));const r=Math.max(1,Math.floor(xi().devicePixelRatio));this.pageSize=Math.min(1024*r,this._maxTextureSize),this._initFirstPage(),this._register(Ve(()=>yi(this._pages)))}_initFirstPage(){const e=this._instantiationService.createInstance($c,0,this.pageSize,this._allocatorType);this._pages.push(e);const t=new jL(1,"",1,this._decorationStyleCache);e.getGlyph(t,"",0,0),t.dispose()}clear(){for(const e of this._pages)e.dispose();this._pages.length=0,this._glyphPageIndex.clear(),this._warmedUpRasterizers.clear(),this._warmUpTask.clear(),this._initFirstPage(),this._onDidDeleteGlyphs.fire()}getGlyph(e,t,i,n,o){return i&=-2048,i|=Math.floor(o%1*10),this._warmedUpRasterizers.has(e.id)||(this._warmUpAtlas(e),this._warmedUpRasterizers.add(e.id)),this._tryGetGlyph(this._glyphPageIndex.get(t,i,n,e.cacheKey)??0,e,t,i,n)}_tryGetGlyph(e,t,i,n,o){return this._glyphPageIndex.set(e,i,n,o,t.cacheKey),this._pages[e].getGlyph(t,i,n,o)??(e+1<this._pages.length?this._tryGetGlyph(e+1,t,i,n,o):void 0)??this._getGlyphFromNewPage(t,i,n,o)}_getGlyphFromNewPage(e,t,i,n){if(this._pages.length>=YT.maximumPageCount)throw new Error(`Attempt to create a texture atlas page past the limit ${YT.maximumPageCount}`);return this._pages.push(this._instantiationService.createInstance($c,this._pages.length,this.pageSize,this._allocatorType)),this._glyphPageIndex.set(this._pages.length-1,t,i,n,e.cacheKey),this._pages[this._pages.length-1].getGlyph(e,t,i,n)}getStats(){return this._pages.map(e=>e.getStats())}_warmUpAtlas(e){var n;const t=this._colorMap;if(!t)throw new et("Cannot warm atlas without color map");(n=this._warmUpTask.value)==null||n.clear();const i=this._warmUpTask.value=this._instantiationService.createInstance(a5e);for(let o=65;o<=90;o++)for(const r of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(o),r<<15&16744448,0,a)});for(let o=97;o<=122;o++)for(const r of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(o),r<<15&16744448,0,a)});for(let o=33;o<=126;o++)for(const r of t.keys())i.enqueue(()=>{for(let a=0;a<1;a+=.1)this.getGlyph(e,String.fromCharCode(o),r<<15&16744448,0,a)})}},YT=L_,L_.maximumPageCount=16,L_);Sg=YT=h5e([gX(3,Dn),gX(4,$e)],Sg);var KL;(function(s){s[s.Ignore=0]="Ignore",s[s.Info=1]="Info",s[s.Warning=2]="Warning",s[s.Error=3]="Error"})(KL||(KL={}));(function(s){const e="error",t="warning",i="warn",n="info",o="ignore";function r(l){return l?zp(e,l)?s.Error:zp(t,l)||zp(i,l)?s.Warning:zp(n,l)?s.Info:s.Ignore:s.Ignore}s.fromValue=r;function a(l){switch(l){case s.Error:return e;case s.Warning:return t;case s.Info:return n;default:return o}}s.toString=a})(KL||(KL={}));var xn=KL,f0=xn;const Hn=Mt("notificationService");class u5e{}var Mr;(function(s){async function e(n){try{if(!navigator.gpu)throw new Error("This browser does not support WebGPU");const o=await navigator.gpu.requestAdapter();if(!o)throw new Error("This browser supports WebGPU but it appears to be disabled");return J5(await o.requestDevice())}catch(o){throw n&&n(o.message),o}}s.requestDevice=e;function t(n,o,r){const a=n.createBuffer(o);return r&&n.queue.writeBuffer(a,0,kb(r)?r():r),J5(a)}s.createBuffer=t;function i(n,o){return J5(n.createTexture(o))}s.createTexture=i})(Mr||(Mr={}));function J5(s){return{object:s,dispose:()=>s.destroy()}}class f5e{get dataOffset(){return this._startIndex}get dirtySize(){if(!(this._startIndex===void 0||this._endIndex===void 0))return this._endIndex-this._startIndex+1}get isDirty(){return this._startIndex!==void 0}flag(e,t=1){return this._flag(e),t>1&&this._flag(e+t-1),e}_flag(e){(this._startIndex===void 0||e<this._startIndex)&&(this._startIndex=e),(this._endIndex===void 0||e>this._endIndex)&&(this._endIndex=e)}clear(){this._startIndex=void 0,this._endIndex=void 0}}function g5e(s,e){return new m5e(s,e)}class m5e extends K{get entryCount(){return this._entries.size}get dirtyTracker(){return this._dirtyTracker}constructor(e,t){super(),this.propertySpecs=e,this.capacity=t,this._dirtyTracker=new f5e,this._propertySpecsMap=new Map,this._entries=new Zo,this._onDidChange=this._register(new q),this._onDidChangeBuffer=this._register(new q),this.onDidChangeBuffer=this._onDidChangeBuffer.event,this.view=new Float32Array(t*e.length),this.buffer=this.view.buffer,this._entrySize=e.length;for(let i=0;i<e.length;i++){const n={offset:i,...e[i]};this._propertySpecsMap.set(n.name,n)}this._register(Ve(()=>yi(this._entries)))}createEntry(e){this._entries.size===this.capacity&&(this._expandBuffer(),this._onDidChangeBuffer.fire());const t=new p5e(this.view,this._propertySpecsMap,this._dirtyTracker,this._entries.size,e),i=this._entries.push(t),n=[];return n.push(Se.forward(t.onDidChange,this._onDidChange)),n.push(t.onWillDispose(()=>{const o=t.i;i(),this.view.set(this.view.subarray(o*this._entrySize+2,this._entries.size*this._entrySize+2),o*this._entrySize);for(const r of this._entries)r.i>o&&r.i--;this._dirtyTracker.flag(o,(this._entries.size-o)*this._entrySize),yi(n)})),t}_expandBuffer(){this.capacity*=2;const e=new Float32Array(this.capacity*this._entrySize);e.set(this.view),this.view=e,this.buffer=this.view.buffer}}class p5e extends K{constructor(e,t,i,n,o){super(),this._view=e,this._propertySpecsMap=t,this._dirtyTracker=i,this.i=n,this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this._onWillDispose=this._register(new q),this.onWillDispose=this._onWillDispose.event;for(const r of this._propertySpecsMap.values())this._view[this.i*this._propertySpecsMap.size+r.offset]=o[r.name];this._dirtyTracker.flag(this.i*this._propertySpecsMap.size,this._propertySpecsMap.size)}dispose(){this._onWillDispose.fire(),super.dispose()}setRaw(e){if(e.length!==this._propertySpecsMap.size)throw new Error(`Data length ${e.length} does not match the number of properties in the collection (${this._propertySpecsMap.size})`);this._view.set(e,this.i*this._propertySpecsMap.size),this._dirtyTracker.flag(this.i*this._propertySpecsMap.size,this._propertySpecsMap.size)}}const _5e=`

struct Vertex {
	@location(0) position: vec2f,
};

struct LayoutInfo {
	canvasDims: vec2f,
	viewportOffset: vec2f,
	viewportDims: vec2f,
}

struct ScrollOffset {
	offset: vec2f,
}

struct Shape {
	position: vec2f,
	size: vec2f,
	color: vec4f,
};

struct VSOutput {
	@builtin(position) position: vec4f,
	@location(1)       color:    vec4f,
};

// Uniforms
@group(0) @binding(1) var<uniform>       layoutInfo:      LayoutInfo;

// Storage buffers
@group(0) @binding(0)            var<storage, read> shapes:          array<Shape>;
@group(0) @binding(2)      var<uniform>       scrollOffset:    ScrollOffset;

@vertex fn vs(
	vert: Vertex,
	@builtin(instance_index) instanceIndex: u32,
	@builtin(vertex_index) vertexIndex : u32
) -> VSOutput {
	let shape = shapes[instanceIndex];

	var vsOut: VSOutput;
	vsOut.position = vec4f(
		(
			// Top left corner
			vec2f(-1,  1) +
			// Convert pixel position to clipspace
			vec2f( 2, -2) / layoutInfo.canvasDims *
			// Shape position and size
			(layoutInfo.viewportOffset - scrollOffset.offset + shape.position + vert.position * shape.size)
		),
		0.0,
		1.0
	);
	vsOut.color = shape.color;
	return vsOut;
}

@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {
	return vsOut.color;
}
`;class b5e extends Cv{constructor(e,t,i,n,o,r){super(),this._context=e,this._contentLeft=t,this._devicePixelRatio=i,this._canvas=n,this._ctx=o,this._shapeBindBuffer=this._register(new mi),this._initialized=!1,this._shapeCollection=this._register(g5e([{name:"x"},{name:"y"},{name:"width"},{name:"height"},{name:"red"},{name:"green"},{name:"blue"},{name:"alpha"}],32)),this._context.addEventHandler(this),this._initWebgpu(r)}async _initWebgpu(e){if(this._device=await e,this._store.isDisposed)return;const t=navigator.gpu.getPreferredCanvasFormat();this._ctx.configure({device:this._device,format:t,alphaMode:"premultiplied"}),this._renderPassColorAttachment={view:null,loadOp:"load",storeOp:"store"},this._renderPassDescriptor={label:"Monaco rectangle renderer render pass",colorAttachments:[this._renderPassColorAttachment]};let i;{const a=new Float32Array(6),l=(c=this._canvas.width,d=this._canvas.height)=>(a[0]=c,a[1]=d,a[2]=Math.ceil(this._context.configuration.options.get(165).contentLeft*xi().devicePixelRatio),a[3]=0,a[4]=a[0]-a[2],a[5]=a[1]-a[3],a);i=this._register(Mr.createBuffer(this._device,{label:"Monaco rectangle renderer uniform buffer",size:24,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>l())).object,this._register(pae(this._canvas,xi(),(c,d)=>{this._device.queue.writeBuffer(i,0,l(c,d))}))}const n=2;this._scrollOffsetBindBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco rectangle renderer scroll offset buffer",size:n*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(n);const o=()=>Mr.createBuffer(this._device,{label:"Monaco rectangle renderer shape buffer",size:this._shapeCollection.buffer.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});this._shapeBindBuffer.value=o(),this._register(Se.runAndSubscribe(this._shapeCollection.onDidChangeBuffer,()=>{this._shapeBindBuffer.value=o(),this._pipeline&&this._updateBindGroup(this._pipeline,i)})),this._vertexBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco rectangle renderer vertex buffer",size:f_.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST},f_)).object;const r=this._device.createShaderModule({label:"Monaco rectangle renderer shader module",code:_5e});this._pipeline=this._device.createRenderPipeline({label:"Monaco rectangle renderer render pipeline",layout:"auto",vertex:{module:r,buffers:[{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]}]},fragment:{module:r,targets:[{format:t,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"}}}]}}),this._updateBindGroup(this._pipeline,i),this._initialized=!0}_updateBindGroup(e,t){this._bindGroup=this._device.createBindGroup({label:"Monaco rectangle renderer bind group",layout:e.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._shapeBindBuffer.value.object}},{binding:1,resource:{buffer:t}},{binding:2,resource:{buffer:this._scrollOffsetBindBuffer}}]})}register(e,t,i,n,o,r,a,l){return this._shapeCollection.createEntry({x:e,y:t,width:i,height:n,red:o,green:r,blue:a,alpha:l})}onScrollChanged(e){if(this._device){const t=xi().devicePixelRatio;this._scrollOffsetValueBuffer[0]=this._context.viewLayout.getCurrentScrollLeft()*t,this._scrollOffsetValueBuffer[1]=this._context.viewLayout.getCurrentScrollTop()*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer)}return!0}_update(){if(!this._device)return;const e=this._shapeCollection;e.dirtyTracker.isDirty&&(this._device.queue.writeBuffer(this._shapeBindBuffer.value.object,0,e.buffer,e.dirtyTracker.dataOffset,e.dirtyTracker.dirtySize*e.view.BYTES_PER_ELEMENT),e.dirtyTracker.clear())}draw(e){if(!this._initialized)return;this._update();const t=this._device.createCommandEncoder({label:"Monaco rectangle renderer command encoder"});this._renderPassColorAttachment.view=this._ctx.getCurrentTexture().createView();const i=t.beginRenderPass(this._renderPassDescriptor);i.setPipeline(this._pipeline),i.setVertexBuffer(0,this._vertexBuffer),i.setBindGroup(0,this._bindGroup);const n=Math.ceil(this._contentLeft.get()*this._devicePixelRatio.get());i.setScissorRect(n,0,this._canvas.width-n,this._canvas.height),i.draw(f_.length/2,this._shapeCollection.entryCount),i.end();const o=t.finish();this._device.queue.submit([o])}}class v5e extends K{constructor(){super(),this._ruleCache=new Map,this._container=we("div.monaco-decoration-css-rule-extractor"),this._dummyElement=we("span"),this._container.appendChild(this._dummyElement),this._register(Ve(()=>this._container.remove()))}getStyleRules(e,t){const i=this._ruleCache.get(t);if(i)return i;this._dummyElement.className=t,e.appendChild(this._container);const n=this._getStyleRules(t);return this._ruleCache.set(t,n),e.removeChild(this._container),n}_getStyleRules(e){const t=[],n=[...uk().styleSheets];for(let o=0;o<n.length;o++){const r=n[o];for(const a of r.cssRules)if(a instanceof CSSImportRule)a.styleSheet&&n.push(a.styleSheet);else if(a instanceof CSSStyleRule){const l=`.${e}`,c=a.selectorText.indexOf(l);if(c!==-1){const d=c+l.length;(a.selectorText.length===d||a.selectorText.substring(d,d+1).match(/[ :]/))&&t.push(a)}}}return t}}class C5e{constructor(){this._nextId=1,this._cacheById=new Map,this._cacheByStyle=new TO}getOrCreateEntry(e,t,i){if(e===void 0&&t===void 0&&i===void 0)return 0;const n=this._cacheByStyle.get(e??0,t?1:0,i===void 0?"":i.toFixed(2));if(n)return n.id;const o=this._nextId++,r={id:o,color:e,bold:t,opacity:i};return this._cacheById.set(o,r),this._cacheByStyle.set(r,e??0,t?1:0,i===void 0?"":i.toFixed(2)),o}getStyleSet(e){if(e!==0)return this._cacheById.get(e)}}function rd(s,e){let t,i=!0;return pTe({changeTracker:{createChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(n,o)=>{if(n.didChange(s)){const r=n.change;r!==void 0&&o.deltas.push(r),o.didChange=!0}return!0}}},(n,o)=>{const r=s.read(n),a=t;o.didChange&&(t=r,e(r,a,o.deltas)),i&&(i=!1,t=r)})}function _ae(s,e){const t=new oe,i=rd(s,(n,o,r)=>{t.clear(),e(n,o,r,t)});return{dispose(){i.dispose(),t.dispose()}}}function w5e(s,e){return _ae(s,(t,i,n,o)=>{e(t,i,n,I9(o))})}var y5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},eF=function(s,e){return function(t,i){e(t,i,s)}},ar,qg;let Yo=(qg=class extends K{static get decorationCssRuleExtractor(){return ar._decorationCssRuleExtractor}static get decorationStyleCache(){return ar._decorationStyleCache}static get atlas(){if(!ar._atlas)throw new et("Cannot call ViewGpuContext.textureAtlas before device is resolved");return ar._atlas}get atlas(){return ar.atlas}constructor(e,t,i,n){super(),this._instantiationService=t,this._notificationService=i,this.configurationService=n,this.maxGpuCols=2e3,this.canvas=gi(document.createElement("canvas")),this.canvas.setClassName("editorCanvas"),this._register(Se.runAndSubscribe(n.onDidChangeConfiguration,l=>{var c;if(!l||l.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")){const d=((c=n.getValue("editor").scrollbar)==null?void 0:c.verticalScrollbarSize)??14;this.canvas.domNode.style.boxSizing="border-box",this.canvas.domNode.style.paddingRight=`${d}px`}})),this.ctx=Bb(this.canvas.domNode.getContext("webgpu")),ar.device||(ar.device=Mr.requestDevice(l=>{const c=[{label:_(78,"Use DOM-based rendering"),run:()=>this.configurationService.updateValue("editor.experimentalGpuAcceleration","off")}];this._notificationService.prompt(f0.Warning,l,c)}).then(l=>(ar.deviceSync=l.object,ar._atlas||(ar._atlas=this._instantiationService.createInstance(Sg,l.object.limits.maxTextureDimension2D,void 0,ar.decorationStyleCache)),l.object)));const o=ht(this,xi().devicePixelRatio);this._register(ee(xi(),"resize",()=>{o.set(xi().devicePixelRatio,void 0)})),this.devicePixelRatio=o,this._register(rd(this.devicePixelRatio,()=>{var l;return(l=ar.atlas)==null?void 0:l.clear()}));const r=ht(this,{width:this.canvas.domNode.width,height:this.canvas.domNode.height});this._register(pae(this.canvas.domNode,xi(),(l,c)=>{this.canvas.domNode.width=l,this.canvas.domNode.height=c,r.set({width:l,height:c},void 0)})),this.canvasDevicePixelDimensions=r;const a=ht(this,0);this._register(this.configurationService.onDidChangeConfiguration(l=>{a.set(e.configuration.options.get(165).contentLeft,void 0)})),this.contentLeft=a,this.rectangleRenderer=this._instantiationService.createInstance(b5e,e,this.contentLeft,this.devicePixelRatio,this.canvas.domNode,this.ctx,ar.device)}canRender(e,t,i){const n=t.getViewLineRenderingData(i);if(n.containsRTL||n.maxColumn>this.maxGpuCols)return!1;if(n.inlineDecorations.length>0){let o=!0;for(const r of n.inlineDecorations){if(r.type!==0){o=!1;break}const a=ar._decorationCssRuleExtractor.getStyleRules(this.canvas.domNode,r.inlineClassName);if(o&&(o=a.every(l=>{if(l.selectorText.includes(":"))return!1;for(const c of l.style)if(!mX(c,l.style))return!1;return!0})),!o)break}return o}return!0}canRenderDetailed(e,t,i){const n=t.getViewLineRenderingData(i),o=[];if(n.containsRTL&&o.push("containsRTL"),n.maxColumn>this.maxGpuCols&&o.push("maxColumn > maxGpuCols"),n.inlineDecorations.length>0){let r=!0;const a=[],l=[],c=[];for(const d of n.inlineDecorations){if(d.type!==0){a.push(d.type),r=!1;continue}const h=ar._decorationCssRuleExtractor.getStyleRules(this.canvas.domNode,d.inlineClassName);r&&(r=h.every(u=>{if(u.selectorText.includes(":"))return l.push(u.selectorText),!1;for(const f of u.style)if(!mX(f,u.style))return c.push(`${f}: ${u.style[f]}`),!1;return!0}))}a.length>0&&o.push(`inlineDecorations with unsupported types (${a.map(d=>`\`${d}\``).join(", ")})`),c.length>0&&o.push(`inlineDecorations with unsupported CSS rules (${c.map(d=>`\`${d}\``).join(", ")})`),l.length>0&&o.push(`inlineDecorations with unsupported CSS selectors (${l.map(d=>`\`${d}\``).join(", ")})`)}return o}},ar=qg,qg._decorationCssRuleExtractor=new v5e,qg._decorationStyleCache=new C5e,qg);Yo=ar=y5e([eF(1,$e),eF(2,Hn),eF(3,xt)],Yo);const S5e=["color","font-weight","opacity"];function mX(s,e){return!!S5e.includes(s)}function AR(s,e){return s.isBasicASCII&&e.useMonospaceOptimizations?new x5e(s):new L5e(s)}class x5e{constructor(e){this._content=e.content}getSegmentAtIndex(e){return this._content[e]}}class L5e{constructor(e){this._segments=[];const t=e.content,i=bv.Segmenter(void 0,{granularity:"grapheme"}).value,n=Array.from(i.segment(t));let o=0;for(let r=0;r<t.length;r++){const a=n[o];if(!a)break;if(a.index!==r){this._segments.push(void 0);continue}o++,this._segments.push(a)}}getSegmentAtIndex(e){var t;return(t=this._segments[e])==null?void 0:t.segment}}class bae extends Cv{get glyphRasterizer(){return this._glyphRasterizer.value}constructor(e,t,i,n){super(),this._context=e,this._viewGpuContext=t,this._device=i,this._glyphRasterizer=n,this._context.addEventHandler(this)}}const vae=`
struct GlyphInfo {
	position: vec2f,
	size: vec2f,
	origin: vec2f,
};

struct Vertex {
	@location(0) position: vec2f,
};

struct Cell {
	position: vec2f,
	unused1: vec2f,
	glyphIndex: f32,
	textureIndex: f32
};

struct LayoutInfo {
	canvasDims: vec2f,
	viewportOffset: vec2f,
	viewportDims: vec2f,
}

struct ScrollOffset {
	offset: vec2f
}

struct VSOutput {
	@builtin(position) position:   vec4f,
	@location(1)       layerIndex: f32,
	@location(0)       texcoord:   vec2f,
};

// Uniforms
@group(0) @binding(4)       var<uniform>       layoutInfo:      LayoutInfo;
@group(0) @binding(5)  var<uniform>       atlasDims:       vec2f;
@group(0) @binding(6)            var<uniform>       scrollOffset:    ScrollOffset;

// Storage buffers
@group(0) @binding(0)               var<storage, read> glyphInfo:       array<array<GlyphInfo, ${$c.maximumGlyphCount}>, ${Sg.maximumPageCount}>;
@group(0) @binding(1)                   var<storage, read> cells:           array<Cell>;

@vertex fn vs(
	vert: Vertex,
	@builtin(instance_index) instanceIndex: u32,
	@builtin(vertex_index) vertexIndex : u32
) -> VSOutput {
	let cell = cells[instanceIndex];
	var glyph = glyphInfo[u32(cell.textureIndex)][u32(cell.glyphIndex)];

	var vsOut: VSOutput;
	// Multiple vert.position by 2,-2 to get it into clipspace which ranged from -1 to 1
	vsOut.position = vec4f(
		// Make everything relative to top left instead of center
		vec2f(-1, 1) +
		((vert.position * vec2f(2, -2)) / layoutInfo.canvasDims) * glyph.size +
		((cell.position * vec2f(2, -2)) / layoutInfo.canvasDims) +
		((glyph.origin * vec2f(2, -2)) / layoutInfo.canvasDims) +
		(((layoutInfo.viewportOffset - scrollOffset.offset * vec2(1, -1)) * 2) / layoutInfo.canvasDims),
		0.0,
		1.0
	);

	vsOut.layerIndex = cell.textureIndex;
	// Textures are flipped from natural direction on the y-axis, so flip it back
	vsOut.texcoord = vert.position;
	vsOut.texcoord = (
		// Glyph offset (0-1)
		(glyph.position / atlasDims) +
		// Glyph coordinate (0-1)
		(vsOut.texcoord * (glyph.size / atlasDims))
	);

	return vsOut;
}

@group(0) @binding(2) var ourSampler: sampler;
@group(0) @binding(3)        var ourTexture: texture_2d_array<f32>;

@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {
	return textureSample(ourTexture, ourSampler, vsOut.texcoord, u32(vsOut.layerIndex));
}
`,Hd=class Hd extends bae{get bindGroupEntries(){return[{binding:1,resource:{buffer:this._cellBindBuffer}},{binding:6,resource:{buffer:this._scrollOffsetBindBuffer}}]}constructor(e,t,i,n){super(e,t,i,n),this.type="viewport",this.wgsl=vae,this._cellBindBufferLineCapacity=63,this._activeDoubleBufferIndex=0,this._visibleObjectCount=0,this._scrollInitialized=!1,this._onDidChangeBindGroupEntries=this._register(new q),this.onDidChangeBindGroupEntries=this._onDidChangeBindGroupEntries.event,this._rebuildCellBuffer(this._cellBindBufferLineCapacity);const o=2;this._scrollOffsetBindBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco scroll offset buffer",size:o*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(o)}_rebuildCellBuffer(e){var n;(n=this._cellBindBuffer)==null||n.destroy();const t=(Math.floor(e/32)+1)*32,i=t*Hd.maxSupportedColumns*6*Float32Array.BYTES_PER_ELEMENT;this._cellBindBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco full file cell buffer",size:i,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._cellValueBuffers=[new ArrayBuffer(i),new ArrayBuffer(i)],this._cellBindBufferLineCapacity=t,this._onDidChangeBindGroupEntries.fire()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onTokensChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onLinesChanged(e){return!0}onScrollChanged(e){const t=xi().devicePixelRatio;return this._scrollOffsetValueBuffer[0]=((e==null?void 0:e.scrollLeft)??this._context.viewLayout.getCurrentScrollLeft())*t,this._scrollOffsetValueBuffer[1]=((e==null?void 0:e.scrollTop)??this._context.viewLayout.getCurrentScrollTop())*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer),!0}onThemeChanged(e){return!0}onLineMappingChanged(e){return!0}onZonesChanged(e){return!0}reset(){for(const e of[0,1]){const t=new Float32Array(this._cellValueBuffers[e]);t.fill(0,0,t.length),this._device.queue.writeBuffer(this._cellBindBuffer,0,t.buffer,0,t.byteLength)}}update(e,t){var A;let i="",n,o=0,r=0,a=0,l=0,c=0,d=0,h,u=0,f=0,g=0,m=0,p,v,b,w,C,y=0,x=0,S;const L=xi().devicePixelRatio;let E;this._scrollInitialized||(this.onScrollChanged(),this._scrollInitialized=!0),this._cellBindBufferLineCapacity<e.endLineNumber-e.startLineNumber+1&&this._rebuildCellBuffer(e.endLineNumber-e.startLineNumber+1);const M=new Float32Array(this._cellValueBuffers[this._activeDoubleBufferIndex]);M.fill(0);const R=Hd.maxSupportedColumns*6;for(r=e.startLineNumber;r<=e.endLineNumber;r++)if(this._viewGpuContext.canRender(t,e,r)){w=e.getViewLineRenderingData(r),d=0,E=AR(w,t),o=t.spaceWidth*L,l=0,S=w.tokens,f=w.minColumn-1,g=0;for(let N=0,P=S.getCount();N<P;N++)if(g=S.getEndOffset(N),!(g<=f)){for(m=S.getMetadata(N),a=f;a<g&&!(a>Hd.maxSupportedColumns);a++){if(n=E.getSegmentAtIndex(a),n===void 0)continue;i=n,w.isBasicASCII&&t.useMonospaceOptimizations||(o=this.glyphRasterizer.getTextMetrics(i).width),v=void 0,p=void 0,b=void 0;for(C of w.inlineDecorations){if(r<C.range.startLineNumber||r>C.range.endLineNumber||r===C.range.startLineNumber&&a<C.range.startColumn-1||r===C.range.endLineNumber&&a>=C.range.endColumn-1)continue;const H=Yo.decorationCssRuleExtractor.getStyleRules(this._viewGpuContext.canvas.domNode,C.inlineClassName);for(const G of H)for(const V of G.style){const U=((A=G.styleMap.get(V))==null?void 0:A.toString())??"";switch(V){case"color":{const $=re.Format.CSS.parse(U);if(!$)throw new et("Invalid color format "+U);v=$.toNumber32Bit();break}case"font-weight":{I5e(U)>=400?p=!0:p=!1;break}case"opacity":{b=E5e(U);break}default:throw new et("Unexpected inline decoration style")}}}if(i===" "||i==="	"){if(u=((r-1)*Hd.maxSupportedColumns+a)*6,M.fill(0,u,u+6),i==="	"){const H=a+d;d=Ln.nextRenderTabStop(a+d,w.tabSize),l+=o*(d-H),d-=a+1}else l+=o;continue}const W=Yo.decorationStyleCache.getOrCreateEntry(v,p,b);h=this._viewGpuContext.atlas.getGlyph(this.glyphRasterizer,i,m,W,l),c=Math.round(e.relativeVerticalOffset[r-e.startLineNumber]*L+Math.floor((e.lineHeight*L-(h.fontBoundingBoxAscent+h.fontBoundingBoxDescent))/2)+h.fontBoundingBoxAscent),u=((r-e.startLineNumber)*Hd.maxSupportedColumns+a)*6,M[u+0]=Math.floor(l),M[u+1]=c,M[u+4]=h.glyphIndex,M[u+5]=h.pageIndex,l+=o}f=g}y=((r-e.startLineNumber)*Hd.maxSupportedColumns+g)*6,x=(r-e.startLineNumber)*Hd.maxSupportedColumns*6,M.fill(0,y,x)}const T=(e.endLineNumber-e.startLineNumber+1)*R;return this._device.queue.writeBuffer(this._cellBindBuffer,0,M.buffer,0,(e.endLineNumber-e.startLineNumber)*R*Float32Array.BYTES_PER_ELEMENT),this._activeDoubleBufferIndex=this._activeDoubleBufferIndex?0:1,this._visibleObjectCount=T,T}draw(e,t){if(this._visibleObjectCount<=0)throw new et("Attempt to draw 0 objects");e.draw(f_.length/2,this._visibleObjectCount)}};Hd.maxSupportedColumns=2e3;let MB=Hd;function I5e(s){switch(s){case"lighter":case"normal":return 400;case"bolder":case"bold":return 700}return parseInt(s)}function E5e(s){return s.endsWith("%")?parseFloat(s.substring(0,s.length-1))/100:s.match(/^\d+(?:\.\d*)/)?parseFloat(s):1}const uo=class uo extends bae{get bindGroupEntries(){return[{binding:1,resource:{buffer:this._cellBindBuffer}},{binding:6,resource:{buffer:this._scrollOffsetBindBuffer}}]}constructor(e,t,i,n){super(e,t,i,n),this.type="fullfile",this.wgsl=vae,this._activeDoubleBufferIndex=0,this._upToDateLines=[new Set,new Set],this._visibleObjectCount=0,this._finalRenderedLine=0,this._scrollInitialized=!1,this._queuedBufferUpdates=[[],[]];const o=uo.maxSupportedLines*uo.maxSupportedColumns*6*Float32Array.BYTES_PER_ELEMENT;this._cellBindBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco full file cell buffer",size:o,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._cellValueBuffers=[new ArrayBuffer(o),new ArrayBuffer(o)];const r=2;this._scrollOffsetBindBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco scroll offset buffer",size:r*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})).object,this._scrollOffsetValueBuffer=new Float32Array(r)}onConfigurationChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}onDecorationsChanged(e){return this._invalidateAllLines(),!0}onTokensChanged(e){for(const t of e.ranges)this._invalidateLineRange(t.fromLineNumber,t.toLineNumber);return!0}onLinesDeleted(e){return this._invalidateLinesFrom(e.fromLineNumber),this._queueBufferUpdate(e),!0}onLinesInserted(e){return this._invalidateLinesFrom(e.fromLineNumber),!0}onLinesChanged(e){return this._invalidateLineRange(e.fromLineNumber,e.fromLineNumber+e.count),!0}onScrollChanged(e){const t=xi().devicePixelRatio;return this._scrollOffsetValueBuffer[0]=((e==null?void 0:e.scrollLeft)??this._context.viewLayout.getCurrentScrollLeft())*t,this._scrollOffsetValueBuffer[1]=((e==null?void 0:e.scrollTop)??this._context.viewLayout.getCurrentScrollTop())*t,this._device.queue.writeBuffer(this._scrollOffsetBindBuffer,0,this._scrollOffsetValueBuffer),!0}onThemeChanged(e){return this._invalidateAllLines(),!0}onLineMappingChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}onZonesChanged(e){return this._invalidateAllLines(),this._queueBufferUpdate(e),!0}_invalidateAllLines(){this._upToDateLines[0].clear(),this._upToDateLines[1].clear()}_invalidateLinesFrom(e){for(const t of[0,1]){const i=this._upToDateLines[t];for(const n of i)n>=e&&i.delete(n)}}_invalidateLineRange(e,t){for(let i=e;i<=t;i++)this._upToDateLines[0].delete(i),this._upToDateLines[1].delete(i)}reset(){this._invalidateAllLines();for(const e of[0,1]){const t=new Float32Array(this._cellValueBuffers[e]);t.fill(0,0,t.length),this._device.queue.writeBuffer(this._cellBindBuffer,0,t.buffer,0,t.byteLength)}this._finalRenderedLine=0}update(e,t){var H;let i="",n,o=0,r=0,a=0,l=0,c=0,d=0,h,u=0,f=0,g=0,m=0,p,v,b,w,C,y=0,x=0,S;const L=xi().devicePixelRatio;let E;this._scrollInitialized||(this.onScrollChanged(),this._scrollInitialized=!0);const M=new Float32Array(this._cellValueBuffers[this._activeDoubleBufferIndex]),R=uo.maxSupportedColumns*6,T=this._upToDateLines[this._activeDoubleBufferIndex];let A=3e3,N=0;const P=this._queuedBufferUpdates[this._activeDoubleBufferIndex];for(;P.length;){const G=P.shift();switch(G.type){case 2:case 8:case 17:{M.fill(0),A=1,N=Math.max(N,this._finalRenderedLine),this._finalRenderedLine=0;break}case 10:{const V=(G.fromLineNumber-1)*uo.maxSupportedColumns*6,U=G.toLineNumber*uo.maxSupportedColumns*6,$=(this._finalRenderedLine-(G.toLineNumber-G.fromLineNumber+1))*uo.maxSupportedColumns*6;M.set(M.subarray(U),V),M.fill(0,$),A=Math.min(A,G.fromLineNumber),N=Math.max(N,this._finalRenderedLine),this._finalRenderedLine-=G.toLineNumber-G.fromLineNumber+1;break}}}for(r=e.startLineNumber;r<=e.endLineNumber;r++){if(!this._viewGpuContext.canRender(t,e,r)){y=(r-1)*uo.maxSupportedColumns*6,x=r*uo.maxSupportedColumns*6,M.fill(0,y,x),A=Math.min(A,r),N=Math.max(N,r);continue}if(!T.has(r)){A=Math.min(A,r),N=Math.max(N,r),w=e.getViewLineRenderingData(r),d=0,E=AR(w,t),o=t.spaceWidth*L,l=0,S=w.tokens,f=w.minColumn-1,g=0;for(let G=0,V=S.getCount();G<V;G++)if(g=S.getEndOffset(G),!(g<=f)){for(m=S.getMetadata(G),a=f;a<g&&!(a>uo.maxSupportedColumns);a++){if(n=E.getSegmentAtIndex(a),n===void 0)continue;i=n,w.isBasicASCII&&t.useMonospaceOptimizations||(o=this.glyphRasterizer.getTextMetrics(i).width),v=void 0,p=void 0,b=void 0;for(C of w.inlineDecorations){if(r<C.range.startLineNumber||r>C.range.endLineNumber||r===C.range.startLineNumber&&a<C.range.startColumn-1||r===C.range.endLineNumber&&a>=C.range.endColumn-1)continue;const $=Yo.decorationCssRuleExtractor.getStyleRules(this._viewGpuContext.canvas.domNode,C.inlineClassName);for(const Y of $)for(const se of Y.style){const j=((H=Y.styleMap.get(se))==null?void 0:H.toString())??"";switch(se){case"color":{const ie=re.Format.CSS.parse(j);if(!ie)throw new et("Invalid color format "+j);v=ie.toNumber32Bit();break}case"font-weight":{k5e(j)>=400?p=!0:p=!1;break}case"opacity":{b=D5e(j);break}default:throw new et("Unexpected inline decoration style")}}}if(i===" "||i==="	"){if(u=((r-1)*uo.maxSupportedColumns+a)*6,M.fill(0,u,u+6),i==="	"){const $=a+d;d=Ln.nextRenderTabStop(a+d,w.tabSize),l+=o*(d-$),d-=a+1}else l+=o;continue}const U=Yo.decorationStyleCache.getOrCreateEntry(v,p,b);h=this._viewGpuContext.atlas.getGlyph(this.glyphRasterizer,i,m,U,l),c=Math.round(e.relativeVerticalOffset[r-e.startLineNumber]*L+Math.floor((e.lineHeight*L-(h.fontBoundingBoxAscent+h.fontBoundingBoxDescent))/2)+h.fontBoundingBoxAscent),u=((r-1)*uo.maxSupportedColumns+a)*6,M[u+0]=Math.floor(l),M[u+1]=c,M[u+4]=h.glyphIndex,M[u+5]=h.pageIndex,l+=o}f=g}y=((r-1)*uo.maxSupportedColumns+g)*6,x=r*uo.maxSupportedColumns*6,M.fill(0,y,x),T.add(r)}}const W=(e.endLineNumber-e.startLineNumber+1)*R;return A=Math.min(A,uo.maxSupportedLines),N=Math.min(N,uo.maxSupportedLines),A<=N&&this._device.queue.writeBuffer(this._cellBindBuffer,(A-1)*R*Float32Array.BYTES_PER_ELEMENT,M.buffer,(A-1)*R*Float32Array.BYTES_PER_ELEMENT,(N-A+1)*R*Float32Array.BYTES_PER_ELEMENT),this._finalRenderedLine=Math.max(this._finalRenderedLine,N),this._activeDoubleBufferIndex=this._activeDoubleBufferIndex?0:1,this._visibleObjectCount=W,W}draw(e,t){if(this._visibleObjectCount<=0)throw new et("Attempt to draw 0 objects");e.draw(f_.length/2,this._visibleObjectCount,void 0,(t.startLineNumber-1)*uo.maxSupportedColumns)}_queueBufferUpdate(e){this._queuedBufferUpdates[0].push(e),this._queuedBufferUpdates[1].push(e)}};uo.maxSupportedLines=3e3,uo.maxSupportedColumns=200;let _p=uo;function k5e(s){switch(s){case"lighter":case"normal":return 400;case"bolder":case"bold":return 700}return parseInt(s)}function D5e(s){return s.endsWith("%")?parseFloat(s.substring(0,s.length-1))/100:s.match(/^\d+(?:\.\d*)/)?parseFloat(s):1}var T5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},pX=function(s,e){return function(t,i){e(t,i,s)}};let AB=class extends yr{constructor(e,t,i,n){super(e),this._viewGpuContext=t,this._instantiationService=i,this._logService=n,this._atlasGpuTextureVersions=[],this._initialized=!1,this._glyphRasterizer=this._register(new mi),this._renderStrategy=this._register(new mi),this.canvas=this._viewGpuContext.canvas.domNode,this._register(lt(o=>{this._viewGpuContext.canvasDevicePixelDimensions.read(o);const r=this._lastViewportData;r&&setTimeout(()=>{r===this._lastViewportData&&this.renderText(r)})})),this.initWebgpu()}async initWebgpu(){if(this._device=Yo.deviceSync||await Yo.device,this._store.isDisposed)return;const e=Yo.atlas;this._register(e.onDidDeleteGlyphs(()=>{this._atlasGpuTextureVersions.length=0,this._atlasGpuTextureVersions[0]=0,this._atlasGpuTextureVersions[1]=0,this._renderStrategy.value.reset()}));const t=navigator.gpu.getPreferredCanvasFormat();this._viewGpuContext.ctx.configure({device:this._device,format:t,alphaMode:"premultiplied"}),this._renderPassColorAttachment={view:null,loadOp:"load",storeOp:"store"},this._renderPassDescriptor={label:"Monaco render pass",colorAttachments:[this._renderPassColorAttachment]};let i;{const l=new Float32Array(6),c=(d=this.canvas.width,h=this.canvas.height)=>(l[0]=d,l[1]=h,l[2]=Math.ceil(this._context.configuration.options.get(165).contentLeft*xi().devicePixelRatio),l[3]=0,l[4]=l[0]-l[2],l[5]=l[1]-l[3],l);i=this._register(Mr.createBuffer(this._device,{label:"Monaco uniform buffer",size:24,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>c())).object,this._register(rd(this._viewGpuContext.canvasDevicePixelDimensions,({width:d,height:h})=>{this._device.queue.writeBuffer(i,0,c(d,h))})),this._register(rd(this._viewGpuContext.contentLeft,()=>{this._device.queue.writeBuffer(i,0,c())}))}let n;n=this._register(Mr.createBuffer(this._device,{label:"Monaco atlas info uniform buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST},()=>{const l=new Float32Array(2);return l[0]=e.pageSize,l[1]=e.pageSize,l})).object;const o=this._context.configuration.options.get(58),r=this._context.configuration.options.get(61);this._glyphRasterizer.value=this._register(new jL(r,o,this._viewGpuContext.devicePixelRatio.get(),Yo.decorationStyleCache)),this._register(rd(this._viewGpuContext.devicePixelRatio,()=>{this._refreshGlyphRasterizer()})),this._renderStrategy.value=this._instantiationService.createInstance(_p,this._context,this._viewGpuContext,this._device,this._glyphRasterizer),this._glyphStorageBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco glyph storage buffer",size:Sg.maximumPageCount*($c.maximumGlyphCount*24),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST})).object,this._atlasGpuTextureVersions[0]=0,this._atlasGpuTextureVersions[1]=0,this._atlasGpuTexture=this._register(Mr.createTexture(this._device,{label:"Monaco atlas texture",format:"rgba8unorm",size:{width:e.pageSize,height:e.pageSize,depthOrArrayLayers:Sg.maximumPageCount},dimension:"2d",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT})).object,this._updateAtlasStorageBufferAndTexture(),this._vertexBuffer=this._register(Mr.createBuffer(this._device,{label:"Monaco vertex buffer",size:f_.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST},f_)).object;const a=this._device.createShaderModule({label:"Monaco shader module",code:this._renderStrategy.value.wgsl});if(this._pipeline=this._device.createRenderPipeline({label:"Monaco render pipeline",layout:"auto",vertex:{module:a,buffers:[{arrayStride:2*Float32Array.BYTES_PER_ELEMENT,attributes:[{shaderLocation:0,offset:0,format:"float32x2"}]}]},fragment:{module:a,targets:[{format:t,blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"},alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha"}}}]}}),this._rebuildBindGroup=()=>{this._bindGroup=this._device.createBindGroup({label:"Monaco bind group",layout:this._pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._glyphStorageBuffer}},{binding:2,resource:this._device.createSampler({label:"Monaco atlas sampler",magFilter:"nearest",minFilter:"nearest"})},{binding:3,resource:this._atlasGpuTexture.createView()},{binding:4,resource:{buffer:i}},{binding:5,resource:{buffer:n}},...this._renderStrategy.value.bindGroupEntries]})},this._rebuildBindGroup(),this._initialized=!0,this._initViewportData){for(const l of this._initViewportData)this.renderText(l);this._initViewportData=void 0}}_refreshRenderStrategy(e){var i,n;if(((i=this._renderStrategy.value)==null?void 0:i.type)==="viewport"||e.endLineNumber<_p.maxSupportedLines&&this._viewportMaxColumn(e)<_p.maxSupportedColumns)return;this._logService.trace(`File is larger than ${_p.maxSupportedLines} lines or ${_p.maxSupportedColumns} columns, switching to viewport render strategy`);const t=this._instantiationService.createInstance(MB,this._context,this._viewGpuContext,this._device,this._glyphRasterizer);this._renderStrategy.value=t,this._register(t.onDidChangeBindGroupEntries(()=>{var o;return(o=this._rebuildBindGroup)==null?void 0:o.call(this)})),(n=this._rebuildBindGroup)==null||n.call(this)}_viewportMaxColumn(e){let t=0,i;for(let n=e.startLineNumber;n<=e.endLineNumber;n++)i=e.getViewLineRenderingData(n),t=Math.max(t,i.maxColumn);return t}_updateAtlasStorageBufferAndTexture(){for(const[e,t]of Yo.atlas.pages.entries()){if(e>=Sg.maximumPageCount){console.log(`Attempt to upload atlas page [${e}], only ${Sg.maximumPageCount} are supported currently`);continue}if(t.version===this._atlasGpuTextureVersions[e])continue;this._logService.trace("Updating atlas page[",e,"] from version ",this._atlasGpuTextureVersions[e]," to version ",t.version);const i=6*$c.maximumGlyphCount,n=new Float32Array(i);let o=0;for(const r of t.glyphs)n[o+0]=r.x,n[o+0+1]=r.y,n[o+2]=r.w,n[o+2+1]=r.h,n[o+4]=r.originOffsetX,n[o+4+1]=r.originOffsetY,o+=6;if(o/6>$c.maximumGlyphCount)throw new Error(`Attempting to write more glyphs (${o/6}) than the GPUBuffer can hold (${$c.maximumGlyphCount})`);this._device.queue.writeBuffer(this._glyphStorageBuffer,e*6*$c.maximumGlyphCount*Float32Array.BYTES_PER_ELEMENT,n,0,6*$c.maximumGlyphCount),t.usedArea.right-t.usedArea.left>0&&t.usedArea.bottom-t.usedArea.top>0&&this._device.queue.copyExternalImageToTexture({source:t.source},{texture:this._atlasGpuTexture,origin:{x:t.usedArea.left,y:t.usedArea.top,z:e}},{width:t.usedArea.right-t.usedArea.left+1,height:t.usedArea.bottom-t.usedArea.top+1}),this._atlasGpuTextureVersions[e]=t.version}}prepareRender(e){throw new et("Should not be called")}render(e){throw new et("Should not be called")}onConfigurationChanged(e){return this._refreshGlyphRasterizer(),!0}onCursorStateChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onLineMappingChanged(e){return!0}onRevealRangeRequest(e){return!0}onScrollChanged(e){return!0}onThemeChanged(e){return!0}onZonesChanged(e){return!0}_refreshGlyphRasterizer(){const e=this._glyphRasterizer.value;if(!e)return;const t=this._context.configuration.options.get(58),i=this._context.configuration.options.get(61),n=this._viewGpuContext.devicePixelRatio.get();(e.fontFamily!==t||e.fontSize!==i||e.devicePixelRatio!==n)&&(this._glyphRasterizer.value=new jL(i,t,n,Yo.decorationStyleCache))}renderText(e){if(this._initialized)return this._refreshRenderStrategy(e),this._renderText(e);this._initViewportData=this._initViewportData??[],this._initViewportData.push(e)}_renderText(e){this._viewGpuContext.rectangleRenderer.draw(e);const t=new ER(this._context.configuration,this._context.theme.type);this._renderStrategy.value.update(e,t),this._updateAtlasStorageBufferAndTexture();const i=this._device.createCommandEncoder({label:"Monaco command encoder"});this._renderPassColorAttachment.view=this._viewGpuContext.ctx.getCurrentTexture().createView({label:"Monaco canvas texture view"});const n=i.beginRenderPass(this._renderPassDescriptor);n.setPipeline(this._pipeline),n.setVertexBuffer(0,this._vertexBuffer);const o=Math.ceil(this._viewGpuContext.contentLeft.get()*this._viewGpuContext.devicePixelRatio.get());n.setScissorRect(o,0,this.canvas.width-o,this.canvas.height),n.setBindGroup(0,this._bindGroup),this._renderStrategy.value.draw(n,e),n.end();const r=i.finish();this._device.queue.submit([r]),this._lastViewportData=e,this._lastViewLineOptions=t}linesVisibleRangesForRange(e,t){if(!this._lastViewportData)return null;const i=e.endLineNumber,n=D.intersectRanges(e,this._lastViewportData.visibleRange);if(!n)return null;const o=this._lastViewportData.startLineNumber,r=this._lastViewportData.endLineNumber,a=this._lastViewportData,l=this._lastViewLineOptions;if(!a||!l)return null;const c=[];let d=0;t&&(d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(n.startLineNumber,1)).lineNumber);for(let h=n.startLineNumber;h<=n.endLineNumber;h++){if(h<o||h>r)continue;const u=h===n.startLineNumber?n.startColumn:1,f=h!==i,g=f?this._context.viewModel.getLineMaxColumn(h):n.endColumn,m=this._visibleRangesForLineRange(h,u,g);if(m){if(t&&h<i){const p=d;d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new z(h+1,1)).lineNumber,p!==d&&(m.ranges[m.ranges.length-1].width+=l.spaceWidth)}c.push(new Rre(m.outsideRenderedLine,h,bk.from(m.ranges),f))}}return c.length===0?null:c}_visibleRangesForLineRange(e,t,i){if(this.shouldRender())return null;const n=this._lastViewportData,o=this._lastViewLineOptions;if(!n||!o||e<n.startLineNumber||e>n.endLineNumber)return null;const r=n.getViewLineRenderingData(e),a=r.content;let l;r.isBasicASCII&&o.useMonospaceOptimizations||(l=AR(r,o));let c="",d=0,h=0;for(let m=0;m<t-1;m++){if(r.isBasicASCII&&o.useMonospaceOptimizations)c=a.charAt(m);else{if(c=l.getSegmentAtIndex(m),c===void 0)continue;h+=this._renderStrategy.value.glyphRasterizer.getTextMetrics(c).width/xi().devicePixelRatio-o.spaceWidth}c==="	"?d=Ln.nextRenderTabStop(d,r.tabSize):d++}let u=d,f=0;for(let m=t-1;m<i-1;m++){if(r.isBasicASCII&&o.useMonospaceOptimizations)c=a.charAt(m);else{if(c=l.getSegmentAtIndex(m),c===void 0)continue;f+=this._renderStrategy.value.glyphRasterizer.getTextMetrics(c).width/xi().devicePixelRatio-o.spaceWidth}c==="	"?u=Ln.nextRenderTabStop(u,r.tabSize):u++}return new bB(!1,[new Wg(d*o.spaceWidth+h,(u-d)*o.spaceWidth+f)])}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new Mre(t.outsideRenderedLine,t.ranges[0].left):null}getLineWidth(e){if(!this._lastViewportData||!this._lastViewLineOptions||!this._viewGpuContext.canRender(this._lastViewLineOptions,this._lastViewportData,e))return;const t=this._lastViewportData.getViewLineRenderingData(e),i=this._visibleRangesForLineRange(e,1,t.maxColumn),n=i==null?void 0:i.ranges.at(-1);if(n)return n.width}getPositionAtCoordinate(e,t){if(!this._lastViewportData||!this._lastViewLineOptions||!this._viewGpuContext.canRender(this._lastViewLineOptions,this._lastViewportData,e))return;const i=this._lastViewportData.getViewLineRenderingData(e),n=i.content,o=xi().devicePixelRatio,r=t*o,a=this._lastViewLineOptions.spaceWidth*o,l=AR(i,this._lastViewLineOptions);let c=0,d=0,h=0,u=0;for(let f=0;f<n.length;f++){const g=l.getSegmentAtIndex(f);if(g===void 0){u++;continue}if(g==="	"){const m=f+h;h=Ln.nextRenderTabStop(f+h,i.tabSize),d=a*(h-m),h-=f+1}else i.isBasicASCII&&this._lastViewLineOptions.useMonospaceOptimizations?d=a:d=this._renderStrategy.value.glyphRasterizer.getTextMetrics(g).width;if(r<c+d/2)break;c+=d,u++}return new z(e,u+1)}};AB=T5e([pX(2,$e),pX(3,Ji)],AB);class N5e{constructor(){this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const _h=new N5e,ai=Mt("keybindingService");class Cae extends yr{}class wae{_getPageOfLine(e,t){return Math.floor((e-1)/t)}_getRangeForPage(e,t){const i=e*t,n=i+1,o=i+t;return new D(n,1,o+1,1)}fromEditorSelection(e,t,i,n){const r=this._getPageOfLine(t.startLineNumber,i),a=this._getRangeForPage(r,i),l=this._getPageOfLine(t.endLineNumber,i),c=this._getRangeForPage(l,i);let d=a.intersectRanges(new D(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(d,1)>500){const w=e.modifyPosition(d.getEndPosition(),-500);d=D.fromPositions(w,d.getEndPosition())}const h=e.getValueInRange(d,1),u=e.getLineCount(),f=e.getLineMaxColumn(u);let g=c.intersectRanges(new D(t.endLineNumber,t.endColumn,u,f));if(n&&e.getValueLengthInRange(g,1)>500){const w=e.modifyPosition(g.getStartPosition(),500);g=D.fromPositions(g.getStartPosition(),w)}const m=e.getValueInRange(g,1);let p;if(r===l||r+1===l)p=e.getValueInRange(t,1);else{const w=a.intersectRanges(t),C=c.intersectRanges(t);p=e.getValueInRange(w,1)+"…"+e.getValueInRange(C,1)}n&&p.length>2*500&&(p=p.substring(0,500)+"…"+p.substring(p.length-500,p.length));let v,b;return t.getDirection()===0?(v=h.length,b=h.length+p.length):(b=h.length,v=h.length+p.length),{value:h+p+m,selection:t,selectionStart:v,selectionEnd:b,startPositionWithinEditor:d.getStartPosition(),newlineCountBeforeSelection:d.endLineNumber-d.startLineNumber}}}function PB(s,e){var i,n,o;if(s.get(2)===1){const r=(i=e.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))==null?void 0:i.getAriaLabel(),a=(n=e.lookupKeybinding("workbench.action.showCommands"))==null?void 0:n.getAriaLabel(),l=(o=e.lookupKeybinding("workbench.action.openGlobalKeybindings"))==null?void 0:o.getAriaLabel(),c=_(61,"The editor is not accessible at this time.");return r?_(62,"{0} To enable screen reader optimized mode, use {1}",c,r):a?_(63,"{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",c,a):l?_(64,"{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",c,l):c}return s.get(8)}function _X(s){let e=0,t=-1;do{if(t=s.indexOf(`
`,t+1),t===-1)break;e++}while(!0);return e}var R5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},bX=function(s,e){return function(t,i){e(t,i,s)}};class M5e{constructor(e,t,i,n,o){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=o,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new z(this.modelLineNumber,this.distanceToModelLineStart+1),i=new z(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const tF=Wr;let OB=class extends Cae{constructor(e,t,i,n,o,r){super(e),this._keybindingService=o,this._instantiationService=r,this._primaryCursorPosition=new z(1,1),this._primaryCursorVisibleRange=null,this._viewController=i,this._visibleRangeProvider=n,this._scrollLeft=0,this._scrollTop=0;const a=this._context.configuration.options,l=a.get(165);this._setAccessibilityOptions(a),this._contentLeft=l.contentLeft,this._contentWidth=l.contentWidth,this._contentHeight=l.height,this._fontInfo=a.get(59),this._emptySelectionClipboard=a.get(45),this._copyWithSyntaxHighlighting=a.get(31),this._visibleTextArea=null,this._selections=[new Oe(1,1,1,1)],this._modelSelections=[new Oe(1,1,1,1)],this._lastRenderPosition=null,this.textArea=gi(document.createElement("textarea")),dd.write(this.textArea,7),this.textArea.setClassName(`inputarea ${w1}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:c}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${c*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",PB(a,this._keybindingService)),this.textArea.setAttribute("aria-required",a.get(9)?"true":"false"),this.textArea.setAttribute("tabindex",String(a.get(140))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",_(65,"editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",a.get(104)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=gi(document.createElement("div")),this.textAreaCover.setPosition("absolute"),t.appendChild(this.textArea),t.appendChild(this.textAreaCover);const d=new wae,h={getDataToCopy:()=>Ure(this._context.viewModel,this._modelSelections,this._emptySelectionClipboard,this._copyWithSyntaxHighlighting),getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const g=this._selections[0];if(Bt&&g.isEmpty()){const p=g.getStartPosition();let v=this._getWordBeforePosition(p);if(v.length===0&&(v=this._getCharacterBeforePosition(p)),v.length>0)return new qo(v,v.length,v.length,D.fromPositions(p),0)}if(Bt&&!g.isEmpty()&&this._context.viewModel.getValueLengthInRange(g,0)<500){const p=this._context.viewModel.getValueInRange(g,0);return new qo(p,0,p.length,g,0)}if(Eb&&!g.isEmpty()){const p="vscode-placeholder";return new qo(p,0,p.length,null,void 0)}return qo.EMPTY}if(NG){const g=this._selections[0];if(g.isEmpty()){const m=g.getStartPosition(),[p,v]=this._getAndroidWordAtPosition(m);if(p.length>0)return new qo(p,v,v,D.fromPositions(m),0)}return qo.EMPTY}const f=d.fromEditorSelection(this._context.viewModel,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0);return qo.fromScreenReaderContentState(f)},deduceModelPosition:(f,g,m)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(f,g,m)},u=this._register(new rOe(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(yB,h,u,sa,{isAndroid:NG,isChrome:ik,isFirefox:Wr,isSafari:Eb})),this._register(this._textAreaInput.onKeyDown(f=>{this._viewController.emitKeyDown(f)})),this._register(this._textAreaInput.onKeyUp(f=>{this._viewController.emitKeyUp(f)})),this._register(this._textAreaInput.onPaste(f=>{let g=!1,m=null,p=null;f.metadata&&(g=this._emptySelectionClipboard&&!!f.metadata.isFromEmptySelection,m=typeof f.metadata.multicursorText<"u"?f.metadata.multicursorText:null,p=f.metadata.mode),this._viewController.paste(f.text,g,m,p)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(f=>{f.replacePrevCharCnt||f.replaceNextCharCnt||f.positionDelta?this._viewController.compositionType(f.text,f.replacePrevCharCnt,f.replaceNextCharCnt,f.positionDelta):this._viewController.type(f.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(f=>{this._viewController.setSelection(f)})),this._register(this._textAreaInput.onCompositionStart(f=>{const g=this.textArea.domNode,m=this._modelSelections[0],{distanceToModelLineStart:p,widthOfHiddenTextBefore:v}=(()=>{const w=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),C=w.lastIndexOf(`
`),y=w.substring(C+1),x=y.lastIndexOf("	"),S=y.length-x-1,L=m.getStartPosition(),E=Math.min(L.column-1,S),M=L.column-1-E,R=y.substring(0,y.length-E),{tabSize:T}=this._context.viewModel.model.getOptions(),A=A5e(this.textArea.domNode.ownerDocument,R,this._fontInfo,T);return{distanceToModelLineStart:M,widthOfHiddenTextBefore:A}})(),{distanceToModelLineEnd:b}=(()=>{const w=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),C=w.indexOf(`
`),y=C===-1?w:w.substring(0,C),x=y.indexOf("	"),S=x===-1?y.length:y.length-x-1,L=m.getEndPosition(),E=Math.min(this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column,S);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column-E}})();this._context.viewModel.revealRange("keyboard",!0,D.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new M5e(this._context,m.startLineNumber,p,v,b),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${w1} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(f=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${w1}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(_h.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}get domNode(){return this.textArea}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose(),this.textArea.domNode.remove(),this.textAreaCover.domNode.remove()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),n=Bl(t,[]);let o=!0,r=e.column,a=!0,l=e.column,c=0;for(;c<50&&(o||a);){if(o&&r<=1&&(o=!1),o){const d=i.charCodeAt(r-2);n.get(d)!==0?o=!1:r--}if(a&&l>i.length&&(a=!1),a){const d=i.charCodeAt(l-1);n.get(d)!==0?a=!1:l++}c++}return[i.substring(r-1,l-1),e.column-r]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=Bl(this._context.configuration.options.get(148),[]);let n=e.column,o=0;for(;n>1;){const r=t.charCodeAt(n-2);if(i.get(r)!==0||o>50)return t.substring(n-1,e.column-1);o++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!vs(i.charCodeAt(0)))return i}return""}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===Go.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const n=e.get(165).wrappingColumn;if(n!==-1&&this._accessibilitySupport!==1){const o=e.get(59);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(n*o.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=tF?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(165);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(59),this._emptySelectionClipboard=t.get(45),this._copyWithSyntaxHighlighting=t.get(31),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:n}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${n*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",PB(t,this._keybindingService)),this.textArea.setAttribute("aria-required",t.get(9)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(140))),(e.hasChanged(41)||e.hasChanged(104))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focus(){this._textAreaInput.focusTextArea()}refreshFocusState(){this._textAreaInput.refreshFocusState()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!_h.enabled||e.get(41)&&e.get(104)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){var t;this._primaryCursorPosition=new z(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),(t=this._visibleTextArea)==null||t.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const i=this._visibleTextArea.visibleTextareaStart,n=this._visibleTextArea.visibleTextareaEnd,o=this._visibleTextArea.startPosition,r=this._visibleTextArea.endPosition;if(o&&r&&i&&n&&n.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){const a=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,l=_X(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let c=this._visibleTextArea.widthOfHiddenLineTextBefore,d=this._contentLeft+i.left-this._scrollLeft,h=n.left-i.left+1;if(d<this._contentLeft){const w=this._contentLeft-d;d+=w,c+=w,h-=w}h>this._contentWidth&&(h=this._contentWidth);const u=this._context.viewLayout.getLineHeightForLineNumber(o.lineNumber),f=this._context.viewModel.getFontSizeAtPosition(this._primaryCursorPosition),g=this._context.viewModel.getViewLineData(o.lineNumber),m=g.tokens.findTokenIndexAtOffset(o.column-1),p=g.tokens.findTokenIndexAtOffset(r.column-1),v=m===p,b=this._visibleTextArea.definePresentation(v?g.tokens.getPresentation(m):null);this.textArea.domNode.scrollTop=l*u,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:a,left:d,width:h,height:u,useCover:!1,color:(An.getColorMap()||[])[b.foreground],italic:b.italic,bold:b.bold,underline:b.underline,strikethrough:b.strikethrough,fontSize:f})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(Bt||this._accessibilitySupport===2){const i=this._primaryCursorPosition.lineNumber,n=this._context.viewLayout.getLineHeightForLineNumber(i);this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:n,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const o=this._textAreaInput.textAreaState.newlineCountBeforeSelection??_X(this.textArea.domNode.value.substring(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=o*n;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:tF?0:1,useCover:!1})}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:tF?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;js(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setLineHeight(e.height),t.setFontSize(e.fontSize??this._fontInfo.fontSize),t.setColor(e.color?re.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(66)?i.setClassName("monaco-editor-background textAreaCover "+kR.OUTER_CLASS_NAME):n.get(76).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+IR.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};OB=R5e([bX(4,ai),bX(5,$e)],OB);function A5e(s,e,t,i){if(e.length===0)return 0;const n=s.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const o=s.createElement("span");js(o,t),o.style.whiteSpace="pre",o.style.tabSize=`${i*t.spaceWidth}px`,o.append(e),n.appendChild(o),s.body.appendChild(n);const r=o.offsetWidth;return n.remove(),r}var P5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},O5e=function(s,e){return function(t,i){e(t,i,s)}};let FB=class extends K{constructor(e,t,i){super(),this._domNode=t,this._onFocusChange=i,this._isFocused=!1,this._isPaused=!1,this._register(ee(this._domNode,"focus",()=>{e.trace("NativeEditContext.focus"),!this._isPaused&&this.refreshFocusState()})),this._register(ee(this._domNode,"blur",()=>{e.trace("NativeEditContext.blur"),!this._isPaused&&this._handleFocusedChanged(!1)}))}pause(){this._isPaused=!0}resume(){this._isPaused=!1,this.refreshFocusState()}_handleFocusedChanged(e){this._isFocused!==e&&(this._isFocused=e,this._onFocusChange(this._isFocused))}focus(){this._domNode.focus(),this.refreshFocusState()}refreshFocusState(){const e=fm(this._domNode),t=e?e.activeElement:Ss(),i=this._domNode===t;this._handleFocusedChanged(i)}get isFocused(){return this._isFocused}};FB=P5e([O5e(0,Ji)],FB);function B0(s,e,t,i){return s.addEventListener(e,t,i),{dispose(){s.removeEventListener(e,t)}}}var F5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},B5e=function(s,e){return function(t,i){e(t,i,s)}};const iF=Oh("richScreenReaderContent",{createHTML:s=>s}),nF="data-line-number";let BB=class extends K{constructor(e,t,i,n){super(),this._domNode=e,this._context=t,this._viewController=i,this._accessibilityService=n,this._selectionChangeListener=this._register(new mi),this._accessibilityPageSize=1,this._ignoreSelectionChangeTime=0,this._state=GL.NULL,this._strategy=new V5e,this._renderedLines=new Map,this._renderedSelection=new Oe(1,1,1,1),this.onConfigurationChanged(this._context.configuration.options)}updateScreenReaderContent(e){const t=xi().document.activeElement;if(!t||t!==this._domNode.domNode)return;if(this._accessibilityService.isScreenReaderOptimized()){const n=this._getScreenReaderContentLineIntervals(e);this._state.equals(n)||(this._state=n,this._renderedLines=this._renderScreenReaderContent(n)),this._renderedSelection.equalsSelection(e)||(this._renderedSelection=e,this._setSelectionOnScreenReaderContent(this._context,this._renderedLines,e))}else this._state=GL.NULL,this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.textContent=""}updateScrollTop(e){const t=this._state.intervals;if(!t.length)return;const i=this._context.viewModel.viewLayout,n=t[0].startLine,o=i.getVerticalOffsetForLineNumber(n),r=i.getVerticalOffsetForLineNumber(e.positionLineNumber);this._domNode.domNode.scrollTop=r-o}onFocusChange(e){e?this._selectionChangeListener.value=this._setSelectionChangeListener():this._selectionChangeListener.value=void 0}onConfigurationChanged(e){this._accessibilityPageSize=e.get(3)}onWillCut(){this._setIgnoreSelectionChangeTime("onCut")}onWillPaste(){this._setIgnoreSelectionChangeTime("onWillPaste")}_setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}_setSelectionChangeListener(){let e=0;return ee(this._domNode.domNode.ownerDocument,"selectionchange",()=>{if(!(xi().document.activeElement===this._domNode.domNode)||!this._accessibilityService.isScreenReaderOptimized()||!_h.enabled)return;const o=Date.now(),r=o-e;if(e=o,r<5)return;const a=o-this._ignoreSelectionChangeTime;if(this._ignoreSelectionChangeTime=0,a<100)return;const l=this._getEditorSelectionFromDomRange();l&&this._viewController.setSelection(l)})}_renderScreenReaderContent(e){const t=[],i=new Map;for(const n of e.intervals)for(let o=n.startLine;o<=n.endLine;o++){const r=this._renderLine(o);i.set(o,r),t.push(r.domNode)}return this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.replaceChildren(...t),i}_renderLine(e){const t=this._context.viewModel,i=t.getViewLineRenderingData(e),n=this._context.configuration.options,o=n.get(59),r=n.get(133),a=n.get(108),l=n.get(60),c=n.get(40),d=Qo.filter(i.inlineDecorations,e,i.minColumn,i.maxColumn),h=o.isMonospace&&!c,u=l!==gf.OFF;let f;n.get(47)==="off"?f=n.get(113):f="none";const m=new kf(h,o.canUseHalfwidthRightwardsArrow,i.content,i.continuesWithWrappedLine,i.isBasicASCII,i.containsRTL,i.minColumn-1,i.tokens,d,i.tabSize,i.startVisibleColumn,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,r,f,a,u,null,null,0,!0),p=new Dm(1e4),v=h0(m,p),b=p.build(),w=(iF==null?void 0:iF.createHTML(b))??b,C=t.viewLayout.getLineHeightForLineNumber(e)+"px",y=document.createElement("div");return y.innerHTML=w,y.style.lineHeight=C,y.style.height=C,y.setAttribute(nF,e.toString()),new W5e(y,v.characterMapping)}_setSelectionOnScreenReaderContent(e,t,i){const o=xi().document.getSelection();if(!o)return;const r=i.startLineNumber,a=i.endLineNumber,l=t.get(r),c=t.get(a);if(!l||!c)return;const d=e.viewModel,h=d.model,u=d.coordinatesConverter,f=new D(r,1,r,i.selectionStartColumn),g=u.convertViewRangeToModelRange(f),m=h.getCharacterCountInRange(g),p=new D(a,1,a,i.positionColumn),v=u.convertViewRangeToModelRange(p),b=h.getCharacterCountInRange(v),w=l.characterMapping.getDomPosition(m),C=c.characterMapping.getDomPosition(b),y=l.domNode.firstChild,x=c.domNode.firstChild,S=y.childNodes,L=x.childNodes,E=S.item(w.partIndex),M=L.item(C.partIndex);!E.firstChild||!M.firstChild||(this._setIgnoreSelectionChangeTime("setRange"),o.setBaseAndExtent(E.firstChild,i.startColumn===1?0:w.charIndex+1,M.firstChild,i.endColumn===1?0:C.charIndex+1))}_getScreenReaderContentLineIntervals(e){return this._strategy.fromEditorSelection(this._context.viewModel,e,this._accessibilityPageSize)}_getEditorSelectionFromDomRange(){var b,w,C,y;if(!this._renderedLines)return;const e=xi().document.getSelection();if(!e||e.rangeCount===0)return;const i=e.getRangeAt(0),n=i.startContainer,o=i.endContainer,r=n.parentElement,a=o.parentElement;if(!r||!Bn(r)||!a||!Bn(a))return;const l=(b=r.parentElement)==null?void 0:b.parentElement,c=(w=a.parentElement)==null?void 0:w.parentElement;if(!l||!c)return;const d=l.getAttribute(nF),h=c.getAttribute(nF);if(!d||!h)return;const u=parseInt(d),f=parseInt(h),g=(C=this._renderedLines.get(u))==null?void 0:C.characterMapping,m=(y=this._renderedLines.get(f))==null?void 0:y.characterMapping;if(!g||!m)return;const p=xw(g,r,i.startOffset),v=xw(m,a,i.endOffset);return e.direction==="forward"?new Oe(u,p,f,v):new Oe(f,v,u,p)}};BB=F5e([B5e(3,so)],BB);class W5e{constructor(e,t){this.domNode=e,this.characterMapping=t}}class H5e{constructor(e,t){this.startLine=e,this.endLine=t}}class GL{constructor(e,t){this.intervals=t;let i="";for(const n of t)for(let o=n.startLine;o<=n.endLine;o++)i+=e.getLineContent(o)+`
`;this.value=i}equals(e){return this.value===e.value}static get NULL(){const e={getLineContent:()=>"",getLineCount:()=>1,getLineMaxColumn:()=>1,getValueInRange:()=>"",getValueLengthInRange:()=>0,modifyPosition:(t,i)=>t};return new GL(e,[])}}class V5e{constructor(){}_getPageOfLine(e,t){return Math.floor((e-1)/t)}_getRangeForPage(e,t,i){const n=t*i,o=n+1,r=Math.min(n+i,e.getLineCount());return new H5e(o,r)}fromEditorSelection(e,t,i){const n=this._getPageOfLine(t.startLineNumber,i),o=this._getRangeForPage(e,n,i),r=this._getPageOfLine(t.endLineNumber,i),a=this._getRangeForPage(e,r,i),l=[{startLine:o.startLine,endLine:o.endLine}];return n+1<r&&l.push({startLine:a.startLine,endLine:a.endLine}),new GL(e,l)}}class z5e{constructor(e){this.replacements=e;let t=-1;for(const i of e){if(!(i.replaceRange.start>=t))throw new et(`Edits must be disjoint and sorted. Found ${i} after ${t}`);t=i.replaceRange.endExclusive}}toString(){return`[${this.replacements.map(t=>t.toString()).join(", ")}]`}normalize(){const e=[];let t;for(const i of this.replacements)if(!(i.getNewLength()===0&&i.replaceRange.length===0)){if(t&&t.replaceRange.endExclusive===i.replaceRange.start){const n=t.tryJoinTouching(i);if(n){t=n;continue}}t&&e.push(t),t=i}return t&&e.push(t),this._createNew(e)}compose(e){const t=this.normalize(),i=e.normalize();if(t.isEmpty())return i;if(i.isEmpty())return t;const n=[...t.replacements],o=[];let r=0;for(const a of i.replacements){for(;;){const h=n[0];if(!h||h.replaceRange.start+r+h.getNewLength()>=a.replaceRange.start)break;n.shift(),o.push(h),r+=h.getNewLength()-h.replaceRange.length}const l=r;let c,d;for(;;){const h=n[0];if(!h||h.replaceRange.start+r>a.replaceRange.endExclusive)break;c||(c=h),d=h,n.shift(),r+=h.getNewLength()-h.replaceRange.length}if(!c)o.push(a.delta(-r));else{const h=Math.min(c.replaceRange.start,a.replaceRange.start-l),u=a.replaceRange.start-(c.replaceRange.start+l);if(u>0){const p=c.slice(Ue.emptyAt(h),new Ue(0,u));o.push(p)}if(!d)throw new et("Invariant violation: lastIntersecting is undefined");const f=d.replaceRange.endExclusive+r-a.replaceRange.endExclusive;if(f>0){const p=d.slice(Ue.ofStartAndLength(d.replaceRange.endExclusive,0),new Ue(d.getNewLength()-f,d.getNewLength()));n.unshift(p),r-=p.getNewLength()-p.replaceRange.length}const g=new Ue(h,a.replaceRange.endExclusive-r),m=a.slice(g,new Ue(0,a.getNewLength()));o.push(m)}}for(;;){const a=n.shift();if(!a)break;o.push(a)}return this._createNew(o).normalize()}getNewRanges(){const e=[];let t=0;for(const i of this.replacements)e.push(Ue.ofStartAndLength(i.replaceRange.start+t,i.getNewLength())),t+=i.getLengthDelta();return e}isEmpty(){return this.replacements.length===0}}class U5e{constructor(e){this.replaceRange=e}delta(e){return this.slice(this.replaceRange.delta(e),new Ue(0,this.getNewLength()))}getLengthDelta(){return this.getNewLength()-this.replaceRange.length}toString(){return`{ ${this.replaceRange.toString()} -> ${this.getNewLength()} }`}get isEmpty(){return this.getNewLength()===0&&this.replaceRange.length===0}getRangeAfterReplace(){return new Ue(this.replaceRange.start,this.replaceRange.start+this.getNewLength())}}class $5e extends z5e{apply(e){const t=[];let i=0;for(const n of this.replacements)t.push(e.substring(i,n.replaceRange.start)),t.push(n.newText),i=n.replaceRange.endExclusive;return t.push(e.substring(i)),t.join("")}}class q5e extends U5e{constructor(e,t){super(e),this.newText=t}getNewLength(){return this.newText.length}toString(){return`${this.replaceRange} -> ${JSON.stringify(this.newText)}`}replace(e){return e.substring(0,this.replaceRange.start)+this.newText+e.substring(this.replaceRange.endExclusive)}removeCommonSuffixPrefix(e){const t=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),i=mc(t,this.newText),n=Math.min(t.length-i,this.newText.length-i,df(t,this.newText)),o=new Ue(this.replaceRange.start+i,this.replaceRange.endExclusive-n),r=this.newText.substring(i,this.newText.length-n);return new to(o,r)}removeCommonSuffixAndPrefix(e){return this.removeCommonSuffix(e).removeCommonPrefix(e)}removeCommonPrefix(e){const t=this.replaceRange.substring(e),i=mc(t,this.newText);return i===0?this:this.slice(this.replaceRange.deltaStart(i),new Ue(i,this.newText.length))}removeCommonSuffix(e){const t=this.replaceRange.substring(e),i=df(t,this.newText);return i===0?this:this.slice(this.replaceRange.deltaEnd(-i),new Ue(0,this.newText.length-i))}toJson(){return{txt:this.newText,pos:this.replaceRange.start,len:this.replaceRange.length}}}const e1=class e1 extends $5e{static compose(e){if(e.length===0)return e1.empty;let t=e[0];for(let i=1;i<e.length;i++)t=t.compose(e[i]);return t}constructor(e){super(e)}_createNew(e){return new e1(e)}};e1.empty=new e1([]);let bf=e1;class to extends q5e{static insert(e,t){return new to(Ue.emptyAt(e),t)}static replace(e,t){return new to(e,t)}equals(e){return this.replaceRange.equals(e.replaceRange)&&this.newText===e.newText}tryJoinTouching(e){return new to(this.replaceRange.joinRightTouching(e.replaceRange),this.newText+e.newText)}slice(e,t){return new to(e,t?t.substring(this.newText):this.newText)}}function yae(s,e){s=s.slice();const t=[];let i=0;for(const n of e.replacements){for(;;){const r=s[0];if(!r||r.endExclusive>=n.replaceRange.start)break;s.shift(),t.push(r.delta(i))}const o=[];for(;;){const r=s[0];if(!r||!r.intersectsOrTouches(n.replaceRange))break;s.shift(),o.push(r)}for(let r=o.length-1;r>=0;r--){let a=o[r];const l=a.intersect(n.replaceRange).length;a=a.deltaEnd(-l+(r===0?n.newText.length:0));const c=a.start-n.replaceRange.start;c>0&&(a=a.delta(-c)),r!==0&&(a=a.delta(n.newText.length)),a=a.delta(-(n.newText.length-n.replaceRange.length)),s.unshift(a)}i+=n.newText.length-n.replaceRange.length}for(;;){const n=s[0];if(!n)break;s.shift(),t.push(n.delta(i))}return t}const al=class al{static ofLength(e,t){return new al(e,e+t)}static fromRange(e){return new al(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new al(e.startLineNumber,e.endLineNumber+1)}static joinMany(e){if(e.length===0)return[];let t=new Sl(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new Sl(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new et("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new al(t,i)}static deserialize(e){return new al(e[0],e[1])}constructor(e,t){if(e>t)throw new et(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new al(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new al(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new al(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new al(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}intersectsOrTouches(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new D(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new D(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}toOffsetRange(){return new Ue(this.startLineNumber-1,this.endLineNumberExclusive-1)}addMargin(e,t){return new al(this.startLineNumber-e,this.endLineNumberExclusive+t)}};al.compareByStart=wo(e=>e.startLineNumber,aa);let dt=al;class Sl{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=WL(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=Dw(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{const n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){const t=kw(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){const t=kw(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,n=0,o=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let r=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(r=a,i++):(r=l,n++)}else i<this._normalizedRanges.length?(r=this._normalizedRanges[i],i++):(r=e._normalizedRanges[n],n++);o===null?o=r:o.endLineNumberExclusive>=r.startLineNumber?o=new dt(o.startLineNumber,Math.max(o.endLineNumberExclusive,r.endLineNumberExclusive)):(t.push(o),o=r)}return o!==null&&t.push(o),new Sl(t)}subtractFrom(e){const t=WL(this._normalizedRanges,r=>r.endLineNumberExclusive>=e.startLineNumber),i=Dw(this._normalizedRanges,r=>r.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new Sl([e]);const n=[];let o=e.startLineNumber;for(let r=t;r<i;r++){const a=this._normalizedRanges[r];a.startLineNumber>o&&n.push(new dt(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<e.endLineNumberExclusive&&n.push(new dt(o,e.endLineNumberExclusive)),new Sl(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){const o=this._normalizedRanges[i],r=e._normalizedRanges[n],a=o.intersect(r);a&&!a.isEmpty&&t.push(a),o.endLineNumberExclusive<r.endLineNumberExclusive?i++:n++}return new Sl(t)}getWithDelta(e){return new Sl(this._normalizedRanges.map(t=>t.delta(e)))}}const Mc=class Mc{static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new Mc(0,t.column-e.column):new Mc(t.lineNumber-e.lineNumber,t.column-1)}static fromPosition(e){return new Mc(e.lineNumber-1,e.column-1)}static ofRange(e){return Mc.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(const n of e)n===`
`?(t++,i=0):i++;return new Mc(t,i)}constructor(e,t){this.lineCount=e,this.columnCount=t}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}add(e){return e.lineCount===0?new Mc(this.lineCount,this.columnCount+e.columnCount):new Mc(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new D(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new D(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new D(1,1,this.lineCount+1,this.columnCount+1)}toLineRange(){return dt.ofLength(1,this.lineCount+1)}addToPosition(e){return this.lineCount===0?new z(e.lineNumber,e.column+this.columnCount):new z(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};Mc.zero=new Mc(0,0);let xs=Mc;class Sae{getOffsetRange(e){return new Ue(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getRange(e){return D.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getStringReplacement(e){return new g_.deps.StringReplacement(this.getOffsetRange(e.range),e.text)}getTextReplacement(e){return new g_.deps.TextReplacement(this.getRange(e.replaceRange),e.newText)}getTextEdit(e){const t=e.replacements.map(i=>this.getTextReplacement(i));return new g_.deps.TextEdit(t)}}const pK=class pK{static get deps(){if(!this._deps)throw new Error("Dependencies not set. Call _setDependencies first.");return this._deps}};pK._deps=void 0;let g_=pK;function j5e(s){g_._deps=s}class s4 extends Sae{constructor(e){super(),this.text=e,this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&(this.lineStartOffsetByLineIdx.push(t+1),t>0&&e.charAt(t-1)==="\r"?this.lineEndOffsetByLineIdx.push(t-1):this.lineEndOffsetByLineIdx.push(t));this.lineEndOffsetByLineIdx.push(e.length)}getOffset(e){const t=this._validatePosition(e);return this.lineStartOffsetByLineIdx[t.lineNumber-1]+t.column-1}_validatePosition(e){if(e.lineNumber<1)return new z(1,1);const t=this.textLength.lineCount+1;if(e.lineNumber>t){const n=this.getLineLength(t);return new z(t,n+1)}if(e.column<1)return new z(e.lineNumber,1);const i=this.getLineLength(e.lineNumber);return e.column-1>i?new z(e.lineNumber,i+1):e}getPosition(e){const t=Dw(this.lineStartOffsetByLineIdx,o=>o<=e),i=t+1,n=e-this.lineStartOffsetByLineIdx[t]+1;return new z(i,n)}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new g_.deps.TextLength(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}}class E${constructor(){this._transformer=void 0}get endPositionExclusive(){return this.length.addToPosition(new z(1,1))}get lineRange(){return this.length.toLineRange()}getValue(){return this.getValueOfRange(this.length.toRange())}getValueOfOffsetRange(e){return this.getValueOfRange(this.getTransformer().getRange(e))}getLineLength(e){return this.getValueOfRange(new D(e,1,e,Number.MAX_SAFE_INTEGER)).length}getTransformer(){return this._transformer||(this._transformer=new s4(this.getValue())),this._transformer}getLineAt(e){return this.getValueOfRange(new D(e,1,e,Number.MAX_SAFE_INTEGER))}}class K5e extends E${constructor(e,t){uL(t>=1),super(),this._getLineContent=e,this._lineCount=t}getValueOfRange(e){if(e.startLineNumber===e.endLineNumber)return this._getLineContent(e.startLineNumber).substring(e.startColumn-1,e.endColumn-1);let t=this._getLineContent(e.startLineNumber).substring(e.startColumn-1);for(let i=e.startLineNumber+1;i<e.endLineNumber;i++)t+=`
`+this._getLineContent(i);return t+=`
`+this._getLineContent(e.endLineNumber).substring(0,e.endColumn-1),t}getLineLength(e){return this._getLineContent(e).length}get length(){const e=this._getLineContent(this._lineCount);return new xs(this._lineCount-1,e.length)}}class fD extends K5e{constructor(e){super(t=>e[t-1],e.length)}}class xg extends E${constructor(e){super(),this.value=e,this._t=new s4(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}getTransformer(){return this._t}}class ra{static fromStringEdit(e,t){const i=e.replacements.map(n=>os.fromStringReplacement(n,t));return new ra(i)}static fromParallelReplacementsUnsorted(e){const t=e.slice().sort(wo(i=>i.range,D.compareRangesUsingStarts));return new ra(t)}constructor(e){this.replacements=e,dm(()=>sk(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}mapPosition(e){let t=0,i=0,n=0;for(const o of this.replacements){const r=o.range.getStartPosition();if(e.isBeforeOrEqual(r))break;const a=o.range.getEndPosition(),l=xs.ofText(o.text);if(e.isBefore(a)){const c=new z(r.lineNumber+t,r.column+(r.lineNumber+t===i?n:0)),d=l.addToPosition(c);return gD(c,d)}r.lineNumber+t!==i&&(n=0),t+=l.lineCount-(o.range.endLineNumber-o.range.startLineNumber),l.lineCount===0?a.lineNumber!==r.lineNumber?n+=l.columnCount-(a.column-1):n+=l.columnCount-(a.column-r.column):n=l.columnCount,i=a.lineNumber+t}return new z(e.lineNumber+t,e.column+(e.lineNumber+t===i?n:0))}mapRange(e){function t(r){return r instanceof z?r:r.getStartPosition()}function i(r){return r instanceof z?r:r.getEndPosition()}const n=t(this.mapPosition(e.getStartPosition())),o=i(this.mapPosition(e.getEndPosition()));return gD(n,o)}apply(e){let t="",i=new z(1,1);for(const o of this.replacements){const r=o.range,a=r.getStartPosition(),l=r.getEndPosition(),c=gD(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=o.text,i=l}const n=gD(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){const t=new xg(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,n=0;for(const o of this.replacements){const r=xs.ofText(o.text),a=z.lift({lineNumber:o.range.startLineNumber+i,column:o.range.startColumn+(o.range.startLineNumber===t?n:0)}),l=r.createRange(a);e.push(l),i=l.endLineNumber-o.range.endLineNumber,n=l.endColumn-o.range.endColumn,t=o.range.endLineNumber}return e}toReplacement(e){if(this.replacements.length===0)throw new et;if(this.replacements.length===1)return this.replacements[0];const t=this.replacements[0].range.getStartPosition(),i=this.replacements[this.replacements.length-1].range.getEndPosition();let n="";for(let o=0;o<this.replacements.length;o++){const r=this.replacements[o];if(n+=r.text,o<this.replacements.length-1){const a=this.replacements[o+1],l=D.fromPositions(r.range.getEndPosition(),a.range.getStartPosition()),c=e.getValueOfRange(l);n+=c}}return new os(D.fromPositions(t,i),n)}toString(e){return e===void 0?this.replacements.map(t=>t.toString()).join(`
`):typeof e=="string"?this.toString(new xg(e)):this.replacements.length===0?"":this.replacements.map(t=>{const n=e.getValueOfRange(t.range),o=D.fromPositions(new z(Math.max(1,t.range.startLineNumber-1),1),t.range.getStartPosition());let r=e.getValueOfRange(o);r.length>10&&(r="..."+r.substring(r.length-10));const a=D.fromPositions(t.range.getEndPosition(),new z(t.range.endLineNumber+1,1));let l=e.getValueOfRange(a);l.length>10&&(l=l.substring(0,10)+"...");let c=n;if(c.length>10){const h=Math.floor(5);c=c.substring(0,h)+"..."+c.substring(c.length-h)}let d=t.text;if(d.length>10){const h=Math.floor(5);d=d.substring(0,h)+"..."+d.substring(d.length-h)}return c.length===0?`${r}❰${d}❱${l}`:`${r}❰${c}↦${d}❱${l}`}).join(`
`)}}class os{static joinReplacements(e,t){if(e.length===0)throw new et;if(e.length===1)return e[0];const i=e[0].range.getStartPosition(),n=e[e.length-1].range.getEndPosition();let o="";for(let r=0;r<e.length;r++){const a=e[r];if(o+=a.text,r<e.length-1){const l=e[r+1],c=D.fromPositions(a.range.getEndPosition(),l.range.getStartPosition()),d=t.getValueOfRange(c);o+=d}}return new os(D.fromPositions(i,n),o)}static fromStringReplacement(e,t){return new os(t.getTransformer().getRange(e.replaceRange),e.newText)}static delete(e){return new os(e,"")}constructor(e,t){this.range=e,this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}equals(e){return os.equals(this,e)}removeCommonPrefixAndSuffix(e){return this.removeCommonPrefix(e).removeCommonSuffix(e)}removeCommonPrefix(e){const t=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=this.text.replaceAll(`\r
`,`
`),n=mc(t,i),o=xs.ofText(t.substring(0,n)).addToPosition(this.range.getStartPosition()),r=i.substring(n),a=D.fromPositions(o,this.range.getEndPosition());return new os(a,r)}removeCommonSuffix(e){const t=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=this.text.replaceAll(`\r
`,`
`),n=df(t,i),o=xs.ofText(t.substring(0,t.length-n)).addToPosition(this.range.getStartPosition()),r=i.substring(0,i.length-n),a=D.fromPositions(this.range.getStartPosition(),o);return new os(a,r)}toString(){const e=this.range.getStartPosition(),t=this.range.getEndPosition();return`(${e.lineNumber},${e.column} -> ${t.lineNumber},${t.column}): "${this.text}"`}}function gD(s,e){if(s.lineNumber===e.lineNumber&&s.column===Number.MAX_SAFE_INTEGER)return D.fromPositions(e,e);if(!s.isBeforeOrEqual(e))throw new et("start must be before end");return new D(s.lineNumber,s.column,e.lineNumber,e.column)}j5e({StringEdit:bf,StringReplacement:to,TextReplacement:os,TextEdit:ra,TextLength:xs});var G5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Y5e=function(s,e){return function(t,i){e(t,i,s)}};let WB=class extends K{constructor(e,t,i,n){super(),this._domNode=e,this._context=t,this._viewController=i,this._accessibilityService=n,this._selectionChangeListener=this._register(new mi),this._accessibilityPageSize=1,this._ignoreSelectionChangeTime=0,this._strategy=new wae,this.onConfigurationChanged(this._context.configuration.options)}updateScreenReaderContent(e){const t=this._domNode.domNode,i=xi().document.activeElement;if(!i||i!==t)return;if(this._accessibilityService.isScreenReaderOptimized()){this._state=this._getScreenReaderContentState(e),t.textContent!==this._state.value&&(this._setIgnoreSelectionChangeTime("setValue"),t.textContent=this._state.value);const o=xi().document.getSelection();if(!o)return;const r=this._getScreenReaderRange(this._state.selectionStart,this._state.selectionEnd);if(!r)return;this._setIgnoreSelectionChangeTime("setRange"),o.setBaseAndExtent(r.anchorNode,r.anchorOffset,r.focusNode,r.focusOffset)}else this._state=void 0,this._setIgnoreSelectionChangeTime("setValue"),this._domNode.domNode.textContent=""}updateScrollTop(e){if(!this._state)return;const t=this._context.viewModel.viewLayout,i=this._state.startPositionWithinEditor.lineNumber,n=t.getVerticalOffsetForLineNumber(i),o=t.getVerticalOffsetForLineNumber(e.positionLineNumber);this._domNode.domNode.scrollTop=o-n}onFocusChange(e){e?this._selectionChangeListener.value=this._setSelectionChangeListener():this._selectionChangeListener.value=void 0}onConfigurationChanged(e){this._accessibilityPageSize=e.get(3)}onWillCut(){this._setIgnoreSelectionChangeTime("onCut")}onWillPaste(){this._setIgnoreSelectionChangeTime("onWillPaste")}_setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}_setSelectionChangeListener(){let e=0;return ee(this._domNode.domNode.ownerDocument,"selectionchange",()=>{const t=this._accessibilityService.isScreenReaderOptimized();if(!this._state||!t||!_h.enabled||!(xi().document.activeElement===this._domNode.domNode))return;const o=xi().document.getSelection();if(!o||o.rangeCount===0)return;const a=o.getRangeAt(0),l=Date.now(),c=l-e;if(e=l,c<5)return;const d=l-this._ignoreSelectionChangeTime;this._ignoreSelectionChangeTime=0,!(d<100)&&this._viewController.setSelection(this._getEditorSelectionFromDomRange(this._context,this._state,o.direction,a))})}_getScreenReaderContentState(e){const t=this._strategy.fromEditorSelection(this._context.viewModel,e,this._accessibilityPageSize,this._accessibilityService.getAccessibilitySupport()===0),i=this._context.viewModel.model.getPositionAt(1/0);let n=t.value;return i.column===1&&e.getEndPosition().equals(i)&&(n+=`
`),t.value=n,t}_getScreenReaderRange(e,t){const i=this._domNode.domNode.firstChild;if(!i)return;const n=new globalThis.Range;return n.setStart(i,e),n.setEnd(i,t),{anchorNode:i,anchorOffset:e,focusNode:i,focusOffset:t}}_getEditorSelectionFromDomRange(e,t,i,n){const o=e.viewModel,r=o.model,l=o.coordinatesConverter.convertViewPositionToModelPosition(t.startPositionWithinEditor),c=r.getOffsetAt(l);let d=n.startOffset+c,h=n.endOffset+c;if(r.getEndOfLineSequence()===1){const v=t.value,b=new s4(v),w=b.getPosition(n.startOffset),C=b.getPosition(n.endOffset);d+=w.lineNumber-1,h+=C.lineNumber-1}const f=r.getPositionAt(d),g=r.getPositionAt(h),m=i==="forward"?f:g,p=i==="forward"?g:f;return Oe.fromPositions(m,p)}};WB=G5e([Y5e(3,so)],WB);var X5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vX=function(s,e){return function(t,i){e(t,i,s)}};let HB=class extends K{constructor(e,t,i,n,o){super(),this._domNode=e,this._context=t,this._viewController=i,this._keybindingService=n,this._accessibilityService=o,this._contentLeft=1,this._contentWidth=1,this._contentHeight=1,this._divWidth=1,this._primarySelection=new Oe(1,1,1,1),this._primaryCursorVisibleRange=null,this._state=this._register(new mi),this._instantiateScreenReaderContent(),this._updateConfigurationSettings(),this._updateDomAttributes()}onWillPaste(){var e;(e=this._state.value)==null||e.onWillPaste()}onWillCut(){var e;(e=this._state.value)==null||e.onWillCut()}handleFocusChange(e){var t;(t=this._state.value)==null||t.onFocusChange(e),this.writeScreenReaderContent()}onConfigurationChanged(e){this._instantiateScreenReaderContent(),this._updateConfigurationSettings(),this._updateDomAttributes(),e.hasChanged(2)&&this.writeScreenReaderContent()}_instantiateScreenReaderContent(){const e=this._context.configuration.options.get(107);this._renderRichContent!==e&&(this._renderRichContent=e,this._state.value=this._createScreenReaderContent(e))}_createScreenReaderContent(e){return e?new BB(this._domNode,this._context,this._viewController,this._accessibilityService):new WB(this._domNode,this._context,this._viewController,this._accessibilityService)}_updateConfigurationSettings(){var n;const e=this._context.configuration.options,t=e.get(165),i=t.wrappingColumn;this._contentLeft=t.contentLeft,this._contentWidth=t.contentWidth,this._contentHeight=t.height,this._fontInfo=e.get(59),this._divWidth=Math.round(i*this._fontInfo.typicalHalfwidthCharacterWidth),(n=this._state.value)==null||n.onConfigurationChanged(e)}_updateDomAttributes(){const e=this._context.configuration.options;this._domNode.domNode.setAttribute("role","textbox"),this._domNode.domNode.setAttribute("aria-required",e.get(9)?"true":"false"),this._domNode.domNode.setAttribute("aria-multiline","true"),this._domNode.domNode.setAttribute("aria-autocomplete",e.get(104)?"none":"both"),this._domNode.domNode.setAttribute("aria-roledescription",_(60,"editor")),this._domNode.domNode.setAttribute("aria-label",PB(e,this._keybindingService));const t=this._context.viewModel.model.getOptions().tabSize,i=e.get(59).spaceWidth;this._domNode.domNode.style.tabSize=`${t*i}px`;const n=e.get(154),o=n==="inherit"?e.get(153):n,r=o==="inherit"?e.get(149):o;this._domNode.domNode.style.textWrap=r==="off"?"nowrap":"wrap"}onCursorStateChanged(e){this._primarySelection=e.selections[0]??new Oe(1,1,1,1)}prepareRender(e){this.writeScreenReaderContent(),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primarySelection.getPosition())}render(e){var l;if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const t=this._context.viewLayout.getCurrentScrollLeft(),i=this._contentLeft+this._primaryCursorVisibleRange.left-t;if(i<this._contentLeft||i>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const n=this._context.viewLayout.getCurrentScrollTop(),o=this._primarySelection.positionLineNumber,r=this._context.viewLayout.getVerticalOffsetForLineNumber(o)-n;if(r<0||r>this._contentHeight){this._renderAtTopLeft();return}const a=this._context.viewLayout.getLineHeightForLineNumber(o);this._doRender(r,this._contentLeft,this._divWidth,a),(l=this._state.value)==null||l.updateScrollTop(this._primarySelection)}_renderAtTopLeft(){this._doRender(0,0,this._contentWidth,1)}_doRender(e,t,i,n){js(this._domNode,this._fontInfo),this._domNode.setTop(e),this._domNode.setLeft(t),this._domNode.setWidth(i),this._domNode.setHeight(n),this._domNode.setLineHeight(n)}setAriaOptions(e){e.activeDescendant?(this._domNode.setAttribute("aria-haspopup","true"),this._domNode.setAttribute("aria-autocomplete","list"),this._domNode.setAttribute("aria-activedescendant",e.activeDescendant)):(this._domNode.setAttribute("aria-haspopup","false"),this._domNode.setAttribute("aria-autocomplete","both"),this._domNode.removeAttribute("aria-activedescendant")),e.role&&this._domNode.setAttribute("role",e.role)}writeScreenReaderContent(){var e;(e=this._state.value)==null||e.updateScreenReaderContent(this._primarySelection)}};HB=X5e([vX(3,ai),vX(4,so)],HB);var VB;(function(s){function e(t,i){return new t.EditContext(i)}s.create=e})(VB||(VB={}));class Z5e{constructor(){this._nativeEditContextMapping=new Map}register(e,t){return this._nativeEditContextMapping.set(e,t),{dispose:()=>{this._nativeEditContextMapping.delete(e)}}}get(e){return this._nativeEditContextMapping.get(e)}}const k$=new Z5e;var Q5e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},CX=function(s,e){return function(t,i){e(t,i,s)}},YS;(function(s){s.NONE="edit-context-composition-none",s.SECONDARY="edit-context-composition-secondary",s.PRIMARY="edit-context-composition-primary"})(YS||(YS={}));let PR=class extends Cae{constructor(e,t,i,n,o,r,a){super(t),this._viewController=n,this._visibleRangeProvider=o,this.logService=a,this._previousEditContextSelection=new Ue(0,0),this._editContextPrimarySelection=new Oe(1,1,1,1),this._decorations=[],this._primarySelection=new Oe(1,1,1,1),this._targetWindowId=-1,this._scrollTop=0,this._scrollLeft=0,this._linesVisibleRanges=null,this.domNode=new dR(document.createElement("div")),this.domNode.setClassName("native-edit-context"),this._imeTextArea=new dR(document.createElement("textarea")),this._imeTextArea.setClassName("ime-text-area"),this._imeTextArea.setAttribute("readonly","true"),this._imeTextArea.setAttribute("tabindex","-1"),this._imeTextArea.setAttribute("aria-hidden","true"),this.domNode.setAttribute("autocorrect","off"),this.domNode.setAttribute("autocapitalize","off"),this.domNode.setAttribute("autocomplete","off"),this.domNode.setAttribute("spellcheck","false"),this._updateDomAttributes(),i.appendChild(this.domNode),i.appendChild(this._imeTextArea),this._parent=i.domNode,this._focusTracker=this._register(new FB(a,this.domNode.domNode,h=>{a.trace("NativeEditContext#handleFocusChange : ",h),this._screenReaderSupport.handleFocusChange(h),this._context.viewModel.setHasFocus(h)}));const l=je(this.domNode.domNode);this._editContext=VB.create(l),this.setEditContextOnDomNode(),this._screenReaderSupport=this._register(r.createInstance(HB,this.domNode,t,this._viewController)),this._register(ee(this.domNode.domNode,"copy",h=>{this.logService.trace("NativeEditContext#copy"),this._ensureClipboardGetsEditorSelection(h)})),this._register(ee(this.domNode.domNode,"cut",h=>{this.logService.trace("NativeEditContext#cut"),this._screenReaderSupport.onWillCut(),this._ensureClipboardGetsEditorSelection(h),this.logService.trace("NativeEditContext#cut (before viewController.cut)"),this._viewController.cut()})),this._register(ee(this.domNode.domNode,"keyup",h=>this._onKeyUp(h))),this._register(ee(this.domNode.domNode,"keydown",async h=>this._onKeyDown(h))),this._register(ee(this._imeTextArea.domNode,"keyup",h=>this._onKeyUp(h))),this._register(ee(this._imeTextArea.domNode,"keydown",async h=>this._onKeyDown(h))),this._register(ee(this.domNode.domNode,"beforeinput",async h=>{(h.inputType==="insertParagraph"||h.inputType==="insertLineBreak")&&this._onType(this._viewController,{text:`
`,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0})})),this._register(ee(this.domNode.domNode,"paste",h=>{if(this.logService.trace("NativeEditContext#paste"),h.preventDefault(),!h.clipboardData)return;let[u,f]=h_.getTextData(h.clipboardData);if(this.logService.trace("NativeEditContext#paste with id : ",f==null?void 0:f.id," with text.length: ",u.length),!u)return;f=f||mh.INSTANCE.get(u);let g=!1,m=null,p=null;f&&(g=this._context.configuration.options.get(45)&&!!f.isFromEmptySelection,m=typeof f.multicursorText<"u"?f.multicursorText:null,p=f.mode),this.logService.trace("NativeEditContext#paste (before viewController.paste)"),this._viewController.paste(u,g,m,p)})),this._register(B0(this._editContext,"textformatupdate",h=>this._handleTextFormatUpdate(h))),this._register(B0(this._editContext,"characterboundsupdate",h=>this._updateCharacterBounds(h)));let c;this._register(B0(this._editContext,"textupdate",h=>{const u=h.text;if(u.length===1){const f=u.charCodeAt(0);if(vs(f)){c=u;return}if(hm(f)&&c){const g={text:c+u,selectionEnd:h.selectionEnd,selectionStart:h.selectionStart,updateRangeStart:h.updateRangeStart-1,updateRangeEnd:h.updateRangeEnd-1};c=void 0,this._emitTypeEvent(this._viewController,g);return}}this._emitTypeEvent(this._viewController,h)})),this._register(B0(this._editContext,"compositionstart",h=>{this._updateEditContext(),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(B0(this._editContext,"compositionend",h=>{this._updateEditContext(),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}));let d=!1;this._register(_h.onDidChange(()=>{_h.enabled&&d&&(this._focusTracker.resume(),this.domNode.focus(),d=!1),!_h.enabled&&this.isFocused()&&(this._focusTracker.pause(),this._imeTextArea.focus(),d=!0)})),this._register(k$.register(e,this))}dispose(){this.domNode.domNode.editContext=void 0,this.domNode.domNode.blur(),this.domNode.domNode.remove(),this._imeTextArea.domNode.remove(),super.dispose()}setAriaOptions(e){this._screenReaderSupport.setAriaOptions(e)}getLastRenderData(){return this._primarySelection.getPosition()}prepareRender(e){this._screenReaderSupport.prepareRender(e),this._updateSelectionAndControlBoundsData(e)}onDidRender(){this._updateSelectionAndControlBoundsAfterRender()}render(e){this._screenReaderSupport.render(e)}onCursorStateChanged(e){return this._primarySelection=e.modelSelections[0]??new Oe(1,1,1,1),this._screenReaderSupport.onCursorStateChanged(e),this._updateEditContext(),!0}onConfigurationChanged(e){return this._screenReaderSupport.onConfigurationChanged(e),this._updateDomAttributes(),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.fromLineNumber+e.count-1),!0}onLinesDeleted(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.toLineNumber),!0}onLinesInserted(e){return this._updateEditContextOnLineChange(e.fromLineNumber,e.toLineNumber),!0}_updateEditContextOnLineChange(e,t){this._editContextPrimarySelection.endLineNumber<e||this._editContextPrimarySelection.startLineNumber>t||this._updateEditContext()}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}onWillPaste(){this.logService.trace("NativeEditContext#onWillPaste"),this._onWillPaste()}_onWillPaste(){this._screenReaderSupport.onWillPaste()}onWillCopy(){this.logService.trace("NativeEditContext#onWillCopy"),this.logService.trace("NativeEditContext#isFocused : ",this.domNode.domNode===Ss())}writeScreenReaderContent(){this._screenReaderSupport.writeScreenReaderContent()}isFocused(){return this._focusTracker.isFocused}focus(){this._focusTracker.focus(),this.refreshFocusState()}refreshFocusState(){this._focusTracker.refreshFocusState()}setEditContextOnDomNode(){const e=je(this.domNode.domNode),t=wL(e);this._targetWindowId!==t&&(this.domNode.domNode.editContext=this._editContext,this._targetWindowId=t)}_onKeyUp(e){this._viewController.emitKeyUp(new Bi(e))}_onKeyDown(e){const t=new Bi(e);t.keyCode===114&&t.stopPropagation(),this._viewController.emitKeyDown(t)}_updateDomAttributes(){const e=this._context.configuration.options;this.domNode.domNode.setAttribute("tabindex",String(e.get(140)))}_updateEditContext(){const e=this._getNewEditContextState();e&&(this._editContext.updateText(0,Number.MAX_SAFE_INTEGER,e.text??" "),this._editContext.updateSelection(e.selectionStartOffset,e.selectionEndOffset),this._editContextPrimarySelection=e.editContextPrimarySelection,this._previousEditContextSelection=new Ue(e.selectionStartOffset,e.selectionEndOffset))}_emitTypeEvent(e,t){if(!this._editContext)return;const i=this._previousEditContextSelection.endExclusive,n=this._previousEditContextSelection.start;this._previousEditContextSelection=new Ue(t.selectionStart,t.selectionEnd);let o=0,r=0;t.updateRangeEnd>i&&(o=t.updateRangeEnd-i),t.updateRangeStart<n&&(r=n-t.updateRangeStart);let a="";n<t.updateRangeStart&&(a+=this._editContext.text.substring(n,t.updateRangeStart)),a+=t.text,i>t.updateRangeEnd&&(a+=this._editContext.text.substring(t.updateRangeEnd,i));let l=0;t.selectionStart===t.selectionEnd&&n===i&&(l=t.selectionStart-(t.updateRangeStart+t.text.length));const c={text:a,replacePrevCharCnt:r,replaceNextCharCnt:o,positionDelta:l};this._onType(e,c)}_onType(e,t){t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?e.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta):e.type(t.text)}_getNewEditContextState(){const e=this._primarySelection,t=this._context.viewModel.model;if(!t.isValidRange(e))return;const i=e.startLineNumber,n=e.endLineNumber,o=t.getLineMaxColumn(n),r=new D(i,1,n,o),a=t.getValueInRange(r,0),l=e.startColumn-1,c=a.length+e.endColumn-o;return{text:a,selectionStartOffset:l,selectionEndOffset:c,editContextPrimarySelection:e}}_editContextStartPosition(){return new z(this._editContextPrimarySelection.startLineNumber,1)}_handleTextFormatUpdate(e){if(!this._editContext)return;const t=e.getTextFormats(),i=this._editContextStartPosition(),n=[];t.forEach(o=>{const r=this._context.viewModel.model,a=r.getOffsetAt(i),l=r.getPositionAt(a+o.rangeStart),c=r.getPositionAt(a+o.rangeEnd),d=D.fromPositions(l,c),h=o.underlineThickness.toLowerCase();let u=YS.NONE;switch(h){case"thin":u=YS.SECONDARY;break;case"thick":u=YS.PRIMARY;break}n.push({range:d,options:{description:"textFormatDecoration",inlineClassName:u}})}),this._decorations=this._context.viewModel.model.deltaDecorations(this._decorations,n)}_updateSelectionAndControlBoundsData(e){const t=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(this._primarySelection);if(this._primarySelection.isEmpty()){const i=e.visibleRangeForPosition(t.getStartPosition());this._linesVisibleRanges=i}else this._linesVisibleRanges=null}_updateSelectionAndControlBoundsAfterRender(){const t=this._context.configuration.options.get(165).contentLeft,i=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(this._primarySelection),n=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),o=this._context.viewLayout.getVerticalOffsetAfterLineNumber(i.endLineNumber),r=this._parent.getBoundingClientRect(),a=r.top+n-this._scrollTop,l=o-n;let c=r.left+t-this._scrollLeft,d;this._primarySelection.isEmpty()?(this._linesVisibleRanges&&(c+=this._linesVisibleRanges.left),d=0):d=r.width-t;const h=new DOMRect(c,a,d,l);this._editContext.updateSelectionBounds(h),this._editContext.updateControlBounds(h)}_updateCharacterBounds(e){const t=this._context.configuration.options,i=t.get(59).typicalHalfwidthCharacterWidth,n=t.get(165).contentLeft,o=this._parent.getBoundingClientRect(),r=[],a=new s4(this._editContext.text);for(let l=e.rangeStart;l<e.rangeEnd;l++){const c=a.getPosition(l),d=this._editContextPrimarySelection.startLineNumber-1,h=new z(d+c.lineNumber,c.column),u=h.delta(0,1),f=D.fromPositions(h,u),g=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(f),m=this._visibleRangeProvider.linesVisibleRangesForRange(g,!0)??[],p=g.startLineNumber,v=this._context.viewLayout.getVerticalOffsetForLineNumber(p),b=o.top+v-this._scrollTop;let w=0,C=i;if(m.length>0)for(const x of m[0].ranges){w=x.left,C=x.width;break}const y=this._context.viewLayout.getLineHeightForLineNumber(p);r.push(new DOMRect(o.left+n+w-this._scrollLeft,b,C,y))}this._editContext.updateCharacterBounds(e.rangeStart,r)}_ensureClipboardGetsEditorSelection(e){const t=this._context.configuration.options,i=t.get(45),n=t.get(31),o=this._context.viewModel.getCursorStates().map(c=>c.modelState.selection),r=Ure(this._context.viewModel,o,i,n);let a;this.logService.getLevel()===Ns.Trace&&(a=wv());const l={version:1,id:a,isFromEmptySelection:r.isFromEmptySelection,multicursorText:r.multicursorText,mode:r.mode};mh.INSTANCE.set(Wr?r.text.replace(/\r\n/g,`
`):r.text,l),e.preventDefault(),e.clipboardData&&h_.setTextData(e.clipboardData,r.text,r.html,l),this.logService.trace("NativeEditContext#_ensureClipboardGetsEditorSelectios with id : ",a," with text.length: ",r.text.length)}};PR=Q5e([CX(5,$e),CX(6,Ji)],PR);class J5e extends yr{constructor(e,t){super(e),this._viewGpuContext=t,this._gpuShapes=[],this._register(lt(i=>this._updateEntries(i)))}onConfigurationChanged(e){return this._updateEntries(void 0),!0}prepareRender(e){}render(e){}_updateEntries(e){const t=this._context.configuration.options,i=t.get(116),n=t.get(59).typicalHalfwidthCharacterWidth,o=this._viewGpuContext.devicePixelRatio.read(e);for(let r=0,a=i.length;r<a;r++){const l=i[r],c=this._gpuShapes[r],d=l.color?re.fromHex(l.color):this._context.theme.getColor(OOe)??re.white,h=[l.column*n*o,0,Math.max(1,Math.ceil(o)),Number.MAX_SAFE_INTEGER,d.rgba.r/255,d.rgba.g/255,d.rgba.b/255,d.rgba.a];c?c.setRaw(h):this._gpuShapes[r]=this._viewGpuContext.rectangleRenderer.register(...h)}for(;this._gpuShapes.length>i.length;)this._gpuShapes.splice(-1,1)[0].dispose()}}const SA=class SA extends Nm{constructor(e,t){super(),this._viewGpuContext=t,this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onCursorStateChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return!0}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.viewportData,o=new ER(this._context.configuration,this._context.theme.type),r=[];for(let a=t;a<=i;a++){const l=a-t,c=this._viewGpuContext.canRenderDetailed(o,n,a);r[l]=c.length?`<div class="${SA.CLASS_NAME}" title="Cannot render on GPU: ${c.join(", ")}"></div>`:""}this._renderResult=r}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};SA.CLASS_NAME="gpu-mark";let zB=SA;var eFe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},tFe=function(s,e){return function(t,i){e(t,i,s)}};let UB=class extends Cv{constructor(e,t,i,n,o,r,a,l,c){super(),this._instantiationService=c,this._shouldRecomputeGlyphMarginLanes=!1,this._ownerID=t,this._widgetFocusTracker=this._register(new iFe(e,l)),this._register(this._widgetFocusTracker.onChange(()=>{this._context.viewModel.setHasWidgetFocus(this._widgetFocusTracker.hasFocus())})),this._selections=[new Oe(1,1,1,1)],this._renderAnimationFrame=null,this._overflowGuardContainer=gi(document.createElement("div")),dd.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._viewController=new dOe(n,r,a,i),this._context=new e5e(n,o,r),this._context.addEventHandler(this),this._viewParts=[],this._editContextEnabled=this._context.configuration.options.get(170),this._accessibilitySupport=this._context.configuration.options.get(2),this._editContext=this._instantiateEditContext(),this._viewParts.push(this._editContext),this._linesContent=gi(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=gi(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._context.configuration.options.get(46)==="on"&&(this._viewGpuContext=this._instantiationService.createInstance(Yo,this._context)),this._scrollbar=new a4e(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new IB(this._context,this._viewGpuContext,this._linesContent),this._viewGpuContext&&(this._viewLinesGpu=this._instantiationService.createInstance(AB,this._context,this._viewGpuContext)),this._viewZones=new Y4e(this._context),this._viewParts.push(this._viewZones);const d=new H4e(this._context);this._viewParts.push(d);const h=new $4e(this._context);this._viewParts.push(h);const u=new uOe(this._context);this._viewParts.push(u),u.addDynamicOverlay(new s4e(this._context)),u.addDynamicOverlay(new TB(this._context)),u.addDynamicOverlay(new v4e(this._context)),u.addDynamicOverlay(new r4e(this._context)),u.addDynamicOverlay(new Z4e(this._context));const f=new fOe(this._context);this._viewParts.push(f),f.addDynamicOverlay(new o4e(this._context)),f.addDynamicOverlay(new x4e(this._context)),f.addDynamicOverlay(new S4e(this._context)),f.addDynamicOverlay(new IR(this._context)),this._viewGpuContext&&f.addDynamicOverlay(new zB(this._context,this._viewGpuContext)),this._glyphMarginWidgets=new d4e(this._context),this._viewParts.push(this._glyphMarginWidgets);const g=new kR(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(f.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new mOe(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new NB(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new F4e(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const m=this._viewGpuContext?new J5e(this._context,this._viewGpuContext):new U4e(this._context);this._viewParts.push(m);const p=new gOe(this._context);this._viewParts.push(p);const v=new O4e(this._context);if(this._viewParts.push(v),d){const b=this._scrollbar.getOverviewRulerLayoutInfo();b.parent.insertBefore(d.getDomNode(),b.insertBefore)}this._linesContent.appendChild(u.getDomNode()),"domNode"in m&&this._linesContent.appendChild(m.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._viewGpuContext&&this._overflowGuardContainer.appendChild(this._viewGpuContext.canvas),this._overflowGuardContainer.appendChild(h.getDomNode()),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(v.getDomNode()),this._overflowGuardContainer.appendChild(p.domNode),this.domNode.appendChild(this._overflowGuardContainer),l?(l.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),l.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new cOe(this._context,this._viewController,this._createPointerHandlerHelper()))}_instantiateEditContext(){return this._context.configuration.options.get(170)?this._instantiationService.createInstance(PR,this._ownerID,this._context,this._overflowGuardContainer,this._viewController,this._createTextAreaHandlerHelper()):this._instantiationService.createInstance(OB,this._context,this._overflowGuardContainer,this._viewController,this._createTextAreaHandlerHelper())}_updateEditContext(){const e=this._context.configuration.options.get(170),t=this._context.configuration.options.get(2);if(this._editContextEnabled===e&&this._accessibilitySupport===t)return;this._editContextEnabled=e,this._accessibilitySupport=t;const i=this._editContext.isFocused(),n=this._viewParts.indexOf(this._editContext);this._editContext.dispose(),this._editContext=this._instantiateEditContext(),i&&this._editContext.focus(),n!==-1&&this._viewParts.splice(n,1,this._editContext)}_computeGlyphMarginLanes(){const e=this._context.viewModel.model,t=this._context.viewModel.glyphLanes;let i=[],n=0;i=i.concat(e.getAllMarginDecorations().map(o=>{var a,l;const r=((a=o.options.glyphMargin)==null?void 0:a.position)??cd.Center;return n=Math.max(n,o.range.endLineNumber),{range:o.range,lane:r,persist:(l=o.options.glyphMargin)==null?void 0:l.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(o=>{const r=e.validateRange(o.preference.range);return n=Math.max(n,r.endLineNumber),{range:r,lane:o.preference.lane}})),i.sort((o,r)=>D.compareRangesUsingStarts(o.range,r.range)),t.reset(n);for(const o of i)t.push(o.lane,o.range,o.persist);return t}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,viewLinesGpu:this._viewLinesGpu,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._editContext.domNode.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._editContext.getLastRenderData();return new OPe(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>{var n;this._flushAccumulatedAndRenderNow();const i=new z(e,t);return this._viewLines.visibleRangeForPosition(i)??((n=this._viewLinesGpu)==null?void 0:n.visibleRangeForPosition(i))??null},getLineWidth:e=>{if(this._flushAccumulatedAndRenderNow(),this._viewLinesGpu){const t=this._viewLinesGpu.getLineWidth(e);if(t!==void 0)return t}return this._viewLines.getLineWidth(e)}}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e)),linesVisibleRangesForRange:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.linesVisibleRangesForRange(e,t))}}_applyLayout(){const t=this._context.configuration.options.get(165);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const e=this._editContext.isFocused()?" focused":"";return this._context.configuration.options.get(162)+" "+xB(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._updateEditContext(),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){var e,t;this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),(e=this._viewGpuContext)==null||e.dispose(),this._viewLines.dispose(),(t=this._viewLinesGpu)==null||t.dispose();for(const i of this._viewParts)i.dispose();super.dispose()}_scheduleRender(){var e;if(this._store.isDisposed)throw new et;if(this._renderAnimationFrame===null){this._editContext instanceof PR&&this._editContext.setEditContextOnDomNode();const t=this._createCoordinatedRendering();this._renderAnimationFrame=$B.INSTANCE.scheduleCoordinatedRendering({window:je((e=this.domNode)==null?void 0:e.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new et;try{return t.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new et;return t.renderText()},prepareRender:(i,n)=>{if(this._store.isDisposed)throw new et;return t.prepareRender(i,n)},render:(i,n)=>{if(this._store.isDisposed)throw new et;return t.render(i,n)}})}}_flushAccumulatedAndRenderNow(){const e=this._createCoordinatedRendering();Lg(()=>e.prepareRenderText());const t=Lg(()=>e.renderText());if(t){const[i,n]=t;Lg(()=>e.prepareRender(i,n)),Lg(()=>e.render(i,n))}}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}vg.onRenderStart()},renderText:()=>{var n;if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new Q4e(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),(n=this._viewLinesGpu)!=null&&n.shouldRender()&&(this._viewLinesGpu.renderText(i),this._viewLinesGpu.onDidRender()),[e,new bPe(this._context.viewLayout,i,this._viewLines,this._viewLinesGpu)]},prepareRender:(e,t)=>{for(const i of e)i.prepareRender(t)},render:(e,t)=>{for(const i of e)i.render(t),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const o=this._viewLines.visibleRangeForPosition(new z(n.lineNumber,n.column));return o?o.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?JO.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new z4e(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._editContext.writeScreenReaderContent(e)}focus(){this._editContext.focus()}isFocused(){return this._editContext.isFocused()}isWidgetFocused(){return this._widgetFocusTracker.hasFocus()}setAriaOptions(e){this._editContext.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,n,o;this._contentWidgets.setWidgetPosition(e.widget,((t=e.position)==null?void 0:t.position)??null,((i=e.position)==null?void 0:i.secondaryPosition)??null,((n=e.position)==null?void 0:n.preference)??null,((o=e.position)==null?void 0:o.positionAffinity)??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};UB=eFe([tFe(8,$e)],UB);function Lg(s){try{return s()}catch(e){return _t(e),null}}const xA=class xA{constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{const t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(const[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){const t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,ZN(e,t,100))}}_onRenderScheduled(){const e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of e)Lg(()=>i.prepareRenderText());const t=[];for(let i=0,n=e.length;i<n;i++){const o=e[i];t[i]=Lg(()=>o.renderText())}for(let i=0,n=e.length;i<n;i++){const o=e[i],r=t[i];if(!r)continue;const[a,l]=r;Lg(()=>o.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){const o=e[i],r=t[i];if(!r)continue;const[a,l]=r;Lg(()=>o.render(a,l))}}};xA.INSTANCE=new xA;let $B=xA;class iFe extends K{constructor(e,t){super(),this._onChange=this._register(new q),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Ol(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Ol(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class XS{constructor(e,t,i,n,o){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&n>this.injectionOffsets[o];o++)n<this.injectionOffsets[o]+this.injectionOptions[o].content.length?n=this.injectionOffsets[o]:n-=this.injectionOptions[o].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,o=0,r=0;for(;i<=n;){o=i+(n-i)/2|0;const l=this.breakOffsets[o];if(r=o>0?this.breakOffsets[o-1]:0,t===0)if(e<=r)n=o-1;else if(e>l)i=o+1;else break;else if(e<r)n=o-1;else if(e>=l)i=o+1;else break}let a=e-r;return o>0&&(a+=this.wrappedTextIndentLength),new mD(o,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const n=this.outputPositionToOffsetInInputWithInjections(e,t),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(o!==n)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new mD(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new mD(e+1,this.getMinOutputOffset(e+1))}return new mD(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&wX(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(yX(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let o=i.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[i.injectedTextIndex]&&!(wX(this.injectionOptions[o].cursorStops)||(n-=this.injectionOptions[o].content.length,yX(this.injectionOptions[o].cursorStops)));)o--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,o=i.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)n+=this.injectionOptions[o+1].content.length,o++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,o=i.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)n-=this.injectionOptions[o-1].content.length,o--;return n}nk()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let o=0;o<t.length;o++){const r=i[o].content.length,a=t[o]+n,l=t[o]+n+r;if(a>e)break;if(e<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:r};n+=r}}}}function wX(s){return s==null?!0:s===wl.Right||s===wl.Both}function yX(s){return s==null?!0:s===wl.Left||s===wl.Both}class mD{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new z(e+this.outputLineIndex,this.outputOffset+1)}}class nFe{constructor(){this.changeType=1}}class hd{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(const o of t)i+=e.substring(n,o.column-1),n=o.column-1,i+=o.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new hd(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new hd(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}constructor(e,t,i,n,o){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=o}}class SX{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class sFe{constructor(e,t,i,n){this.ownerId=e,this.decorationId=t,this.lineNumber=i,this.lineHeight=n}}class oFe{constructor(e,t){this.ownerId=e,this.lineNumber=t}}class rFe{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class aFe{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class lFe{constructor(){this.changeType=5}}class S1{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,o=e.isUndoing||t.isUndoing,r=e.isRedoing||t.isRedoing;return new S1(i,n,o,r)}}class xae{constructor(e){this.changes=e}}let Lae=class{constructor(e){this.changes=e}},Iae=class{constructor(e){this.changes=e}};class m_{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=S1.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=m_._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new m_(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.eol,o=t.versionId,r=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:c,versionId:o,isUndoing:r,isRedoing:a,isFlush:l,detailedReasons:e.detailedReasons.concat(t.detailedReasons),detailedReasonsChangeLengths:e.detailedReasonsChangeLengths.concat(t.detailedReasonsChangeLengths)}}}const sF=Oh("domLineBreaksComputer",{createHTML:s=>s});class D${static create(e){return new D$(new WeakRef(e))}constructor(e){this.targetWindow=e}createLineBreaksComputer(e,t,i,n,o,r){const a=[],l=[];return{addRequest:(c,d,h)=>{a.push(c),l.push(d)},finalize:()=>cFe(_g(this.targetWindow.deref()),a,e,t,i,n,o,l)}}}function cFe(s,e,t,i,n,o,r,a){function l(E){const M=a[E];if(M){const R=hd.applyInjectedText(e[E],M),T=M.map(N=>N.options),A=M.map(N=>N.column-1);return new XS(A,T,[R.length],[],0)}else return null}if(n===-1){const E=[];for(let M=0,R=e.length;M<R;M++)E[M]=l(M);return E}const c=Math.round(n*t.typicalHalfwidthCharacterWidth),h=Math.round(i*(o===3?2:o===2?1:0)),u=Math.ceil(t.spaceWidth*h),f=document.createElement("div");js(f,t);const g=new Dm(1e4),m=[],p=[],v=[],b=[],w=[];for(let E=0;E<e.length;E++){const M=hd.applyInjectedText(e[E],a[E]);let R=0,T=0,A=c;if(o!==0)if(R=Jo(M),R===-1)R=0;else{for(let H=0;H<R;H++){const G=M.charCodeAt(H)===9?i-T%i:1;T+=G}const W=Math.ceil(t.spaceWidth*T);W+t.typicalFullwidthCharacterWidth>c?(R=0,T=0):A=c-W}const N=M.substr(R),P=dFe(N,T,i,A,g,u);m[E]=R,p[E]=T,v[E]=N,b[E]=P[0],w[E]=P[1]}const C=g.build(),y=(sF==null?void 0:sF.createHTML(C))??C;f.innerHTML=y,f.style.position="absolute",f.style.top="10000",r==="keepAll"?(f.style.wordBreak="keep-all",f.style.overflowWrap="anywhere"):(f.style.wordBreak="inherit",f.style.overflowWrap="break-word"),s.document.body.appendChild(f);const x=document.createRange(),S=Array.prototype.slice.call(f.children,0),L=[];for(let E=0;E<e.length;E++){const M=S[E],R=hFe(x,M,v[E],b[E]);if(R===null){L[E]=l(E);continue}const T=m[E],A=p[E]+h,N=w[E],P=[];for(let V=0,U=R.length;V<U;V++)P[V]=N[R[V]];if(T!==0)for(let V=0,U=R.length;V<U;V++)R[V]+=T;let W,H;const G=a[E];G?(W=G.map(V=>V.options),H=G.map(V=>V.column-1)):(W=null,H=null),L[E]=new XS(H,W,R,P,A)}return f.remove(),L}function dFe(s,e,t,i,n,o){if(o!==0){const u=String(o);n.appendString('<div style="text-indent: -'),n.appendString(u),n.appendString("px; padding-left: "),n.appendString(u),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');const r=s.length;let a=e,l=0;const c=[],d=[];let h=0<r?s.charCodeAt(0):0;n.appendString("<span>");for(let u=0;u<r;u++){u!==0&&u%16384===0&&n.appendString("</span><span>"),c[u]=l,d[u]=a;const f=h;h=u+1<r?s.charCodeAt(u+1):0;let g=1,m=1;switch(f){case 9:g=t-a%t,m=g;for(let p=1;p<=g;p++)p<g?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:h===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:hf(f)&&m++,f<32?n.appendCharCode(9216+f):n.appendCharCode(f)}l+=g,a+=m}return n.appendString("</span>"),c[s.length]=l,d[s.length]=a,n.appendString("</div>"),[c,d]}function hFe(s,e,t,i){if(t.length<=1)return null;const n=Array.prototype.slice.call(e.children,0),o=[];try{qB(s,n,i,0,null,t.length-1,null,o)}catch(r){return console.log(r),null}return o.length===0?null:(o.push(t.length),o)}function qB(s,e,t,i,n,o,r,a){if(i===o||(n=n||oF(s,e,t[i],t[i+1]),r=r||oF(s,e,t[o],t[o+1]),Math.abs(n[0].top-r[0].top)<=.1))return;if(i+1===o){a.push(o);return}const l=i+(o-i)/2|0,c=oF(s,e,t[l],t[l+1]);qB(s,e,t,i,n,l,c,a),qB(s,e,t,l,c,o,r,a)}function oF(s,e,t,i){return s.setStart(e[t/16384|0].firstChild,t%16384),s.setEnd(e[i/16384|0].firstChild,i%16384),s.getClientRects()}class uFe extends K{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new gO),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t){if(this._pending.has(n.id)){_t(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(vS(je(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(vS(je(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(vS(je(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){var e;return vS(je((e=this._editor)==null?void 0:e.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){_t(i)}}}}class Eae{constructor(e,t,i,n,o,r,a){this.id=e,this.label=t,this.alias=i,this.metadata=n,this._precondition=o,this._run=r,this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}const yk={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};function bm(s){let e=0,t=0,i=0,n=0;for(let o=0,r=s.length;o<r;o++){const a=s.charCodeAt(o);a===13?(e===0&&(t=o),e++,o+1<r&&s.charCodeAt(o+1)===10?(n|=2,o++):n|=3,i=o+1):a===10&&(n|=1,e===0&&(t=o),e++,i=o+1)}return e===0&&(t=s.length),[e,t,s.length-i,n]}class xX{constructor(e,t,i,n){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=n}}class fFe{constructor(e,t,i,n,o,r){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n,this.nestingLevelOfEqualBracketType=o,this.bracketPairNode=r}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class gFe extends fFe{constructor(e,t,i,n,o,r,a){super(e,t,i,n,o,r),this.minVisibleColumnIndentation=a}}function mFe(s,e,t,i){return s!==t?ss(t-s,i):ss(0,i-e)}const _r=0;function OR(s){return s===0}const Ka=2**26;function ss(s,e){return s*Ka+e}function Tl(s){const e=s,t=Math.floor(e/Ka),i=e-t*Ka;return new xs(t,i)}function pFe(s){return Math.floor(s/Ka)}function On(s,e){let t=s+e;return e>=Ka&&(t=t-s%Ka),t}function _Fe(s,e){return s.reduce((t,i)=>On(t,e(i)),_r)}function kae(s,e){return s===e}function YL(s,e){const t=s,i=e;if(i-t<=0)return _r;const o=Math.floor(t/Ka),r=Math.floor(i/Ka),a=i-r*Ka;if(o===r){const l=t-o*Ka;return ss(0,a-l)}else return ss(r-o,a)}function x1(s,e){return s<e}function L1(s,e){return s<=e}function wS(s,e){return s>=e}function NC(s){return ss(s.lineNumber-1,s.column-1)}function p_(s,e){const t=s,i=Math.floor(t/Ka),n=t-i*Ka,o=e,r=Math.floor(o/Ka),a=o-r*Ka;return new D(i+1,n+1,r+1,a+1)}function bFe(s){const e=fa(s);return ss(e.length-1,e[e.length-1].length)}class Fu{static fromModelContentChanges(e){return e.map(i=>{const n=D.lift(i.range);return new Fu(NC(n.getStartPosition()),NC(n.getEndPosition()),bFe(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${Tl(this.startOffset)}...${Tl(this.endOffset)}) -> ${Tl(this.newLength)}`}}class vFe{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>T$.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:YL(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?ss(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):ss(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=Tl(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?ss(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):ss(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(L1(i,e)){this.nextEditIdx++;const n=Tl(i),o=Tl(this.translateOldToCur(t.endOffsetBeforeObj)),r=n.lineCount-o.lineCount;this.deltaOldToNewLineCount+=r;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class T${static from(e){return new T$(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=Tl(t),this.endOffsetAfterObj=Tl(On(e,i)),this.offsetObj=Tl(e)}}const pD=[],ll=class ll{static create(e,t){if(e<=128&&t.length===0){let i=ll.cache[e];return i||(i=new ll(e,t),ll.cache[e]=i),i}return new ll(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let n=i>>5;if(n===0){const r=1<<i|this.items;return r===this.items?this:ll.create(r,this.additionalItems)}n--;const o=this.additionalItems.slice(0);for(;o.length<n;)o.push(0);return o[n]|=1<<(i&31),ll.create(this.items,o)}merge(e){const t=this.items|e.items;if(this.additionalItems===pD&&e.additionalItems===pD)return t===this.items?this:t===e.items?e:ll.create(t,pD);const i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const o=this.additionalItems[n]||0,r=e.additionalItems[n]||0;i.push(o|r)}return ll.create(t,i)}intersects(e){if((this.items&e.items)!==0)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if((this.additionalItems[t]&e.additionalItems[t])!==0)return!0;return!1}};ll.cache=new Array(129),ll.empty=ll.create(0,pD);let ia=ll;const LX={getKey(s){return s}};class Dae{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class N${get length(){return this._length}constructor(e){this._length=e}}class XL extends N${static create(e,t,i){let n=e.length;return t&&(n=On(n,t.length)),i&&(n=On(n,i.length)),new XL(n,e,t,i,t?t.missingOpeningBracketIds:ia.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,n,o){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=o}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new XL(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(On(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class Ih extends N${static create23(e,t,i,n=!1){let o=e.length,r=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(o=On(o,t.length),r=r.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");o=On(o,i.length),r=r.merge(i.missingOpeningBracketIds)}return n?new CFe(o,e.listHeight+1,e,t,i,r):new ZL(o,e.listHeight+1,e,t,i,r)}static getEmpty(){return new wFe(_r,0,[],ia.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new et;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const o=this.getChild(n);t=On(t,o.length),i=i.merge(o.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let o=0;o<this.childrenLength;o++){const r=this.getChild(o);r&&(i=Math.min(i,r.computeMinIndentation(n,t)),n=On(n,r.length))}return this.cachedMinIndentation=i,i}}class ZL extends Ih{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,n,o,r){super(e,t,r),this._item1=i,this._item2=n,this._item3=o}deepClone(){return new ZL(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class CFe extends ZL{toMutable(){return new ZL(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class FR extends Ih{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,n){super(e,t,n),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new FR(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class wFe extends FR{toMutable(){return new FR(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const yFe=[];class R$ extends N${get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return yFe}deepClone(){return this}}class bp extends R${get kind(){return 0}get missingOpeningBracketIds(){return ia.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=Tl(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,o=pFe(On(e,this.length))+1;let r=Number.MAX_SAFE_INTEGER;for(let a=n;a<=o;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const d=Ln.visibleColumnFromColumn(c,l,t.getOptions().tabSize);r=Math.min(r,d)}return r}}class BR extends R${static create(e,t,i){return new BR(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return ia.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class SFe extends R${get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let cg=class{constructor(e,t,i,n,o){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=o}};class Tae{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new xFe(this.textModel,this.bracketTokens),this._offset=_r,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return ss(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=On(this._offset,e);const t=Tl(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=On(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class xFe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const o=this.lineTokens,r=o.getCount();let a=null;if(this.lineTokenOffset<r){const l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<r&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Do.getTokenType(l)===0,d=Do.containsBalancedBrackets(l),h=o.getEndOffset(this.lineTokenOffset);if(d&&c&&this.lineCharOffset<h){const u=o.getLanguageId(this.lineTokenOffset),f=this.line.substring(this.lineCharOffset,h),g=this.bracketTokens.getSingleLanguageBracketTokens(u),m=g.regExpGlobal;if(m){m.lastIndex=0;const p=m.exec(f);p&&(a=g.getToken(p[0]),a&&(this.lineCharOffset+=p.index))}}if(i+=h-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=h}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const n=mFe(e,t,this.lineIdx,this.lineCharOffset);return new cg(n,0,-1,ia.getEmpty(),new bp(n))}}class LFe{constructor(e,t){this.text=e,this._offset=_r,this.idx=0;const i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,o=[];let r,a=0,l=0,c=0,d=0;const h=[];for(let g=0;g<60;g++)h.push(new cg(ss(0,g),0,-1,ia.getEmpty(),new bp(ss(0,g))));const u=[];for(let g=0;g<60;g++)u.push(new cg(ss(1,g),0,-1,ia.getEmpty(),new bp(ss(1,g))));if(n)for(n.lastIndex=0;(r=n.exec(e))!==null;){const g=r.index,m=r[0];if(m===`
`)a++,l=g+1;else{if(c!==g){let p;if(d===a){const v=g-c;if(v<h.length)p=h[v];else{const b=ss(0,v);p=new cg(b,0,-1,ia.getEmpty(),new bp(b))}}else{const v=a-d,b=g-l;if(v===1&&b<u.length)p=u[b];else{const w=ss(v,b);p=new cg(w,0,-1,ia.getEmpty(),new bp(w))}}o.push(p)}o.push(t.getToken(m)),c=g+m.length,d=a}}const f=e.length;if(c!==f){const g=d===a?ss(0,f-c):ss(a-d,f-l);o.push(new cg(g,0,-1,ia.getEmpty(),new bp(g)))}this.length=ss(a,f-l),this.tokens=o}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new pke}}class M${static createFromLanguage(e,t){function i(o){return t.getKey(`${o.languageId}:::${o.bracketText}`)}const n=new Map;for(const o of e.bracketsNew.openingBrackets){const r=ss(0,o.bracketText.length),a=i(o),l=ia.getEmpty().add(a,LX);n.set(o.bracketText,new cg(r,1,a,l,BR.create(r,o,l)))}for(const o of e.bracketsNew.closingBrackets){const r=ss(0,o.bracketText.length);let a=ia.getEmpty();const l=o.getOpeningBrackets();for(const c of l)a=a.add(i(c),LX);n.set(o.bracketText,new cg(r,2,i(l[0]),a,BR.create(r,o,a)))}return new M$(n)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>IFe(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function IFe(s){let e=ua(s);return/^[\w ]+/.test(s)&&(e=`\\b${e}`),/[\w ]+$/.test(s)&&(e=`${e}\\b`),e}class Nae{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=M$.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function EFe(s){if(s.length===0)return null;if(s.length===1)return s[0];let e=0;function t(){if(e>=s.length)return null;const r=e,a=s[r].listHeight;for(e++;e<s.length&&s[e].listHeight===a;)e++;return e-r>=2?Rae(r===0&&e===s.length?s:s.slice(r,e),!1):s[r]}let i=t(),n=t();if(!n)return i;for(let r=t();r;r=t())IX(i,n)<=IX(n,r)?(i=rF(i,n),n=r):n=rF(n,r);return rF(i,n)}function Rae(s,e=!1){if(s.length===0)return null;if(s.length===1)return s[0];let t=s.length;for(;t>3;){const i=t>>1;for(let n=0;n<i;n++){const o=n<<1;s[n]=Ih.create23(s[o],s[o+1],o+3===t?s[o+2]:null,e)}t=i}return Ih.create23(s[0],s[1],t>=3?s[2]:null,e)}function IX(s,e){return Math.abs(s.listHeight-e.listHeight)}function rF(s,e){return s.listHeight===e.listHeight?Ih.create23(s,e,null,!1):s.listHeight>e.listHeight?kFe(s,e):DFe(e,s)}function kFe(s,e){s=s.toMutable();let t=s;const i=[];let n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let o=i.length-1;o>=0;o--){const r=i[o];n?r.childrenLength>=3?n=Ih.create23(r.unappendChild(),n,null,!1):(r.appendChildOfSameHeight(n),n=void 0):r.handleChildrenChanged()}return n?Ih.create23(s,n,null,!1):s}function DFe(s,e){s=s.toMutable();let t=s;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let o=i.length-1;o>=0;o--){const r=i[o];n?r.childrenLength>=3?n=Ih.create23(n,r.unprependChild(),null,!1):(r.prependChildOfSameHeight(n),n=void 0):r.handleChildrenChanged()}return n?Ih.create23(n,s,null,!1):s}class TFe{constructor(e){this.lastOffset=_r,this.nextNodes=[e],this.offsets=[_r],this.idxs=[]}readLongestNodeAt(e,t){if(x1(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=W0(this.nextNodes);if(!i)return;const n=W0(this.offsets);if(x1(e,n))return;if(x1(n,e))if(On(n,i.length)<=e)this.nextNodeAfterCurrent();else{const o=aF(i);o!==-1?(this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const o=aF(i);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(o)),this.offsets.push(n),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){const e=W0(this.offsets),t=W0(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=W0(this.nextNodes),n=aF(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(On(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}}function aF(s,e=-1){for(;;){if(e++,e>=s.childrenLength)return-1;if(s.getChild(e))return e}}function W0(s){return s.length>0?s[s.length-1]:void 0}function jB(s,e,t,i){return new NFe(s,e,t,i).parseDocument()}class NFe{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new TFe(i):void 0,this.positionMapper=new vFe(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(ia.getEmpty(),0);return e||(e=Ih.getEmpty()),e}parseList(e,t){const i=[];for(;;){let o=this.tryReadChildFromCache(e);if(!o){const r=this.tokenizer.peek();if(!r||r.kind===2&&r.bracketIds.intersects(e))break;o=this.parseChild(e,t+1)}o.kind===4&&o.childrenLength===0||i.push(o)}return this.oldNodeReader?EFe(i):Rae(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!OR(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!x1(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new SFe(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new bp(i.length);const n=e.merge(i.bracketIds),o=this.parseList(n,t+1),r=this.tokenizer.peek();return r&&r.kind===2&&(r.bracketId===i.bracketId||r.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),XL.create(i.astNode,o,r.astNode)):XL.create(i.astNode,o,null)}default:throw new Error("unexpected")}}}function WR(s,e){if(s.length===0)return e;if(e.length===0)return s;const t=new ff(EX(s)),i=EX(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function o(c){if(c===void 0){const h=t.takeWhile(u=>!0)||[];return n&&h.unshift(n),h}const d=[];for(;n&&!OR(c);){const[h,u]=n.splitAt(c);d.push(h),c=YL(h.lengthAfter,c),n=u??t.dequeue()}return OR(c)||d.push(new Ig(!1,c,c)),d}const r=[];function a(c,d,h){if(r.length>0&&kae(r[r.length-1].endOffset,c)){const u=r[r.length-1];r[r.length-1]=new Fu(u.startOffset,d,On(u.newLength,h))}else r.push({startOffset:c,endOffset:d,newLength:h})}let l=_r;for(const c of i){const d=o(c.lengthBefore);if(c.modified){const h=_Fe(d,f=>f.lengthBefore),u=On(l,h);a(l,u,c.lengthAfter),l=u}else for(const h of d){const u=l;l=On(l,h.lengthBefore),h.modified&&a(u,l,h.lengthAfter)}}return r}class Ig{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=YL(e,this.lengthAfter);return kae(t,_r)?[this,void 0]:this.modified?[new Ig(this.modified,this.lengthBefore,e),new Ig(this.modified,_r,t)]:[new Ig(this.modified,e,e),new Ig(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Tl(this.lengthBefore)} -> ${Tl(this.lengthAfter)}`}}function EX(s){const e=[];let t=_r;for(const i of s){const n=YL(t,i.startOffset);OR(n)||e.push(new Ig(!1,n,n));const o=YL(i.startOffset,i.endOffset);e.push(new Ig(!0,o,i.newLength)),t=i.endOffset}return e}class RFe extends K{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new q,this.denseKeyProvider=new Dae,this.brackets=new Nae(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),n=new LFe(this.textModel.getValue(),i);this.initialAstWithoutTokens=jB(n,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Fu(ss(i.fromLineNumber-1,0),ss(i.toLineNumber,0),ss(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Fu.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=WR(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=WR(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const n=t,o=new Tae(this.textModel,this.brackets);return jB(o,e,n,i)}getBracketsInRange(e,t){this.flushQueue();const i=ss(e.startLineNumber-1,e.startColumn-1),n=ss(e.endLineNumber-1,e.endColumn-1);return new l_(o=>{const r=this.initialAstWithoutTokens||this.astWithTokens;KB(r,_r,r.length,i,n,o,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=NC(e.getStartPosition()),n=NC(e.getEndPosition());return new l_(o=>{const r=this.initialAstWithoutTokens||this.astWithTokens,a=new MFe(o,t,this.textModel);GB(r,_r,r.length,i,n,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Aae(t,_r,t.length,NC(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Mae(t,_r,t.length,NC(e))}}function Mae(s,e,t,i){if(s.kind===4||s.kind===2){const n=[];for(const o of s.children)t=On(e,o.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let o=n.length-1;o>=0;o--){const{nodeOffsetStart:r,nodeOffsetEnd:a}=n[o];if(x1(r,i)){const l=Mae(s.children[o],r,a,i);if(l)return l}}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=p_(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function Aae(s,e,t,i){if(s.kind===4||s.kind===2){for(const n of s.children){if(t=On(e,n.length),x1(i,t)){const o=Aae(n,e,t,i);if(o)return o}e=t}return null}else{if(s.kind===3)return null;if(s.kind===1){const n=p_(e,t);return{bracketInfo:s.bracketInfo,range:n}}}return null}function KB(s,e,t,i,n,o,r,a,l,c,d=!1){if(r>200)return!0;e:for(;;)switch(s.kind){case 4:{const h=s.childrenLength;for(let u=0;u<h;u++){const f=s.getChild(u);if(f){if(t=On(e,f.length),L1(e,n)&&wS(t,i)){if(wS(t,n)){s=f;continue e}if(!KB(f,e,t,i,n,o,r,0,l,c))return!1}e=t}}return!0}case 2:{const h=!c||!s.closingBracket||s.closingBracket.bracketInfo.closesColorized(s.openingBracket.bracketInfo);let u=0;if(l){let g=l.get(s.openingBracket.text);g===void 0&&(g=0),u=g,h&&(g++,l.set(s.openingBracket.text,g))}const f=s.childrenLength;for(let g=0;g<f;g++){const m=s.getChild(g);if(m){if(t=On(e,m.length),L1(e,n)&&wS(t,i)){if(wS(t,n)&&m.kind!==1){s=m,h?(r++,a=u+1):a=u;continue e}if((h||m.kind!==1||!s.closingBracket)&&!KB(m,e,t,i,n,o,h?r+1:r,h?u+1:u,l,c,!s.closingBracket))return!1}e=t}}return l==null||l.set(s.openingBracket.text,u),!0}case 3:{const h=p_(e,t);return o(new xX(h,r-1,0,!0))}case 1:{const h=p_(e,t);return o(new xX(h,r-1,a-1,d))}case 0:return!0}}class MFe{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function GB(s,e,t,i,n,o,r,a){var c;if(r>200)return!0;let l=!0;if(s.kind===2){let d=0;if(a){let f=a.get(s.openingBracket.text);f===void 0&&(f=0),d=f,f++,a.set(s.openingBracket.text,f)}const h=On(e,s.openingBracket.length);let u=-1;if(o.includeMinIndentation&&(u=s.computeMinIndentation(e,o.textModel)),l=o.push(new gFe(p_(e,t),p_(e,h),s.closingBracket?p_(On(h,((c=s.child)==null?void 0:c.length)||_r),t):void 0,r,d,s,u)),e=h,l&&s.child){const f=s.child;if(t=On(e,f.length),L1(e,n)&&wS(t,i)&&(l=GB(f,e,t,i,n,o,r+1,a),!l))return!1}a==null||a.set(s.openingBracket.text,d)}else{let d=e;for(const h of s.children){const u=d;if(d=On(d,h.length),L1(u,n)&&L1(i,d)&&(l=GB(h,u,d,i,n,o,r,a),!l))return!1}}return l}class AFe extends K{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new mi),this.onDidChangeEmitter=new q,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(e){var t;(!e.languageId||(t=this.bracketPairsTree.value)!=null&&t.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;(e=this.bracketPairsTree.value)==null||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;(t=this.bracketPairsTree.value)==null||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new oe;this.bracketPairsTree.value=PFe(e.add(new RFe(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!1))||l_.empty}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)==null?void 0:t.object.getBracketPairsInRange(e,!0))||l_.empty}getBracketsInRange(e,t=!1){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)==null?void 0:i.object.getBracketsInRange(e,t))||l_.empty}findMatchingBracketUp(e,t,i){const n=this.textModel.validatePosition(t),o=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column);if(this.canBuildAST){const r=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew.getClosingBracketInfo(e);if(!r)return null;const a=this.getBracketPairsInRange(D.fromPositions(t,t)).findLast(l=>r.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const r=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(o).brackets;if(!a)return null;const l=a.textIsBracket[r];return l?_D(this._findMatchingBracketUp(l,n,lF(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(D.fromPositions(e,e)).filter(n=>n.closingBracketRange!==void 0&&(n.openingBracketRange.containsPosition(e)||n.closingBracketRange.containsPosition(e))).findLastMaxBy(wo(n=>n.openingBracketRange.containsPosition(e)?n.openingBracketRange:n.closingBracketRange,D.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=lF(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,n){const o=t.getCount(),r=t.getLanguageId(n);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=n-1;c>=0;c--){const d=t.getEndOffset(c);if(d<=a)break;if(Rd(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){a=d;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=n+1;c<o;c++){const d=t.getStartOffset(c);if(d>=l)break;if(Rd(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){l=d;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.tokenization.getLineTokens(i),o=this.textModel.getLineContent(i),r=n.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(r)).brackets;if(a&&!Rd(n.getStandardTokenType(r))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,n,a,r),d=null;for(;;){const h=Yl.findNextBracketInRange(a.forwardRegex,i,o,l,c);if(!h)break;if(h.startColumn<=e.column&&e.column<=h.endColumn){const u=o.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),f=this._matchFoundBracket(h,a.textIsBracket[u],a.textIsOpenBracket[u],t);if(f){if(f instanceof bu)return null;d=f}}l=h.endColumn-1}if(d)return d}if(r>0&&n.getStartOffset(r)===e.column-1){const l=r-1,c=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(l)).brackets;if(c&&!Rd(n.getStandardTokenType(l))){const{searchStartOffset:d,searchEndOffset:h}=this._establishBracketSearchOffsets(e,n,c,l),u=Yl.findPrevBracketInRange(c.reversedRegex,i,o,d,h);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn){const f=o.substring(u.startColumn-1,u.endColumn-1).toLowerCase(),g=this._matchFoundBracket(u,c.textIsBracket[f],c.textIsOpenBracket[f],t);if(g)return g instanceof bu?null:g}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const o=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return o?o instanceof bu?o:[e,o]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,o=e.reversedRegex;let r=-1,a=0;const l=(c,d,h,u)=>{for(;;){if(i&&++a%100===0&&!i())return bu.INSTANCE;const f=Yl.findPrevBracketInRange(o,c,d,h,u);if(!f)break;const g=d.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(g)?r++:e.isClose(g)&&r--,r===0)return f;u=f.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const d=this.textModel.tokenization.getLineTokens(c),h=d.getCount(),u=this.textModel.getLineContent(c);let f=h-1,g=u.length,m=u.length;c===t.lineNumber&&(f=d.findTokenIndexAtOffset(t.column-1),g=t.column-1,m=t.column-1);let p=!0;for(;f>=0;f--){const v=d.getLanguageId(f)===n&&!Rd(d.getStandardTokenType(f));if(v)p?g=d.getStartOffset(f):(g=d.getStartOffset(f),m=d.getEndOffset(f));else if(p&&g!==m){const b=l(c,u,g,m);if(b)return b}p=v}if(p&&g!==m){const v=l(c,u,g,m);if(v)return v}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,o=e.forwardRegex;let r=1,a=0;const l=(d,h,u,f)=>{for(;;){if(i&&++a%100===0&&!i())return bu.INSTANCE;const g=Yl.findNextBracketInRange(o,d,h,u,f);if(!g)break;const m=h.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(m)?r++:e.isClose(m)&&r--,r===0)return g;u=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let d=t.lineNumber;d<=c;d++){const h=this.textModel.tokenization.getLineTokens(d),u=h.getCount(),f=this.textModel.getLineContent(d);let g=0,m=0,p=0;d===t.lineNumber&&(g=h.findTokenIndexAtOffset(t.column-1),m=t.column-1,p=t.column-1);let v=!0;for(;g<u;g++){const b=h.getLanguageId(g)===n&&!Rd(h.getStandardTokenType(g));if(b)v||(m=h.getStartOffset(g)),p=h.getEndOffset(g);else if(v&&m!==p){const w=l(d,f,m,p);if(w)return w}v=b}if(v&&m!==p){const b=l(d,f,m,p);if(b)return b}}return null}findPrevBracket(e){var r;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((r=this.bracketPairsTree.value)==null?void 0:r.object.getFirstBracketBefore(t))||null;let i=null,n=null,o=null;for(let a=t.lineNumber;a>=1;a--){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),d=this.textModel.getLineContent(a);let h=c-1,u=d.length,f=d.length;if(a===t.lineNumber){h=l.findTokenIndexAtOffset(t.column-1),u=t.column-1,f=t.column-1;const m=l.getLanguageId(h);i!==m&&(i=m,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let g=!0;for(;h>=0;h--){const m=l.getLanguageId(h);if(i!==m){if(n&&o&&g&&u!==f){const v=Yl.findPrevBracketInRange(n.reversedRegex,a,d,u,f);if(v)return this._toFoundBracket(o,v);g=!1}i=m,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,o=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}const p=!!n&&!Rd(l.getStandardTokenType(h));if(p)g?u=l.getStartOffset(h):(u=l.getStartOffset(h),f=l.getEndOffset(h));else if(o&&n&&g&&u!==f){const v=Yl.findPrevBracketInRange(n.reversedRegex,a,d,u,f);if(v)return this._toFoundBracket(o,v)}g=p}if(o&&n&&g&&u!==f){const m=Yl.findPrevBracketInRange(n.reversedRegex,a,d,u,f);if(m)return this._toFoundBracket(o,m)}}return null}findNextBracket(e){var a;const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((a=this.bracketPairsTree.value)==null?void 0:a.object.getFirstBracketAfter(t))||null;const i=this.textModel.getLineCount();let n=null,o=null,r=null;for(let l=t.lineNumber;l<=i;l++){const c=this.textModel.tokenization.getLineTokens(l),d=c.getCount(),h=this.textModel.getLineContent(l);let u=0,f=0,g=0;if(l===t.lineNumber){u=c.findTokenIndexAtOffset(t.column-1),f=t.column-1,g=t.column-1;const p=c.getLanguageId(u);n!==p&&(n=p,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let m=!0;for(;u<d;u++){const p=c.getLanguageId(u);if(n!==p){if(r&&o&&m&&f!==g){const b=Yl.findNextBracketInRange(o.forwardRegex,l,h,f,g);if(b)return this._toFoundBracket(r,b);m=!1}n=p,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets,r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const v=!!o&&!Rd(c.getStandardTokenType(u));if(v)m||(f=c.getStartOffset(u)),g=c.getEndOffset(u);else if(r&&o&&m&&f!==g){const b=Yl.findNextBracketInRange(o.forwardRegex,l,h,f,g);if(b)return this._toFoundBracket(r,b)}m=v}if(r&&o&&m&&f!==g){const p=Yl.findNextBracketInRange(o.forwardRegex,l,h,f,g);if(p)return this._toFoundBracket(r,p)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const f=D.fromPositions(i),g=this.getBracketPairsInRange(D.fromPositions(i,i)).findLast(m=>m.closingBracketRange!==void 0&&m.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}const n=lF(t),o=this.textModel.getLineCount(),r=new Map;let a=[];const l=(f,g)=>{if(!r.has(f)){const m=[];for(let p=0,v=g?g.brackets.length:0;p<v;p++)m[p]=0;r.set(f,m)}a=r.get(f)};let c=0;const d=(f,g,m,p,v)=>{for(;;){if(n&&++c%100===0&&!n())return bu.INSTANCE;const b=Yl.findNextBracketInRange(f.forwardRegex,g,m,p,v);if(!b)break;const w=m.substring(b.startColumn-1,b.endColumn-1).toLowerCase(),C=f.textIsBracket[w];if(C&&(C.isOpen(w)?a[C.index]++:C.isClose(w)&&a[C.index]--,a[C.index]===-1))return this._matchFoundBracket(b,C,!1,n);p=b.endColumn-1}return null};let h=null,u=null;for(let f=i.lineNumber;f<=o;f++){const g=this.textModel.tokenization.getLineTokens(f),m=g.getCount(),p=this.textModel.getLineContent(f);let v=0,b=0,w=0;if(f===i.lineNumber){v=g.findTokenIndexAtOffset(i.column-1),b=i.column-1,w=i.column-1;const y=g.getLanguageId(v);h!==y&&(h=y,u=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,u))}let C=!0;for(;v<m;v++){const y=g.getLanguageId(v);if(h!==y){if(u&&C&&b!==w){const S=d(u,f,p,b,w);if(S)return _D(S);C=!1}h=y,u=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,u)}const x=!!u&&!Rd(g.getStandardTokenType(v));if(x)C||(b=g.getStartOffset(v)),w=g.getEndOffset(v);else if(u&&C&&b!==w){const S=d(u,f,p,b,w);if(S)return _D(S)}C=x}if(u&&C&&b!==w){const y=d(u,f,p,b,w);if(y)return _D(y)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.getBracketInfo(i);return n?{range:t,bracketInfo:n}:null}}function PFe(s,e){return{object:s,dispose:()=>e==null?void 0:e.dispose()}}function lF(s){if(typeof s>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=s}}const LA=class LA{constructor(){this._searchCanceledBrand=void 0}};LA.INSTANCE=new LA;let bu=LA;function _D(s){return s instanceof bu?null:s}class OFe extends K{constructor(e){super(),this.textModel=e,this.colorProvider=new Pae,this.onDidChangeEmitter=new q,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,n){return n?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(r=>({id:`bracket${r.range.toString()}-${r.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(r,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:r.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new D(1,1,this.textModel.getLineCount(),1),e,t):[]}}class Pae{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}Ul((s,e)=>{const t=[eae,tae,iae,nae,sae,oae],i=new Pae;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${s.getColor(qOe)}; }`);const n=t.map(o=>s.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){const r=n[o%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(o)} { color: ${r}; }`)}});function bD(s){return s.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class mo{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${bD(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${bD(this.oldText)}")`:`(replace@${this.oldPosition} "${bD(this.oldText)}" with "${bD(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;Bc(e,n,i),i+=4;for(let o=0;o<n;o++)GDe(e,t.charCodeAt(o),i),i+=2;return i}static _readString(e,t){const i=Fc(e,t);return t+=4,oRe(e,t,i)}writeSize(){return 8+mo._writeStringSize(this.oldText)+mo._writeStringSize(this.newText)}write(e,t){return Bc(e,this.oldPosition,t),t+=4,Bc(e,this.newPosition,t),t+=4,t=mo._writeString(e,this.oldText,t),t=mo._writeString(e,this.newText,t),t}static read(e,t,i){const n=Fc(e,t);t+=4;const o=Fc(e,t);t+=4;const r=mo._readString(e,t);t+=mo._writeStringSize(r);const a=mo._readString(e,t);return t+=mo._writeStringSize(a),i.push(new mo(n,r,o,a)),t}}function FFe(s,e){return s===null||s.length===0?e:new Fd(s,e).compress()}class Fd{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[c,d]=Fd._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(c),n=d;continue}if(i.newPosition<n.oldPosition){const[c,d]=Fd._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(c),i=d;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[c,d]=Fd._splitPrev(i,n.oldLength);a=c,l=n,i=d,n=this._getCurr(++t)}else{const[c,d]=Fd._splitCurr(n,i.newLength);a=i,l=c,i=this._getPrev(++e),n=d}this._result[this._resultLen++]=new mo(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const o=Fd._merge(this._result);return Fd._removeNoOps(o)}_acceptCurr(e){this._result[this._resultLen++]=Fd._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=Fd._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new mo(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new mo(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new mo(e.oldPosition,e.oldText,e.newPosition,i),new mo(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new mo(e.oldPosition,i,e.newPosition,e.newText),new mo(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,n=e[0];for(let o=1;o<e.length;o++){const r=e[o];n.oldEnd===r.oldPosition?n=new mo(n.oldPosition,n.oldText+r.oldText,n.newPosition,n.newText+r.newText):(t[i++]=n,n=r)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const o=e[n];o.oldText!==o.newText&&(t[i++]=o)}return t}}const BFe=Symbol("TextModelEditSource");class Oae{constructor(e,t){this.metadata=e}toString(){return`${this.metadata.source}`}getType(){const e=this.metadata;switch(e.source){case"cursor":return e.kind;case"inlineCompletionAccept":return e.source+(e.$nes?":nes":"");case"unknown":return e.name||"unknown";default:return e.source}}toKey(e,t={}){const i=this.metadata;return Object.entries(i).filter(([o,r])=>{const a=t[o];return a!==void 0?a:(o.match(/\$/g)||[]).length<=e&&r!==void 0&&r!==null&&r!==""}).map(([o,r])=>`${o}:${r}`).join("-")}}function Er(s){return new Oae(s,BFe)}const ko={unknown(s){return Er({source:"unknown",name:s.name})},rename:()=>Er({source:"rename"}),chatApplyEdits(s){var e,t;return Er({source:"Chat.applyEdits",$modelId:kX(s.modelId),$extensionId:(e=s.extensionId)==null?void 0:e.extensionId,$extensionVersion:(t=s.extensionId)==null?void 0:t.version,$$languageId:s.languageId,$$sessionId:s.sessionId,$$requestId:s.requestId,$$mode:s.mode,$$codeBlockSuggestionId:s.codeBlockSuggestionId})},chatUndoEdits:()=>Er({source:"Chat.undoEdits"}),chatReset:()=>Er({source:"Chat.reset"}),inlineCompletionAccept(s){return Er({source:"inlineCompletionAccept",$nes:s.nes,...vD(s.providerId),$$requestUuid:s.requestUuid,$$languageId:s.languageId})},inlineCompletionPartialAccept(s){return Er({source:"inlineCompletionPartialAccept",type:s.type,$nes:s.nes,...vD(s.providerId),$$requestUuid:s.requestUuid,$$languageId:s.languageId})},inlineChatApplyEdit(s){var e,t;return Er({source:"inlineChat.applyEdits",$modelId:kX(s.modelId),$extensionId:(e=s.extensionId)==null?void 0:e.extensionId,$extensionVersion:(t=s.extensionId)==null?void 0:t.version,$$sessionId:s.sessionId,$$requestId:s.requestId,$$languageId:s.languageId})},reloadFromDisk:()=>Er({source:"reloadFromDisk"}),cursor(s){return Er({source:"cursor",kind:s.kind,detailedSource:s.detailedSource})},setValue:()=>Er({source:"setValue"}),eolChange:()=>Er({source:"eolChange"}),applyEdits:()=>Er({source:"applyEdits"}),snippet:()=>Er({source:"snippet"}),suggest:s=>Er({source:"suggest",...vD(s.providerId)}),codeAction:s=>Er({source:"codeAction",$kind:s.kind,...vD(s.providerId)})};function vD(s){return s?{$extensionId:s.extensionId,$extensionVersion:s.extensionVersion,$providerId:s.providerId}:{}}function kX(s){if(s!==void 0)return s.replaceAll("/","|")}class QL{static fromText(e){const t=xs.ofText(e).lineCount,i=e.length;return new QL(t,0,i,0)}static tryCreate(e,t,i,n){if(!(e===void 0||t===void 0||i===void 0||n===void 0))return new QL(e,t,i,n)}constructor(e,t,i,n){this.linesAdded=e,this.linesRemoved=t,this.charsAdded=i,this.charsRemoved=n}}var DX;(function(s){function e(t){const i=t?t("sgt"):$re("sgt");return i}s.newId=e})(DX||(DX={}));function qv(s){return s.toString()}class zs{static create(e,t){const i=e.getAlternativeVersionId(),n=YB(e);return new zs(i,i,n,n,t,t,[])}constructor(e,t,i,n,o,r,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=o,this.afterCursorState=r,this.changes=a}append(e,t,i,n,o){t.length>0&&(this.changes=FFe(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=o}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,i){if(Bc(e,t?t.length:0,i),i+=4,t)for(const n of t)Bc(e,n.selectionStartLineNumber,i),i+=4,Bc(e,n.selectionStartColumn,i),i+=4,Bc(e,n.positionLineNumber,i),i+=4,Bc(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=Fc(e,t);t+=4;for(let o=0;o<n;o++){const r=Fc(e,t);t+=4;const a=Fc(e,t);t+=4;const l=Fc(e,t);t+=4;const c=Fc(e,t);t+=4,i.push(new Oe(r,a,l,c))}return t}serialize(){let e=10+zs._writeSelectionsSize(this.beforeCursorState)+zs._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;Bc(t,this.beforeVersionId,i),i+=4,Bc(t,this.afterVersionId,i),i+=4,UG(t,this.beforeEOL,i),i+=1,UG(t,this.afterEOL,i),i+=1,i=zs._writeSelections(t,this.beforeCursorState,i),i=zs._writeSelections(t,this.afterCursorState,i),Bc(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=Fc(t,i);i+=4;const o=Fc(t,i);i+=4;const r=zG(t,i);i+=1;const a=zG(t,i);i+=1;const l=[];i=zs._readSelections(t,i,l);const c=[];i=zs._readSelections(t,i,c);const d=Fc(t,i);i+=4;const h=[];for(let u=0;u<d;u++)i=mo.read(t,i,h);return new zs(n,o,r,a,l,c,h)}}class Fae{get type(){return 0}get resource(){return Ze.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,n){this.label=e,this.code=t,this.model=i,this._data=zs.create(i,n)}toString(){return(this._data instanceof zs?this._data:zs.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(Ze.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof zs}append(e,t,i,n,o){this._data instanceof zs&&this._data.append(e,t,i,n,o)}close(){this._data instanceof zs&&(this._data=this._data.serialize())}open(){this._data instanceof zs||(this._data=zs.deserialize(this._data))}undo(){if(Ze.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof zs&&(this._data=this._data.serialize());const e=zs.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(Ze.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof zs&&(this._data=this._data.serialize());const e=zs.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof zs&&(this._data=this._data.serialize()),this._data.byteLength+168}}class WFe{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const o=qv(n.resource);this._editStackElementsMap.set(o,n)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=qv(e);return this._editStackElementsMap.has(t)}setModel(e){const t=qv(Ze.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=qv(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,o){const r=qv(e.uri);this._editStackElementsMap.get(r).append(e,t,i,n,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=qv(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${Fl(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function YB(s){return s.getEOL()===`
`?0:1}function vu(s){return s?s instanceof Fae||s instanceof WFe:!1}class A${constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);vu(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);vu(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(vu(i)&&i.canAppend(this._model))return i;const n=new Fae(_(785,"Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],YB(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n,o=ko.unknown({name:"pushEditOperation"})){const r=this._getOrCreateEditStackElement(e,n),a=this._model.applyEdits(t,!0,o),l=A$._computeCursorState(i,a),c=a.map((d,h)=>({index:h,textChange:d.textChange}));return c.sort((d,h)=>d.textChange.oldPosition===h.textChange.oldPosition?d.index-h.index:d.textChange.oldPosition-h.textChange.oldPosition),r.append(this._model,c.map(d=>d.textChange),YB(this._model),this._model.getAlternativeVersionId(),l),l}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return _t(i),null}}}class HFe{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function VFe(s,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let o;for(o=0;o<e&&o<i;o++){const u=s.charCodeAt(o),f=t.charCodeAt(o);if(u!==f)break}let r=0,a=0;for(let u=o;u<e;u++)s.charCodeAt(u)===32?r++:a++;let l=0,c=0;for(let u=o;u<i;u++)t.charCodeAt(u)===32?l++:c++;if(r>0&&a>0||l>0&&c>0)return;const d=Math.abs(a-c),h=Math.abs(r-l);if(d===0){n.spacesDiff=h,h>0&&0<=l-1&&l-1<s.length&&l<t.length&&t.charCodeAt(l)!==32&&s.charCodeAt(l-1)===32&&s.charCodeAt(s.length-1)===44&&(n.looksLikeAlignment=!0);return}if(h%d===0){n.spacesDiff=h/d;return}}function TX(s,e,t){const i=Math.min(s.getLineCount(),1e4);let n=0,o=0,r="",a=0;const l=[2,4,6,8,3,5,7],c=8,d=[0,0,0,0,0,0,0,0,0],h=new HFe;for(let g=1;g<=i;g++){const m=s.getLineLength(g),p=s.getLineContent(g),v=m<=65536;let b=!1,w=0,C=0,y=0;for(let S=0,L=m;S<L;S++){const E=v?p.charCodeAt(S):s.getLineCharCode(g,S);if(E===9)y++;else if(E===32)C++;else{b=!0,w=S;break}}if(!b||(y>0?n++:C>1&&o++,VFe(r,a,p,w,h),h.looksLikeAlignment&&!(t&&e===h.spacesDiff)))continue;const x=h.spacesDiff;x<=c&&d[x]++,r=p,a=w}let u=t;n!==o&&(u=n<o);let f=e;if(u){let g=u?0:.1*i;l.forEach(m=>{const p=d[m];p>g&&(g=p,f=m)}),f===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(f=2)}return{insertSpaces:u,tabSize:f}}function kr(s){return(s.metadata&1)>>>0}function an(s,e){s.metadata=s.metadata&254|e<<0}function yo(s){return(s.metadata&2)>>>1===1}function sn(s,e){s.metadata=s.metadata&253|(e?1:0)<<1}function Bae(s){return(s.metadata&4)>>>2===1}function NX(s,e){s.metadata=s.metadata&251|(e?1:0)<<2}function Wae(s){return(s.metadata&64)>>>6===1}function RX(s,e){s.metadata=s.metadata&191|(e?1:0)<<6}function Hae(s){return(s.metadata&128)>>>7===1}function MX(s,e){s.metadata=s.metadata&127|(e?1:0)<<7}function zFe(s){return(s.metadata&24)>>>3}function AX(s,e){s.metadata=s.metadata&231|e<<3}function UFe(s){return(s.metadata&32)>>>5===1}function PX(s,e){s.metadata=s.metadata&223|(e?1:0)<<5}class Vae{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,an(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,NX(this,!1),RX(this,!1),AX(this,1),PX(this,!1),MX(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,sn(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;NX(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),RX(this,this.options.glyphMarginClassName!==null),AX(this,this.options.stickiness),PX(this,this.options.collapseOnReplaceEdit),MX(this,this.options.affectsFont??!1)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const Ut=new Vae(null,0,0);Ut.parent=Ut;Ut.left=Ut;Ut.right=Ut;an(Ut,0);class cF{constructor(){this.root=Ut,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,o,r,a){return this.root===Ut?[]:ZFe(this,e,t,i,n,o,r,a)}search(e,t,i,n,o){return this.root===Ut?[]:XFe(this,e,t,i,n,o)}collectNodesFromOwner(e){return GFe(this,e)}collectNodesPostOrder(){return YFe(this)}insert(e){OX(this,e),this._normalizeDeltaIfNecessary()}delete(e){FX(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const o=i.start+n,r=i.end+n;i.setCachedOffsets(o,r,t)}acceptReplace(e,t,i,n){const o=jFe(this,e,e+t);for(let r=0,a=o.length;r<a;r++){const l=o[r];FX(this,l)}this._normalizeDeltaIfNecessary(),KFe(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let r=0,a=o.length;r<a;r++){const l=o[r];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,qFe(l,e,e+t,i,n),l.maxEnd=l.end,OX(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,$Fe(this))}}function $Fe(s){let e=s.root,t=0;for(;e!==Ut;){if(e.left!==Ut&&!yo(e.left)){e=e.left;continue}if(e.right!==Ut&&!yo(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,vm(e),sn(e,!0),sn(e.left,!1),sn(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}sn(s.root,!1)}function jv(s,e,t,i){return s<t?!0:s>t||i===1?!1:i===2?!0:e}function qFe(s,e,t,i,n){const o=zFe(s),r=o===0||o===2,a=o===1||o===2,l=t-e,c=i,d=Math.min(l,c),h=s.start;let u=!1;const f=s.end;let g=!1;e<=h&&f<=t&&UFe(s)&&(s.start=e,u=!0,s.end=e,g=!0);{const p=n?1:l>0?2:0;!u&&jv(h,r,e,p)&&(u=!0),!g&&jv(f,a,e,p)&&(g=!0)}if(d>0&&!n){const p=l>c?2:0;!u&&jv(h,r,e+d,p)&&(u=!0),!g&&jv(f,a,e+d,p)&&(g=!0)}{const p=n?1:0;!u&&jv(h,r,t,p)&&(s.start=e+c,u=!0),!g&&jv(f,a,t,p)&&(s.end=e+c,g=!0)}const m=c-l;u||(s.start=Math.max(0,h+m)),g||(s.end=Math.max(0,f+m)),s.start>s.end&&(s.end=s.start)}function jFe(s,e,t){let i=s.root,n=0,o=0,r=0,a=0;const l=[];let c=0;for(;i!==Ut;){if(yo(i)){sn(i.left,!1),sn(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!yo(i.left)){if(o=n+i.maxEnd,o<e){sn(i,!0);continue}if(i.left!==Ut){i=i.left;continue}}if(r=n+i.start,r>t){sn(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(r,a,0),l[c++]=i),sn(i,!0),i.right!==Ut&&!yo(i.right)){n+=i.delta,i=i.right;continue}}return sn(s.root,!1),l}function KFe(s,e,t,i){let n=s.root,o=0,r=0,a=0;const l=i-(t-e);for(;n!==Ut;){if(yo(n)){sn(n.left,!1),sn(n.right,!1),n===n.parent.right&&(o-=n.parent.delta),vm(n),n=n.parent;continue}if(!yo(n.left)){if(r=o+n.maxEnd,r<e){sn(n,!0);continue}if(n.left!==Ut){n=n.left;continue}}if(a=o+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(s.requestNormalizeDelta=!0),sn(n,!0);continue}if(sn(n,!0),n.right!==Ut&&!yo(n.right)){o+=n.delta,n=n.right;continue}}sn(s.root,!1)}function GFe(s,e){let t=s.root;const i=[];let n=0;for(;t!==Ut;){if(yo(t)){sn(t.left,!1),sn(t.right,!1),t=t.parent;continue}if(t.left!==Ut&&!yo(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),sn(t,!0),t.right!==Ut&&!yo(t.right)){t=t.right;continue}}return sn(s.root,!1),i}function YFe(s){let e=s.root;const t=[];let i=0;for(;e!==Ut;){if(yo(e)){sn(e.left,!1),sn(e.right,!1),e=e.parent;continue}if(e.left!==Ut&&!yo(e.left)){e=e.left;continue}if(e.right!==Ut&&!yo(e.right)){e=e.right;continue}t[i++]=e,sn(e,!0)}return sn(s.root,!1),t}function XFe(s,e,t,i,n,o){let r=s.root,a=0,l=0,c=0;const d=[];let h=0;for(;r!==Ut;){if(yo(r)){sn(r.left,!1),sn(r.right,!1),r===r.parent.right&&(a-=r.parent.delta),r=r.parent;continue}if(r.left!==Ut&&!yo(r.left)){r=r.left;continue}l=a+r.start,c=a+r.end,r.setCachedOffsets(l,c,n);let u=!0;if(e&&r.ownerId&&r.ownerId!==e&&(u=!1),t&&Bae(r)&&(u=!1),i&&Hae(r)&&(u=!1),o&&!Wae(r)&&(u=!1),u&&(d[h++]=r),sn(r,!0),r.right!==Ut&&!yo(r.right)){a+=r.delta,r=r.right;continue}}return sn(s.root,!1),d}function ZFe(s,e,t,i,n,o,r,a){let l=s.root,c=0,d=0,h=0,u=0;const f=[];let g=0;for(;l!==Ut;){if(yo(l)){sn(l.left,!1),sn(l.right,!1),l===l.parent.right&&(c-=l.parent.delta),l=l.parent;continue}if(!yo(l.left)){if(d=c+l.maxEnd,d<e){sn(l,!0);continue}if(l.left!==Ut){l=l.left;continue}}if(h=c+l.start,h>t){sn(l,!0);continue}if(u=c+l.end,u>=e){l.setCachedOffsets(h,u,r);let m=!0;i&&l.ownerId&&l.ownerId!==i&&(m=!1),n&&Bae(l)&&(m=!1),o&&Hae(l)&&(m=!1),a&&!Wae(l)&&(m=!1),m&&(f[g++]=l)}if(sn(l,!0),l.right!==Ut&&!yo(l.right)){c+=l.delta,l=l.right;continue}}return sn(s.root,!1),f}function OX(s,e){if(s.root===Ut)return e.parent=Ut,e.left=Ut,e.right=Ut,an(e,0),s.root=e,s.root;QFe(s,e),$f(e.parent);let t=e;for(;t!==s.root&&kr(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;kr(i)===1?(an(t.parent,0),an(i,0),an(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,ZS(s,t)),an(t.parent,0),an(t.parent.parent,1),QS(s,t.parent.parent))}else{const i=t.parent.parent.left;kr(i)===1?(an(t.parent,0),an(i,0),an(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,QS(s,t)),an(t.parent,0),an(t.parent.parent,1),ZS(s,t.parent.parent))}return an(s.root,0),e}function QFe(s,e){let t=0,i=s.root;const n=e.start,o=e.end;for(;;)if(e3e(n,o,i.start+t,i.end+t)<0)if(i.left===Ut){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===Ut){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=Ut,e.right=Ut,an(e,1)}function FX(s,e){let t,i;if(e.left===Ut?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Ut?(t=e.left,i=e):(i=JFe(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(s.requestNormalizeDelta=!0)),i===s.root){s.root=t,an(t,0),e.detach(),dF(),vm(t),s.root.parent=Ut;return}const n=kr(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,an(i,kr(e)),e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Ut&&(i.left.parent=i),i.right!==Ut&&(i.right.parent=i)),e.detach(),n){$f(t.parent),i!==e&&($f(i),$f(i.parent)),dF();return}$f(t),$f(t.parent),i!==e&&($f(i),$f(i.parent));let o;for(;t!==s.root&&kr(t)===0;)t===t.parent.left?(o=t.parent.right,kr(o)===1&&(an(o,0),an(t.parent,1),ZS(s,t.parent),o=t.parent.right),kr(o.left)===0&&kr(o.right)===0?(an(o,1),t=t.parent):(kr(o.right)===0&&(an(o.left,0),an(o,1),QS(s,o),o=t.parent.right),an(o,kr(t.parent)),an(t.parent,0),an(o.right,0),ZS(s,t.parent),t=s.root)):(o=t.parent.left,kr(o)===1&&(an(o,0),an(t.parent,1),QS(s,t.parent),o=t.parent.left),kr(o.left)===0&&kr(o.right)===0?(an(o,1),t=t.parent):(kr(o.left)===0&&(an(o.right,0),an(o,1),ZS(s,o),o=t.parent.left),an(o,kr(t.parent)),an(t.parent,0),an(o.left,0),QS(s,t.parent),t=s.root));an(t,0),dF()}function JFe(s){for(;s.left!==Ut;)s=s.left;return s}function dF(){Ut.parent=Ut,Ut.delta=0,Ut.start=0,Ut.end=0}function ZS(s,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(s.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Ut&&(t.left.parent=e),t.parent=e.parent,e.parent===Ut?s.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,vm(e),vm(t)}function QS(s,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(s.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Ut&&(t.right.parent=e),t.parent=e.parent,e.parent===Ut?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,vm(e),vm(t)}function zae(s){let e=s.end;if(s.left!==Ut){const t=s.left.maxEnd;t>e&&(e=t)}if(s.right!==Ut){const t=s.right.maxEnd+s.delta;t>e&&(e=t)}return e}function vm(s){s.maxEnd=zae(s)}function $f(s){for(;s!==Ut;){const e=zae(s);if(s.maxEnd===e)return;s.maxEnd=e,s=s.parent}}function e3e(s,e,t,i){return s===t?e-i:s-t}class XB{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Tt)return P$(this.right);let e=this;for(;e.parent!==Tt&&e.parent.left!==e;)e=e.parent;return e.parent===Tt?Tt:e.parent}prev(){if(this.left!==Tt)return Uae(this.left);let e=this;for(;e.parent!==Tt&&e.parent.right!==e;)e=e.parent;return e.parent===Tt?Tt:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const Tt=new XB(null,0);Tt.parent=Tt;Tt.left=Tt;Tt.right=Tt;Tt.color=0;function P$(s){for(;s.left!==Tt;)s=s.left;return s}function Uae(s){for(;s.right!==Tt;)s=s.right;return s}function O$(s){return s===Tt?0:s.size_left+s.piece.length+O$(s.right)}function F$(s){return s===Tt?0:s.lf_left+s.piece.lineFeedCnt+F$(s.right)}function hF(){Tt.parent=Tt}function JS(s,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Tt&&(t.left.parent=e),t.parent=e.parent,e.parent===Tt?s.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function ex(s,e){const t=e.left;e.left=t.right,t.right!==Tt&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Tt?s.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function CD(s,e){let t,i;if(e.left===Tt?(i=e,t=i.right):e.right===Tt?(i=e,t=i.left):(i=P$(e.right),t=i.right),i===s.root){s.root=t,t.color=0,e.detach(),hF(),s.root.parent=Tt;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,yS(s,t)):(i.parent===e?t.parent=i:t.parent=i.parent,yS(s,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===s.root?s.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Tt&&(i.left.parent=i),i.right!==Tt&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,yS(s,i)),e.detach(),t.parent.left===t){const r=O$(t),a=F$(t);if(r!==t.parent.size_left||a!==t.parent.lf_left){const l=r-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=r,t.parent.lf_left=a,tu(s,t.parent,l,c)}}if(yS(s,t.parent),n){hF();return}let o;for(;t!==s.root&&t.color===0;)t===t.parent.left?(o=t.parent.right,o.color===1&&(o.color=0,t.parent.color=1,JS(s,t.parent),o=t.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.right.color===0&&(o.left.color=0,o.color=1,ex(s,o),o=t.parent.right),o.color=t.parent.color,t.parent.color=0,o.right.color=0,JS(s,t.parent),t=s.root)):(o=t.parent.left,o.color===1&&(o.color=0,t.parent.color=1,ex(s,t.parent),o=t.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.left.color===0&&(o.right.color=0,o.color=1,JS(s,o),o=t.parent.left),o.color=t.parent.color,t.parent.color=0,o.left.color=0,ex(s,t.parent),t=s.root));t.color=0,hF()}function BX(s,e){for(yS(s,e);e!==s.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,JS(s,e)),e.parent.color=0,e.parent.parent.color=1,ex(s,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,ex(s,e)),e.parent.color=0,e.parent.parent.color=1,JS(s,e.parent.parent))}s.root.color=0}function tu(s,e,t,i){for(;e!==s.root&&e!==Tt;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function yS(s,e){let t=0,i=0;if(e!==s.root){for(;e!==s.root&&e===e.parent.right;)e=e.parent;if(e!==s.root)for(e=e.parent,t=O$(e.left)-e.size_left,i=F$(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==s.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const t3e=999;class np{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=$ae(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=Bse(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new JNe(t,this.wordSeparators?Bl(this.wordSeparators,[]):null,i?this.searchString:null)}}function $ae(s){if(!s||s.length===0)return!1;for(let e=0,t=s.length;e<t;e++){const i=s.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=s.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function vp(s,e,t){if(!t)return new IL(s,null);const i=[];for(let n=0,o=e.length;n<o;n++)i[n]=e[n];return new IL(s,i)}class WX{constructor(e){const t=[];let i=0;for(let n=0,o=e.length;n<o;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){const o=i+((n-i)/2>>0);t[o]>=e?n=o-1:t[o+1]>=e?(i=o,n=o):i=o+1}return i+1}}class wD{static findMatches(e,t,i,n,o){const r=t.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(e,i,new RC(r.wordSeparators,r.regex),n,o):this._doFindMatchesLineByLine(e,i,r,n,o):[]}static _getMultilineMatchRange(e,t,i,n,o,r){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(o),a=t+o+l):a=t+o;let c;if(n){const f=n.findLineFeedCountBeforeOffset(o+r.length)-l;c=a+r.length+f}else c=a+r.length;const d=e.getPositionAt(a),h=e.getPositionAt(c);return new D(d.lineNumber,d.column,h.lineNumber,h.column)}static _doFindMatchesMultiline(e,t,i,n,o){const r=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new WX(a):null,c=[];let d=0,h;for(i.reset(0);h=i.next(a);)if(c[d++]=vp(this._getMultilineMatchRange(e,r,a,l,h.index,h[0]),h,n),d>=o)return c;return c}static _doFindMatchesLineByLine(e,t,i,n,o){const r=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,r,n,o),r}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,r,n,o);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<o;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,r,n,o);if(a<o){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,r,n,o)}return r}static _findMatchesInLine(e,t,i,n,o,r,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const u=e.simpleSearch,f=u.length,g=t.length;let m=-f;for(;(m=t.indexOf(u,m+f))!==-1;)if((!c||B$(c,t,g,m,f))&&(r[o++]=new IL(new D(i,m+1+n,i,m+1+f+n),null),o>=l))return o;return o}const d=new RC(e.wordSeparators,e.regex);let h;d.reset(0);do if(h=d.next(t),h&&(r[o++]=vp(new D(i,h.index+1+n,i,h.index+1+h[0].length+n),h,a),o>=l))return o;while(h);return o}static findNextMatch(e,t,i,n){const o=t.parseSearchRequest();if(!o)return null;const r=new RC(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(e,i,r,n):this._doFindNextMatchLineByLine(e,i,r,n)}static _doFindNextMatchMultiline(e,t,i,n){const o=new z(t.lineNumber,1),r=e.getOffsetAt(o),a=e.getLineCount(),l=e.getValueInRange(new D(o.lineNumber,o.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new WX(l):null;i.reset(t.column-1);const d=i.next(l);return d?vp(this._getMultilineMatchRange(e,r,l,c,d.index,d[0]),d,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new z(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const o=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r),l=this._findFirstMatchInLine(i,a,r,t.column,n);if(l)return l;for(let c=1;c<=o;c++){const d=(r+c-1)%o,h=e.getLineContent(d+1),u=this._findFirstMatchInLine(i,h,d+1,1,n);if(u)return u}return null}static _findFirstMatchInLine(e,t,i,n,o){e.reset(n-1);const r=e.next(t);return r?vp(new D(i,r.index+1,i,r.index+1+r[0].length),r,o):null}static findPreviousMatch(e,t,i,n){const o=t.parseSearchRequest();if(!o)return null;const r=new RC(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(e,i,r,n):this._doFindPreviousMatchLineByLine(e,i,r,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const o=this._doFindMatchesMultiline(e,new D(1,1,t.lineNumber,t.column),i,n,10*t3e);if(o.length>0)return o[o.length-1];const r=e.getLineCount();return t.lineNumber!==r||t.column!==e.getLineMaxColumn(r)?this._doFindPreviousMatchMultiline(e,new z(r,e.getLineMaxColumn(r)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const o=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,r,n);if(l)return l;for(let c=1;c<=o;c++){const d=(o+r-c-1)%o,h=e.getLineContent(d+1),u=this._findLastMatchInLine(i,h,d+1,n);if(u)return u}return null}static _findLastMatchInLine(e,t,i,n){let o=null,r;for(e.reset(0);r=e.next(t);)o=vp(new D(i,r.index+1,i,r.index+1+r[0].length),r,n);return o}}function i3e(s,e,t,i,n){if(i===0)return!0;const o=e.charCodeAt(i-1);if(s.get(o)!==0||o===13||o===10)return!0;if(n>0){const r=e.charCodeAt(i);if(s.get(r)!==0)return!0}return!1}function n3e(s,e,t,i,n){if(i+n===t)return!0;const o=e.charCodeAt(i+n);if(s.get(o)!==0||o===13||o===10)return!0;if(n>0){const r=e.charCodeAt(i+n-1);if(s.get(r)!==0)return!0}return!1}function B$(s,e,t,i,n){return i3e(s,e,t,i,n)&&n3e(s,e,t,i,n)}class RC{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,o=i[0].length;if(n===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){HN(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=o,!this._wordSeparators||B$(this._wordSeparators,e,t,n,o))return i}while(i);return null}}const jh=65535;function qae(s){let e;return s[s.length-1]<65536?e=new Uint16Array(s.length):e=new Uint32Array(s.length),e.set(s,0),e}class s3e{constructor(e,t,i,n,o){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=o}}function ou(s,e=!0){const t=[0];let i=1;for(let n=0,o=s.length;n<o;n++){const r=s.charCodeAt(n);r===13?n+1<o&&s.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:r===10&&(t[i++]=n+1)}return e?qae(t):t}function o3e(s,e){s.length=0,s[0]=0;let t=1,i=0,n=0,o=0,r=!0;for(let l=0,c=e.length;l<c;l++){const d=e.charCodeAt(l);d===13?l+1<c&&e.charCodeAt(l+1)===10?(o++,s[t++]=l+2,l++):(i++,s[t++]=l+1):d===10?(n++,s[t++]=l+1):r&&d!==9&&(d<32||d>126)&&(r=!1)}const a=new s3e(qae(s),i,n,o,r);return s.length=0,a}class Kr{constructor(e,t,i,n,o){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=o}}class Cp{constructor(e,t){this.buffer=e,this.lineStarts=t}}class r3e{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Tt&&e.iterate(e.root,i=>(i!==Tt&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class a3e{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const o=i[n];if(o.node.parent===null||o.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const o of i)o!==null&&n.push(o);this._cache=n}}}class l3e{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new Cp("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Tt,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let o=0,r=e.length;o<r;o++)if(e[o].buffer.length>0){e[o].lineStarts||(e[o].lineStarts=ou(e[o].buffer));const a=new Kr(o+1,{line:0,column:0},{line:e[o].lineStarts.length-1,column:e[o].buffer.length-e[o].lineStarts[e[o].lineStarts.length-1]},e[o].lineStarts.length-1,e[o].buffer.length);this._buffers.push(e[o]),n=this.rbInsertRight(n,a)}this._searchCache=new a3e(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=jh,i=t-Math.floor(t/3),n=i*2;let o="",r=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),d=c.length;if(r<=i||r+d<n)return o+=c,r+=d,!0;const h=o.replace(/\r\n|\r|\n/g,e);return a.push(new Cp(h,ou(h))),o=c,r=d,!0}),r>0){const l=o.replace(/\r\n|\r|\n/g,e);a.push(new Cp(l,ou(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new r3e(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==Tt;)if(n.left!==Tt&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const o=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=o+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==Tt;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const o=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+o.index,o.index===0){const r=this.getOffsetAt(i+1,1),a=n-r;return new z(i+1,a+1)}return new z(i+1,o.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===Tt){const o=this.getOffsetAt(i+1,1),r=n-e-o;return new z(i+1,r+1)}else t=t.right;return new z(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),o=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,t):o}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let r=n.substring(o+e.remainder,o+i.piece.length);for(i=i.next();i!==Tt;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){r+=a.substring(l,l+t.remainder);break}else r+=a.substr(l,i.piece.length);i=i.next()}return r}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,o=>{if(o===Tt)return!0;const r=o.piece;let a=r.length;if(a===0)return!0;const l=this._buffers[r.bufferIndex].buffer,c=this._buffers[r.bufferIndex].lineStarts,d=r.start.line,h=r.end.line;let u=c[d]+r.start.column;if(n&&(l.charCodeAt(u)===10&&(u++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(d===h)return!this._EOLNormalized&&l.charCodeAt(u+a-1)===13?(n=!0,i+=l.substr(u,a-1)):i+=l.substr(u,a),!0;i+=this._EOLNormalized?l.substring(u,Math.max(u,c[d+1]-this._EOLLength)):l.substring(u,c[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=d+1;f<h;f++)i=this._EOLNormalized?l.substring(c[f],c[f+1]-this._EOLLength):l.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[h]+r.end.column-1)===13?(n=!0,r.end.column===0?t--:i=l.substr(c[h],r.end.column-1)):i=l.substr(c[h],r.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===Tt)return"";const n=this._buffers[i.piece.bufferIndex],o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.substring(o,o+i.piece.length)}else{const i=this._buffers[t.node.piece.bufferIndex],n=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),o=n+t.remainder,r=n+t.node.piece.length;return i.buffer.substring(o,r)}}findMatchesInNode(e,t,i,n,o,r,a,l,c,d,h){const u=this._buffers[e.piece.bufferIndex],f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,o),m=this.offsetInBuffer(e.piece.bufferIndex,r);let p;const v={line:0,column:0};let b,w;t._wordSeparators?(b=u.buffer.substring(g,m),w=C=>C+g,t.reset(0)):(b=u.buffer,w=C=>C,t.reset(g));do if(p=t.next(b),p){if(w(p.index)>=m)return d;this.positionInBuffer(e,w(p.index)-f,v);const C=this.getLineFeedCnt(e.piece.bufferIndex,o,v),y=v.line===o.line?v.column-o.column+n:v.column+1,x=y+p[0].length;if(h[d++]=vp(new D(i+C,y,i+C,x),p,l),w(p.index)+p[0].length>=m||d>=c)return d}while(p);return d}findMatchesLineByLine(e,t,i,n){const o=[];let r=0;const a=new RC(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let d=this.positionInBuffer(l.node,l.remainder);const h=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,d,h,t,i,n,r,o),o;let u=e.startLineNumber,f=l.node;for(;f!==c.node;){const m=this.getLineFeedCnt(f.piece.bufferIndex,d,f.piece.end);if(m>=1){const v=this._buffers[f.piece.bufferIndex].lineStarts,b=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start),w=v[d.line+m],C=u===e.startLineNumber?e.startColumn:1;if(r=this.findMatchesInNode(f,a,u,C,d,this.positionInBuffer(f,w-b),t,i,n,r,o),r>=n)return o;u+=m}const p=u===e.startLineNumber?e.startColumn-1:0;if(u===e.endLineNumber){const v=this.getLineContent(u).substring(p,e.endColumn-1);return r=this._findMatchesInLine(t,a,v,e.endLineNumber,p,r,o,i,n),o}if(r=this._findMatchesInLine(t,a,this.getLineContent(u).substr(p),u,p,r,o,i,n),r>=n)return o;u++,l=this.nodeAt2(u,1),f=l.node,d=this.positionInBuffer(l.node,l.remainder)}if(u===e.endLineNumber){const m=u===e.startLineNumber?e.startColumn-1:0,p=this.getLineContent(u).substring(m,e.endColumn-1);return r=this._findMatchesInLine(t,a,p,e.endLineNumber,m,r,o,i,n),o}const g=u===e.startLineNumber?e.startColumn:1;return r=this.findMatchesInNode(c.node,a,u,g,d,h,t,i,n,r,o),o}_findMatchesInLine(e,t,i,n,o,r,a,l,c){const d=e.wordSeparators;if(!l&&e.simpleSearch){const u=e.simpleSearch,f=u.length,g=i.length;let m=-f;for(;(m=i.indexOf(u,m+f))!==-1;)if((!d||B$(d,i,g,m,f))&&(a[r++]=new IL(new D(n,m+1+o,n,m+1+f+o),null),r>=c))return r;return r}let h;t.reset(0);do if(h=t.next(i),h&&(a[r++]=vp(new D(n,h.index+1+o,n,h.index+1+h[0].length+o),h,l),r>=c))return r;while(h);return r}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Tt){const{node:n,remainder:o,nodeStartOffset:r}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,c=this.positionInBuffer(n,o);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&r+a.length===e&&t.length<jh){this.appendToNode(n,t),this.computeBufferMetadata();return}if(r===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(r+n.piece.length>e){const d=[];let h=new Kr(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,o)===10){const m={line:h.start.line+1,column:0};h=new Kr(h.bufferIndex,m,h.end,this.getLineFeedCnt(h.bufferIndex,m,h.end),h.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,o-1)===13){const m=this.positionInBuffer(n,o-1);this.deleteNodeTail(n,m),t="\r"+t,n.piece.length===0&&d.push(n)}else this.deleteNodeTail(n,c);else this.deleteNodeTail(n,c);const u=this.createNewPieces(t);h.length>0&&this.rbInsertRight(n,h);let f=n;for(let g=0;g<u.length;g++)f=this.rbInsertRight(f,u[g]);this.deleteNodes(d)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let o=this.rbInsertLeft(null,n[0]);for(let r=1;r<n.length;r++)o=this.rbInsertRight(o,n[r])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Tt)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),o=i.node,r=n.node;if(o===r){const u=this.positionInBuffer(o,i.remainder),f=this.positionInBuffer(o,n.remainder);if(i.nodeStartOffset===e){if(t===o.piece.length){const g=o.next();CD(this,o),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(o,f),this._searchCache.validate(e),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(i.nodeStartOffset+o.piece.length===e+t){this.deleteNodeTail(o,u),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,u,f),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(e),o.piece.length===0&&a.push(o);const c=this.positionInBuffer(r,n.remainder);this.deleteNodeHead(r,c),r.piece.length===0&&a.push(r);const d=o.next();for(let u=d;u!==Tt&&u!==r;u=u.next())a.push(u);const h=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(h),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const r=t.piece,a={line:r.start.line+1,column:0},l=new Kr(r.bufferIndex,a,r.end,this.getLineFeedCnt(r.bufferIndex,a,r.end),r.length-1);t.piece=l,e+=`
`,tu(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let o=this.rbInsertLeft(t,n[n.length-1]);for(let r=n.length-2;r>=0;r--)o=this.rbInsertLeft(o,n[r]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let o=n;for(let r=1;r<i.length;r++)o=this.rbInsertRight(o,i[r]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,o=e.piece.bufferIndex,r=this._buffers[o].lineStarts,l=r[n.start.line]+n.start.column+t;let c=n.start.line,d=n.end.line,h=0,u=0,f=0;for(;c<=d&&(h=c+(d-c)/2|0,f=r[h],h!==d);)if(u=r[h+1],l<f)d=h-1;else if(l>=u)c=h+1;else break;return i?(i.line=h,i.column=l-f,null):{line:h,column:l-f}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const o=n[i.line+1],r=n[i.line]+i.column;if(o>r+1)return i.line-t.line;const a=r-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)CD(this,e[t])}createNewPieces(e){if(e.length>jh){const d=[];for(;e.length>jh;){const u=e.charCodeAt(jh-1);let f;u===13||u>=55296&&u<=56319?(f=e.substring(0,jh-1),e=e.substring(jh-1)):(f=e.substring(0,jh),e=e.substring(jh));const g=ou(f);d.push(new Kr(this._buffers.length,{line:0,column:0},{line:g.length-1,column:f.length-g[g.length-1]},g.length-1,f.length)),this._buffers.push(new Cp(f,g))}const h=ou(e);return d.push(new Kr(this._buffers.length,{line:0,column:0},{line:h.length-1,column:e.length-h[h.length-1]},h.length-1,e.length)),this._buffers.push(new Cp(e,h)),d}let t=this._buffers[0].buffer.length;const i=ou(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let d=0;d<i.length;d++)i[d]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let d=0;d<i.length;d++)i[d]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const o=this._buffers[0].buffer.length,r=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[r],l={line:r,column:a},c=new Kr(0,n,l,this.getLineFeedCnt(0,n,l),o-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,n="";const o=this._searchCache.get2(e);if(o){i=o.node;const r=this.getAccumulatedValue(i,e-o.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+r,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-o.nodeStartLineNumber);return a.substring(l+r,l+c-t)}}else{let r=0;const a=e;for(;i!==Tt;)if(i.left!==Tt&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),d=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:r,nodeStartLineNumber:a-(e-1-i.lf_left)}),d.substring(h+l,h+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=c.substring(d+l,d+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==Tt;){const r=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=r.substring(l,l+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=r.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==Tt;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),o=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const r=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(r!==o)return{index:r,remainder:0}}return{index:o,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+t+1;return o>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[o]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),r=t,a=this.offsetInBuffer(i.bufferIndex,r),l=this.getLineFeedCnt(i.bufferIndex,i.start,r),c=l-n,d=a-o,h=i.length+d;e.piece=new Kr(i.bufferIndex,i.start,r,l,h),tu(this,e,d,c)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),r=t,a=this.getLineFeedCnt(i.bufferIndex,r,i.end),l=this.offsetInBuffer(i.bufferIndex,r),c=a-n,d=o-l,h=i.length+d;e.piece=new Kr(i.bufferIndex,r,i.end,a,h),tu(this,e,d,c)}shrinkNode(e,t,i){const n=e.piece,o=n.start,r=n.end,a=n.length,l=n.lineFeedCnt,c=t,d=this.getLineFeedCnt(n.bufferIndex,n.start,c),h=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,o);e.piece=new Kr(n.bufferIndex,n.start,c,d,h),tu(this,e,h-a,d-l);const u=new Kr(n.bufferIndex,i,r,this.getLineFeedCnt(n.bufferIndex,i,r),this.offsetInBuffer(n.bufferIndex,r)-this.offsetInBuffer(n.bufferIndex,i)),f=this.rbInsertRight(e,u);this.validateCRLFWithPrevNode(f)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const o=ou(t,!1);for(let f=0;f<o.length;f++)o[f]+=n;if(i){const f=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-f}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));const r=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[r],l={line:r,column:a},c=e.piece.length+t.length,d=e.piece.lineFeedCnt,h=this.getLineFeedCnt(0,e.piece.start,l),u=h-d;e.piece=new Kr(e.piece.bufferIndex,e.piece.start,l,h,c),this._lastChangeBufferPos=l,tu(this,e,t.length,u)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==Tt;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const o={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(o),o}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==Tt;)if(i.left!==Tt&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2),r=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(o+t-1,r),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2);if(o+t-1<=i.piece.length)return{node:i,remainder:o+t-1,nodeStartOffset:n};t-=i.piece.length-o;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==Tt;){if(i.piece.lineFeedCnt>0){const o=this.getAccumulatedValue(i,0),r=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,o),nodeStartOffset:r}}else if(i.piece.length>=t-1){const o=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:o}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Tt||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,o=i[n]+t.start.column;return n===i.length-1||i[n+1]>o+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Tt||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let o;e.piece.end.column===0?o={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:o={line:e.piece.end.line,column:e.piece.end.column-1};const r=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Kr(e.piece.bufferIndex,e.piece.start,o,a,r),tu(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Kr(t.piece.bufferIndex,l,t.piece.end,d,c),tu(this,t,-1,-1),t.piece.length===0&&i.push(t);const h=this.createNewPieces(`\r
`);this.rbInsertRight(e,h[0]);for(let u=0;u<i.length;u++)CD(this,i[u])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)CD(this,i);else{const n=i.piece,o={line:n.start.line+1,column:0},r=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,o,n.end);i.piece=new Kr(n.bufferIndex,o,n.end,a,r),tu(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Tt)return t(Tt);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Tt)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,o)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new XB(t,1);if(i.left=Tt,i.right=Tt,i.parent=Tt,i.size_left=0,i.lf_left=0,this.root===Tt)this.root=i,i.color=0;else if(e.right===Tt)e.right=i,i.parent=e;else{const o=P$(e.right);o.left=i,i.parent=o}return BX(this,i),i}rbInsertLeft(e,t){const i=new XB(t,1);if(i.left=Tt,i.right=Tt,i.parent=Tt,i.size_left=0,i.lf_left=0,this.root===Tt)this.root=i,i.color=0;else if(e.left===Tt)e.left=i,i.parent=e;else{const n=Uae(e.left);n.right=i,i.parent=n}return BX(this,i),i}}class I1 extends K{constructor(e,t,i,n,o,r,a){super(),this._onDidChangeContent=this._register(new q),this._BOM=t,this._mightContainNonBasicASCII=!r,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._pieceTree=new l3e(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),o=this.getPositionAt(i);return new D(n.lineNumber,n.column,o.lineNumber,o.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let o=0;const r=this._getEndOfLine(t),a=this.getEOL();if(r.length!==a.length){const l=r.length-a.length,c=e.endLineNumber-e.startLineNumber;o=l*c}return n-i+o}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,o=e.endLineNumber;for(let r=n;r<=o;r++){const a=this.getLineContent(r),l=r===n?e.startColumn-1:0,c=r===o?e.endColumn-1:a.length;for(let d=l;d<c;d++)vs(a.charCodeAt(d))?(i=i+1,d=d+1):i=i+1}return i+=this._getEndOfLine(t).length*(o-n),i}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=Jo(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=uc(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,a=!0,l=[];for(let m=0;m<e.length;m++){const p=e[m];a&&p._isTracked&&(a=!1);const v=p.range;if(p.text){let x=!0;r||(x=!ck(p.text),r=x),!n&&x&&(n=pw(p.text)),!o&&x&&(o=zse(p.text))}let b="",w=0,C=0,y=0;if(p.text){let x;[w,C,y,x]=bm(p.text);const S=this.getEOL();x===0||x===(S===`\r
`?2:1)?b=p.text:b=p.text.replace(/\r\n|\r|\n/g,S)}l[m]={sortIndex:m,identifier:p.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:b,eolCount:w,firstLineLength:C,lastLineLength:y,forceMoveMarkers:!!p.forceMoveMarkers,isAutoWhitespaceEdit:p.isAutoWhitespaceEdit||!1}}l.sort(I1._sortOpsAscending);let c=!1;for(let m=0,p=l.length-1;m<p;m++){const v=l[m].range.getEndPosition(),b=l[m+1].range.getStartPosition();if(b.isBeforeOrEqual(v)){if(b.isBefore(v))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const d=i||t?I1._getInverseEditRanges(l):[],h=[];if(t)for(let m=0;m<l.length;m++){const p=l[m],v=d[m];if(p.isAutoWhitespaceEdit&&p.range.isEmpty())for(let b=v.startLineNumber;b<=v.endLineNumber;b++){let w="";b===v.startLineNumber&&(w=this.getLineContent(p.range.startLineNumber),Jo(w)!==-1)||h.push({lineNumber:b,oldContent:w})}}let u=null;if(i){let m=0;u=[];for(let p=0;p<l.length;p++){const v=l[p],b=d[p],w=this.getValueInRange(v.range),C=v.rangeOffset+m;m+=v.text.length-w.length,u[p]={sortIndex:v.sortIndex,identifier:v.identifier,range:b,text:w,textChange:new mo(v.rangeOffset,w,C,v.text)}}c||u.sort((p,v)=>p.sortIndex-v.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=r;const f=this._doApplyEdits(l);let g=null;if(t&&h.length>0){h.sort((m,p)=>p.lineNumber-m.lineNumber),g=[];for(let m=0,p=h.length;m<p;m++){const v=h[m].lineNumber;if(m>0&&h[m-1].lineNumber===v)continue;const b=h[m].oldContent,w=this.getLineContent(v);w.length===0||w===b||Jo(w)!==-1||g.push(v)}}return this._onDidChangeContent.fire(),new eRe(u,f,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,o=new D(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let r=i.startLineNumber,a=i.startColumn;const l=[];for(let f=0,g=e.length;f<g;f++){const m=e[f],p=m.range;t=t||m.forceMoveMarkers,l.push(this.getValueInRange(new D(r,a,p.startLineNumber,p.startColumn))),m.text.length>0&&l.push(m.text),r=p.endLineNumber,a=p.endColumn}const c=l.join(""),[d,h,u]=bm(c);return{sortIndex:0,identifier:e[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:c,eolCount:d,firstLineLength:h,lastLineLength:u,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(I1._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],o=n.range.startLineNumber,r=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(o===a&&r===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new D(o,r,a,l);t.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,o=null;for(let r=0,a=e.length;r<a;r++){const l=e[r];let c,d;o?o.range.endLineNumber===l.range.startLineNumber?(c=i,d=n+(l.range.startColumn-o.range.endColumn)):(c=i+(l.range.startLineNumber-o.range.endLineNumber),d=l.range.startColumn):(c=l.range.startLineNumber,d=l.range.startColumn);let h;if(l.text.length>0){const u=l.eolCount+1;u===1?h=new D(c,d,c,d+l.firstLineLength):h=new D(c,d,c+u-1,l.lastLineLength+1)}else h=new D(c,d,c,d);i=h.endLineNumber,n=h.endColumn,t.push(h),o=l}return t}static _sortOpsAscending(e,t){const i=D.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=D.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class c3e{constructor(e,t,i,n,o,r,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=o,this._containsRTL=r,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,r=i.length;o<r;o++){const a=i[o].buffer.replace(/\r\n|\r|\n/g,t),l=ou(a);i[o]=new Cp(a,l)}const n=new I1(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class jae{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&LU(e)&&(this.BOM=bDe,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=o3e(this._tmpLineStarts,e);this.chunks.push(new Cp(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=pw(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=zse(e)))}finish(e=!0){return this._finish(),new c3e(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=ou(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}function xl(s,e=Ls.ofCaller()){return typeof s=="string"?new HX(s,void 0,e):new HX(void 0,s,e)}class HX extends Jy{get debugName(){return new So(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t,i){super(i),this._debugName=e,this._owner=t}trigger(e,t){if(!e){Ki(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this._observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}class d3e extends Jy{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i,n){super(n),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){var e,t;if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const i of this._deltas){(e=Ro())==null||e.handleObservableUpdated(this,{change:i,didChange:!0,oldValue:"(unknown)",newValue:this._value,hadValue:!0});for(const n of this._observers)n.handleChange(this,i)}this._deltas.length=0}else{(t=Ro())==null||t.handleObservableUpdated(this,{change:void 0,didChange:!0,oldValue:"(unknown)",newValue:this._value,hadValue:!0});for(const i of this._observers)i.handleChange(this,void 0)}}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this._observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this._observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this._observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this._observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new t0(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(o,r)=>{},handlePossibleChange:o=>{}},this),this._updateCounter>1)for(const o of this._observers)o.handlePossibleChange(this)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function tx(s,e,t=Ls.ofCaller()){return s.lazy?new d3e(new So(s.owner,s.debugName,void 0),e,s.equalsFn??Ja,t):new CL(new So(s.owner,s.debugName,void 0),e,s.equalsFn??Ja,t)}class h3e{constructor(){this._onDidChangeVisibleRanges=new q,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set,this._viewsChanged=xl(this),this.visibleLineRanges=_o({owner:this,equalsFn:bL(NU())},e=>(this._viewsChanged.read(e),dt.joinMany([...this._views].map(i=>{var n;return((n=i.state.read(e))==null?void 0:n.visibleLineRanges)??[]}))))}attachView(){const e=new f3e(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),this._viewsChanged.trigger(void 0),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0}),this._viewsChanged.trigger(void 0)}}class u3e{constructor(e,t){this.visibleLineRanges=e,this.stabilized=t}equals(e){return this===e?!0:!(!dn(this.visibleLineRanges,e.visibleLineRanges,(t,i)=>t.equals(i))||this.stabilized!==e.stabilized)}}class f3e{get state(){return this._state}constructor(e){this.handleStateChange=e,this._state=tx({owner:this,equalsFn:Up((t,i)=>t.equals(i))},void 0)}setVisibleLines(e,t){const i=e.map(o=>new dt(o.startLineNumber,o.endLineNumber+1)),n=new u3e(i,t);this._state.set(n,void 0,void 0),this.handleStateChange(n)}}class g3e extends K{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new Ni(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){dn(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class Kae extends K{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t){super(),this._languageIdCodec=e,this._textModel=t,this._onDidChangeTokens=this._register(new q),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}}function m3e(s,e){const t=s.gotoNextSibling(),i=e.gotoNextSibling();if(t!==i)throw new Error("Trees are out of sync");return t&&i}function Gae(s,e){const t=s.gotoParent(),i=e.gotoParent();if(t!==i)throw new Error("Trees are out of sync");return t&&i}function p3e(s,e,t){const i=s.gotoFirstChild(),n=e.gotoFirstChild();if(i!==n)throw new Error("Trees are out of sync");if(t===0)return i&&n;for(let o=1;o<=t;o++){const r=s.gotoNextSibling(),a=e.gotoNextSibling();if(r!==a)throw new Error("Trees are out of sync");if(!r||!a)return!1}return i&&n}function VX(s,e){do{if(s.currentNode.nextSibling)return m3e(s,e);s.currentNode.parent&&Gae(s,e)}while(s.currentNode.nextSibling||s.currentNode.parent);return!1}function _3e(s,e){const t=e.walk();t.resetTo(s);const i=s.currentNode;do if(t.currentNode.previousSibling&&t.currentNode.endIndex-t.currentNode.startIndex!==0)t.gotoPreviousSibling();else{for(;!t.currentNode.previousSibling&&t.currentNode.parent;)t.gotoParent();t.gotoPreviousSibling()}while(t.currentNode.endIndex>i.startIndex&&(t.currentNode.parent||t.currentNode.previousSibling)&&t.currentNode.id!==i.id);if(t.currentNode.id!==i.id&&t.currentNode.endIndex<=i.startIndex)return t.currentNode}var b3e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},zX=function(s,e){return function(t,i){e(t,i,s)}};let ZB=class extends K{constructor(e,t,i,n,o,r,a){super(),this.languageId=e,this._ranges=t,this._parser=i,this._parserClass=n,this.textModel=o,this._logService=r,this._telemetryService=a,this._tree=ht(this,void 0),this.tree=this._tree,this._treeLastParsedVersion=ht(this,-1),this.treeLastParsedVersion=this._treeLastParsedVersion,this._onDidChangeContentQueue=new nDe,this._tree=ht(this,void 0),this.tree=this._tree,this._register(Ve(()=>{var l,c,d;(l=this._tree.get())==null||l.delete(),(c=this._lastFullyParsed)==null||c.delete(),(d=this._lastFullyParsedWithEdits)==null||d.delete(),this._parser.delete()})),this.handleContentChange(void 0,this._ranges)}handleContentChange(e,t){const i=this.textModel.getVersionId();let n=[];t&&(n=this._setRanges(t)),e&&this._applyEdits(e.changes),this._onDidChangeContentQueue.clearPending(),this._onDidChangeContentQueue.schedule(async()=>{if(this._store.isDisposed)return;const o=this._lastFullyParsed;let r;this._lastFullyParsedWithEdits&&this._lastFullyParsed&&(r=this._findChangedNodes(this._lastFullyParsedWithEdits,this._lastFullyParsed));const a=await this._parseAndUpdateTree(i);if(a){let l;r?o&&r&&(l=this._findTreeChanges(a,r,n)):this._ranges&&(l=this._ranges.map(d=>({newRange:new D(d.startPosition.row+1,d.startPosition.column+1,d.endPosition.row+1,d.endPosition.column+1),oldRangeLength:d.endIndex-d.startIndex,newRangeStartOffset:d.startIndex,newRangeEndOffset:d.endIndex}))),l||(l=[{newRange:this.textModel.getFullModelRange(),newRangeStartOffset:0,newRangeEndOffset:this.textModel.getValueLength()}]);const c=this._tree.get();Ki(d=>{this._tree.set(a,d,{ranges:l,versionId:i}),this._treeLastParsedVersion.set(i,d)}),c==null||c.delete()}})}_applyEdits(e){var t,i;for(const n of e){const o=xs.ofRange(D.lift(n.range)),r=xs.ofText(n.text),a=n.text.length===0?r:o.add(r),l={startIndex:n.rangeOffset,oldEndIndex:n.rangeOffset+n.rangeLength,newEndIndex:n.rangeOffset+n.text.length,startPosition:{row:n.range.startLineNumber-1,column:n.range.startColumn-1},oldEndPosition:{row:n.range.endLineNumber-1,column:n.range.endColumn-1},newEndPosition:{row:n.range.startLineNumber+a.lineCount-1,column:a.lineCount?a.columnCount:n.range.endColumn+a.columnCount}};(t=this._tree.get())==null||t.edit(l),(i=this._lastFullyParsedWithEdits)==null||i.edit(l)}}_findChangedNodes(e,t){if(this._ranges&&this._ranges.every(a=>a.startPosition.row!==e.rootNode.startPosition.row)||e.rootNode.startPosition.row!==0)return[];const i=e.walk(),n=t.walk(),o=[];let r=!0;do if(i.currentNode.hasChanges){const a=i.currentNode.children,l=[],c=a.filter((d,h)=>d!=null&&d.hasChanges||n.currentNode.children.length<=h?(l.push(h),!0):!1);if(c.length===0||i.currentNode.hasError!==n.currentNode.hasError){for(;i.currentNode.parent&&r&&!i.currentNode.isNamed;)r=Gae(i,n);const d=i.currentNode,h=_3e(i,e)??d;o.push({startIndex:h.startIndex,endIndex:d.endIndex,startPosition:h.startPosition,endPosition:d.endPosition}),r=VX(i,n)}else c.length>=1&&(r=p3e(i,n,l[0]))}else r=VX(i,n);while(r);return i.delete(),n.delete(),o}_findTreeChanges(e,t,i){let n=0;const o=[];for(let r=0;r<t.length;r++){const a=t[r];if(o.length>0&&a.startIndex>=o[o.length-1].newRangeStartOffset&&a.endIndex<=o[o.length-1].newRangeEndOffset)continue;const l=e.walk(),c=()=>l.startIndex<a.startIndex&&l.endIndex>a.endIndex;for(;c();){let m=l.gotoFirstChild(),p=!1;for(;m;)if(c()&&l.currentNode.isNamed){p=!0;break}else m=l.gotoNextSibling();if(!p){l.gotoParent();break}if(l.currentNode.childCount===0)break}const d=l.currentNode.startPosition,h=l.currentNode.endPosition,u=l.currentNode.startIndex,f=l.currentNode.endIndex,g={newRange:new D(d.row+1,d.column+1,h.row+1,h.column+1),newRangeStartOffset:u,newRangeEndOffset:f};n<i.length&&UX(i[n],{startIndex:u,endIndex:f})?(i[n].startIndex<g.newRangeStartOffset&&(g.newRange=g.newRange.setStartPosition(i[n].startPosition.row+1,i[n].startPosition.column+1),g.newRangeStartOffset=i[n].startIndex),i[n].endIndex>g.newRangeEndOffset&&(g.newRange=g.newRange.setEndPosition(i[n].endPosition.row+1,i[n].endPosition.column+1),g.newRangeEndOffset=i[n].endIndex),n++):n<i.length&&i[n].endIndex<g.newRangeStartOffset&&o.push({newRange:new D(i[n].startPosition.row+1,i[n].startPosition.column+1,i[n].endPosition.row+1,i[n].endPosition.column+1),newRangeStartOffset:i[n].startIndex,newRangeEndOffset:i[n].endIndex}),o.length>0&&o[o.length-1].newRangeEndOffset>=g.newRangeStartOffset?(o[o.length-1].newRange=D.fromPositions(o[o.length-1].newRange.getStartPosition(),g.newRange.getEndPosition()),o[o.length-1].newRangeEndOffset=g.newRangeEndOffset):o.push(g)}return this._constrainRanges(o)}_constrainRanges(e){if(!this._ranges)return e;const t=[];let i=0,n=0;for(;i<e.length&&n<this._ranges.length;){const o=e[i],r=this._ranges[n];if(o.newRangeEndOffset<r.startIndex)i++;else if(o.newRangeStartOffset>r.endIndex)n++;else{const a=Math.max(o.newRangeStartOffset,r.startIndex),l=Math.min(o.newRangeEndOffset,r.endIndex),c=o.newRange.intersectRanges(new D(r.startPosition.row+1,r.startPosition.column+1,r.endPosition.row+1,r.endPosition.column+1));t.push({newRange:c,newRangeEndOffset:l,newRangeStartOffset:a}),l<o.newRangeEndOffset?(o.newRange=D.fromPositions(c.getEndPosition(),o.newRange.getEndPosition()),o.newRangeStartOffset=l+1):i++}}return t}async _parseAndUpdateTree(e){var i,n;const t=await this._parse();if(t)return(i=this._lastFullyParsed)==null||i.delete(),this._lastFullyParsed=t.copy(),(n=this._lastFullyParsedWithEdits)==null||n.delete(),this._lastFullyParsedWithEdits=t.copy(),t;this._tree.get()||this._parser.reset()}_parse(){let e="fullParse";return this._tree.get()&&(e="incrementalParse"),this._parseAndYield(e)}async _parseAndYield(e){let t=0,i=0;const n=this.textModel.getVersionId();let o;const r=v3e();do{const a=performance.now();o=this._parser.parse((l,c)=>this._parseCallback(l),this._tree.get(),{progressCallback:r,includedRanges:this._ranges}),t+=performance.now()-a,i++,await new Promise(l=>ok(l))}while(!this._store.isDisposed&&!o&&n===this.textModel.getVersionId());return this._sendParseTimeTelemetry(e,t,i),o&&n===this.textModel.getVersionId()?o:void 0}_parseCallback(e){try{return this.textModel.getTextBuffer().getNearestChunk(e)}catch(t){this._logService.debug("Error getting chunk for tree-sitter parsing",t)}}_setRanges(e){const t=[];if(this._ranges)for(const i of e){let n=!1;for(let o=0;o<this._ranges.length;o++){const r=this._ranges[o];if(C3e(r,i)||UX(r,i)){n=!0;break}}n||t.push(i)}else t.push(...e);return this._ranges=e,t}_sendParseTimeTelemetry(e,t,i){this._logService.debug(`Tree parsing (${e}) took ${t} ms and ${i} passes.`),e==="fullParse"?this._telemetryService.publicLog2("treeSitter.fullParse",{languageId:this.languageId,time:t,passes:i}):this._telemetryService.publicLog2("treeSitter.incrementalParse",{languageId:this.languageId,time:t,passes:i})}createParsedTreeSync(e){const t=new this._parserClass;t.setLanguage(this._parser.language);const i=t.parse(e);return t.delete(),i??void 0}};ZB=b3e([zX(5,Ji),zX(6,Wo)],ZB);function v3e(){let s=performance.now();return function(t){const i=performance.now();return i-s>50?(s=i,!0):!1}}function C3e(s,e){return s.startPosition.row===e.startPosition.row&&s.startPosition.column===e.startPosition.column&&s.endPosition.row===e.endPosition.row&&s.endPosition.column===e.endPosition.column&&s.startIndex===e.startIndex&&s.endIndex===e.endIndex}function UX(s,e){return s.startIndex<=e.startIndex&&s.endIndex>=e.startIndex||e.startIndex<=s.startIndex&&e.endIndex>=s.startIndex}const Rw=new class{clone(){return this}equals(s){return this===s}};function W$(s,e){return new w$([new HL(0,"",s)],e)}function o4(s,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(s<<0|0|0|32768|2<<24)>>>0,new i4(t,e===null?Rw:e)}class w3e{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const n=this._store.slice(0,e),o=this._store.slice(e+t),r=y3e(i,this._default);this._store=n.concat(r,o)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=_O(this._store,e,i)}}function y3e(s,e){const t=[];for(let i=0;i<s;i++)t[i]=e;return t}class S3e{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class QB{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new S3e(e,[t]))}finalize(){return this._tokens}}class x3e{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new JB(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class L3e extends x3e{constructor(e,t,i,n){super(e,t),this._textModel=i,this._languageIdCodec=n}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const n=this.getFirstInvalidLine();if(!n||n.lineNumber>t)break;const o=this._textModel.getLineContent(n.lineNumber),r=H0(this._languageIdCodec,i,this.tokenizationSupport,o,!0,n.startState);e.add(n.lineNumber,r.tokens),this.store.setEndState(n.lineNumber,r.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const n=this._textModel.getLanguageId(),o=this._textModel.getLineContent(e.lineNumber),r=o.substring(0,e.column-1)+t+o.substring(e.column-1),a=H0(this._languageIdCodec,n,this.tokenizationSupport,r,!0,i),l=new qn(a.tokens,r,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLinesAt(e,t){const i=this.getStartState(e);if(!i)return null;const n=this._textModel.getLanguageId(),o=[];let r=i;for(const a of t){const l=H0(this._languageIdCodec,n,this.tokenizationSupport,a,!0,r);o.push(new qn(l.tokens,a,this._languageIdCodec)),r=l.endState}return o}hasAccurateTokensForLine(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let n=this.guessStartState(t);const o=this._textModel.getLanguageId();for(let r=t;r<=i;r++){const a=this._textModel.getLineContent(r),l=H0(this._languageIdCodec,o,this.tokenizationSupport,a,!0,n);e.add(r,l.tokens),n=l.endState}return{heuristicTokens:!0}}guessStartState(e){let{likelyRelevantLines:t,initialState:i}=Yae(this._textModel,e,this);i||(i=this.tokenizationSupport.getInitialState());const n=this._textModel.getLanguageId();let o=i;for(const r of t)o=H0(this._languageIdCodec,n,this.tokenizationSupport,r,!1,o).endState;return o}}function Yae(s,e,t){let i=s.getLineFirstNonWhitespaceColumn(e);const n=[];let o=null;for(let r=e-1;i>1&&r>=1;r--){const a=s.getLineFirstNonWhitespaceColumn(r);if(a!==0&&a<i&&(n.push(s.getLineContent(r)),i=a,o=t==null?void 0:t.getStartState(r),o))break}return n.reverse(),{likelyRelevantLines:n,initialState:o??void 0}}class JB{constructor(e){this.lineCount=e,this._tokenizationStateStore=new I3e,this._invalidEndStatesLineNumbers=new E3e,this._invalidEndStatesLineNumbers.addRange(new Ue(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new et("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Ue(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Ue(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=bm(t.text);this.acceptChange(new dt(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Ue(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new et("Start state must be defined");return{lineNumber:t,startState:i}}}class I3e{constructor(){this._lineEndStates=new w3e(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class E3e{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Ue(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new Ue(i.start,e):this._ranges.splice(t,1,new Ue(i.start,e),new Ue(e+1,i.endExclusive))}}addRange(e){Ue.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;const o=t-e.length;for(let r=n;r<this._ranges.length;r++)this._ranges[r]=this._ranges[r].delta(o);if(i===n){const r=new Ue(e.start,e.start+t);r.isEmpty||this._ranges.splice(i,0,r)}else{const r=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new Ue(r,a+o);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function H0(s,e,t,i,n,o){let r=null;if(t)try{r=t.tokenizeEncoded(i,n,o.clone())}catch(a){_t(a)}return r||(r=o4(s.encodeLanguageId(e),o)),qn.convertToEndOffset(r.tokens,i.length),r}class k3e{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,bU(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?ok(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new QB,i=Fs.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){var i;const t=(i=this._tokenizerWithStateStore)==null?void 0:i.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new dt(e,t))}}class Wb{get children(){return this._children}get length(){return this._length}constructor(e){this.height=e,this._children=[],this._length=0}static create(e,t){const i=new Wb(e.height+1);return i.appendChild(e),i.appendChild(t),i}canAppendChild(){return this._children.length<3}appendChild(e){if(!this.canAppendChild())throw new Error("Cannot insert more than 3 children in a ListNode");this._children.push(e),this._length+=e.length,this._updateParentLength(e.length),lr(e)||(e.parent=this)}_updateParentLength(e){let t=this.parent;for(;t;)t._length+=e,t=t.parent}unappendChild(){const e=this._children.pop();return this._length-=e.length,this._updateParentLength(-e.length),e}prependChild(e){if(this._children.length>=3)throw new Error("Cannot prepend more than 3 children in a ListNode");this._children.unshift(e),this._length+=e.length,this._updateParentLength(e.length),lr(e)||(e.parent=this)}unprependChild(){const e=this._children.shift();return this._length-=e.length,this._updateParentLength(-e.length),e}lastChild(){return this._children[this._children.length-1]}dispose(){this._children.splice(0,this._children.length)}}var Wa;(function(s){s[s.None=0]="None",s[s.ViewportGuess=1]="ViewportGuess",s[s.EditGuess=2]="EditGuess",s[s.Accurate=3]="Accurate"})(Wa||(Wa={}));function lr(s){return s.token!==void 0}function Xae(s,e){let t=s;const i=[];let n;for(;;){if(e.height===t.height){n=e;break}if(lr(t))throw new Error("unexpected");i.push(t),t=t.lastChild()}for(let o=i.length-1;o>=0;o--){const r=i[o];n&&(r.children.length>=3?n=Wb.create(r.unappendChild(),n):(r.appendChild(n),n=void 0))}if(n){const o=new Wb(n.height+1);return o.appendChild(s),o.appendChild(n),o}else return s}function D3e(s,e){let t=s;const i=[];for(;e.height!==t.height;){if(lr(t))throw new Error("unexpected");i.push(t),t=t.children[0]}let n=e;for(let o=i.length-1;o>=0;o--){const r=i[o];n&&(r.children.length>=3?n=Wb.create(n,r.unprependChild()):(r.prependChild(n),n=void 0))}return n?Wb.create(n,s):s}function T3e(s,e){return s.height===e.height?Wb.create(s,e):s.height>e.height?Xae(s,e):D3e(e,s)}class N3e{constructor(e){this._textModel=e,this._root=this.createEmptyRoot()}createEmptyRoot(){return{length:this._textModel.getValueLength(),token:0,height:0,tokenQuality:Wa.None}}buildStore(e,t){this._root=this.createFromUpdates(e,t)}createFromUpdates(e,t){if(e.length===0)return this.createEmptyRoot();let i={length:e[0].length,token:e[0].token,height:0,tokenQuality:t};for(let n=1;n<e.length;n++)i=Xae(i,{length:e[n].length,token:e[n].token,height:0,tokenQuality:t});return i}update(e,t,i){t.length!==0&&this.replace(e,t[0].startOffsetInclusive,t,i)}delete(e,t){this.replace(e,t,[],Wa.EditGuess)}replace(e,t,i,n){const o=t+e,r=[],a=[],l=[{node:this._root,offset:0}];for(;l.length>0;){const h=l.pop(),u=h.offset;if(u<t&&u+h.node.length<=t){lr(h.node)||(h.node.parent=void 0),r.push(h.node);continue}else lr(h.node)&&u<t&&r.push({length:t-u,token:h.node.token,height:0,tokenQuality:h.node.tokenQuality});if(!(t<=u&&u+h.node.length<=o)){if(u>=o){lr(h.node)||(h.node.parent=void 0),a.push(h.node);continue}else if(lr(h.node)&&u+h.node.length>o){a.push({length:u+h.node.length-o,token:h.node.token,height:0,tokenQuality:h.node.tokenQuality});continue}if(!lr(h.node)){let f=u+h.node.length;for(let g=h.node.children.length-1;g>=0;g--)f-=h.node.children[g].length,l.push({node:h.node.children[g],offset:f})}}}let c;i.length>0?c=r.concat(this.createFromUpdates(i,n),a):c=r.concat(a);let d=c[0];for(let h=1;h<c.length;h++)d=T3e(d,c[h]);this._root=d??this.createEmptyRoot()}traverseInOrderInRange(e,t,i){const n=[{node:this._root,offset:0}];for(;n.length>0;){const{node:o,offset:r}=n.pop();if(!(r+o.length<=e||r>=t)){if(i(o,r))return;if(!lr(o)){let l=r+o.length;for(let c=o.children.length-1;c>=0;c--)l-=o.children[c].length,n.push({node:o.children[c],offset:l})}}}}getTokenAt(e){let t;return this.traverseInOrderInRange(e,this._root.length,(i,n)=>lr(i)?(t={token:i.token,startOffsetInclusive:n,length:i.length},!0):!1),t}getTokensInRange(e,t){const i=[];return this.traverseInOrderInRange(e,t,(n,o)=>{if(lr(n)){let r=n.length,a=o;o<e&&o+n.length>t?(a=e,r=t-e):o<e?(r-=e-o,a=e):o+n.length>t&&(r-=o+n.length-t),i.push({token:n.token,startOffsetInclusive:a,length:r})}return!1}),i}markForRefresh(e,t){this.traverseInOrderInRange(e,t,i=>(lr(i)&&(i.tokenQuality=Wa.None),!1))}rangeHasTokens(e,t,i){let n=!0;return this.traverseInOrderInRange(e,t,o=>(lr(o)&&o.tokenQuality<i&&(n=!1),!1)),n}rangeNeedsRefresh(e,t){let i=!1;return this.traverseInOrderInRange(e,t,n=>(lr(n)&&n.tokenQuality!==Wa.Accurate&&(i=!0),!1)),i}getNeedsRefresh(){const e=[];return this.traverseInOrderInRange(0,this._textModel.getValueLength(),(t,i)=>(lr(t)&&t.tokenQuality!==Wa.Accurate&&(e.length>0&&e[e.length-1].endOffset===i?e[e.length-1].endOffset+=t.length:e.push({startOffset:i,endOffset:i+t.length})),!1)),e}dispose(){const e=[[this._root,!1]];for(;e.length>0;){const[t,i]=e.pop();if(!lr(t))if(i)t.dispose(),t.parent=void 0;else{e.push([t,!0]);for(let n=t.children.length-1;n>=0;n--)e.push([t.children[n],!1])}}this._root=void 0}}const R3e=Mt("treeSitterThemeService");function M3e(s){return{createChangeSummary:e=>({changes:[]}),handleChange(e,t){for(const i in s)e.didChange(s[i])&&t.changes.push({key:i,change:e.change});return!0},beforeUpdate(e,t){for(const i in s){if(i==="changes")throw new et('property name "changes" is reserved for change tracking');t[i]=s[i].read(e)}}}}function A3e(s){let e;return{createChangeSummary:t=>({changes:[]}),handleChange(t,i){e||(e=s());for(const n in e)t.didChange(e[n])&&i.changes.push({key:n,change:t.change});return!0},beforeUpdate(t,i){e||(e=s());for(const n in e){if(n==="changes")throw new et('property name "changes" is reserved for change tracking');i[n]=e[n].read(t)}}}}var P3e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},O3e=function(s,e){return function(t,i){e(t,i,s)}};let e7=class extends K{get _textModel(){return this._tree.textModel}constructor(e,t,i,n,o){super(),this._tree=e,this._highlightingQueries=t,this._languageIdCodec=i,this._visibleLineRanges=n,this._treeSitterThemeService=o,this._onDidChangeTokens=this._register(new q),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidCompleteBackgroundTokenization=this._register(new q),this.onDidChangeBackgroundTokenization=this._onDidCompleteBackgroundTokenization.event,this._encodedLanguageId=this._languageIdCodec.encodeLanguageId(this._tree.languageId),this._register(rd(this._treeSitterThemeService.onChange,()=>{this._updateTheme()})),this._tokenStore=this._register(new N3e(this._textModel)),this._accurateVersion=this._textModel.getVersionId(),this._guessVersion=this._textModel.getVersionId(),this._tokenStore.buildStore(this._createEmptyTokens(),Wa.None),this._register(lt(r=>{const a=this._visibleLineRanges.read(r);this._parseAndTokenizeViewPort(a)})),this._register(e0({owner:this,changeTracker:M3e({tree:this._tree.tree})},(r,a)=>{var c;const l=(c=a.changes.at(0))==null?void 0:c.change;if(a.changes.length>1)throw new et("The tree changed twice in one transaction. This is currently not supported and should not happen.");if(!l)a.tree&&this._firstTreeUpdate(this._tree.treeLastParsedVersion.read(r));else{if(this.hasTokens())for(const d of l.ranges)this._markForRefresh(d.newRange);this.hasTokens()?this._handleTreeUpdate(l.ranges,l.versionId):this._firstTreeUpdate(l.versionId)}}))}handleContentChanged(e){this._guessVersion=e.versionId;for(const t of e.changes)if(t.text.length>t.rangeLength){const i=t.rangeOffset>0?t.rangeOffset-1:t.rangeOffset,n=this._tokenStore.getTokenAt(i);let o;n?(o={startOffsetInclusive:n.startOffsetInclusive,length:n.length+t.text.length-t.rangeLength,token:n.token},this._tokenStore.markForRefresh(i,t.rangeOffset+(t.text.length>t.rangeLength?t.text.length:t.rangeLength))):o={startOffsetInclusive:i,length:t.text.length,token:0},this._tokenStore.update((n==null?void 0:n.length)??0,[o],Wa.EditGuess)}else if(t.text.length<t.rangeLength){const i=t.rangeLength-t.text.length;this._tokenStore.delete(i,t.rangeOffset)}}getLineTokens(e){const t=this._textModel.getLineContent(e),i=this.getTokens(e);return new qn(i,t,this._languageIdCodec)}_createEmptyTokens(){const e=this._emptyToken(),t=this._textModel.getValueLength();return[this._emptyTokensForOffsetAndLength(0,t,e)]}_emptyToken(){return this._treeSitterThemeService.findMetadata([],this._encodedLanguageId,!1,void 0)}_emptyTokensForOffsetAndLength(e,t,i){return{token:i,length:e+t,startOffsetInclusive:0}}hasAccurateTokensForLine(e){return this.hasTokens(new D(e,1,e,this._textModel.getLineMaxColumn(e)))}tokenizeLinesAt(e,t){const i=this._guessTokensForLinesContent(e,t),n=[];if(!i)return null;for(let o=0;o<i.length;o++)n.push(new qn(i[o],t[o],this._languageIdCodec));return n}_rangeHasTokens(e,t){return this._tokenStore.rangeHasTokens(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()),t)}hasTokens(e){return!e||this._guessVersion===this._accurateVersion?!0:!this._tokenStore.rangeNeedsRefresh(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()))}getTokens(e){const t=this._textModel.getOffsetAt({lineNumber:e,column:1}),i=this._textModel.getOffsetAt({lineNumber:e,column:this._textModel.getLineLength(e)+1}),n=this._tokenStore.getTokensInRange(t,i),o=new Uint32Array(n.length*2);for(let r=0;r<n.length;r++)o[r*2]=n[r].startOffsetInclusive-t+n[r].length,o[r*2+1]=n[r].token;return o}getTokensInRange(e,t,i,n){const o=n?this._tokenizeCapturesWithMetadata(n,t,i):this._tokenize(e,t,i);if(o!=null&&o.endOffsetsAndMetadata)return this._rangeTokensAsUpdates(t,o.endOffsetsAndMetadata)}_updateTokensInStore(e,t,i){this._accurateVersion=e;for(const n of t){const o=n.newTokens.length>0?n.newTokens[n.newTokens.length-1]:void 0;let r;o&&this._guessVersion>=e?r=o.startOffsetInclusive+o.length-n.newTokens[0].startOffsetInclusive:n.oldRangeLength?r=n.oldRangeLength:r=0,this._tokenStore.update(r,n.newTokens,i)}}_markForRefresh(e){this._tokenStore.markForRefresh(this._textModel.getOffsetAt(e.getStartPosition()),this._textModel.getOffsetAt(e.getEndPosition()))}_getNeedsRefresh(){const e=this._tokenStore.getNeedsRefresh();return e?e.map(t=>({range:D.fromPositions(this._textModel.getPositionAt(t.startOffset),this._textModel.getPositionAt(t.endOffset)),startOffset:t.startOffset,endOffset:t.endOffset})):[]}_parseAndTokenizeViewPort(e){const t=e.map(i=>i.toInclusiveRange()).filter($s);for(const i of t){const n=this._textModel.getOffsetAt(i.getStartPosition()),o=this._textModel.getOffsetAt(i.getEndPosition()),r=this._textModel.getVersionId();if(this._rangeHasTokens(i,Wa.ViewportGuess))continue;const a=this._textModel.getValueInRange(i),l=this._forceParseAndTokenizeContent(i,n,o,a,!0);if(!l||this._rangeHasTokens(i,Wa.ViewportGuess)||l.length===0)continue;const c=l[l.length-1],d=c.startOffsetInclusive+c.length-l[0].startOffsetInclusive;this._updateTokensInStore(r,[{newTokens:l,oldRangeLength:d}],Wa.ViewportGuess),this._onDidChangeTokens.fire({changes:{semanticTokensApplied:!1,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]}})}}_guessTokensForLinesContent(e,t){if(t.length===0)return;const i=t.join(this._textModel.getEOL()),n=new D(1,1,e+t.length,t[t.length-1].length+1),o=this._textModel.getOffsetAt({lineNumber:e,column:1}),r=this._forceParseAndTokenizeContent(n,o,o+i.length,i,!1);if(!r)return;const a=new Array(t.length);let l=0,c=0,d=0;for(let h=0;h<t.length;h++){const u=[];let f=!1;for(let g=l;!f&&g<r.length;g++){const m=r[g],p=m.endOffset-d,v=c-d;if(p<=t[h].length)u.push({endOffset:p,metadata:m.metadata}),l++;else if(v<t[h].length){const b={endOffset:t[h].length,metadata:m.metadata};u.push(b),f=!0}else f=!0;c=m.endOffset}a[h]=this._endOffsetTokensToUint32Array(u),d+=t[h].length+this._textModel.getEOL().length}return a}_forceParseAndTokenizeContent(e,t,i,n,o){const r=Yae(this._textModel,e.startLineNumber).likelyRelevantLines,a=r.join(this._textModel.getEOL()),l=this._tree.createParsedTreeSync(`${a}${n}`);if(!l)return;const c=new D(1,1,e.endLineNumber-e.startLineNumber+1+r.length,e.endColumn),d=this.captureAtRange(c),h=this._tokenizeCapturesWithMetadata(d,a.length,i-t+a.length);if(l.delete(),!!h)return o?this._rangeTokensAsUpdates(t,h.endOffsetsAndMetadata,a.length):h.endOffsetsAndMetadata}_firstTreeUpdate(e){return this._setViewPortTokens(e)}_setViewPortTokens(e){const t=this._visibleLineRanges.get().map(i=>{const n=i.toInclusiveRange();if(!n)return;const o=this._textModel.getOffsetAt(n.getStartPosition()),r=this._textModel.getOffsetAt(n.getEndPosition());return{newRange:n,newRangeEndOffset:r,newRangeStartOffset:o}}).filter($s);return this._handleTreeUpdate(t,e)}_handleTreeUpdate(e,t){const i=[];for(let r=0;r<e.length;r++)if(e[r].newRange.endLineNumber-e[r].newRange.startLineNumber>1e3){const l=e[r].newRange.endLineNumber;let c=e[r].newRange.startLineNumber,d=e[r].newRange.startColumn,h=c+1e3;do{const u=new z(c,d),f=h===e[r].newRange.endLineNumber?e[r].newRange.endColumn:this._textModel.getLineMaxColumn(h),g=new z(h,f),m=D.fromPositions(u,g);i.push({range:m,startOffset:this._textModel.getOffsetAt(m.getStartPosition()),endOffset:this._textModel.getOffsetAt(m.getEndPosition())}),c=h+1,d=1,h<l&&h+1e3>l?h=l:h=h+1e3}while(h<=l)}else if(r===0||i[r-1].endOffset<e[r].newRangeStartOffset)i.push({range:e[r].newRange,startOffset:e[r].newRangeStartOffset,endOffset:e[r].newRangeEndOffset});else if(i[r-1].endOffset<e[r].newRangeEndOffset){const l=this._textModel.getPositionAt(i[r-1].endOffset+1),c=new D(l.lineNumber,l.column,e[r].newRange.endLineNumber,e[r].newRange.endColumn);i.push({range:c,startOffset:i[r-1].endOffset+1,endOffset:e[r].newRangeEndOffset})}const o=i.map(r=>this._getCaptures(r.range));return this._updateTreeForRanges(i,t,o).then(()=>{!this._textModel.isDisposed()&&this._tree.treeLastParsedVersion.get()===this._textModel.getVersionId()&&this._refreshNeedsRefresh(t)})}async _updateTreeForRanges(e,t,i){let n;for(let o=0;o<e.length&&!(!this._textModel.isDisposed()&&t!==this._textModel.getVersionId());o++){const r=i[o],a=e[o],l=this.getTokensInRange(a.range,a.startOffset,a.endOffset,r);l?n={newTokens:l}:n={newTokens:[]},this._updateTokensInStore(t,[n],Wa.Accurate),this._onDidChangeTokens.fire({changes:{semanticTokensApplied:!1,ranges:[{fromLineNumber:a.range.getStartPosition().lineNumber,toLineNumber:a.range.getEndPosition().lineNumber}]}}),await new Promise(c=>ok(c))}this._onDidCompleteBackgroundTokenization.fire()}_refreshNeedsRefresh(e){const t=this._getNeedsRefresh();if(t.length===0)return;const i=new Array(t.length);for(let n=0;n<t.length;n++){const o=t[n];i[n]={newRange:o.range,newRangeStartOffset:o.startOffset,newRangeEndOffset:o.endOffset}}this._handleTreeUpdate(i,e)}_rangeTokensAsUpdates(e,t,i){const n=[];let o=0;for(const r of t){if(r.endOffset<=o||i&&r.endOffset<i)continue;let a;i&&o<i?a={startOffsetInclusive:e+i,length:r.endOffset-i,token:r.metadata}:a={startOffsetInclusive:e+o,length:r.endOffset-o,token:r.metadata},n.push(a),o=r.endOffset}return n}_updateTheme(){const e=this._textModel.getFullModelRange();this._markForRefresh(e),this._parseAndTokenizeViewPort(this._visibleLineRanges.get())}captureAtRange(e){const t=this._tree.tree.get();return t?this._highlightingQueries.captures(t.rootNode,{startPosition:{row:e.startLineNumber-1,column:e.startColumn-1},endPosition:{row:e.endLineNumber-1,column:e.endColumn-1}}).map(i=>({name:i.name,text:i.node.text,node:{startIndex:i.node.startIndex,endIndex:i.node.endIndex,startPosition:{lineNumber:i.node.startPosition.row+1,column:i.node.startPosition.column+1},endPosition:{lineNumber:i.node.endPosition.row+1,column:i.node.endPosition.column+1}},encodedLanguageId:this._encodedLanguageId})):[]}captureAtRangeWithInjections(e){const t=this.captureAtRange(e);for(let i=0;i<t.length;i++){const n=t[i],o=n.node.startPosition.lineNumber,r=n.node.endPosition.lineNumber,a=n.node.startPosition.column,l=n.node.endPosition.column,c=o>e.startLineNumber&&o<e.endLineNumber?o:e.startLineNumber,d=r>e.startLineNumber&&r<e.endLineNumber?r:e.endLineNumber,h=o===e.startLineNumber?a<e.startColumn?e.startColumn:a:o<e.startLineNumber?e.startColumn:a,u=r===e.endLineNumber?l>e.endColumn?e.endColumn:l:r>e.endLineNumber?e.endColumn:l,f=new D(c,h,d,u),g=this._getInjectionCaptures(n,f);g&&g.length>0&&(t.splice(i+1,0,...g),i+=g.length)}return t}tokenizeEncoded(e){const t=this._tokenizeEncoded(e);if(!t)return;const i=this._rangeTokensAsUpdates(this._textModel.getOffsetAt({lineNumber:e,column:1}),t.result);t.versionId===this._textModel.getVersionId()&&this._updateTokensInStore(t.versionId,[{newTokens:i,oldRangeLength:this._textModel.getLineLength(e)}],Wa.Accurate)}_getCaptures(e){return this.captureAtRangeWithInjections(e)}_tokenize(e,t,i){const n=this._getCaptures(e),o=this._tokenizeCapturesWithMetadata(n,t,i);if(o)return{...o,versionId:this._tree.treeLastParsedVersion.get()}}_createTokensFromCaptures(e,t,i){const n=this._tree.tree.get(),o=Fs.create(),r=i-t,a=this._languageIdCodec.encodeLanguageId(this._tree.languageId),l=F3e[this._tree.languageId]||"source";if(e.length===0)return n?(o.stop(),{endOffsets:[{endOffset:r,scopes:[],encodedLanguageId:a}],captureTime:o.elapsed()}):void 0;const c=Array(e.length);c.fill({endOffset:0,scopes:[l],encodedLanguageId:a});let d=0;const h=()=>{c.push({endOffset:0,scopes:[l],encodedLanguageId:a})},u=(m,p)=>m.name.includes("punctuation")&&m.text?Array.from(m.text.matchAll(B3e)).map(v=>p+v.index):void 0,f=(m,p,v,b)=>{if(b!==void 0){const w=c[b].scopes;let C=c[b].bracket;if((b>0?c[b-1].endOffset:0)!==p){let x;if(C&&C.length>0){x=[];const S=[];for(let L=0;L<C.length;L++){const E=C[L];E<p?x.push(E):E>v&&S.push(E)}x.length===0&&(x=void 0),S.length===0?C=void 0:C=S}c.splice(b,0,{endOffset:p,scopes:[...w],bracket:x,encodedLanguageId:m.encodedLanguageId}),b++,h(),d++}c.splice(b,0,{endOffset:v,scopes:[...w,m.name],bracket:u(m,p),encodedLanguageId:m.encodedLanguageId}),c[d].bracket=C}else c[d]={endOffset:v,scopes:[l,m.name],bracket:u(m,p),encodedLanguageId:m.encodedLanguageId};d++};for(let m=0;m<e.length;m++){const p=e[m],v=p.node.endIndex<i?p.node.endIndex<t?t:p.node.endIndex:i,b=p.node.startIndex<t?t:p.node.startIndex,w=v-t;let C;const y=v-b;m>0?C=c[d-1].endOffset:C=b-t-1;const x=w-y;if(C>=0&&C<x&&(c[d]={endOffset:x,scopes:[l],encodedLanguageId:this._encodedLanguageId},d++,h()),!(y<0))if(C>=w){let S=d-1,L=c[S].endOffset,E=S>=2?c[S-1].endOffset:0;do{if(E+y===L){if(E===x){c[S].scopes.push(p.name);const M=c[S].bracket;c[S].bracket=M&&M.length>0?M:u(p,x)}}else if(E<=x){f(p,x,w,S);break}S--,E=S>=1?c[S-1].endOffset:0,L=S>=0?c[S].endOffset:0}while(L>x)}else f(p,x,w)}c[d-1].endOffset<r&&r-c[d-1].endOffset>0&&(h(),c[d]={endOffset:r,scopes:c[d].scopes,encodedLanguageId:this._encodedLanguageId},d++);for(let m=0;m<c.length;m++)if(c[m].endOffset===0&&m!==0){c.splice(m,c.length-m);break}const g=o.elapsed();return{endOffsets:c,captureTime:g}}_getInjectionCaptures(e,t){return[]}_tokenizeCapturesWithMetadata(e,t,i){const n=Fs.create(),o=this._createTokensFromCaptures(e,t,i);if(!o)return;const r=o.endOffsets;for(let l=0;l<r.length;l++){const c=r[l];c.metadata=this._treeSitterThemeService.findMetadata(c.scopes,c.encodedLanguageId,!!c.bracket&&c.bracket.length>0,void 0)}const a=n.elapsed();return{endOffsetsAndMetadata:r,captureTime:o.captureTime,metadataTime:a}}_tokenizeEncoded(e){const t=this._textModel.getOffsetAt({lineNumber:e,column:1}),i=this._textModel.getLineCount(),n=e+1<=i?this._textModel.getOffsetAt({lineNumber:e+1,column:1}):this._textModel.getValueLength(),o=n-t,r=this._tokenize(new D(e,1,e,o+1),t,n);if(r)return{result:r.endOffsetsAndMetadata,captureTime:r.captureTime,metadataTime:r.metadataTime,versionId:r.versionId}}_endOffsetTokensToUint32Array(e){const t=new Uint32Array(e.length*2);for(let i=0;i<e.length;i++)t[i*2]=e[i].endOffset,t[i*2+1]=e[i].metadata;return t}};e7=P3e([O3e(4,R3e)],e7);const F3e={css:"source.css",typescript:"source.ts",ini:"source.ini",regex:"source.regex"},B3e=/[\{\}\[\]\<\>\(\)]/g,H$=Mt("treeSitterLibraryService");class W3e{constructor(e){this._value=ht(this,void 0),this.promiseResult=this._value,this.promise=e.then(t=>(Ki(i=>{this._value.set(new $X(t,void 0),i)}),t),t=>{throw Ki(i=>{this._value.set(new $X(void 0,t),i)}),t})}}class $X{constructor(e,t){this.data=e,this.error=t}getDataOrThrow(){if(this.error)throw this.error;return this.data}}var H3e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},qX=function(s,e){return function(t,i){e(t,i,s)}};let t7=class extends Kae{constructor(e,t,i,n,o,r){super(t,i),this._languageIdObs=e,this._treeSitterLibraryService=o,this._instantiationService=r,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new q),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event;const a=new W3e(this._treeSitterLibraryService.getParserClass()),l=ae(this,c=>{var h,u;return(u=(h=a.promiseResult)==null?void 0:h.read(c))==null?void 0:u.getDataOrThrow()});this._tree=ae(this,c=>{const d=l.read(c);if(!d)return;const h=this._languageIdObs.read(c),u=this._treeSitterLibraryService.getLanguage(h,!1,c);if(!u)return;const f=new d;if(c.store.add(Ve(()=>{f.delete()})),f.setLanguage(u),this._treeSitterLibraryService.getInjectionQueries(h,c)!==void 0)return c.store.add(this._instantiationService.createInstance(ZB,h,void 0,f,d,this._textModel))}),this._tokenizationImpl=ae(this,c=>{const d=this._tree.read(c);if(!d)return;const h=this._treeSitterLibraryService.getHighlightingQueries(d.languageId,c);if(h)return c.store.add(this._instantiationService.createInstance(e7,d,h,this._languageIdCodec,n))}),this._register(lt(c=>{const d=this._tokenizationImpl.read(c);d&&(c.store.add(d.onDidChangeTokens(h=>{this._onDidChangeTokens.fire(h.changes)})),c.store.add(d.onDidChangeBackgroundTokenization(h=>{this._backgroundTokenizationState=2,this._onDidChangeBackgroundTokenizationState.fire()})))}))}getLineTokens(e){const t=this._tokenizationImpl.get();if(!t){const i=this._textModel.getLineContent(e);return qn.createEmpty(i,this._languageIdCodec)}return t.getLineTokens(e)}todo_resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}handleDidChangeAttached(){}handleDidChangeContent(e){if(e.isFlush)this.todo_resetTokenization(!1);else{const i=this._tokenizationImpl.get();i==null||i.handleContentChanged(e)}const t=this._tree.get();t==null||t.handleContentChange(e)}forceTokenization(e){const t=this._tokenizationImpl.get();t&&(t.hasAccurateTokensForLine(e)||t.tokenizeEncoded(e))}hasAccurateTokensForLine(e){const t=this._tokenizationImpl.get();return t?t.hasAccurateTokensForLine(e):!1}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,t,i){return 0}tokenizeLinesAt(e,t){const i=this._tokenizationImpl.get();return i?i.tokenizeLinesAt(e,t):null}get hasTokens(){const e=this._tokenizationImpl.get();return e?e.hasTokens():!1}};t7=H3e([qX(4,H$),qX(5,$e)],t7);class V${constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t,i=void 0){if(this._pieces=e||[],this._isComplete=t,i)for(const n of this._pieces)n.reportIfInvalid(i)}setPartial(e,t){let i=e;if(t.length>0){const o=t[0].getRange(),r=t[t.length-1].getRange();if(!o||!r)return e;i=e.plusRange(o).plusRange(r)}let n=null;for(let o=0,r=this._pieces.length;o<r;o++){const a=this._pieces[o];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(o,1),o--,r--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:o};continue}const[l,c]=a.split(i);if(l.isEmpty()){n=n||{index:o};continue}c.isEmpty()||(this._pieces.splice(o,1,l,c),o++,r++,n=n||{index:o})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=_O(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getTextLength()===0)return t;const i=this._pieces;if(i.length===0)return t;const n=V$._findFirstPieceWithLine(i,e),o=i[n].getLineTokens(e);if(!o)return t;const r=t.getCount(),a=o.getCount();let l=0;const c=[];let d=0,h=0;const u=(f,g)=>{f!==h&&(h=f,c[d++]=f,c[d++]=g)};for(let f=0;f<a;f++){const g=Math.min(o.getStartCharacter(f),t.getTextLength()),m=Math.min(o.getEndCharacter(f),t.getTextLength()),p=o.getMetadata(f),v=((p&1?2048:0)|(p&2?4096:0)|(p&4?8192:0)|(p&8?16384:0)|(p&16?16744448:0)|(p&32?4278190080:0))>>>0,b=~v>>>0;for(;l<r&&t.getEndOffset(l)<=g;)u(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<r&&t.getStartOffset(l)<g&&u(g,t.getMetadata(l));l<r&&t.getEndOffset(l)<m;)u(t.getEndOffset(l),t.getMetadata(l)&b|p&v),l++;if(l<r)u(m,t.getMetadata(l)&b|p&v),t.getEndOffset(l)===m&&l++;else{const w=Math.min(Math.max(0,l-1),r-1);u(m,t.getMetadata(w)&b|p&v)}}for(;l<r;)u(t.getEndOffset(l),t.getMetadata(l)),l++;return new qn(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let o=i+Math.floor((n-i)/2);if(e[o].endLineNumber<t)i=o+1;else if(e[o].startLineNumber>t)n=o-1;else{for(;o>i&&e[o-1].startLineNumber<=t&&t<=e[o-1].endLineNumber;)o--;return o}}return i}acceptEdit(e,t,i,n,o){for(let r=0;r<this._pieces.length;r++){const a=this._pieces[r];a.acceptEdit(e,t,i,n,o),a.isEmpty()&&(this._pieces.splice(r,1),r--)}}}const ru=new Uint32Array(0).buffer;class qd{static deleteBeginning(e,t){return e===null||e===ru?e:qd.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===ru)return e;const i=Iu(e),n=i[i.length-2];return qd.delete(e,t,n)}static delete(e,t,i){if(e===null||e===ru||t===i)return e;const n=Iu(e),o=n.length>>>1;if(t===0&&n[n.length-2]===i)return ru;const r=qn.findIndexInTokensArray(n,t),a=r>0?n[r-1<<1]:0,l=n[r<<1];if(i<l){const f=i-t;for(let g=r;g<o;g++)n[g<<1]-=f;return e}let c,d;a!==t?(n[r<<1]=t,c=r+1<<1,d=t):(c=r<<1,d=a);const h=i-t;for(let f=r+1;f<o;f++){const g=n[f<<1]-h;g>d&&(n[c++]=g,n[c++]=n[(f<<1)+1],d=g)}if(c===n.length)return e;const u=new Uint32Array(c);return u.set(n.subarray(0,c),0),u.buffer}static append(e,t){if(t===ru)return e;if(e===ru)return t;if(e===null)return e;if(t===null)return null;const i=Iu(e),n=Iu(t),o=n.length>>>1,r=new Uint32Array(i.length+n.length);r.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<o;c++)r[a++]=n[c<<1]+l,r[a++]=n[(c<<1)+1];return r.buffer}static insert(e,t,i){if(e===null||e===ru)return e;const n=Iu(e),o=n.length>>>1;let r=qn.findIndexInTokensArray(n,t);r>0&&n[r-1<<1]===t&&r--;for(let a=r;a<o;a++)n[a<<1]+=i;return e}}function Iu(s){return s instanceof Uint32Array?s:new Uint32Array(s)}class JL{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==ru)return new qn(Iu(n),i,this._languageIdCodec);const o=new Uint32Array(2);return o[0]=i.length,o[1]=jX(this._languageIdCodec.encodeLanguageId(e)),new qn(o,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?Iu(i):null;if(t===0){let o=!1;if(n&&n.length>1&&(o=Do.getLanguageId(n[1])!==e),!o)return ru}if(!n||n.length===0){const o=new Uint32Array(2);return o[0]=t,o[1]=jX(e),o.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=_O(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,o){const r=JL._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=r,o?!JL._equals(a,r):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=Iu(e),n=Iu(t);if(i.length!==n.length)return!1;for(let o=0,r=i.length;o<r;o++)if(i[o]!==n[o])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new z(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=qd.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=qd.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=qd.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=qd.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=qd.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=qd.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=qd.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let n=0,o=e.length;n<o;n++){const r=e[n];let a=0,l=0,c=!1;for(let d=r.startLineNumber;d<=r.endLineNumber;d++)c?(this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!1),l=d):this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!0)&&(c=!0,a=d,l=d);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function jX(s){return(s<<0|0|0|32768|2<<24|1024)>>>0}class V3e extends Kae{constructor(e,t,i,n){super(e,t),this.getLanguageId=i,this._tokenizer=null,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new q),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new mi),this._tokens=new JL(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new mi),this._attachedViewStates=this._register(new gO),this._register(An.onDidChange(o=>{const r=this.getLanguageId();o.changedLanguages.indexOf(r)!==-1&&this.todo_resetTokenization()})),this.todo_resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:o,state:r})=>{if(r){let a=this._attachedViewStates.get(o);a||(a=new g3e(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(r)}else this._attachedViewStates.deleteAndDispose(o)}))}todo_resetTokenization(e=!0){var o;this._tokens.flush(),(o=this._debugBackgroundTokens)==null||o.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new JB(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const r=An.get(this.getLanguageId());if(!r)return[null,null];let a;try{a=r.getInitialState()}catch(l){return _t(l),[null,null]}return[r,a]},[i,n]=t();if(i&&n?this._tokenizer=new L3e(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const r={setTokens:a=>{this.setTokens(a)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const a=2;this._backgroundTokenizationState=a,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(a,l)=>{var d;if(!this._tokenizer)return;const c=this._tokenizer.store.getFirstInvalidEndStateLineNumber();c!==null&&a>=c&&((d=this._tokenizer)==null||d.store.setEndState(a,l))}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,r)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new k3e(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),i!=null&&i.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new JL(this._languageIdCodec),this._debugBackgroundStates=new JB(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:a=>{var l;(l=this._debugBackgroundTokens)==null||l.setMultilineTokens(a,this._textModel)},backgroundTokenizationFinished(){},setEndState:(a,l)=>{var c;(c=this._debugBackgroundStates)==null||c.setEndState(a,l)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var e;(e=this._defaultBackgroundTokenizer)==null||e.handleChanges()}handleDidChangeContent(e){var t,i,n;if(e.isFlush)this.todo_resetTokenization(!1);else if(!e.isEolChange){for(const o of e.changes){const[r,a]=bm(o.text);this._tokens.acceptEdit(o.range,r,a),(t=this._debugBackgroundTokens)==null||t.acceptEdit(o.range,r,a)}(i=this._debugBackgroundStates)==null||i.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),(n=this._defaultBackgroundTokenizer)==null||n.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=dt.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){var r,a;if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const i=new QB,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),o=this.setTokens(i.finalize());if(n)for(const l of o.changes)(r=this._backgroundTokenizer.value)==null||r.requestTokens(l.fromLineNumber,l.toLineNumber+1);(a=this._defaultBackgroundTokenizer)==null||a.checkFinished()}forceTokenization(e){var i,n;const t=new QB;(i=this._tokenizer)==null||i.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),(n=this._defaultBackgroundTokenizer)==null||n.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){var n;const t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const o=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(o)&&((n=this._debugBackgroundTokenizer.value)!=null&&n.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const n=this._textModel.validatePosition(new z(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLinesAt(e,t){return this._tokenizer?(this.forceTokenization(e),this._tokenizer.tokenizeLinesAt(e,t)):null}get hasTokens(){return this._tokens.hasTokens}}var z3e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yD=function(s,e){return function(t,i){e(t,i,s)}},XT;let i7=XT=class extends dae{constructor(e,t,i,n,o,r,a,l){super(),this._textModel=e,this._bracketPairsTextModelPart=t,this._languageId=i,this._attachedViews=n,this._languageService=o,this._languageConfigurationService=r,this._instantiationService=a,this._treeSitterLibraryService=l,this._languageIdObs=ht(this,this._languageId),this._useTreeSitter=ae(this,d=>{const h=this._languageIdObs.read(d);return this._treeSitterLibraryService.supportsLanguage(h,d)}),this.tokens=ae(this,d=>{let h;return this._useTreeSitter.read(d)?h=d.store.add(this._instantiationService.createInstance(t7,this._languageIdObs,this._languageService.languageIdCodec,this._textModel,this._attachedViews.visibleLineRanges)):h=d.store.add(new V3e(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews)),d.store.add(h.onDidChangeTokens(u=>{this._emitModelTokensChangedEvent(u)})),d.store.add(h.onDidChangeBackgroundTokenizationState(u=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),h});let c=!1;this.tokens.recomputeInitiallyAndOnChange(this._store,d=>{c&&d.todo_resetTokenization(),c=!0}),this._semanticTokens=new V$(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new q),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new q),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new q),this.onDidChangeTokens=this._onDidChangeTokens.event}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,n,o]=bm(t.text);this._semanticTokens.acceptEdit(t.range,i,n,o,t.text.length>0?t.text.charCodeAt(0):0)}this.tokens.get().handleDidChangeContent(e)}handleDidChangeAttached(){this.tokens.get().handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this.tokens.get().getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new et("Illegal value for lineNumber")}get hasTokens(){return this.tokens.get().hasTokens}resetTokenization(){this.tokens.get().todo_resetTokenization()}get backgroundTokenizationState(){return this.tokens.get().backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this.tokens.get().forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this.tokens.get().hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this.tokens.get().isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this.tokens.get().tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this.tokens.get().getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLinesAt(e,t){return this.tokens.get().tokenizeLinesAt(e,t)}setSemanticTokens(e,t){this._semanticTokens.set(e,t,this._textModel),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),n=this.getLineTokens(t.lineNumber),o=n.findTokenIndexAtOffset(t.column-1),[r,a]=XT._findLanguageBoundaries(n,o),l=EL(t.column,this.getLanguageConfiguration(n.getLanguageId(o)).getWordDefinition(),i.substring(r,a),r);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(o>0&&r===t.column-1){const[c,d]=XT._findLanguageBoundaries(n,o-1),h=EL(t.column,this.getLanguageConfiguration(n.getLanguageId(o-1)).getWordDefinition(),i.substring(c,d),c);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn)return h}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let r=t;r>=0&&e.getLanguageId(r)===i;r--)n=e.getStartOffset(r);let o=e.getLineContent().length;for(let r=t,a=e.getCount();r<a&&e.getLanguageId(r)===i;r++)o=e.getEndOffset(r);return[n,o]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new z(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._languageIdObs.set(e,void 0),this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};i7=XT=z3e([yD(4,Wn),yD(5,wn),yD(6,$e),yD(7,H$)],i7);const z$=Mt("undoRedoService");class Zae{constructor(e,t){this.resource=e,this.elements=t}}const t1=class t1{constructor(){this.id=t1._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};t1._ID=0,t1.None=new t1;let n7=t1;const i1=class i1{constructor(){this.id=i1._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};i1._ID=0,i1.None=new i1;let wp=i1;var KX;function U3e(s,e){const t=new Map;for(const i of s){const n=e(i);let o=t.get(n);o||(o=[],t.set(n,o)),o.push(i)}return t}function $3e(s,e){const t=[],i=[];for(const n of s)e.has(n)||t.push(n);for(const n of e)s.has(n)||i.push(n);return{removed:t,added:i}}function Qae(s,e){const t=new Set;for(const i of e)s.has(i)&&t.add(i);return t}class GX{constructor(e,t){this.toKey=t,this._map=new Map,this[KX]="SetWithKey";for(const i of e)this.add(i)}get size(){return this._map.size}add(e){const t=this.toKey(e);return this._map.set(t,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(const e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,t){this._map.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}}KX=Symbol.toStringTag;var q3e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},SD=function(s,e){return function(t,i){e(t,i,s)}},sp;function j3e(s){const e=new jae;return e.acceptChunk(s),e.finish()}function K3e(s){const e=new jae;let t;for(;typeof(t=s.read())=="string";)e.acceptChunk(t);return e.finish()}function YX(s,e){let t;return typeof s=="string"?t=j3e(s):QNe(s)?t=K3e(s):t=s,t.create(e)}let xD=0;const G3e=999,Y3e=1e4,X3e=300;class Z3e{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}}const V0=()=>{throw new Error("Invalid change accessor")};var jc;let Hb=(jc=class extends K{static resolveOptions(e,t){if(t.detectIndentation){const i=TX(e,t.tabSize,t.insertSpaces);return new UT({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new UT(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}get onDidChangeOptions(){return this._onDidChangeOptions.event}get onDidChangeAttached(){return this._onDidChangeAttached.event}get onDidChangeLineHeight(){return this._onDidChangeLineHeight.event}get onDidChangeFont(){return this._onDidChangeFont.event}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return dc(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,n=null,o,r,a,l){super(),this._undoRedoService=o,this._languageService=r,this._languageConfigurationService=a,this.instantiationService=l,this._onWillDispose=this._register(new q),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new i9e((g,m,p)=>this.handleBeforeFireDecorationsChangedEvent(g,m,p))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new q),this._onDidChangeAttached=this._register(new q),this._onDidChangeInjectedText=this._register(new q),this._onDidChangeLineHeight=this._register(new q),this._onDidChangeFont=this._register(new q),this._eventEmitter=this._register(new n9e),this._languageSelectionListener=this._register(new mi),this._deltaDecorationCallCnt=0,this._attachedViews=new h3e,xD++,this.id="$model"+xD,this.isForSimpleWidget=i.isForSimpleWidget,typeof n>"u"||n===null?this._associatedResource=Ze.parse("inmemory://model/"+xD):this._associatedResource=n,this._attachedEditorCount=0;const{textBuffer:c,disposable:d}=YX(e,i.defaultEOL);this._buffer=c,this._bufferDisposable=d;const h=this._buffer.getLineCount(),u=this._buffer.getValueLengthInRange(new D(1,1,h,this._buffer.getLineLength(h)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=u>sp.LARGE_FILE_SIZE_THRESHOLD||h>sp.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=u>sp.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._options=sp.resolveOptions(this._buffer,i);const f=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new AFe(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new b4e(this,this._languageConfigurationService)),this._decorationProvider=this._register(new OFe(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(i7,this,this._bracketPairs,f,this._attachedViews),this._isTooLargeForSyncing=u>sp._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Use(xD),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new XX,this._commandManager=new A$(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(f),this._register(this._languageConfigurationService.onDidChange(g=>{this._bracketPairs.handleLanguageConfigurationServiceChange(g),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(g)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new I1([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=K.None}_assertNotDisposed(){if(this._isDisposed)throw new et("Model is disposed!")}getTextBuffer(){return this._assertNotDisposed(),this._buffer}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new m_(e,t)))}setValue(e,t=ko.setValue()){if(this._assertNotDisposed(),e==null)throw kl();const{textBuffer:i,disposable:n}=YX(e,this._options.defaultEOL);this._setValueFromTextBuffer(i,n,t)}_createContentChanged2(e,t,i,n,o,r,a,l,c,d){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:o}],eol:this._buffer.getEOL(),isEolChange:c,versionId:this.getVersionId(),isUndoing:r,isRedoing:a,isFlush:l,detailedReasons:[d],detailedReasonsChangeLengths:[1]}}_setValueFromTextBuffer(e,t,i){this._assertNotDisposed();const n=this.getFullModelRange(),o=this.getValueLengthInRange(n),r=this.getLineCount(),a=this.getLineMaxColumn(r);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new XX,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new S1([new nFe],this._versionId,!1,!1),this._createContentChanged2(new D(1,1,r,a),0,o,new z(r,a),this.getValue(),!1,!1,!0,!1,i))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new S1([new lFe],this._versionId,!1,!1),this._createContentChanged2(new D(1,1,o,r),0,n,new z(o,r),this.getValue(),!1,!1,!1,!0,ko.eolChange()))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const o=t[i],r=o.range,a=o.cachedAbsoluteStart-o.start,l=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),c=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);o.cachedAbsoluteStart=l,o.cachedAbsoluteEnd=c,o.cachedVersionId=e,o.start=l-a,o.end=c-a,vm(o)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const o=this._buffer.getLineLength(n);o>=Y3e?t+=o:e+=o}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,n=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,o=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,r=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new UT({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:o,bracketPairColorizationOptions:r});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=TX(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),zU(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(Vse.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new et("Operation would exceed heap memory limits");const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new Z3e(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new et("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new et("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new et("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new et("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new et("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new et("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let o=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),r=Math.floor(typeof n=="number"&&!isNaN(n)?n:1);if(o<1)o=1,r=1;else if(o>t)o=t,r=this.getLineMaxColumn(o);else if(r<=1)r=1;else{const h=this.getLineMaxColumn(o);r>=h&&(r=h)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),d=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,d=1;else if(c>t)c=t,d=this.getLineMaxColumn(c);else if(d<=1)d=1;else{const h=this.getLineMaxColumn(c);d>=h&&(d=h)}return i===o&&n===r&&a===c&&l===d&&e instanceof D&&!(e instanceof Oe)?e:new D(o,r,c,d)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const n=this._buffer.getLineCount();if(e>n)return!1;if(t===1)return!0;const o=this.getLineMaxColumn(e);if(t>o)return!1;if(i===1){const r=this._buffer.getLineCharCode(e,t-2);if(vs(r))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),o=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),r=this._buffer.getLineCount();if(n<1)return new z(1,1);if(n>r)return new z(r,this.getLineMaxColumn(r));if(o<=1)return new z(n,1);const a=this.getLineMaxColumn(n);if(o>=a)return new z(n,a);if(i===1){const l=this._buffer.getLineCharCode(n,o-2);if(vs(l))return new z(n,o-1)}return new z(n,o)}validatePosition(e){return this._assertNotDisposed(),e instanceof z&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}isValidRange(e){return this._isValidRange(e,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn;if(!this._isValidPosition(i,n,0)||!this._isValidPosition(o,r,0))return!1;if(t===1){const a=n>1?this._buffer.getLineCharCode(i,n-2):0,l=r>1&&r<=this._buffer.getLineLength(o)?this._buffer.getLineCharCode(o,r-2):0,c=vs(a),d=vs(l);return!c&&!d}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof D&&!(e instanceof Oe)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),o=i.lineNumber,r=i.column,a=n.lineNumber,l=n.column;{const c=r>1?this._buffer.getLineCharCode(o,r-2):0,d=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,h=vs(c),u=vs(d);return!h&&!u?new D(o,r,a,l):o===a&&r===l?new D(o,r-1,a,l-1):h&&u?new D(o,r-1,a,l+1):h?new D(o,r-1,a,l):new D(o,r,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new D(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,o,r,a=G3e){this._assertNotDisposed();let l=null;t!==null&&typeof t!="boolean"&&(Array.isArray(t)||(t=[t]),t.every(h=>D.isIRange(h))&&(l=t.map(h=>this.validateRange(h)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((h,u)=>h.startLineNumber-u.startLineNumber||h.startColumn-u.startColumn);const c=[];c.push(l.reduce((h,u)=>D.areIntersecting(h,u)?h.plusRange(u):(c.push(h),u)));let d;if(!i&&e.indexOf(`
`)<0){const u=new np(e,i,n,o).parseSearchRequest();if(!u)return[];d=f=>this.findMatchesLineByLine(f,u,r,a)}else d=h=>wD.findMatches(this,new np(e,i,n,o),h,r,a);return c.map(d).reduce((h,u)=>h.concat(u),[])}findNextMatch(e,t,i,n,o,r){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new np(e,i,n,o).parseSearchRequest();if(!c)return null;const d=this.getLineCount();let h=new D(a.lineNumber,a.column,d,this.getLineMaxColumn(d)),u=this.findMatchesLineByLine(h,c,r,1);return wD.findNextMatch(this,new np(e,i,n,o),a,r),u.length>0||(h=new D(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),u=this.findMatchesLineByLine(h,c,r,1),u.length>0)?u[0]:null}return wD.findNextMatch(this,new np(e,i,n,o),a,r)}findPreviousMatch(e,t,i,n,o,r){this._assertNotDisposed();const a=this.validatePosition(t);return wD.findPreviousMatch(this,new np(e,i,n,o),a,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof F5?e:new F5(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,n,o){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,n,o)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,n,o){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const r=t.map(l=>({range:this.validateRange(l.range),text:l.text}));let a=!0;if(e)for(let l=0,c=e.length;l<c;l++){const d=e[l];let h=!1;for(let u=0,f=r.length;u<f;u++){const g=r[u].range,m=g.startLineNumber>d.endLineNumber,p=d.startLineNumber>g.endLineNumber;if(!m&&!p){h=!0;break}}if(!h){a=!1;break}}if(a)for(let l=0,c=this._trimAutoWhitespaceLines.length;l<c;l++){const d=this._trimAutoWhitespaceLines[l],h=this.getLineMaxColumn(d);let u=!0;for(let f=0,g=r.length;f<g;f++){const m=r[f].range,p=r[f].text;if(!(d<m.startLineNumber||d>m.endLineNumber)&&!(d===m.startLineNumber&&m.startColumn===h&&m.isEmpty()&&p&&p.length>0&&p.charAt(0)===`
`)&&!(d===m.startLineNumber&&m.startColumn===1&&m.isEmpty()&&p&&p.length>0&&p.charAt(p.length-1)===`
`)){u=!1;break}}if(u){const f=new D(d,1,d,h);t.push(new F5(null,f,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,n,o)}_applyUndo(e,t,i,n){const o=e.map(r=>{const a=this.getPositionAt(r.newPosition),l=this.getPositionAt(r.newEnd);return{range:new D(a.lineNumber,a.column,l.lineNumber,l.column),text:r.oldText}});this._applyUndoRedoEdits(o,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const o=e.map(r=>{const a=this.getPositionAt(r.oldPosition),l=this.getPositionAt(r.oldEnd);return{range:new D(a.lineNumber,a.column,l.lineNumber,l.column),text:r.newText}});this._applyUndoRedoEdits(o,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,o,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(o)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t,i){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const n=this._validateEditOperations(e);return this._doApplyEdits(n,t??!1,i??ko.applyEdits())}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t,i){const n=this._buffer.getLineCount(),o=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),r=this._buffer.getLineCount(),a=o.changes;if(this._trimAutoWhitespaceLines=o.trimAutoWhitespaceLineNumbers,a.length!==0){for(let d=0,h=a.length;d<h;d++){const u=a[d];this._decorationsTree.acceptReplace(u.rangeOffset,u.rangeLength,u.text.length,u.forceMoveMarkers)}const l=[];this._increaseVersionId();let c=n;for(let d=0,h=a.length;d<h;d++){const u=a[d],[f]=bm(u.text);this._onDidChangeDecorations.fire();const g=u.range.startLineNumber,m=u.range.endLineNumber,p=m-g,v=f,b=Math.min(p,v),w=v-p,C=r-c-w+g,y=C,x=C+v,S=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new z(y,1)),this.getOffsetAt(new z(x,this.getLineMaxColumn(x))),0),L=hd.fromDecorations(S),E=new ff(L);for(let M=b;M>=0;M--){const R=g+M,T=C+M;E.takeFromEndWhile(N=>N.lineNumber>T);const A=E.takeFromEndWhile(N=>N.lineNumber===T);l.push(new SX(R,this.getLineContent(T),A))}if(b<p){const M=g+b;l.push(new rFe(M+1,m))}if(b<v){const M=new ff(L),R=g+b,T=v-b,A=r-c-T+R+1,N=[],P=[];for(let W=0;W<T;W++){const H=A+W;P[W]=this.getLineContent(H),M.takeWhile(G=>G.lineNumber<H),N[W]=M.takeWhile(G=>G.lineNumber===H)}l.push(new aFe(R+1,g+v,P,N))}c+=w}this._emitContentChangedEvent(new S1(l,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:a,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1,detailedReasons:[i],detailedReasonsChangeLengths:[a.length]})}return o.reverseEdits===null?void 0:o.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e,t,i){if(e&&e.size>0){const o=Array.from(e).map(r=>new SX(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeInjectedText.fire(new xae(o))}if(t&&t.size>0){const o=Array.from(t).map(r=>new sFe(r.ownerId,r.decorationId,r.lineNumber,r.lineHeight));this._onDidChangeLineHeight.fire(new Lae(o))}if(i&&i.size>0){const o=Array.from(i).map(r=>new oFe(r.ownerId,r.lineNumber));this._onDidChangeFont.fire(new Iae(o))}}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(o,r)=>this._deltaDecorationsImpl(e,[],[{range:o,options:r}])[0],changeDecoration:(o,r)=>{this._changeDecorationImpl(e,o,r)},changeDecorationOptions:(o,r)=>{this._changeDecorationOptionsImpl(e,o,QX(r))},removeDecoration:o=>{this._deltaDecorationsImpl(e,[o],[])},deltaDecorations:(o,r)=>o.length===0&&r.length===0?[]:this._deltaDecorationsImpl(e,o,r)};let n=null;try{n=t(i)}catch(o){_t(o)}return i.addDecoration=V0,i.changeDecoration=V0,i.changeDecorationOptions=V0,i.removeDecoration=V0,i.deltaDecorations=V0,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),_t(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:ZX[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const o=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,a,o),n.setOptions(ZX[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const o=t[i];this._decorationsTree.delete(o),delete this._decorations[o.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i,n)}getLinesDecorations(e,t,i=0,n=!1,o=!1,r=!1){const a=this.getLineCount(),l=Math.min(a,Math.max(1,e)),c=Math.min(a,Math.max(1,t)),d=this.getLineMaxColumn(c),h=new D(l,1,c,d),u=this._getDecorationsInRange(h,i,n,o,r);return F9(u,this._decorationProvider.getDecorationsInRange(h,i,n)),u}getDecorationsInRange(e,t=0,i=!1,n=!1,o=!1,r=!1){const a=this.validateRange(e),l=this._getDecorationsInRange(a,t,i,n,r);return F9(l,this._decorationProvider.getDecorationsInRange(a,t,i,o)),l}getOverviewRulerDecorations(e=0,t=!1,i=!1){return this._decorationsTree.getAll(this,e,t,i,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}getCustomLineHeightsDecorations(e=0){return this._decorationsTree.getAllCustomLineHeights(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return hd.fromDecorations(n).filter(o=>o.lineNumber===e)}getFontDecorationsInRange(e,t=0){const i=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),n=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getFontDecorationsInInterval(this,i,n,t)}getAllDecorations(e=0,t=!1,i=!1){let n=this._decorationsTree.getAll(this,e,t,i,!1,!1);return n=n.concat(this._decorationProvider.getAllDecorations(e,t)),n}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!1,!0)}_getDecorationsInRange(e,t,i,n,o){const r=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),a=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,r,a,t,i,n,o)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t,i){const n=this._decorations[t];if(!n)return;if(n.options.after){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(n.options.before){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}if(n.options.lineHeight!==null){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,l.startLineNumber,null)}if(n.options.affectsFont){const l=this.getDecorationRange(t);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,n.id,l.startLineNumber)}const o=this._validateRangeRelaxedNoAllocations(i),r=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,a,o),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber),n.options.lineHeight!==null&&this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,o.startLineNumber,n.options.lineHeight),n.options.affectsFont&&this._onDidChangeDecorations.recordLineAffectedByFontChange(e,n.id,o.startLineNumber)}_changeDecorationOptionsImpl(e,t,i){const n=this._decorations[t];if(!n)return;const o=!!(n.options.overviewRuler&&n.options.overviewRuler.color),r=!!(i.overviewRuler&&i.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(i),n.options.after||i.after){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(c.endLineNumber)}if(n.options.before||i.before){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(c.startLineNumber)}if(n.options.lineHeight!==null||i.lineHeight!==null){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,t,c.startLineNumber,i.lineHeight)}if(n.options.affectsFont||i.affectsFont){const c=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,t,c.startLineNumber)}const a=o!==r,l=Q3e(i)!==ZT(n);a||l?(this._decorationsTree.delete(n),n.setOptions(i),this._decorationsTree.insert(n)):n.setOptions(i)}_deltaDecorationsImpl(e,t,i,n=!1){const o=this.getVersionId(),r=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const d=new Array(l);for(;a<r||c<l;){let h=null;if(a<r){let u;do u=t[a++],h=this._decorations[u];while(!h&&a<r);if(h){if(h.options.after){const f=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber)}if(h.options.before){const f=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber)}if(h.options.lineHeight!==null){const f=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,u,f.startLineNumber,null)}if(h.options.affectsFont){const f=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByFontChange(e,u,f.startLineNumber)}this._decorationsTree.delete(h),n||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<l){if(!h){const v=++this._lastDecorationId,b=`${this._instanceId};${v}`;h=new Vae(b,0,0),this._decorations[b]=h}const u=i[c],f=this._validateRangeRelaxedNoAllocations(u.range),g=QX(u.options),m=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),p=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);h.ownerId=e,h.reset(o,m,p,f),h.setOptions(g),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),h.options.lineHeight!==null&&this._onDidChangeDecorations.recordLineAffectedByLineHeightChange(e,h.id,f.startLineNumber,h.options.lineHeight),h.options.affectsFont&&this._onDidChangeDecorations.recordLineAffectedByFontChange(e,h.id,f.startLineNumber),n||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(h),d[c]=h.id,c++}else h&&delete this._decorations[h.id]}return d}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return s7(this.getLineContent(e))+1}toString(){return`TextModel(${this.uri.toString()})`}},sp=jc,jc._MODEL_SYNC_LIMIT=50*1024*1024,jc.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024,jc.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3,jc.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024,jc.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:po.tabSize,indentSize:po.indentSize,insertSpaces:po.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:po.trimAutoWhitespace,largeFileOptimizations:po.largeFileOptimizations,bracketPairColorizationOptions:po.bracketPairColorizationOptions},jc);Hb=sp=q3e([SD(4,z$),SD(5,Wn),SD(6,wn),SD(7,$e)],Hb);function s7(s){let e=0;for(const t of s)if(t===" "||t==="	")e++;else break;return e}function uF(s){return!!(s.options.overviewRuler&&s.options.overviewRuler.color)}function Q3e(s){return!!s.after||!!s.before}function ZT(s){return!!s.options.after||!!s.options.before}class XX{constructor(){this._decorationsTree0=new cF,this._decorationsTree1=new cF,this._injectedTextDecorationsTree=new cF}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,o,r,a){const l=e.getVersionId(),c=this._intervalSearch(t,i,n,o,r,l,a);return this._ensureNodesHaveRanges(e,c)}_intervalSearch(e,t,i,n,o,r,a){const l=this._decorationsTree0.intervalSearch(e,t,i,n,o,r,a),c=this._decorationsTree1.intervalSearch(e,t,i,n,o,r,a),d=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,o,r,a);return l.concat(c).concat(d)}getInjectedTextInInterval(e,t,i,n){const o=e.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,!1,o,!1);return this._ensureNodesHaveRanges(e,r).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getFontDecorationsInInterval(e,t,i,n){const o=e.getVersionId(),r=this._decorationsTree0.intervalSearch(t,i,n,!1,!1,o,!1);return this._ensureNodesHaveRanges(e,r).filter(a=>a.options.affectsFont)}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAllCustomLineHeights(e,t){const i=e.getVersionId(),n=this._search(t,!1,!1,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(o=>typeof o.options.lineHeight=="number")}getAll(e,t,i,n,o,r){const a=e.getVersionId(),l=this._search(t,i,n,o,a,r);return this._ensureNodesHaveRanges(e,l)}_search(e,t,i,n,o,r){if(n)return this._decorationsTree1.search(e,t,i,o,r);{const a=this._decorationsTree0.search(e,t,i,o,r),l=this._decorationsTree1.search(e,t,i,o,r),c=this._injectedTextDecorationsTree.search(e,t,i,o,r);return a.concat(l).concat(c)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){ZT(e)?this._injectedTextDecorationsTree.insert(e):uF(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){ZT(e)?this._injectedTextDecorationsTree.delete(e):uF(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){ZT(e)?this._injectedTextDecorationsTree.resolveNode(e,t):uF(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function xd(s){return s.replace(/[^a-z0-9\-_]/gi," ")}class Jae{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class J3e extends Jae{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:Xa.Center}getColor(e){return this._resolvedColor||(_f(e.type)&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class e9e{constructor(e){this.position=(e==null?void 0:e.position)??cd.Center,this.persistLane=e==null?void 0:e.persistLane}}class t9e extends Jae{constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(_f(e.type)&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?re.fromHex(e):t.getColor(e.id)}}class Cm{static from(e){return e instanceof Cm?e:new Cm(e)}constructor(e){this.content=e.content||"",this.tokens=e.tokens??null,this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class vt{static register(e){return new vt(e)}static createDynamic(e){return new vt(e)}constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?xd(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?xd(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.lineHeight=e.lineHeight?Math.min(e.lineHeight,X3e):null,this.fontSize=e.fontSize||null,this.affectsFont=!!e.fontSize||!!e.fontFamily||!!e.fontWeight||!!e.fontStyle,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new J3e(e.overviewRuler):null,this.minimap=e.minimap?new t9e(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new e9e(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?xd(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?xd(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?xd(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?dDe(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?xd(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?xd(e.marginClassName):null,this.inlineClassName=e.inlineClassName?xd(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?xd(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?xd(e.afterContentClassName):null,this.after=e.after?Cm.from(e.after):null,this.before=e.before?Cm.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1,this.textDirection=e.textDirection??null}}vt.EMPTY=vt.register({description:"empty"});const ZX=[vt.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),vt.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),vt.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),vt.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function QX(s){return s instanceof vt?s:vt.createDynamic(s)}class JX{static toKey(e){return`${e.ownerId};${e.decorationId};${e.lineNumber}`}constructor(e,t,i,n){this.ownerId=e,this.decorationId=t,this.lineNumber=i,this.lineHeight=n}}class eZ{static toKey(e){return`${e.ownerId};${e.decorationId};${e.lineNumber}`}constructor(e,t,i){this.ownerId=e,this.decorationId=t,this.lineNumber=i}}class i9e extends K{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new q),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._affectedLineHeights=null,this._affectedFontLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e,t,i;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(e=this._affectedInjectedTextLines)==null||e.clear(),this._affectedInjectedTextLines=null,(t=this._affectedLineHeights)==null||t.clear(),this._affectedLineHeights=null,(i=this._affectedFontLines)==null||i.clear(),this._affectedFontLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}recordLineAffectedByLineHeightChange(e,t,i,n){this._affectedLineHeights||(this._affectedLineHeights=new GX([],JX.toKey)),this._affectedLineHeights.add(new JX(e,t,i,n))}recordLineAffectedByFontChange(e,t,i){this._affectedFontLines||(this._affectedFontLines=new GX([],eZ.toKey)),this._affectedFontLines.add(new eZ(e,t,i))}checkAffectedAndFire(e){var t,i;this._affectsMinimap||(this._affectsMinimap=!!((t=e.minimap)!=null&&t.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!((i=e.overviewRuler)!=null&&i.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!e.glyphMarginClassName),this._affectsLineNumber||(this._affectsLineNumber=!!e.lineNumberClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines,this._affectedLineHeights,this._affectedFontLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class n9e extends K{constructor(){super(),this._fastEmitter=this._register(new q),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new q),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}const We=Mt("ILanguageFeaturesService");class U${static create(e){return new U$(e.get(151),e.get(150))}constructor(e,t){this.classifier=new s9e(e,t)}createLineBreaksComputer(e,t,i,n,o,r){const a=[],l=[],c=[];return{addRequest:(d,h,u)=>{a.push(d),l.push(h),c.push(u)},finalize:()=>{const d=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,h=[];for(let u=0,f=a.length;u<f;u++){const g=l[u],m=c[u],p=a[u],v=r&&p.includes('"')&&p.includes("\\n");m&&!m.injectionOptions&&!g&&!v?h[u]=o9e(this.classifier,m,p,t,i,d,n,o):h[u]=r9e(this.classifier,p,g,t,i,d,n,o,v)}return o7.length=0,r7.length=0,h}}}}class s9e extends s0{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let o7=[],r7=[];function o9e(s,e,t,i,n,o,r,a){if(n===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",d=e.breakOffsets,h=e.breakOffsetsVisibleColumn,u=ele(t,i,n,o,r),f=n-u,g=o7,m=r7;let p=0,v=0,b=0,w=n;const C=d.length;let y=0;if(y>=0){let x=Math.abs(h[y]-w);for(;y+1<C;){const S=Math.abs(h[y+1]-w);if(S>=x)break;x=S,y++}}for(;y<C;){let x=y<0?0:d[y],S=y<0?0:h[y];v>x&&(x=v,S=b);let L=0,E=0,M=0,R=0;if(S<=w){let A=S,N=x===0?0:t.charCodeAt(x-1),P=x===0?0:s.get(N),W=!0;for(let H=x;H<l;H++){const G=H,V=t.charCodeAt(H);let U,$;if(vs(V)?(H++,U=0,$=2):(U=s.get(V),$=ix(V,A,i,o)),G>v&&a7(N,P,V,U,c)&&(L=G,E=A),A+=$,A>w){G>v?(M=G,R=A-$):(M=H+1,R=A),A-E>f&&(L=0),W=!1;break}N=V,P=U}if(W){p>0&&(g[p]=d[d.length-1],m[p]=h[d.length-1],p++);break}}if(L===0){let A=S,N=t.charCodeAt(x),P=s.get(N),W=!1;for(let H=x-1;H>=v;H--){const G=H+1,V=t.charCodeAt(H);if(V===9){W=!0;break}let U,$;if(hm(V)?(H--,U=0,$=2):(U=s.get(V),$=hf(V)?o:1),A<=w){if(M===0&&(M=G,R=A),A<=w-f)break;if(a7(V,U,N,P,c)){L=G,E=A;break}}A-=$,N=V,P=U}if(L!==0){const H=f-(R-E);if(H<=i){const G=t.charCodeAt(M);let V;vs(G)?V=2:V=ix(G,R,i,o),H-V<0&&(L=0)}}if(W){y--;continue}}if(L===0&&(L=M,E=R),L<=v){const A=t.charCodeAt(v);vs(A)?(L=v+2,E=b+2):(L=v+1,E=b+ix(A,b,i,o))}for(v=L,g[p]=L,b=E,m[p]=E,p++,w=E+f;y<0||y<C&&h[y]<E;)y++;let T=Math.abs(h[y]-w);for(;y+1<C;){const A=Math.abs(h[y+1]-w);if(A>=T)break;T=A,y++}}return p===0?null:(g.length=p,m.length=p,o7=e.breakOffsets,r7=e.breakOffsetsVisibleColumn,e.breakOffsets=g,e.breakOffsetsVisibleColumn=m,e.wrappedTextIndentLength=u,e)}function r9e(s,e,t,i,n,o,r,a,l){const c=hd.applyInjectedText(e,t);let d,h;if(t&&t.length>0?(d=t.map(M=>M.options),h=t.map(M=>M.column-1)):(d=null,h=null),n===-1)return d?new XS(h,d,[c.length],[],0):null;const u=c.length;if(u<=1)return d?new XS(h,d,[c.length],[],0):null;const f=a==="keepAll",g=ele(c,i,n,o,r),m=n-g,p=[],v=[];let b=0,w=0,C=0,y=n,x=c.charCodeAt(0),S=s.get(x),L=ix(x,0,i,o),E=1;vs(x)&&(L+=1,x=c.charCodeAt(1),S=s.get(x),E++);for(let M=E;M<u;M++){const R=M,T=c.charCodeAt(M);let A,N,P=!1;vs(T)?(M++,A=0,N=2):(A=s.get(T),N=ix(T,L,i,o)),l&&a9e(c,M)?(w=R,C=L,P=!0):a7(x,S,T,A,f)&&(w=R,C=L),L+=N,(L>y||P)&&((w===0||L-C>m)&&(w=R,C=L-N),p[b]=w,v[b]=C,b++,y=C+m,w=0),x=T,S=A}return b===0&&(!t||t.length===0)?null:(p[b]=u,v[b]=L,new XS(h,d,p,v,g))}function ix(s,e,t,i){return s===9?t-e%t:hf(s)||s<32?i:1}function tZ(s,e){return e-s%e}function a9e(s,e){if(e>=2&&s.charAt(e-1)==="n"){let t=0;for(let i=e-2;i>=0;i--)if(s.charAt(i)==="\\")t++;else return t%2===1}return!1}function a7(s,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function ele(s,e,t,i,n){let o=0;if(n!==0){const r=Jo(s);if(r!==-1){for(let l=0;l<r;l++){const c=s.charCodeAt(l)===9?tZ(o,e):1;o+=c}const a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){const c=tZ(o,e);o+=c}o+i>t&&(o=0)}}return o}class HR{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Js(new D(1,1,1,1),0,0,new z(1,1),0),new Js(new D(1,1,1,1),0,0,new z(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new si(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?Oe.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):Oe.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),o=t.selectionStart.getEndPosition(),r=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,r),l=this._validatePositionWithCache(e,o,n,a);return i.equals(r)&&n.equals(a)&&o.equals(l)?t:new Js(D.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,r,t.leftoverVisibleColumns+i.column-r.column)}_setState(e,t,i){if(i&&(i=HR._validateViewState(e.viewModel,i)),t){const n=e.model.validateRange(t.selectionStart),o=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,r=e.model.validatePosition(t.position),a=t.position.equals(r)?t.leftoverVisibleColumns:0;t=new Js(n,t.selectionStartKind,o,r,a)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new Js(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),o=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new Js(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,o,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new z(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),o=e.coordinatesConverter.convertModelPositionToViewPosition(new z(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),r=new D(n.lineNumber,n.column,o.lineNumber,o.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new Js(r,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class iZ{constructor(e){this.context=e,this.cursors=[new HR(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return cae(this.cursors,wo(e=>e.viewState.position,z.compare)).viewState.position}getBottomMostViewPosition(){return lae(this.cursors,wo(e=>e.viewState.position,z.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(si.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const n=i-t;for(let o=0;o<n;o++)this._addSecondaryCursor()}else if(t>i){const n=t-i;for(let o=0;o<n;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new HR(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(wo(i=>i.selection,D.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],o=t[i+1],r=n.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||r.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(r.getEndPosition()):l=a.getStartPosition().isBefore(r.getEndPosition()),l){const c=n.index<o.index?i:i+1,d=n.index<o.index?i+1:i,h=t[d].index,u=t[c].index,f=t[d].selection,g=t[c].selection;if(!f.equalsSelection(g)){const m=f.plusRange(g),p=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,v=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn;let b;h===this.lastAddedCursorIndex?(b=p,this.lastAddedCursorIndex=u):b=v;let w;b?w=new Oe(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn):w=new Oe(m.endLineNumber,m.endColumn,m.startLineNumber,m.startColumn),t[c].selection=w;const C=si.fromModelSelection(w);e[u].setState(this.context,C.modelState,C.viewState)}for(const m of t)m.index>h&&m.index--;e.splice(h,1),t.splice(d,1),this._removeSecondaryCursor(h-1),i--}}}}class nZ{constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class l9e{constructor(){this.type=0}}class c9e{constructor(){this.type=1}}class d9e{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class h9e{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class Hm{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class LD{constructor(){this.type=5}}class u9e{constructor(e){this.type=6,this.isFocused=e}}class f9e{constructor(){this.type=7}}class ID{constructor(){this.type=8}}class tle{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class l7{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class c7{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class nx{constructor(e,t,i,n,o,r,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=o,this.revealHorizontal=r,this.scrollType=a,this.type=12}}class g9e{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class m9e{constructor(e){this.theme=e,this.type=14}}class p9e{constructor(e){this.type=15,this.ranges=e}}class _9e{constructor(){this.type=16}}let b9e=class{constructor(){this.type=17}};class v9e extends K{constructor(){super(),this._onEvent=this._register(new q),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new C9e),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class C9e{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class $${constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new $$(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class r4{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new r4(this.oldHasFocus,e.hasFocus)}}class w9e{constructor(e,t){this.kind=2,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new r4(this.oldHasFocus,e.hasFocus)}}class q${constructor(e,t,i,n,o,r,a,l){this.kind=3,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=o,this.scrollLeft=r,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new q$(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class y9e{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class S9e{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class VR{constructor(e,t,i,n,o,r,a){this.kind=7,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=o,this.reason=r,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,n=t.length;if(i!==n)return!1;for(let o=0;o<i;o++)if(!e[o].equalsSelection(t[o]))return!1;return!0}isNoOp(){return VR._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new VR(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class x9e{constructor(){this.kind=6}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class L9e{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class I9e{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class E9e{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class k9e{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class D9e{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class T9e{constructor(e){this.event=e,this.kind=13}isNoOp(){return!1}attemptToMerge(e){return null}}class N9e{constructor(e){this.event=e,this.kind=14}isNoOp(){return!1}attemptToMerge(e){return null}}class R9e{constructor(e){this.event=e,this.kind=15}isNoOp(){return!1}attemptToMerge(e){return null}}class M9e extends K{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new nZ(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new iZ(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=yi(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new nZ(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let o=!1;const r=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>r&&(n=n.slice(0,r),o=!0);const a=sx.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,o)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,o,r){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=D.fromPositions(a[0],a[0]),e.emitViewEvent(new nx(t,i,l,c,n,o,r))}revealPrimary(e,t,i,n,o,r){const l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new nx(t,i,null,l,n,o,r))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const o=t[i];e.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const r=t[n];let a=1,l=1;r.position&&r.position.lineNumber&&(a=r.position.lineNumber),r.position&&r.position.column&&(l=r.position.column);let c=a,d=l;r.selectionStart&&r.selectionStart.lineNumber&&(c=r.selectionStart.lineNumber),r.selectionStart&&r.selectionStart.column&&(d=r.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:d,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,si.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof xae){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new iZ(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const o=si.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,o)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{const o=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,si.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,si.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const o=this._model.deltaDecorations([],i),r=this._model.deltaDecorations([],n);this._autoClosedActions.push(new sZ(this._model,o,r))}_executeEditOperation(e,t){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const i=A9e.executeCommands(this._model,this._cursors.getSelections(),e.commands,t);if(i){this._interpretCommandResult(i);const n=[],o=[];for(let r=0;r<e.commands.length;r++){const a=e.commands[r];a instanceof QU&&a.enclosingRange&&a.closeCharacterRange&&(n.push(a.closeCharacterRange),o.push(a.enclosingRange))}n.length>0&&this._pushAutoClosedAction(n,o),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,o){const r=sx.from(this._model,this);if(r.equals(n))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new h9e(l,a,i)),!n||n.cursorState.length!==r.cursorState.length||r.cursorState.some((c,d)=>!c.modelState.equals(n.cursorState[d].modelState))){const c=n?n.cursorState.map(h=>h.modelState.selection):null,d=n?n.modelVersionId:0;e.emitOutgoingEvent(new VR(c,a,d,r.modelVersionId,t||"keyboard",i,o))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const o=e[i];if(!o.text||o.text.indexOf(`
`)>=0)return null;const r=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!r)return null;const a=r[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,d=o.text.length-r[2].length-1,h=o.text.lastIndexOf(c,d-1);if(h===-1)return null;t.push([h,d])}return t}executeEdits(e,t,i,n,o){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(i)),r&&(i[0]._isTracked=!0);const a=[],l=[],c=this._model.pushEditOperations(this.getSelections(),i,d=>{if(r)for(let u=0,f=r.length;u<f;u++){const[g,m]=r[u],p=d[u],v=p.range.startLineNumber,b=p.range.startColumn-1+g,w=p.range.startColumn-1+m;a.push(new D(v,w+1,v,w+2)),l.push(new D(v,b+1,v,w+2))}const h=n(d);return h&&(this._isHandling=!0),h},void 0,o);c&&(this._isHandling=!1,this.setSelections(e,t,c,0)),a.length>0&&this._pushAutoClosedAction(a,l)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const o=sx.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(r){_t(r)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,o,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return sZ.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new ox(this._model,this.getSelections())}endComposition(e,t){const i=ko.cursor({kind:"compositionEnd",detailedSource:t}),n=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(ag.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,n,this.getSelections(),this.getAutoClosedCharacters()),i)},e,t)}type(e,t,i){const n=ko.cursor({kind:"type",detailedSource:i});this._executeEdit(()=>{if(i==="keyboard"){const o=t.length;let r=0;for(;r<o;){const a=SU(t,r),l=t.substr(r,a);this._executeEditOperation(ag.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),l),n),r+=a}}else this._executeEditOperation(ag.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t),n)},e,i)}compositionType(e,t,i,n,o,r){const a=ko.cursor({kind:"compositionType",detailedSource:r});if(t.length===0&&i===0&&n===0){if(o!==0){const l=this.getSelections().map(c=>{const d=c.getPosition();return new Oe(d.lineNumber,d.column+o,d.lineNumber,d.column+o)});this.setSelections(e,r,l,0)}return}this._executeEdit(()=>{this._executeEditOperation(ag.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,o),a)},e,r)}paste(e,t,i,n,o){const r=ko.cursor({kind:"paste",detailedSource:o});this._executeEdit(()=>{this._executeEditOperation(ag.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]),r)},e,o,4)}cut(e,t){const i=ko.cursor({kind:"cut",detailedSource:t});this._executeEdit(()=>{this._executeEditOperation(Ab.cut(this.context.cursorConfig,this._model,this.getSelections()),i)},e,t)}executeCommand(e,t,i){const n=ko.cursor({kind:"executeCommand",detailedSource:i});this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Cr(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}),n)},e,i)}executeCommands(e,t,i){const n=ko.cursor({kind:"executeCommands",detailedSource:i});this._executeEdit(()=>{this._executeEditOperation(new Cr(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}),n)},e,i)}}class sx{static from(e,t){return new sx(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class sZ{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(D.compareRangesUsingStarts),e.sort(D.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class A9e{static executeCommands(e,t,i,n=ko.unknown({name:"executeCommands"})){const o={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(o,i,n);for(let a=0,l=o.trackedRanges.length;a<l;a++)o.model._setTrackedRange(o.trackedRanges[a],null,0);return r}static _innerExecuteCommands(e,t,i){if(this._arrayIsEmpty(t))return null;const n=this._getEditOperations(e,t);if(n.operations.length===0)return null;const o=n.operations,r=this._getLoserCursorMap(o);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const a=[];for(let d=0,h=o.length;d<h;d++)r.hasOwnProperty(o[d].identifier.major.toString())||a.push(o[d]);n.hadTrackedEditOperation&&a.length>0&&(a[0]._isTracked=!0);let l=e.model.pushEditOperations(e.selectionsBefore,a,d=>{const h=[];for(let g=0;g<e.selectionsBefore.length;g++)h[g]=[];for(const g of d)g.identifier&&h[g.identifier.major].push(g);const u=(g,m)=>g.identifier.minor-m.identifier.minor,f=[];for(let g=0;g<e.selectionsBefore.length;g++)h[g].length>0?(h[g].sort(u),f[g]=t[g].computeCursorState(e.model,{getInverseEditOperations:()=>h[g],getTrackedSelection:m=>{const p=parseInt(m,10),v=e.model._getTrackedRange(e.trackedRanges[p]);return e.trackedRangesDirection[p]===0?new Oe(v.startLineNumber,v.startColumn,v.endLineNumber,v.endColumn):new Oe(v.endLineNumber,v.endColumn,v.startLineNumber,v.startColumn)}})):f[g]=e.selectionsBefore[g];return f},void 0,i);l||(l=e.selectionsBefore);const c=[];for(const d in r)r.hasOwnProperty(d)&&c.push(parseInt(d,10));c.sort((d,h)=>h-d);for(const d of c)l.splice(d,1);return l}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let o=0,r=t.length;o<r;o++){const a=t[o];if(a){const l=this._getEditOperationsFromCommand(e,o,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let o=0;const r=(h,u,f=!1)=>{D.isEmpty(h)&&u===""||n.push({identifier:{major:t,minor:o++},range:h,text:u,forceMoveMarkers:f,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const d={addEditOperation:r,addTrackedEditOperation:(h,u,f)=>{a=!0,r(h,u,f)},trackSelection:(h,u)=>{const f=Oe.liftSelection(h);let g;if(f.isEmpty())if(typeof u=="boolean")u?g=2:g=3;else{const v=e.model.getLineMaxColumn(f.startLineNumber);f.startColumn===v?g=2:g=3}else g=1;const m=e.trackedRanges.length,p=e.model._setTrackedRange(null,f,g);return e.trackedRanges[m]=p,e.trackedRangesDirection[m]=f.getDirection(),m.toString()}};try{i.getEditOperations(e.model,d)}catch(h){return _t(h),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-D.compareRangesUsingEnds(i.range,n.range));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],o=e[i];if(D.getStartPosition(n.range).isBefore(D.getEndPosition(o.range))){let r;n.identifier.major>o.identifier.major?r=n.identifier.major:r=o.identifier.major,t[r.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===r&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class P9e{constructor(e,t,i,n){this.text=e,this.lineNumber=t,this.startSelectionOffset=i,this.endSelectionOffset=n}}class ox{static _capture(e,t){const i=[];for(const n of t){if(n.startLineNumber!==n.endLineNumber)return null;const o=n.startLineNumber;i.push(new P9e(e.getLineContent(o),o,n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=ox._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=ox._capture(e,t);if(!i||this._original.length!==i.length)return null;const n=[];for(let o=0,r=this._original.length;o<r;o++)n.push(ox._deduceOutcome(this._original[o],i[o]));return n}static _deduceOutcome(e,t){const i=Math.min(e.startSelectionOffset,t.startSelectionOffset,mc(e.text,t.text)),n=Math.min(e.text.length-e.endSelectionOffset,t.text.length-t.endSelectionOffset,df(e.text,t.text)),o=e.text.substring(i,e.text.length-n),r=i,a=t.text.length-n,l=t.text.substring(r,a),c=new D(t.lineNumber,r+1,t.lineNumber,a+1);return new o2e(o,e.startSelectionOffset-i,e.endSelectionOffset-i,l,t.startSelectionOffset-i,t.endSelectionOffset-i,c)}}const oZ={getInitialState:()=>Rw,tokenizeEncoded:(s,e,t)=>o4(0,t)};async function O9e(s,e,t){if(!t)return rZ(e,s.languageIdCodec,oZ);const i=await An.getOrCreate(t);return rZ(e,s.languageIdCodec,i||oZ)}function F9e(s,e,t,i,n,o,r){let a="<div>",l=0,c=0,d=!0;for(let h=0,u=e.getCount();h<u;h++){const f=e.getEndOffset(h);let g="";for(;l<f&&l<n;l++){const m=s.charCodeAt(l),p=m===9;if(c+=hf(m)?2:p?0:1,l<i){if(p){const v=c%o;c+=v===0?o:o-v}continue}switch(m){case 9:{const v=c%o,b=v===0?o:o-v;c+=b;let w=b;for(;w>0;)r&&d?(g+="&#160;",d=!1):(g+=" ",d=!0),w--;break}case 60:g+="&lt;",d=!1;break;case 62:g+="&gt;",d=!1;break;case 38:g+="&amp;",d=!1;break;case 0:g+="&#00;",d=!1;break;case 65279:case 8232:case 8233:case 133:g+="�",d=!1;break;case 13:g+="&#8203",d=!1;break;case 32:r&&d?(g+="&#160;",d=!1):(g+=" ",d=!0);break;default:g+=String.fromCharCode(m),d=!1}}if(!(f<=i)&&(a+=`<span style="${e.getInlineStyle(h,t)}">${g}</span>`,f>n||l>=n||i>=n))break}return a+="</div>",a}function rZ(s,e,t){let i='<div class="monaco-tokenized-source">';const n=fa(s);let o=t.getInitialState();for(let r=0,a=n.length;r<a;r++){const l=n[r];r>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,o);qn.convertToEndOffset(c.tokens,l.length);const h=new qn(c.tokens,l,e).inflate();let u=0;for(let f=0,g=h.getCount();f<g;f++){const m=h.getClassName(f),p=h.getEndOffset(f);i+=`<span class="${m}">${hc(l.substring(u,p))}</span>`,u=p}o=c.endState}return i+="</div>",i}class B9e{constructor(e,t,i,n,o){this.decorationId=e,this.index=t,this.lineNumber=i,this.specialHeight=n,this.prefixSum=o,this.maximumSpecialHeight=n,this.deleted=!1}}class aZ{constructor(e,t){if(this._decorationIDToCustomLine=new fF,this._orderedCustomLines=[],this._pendingSpecialLinesToInsert=[],this._invalidIndex=0,this._hasPending=!1,this._defaultLineHeight=e,t.length>0){for(const i of t)this.insertOrChangeCustomLineHeight(i.decorationId,i.startLineNumber,i.endLineNumber,i.lineHeight);this.commit()}}set defaultLineHeight(e){this._defaultLineHeight=e}get defaultLineHeight(){return this._defaultLineHeight}removeCustomLineHeight(e){const t=this._decorationIDToCustomLine.get(e);if(t){this._decorationIDToCustomLine.delete(e);for(const i of t)i.deleted=!0,this._invalidIndex=Math.min(this._invalidIndex,i.index);this._hasPending=!0}}insertOrChangeCustomLineHeight(e,t,i,n){this.removeCustomLineHeight(e);for(let o=t;o<=i;o++){const r=new B9e(e,-1,o,n,0);this._pendingSpecialLinesToInsert.push(r)}this._hasPending=!0}heightForLineNumber(e){const t=this._binarySearchOverOrderedCustomLinesArray(e);return t>=0?this._orderedCustomLines[t].maximumSpecialHeight:this._defaultLineHeight}getAccumulatedLineHeightsIncludingLineNumber(e){const t=this._binarySearchOverOrderedCustomLinesArray(e);if(t>=0)return this._orderedCustomLines[t].prefixSum+this._orderedCustomLines[t].maximumSpecialHeight;if(t===-1)return this._defaultLineHeight*e;const i=-(t+1),n=this._orderedCustomLines[i-1];return n.prefixSum+n.maximumSpecialHeight+this._defaultLineHeight*(e-n.lineNumber)}onLinesDeleted(e,t){const i=t-e+1,n=this._orderedCustomLines.length,o=this._binarySearchOverOrderedCustomLinesArray(e);let r;if(o>=0){r=o;for(let h=o-1;h>=0&&this._orderedCustomLines[h].lineNumber===e;h--)r--}else r=o===-(n+1)&&o!==-1?n-1:-(o+1);const a=this._binarySearchOverOrderedCustomLinesArray(t);let l;if(a>=0){l=a;for(let h=a+1;h<n&&this._orderedCustomLines[h].lineNumber===t;h++)l++}else l=a===-(n+1)&&a!==-1?n-1:-(a+1);const c=l>r,d=l===r&&this._orderedCustomLines[r]&&this._orderedCustomLines[r].lineNumber>=e&&this._orderedCustomLines[r].lineNumber<=t;if(c||d){let h=0;for(let x=r;x<=l;x++)h=Math.max(h,this._orderedCustomLines[x].maximumSpecialHeight);let u=0;if(r>0){const x=this._orderedCustomLines[r-1];u=x.prefixSum+x.maximumSpecialHeight+this._defaultLineHeight*(e-x.lineNumber-1)}else u=e>0?(e-1)*this._defaultLineHeight:0;const f=this._orderedCustomLines[r],g=this._orderedCustomLines[l],m=this._orderedCustomLines[l+1],p=m&&m.lineNumber===t+1?m.maximumSpecialHeight:this._defaultLineHeight,v=g.prefixSum+g.maximumSpecialHeight-f.prefixSum+this._defaultLineHeight*(t-g.lineNumber)+this._defaultLineHeight*(f.lineNumber-e)+p-h,b=new Set,w=[],C=new fF;let y=0;for(let x=0;x<this._orderedCustomLines.length;x++){const S=this._orderedCustomLines[x];if(x<r)w.push(S),C.add(S.decorationId,S);else if(x>=r&&x<=l){const L=S.decorationId;b.has(L)?y++:(S.index-=y,S.lineNumber=e,S.prefixSum=u,S.maximumSpecialHeight=h,w.push(S),C.add(S.decorationId,S))}else x>l&&(S.index-=y,S.lineNumber-=i,S.prefixSum-=v,w.push(S),C.add(S.decorationId,S));b.add(S.decorationId)}this._orderedCustomLines=w,this._decorationIDToCustomLine=C}else{const h=i*this._defaultLineHeight;for(let u=l;u<this._orderedCustomLines.length;u++){const f=this._orderedCustomLines[u];f.lineNumber>t&&(f.lineNumber-=i,f.prefixSum-=h)}}}onLinesInserted(e,t){const i=t-e+1,n=this._binarySearchOverOrderedCustomLinesArray(e);let o;if(n>=0){o=n;for(let d=n-1;d>=0&&this._orderedCustomLines[d].lineNumber===e;d--)o--}else o=-(n+1);const r=[],a=new Set;for(let d=o;d<this._orderedCustomLines.length;d++)this._orderedCustomLines[d].lineNumber===e&&a.add(this._orderedCustomLines[d].decorationId);const l=new Set;for(let d=o-1;d>=0;d--)this._orderedCustomLines[d].lineNumber===e-1&&l.add(this._orderedCustomLines[d].decorationId);const c=Qae(l,a);for(let d=o;d<this._orderedCustomLines.length;d++)this._orderedCustomLines[d].lineNumber+=i,this._orderedCustomLines[d].prefixSum+=this._defaultLineHeight*i;if(c.size>0){for(const d of c){const h=this._decorationIDToCustomLine.get(d);if(h){const u=h.reduce((m,p)=>Math.min(m,p.lineNumber),e),f=h.reduce((m,p)=>Math.max(m,p.lineNumber),e),g=h.reduce((m,p)=>Math.max(m,p.specialHeight),0);r.push({decorationId:d,startLineNumber:u,endLineNumber:f,lineHeight:g})}}for(const d of r)this.insertOrChangeCustomLineHeight(d.decorationId,d.startLineNumber,d.endLineNumber,d.lineHeight);this.commit()}}commit(){if(!this._hasPending)return;for(const o of this._pendingSpecialLinesToInsert){const r=this._binarySearchOverOrderedCustomLinesArray(o.lineNumber),a=r>=0?r:-(r+1);this._orderedCustomLines.splice(a,0,o),this._invalidIndex=Math.min(this._invalidIndex,a)}this._pendingSpecialLinesToInsert=[];const e=new fF,t=[];for(let o=0;o<this._invalidIndex;o++){const r=this._orderedCustomLines[o];t.push(r),e.add(r.decorationId,r)}let i=0,n=this._invalidIndex>0?t[this._invalidIndex-1]:void 0;for(let o=this._invalidIndex;o<this._orderedCustomLines.length;o++){const r=this._orderedCustomLines[o];if(r.deleted){i++;continue}if(r.index=o-i,n&&n.lineNumber===r.lineNumber)r.maximumSpecialHeight=n.maximumSpecialHeight,r.prefixSum=n.prefixSum;else{let a=r.specialHeight;for(let c=o;c<this._orderedCustomLines.length;c++){const d=this._orderedCustomLines[c];if(!d.deleted){if(d.lineNumber!==r.lineNumber)break;a=Math.max(a,d.specialHeight)}}r.maximumSpecialHeight=a;let l;n?l=n.prefixSum+n.maximumSpecialHeight+this._defaultLineHeight*(r.lineNumber-n.lineNumber-1):l=this._defaultLineHeight*(r.lineNumber-1),r.prefixSum=l}n=r,t.push(r),e.add(r.decorationId,r)}this._orderedCustomLines=t,this._decorationIDToCustomLine=e,this._invalidIndex=1/0,this._hasPending=!1}_binarySearchOverOrderedCustomLinesArray(e){return EU(this._orderedCustomLines.length,t=>{const i=this._orderedCustomLines[t];return i.lineNumber===e?0:i.lineNumber<e?-1:1})}}class fF{constructor(){this._map=new Map}add(e,t){const i=this._map.get(e);i?i.push(t):this._map.set(e,[t])}get(e){return this._map.get(e)}delete(e){this._map.delete(e)}}class W9e{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class H9e{constructor(e,t,i,n,o){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=o,this.prefixSum=0}}var jg;let V9e=(jg=class{constructor(e,t,i,n,o){this._instanceId=Use(++jg.INSTANCE_COUNT),this._pendingChanges=new W9e,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._paddingTop=i,this._paddingBottom=n,this._lineHeightsManager=new aZ(t,o)}static findInsertionIndex(e,t,i){let n=0,o=e.length;for(;n<o;){const r=n+o>>>1;t===e[r].afterLineNumber?i<e[r].ordinal?o=r:n=r+1:t<e[r].afterLineNumber?o=r:n=r+1}return n}setDefaultLineHeight(e){this._lineHeightsManager.defaultLineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e,t){this._lineCount=e,this._lineHeightsManager=new aZ(this._lineHeightsManager.defaultLineHeight,t)}changeLineHeights(e){let t=!1;try{e({insertOrChangeCustomLineHeight:(n,o,r,a)=>{t=!0,this._lineHeightsManager.insertOrChangeCustomLineHeight(n,o,r,a)},removeCustomLineHeight:n=>{t=!0,this._lineHeightsManager.removeCustomLineHeight(n)}})}finally{this._lineHeightsManager.commit()}return t}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,o,r,a)=>{t=!0,n=n|0,o=o|0,r=r|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new H9e(l,n,o,r,a)),l},changeOneWhitespace:(n,o,r)=>{t=!0,o=o|0,r=r|0,this._pendingChanges.change({id:n,newAfterLineNumber:o,newHeight:r})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const n=new Set;for(const l of i)n.add(l.id);const o=new Map;for(const l of t)o.set(l.id,l);const r=l=>{const c=[];for(const d of l)if(!n.has(d.id)){if(o.has(d.id)){const h=o.get(d.id);d.afterLineNumber=h.newAfterLineNumber,d.height=h.newHeight}c.push(d)}return c},a=r(this._arr).concat(r(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_insertWhitespace(e){const t=jg.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const o=this._arr[n];this._removeWhitespace(n),o.afterLineNumber=t,this._insertWhitespace(o)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const o=this._arr[i].afterLineNumber;e<=o&&o<=t?this._arr[i].afterLineNumber=e-1:o>t&&(this._arr[i].afterLineNumber-=t-e+1)}this._lineHeightsManager.onLinesDeleted(e,t)}onLinesInserted(e,t){e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const o=this._arr[i].afterLineNumber;e<=o&&(this._arr[i].afterLineNumber+=t-e+1)}this._lineHeightsManager.onLinesInserted(e,t)}getWhitespacesTotalHeight(){return this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){const e=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(this._lineCount),t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const r=(n-i|0)/2|0,a=i+r|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){e=e|0;let i;e>1?i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(e-1):i=0;const n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getLineHeightForLineNumber(e){return this._lineHeightsManager.heightForLineNumber(e)}getVerticalOffsetAfterLineNumber(e,t=!1){e=e|0;const i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(e),n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}getWhitespaceMinWidth(){if(this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:e<this._paddingTop}isInBottomPadding(e){if(this._paddingBottom===0)return!1;const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(e=e|0,e<0)return 1;const t=this._lineCount|0;let i=1,n=t;for(;i<n;){const o=(i+n)/2|0,r=this.getLineHeightForLineNumber(o),a=this.getVerticalOffsetForLineNumber(o)|0;if(e>=a+r)i=o+1;else{if(e>=a)return o;n=o}}return i>t?t:i}getLinesViewportData(e,t){e=e|0,t=t|0;const i=this.getLineNumberAtOrAfterVerticalOffset(e)|0,n=this.getVerticalOffsetForLineNumber(i)|0;let o=this._lineCount|0,r=this.getFirstWhitespaceIndexAfterLineNumber(i)|0;const a=this.getWhitespacesCount()|0;let l,c;r===-1?(r=a,c=o+1,l=0):(c=this.getAfterLineNumberForWhitespaceIndex(r)|0,l=this.getHeightForWhitespaceIndex(r)|0);let d=n,h=d;const u=5e5;let f=0;n>=u&&(f=Math.floor(n/u)*u,f=Math.floor(f/this._lineHeightsManager.defaultLineHeight)*this._lineHeightsManager.defaultLineHeight,h-=f);const g=[],m=e+(t-e)/2;let p=-1;for(let C=i;C<=o;C++){const y=this.getLineHeightForLineNumber(C);if(p===-1){const x=d,S=d+y;(x<=m&&m<S||x>m)&&(p=C)}for(d+=y,g[C-i]=h,h+=y;c===C;)h+=l,d+=l,r++,r>=a?c=o+1:(c=this.getAfterLineNumberForWhitespaceIndex(r)|0,l=this.getHeightForWhitespaceIndex(r)|0);if(d>=t){o=C;break}}p===-1&&(p=o);const v=this.getVerticalOffsetForLineNumber(o)|0;let b=i,w=o;if(b<w&&n<e&&b++,b<w){const C=this.getLineHeightForLineNumber(o);v+C>t&&w--}return{bigNumbersDelta:f,startLineNumber:i,endLineNumber:o,relativeVerticalOffset:g,centeredLineNumber:p,completelyVisibleStartLineNumber:b,completelyVisibleEndLineNumber:w,lineHeight:this._lineHeightsManager.defaultLineHeight}}getVerticalOffsetForWhitespaceIndex(e){e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeightsManager.getAccumulatedLineHeightsIncludingLineNumber(t):i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const n=this.getVerticalOffsetForWhitespaceIndex(i),o=this.getHeightForWhitespaceIndex(i);if(e>=n+o)return-1;for(;t<i;){const r=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(e>=a+l)t=r+1;else{if(e>=a)return r;i=r}}return t}getWhitespaceAtVerticalOffset(e){e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t),o=this.getIdForWhitespaceIndex(t),r=this.getAfterLineNumberForWhitespaceIndex(t);return{id:o,afterLineNumber:r,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const o=[];for(let r=i;r<=n;r++){const a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(a>=t)break;o.push({id:this.getIdForWhitespaceIndex(r),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(r),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._arr.slice(0)}getWhitespacesCount(){return this._arr.length}getIdForWhitespaceIndex(e){return e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return e=e|0,this._arr[e].height}},jg.INSTANCE_COUNT=0,jg);const z9e=125;class SS{constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class U9e extends K{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new q),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new SS(0,0,0,0),this._scrollable=this._register(new u0({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new $$(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class $9e extends K{constructor(e,t,i,n){super(),this._configuration=e;const o=this._configuration.options,r=o.get(165),a=o.get(96);this._linesLayout=new V9e(t,o.get(75),a.top,a.bottom,i),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new U9e(0,n)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new SS(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(130)?z9e:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(75)&&this._linesLayout.setDefaultLineHeight(t.get(75)),e.hasChanged(96)){const i=t.get(96);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(165)){const i=t.get(165),n=i.contentWidth,o=i.height,r=this._scrollable.getScrollDimensions(),a=r.contentWidth;this._scrollable.setScrollDimensions(new SS(n,r.contentWidth,o,this._getContentHeight(n,o,a)))}else this._updateHeight();e.hasChanged(130)&&this._configureSmoothScrollDuration()}onFlushed(e,t){this._linesLayout.onFlushed(e,t)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(117);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let o=this._linesLayout.getLinesTotalHeight();return n.get(119)?o+=Math.max(0,t-n.get(75)-n.get(96).bottom):n.get(117).ignoreHorizontalScrollbarInContentHeight||(o+=this._getHorizontalScrollbarHeight(e,i)),o}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new SS(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new aX(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new aX(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(166),n=e.get(59),o=e.get(165);if(i.isViewportWrapping){const r=e.get(81);return t>o.contentWidth+n.typicalHalfwidthCharacterWidth&&r.enabled&&r.side==="right"?t+o.verticalScrollbarWidth:t}else{const r=e.get(118)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+r+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new SS(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}changeSpecialLineHeights(e){const t=this._linesLayout.changeLineHeights(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}getLineHeightForLineNumber(e){return this._linesLayout.getLineHeightForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class __{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class q9e{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new __(new D(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class j9e{constructor(e,t,i,n,o){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,o=e.options;let r;if(o.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new z(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new z(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);r=new D(a.lineNumber,a.column,l.lineNumber,l.column)}else r=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new fae(r,o),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getDecorationsOnLine(e,t=!1,i=!1){const n=new D(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i)}_getDecorationsInRange(e,t,i){const n=this._linesCollection.getDecorationsInRange(e,this.editorId,uR(this.configuration.options),fR(this.configuration.options),t,i),o=e.startLineNumber,r=e.endLineNumber,a=[];let l=0;const c=[];for(let h=o;h<=r;h++)c[h-o]=[];let d=!1;for(let h=0,u=n.length;h<u;h++){const f=n[h],g=f.options;if(!y$(this.model,f))continue;const m=this._getOrCreateViewModelDecoration(f),p=m.range;if(a[l++]=m,g.inlineClassName){const v=new __(p,g.inlineClassName,g.inlineClassNameAffectsLetterSpacing?3:0),b=Math.max(o,p.startLineNumber),w=Math.min(r,p.endLineNumber);for(let C=b;C<=w;C++)c[C-o].push(v)}if(g.beforeContentClassName&&o<=p.startLineNumber&&p.startLineNumber<=r){const v=new __(new D(p.startLineNumber,p.startColumn,p.startLineNumber,p.startColumn),g.beforeContentClassName,1);c[p.startLineNumber-o].push(v)}if(g.afterContentClassName&&o<=p.endLineNumber&&p.endLineNumber<=r){const v=new __(new D(p.endLineNumber,p.endColumn,p.endLineNumber,p.endColumn),g.afterContentClassName,2);c[p.endLineNumber-o].push(v)}g.affectsFont&&(d=!0)}return{decorations:a,inlineDecorations:c,hasVariableFonts:d}}}function gF(s,e){return s===null?e?zR.INSTANCE:UR.INSTANCE:new K9e(s,e)}class K9e{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i];let r;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,d)=>new hd(0,0,c+1,this._projectionData.injectionOptions[d],0));r=hd.applyInjectedText(e.getLineContent(t),a).substring(n,o)}else r=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:o+1});return i>0&&(r=lZ(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,o,r,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,d=l.injectionOptions;let h=null;if(c){h=[];let f=0,g=0;for(let m=0;m<l.getOutputLineCount();m++){const p=new Array;h[m]=p;const v=m>0?l.breakOffsets[m-1]:0,b=l.breakOffsets[m];for(;g<c.length;){const w=d[g].content.length,C=c[g]+f,y=C+w;if(C>b)break;if(v<y){const x=d[g];if(x.inlineClassName){const S=m>0?l.wrappedTextIndentLength:0,L=S+Math.max(C-v,0),E=S+Math.min(y-v,b-v);L!==E&&p.push(new q9e(L,E,x.inlineClassName,x.inlineClassNameAffectsLetterSpacing))}}if(y<=b)f+=w,g++;else break}}}let u;if(c){const f=[];for(let g=0;g<c.length;g++){const m=c[g],p=d[g].tokens;p?p.forEach((v,b)=>{f.push({offset:m,text:v.substring(d[g].content),tokenMetadata:b.metadata})}):f.push({offset:m,text:d[g].content,tokenMetadata:qn.defaultTokenMetadata})}u=e.tokenization.getLineTokens(t).withInserted(f)}else u=e.tokenization.getLineTokens(t);for(let f=i;f<i+n;f++){const g=o+f-i;if(!r[g]){a[g]=null;continue}a[g]=this._getViewLineData(u,h?h[f]:null,f)}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,o=i>0?n.wrappedTextIndentLength:0,r=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(r,a,o);let c=l.getLineContent();i>0&&(c=lZ(n.wrappedTextIndentLength)+c);const d=this._projectionData.getMinOutputOffset(i)+1,h=c.length+1,u=i+1<this.getViewLineCount(),f=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new I$(c,u,d,h,f,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}const IA=class IA{constructor(){}isVisible(){return!0}setVisible(e){return e?this:UR.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.tokenization.getLineTokens(t),o=n.getLineContent();return new I$(o,!1,1,o.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,o,r,a){if(!r[o]){a[o]=null;return}a[o]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new z(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}};IA.INSTANCE=new IA;let zR=IA;const EA=class EA{constructor(){}isVisible(){return!1}setVisible(e){return e?zR.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,o,r,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}};EA.INSTANCE=new EA;let UR=EA;const mF=[""];function lZ(s){if(s>=mF.length)for(let e=1;e<=s;e++)mF[e]=G9e(e);return mF[s]}function G9e(s){return new Array(s+1).join(" ")}class Y9e{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=Uv(e);const i=this.values,n=this.prefixSum,o=t.length;return o===0?!1:(this.values=new Uint32Array(i.length+o),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+o),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Uv(e),t=Uv(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Uv(e),t=Uv(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const o=i.length-e;return t>=o&&(t=o),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Uv(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,o=0,r=0;for(;t<=i;)if(n=t+(i-t)/2|0,o=this.prefixSum[n],r=o-this.values[n],e<r)i=n-1;else if(e>=o)t=n+1;else break;return new ile(n,e-r)}}class X9e{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new ile(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=_O(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let o=0;o<i;o++)this._indexBySum[n+o]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class ile{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class Z9e{constructor(e){this._model=e}_validPosition(e){return this._model.validatePosition(e)}_validRange(e){return this._model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}class Q9e{constructor(e,t,i,n,o,r,a,l,c,d,h){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=o,this.tabSize=r,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=d,this.wrapOnEscapedLineFeeds=h,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new eBe(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),o=i.length,r=this.createLineBreaksComputer(),a=new ff(hd.fromDecorations(n));for(let m=0;m<o;m++){const p=a.takeWhile(v=>v.lineNumber===m+1);r.addRequest(i[m],p,t?t[m]:null)}const l=r.finalize(),c=[],d=this.hiddenAreasDecorationIds.map(m=>this.model.getDecorationRange(m)).sort(D.compareRangesUsingStarts);let h=1,u=0,f=-1,g=f+1<d.length?u+1:o+2;for(let m=0;m<o;m++){const p=m+1;p===g&&(f++,h=d[f].startLineNumber,u=d[f].endLineNumber,g=f+1<d.length?u+1:o+2);const v=p>=h&&p<=u,b=gF(l[m],!v);c[m]=b.getViewLineCount(),this.modelLineProjections[m]=b}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new X9e(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(u=>this.model.validateRange(u)),i=J9e(t),n=this.hiddenAreasDecorationIds.map(u=>this.model.getDecorationRange(u)).sort(D.compareRangesUsingStarts);if(i.length===n.length){let u=!1;for(let f=0;f<i.length;f++)if(!i[f].equalsRange(n[f])){u=!0;break}if(!u)return!1}const o=i.map(u=>({range:u,options:vt.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);const r=i;let a=1,l=0,c=-1,d=c+1<r.length?l+1:this.modelLineProjections.length+2,h=!1;for(let u=0;u<this.modelLineProjections.length;u++){const f=u+1;f===d&&(c++,a=r[c].startLineNumber,l=r[c].endLineNumber,d=c+1<r.length?l+1:this.modelLineProjections.length+2);let g=!1;if(f>=a&&f<=l?this.modelLineProjections[u].isVisible()&&(this.modelLineProjections[u]=this.modelLineProjections[u].setVisible(!1),g=!0):(h=!0,this.modelLineProjections[u].isVisible()||(this.modelLineProjections[u]=this.modelLineProjections[u].setVisible(!0),g=!0)),g){const m=this.modelLineProjections[u].getViewLineCount();this.projectedModelLineLineCounts.setValue(u,m)}}return h||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,o){const r=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===n,d=this.wordBreak===o;if(r&&a&&l&&c&&d)return!1;const h=r&&a&&!l&&c&&d;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=o;let u=null;if(h){u=[];for(let f=0,g=this.modelLineProjections.length;f<g;f++)u[f]=this.modelLineProjections[f].getProjectionData()}return this._constructLines(!1,u),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak,this.wrapOnEscapedLineFeeds)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new l7(n,o)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const o=t>2&&!this.modelLineProjections[t-2].isVisible(),r=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let d=0,h=n.length;d<h;d++){const u=gF(n[d],!o);l.push(u);const f=u.getViewLineCount();a+=f,c[d]=f}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new c7(r,r+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,o=this.modelLineProjections[n].getViewLineCount(),r=this.modelLineProjections[n].isVisible(),a=gF(i,r);this.modelLineProjections[n]=a;const l=this.modelLineProjections[n].getViewLineCount();let c=!1,d=0,h=-1,u=0,f=-1,g=0,m=-1;o>l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+l-1,g=h+1,m=g+(o-l)-1,c=!0):o<l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+o-1,u=h+1,f=u+(l-o)-1,c=!0):(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+l-1),this.projectedModelLineLineCounts.setValue(n,l);const p=d<=h?new tle(d,h-d+1):null,v=u<=f?new c7(u,f):null,b=g<=m?new l7(g,m):null;return[c,p,v,b]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),r=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,o.lineNumber,r.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new cZ(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new z(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new z(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),o=new Array;let r=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const d=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,h=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let u=d;u<h;u++)a.push(new cZ(l,u))}if(!c.isVisible()&&r){const d=new z(l-1,this.model.getLineMaxColumn(l-1)+1),h=D.fromPositions(r,d);o.push(new dZ(h,a)),a=[],r=null}else c.isVisible()&&!r&&(r=new z(l,1))}if(r){const l=D.fromPositions(r,this.getModelEndPositionOfViewLine(n));o.push(new dZ(l,a))}return o}getViewLinesBracketGuides(e,t,i,n){const o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,r=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,n);for(const d of a.viewLines){const u=c[d.modelLineNumber-l].map(f=>{if(f.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.forWrappedLinesAfterColumn).lineNumber>=d.modelLineWrappedLineIdx||f.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.forWrappedLinesBeforeOrAtColumn).lineNumber<d.modelLineWrappedLineIdx)return;if(!f.horizontalLine)return f;let g=-1;if(f.column!==-1){const v=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.column);if(v.lineNumber===d.modelLineWrappedLineIdx)g=v.column;else if(v.lineNumber<d.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(d);else if(v.lineNumber>d.modelLineWrappedLineIdx)return}const m=this.convertModelPositionToViewPosition(d.modelLineNumber,f.horizontalLine.endColumn),p=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.horizontalLine.endColumn);return p.lineNumber===d.modelLineWrappedLineIdx?new Yp(f.visibleColumn,g,f.className,new jS(f.horizontalLine.top,m.column),-1,-1):p.lineNumber<d.modelLineWrappedLineIdx||f.visibleColumn!==-1?void 0:new Yp(f.visibleColumn,g,f.className,new jS(f.horizontalLine.top,this.getMaxColumnOfViewLine(d)),-1,-1)});r.push(u.filter(f=>!!f))}}return r}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let o=[];const r=[],a=[],l=i.lineNumber-1,c=n.lineNumber-1;let d=null;for(let g=l;g<=c;g++){const m=this.modelLineProjections[g];if(m.isVisible()){const p=m.getViewLineNumberOfModelPosition(0,g===l?i.column:1),v=m.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),b=v-p+1;let w=0;b>1&&m.getViewLineMinColumn(this.model,g+1,v)===1&&(w=p===0?1:2),r.push(b),a.push(w),d===null&&(d=new z(g+1,0))}else d!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,g)),d=null)}d!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,n.lineNumber)),d=null);const h=t-e+1,u=new Array(h);let f=0;for(let g=0,m=o.length;g<m;g++){let p=o[g];const v=Math.min(h-f,r[g]),b=a[g];let w;b===2?w=0:b===1?w=1:w=v;for(let C=0;C<v;C++)C===w&&(p=0),u[f++]=p}return u}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let o=e;const r=n.index,a=n.remainder,l=[];for(let c=r,d=this.model.getLineCount();c<d;c++){const h=this.modelLineProjections[c];if(!h.isVisible())continue;const u=c===r?a:0;let f=h.getViewLineCount()-u,g=!1;if(o+f>t&&(g=!0,f=t-o+1),h.getViewLinesData(this.model,c+1,u,f,o-e,i,l),o+=f,g)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),o=n.index,r=n.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,r),c=a.getViewLineMaxColumn(this.model,o+1,r);t<l&&(t=l),t>c&&(t=c);const d=a.getModelColumnOfViewPosition(r,t);return this.model.validatePosition(new z(o+1,d)).equals(i)?new z(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new D(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new z(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new D(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,o=!1){const r=this.model.validatePosition(new z(e,t)),a=r.lineNumber,l=r.column;let c=a-1,d=!1;if(o)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,d=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,d=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new z(n?0:1,1);const h=1+this.projectedModelLineLineCounts.getPrefixSum(c);let u;return d?o?u=this.modelLineProjections[c].getViewPositionOfModelPosition(h,1,i):u=this.modelLineProjections[c].getViewPositionOfModelPosition(h,this.model.getLineMaxColumn(c+1),i):u=this.modelLineProjections[a-1].getViewPositionOfModelPosition(h,l,i),u}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return D.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new D(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const o=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(o,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,o,r){const a=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),l=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(l.lineNumber-a.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new D(a.lineNumber,1,l.lineNumber,l.column),t,i,n,o,r);let c=[];const d=a.lineNumber-1,h=l.lineNumber-1;let u=null;for(let p=d;p<=h;p++)if(this.modelLineProjections[p].isVisible())u===null&&(u=new z(p+1,p===d?a.column:1));else if(u!==null){const b=this.model.getLineMaxColumn(p);c=c.concat(this.model.getDecorationsInRange(new D(u.lineNumber,u.column,p,b),t,i,n,o)),u=null}u!==null&&(c=c.concat(this.model.getDecorationsInRange(new D(u.lineNumber,u.column,l.lineNumber,l.column),t,i,n,o)),u=null),c.sort((p,v)=>{const b=D.compareRangesUsingStarts(p.range,v.range);return b===0?p.id<v.id?-1:p.id>v.id?1:0:b});const f=[];let g=0,m=null;for(const p of c){const v=p.id;m!==v&&(m=v,f[g++]=p)}return f}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function J9e(s){if(s.length===0)return[];const e=s.slice();e.sort(D.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,n=e[0].endLineNumber;for(let o=1,r=e.length;o<r;o++){const a=e[o];a.startLineNumber>n+1?(t.push(new D(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new D(i,1,n,1)),t}class cZ{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class dZ{constructor(e,t){this.modelRange=e,this.viewLines=t}}class eBe{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class tBe{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new Z9e(this.model)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new l7(t,i)}onModelLinesInserted(e,t,i,n){return new c7(t,i)}onModelLineChanged(e,t,i){return[!1,new tle(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let o=0;o<i;o++)n[o]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new I$(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const o=[];for(let r=e;r<=t;r++){const a=r-e;o[a]=i[a]?this.getViewLineData(r):null}return o}getDecorationsInRange(e,t,i,n,o,r){return this.model.getDecorationsInRange(e,t,i,n,o,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}const Vm=cd.Right;class iBe{constructor(e){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((e+1)*Vm/8))}reset(e){const t=Math.ceil((e+1)*Vm/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const o=Vm*n+(e-1);this.lanes[o>>>3]|=1<<o%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){const t=[];let i=Vm*e;for(let n=0;n<Vm;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[cd.Center]}countAtLine(e){let t=Vm*e,i=0;for(let n=0;n<Vm;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}}let nBe=class extends K{constructor(e,t,i,n,o,r,a,l,c,d){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this._transactionalTarget=d,this.hiddenAreasModel=new oBe,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new v9e,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new zv(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Ni(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=j$.create(this.model),this.glyphLanes=new iBe(0),this.model.isTooLargeForTokenization())this._lines=new tBe(this.model);else{const h=this._configuration.options,u=h.get(59),f=h.get(156),g=h.get(166),m=h.get(155),p=h.get(146),v=h.get(160);this._lines=new Q9e(this._editorId,this.model,n,o,u,this.model.getOptions().tabSize,f,g.wrappingColumn,m,p,v)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new M9e(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new $9e(this._configuration,this.getLineCount(),this._getCustomLineHeights(),r)),this._register(this.viewLayout.onDidScroll(h=>{h.scrollTopChanged&&this._handleVisibleLinesChanged(),h.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new g9e(h)),this._eventDispatcher.emitOutgoingEvent(new q$(h.oldScrollWidth,h.oldScrollLeft,h.oldScrollHeight,h.oldScrollTop,h.scrollWidth,h.scrollLeft,h.scrollHeight,h.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(h=>{this._eventDispatcher.emitOutgoingEvent(h)})),this._decorations=new j9e(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(h=>{try{const u=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(u,h)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(NR.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new _9e)})),this._register(this._themeService.onDidColorThemeChange(h=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new m9e(h))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_getCustomLineHeights(){return this._configuration.options.get(5)?this.model.getCustomLineHeightsDecorations(this._editorId).map(i=>{const n=i.range.startLineNumber,o=this.coordinatesConverter.convertModelRangeToViewRange(new D(n,1,n,this.model.getLineMaxColumn(n)));return{decorationId:i.id,startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,lineHeight:i.options.lineHeight||0}}):[]}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new D(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new u9e(e)),this._eventDispatcher.emitOutgoingEvent(new r4(!e,e))}setHasWidgetFocus(e){this._eventDispatcher.emitOutgoingEvent(new w9e(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new l9e)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new c9e)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new z(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new uZ(t,this._viewportStart.startLineDelta)}return new uZ(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),n=this._configuration.options,o=n.get(59),r=n.get(156),a=n.get(166),l=n.get(155),c=n.get(146);this._lines.setWrappingSettings(o,r,a.wrappingColumn,l,c)&&(e.emitViewEvent(new LD),e.emitViewEvent(new ID),e.emitViewEvent(new Hm(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(104)&&(this._decorations.reset(),e.emitViewEvent(new Hm(null))),t.hasChanged(112)&&(this._decorations.reset(),e.emitViewEvent(new Hm(null))),e.emitViewEvent(new d9e(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),zv.shouldRecreate(t)&&(this.cursorConfig=new zv(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(i=>{try{const o=this._eventDispatcher.beginEmitViewEvents();let r=!1,a=!1;const l=i instanceof m_?i.rawContentChangedEvent.changes:i.changes,c=i instanceof m_?i.rawContentChangedEvent.versionId:null,d=this._lines.createLineBreaksComputer();for(const f of l)switch(f.changeType){case 4:{for(let g=0;g<f.detail.length;g++){const m=f.detail[g];let p=f.injectedTexts[g];p&&(p=p.filter(v=>!v.ownerId||v.ownerId===this._editorId)),d.addRequest(m,p,null)}break}case 2:{let g=null;f.injectedText&&(g=f.injectedText.filter(m=>!m.ownerId||m.ownerId===this._editorId)),d.addRequest(f.detail,g,null);break}}const h=d.finalize(),u=new ff(h);for(const f of l)switch(f.changeType){case 1:{this._lines.onModelFlushed(),o.emitViewEvent(new LD),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),r=!0;break}case 3:{const g=this._lines.onModelLinesDeleted(c,f.fromLineNumber,f.toLineNumber);g!==null&&(o.emitViewEvent(g),this.viewLayout.onLinesDeleted(g.fromLineNumber,g.toLineNumber)),r=!0;break}case 4:{const g=u.takeCount(f.detail.length),m=this._lines.onModelLinesInserted(c,f.fromLineNumber,f.toLineNumber,g);m!==null&&(o.emitViewEvent(m),this.viewLayout.onLinesInserted(m.fromLineNumber,m.toLineNumber)),r=!0;break}case 2:{const g=u.dequeue(),[m,p,v,b]=this._lines.onModelLineChanged(c,f.lineNumber,g);a=m,p&&o.emitViewEvent(p),v&&(o.emitViewEvent(v),this.viewLayout.onLinesInserted(v.fromLineNumber,v.toLineNumber)),b&&(o.emitViewEvent(b),this.viewLayout.onLinesDeleted(b.fromLineNumber,b.toLineNumber));break}case 5:break}c!==null&&this._lines.acceptVersionId(c),this.viewLayout.onHeightMaybeChanged(),!r&&a&&(o.emitViewEvent(new ID),o.emitViewEvent(new Hm(null)),this._cursor.onLineMappingChanged(o),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const n=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&n){const o=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(o){const r=this.coordinatesConverter.convertModelPositionToViewPosition(o.getStartPosition()),a=this.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber);this.viewLayout.setScrollPosition({scrollTop:a+this._viewportStart.startLineDelta},1)}}try{const o=this._eventDispatcher.beginEmitViewEvents();i instanceof m_&&o.emitOutgoingEvent(new k9e(i.contentChangedEvent)),this._cursor.onModelContentChanged(o,i)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._configuration.options.get(5)&&this._register(this.model.onDidChangeLineHeight(i=>{const n=i.changes.filter(o=>o.ownerId===this._editorId||o.ownerId===0);if(this.viewLayout.changeSpecialLineHeights(o=>{for(const r of n){const{decorationId:a,lineNumber:l,lineHeight:c}=r,d=this.coordinatesConverter.convertModelRangeToViewRange(new D(l,1,l,this.model.getLineMaxColumn(l)));c!==null?o.insertOrChangeCustomLineHeight(a,d.startLineNumber,d.endLineNumber,c):o.removeCustomLineHeight(a)}}),n.length>0){const o=new Lae(n);this._eventDispatcher.emitOutgoingEvent(new N9e(o))}})),this._configuration.options.get(172)&&this._register(this.model.onDidChangeFont(i=>{const n=i.changes.filter(o=>o.ownerId===this._editorId||o.ownerId===0);if(n.length>0){const o=new Iae(n);this._eventDispatcher.emitOutgoingEvent(new R9e(o))}})),this._register(this.model.onDidChangeTokens(i=>{const n=[];for(let o=0,r=i.ranges.length;o<r;o++){const a=i.ranges[o],l=this.coordinatesConverter.convertModelPositionToViewPosition(new z(a.fromLineNumber,1)).lineNumber,c=this.coordinatesConverter.convertModelPositionToViewPosition(new z(a.toLineNumber,this.model.getLineMaxColumn(a.toLineNumber))).lineNumber;n[o]={fromLineNumber:l,toLineNumber:c}}this._eventDispatcher.emitSingleViewEvent(new p9e(n)),this._eventDispatcher.emitOutgoingEvent(new T9e(i))})),this._register(this.model.onDidChangeLanguageConfiguration(i=>{this._eventDispatcher.emitSingleViewEvent(new f9e),this.cursorConfig=new zv(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new E9e(i))})),this._register(this.model.onDidChangeLanguage(i=>{this.cursorConfig=new zv(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new I9e(i))})),this._register(this.model.onDidChangeOptions(i=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const n=this._eventDispatcher.beginEmitViewEvents();n.emitViewEvent(new LD),n.emitViewEvent(new ID),n.emitViewEvent(new Hm(null)),this._cursor.onLineMappingChanged(n),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new zv(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new D9e(i))})),this._register(this.model.onDidChangeDecorations(i=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Hm(i)),this._eventDispatcher.emitOutgoingEvent(new L9e(i))}))}getFontSizeAtPosition(e){if(!this._configuration.options.get(172))return null;const i=this.model.getFontDecorationsInRange(D.fromPositions(e),this._editorId);let n=this._configuration.options.get(59).fontSize+"px";for(const o of i)if(o.options.fontSize){n=o.options.fontSize;break}return n}setHiddenAreas(e,t,i){var a;this.hiddenAreasModel.setHiddenAreas(t,e);const n=this.hiddenAreasModel.getMergedRanges();if(n===this.previousHiddenAreas&&!i)return;this.previousHiddenAreas=n;const o=this._captureStableViewport();let r=!1;try{const l=this._eventDispatcher.beginEmitViewEvents();r=this._lines.setHiddenAreas(n),r&&(l.emitViewEvent(new LD),l.emitViewEvent(new ID),l.emitViewEvent(new Hm(null)),this._cursor.onLineMappingChanged(l),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount(),this._getCustomLineHeights()),this.viewLayout.onHeightMaybeChanged());const c=(a=o.viewportStartModelPosition)==null?void 0:a.lineNumber;c&&n.some(h=>h.startLineNumber<=c&&c<=h.endLineNumber)||o.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),r&&this._eventDispatcher.emitOutgoingEvent(new S9e)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(165),t=this._configuration.options.get(75),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),o=Math.max(1,n.completelyVisibleStartLineNumber-i),r=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new D(o,this.getLineMinColumn(o),r,this.getLineMaxColumn(r)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const n=[];let o=0,r=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let d=0,h=i.length;d<h;d++){const u=i[d].startLineNumber,f=i[d].endLineNumber;f<r||u>l||(r<u&&(n[o++]=new D(r,a,u-1,this.model.getLineMaxColumn(u-1))),r=f+1,a=1)}return(r<l||r===l&&a<c)&&(n[o++]=new D(r,a,l,c)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new D(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new D(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new z(i,this.getLineMinColumn(i))),o=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:o}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=Jo(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=uc(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}_getTextDirection(e,t){let i=0;for(const n of t){const o=n.range;if(o.startLineNumber>e||o.endLineNumber<e)continue;const r=n.options.textDirection;r===qa.RTL?i++:r===qa.LTR&&i--}return i>0?qa.RTL:qa.LTR}getTextDirection(e){const t=this._decorations.getDecorationsOnLine(e);return this._getTextDirection(e,t.decorations)}getViewportViewLineRenderingData(e,t){const i=this._decorations.getDecorationsViewportData(e),n=i.inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,n,i.hasVariableFonts,i.decorations)}getViewLineRenderingData(e){const t=this._decorations.getDecorationsOnLine(e);return this._getViewLineRenderingData(e,t.inlineDecorations[0],t.hasVariableFonts,t.decorations)}_getViewLineRenderingData(e,t,i,n){const o=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),a=this.getTabSize(),l=this._lines.getViewLineData(e);return l.inlineDecorations&&(t=[...t,...l.inlineDecorations.map(c=>c.toInlineDecoration(e))]),new el(l.minColumn,l.maxColumn,l.content,l.continuesWithWrappedLine,o,r,l.tokens,t,a,l.startVisibleColumn,this._getTextDirection(e,n),i)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new B4e(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,uR(this._configuration.options),fR(this._configuration.options)),i=new sBe;for(const n of t){const o=n.options,r=o.overviewRuler;if(!r)continue;const a=r.position;if(a===0)continue;const l=r.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),d=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(l,o.zIndex,c,d,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i==null||i.invalidateCachedColor();const n=t.options.minimap;n==null||n.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e),n=this.model.modifyPosition(i,t);return this.coordinatesConverter.convertModelPositionToViewPosition(n)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const r=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(r)}getPlainTextToCopy(e,t,i){const n=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(D.compareRangesUsingStarts);let o=!1,r=!1;for(const l of e)l.isEmpty()?o=!0:r=!0;if(!r){if(!t)return"";const l=e.map(d=>d.startLineNumber);let c="";for(let d=0;d<l.length;d++)d>0&&l[d-1]===l[d]||(c+=this.model.getLineContent(l[d])+n);return c}if(o&&t){const l=[];let c=0;for(const d of e){const h=d.startLineNumber;d.isEmpty()?h!==c&&l.push(this.model.getLineContent(h)):l.push(this.model.getValueInRange(d,i?2:0)),c=h}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===Za||e.length!==1)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const d=n.startLineNumber;n=new D(d,this.model.getLineMinColumn(d),d,this.model.getLineMaxColumn(d))}const o=this._configuration.options.get(59),r=this._getColorMap(),l=/[:;\\\/<>]/.test(o.fontFamily)||o.fontFamily===Or.fontFamily;let c;return l?c=Or.fontFamily:(c=o.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Or.fontFamily}`),{mode:i,html:`<div style="color: ${r[1]};background-color: ${r[2]};font-family: ${c};font-weight: ${o.fontWeight};font-size: ${o.fontSize}px;line-height: ${o.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,r)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=o;c++){const d=this.model.tokenization.getLineTokens(c),h=d.getLineContent(),u=c===i?n-1:0,f=c===o?r-1:h.length;h===""?l+="<br>":l+=F9e(h,d.inflate(),t,u,f,a,no)}return l}_getColorMap(){const e=An.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=re.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(n=>this._cursor.setStates(n,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(n=>this._cursor.setSelections(n,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new x9e);return}this._withViewEventsCollector(e)}executeEdits(e,t,i,n){this._executeCursorEdit(o=>this._cursor.executeEdits(o,e,t,i,n))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,n,o){this._executeCursorEdit(r=>this._cursor.compositionType(r,e,t,i,n,o))}paste(e,t,i,n){this._executeCursorEdit(o=>this._cursor.paste(o,e,t,i,n))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealAllCursors(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealAll(n,e,i,0,t,0))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealPrimary(n,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new D(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new nx(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new D(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new nx(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,n,o){this._withViewEventsCollector(r=>r.emitViewEvent(new nx(e,!1,i,null,n,t,o)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new b9e),this._eventDispatcher.emitOutgoingEvent(new y9e))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class j${static create(e){const t=e._setTrackedRange(null,new D(1,1,1,1),1);return new j$(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,n,o){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=n,this._startLineDelta=o}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new z(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new D(i.lineNumber,i.column,i.lineNumber,i.column),1),o=e.viewLayout.getVerticalOffsetForLineNumber(t),r=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=r-o}invalidate(){this._isValid=!1}}class sBe{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,o){const r=this._asMap[e];if(r){const a=r.data,l=a[a.length-3],c=a[a.length-1];if(l===o&&c+1>=i){n>c&&(a[a.length-1]=n);return}a.push(o,i,n)}else{const a=new qL(e,t,[o,i,n]);this._asMap[e]=a,this.asArray.push(a)}}}class oBe{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&hZ(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>rBe(t,i),[]);return hZ(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function rBe(s,e){const t=[];let i=0,n=0;for(;i<s.length&&n<e.length;){const o=s[i],r=e[n];if(o.endLineNumber<r.startLineNumber-1)t.push(s[i++]);else if(r.endLineNumber<o.startLineNumber-1)t.push(e[n++]);else{const a=Math.min(o.startLineNumber,r.startLineNumber),l=Math.max(o.endLineNumber,r.endLineNumber);t.push(new D(a,1,l,1)),i++,n++}}for(;i<s.length;)t.push(s[i++]);for(;n<e.length;)t.push(e[n++]);return t}function hZ(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].equalsRange(e[t]))return!1;return!0}class uZ{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}}class g0{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}var aBe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Kh=function(s,e){return function(t,i){e(t,i,s)}},op,I_;let Vb=(I_=class extends K{get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}get contextKeyService(){return this._contextKeyService}constructor(e,t,i,n,o,r,a,l,c,d,h,u){super(),this.languageConfigurationService=h,this._deliveryQueue=Xke(),this._contributions=this._register(new uFe),this._onDidDispose=this._register(new q),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeLineHeight=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeLineHeight=this._onDidChangeLineHeight.event,this._onDidChangeFont=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeFont=this._onDidChangeFont.event,this._onDidChangeModelTokens=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new fZ({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new fZ({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new Ho(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new q({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onWillTriggerEditorOperationEvent=this._register(new q),this._onBeginUpdate=this._register(new q),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new q),this.onEndUpdate=this._onEndUpdate.event,this._onBeforeExecuteEdit=this._register(new q),this.onBeforeExecuteEdit=this._onBeforeExecuteEdit.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),this.inComposition=!1,o.willCreateCodeEditor();const f={...t};if(this._domElement=e,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++lBe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?He.SimpleEditorContext:He.EditorContext),f,d)),this._register(this._configuration.onDidChange(p=>{this._onDidChangeConfiguration.fire(p);const v=this._configuration.options;if(p.hasChanged(165)){const b=v.get(165);this._onDidLayoutChange.fire(b)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),i.contextKeyValues)for(const[p,v]of Object.entries(i.contextKeyValues))this._contextKeyService.createKey(p,v);this._notificationService=c,this._codeEditorService=o,this._commandService=r,this._themeService=l,this._register(new dBe(this,this._contextKeyService)),this._register(new hBe(this,this._contextKeyService,u)),this._instantiationService=this._register(n.createChild(new g0([ut,this._contextKeyService]))),this._modelData=null,this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let g;Array.isArray(i.contributions)?g=i.contributions:g=g1.getEditorContributions(),this._contributions.initialize(this,g,this._instantiationService);for(const p of g1.getEditorActions()){if(this._actions.has(p.id)){_t(new Error(`Cannot have two actions with the same id ${p.id}`));continue}const v=new Eae(p.id,p.label,p.alias,p.metadata,p.precondition??void 0,b=>this._instantiationService.invokeFunction(w=>Promise.resolve(p.runEditorCommand(w,this,b))),this._contextKeyService);this._actions.set(v.id,v)}const m=()=>!this._configuration.options.get(104)&&this._configuration.options.get(43).enabled;this._register(new jTe(this._domElement,{onDragOver:p=>{if(!m())return;const v=this.getTargetAtClientPoint(p.clientX,p.clientY);v!=null&&v.position&&this.showDropIndicatorAt(v.position)},onDrop:async p=>{if(!m()||(this.removeDropIndicator(),!p.dataTransfer))return;const v=this.getTargetAtClientPoint(p.clientX,p.clientY);v!=null&&v.position&&this._onDropIntoEditor.fire({position:v.position,event:p})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;(t=this._modelData)==null||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i,n){return new cB(e,t,i,this._domElement,n)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return yk.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?vi.getWordAtPosition(this._modelData.model,this._configuration.options.get(148),this._configuration.options.get(147),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){var t;try{this._beginUpdate();const i=e;if(this._modelData===null&&i===null||this._modelData&&this._modelData.model===i)return;const n={oldModelUrl:((t=this._modelData)==null?void 0:t.model.uri)||null,newModelUrl:(i==null?void 0:i.uri)||null};this._onWillChangeModel.fire(n);const o=this.hasTextFocus(),r=this._detachModel();this._attachModel(i),this.hasModel()?o&&this.focus():(this._editorTextFocus.setValue(!1),this._editorWidgetFocus.setValue(!1)),this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(r),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const o=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(r.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?op._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?op._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const o=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber,n)}getBottomForLineNumber(e,t=!1){if(!this._modelData)return-1;const i=this._modelData.model.getLineMaxColumn(e);return op._getVerticalOffsetAfterPosition(this._modelData,e,i,t)}getLineHeightForPosition(e){if(!this._modelData)return-1;const t=this._modelData.viewModel,i=t.coordinatesConverter,n=z.lift(e);if(i.modelPositionIsVisible(n)){const o=i.convertModelPositionToViewPosition(n);return t.viewLayout.getLineHeightForLineNumber(o.lineNumber)}return 0}setHiddenAreas(e,t,i){var n;(n=this._modelData)==null||n.viewModel.setHiddenAreas(e.map(o=>D.lift(o)),t,i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return Ln.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!z.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!D.isIRange(e))throw new Error("Invalid arguments");const o=this._modelData.model.validateRange(e),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(o);this._modelData.viewModel.revealRange("api",i,r,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new D(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!z.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new D(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=Oe.isISelection(e),n=D.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const o={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(o,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new Oe(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new D(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!D.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(D.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let n=0,o=e.length;n<o;n++)if(!Oe.isISelection(e[n]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const n=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(n)}}handleInitialized(){var e;(e=this._getViewModel())==null||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){i=i||{};try{switch(this._onWillTriggerEditorOperationEvent.fire({source:e,handlerId:t,payload:i}),this._beginUpdate(),t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const o=i;this._type(e,o.text||"");return}case"replacePreviousChar":{const o=i;this._compositionType(e,o.text||"",o.replaceCharCnt||0,0,0);return}case"compositionType":{const o=i;this._compositionType(e,o.text||"",o.replacePrevCharCnt||0,o.replaceNextCharCnt||0,o.positionDelta||0);return}case"paste":{const o=i;this._paste(e,o.text||"",o.pasteOnNewLine||!1,o.multicursorText||null,o.mode||null,o.clipboardEvent);return}case"cut":this._cut(e);return}const n=this.getAction(t);if(n){Promise.resolve(n.run(i)).then(void 0,_t);return}if(!this._modelData||this._triggerEditorCommand(e,t,i))return;this._triggerCommand(t,i)}finally{this._endUpdate()}}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this.inComposition=!0,this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this.inComposition=!1,this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,n,o){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,o,e)}_paste(e,t,i,n,o,r){if(!this._modelData)return;const a=this._modelData.viewModel,l=a.getSelection().getStartPosition();a.paste(t,i,n,e);const c=a.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:r,range:new D(l.lineNumber,l.column,c.lineNumber,c.column),languageId:o})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=g1.getEditorCommand(t);return n?(i=i||{},ws(i)&&(i.source=e),this._instantiationService.invokeFunction(o=>{Promise.resolve(n.runEditorCommand(o,this,i)).then(void 0,_t)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(104)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(104)?!1:(this._modelData.model.popStackElement(),!0)}edit(e,t){return this.executeEdits(t,e.replacements.map(i=>({range:i.range,text:i.text})),void 0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(104))return!1;let n;i?Array.isArray(i)?n=()=>i:n=i:n=()=>null;let o,r;return e instanceof Oae?(r=e,o=e.metadata.source):(r=ko.unknown({name:o}),o=e),this._onBeforeExecuteEdit.fire({source:o??void 0}),this._modelData.viewModel.executeEdits(o,t,n,r),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new uBe(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){if(!this._modelData)return null;const t=this._configuration.options;return this._modelData.model.getLineDecorations(e,this._id,uR(t),fR(t))}getDecorationsInRange(e){if(!this._modelData)return null;const t=this._configuration.options;return this._modelData.model.getDecorationsInRange(e,this._id,uR(t),fR(t))}getFontSizeAtPosition(e){return this._modelData?this._modelData.viewModel.getFontSizeAtPosition(e):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.changeDecorations(i=>i.deltaDecorations(t,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(165)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,t=!1){this._configuration.observeContainer(e),t||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isWidgetFocused()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),n=this._configuration.options.get(165),o=op._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),r=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft(),a=this.getLineHeightForPosition(t);return{top:o,left:r,height:a}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){js(e,this._configuration.options.get(59))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),n=new nBe(this._id,this._configuration,e,D$.create(je(this._domElement)),U$.create(this._configuration.options),a=>Vr(je(this._domElement),a),this.languageConfigurationService,this._themeService,i,{batchChanges:a=>{try{return this._beginUpdate(),a()}finally{this._endUpdate()}}});t.push(e.onWillDispose(()=>this.setModel(null))),t.push(n.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._editorWidgetFocus.setValue(a.hasFocus);break;case 3:this._onDidScrollChange.fire(a);break;case 4:this._onDidChangeViewZones.fire();break;case 5:this._onDidChangeHiddenAreas.fire();break;case 6:this._onDidAttemptReadOnlyEdit.fire();break;case 7:{if(a.reachedMaxCursorCount){const h=this.getOption(89),u=_(83,"The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(f0.Warning,u,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:_(84,"Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let h=0,u=a.selections.length;h<u;h++)l[h]=a.selections[h].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const d={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(d);break}case 8:this._onDidChangeModelDecorations.fire(a.event);break;case 9:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 10:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 11:this._onDidChangeModelContent.fire(a.event);break;case 12:this._onDidChangeModelOptions.fire(a.event);break;case 13:this._onDidChangeModelTokens.fire(a.event);break;case 14:this._onDidChangeLineHeight.fire(a.event);break;case 15:this._onDidChangeFont.fire(a.event);break}}));const[o,r]=this._createView(n);if(r){this._domElement.appendChild(o.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addContentWidget(this._contentWidgets[d])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addOverlayWidget(this._overlayWidgets[d])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addGlyphMarginWidget(this._glyphMarginWidgets[d])}o.render(!1,!0),o.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new cBe(e,n,o,r,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(o,r,a,l)=>{this._paste("keyboard",o,r,a,l)},type:o=>{this._type("keyboard",o)},compositionType:(o,r,a,l)=>{this._compositionType("keyboard",o,r,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(o,r,a,l)=>{const c={text:o,pasteOnNewLine:r,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:o=>{const r={text:o};this._commandService.executeCommand("type",r)},compositionType:(o,r,a,l)=>{if(a||l){const c={text:o,replacePrevCharCnt:r,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:o,replaceCharCnt:r};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new JO(e.coordinatesConverter);return i.onKeyDown=o=>this._onKeyDown.fire(o),i.onKeyUp=o=>this._onKeyUp.fire(o),i.onContextMenu=o=>this._onContextMenu.fire(o),i.onMouseMove=o=>this._onMouseMove.fire(o),i.onMouseLeave=o=>this._onMouseLeave.fire(o),i.onMouseDown=o=>this._onMouseDown.fire(o),i.onMouseUp=o=>this._onMouseUp.fire(o),i.onMouseDrag=o=>this._onMouseDrag.fire(o),i.onMouseDrop=o=>this._onMouseDrop.fire(o),i.onMouseDropCanceled=o=>this._onMouseDropCanceled.fire(o),i.onMouseWheel=o=>this._onMouseWheel.fire(o),[new UB(this._domElement,this.getId(),t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e==null||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){var i;if((i=this._contributionsDisposable)==null||i.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&t.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new D(e.lineNumber,e.column,e.lineNumber,e.column),options:op.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}},op=I_,I_.dropIntoEditorDecorationOptions=vt.register({description:"workbench-dnd-target",className:"dnd-target"}),I_);Vb=op=aBe([Kh(3,$e),Kh(4,ii),Kh(5,en),Kh(6,ut),Kh(7,Dn),Kh(8,Hn),Kh(9,so),Kh(10,wn),Kh(11,We)],Vb);let lBe=0,cBe=class{constructor(e,t,i,n,o,r){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=o,this.attachedView=r}dispose(){yi(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}};class fZ extends K{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new q(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new q(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class Ho extends q{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class dBe extends K{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=B.editorSimpleInput.bindTo(t),this._editorFocus=B.focus.bindTo(t),this._textInputFocus=B.textInputFocus.bindTo(t),this._editorTextFocus=B.editorTextFocus.bindTo(t),this._tabMovesFocus=B.tabMovesFocus.bindTo(t),this._editorReadonly=B.readOnly.bindTo(t),this._inDiffEditor=B.inDiffEditor.bindTo(t),this._editorColumnSelection=B.columnSelection.bindTo(t),this._hasMultipleSelections=B.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=B.hasNonEmptySelection.bindTo(t),this._canUndo=B.canUndo.bindTo(t),this._canRedo=B.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(ww.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(e.get(164)||ww.getTabFocusMode()),this._editorReadonly.set(e.get(104)),this._inDiffEditor.set(e.get(70)),this._editorColumnSelection.set(e.get(28))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class hBe extends K{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=B.languageId.bindTo(t),this._hasCompletionItemProvider=B.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=B.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=B.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=B.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=B.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=B.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=B.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=B.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=B.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=B.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=B.hasReferenceProvider.bindTo(t),this._hasRenameProvider=B.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=B.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=B.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=B.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=B.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=B.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=B.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInEmbeddedEditor=B.isInEmbeddedEditor.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===ct.walkThroughSnippet||e.uri.scheme===ct.vscodeChatCodeBlock)})}}class uBe{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}}const fBe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),gBe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function Kv(s){return fBe+encodeURIComponent(s.toString())+gBe}const mBe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),pBe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function gZ(s){return mBe+encodeURIComponent(s.toString())+pBe}Ul((s,e)=>{const t=s.getColor(qO);t&&(e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${Kv(t)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-error-decoration: url("data:image/svg+xml,${Kv(t)}"); }`));const i=s.getColor(mf);i&&(e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${Kv(i)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-warning-decoration: url("data:image/svg+xml,${Kv(i)}"); }`));const n=s.getColor(Lh);n&&(e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${Kv(n)}") repeat-x bottom left; }`),e.addRule(`:root { --monaco-editor-info-decoration: url("data:image/svg+xml,${Kv(n)}"); }`));const o=s.getColor(OMe);o&&(e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${gZ(o)}") no-repeat bottom left; }`),e.addRule(`:root { --monaco-editor-hint-decoration: url("data:image/svg+xml,${gZ(o)}"); }`));const r=s.getColor(WOe);r&&(e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`),e.addRule(`:root { --monaco-editor-unnecessary-decoration-opacity: ${r.rgba.a}; }`))});function Gi(s){return new _Be(s)}class _Be extends roe{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function iu(s,e){return s}function a4(s){return Gi(s)}const Df=Mt("accessibilitySignalService"),Nt=class Nt{static register(e){return new Nt(e.fileName)}constructor(e){this.fileName=e}};Nt.error=Nt.register({fileName:"error.mp3"}),Nt.warning=Nt.register({fileName:"warning.mp3"}),Nt.success=Nt.register({fileName:"success.mp3"}),Nt.foldedArea=Nt.register({fileName:"foldedAreas.mp3"}),Nt.break=Nt.register({fileName:"break.mp3"}),Nt.quickFixes=Nt.register({fileName:"quickFixes.mp3"}),Nt.taskCompleted=Nt.register({fileName:"taskCompleted.mp3"}),Nt.taskFailed=Nt.register({fileName:"taskFailed.mp3"}),Nt.terminalBell=Nt.register({fileName:"terminalBell.mp3"}),Nt.diffLineInserted=Nt.register({fileName:"diffLineInserted.mp3"}),Nt.diffLineDeleted=Nt.register({fileName:"diffLineDeleted.mp3"}),Nt.diffLineModified=Nt.register({fileName:"diffLineModified.mp3"}),Nt.requestSent=Nt.register({fileName:"requestSent.mp3"}),Nt.responseReceived1=Nt.register({fileName:"responseReceived1.mp3"}),Nt.responseReceived2=Nt.register({fileName:"responseReceived2.mp3"}),Nt.responseReceived3=Nt.register({fileName:"responseReceived3.mp3"}),Nt.responseReceived4=Nt.register({fileName:"responseReceived4.mp3"}),Nt.clear=Nt.register({fileName:"clear.mp3"}),Nt.save=Nt.register({fileName:"save.mp3"}),Nt.format=Nt.register({fileName:"format.mp3"}),Nt.voiceRecordingStarted=Nt.register({fileName:"voiceRecordingStarted.mp3"}),Nt.voiceRecordingStopped=Nt.register({fileName:"voiceRecordingStopped.mp3"}),Nt.progress=Nt.register({fileName:"progress.mp3"}),Nt.chatEditModifiedFile=Nt.register({fileName:"chatEditModifiedFile.mp3"}),Nt.editsKept=Nt.register({fileName:"editsKept.mp3"}),Nt.editsUndone=Nt.register({fileName:"editsUndone.mp3"}),Nt.nextEditSuggestion=Nt.register({fileName:"nextEditSuggestion.mp3"}),Nt.terminalCommandSucceeded=Nt.register({fileName:"terminalCommandSucceeded.mp3"}),Nt.chatUserActionRequired=Nt.register({fileName:"chatUserActionRequired.mp3"}),Nt.codeActionTriggered=Nt.register({fileName:"codeActionTriggered.mp3"}),Nt.codeActionApplied=Nt.register({fileName:"codeActionApplied.mp3"});let Pi=Nt;class bBe{constructor(e){this.randomOneOf=e}}const wt=class wt{constructor(e,t,i,n,o,r,a=!1){this.sound=e,this.name=t,this.legacySoundSettingsKey=i,this.settingsKey=n,this.legacyAnnouncementSettingsKey=o,this.announcementMessage=r,this.managesOwnEnablement=a}static register(e){const t=new bBe("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new wt(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage,e.managesOwnEnablement);return wt._signals.add(i),i}};wt._signals=new Set,wt.errorAtPosition=wt.register({name:_(1576,"Error at Position"),sound:Pi.error,announcementMessage:_(1577,"Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"}),wt.warningAtPosition=wt.register({name:_(1578,"Warning at Position"),sound:Pi.warning,announcementMessage:_(1579,"Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"}),wt.errorOnLine=wt.register({name:_(1580,"Error on Line"),sound:Pi.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:_(1581,"Error on Line"),settingsKey:"accessibility.signals.lineHasError"}),wt.warningOnLine=wt.register({name:_(1582,"Warning on Line"),sound:Pi.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:_(1583,"Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"}),wt.foldedArea=wt.register({name:_(1584,"Folded Area on Line"),sound:Pi.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:_(1585,"Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"}),wt.break=wt.register({name:_(1586,"Breakpoint on Line"),sound:Pi.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:_(1587,"Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"}),wt.inlineSuggestion=wt.register({name:_(1588,"Inline Suggestion on Line"),sound:Pi.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"}),wt.nextEditSuggestion=wt.register({name:_(1589,"Next Edit Suggestion on Line"),sound:Pi.nextEditSuggestion,legacySoundSettingsKey:"audioCues.nextEditSuggestion",settingsKey:"accessibility.signals.nextEditSuggestion",announcementMessage:_(1590,"Next Edit Suggestion")}),wt.terminalQuickFix=wt.register({name:_(1591,"Terminal Quick Fix"),sound:Pi.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:_(1592,"Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"}),wt.onDebugBreak=wt.register({name:_(1593,"Debugger Stopped on Breakpoint"),sound:Pi.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:_(1594,"Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"}),wt.noInlayHints=wt.register({name:_(1595,"No Inlay Hints on Line"),sound:Pi.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:_(1596,"No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"}),wt.taskCompleted=wt.register({name:_(1597,"Task Completed"),sound:Pi.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:_(1598,"Task Completed"),settingsKey:"accessibility.signals.taskCompleted"}),wt.taskFailed=wt.register({name:_(1599,"Task Failed"),sound:Pi.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:_(1600,"Task Failed"),settingsKey:"accessibility.signals.taskFailed"}),wt.terminalCommandFailed=wt.register({name:_(1601,"Terminal Command Failed"),sound:Pi.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:_(1602,"Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"}),wt.terminalCommandSucceeded=wt.register({name:_(1603,"Terminal Command Succeeded"),sound:Pi.terminalCommandSucceeded,announcementMessage:_(1604,"Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"}),wt.terminalBell=wt.register({name:_(1605,"Terminal Bell"),sound:Pi.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:_(1606,"Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"}),wt.notebookCellCompleted=wt.register({name:_(1607,"Notebook Cell Completed"),sound:Pi.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:_(1608,"Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"}),wt.notebookCellFailed=wt.register({name:_(1609,"Notebook Cell Failed"),sound:Pi.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:_(1610,"Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"}),wt.diffLineInserted=wt.register({name:_(1611,"Diff Line Inserted"),sound:Pi.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"}),wt.diffLineDeleted=wt.register({name:_(1612,"Diff Line Deleted"),sound:Pi.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"}),wt.diffLineModified=wt.register({name:_(1613,"Diff Line Modified"),sound:Pi.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"}),wt.chatEditModifiedFile=wt.register({name:_(1614,"Chat Edit Modified File"),sound:Pi.chatEditModifiedFile,announcementMessage:_(1615,"File Modified from Chat Edits"),settingsKey:"accessibility.signals.chatEditModifiedFile"}),wt.chatRequestSent=wt.register({name:_(1616,"Chat Request Sent"),sound:Pi.requestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:_(1617,"Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"}),wt.chatResponseReceived=wt.register({name:_(1618,"Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Pi.responseReceived1,Pi.responseReceived2,Pi.responseReceived3,Pi.responseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"}),wt.codeActionTriggered=wt.register({name:_(1619,"Code Action Request Triggered"),sound:Pi.codeActionTriggered,legacySoundSettingsKey:"audioCues.codeActionRequestTriggered",legacyAnnouncementSettingsKey:"accessibility.alert.codeActionRequestTriggered",announcementMessage:_(1620,"Code Action Request Triggered"),settingsKey:"accessibility.signals.codeActionTriggered"}),wt.codeActionApplied=wt.register({name:_(1621,"Code Action Applied"),legacySoundSettingsKey:"audioCues.codeActionApplied",sound:Pi.codeActionApplied,settingsKey:"accessibility.signals.codeActionApplied"}),wt.progress=wt.register({name:_(1622,"Progress"),sound:Pi.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:_(1623,"Progress"),settingsKey:"accessibility.signals.progress"}),wt.clear=wt.register({name:_(1624,"Clear"),sound:Pi.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:_(1625,"Clear"),settingsKey:"accessibility.signals.clear"}),wt.save=wt.register({name:_(1626,"Save"),sound:Pi.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:_(1627,"Save"),settingsKey:"accessibility.signals.save"}),wt.format=wt.register({name:_(1628,"Format"),sound:Pi.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:_(1629,"Format"),settingsKey:"accessibility.signals.format"}),wt.voiceRecordingStarted=wt.register({name:_(1630,"Voice Recording Started"),sound:Pi.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"}),wt.voiceRecordingStopped=wt.register({name:_(1631,"Voice Recording Stopped"),sound:Pi.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"}),wt.editsKept=wt.register({name:_(1632,"Edits Kept"),sound:Pi.editsKept,announcementMessage:_(1633,"Edits Kept"),settingsKey:"accessibility.signals.editsKept"}),wt.editsUndone=wt.register({name:_(1634,"Undo Edits"),sound:Pi.editsUndone,announcementMessage:_(1635,"Edits Undone"),settingsKey:"accessibility.signals.editsUndone"}),wt.chatUserActionRequired=wt.register({name:_(1636,"Chat User Action Required"),sound:Pi.chatUserActionRequired,announcementMessage:_(1637,"Chat User Action Required"),settingsKey:"accessibility.signals.chatUserActionRequired",managesOwnEnablement:!0});let ur=wt;function mZ(s,e,t,i=Ls.ofCaller()){return loe({debugName:()=>`Configuration Key "${s}"`},n=>t.onDidChangeConfiguration(o=>{o.affectsConfiguration(s)&&n(o)}),()=>t.getValue(s)??e,i)}function Ad(s,e,t,i=Ls.ofCaller()){const n=s.bindTo(e),o=new oe;return _o({debugName:()=>`Set Context Key "${s.key}"`},r=>{const a=t(r);return n.set(a),a},i).recomputeInitiallyAndOnChange(o),o}const nle=Mt("progressService"),_K=class _K{constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};_K.None=Object.freeze({report(){}});let ed=_K;const vf=Mt("editorProgressService");class ud{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new ud(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const o=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-o}return new ud(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,n,o){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=n,this._cursorPosition=o}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}}const zb={RESOURCES:"ResourceURLs",TEXT:Un.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"},vBe=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let l4=vBe;const CBe=new bo(()=>l4("mouse",!1)),wBe=new bo(()=>l4("element",!1));function yBe(s){l4=s}function Fh(s){return s==="element"?wBe.value:CBe.value}function sle(){return l4("element",!0)}function Ju(s,e){if(s!==void 0){const t=s.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=Ju(i[1].trim(),e)),`var(${i[0]}, ${e})`}return s}return e}function pZ(s){const e=s.replaceAll(/[^_\-a-z0-9]/gi,"");return e!==s&&console.warn(`CSS ident value ${s} modified to ${e} to be safe for CSS`),e}function Hf(s){return`'${s.replaceAll(/'/g,"\\000027")}'`}function Eh(s){return s?Yr`url('${CSS.escape(Qse.uriToBrowserUri(s).toString(!0))}')`:"url('')"}function ED(s,e=!1){const t=CSS.escape(s);return!e&&t!==s&&console.warn(`CSS class name ${s} modified to ${t} to be safe for CSS`),t}function Yr(s,...e){return s.reduce((t,i,n)=>{const o=e[n]||"";return t+i+o},"")}class pF{constructor(){this._parts=[]}push(...e){this._parts.push(...e)}join(e=`
`){return this._parts.join(e)}}function SBe(s){const e=xBe(s);if(e&&e.length>0)return new Uint32Array(e)}let Ra=0;const dg=new Uint32Array(10);function xBe(s){if(Ra=0,Ld(s,_F,4352),Ra>0||(Ld(s,bF,4449),Ra>0)||(Ld(s,vF,4520),Ra>0)||(Ld(s,zm,12593),Ra))return dg.subarray(0,Ra);if(s>=44032&&s<=55203){const e=s-44032,t=e%588,i=Math.floor(e/588),n=Math.floor(t/28),o=t%28-1;if(i<_F.length?Ld(i,_F,0):4352+i-12593<zm.length&&Ld(4352+i,zm,12593),n<bF.length?Ld(n,bF,0):4449+n-12593<zm.length&&Ld(4449+n-12593,zm,12593),o>=0&&(o<vF.length?Ld(o,vF,0):4520+o-12593<zm.length&&Ld(4520+o-12593,zm,12593)),Ra>0)return dg.subarray(0,Ra)}}function Ld(s,e,t){s>=t&&s<t+e.length&&LBe(e[s-t])}function LBe(s){s!==0&&(dg[Ra++]=s&255,s>>8&&(dg[Ra++]=s>>8&255),s>>16&&(dg[Ra++]=s>>16&255))}const _F=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),bF=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),vF=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),zm=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function K$(...s){return function(e,t){for(let i=0,n=s.length;i<n;i++){const o=s[i](e,t);if(o)return o}return null}}ole.bind(void 0,!1);const eI=ole.bind(void 0,!0);function ole(s,e,t){if(!t||t.length<e.length)return null;let i;return s?i=CU(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function rle(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t===-1?null:[{start:t,end:t+s.length}]}function ale(s,e){return d7(s.toLowerCase(),e.toLowerCase(),0,0)}function d7(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]===e[i]){let n=null;return(n=d7(s,e,t+1,i+1))?X$({start:i,end:i+1},n):null}return d7(s,e,t,i+1)}function G$(s){return 97<=s&&s<=122}function c4(s){return 65<=s&&s<=90}function Y$(s){return 48<=s&&s<=57}function lle(s){return s===32||s===9||s===10||s===13}const cle=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(s=>cle.add(s.charCodeAt(0)));function $R(s){return lle(s)||cle.has(s)}function _Z(s,e){return s===e||$R(s)&&$R(e)}const CF=new Map;function bZ(s){if(CF.has(s))return CF.get(s);let e;const t=SBe(s);return t&&(e=t),CF.set(s,e),e}function dle(s){return G$(s)||c4(s)||Y$(s)}function X$(s,e){return e.length===0?e=[s]:s.end===e[0].start?e[0].start=s.start:e.unshift(s),e}function hle(s,e){for(let t=e;t<s.length;t++){const i=s.charCodeAt(t);if(c4(i)||Y$(i)||t>0&&!dle(s.charCodeAt(t-1)))return t}return s.length}function h7(s,e,t,i){if(t===s.length)return[];if(i===e.length)return null;if(s[t]!==e[i].toLowerCase())return null;{let n=null,o=i+1;for(n=h7(s,e,t+1,i+1);!n&&(o=hle(e,o))<e.length;)n=h7(s,e,t+1,o),o++;return n===null?null:X$({start:i,end:i+1},n)}}function IBe(s){let e=0,t=0,i=0,n=0,o=0;for(let d=0;d<s.length;d++)o=s.charCodeAt(d),c4(o)&&e++,G$(o)&&t++,dle(o)&&i++,Y$(o)&&n++;const r=e/s.length,a=t/s.length,l=i/s.length,c=n/s.length;return{upperPercent:r,lowerPercent:a,alphaPercent:l,numericPercent:c}}function EBe(s){const{upperPercent:e,lowerPercent:t}=s;return t===0&&e>.6}function kBe(s){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=s;return t>.2&&e<.8&&i>.6&&n<.2}function DBe(s){let e=0,t=0,i=0,n=0;for(let o=0;o<s.length;o++)i=s.charCodeAt(o),c4(i)&&e++,G$(i)&&t++,lle(i)&&n++;return(e===0||t===0)&&n===0?s.length<=30:e<=5}function ule(s,e){if(!e||(e=e.trim(),e.length===0)||!DBe(s))return null;e.length>60&&(e=e.substring(0,60));const t=IBe(e);if(!kBe(t)){if(!EBe(t))return null;e=e.toLowerCase()}let i=null,n=0;for(s=s.toLowerCase();n<e.length&&(i=h7(s,e,0,n))===null;)n=hle(e,n+1);return i}function TBe(s,e,t=!1){if(!e||e.length===0)return null;let i=null,n=0;for(s=s.toLowerCase(),e=e.toLowerCase();n<e.length&&(i=u7(s,e,0,n,t),i===null);)n=fle(e,n+1);return i}function u7(s,e,t,i,n){let o=0;if(t===s.length)return[];if(i===e.length)return null;if(!_Z(s.charCodeAt(t),e.charCodeAt(i))){const l=bZ(s.charCodeAt(t));if(!l)return null;for(let c=0;c<l.length;c++)if(!_Z(l[c],e.charCodeAt(i+c)))return null;o+=l.length-1}let r=null,a=i+o+1;if(r=u7(s,e,t+1,a,n),!n)for(;!r&&(a=fle(e,a))<e.length;)r=u7(s,e,t+1,a,n),a++;if(!r)return null;if(s.charCodeAt(t)!==e.charCodeAt(i)){const l=bZ(s.charCodeAt(t));if(!l)return r;for(let c=0;c<l.length;c++)if(l[c]!==e.charCodeAt(i+c))return r}return X$({start:i,end:i+o+1},r)}function fle(s,e){for(let t=e;t<s.length;t++)if($R(s.charCodeAt(t))||t>0&&$R(s.charCodeAt(t-1)))return t;return s.length}const NBe=K$(eI,ule,rle),RBe=K$(eI,ule,ale),vZ=new Cc(1e4);function CZ(s,e,t=!1){if(typeof s!="string"||typeof e!="string")return null;let i=vZ.get(s);i||(i=new RegExp(uDe(s),"i"),vZ.set(s,i));const n=i.exec(e);return n?[{start:n.index,end:n.index+n[0].length}]:t?RBe(s,e):NBe(s,e)}function MBe(s,e){const t=Ub(s,s.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?Sk(t):null}function ABe(s,e,t,i,n,o){const r=Math.min(13,s.length);for(;t<r;t++){const a=Ub(s,e,t,i,n,o,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,o]}function Sk(s){if(typeof s>"u")return[];const e=[],t=s[1];for(let i=s.length-1;i>1;i--){const n=s[i]+t,o=e[e.length-1];o&&o.end===n?o.end=n+1:e.push({start:n,end:n+1})}return e}const Eg=128;function Z$(){const s=[],e=[];for(let t=0;t<=Eg;t++)e[t]=0;for(let t=0;t<=Eg;t++)s.push(e.slice(0));return s}function gle(s){const e=[];for(let t=0;t<=s;t++)e[t]=0;return e}const mle=gle(2*Eg),f7=gle(2*Eg),Gh=Z$(),Um=Z$(),kD=Z$();function DD(s,e){if(e<0||e>=s.length)return!1;const t=s.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!xU(t)}}function wZ(s,e){if(e<0||e>=s.length)return!1;switch(s.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function QT(s,e,t){return e[s]!==t[s]}function PBe(s,e,t,i,n,o,r=!1){for(;e<t&&n<o;)s[e]===i[n]&&(r&&(mle[e]=n),e+=1),n+=1;return e===t}var fc;(function(s){s.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}s.isDefault=e})(fc||(fc={}));const bK=class bK{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};bK.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};let tI=bK;function Ub(s,e,t,i,n,o,r=tI.default){const a=s.length>Eg?Eg:s.length,l=i.length>Eg?Eg:i.length;if(t>=a||o>=l||a-t>l-o||!PBe(e,t,a,n,o,l,!0))return;OBe(a,l,t,o,e,n);let c=1,d=1,h=t,u=o;const f=[!1];for(c=1,h=t;h<a;c++,h++){const b=mle[h],w=f7[h],C=h+1<a?f7[h+1]:l;for(d=b-o+1,u=b;u<C;d++,u++){let y=Number.MIN_SAFE_INTEGER,x=!1;u<=w&&(y=FBe(s,e,h,t,i,n,u,l,o,Gh[c-1][d-1]===0,f));let S=0;y!==Number.MIN_SAFE_INTEGER&&(x=!0,S=y+Um[c-1][d-1]);const L=u>b,E=L?Um[c][d-1]+(Gh[c][d-1]>0?-5:0):0,M=u>b+1&&Gh[c][d-1]>0,R=M?Um[c][d-2]+(Gh[c][d-2]>0?-5:0):0;if(M&&(!L||R>=E)&&(!x||R>=S))Um[c][d]=R,kD[c][d]=3,Gh[c][d]=0;else if(L&&(!x||E>=S))Um[c][d]=E,kD[c][d]=2,Gh[c][d]=0;else if(x)Um[c][d]=S,kD[c][d]=1,Gh[c][d]=Gh[c-1][d-1]+1;else throw new Error("not possible")}}if(!f[0]&&!r.firstMatchCanBeWeak)return;c--,d--;const g=[Um[c][d],o];let m=0,p=0;for(;c>=1;){let b=d;do{const w=kD[c][b];if(w===3)b=b-2;else if(w===2)b=b-1;else break}while(b>=1);m>1&&e[t+c-1]===n[o+d-1]&&!QT(b+o-1,i,n)&&m+1>Gh[c][b]&&(b=d),b===d?m++:m=1,p||(p=b),c--,d=b-1,g.push(d)}l-o===a&&r.boostFullMatch&&(g[0]+=2);const v=p-a;return g[0]-=v,g}function OBe(s,e,t,i,n,o){let r=s-1,a=e-1;for(;r>=t&&a>=i;)n[r]===o[a]&&(f7[r]=a,r--),a--}function FBe(s,e,t,i,n,o,r,a,l,c,d){if(e[t]!==o[r])return Number.MIN_SAFE_INTEGER;let h=1,u=!1;return r===t-i?h=s[t]===n[r]?7:5:QT(r,n,o)&&(r===0||!QT(r-1,n,o))?(h=s[t]===n[r]?7:5,u=!0):DD(o,r)&&(r===0||!DD(o,r-1))?h=5:(DD(o,r-1)||wZ(o,r-1))&&(h=5,u=!0),h>1&&t===i&&(d[0]=!0),u||(u=QT(r,n,o)||DD(o,r-1)||wZ(o,r-1)),t===i?r>l&&(h-=u?3:5):c?h+=u?2:0:h+=u?0:1,r+1===a&&(h-=u?3:5),h}function BBe(s,e,t,i,n,o,r){return WBe(s,e,t,i,n,o,!0,r)}function WBe(s,e,t,i,n,o,r,a){let l=Ub(s,e,t,i,n,o,a);if(s.length>=3){const c=Math.min(7,s.length-1);for(let d=t+1;d<c;d++){const h=HBe(s,d);if(h){const u=Ub(h,h.toLowerCase(),t,i,n,o,a);u&&(u[0]-=3,(!l||u[0]>l[0])&&(l=u))}}}return l}function HBe(s,e){if(e+1>=s.length)return;const t=s[e],i=s[e+1];if(t!==i)return s.slice(0,e)+i+t+s.slice(e+2)}const VBe="$(",Q$=new RegExp(`\\$\\(${it.iconNameExpression}(?:${it.iconModifierExpression})?\\)`,"g"),zBe=new RegExp(`(\\\\)?${Q$.source}`,"g");function UBe(s){return s.replace(zBe,(e,t)=>t?e:`\\${e}`)}const $Be=new RegExp(`\\\\${Q$.source}`,"g");function qBe(s){return s.replace($Be,e=>`\\${e}`)}const jBe=new RegExp(`(\\s)?(\\\\)?${Q$.source}(\\s)?`,"g");function J$(s){return s.indexOf(VBe)===-1?s:s.replace(jBe,(e,t,i,n)=>i?e:t||n||"")}function ple(s){return s?s.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const wF=new RegExp(`\\$\\(${it.iconNameCharacter}+\\)`,"g");function Xp(s){wF.lastIndex=0;let e="";const t=[];let i=0;for(;;){const n=wF.lastIndex,o=wF.exec(s),r=s.substring(n,o==null?void 0:o.index);if(r.length>0){e+=r;for(let a=0;a<r.length;a++)t.push(i)}if(!o)break;i+=o[0].length}return{text:e,iconOffsets:t}}function rx(s,e,t=!1){const{text:i,iconOffsets:n}=e;if(!n||n.length===0)return CZ(s,i,t);const o=lk(i," "),r=i.length-o.length,a=CZ(s,o,t);if(a)for(const l of a){const c=n[l.start+r]+r;l.start+=c,l.end+=c}return a}class To{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw kl("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1,this.supportAlertSyntax=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1,this.supportAlertSyntax=t.supportAlertSyntax??!1)}appendText(e,t=0){return this.value+=GBe(this.supportThemeIcons?UBe(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${YBe(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(ua(t),"g");return e.replace(i,(n,o)=>e.charAt(o-1)!=="\\"?`\\${n}`:n)}}function Mw(s){return ef(s)?!s.value:Array.isArray(s)?s.every(Mw):!0}function ef(s){return s instanceof To?!0:s&&typeof s=="object"?typeof s.value=="string"&&(typeof s.isTrusted=="boolean"||typeof s.isTrusted=="object"||s.isTrusted===void 0)&&(typeof s.supportThemeIcons=="boolean"||s.supportThemeIcons===void 0)&&(typeof s.supportAlertSyntax=="boolean"||s.supportAlertSyntax===void 0):!1}function KBe(s,e){return s===e?!0:!s||!e?!1:s.value===e.value&&s.isTrusted===e.isTrusted&&s.supportThemeIcons===e.supportThemeIcons&&s.supportHtml===e.supportHtml&&s.supportAlertSyntax===e.supportAlertSyntax&&(s.baseUri===e.baseUri||!!s.baseUri&&!!e.baseUri&&gm(Ze.from(s.baseUri),Ze.from(e.baseUri)))}function GBe(s){return s.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function YBe(s,e){var n;const t=((n=s.match(/^`+/gm))==null?void 0:n.reduce((o,r)=>o.length>r.length?o:r).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,s,`${"`".repeat(i)}`].join(`
`)}function TD(s){return s.replace(/"/g,"&quot;")}function yF(s){return s&&s.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function XBe(s){const e=[],t=s.split("|").map(n=>n.trim());s=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),o=/width=(\d+)/.exec(i),r=n?n[1]:"",a=o?o[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(r));l&&e.push(`width="${a}"`),c&&e.push(`height="${r}"`)}return{href:s,dimensions:e}}function _le(s,...e){return Ze.from({scheme:ct.command,path:s,query:e.length?encodeURIComponent(JSON.stringify(e)):void 0})}class eq{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const g7=new eq("id#");function tq(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Sv=tq();function ble(s){Sv=s}const vle=/[&<>"']/,ZBe=new RegExp(vle.source,"g"),Cle=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,QBe=new RegExp(Cle.source,"g"),JBe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yZ=s=>JBe[s];function pl(s,e){if(e){if(vle.test(s))return s.replace(ZBe,yZ)}else if(Cle.test(s))return s.replace(QBe,yZ);return s}const e7e=/(^|[^\[])\^/g;function is(s,e){let t=typeof s=="string"?s:s.source;e=e||"";const i={replace:(n,o)=>{let r=typeof o=="string"?o:o.source;return r=r.replace(e7e,"$1"),t=t.replace(n,r),i},getRegex:()=>new RegExp(t,e)};return i}function SZ(s){try{s=encodeURI(s).replace(/%25/g,"%")}catch{return null}return s}const ax={exec:()=>null};function xZ(s,e){const t=s.replace(/\|/g,(o,r,a)=>{let l=!1,c=r;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=t.split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function z0(s,e,t){const i=s.length;if(i===0)return"";let n=0;for(;n<i&&s.charAt(i-n-1)===e;)n++;return s.slice(0,i-n)}function t7e(s,e){if(s.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<s.length;i++)if(s[i]==="\\")i++;else if(s[i]===e[0])t++;else if(s[i]===e[1]&&(t--,t<0))return i;return-1}function LZ(s,e,t,i){const n=e.href,o=e.title?pl(e.title):null,r=s[1].replace(/\\([\[\]])/g,"$1");if(s[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:n,title:o,text:r,tokens:i.inlineTokens(r)};return i.state.inLink=!1,a}return{type:"image",raw:t,href:n,title:o,text:pl(r)}}function i7e(s,e){const t=s.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(n=>{const o=n.match(/^\s+/);if(o===null)return n;const[r]=o;return r.length>=i.length?n.slice(i.length):n}).join(`
`)}class qR{constructor(e){pt(this,"options");pt(this,"rules");pt(this,"lexer");this.options=e||Sv}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:z0(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],n=i7e(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const n=z0(i,"#");(this.options.pedantic||!n||/ $/.test(n))&&(i=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:z0(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=z0(t[0],`
`).split(`
`),n="",o="";const r=[];for(;i.length>0;){let a=!1;const l=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))l.push(i[c]),a=!0;else if(!a)l.push(i[c]);else break;i=i.slice(c);const d=l.join(`
`),h=d.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");n=n?`${n}
${d}`:d,o=o?`${o}
${h}`:h;const u=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,r,!0),this.lexer.state.top=u,i.length===0)break;const f=r[r.length-1];if((f==null?void 0:f.type)==="code")break;if((f==null?void 0:f.type)==="blockquote"){const g=f,m=g.raw+`
`+i.join(`
`),p=this.blockquote(m);r[r.length-1]=p,n=n.substring(0,n.length-g.raw.length)+p.raw,o=o.substring(0,o.length-g.text.length)+p.text;break}else if((f==null?void 0:f.type)==="list"){const g=f,m=g.raw+`
`+i.join(`
`),p=this.list(m);r[r.length-1]=p,n=n.substring(0,n.length-f.raw.length)+p.raw,o=o.substring(0,o.length-g.raw.length)+p.raw,i=m.substring(r[r.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:r,text:o}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const n=i.length>1,o={type:"list",raw:"",ordered:n,start:n?+i.slice(0,-1):"",loose:!1,items:[]};i=n?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=n?i:"[*+-]");const r=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a=!1;for(;e;){let l=!1,c="",d="";if(!(t=r.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let h=t[2].split(`
`,1)[0].replace(/^\t+/,v=>" ".repeat(3*v.length)),u=e.split(`
`,1)[0],f=!h.trim(),g=0;if(this.options.pedantic?(g=2,d=h.trimStart()):f?g=t[1].length+1:(g=t[2].search(/[^ ]/),g=g>4?1:g,d=h.slice(g),g+=t[1].length),f&&/^ *$/.test(u)&&(c+=u+`
`,e=e.substring(u.length+1),l=!0),!l){const v=new RegExp(`^ {0,${Math.min(3,g-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),b=new RegExp(`^ {0,${Math.min(3,g-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),w=new RegExp(`^ {0,${Math.min(3,g-1)}}(?:\`\`\`|~~~)`),C=new RegExp(`^ {0,${Math.min(3,g-1)}}#`);for(;e;){const y=e.split(`
`,1)[0];if(u=y,this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),w.test(u)||C.test(u)||v.test(u)||b.test(e))break;if(u.search(/[^ ]/)>=g||!u.trim())d+=`
`+u.slice(g);else{if(f||h.search(/[^ ]/)>=4||w.test(h)||C.test(h)||b.test(h))break;d+=`
`+u}!f&&!u.trim()&&(f=!0),c+=y+`
`,e=e.substring(y.length+1),h=u.slice(g)}}o.loose||(a?o.loose=!0:/\n *\n *$/.test(c)&&(a=!0));let m=null,p;this.options.gfm&&(m=/^\[[ xX]\] /.exec(d),m&&(p=m[0]!=="[ ] ",d=d.replace(/^\[[ xX]\] +/,""))),o.items.push({type:"list_item",raw:c,task:!!m,checked:p,loose:!1,text:d,tokens:[]}),o.raw+=c}o.items[o.items.length-1].raw=o.items[o.items.length-1].raw.trimEnd(),o.items[o.items.length-1].text=o.items[o.items.length-1].text.trimEnd(),o.raw=o.raw.trimEnd();for(let l=0;l<o.items.length;l++)if(this.lexer.state.top=!1,o.items[l].tokens=this.lexer.blockTokens(o.items[l].text,[]),!o.loose){const c=o.items[l].tokens.filter(h=>h.type==="space"),d=c.length>0&&c.some(h=>/\n.*\n/.test(h.raw));o.loose=d}if(o.loose)for(let l=0;l<o.items.length;l++)o.items[l].loose=!0;return o}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),n=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:n,title:o}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=xZ(t[1]),n=t[2].replace(/^\||\| *$/g,"").split("|"),o=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===n.length){for(const a of n)/^ *-+: *$/.test(a)?r.align.push("right"):/^ *:-+: *$/.test(a)?r.align.push("center"):/^ *:-+ *$/.test(a)?r.align.push("left"):r.align.push(null);for(let a=0;a<i.length;a++)r.header.push({text:i[a],tokens:this.lexer.inline(i[a]),header:!0,align:r.align[a]});for(const a of o)r.rows.push(xZ(a,r.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:r.align[c]})));return r}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:pl(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const r=z0(i.slice(0,-1),"\\");if((i.length-r.length)%2===0)return}else{const r=t7e(t[2],"()");if(r>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let n=t[2],o="";if(this.options.pedantic){const r=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);r&&(n=r[1],o=r[3])}else o=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(i)?n=n.slice(1):n=n.slice(1,-1)),LZ(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const n=(i[2]||i[1]).replace(/\s+/g," "),o=t[n.toLowerCase()];if(!o){const r=i[0].charAt(0);return{type:"text",raw:r,text:r}}return LZ(i,o,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n||n[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(n[1]||n[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const r=[...n[0]].length-1;let a,l,c=r,d=0;const h=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+r);(n=h.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(l=[...a].length,n[3]||n[4]){c+=l;continue}else if((n[5]||n[6])&&r%3&&!((r+l)%3)){d+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+d);const u=[...n[0]][0].length,f=e.slice(0,r+n.index+u+l);if(Math.min(r,l)%2){const m=f.slice(1,-1);return{type:"em",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}const g=f.slice(2,-2);return{type:"strong",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const n=/[^ ]/.test(i),o=/^ /.test(i)&&/ $/.test(i);return n&&o&&(i=i.substring(1,i.length-1)),i=pl(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,n;return t[2]==="@"?(i=pl(t[1]),n="mailto:"+i):(i=pl(t[1]),n=i),{type:"link",raw:t[0],text:i,href:n,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let n,o;if(t[2]==="@")n=pl(t[0]),o="mailto:"+n;else{let r;do r=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(r!==t[0]);n=pl(t[0]),t[1]==="www."?o="http://"+t[0]:o=t[0]}return{type:"link",raw:t[0],text:n,href:o,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=pl(t[0]),{type:"text",raw:t[0],text:i}}}}const n7e=/^(?: *(?:\n|$))+/,s7e=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,o7e=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,xk=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,r7e=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,wle=/(?:[*+-]|\d{1,9}[.)])/,yle=is(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,wle).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),iq=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,a7e=/^[^\n]+/,nq=/(?!\s*\])(?:\\.|[^\[\]\\])+/,l7e=is(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",nq).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),c7e=is(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,wle).getRegex(),d4="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",sq=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,d7e=is("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",sq).replace("tag",d4).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Sle=is(iq).replace("hr",xk).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",d4).getRegex(),h7e=is(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Sle).getRegex(),oq={blockquote:h7e,code:s7e,def:l7e,fences:o7e,heading:r7e,hr:xk,html:d7e,lheading:yle,list:c7e,newline:n7e,paragraph:Sle,table:ax,text:a7e},IZ=is("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",xk).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",d4).getRegex(),u7e={...oq,table:IZ,paragraph:is(iq).replace("hr",xk).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",IZ).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",d4).getRegex()},f7e={...oq,html:is(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",sq).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ax,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:is(iq).replace("hr",xk).replace("heading",` *#{1,6} *[^
]`).replace("lheading",yle).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},xle=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,g7e=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Lle=/^( {2,}|\\)\n(?!\s*$)/,m7e=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Lk="\\p{P}\\p{S}",p7e=is(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Lk).getRegex(),_7e=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,b7e=is(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Lk).getRegex(),v7e=is("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Lk).getRegex(),C7e=is("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Lk).getRegex(),w7e=is(/\\([punct])/,"gu").replace(/punct/g,Lk).getRegex(),y7e=is(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),S7e=is(sq).replace("(?:-->|$)","-->").getRegex(),x7e=is("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",S7e).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),jR=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,L7e=is(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",jR).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ile=is(/^!?\[(label)\]\[(ref)\]/).replace("label",jR).replace("ref",nq).getRegex(),Ele=is(/^!?\[(ref)\](?:\[\])?/).replace("ref",nq).getRegex(),I7e=is("reflink|nolink(?!\\()","g").replace("reflink",Ile).replace("nolink",Ele).getRegex(),rq={_backpedal:ax,anyPunctuation:w7e,autolink:y7e,blockSkip:_7e,br:Lle,code:g7e,del:ax,emStrongLDelim:b7e,emStrongRDelimAst:v7e,emStrongRDelimUnd:C7e,escape:xle,link:L7e,nolink:Ele,punctuation:p7e,reflink:Ile,reflinkSearch:I7e,tag:x7e,text:m7e,url:ax},E7e={...rq,link:is(/^!?\[(label)\]\((.*?)\)/).replace("label",jR).getRegex(),reflink:is(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",jR).getRegex()},m7={...rq,escape:is(xle).replace("])","~|])").getRegex(),url:is(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},k7e={...m7,br:is(Lle).replace("{2,}","*").getRegex(),text:is(m7.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ND={normal:oq,gfm:u7e,pedantic:f7e},U0={normal:rq,gfm:m7,breaks:k7e,pedantic:E7e};class hh{constructor(e){pt(this,"tokens");pt(this,"options");pt(this,"state");pt(this,"tokenizer");pt(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Sv,this.options.tokenizer=this.options.tokenizer||new qR,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:ND.normal,inline:U0.normal};this.options.pedantic?(t.block=ND.pedantic,t.inline=U0.pedantic):this.options.gfm&&(t.block=ND.gfm,this.options.breaks?t.inline=U0.breaks:t.inline=U0.gfm),this.tokenizer.rules=t}static get rules(){return{block:ND,inline:U0}}static lex(e,t){return new hh(t).lex(e)}static lexInline(e,t){return new hh(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let n,o,r;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),o=t[t.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),o=t[t.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+n.raw,o.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(r=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(d=>{c=d.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(r=e.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(r))){o=t[t.length-1],i&&(o==null?void 0:o.type)==="paragraph"?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):t.push(n),i=r.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),o=t[t.length-1],o&&o.type==="text"?(o.raw+=`
`+n.raw,o.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):t.push(n);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,n,o,r=e,a,l,c;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)d.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,a.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(d=>(i=d.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),n=t[t.length-1],n&&i.type==="text"&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,r,c)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(o=e,this.options.extensions&&this.options.extensions.startInline){let d=1/0;const h=e.slice(1);let u;this.options.extensions.startInline.forEach(f=>{u=f.call({lexer:this},h),typeof u=="number"&&u>=0&&(d=Math.min(d,u))}),d<1/0&&d>=0&&(o=e.substring(0,d+1))}if(i=this.tokenizer.inlineText(o)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,n=t[t.length-1],n&&n.type==="text"?(n.raw+=i.raw,n.text+=i.text):t.push(i);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}}class iI{constructor(e){pt(this,"options");pt(this,"parser");this.options=e||Sv}space(e){return""}code({text:e,lang:t,escaped:i}){var r;const n=(r=(t||"").match(/^\S*/))==null?void 0:r[0],o=e.replace(/\n$/,"")+`
`;return n?'<pre><code class="language-'+pl(n)+'">'+(i?o:pl(o,!0))+`</code></pre>
`:"<pre><code>"+(i?o:pl(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let n="";for(let a=0;a<e.items.length;a++){const l=e.items[a];n+=this.listitem(l)}const o=t?"ol":"ul",r=t&&i!==1?' start="'+i+'"':"";return"<"+o+r+`>
`+n+"</"+o+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let o=0;o<e.header.length;o++)i+=this.tablecell(e.header[o]);t+=this.tablerow({text:i});let n="";for(let o=0;o<e.rows.length;o++){const r=e.rows[o];i="";for(let a=0;a<r.length;a++)i+=this.tablecell(r[a]);n+=this.tablerow({text:i})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const n=this.parser.parseInline(i),o=SZ(e);if(o===null)return n;e=o;let r='<a href="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>",r}image({href:e,title:t,text:i}){const n=SZ(e);if(n===null)return i;e=n;let o=`<img src="${e}" alt="${i}"`;return t&&(o+=` title="${t}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class aq{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class uh{constructor(e){pt(this,"options");pt(this,"renderer");pt(this,"textRenderer");this.options=e||Sv,this.options.renderer=this.options.renderer||new iI,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new aq}static parse(e,t){return new uh(t).parse(e)}static parseInline(e,t){return new uh(t).parseInline(e)}parse(e,t=!0){let i="";for(let n=0;n<e.length;n++){const o=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const a=o,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){i+=l||"";continue}}const r=o;switch(r.type){case"space":{i+=this.renderer.space(r);continue}case"hr":{i+=this.renderer.hr(r);continue}case"heading":{i+=this.renderer.heading(r);continue}case"code":{i+=this.renderer.code(r);continue}case"table":{i+=this.renderer.table(r);continue}case"blockquote":{i+=this.renderer.blockquote(r);continue}case"list":{i+=this.renderer.list(r);continue}case"html":{i+=this.renderer.html(r);continue}case"paragraph":{i+=this.renderer.paragraph(r);continue}case"text":{let a=r,l=this.renderer.text(a);for(;n+1<e.length&&e[n+1].type==="text";)a=e[++n],l+=`
`+this.renderer.text(a);t?i+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):i+=l;continue}default:{const a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let n=0;n<e.length;n++){const o=e[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){i+=a||"";continue}}const r=o;switch(r.type){case"escape":{i+=t.text(r);break}case"html":{i+=t.html(r);break}case"link":{i+=t.link(r);break}case"image":{i+=t.image(r);break}case"strong":{i+=t.strong(r);break}case"em":{i+=t.em(r);break}case"codespan":{i+=t.codespan(r);break}case"br":{i+=t.br(r);break}case"del":{i+=t.del(r);break}case"text":{i+=t.text(r);break}default:{const a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}}class lx{constructor(e){pt(this,"options");this.options=e||Sv}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}pt(lx,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class kle{constructor(...e){pt(this,"defaults",tq());pt(this,"options",this.setOptions);pt(this,"parse",this.parseMarkdown(hh.lex,uh.parse));pt(this,"parseInline",this.parseMarkdown(hh.lexInline,uh.parseInline));pt(this,"Parser",uh);pt(this,"Renderer",iI);pt(this,"TextRenderer",aq);pt(this,"Lexer",hh);pt(this,"Tokenizer",qR);pt(this,"Hooks",lx);this.use(...e)}walkTokens(e,t){var n,o;let i=[];for(const r of e)switch(i=i.concat(t.call(this,r)),r.type){case"table":{const a=r;for(const l of a.header)i=i.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const c of l)i=i.concat(this.walkTokens(c.tokens,t));break}case"list":{const a=r;i=i.concat(this.walkTokens(a.items,t));break}default:{const a=r;(o=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&o[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);i=i.concat(this.walkTokens(c,t))}):a.tokens&&(i=i.concat(this.walkTokens(a.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const n={...i};if(n.async=this.defaults.async||n.async||!1,i.extensions&&(i.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const r=t.renderers[o.name];r?t.renderers[o.name]=function(...a){let l=o.renderer.apply(this,a);return l===!1&&(l=r.apply(this,a)),l}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=t[o.level];r?r.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),n.extensions=t),i.renderer){const o=this.defaults.renderer||new iI(this.defaults);for(const r in i.renderer){if(!(r in o))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const a=r,l=i.renderer[a],c=o[a];o[a]=(...d)=>{let h=l.apply(o,d);return h===!1&&(h=c.apply(o,d)),h||""}}n.renderer=o}if(i.tokenizer){const o=this.defaults.tokenizer||new qR(this.defaults);for(const r in i.tokenizer){if(!(r in o))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const a=r,l=i.tokenizer[a],c=o[a];o[a]=(...d)=>{let h=l.apply(o,d);return h===!1&&(h=c.apply(o,d)),h}}n.tokenizer=o}if(i.hooks){const o=this.defaults.hooks||new lx;for(const r in i.hooks){if(!(r in o))throw new Error(`hook '${r}' does not exist`);if(r==="options")continue;const a=r,l=i.hooks[a],c=o[a];lx.passThroughHooks.has(r)?o[a]=d=>{if(this.defaults.async)return Promise.resolve(l.call(o,d)).then(u=>c.call(o,u));const h=l.call(o,d);return c.call(o,h)}:o[a]=(...d)=>{let h=l.apply(o,d);return h===!1&&(h=c.apply(o,d)),h}}n.hooks=o}if(i.walkTokens){const o=this.defaults.walkTokens,r=i.walkTokens;n.walkTokens=function(a){let l=[];return l.push(r.call(this,a)),o&&(l=l.concat(o.call(this,a))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return hh.lex(e,t??this.defaults)}parser(e,t){return uh.parse(e,t??this.defaults)}parseMarkdown(e,t){return(n,o)=>{const r={...o},a={...this.defaults,...r},l=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&r.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>t(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(l);try{a.hooks&&(n=a.hooks.preprocess(n));let c=e(n,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let d=t(c,a);return a.hooks&&(d=a.hooks.postprocess(d)),d}catch(c){return l(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const n="<p>An error occurred:</p><pre>"+pl(i.message+"",!0)+"</pre>";return t?Promise.resolve(n):n}if(t)return Promise.reject(i);throw i}}}const $b=new kle;function $n(s,e){return $b.parse(s,e)}$n.options=$n.setOptions=function(s){return $b.setOptions(s),$n.defaults=$b.defaults,ble($n.defaults),$n};$n.getDefaults=tq;$n.defaults=Sv;$n.use=function(...s){return $b.use(...s),$n.defaults=$b.defaults,ble($n.defaults),$n};$n.walkTokens=function(s,e){return $b.walkTokens(s,e)};$n.parseInline=$b.parseInline;$n.Parser=uh;$n.parser=uh.parse;$n.Renderer=iI;$n.TextRenderer=aq;$n.Lexer=hh;$n.lexer=hh.lex;$n.Tokenizer=qR;$n.Hooks=lx;$n.parse=$n;$n.options;$n.setOptions;$n.use;$n.walkTokens;$n.parseInline;const D7e=$n;uh.parse;const nI=hh.lex;function T7e(s){return JSON.stringify(s,N7e)}function p7(s){let e=JSON.parse(s);return e=_7(e),e}function N7e(s,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function _7(s,e=0){if(!s||e>200)return s;if(typeof s=="object"){switch(s.$mid){case 1:return Ze.revive(s);case 2:return new RegExp(s.source,s.flags);case 17:return new Date(s.source)}if(s instanceof Og||s instanceof Uint8Array)return s;if(Array.isArray(s))for(let t=0;t<s.length;++t)s[t]=_7(s[t],e+1);else for(const t in s)Object.hasOwnProperty.call(s,t)&&(s[t]=_7(s[t],e+1))}return s}/*! @license DOMPurify 3.2.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.7/LICENSE */const{entries:Dle,setPrototypeOf:EZ,isFrozen:R7e,getPrototypeOf:M7e,getOwnPropertyDescriptor:A7e}=Object;let{freeze:ga,seal:pc,create:Tle}=Object,{apply:b7,construct:v7}=typeof Reflect<"u"&&Reflect;ga||(ga=function(e){return e});pc||(pc=function(e){return e});b7||(b7=function(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];return e.apply(t,n)});v7||(v7=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return new e(...i)});const RD=ma(Array.prototype.forEach),P7e=ma(Array.prototype.lastIndexOf),kZ=ma(Array.prototype.pop),$0=ma(Array.prototype.push),O7e=ma(Array.prototype.splice),JT=ma(String.prototype.toLowerCase),SF=ma(String.prototype.toString),xF=ma(String.prototype.match),q0=ma(String.prototype.replace),F7e=ma(String.prototype.indexOf),B7e=ma(String.prototype.trim),Tc=ma(Object.prototype.hasOwnProperty),Gr=ma(RegExp.prototype.test),j0=W7e(TypeError);function ma(s){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return b7(s,e,i)}}function W7e(s){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return v7(s,t)}}function qi(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:JT;EZ&&EZ(s,null);let i=e.length;for(;i--;){let n=e[i];if(typeof n=="string"){const o=t(n);o!==n&&(R7e(e)||(e[i]=o),n=o)}s[n]=!0}return s}function H7e(s){for(let e=0;e<s.length;e++)Tc(s,e)||(s[e]=null);return s}function nu(s){const e=Tle(null);for(const[t,i]of Dle(s))Tc(s,t)&&(Array.isArray(i)?e[t]=H7e(i):i&&typeof i=="object"&&i.constructor===Object?e[t]=nu(i):e[t]=i);return e}function K0(s,e){for(;s!==null;){const i=A7e(s,e);if(i){if(i.get)return ma(i.get);if(typeof i.value=="function")return ma(i.value)}s=M7e(s)}function t(){return null}return t}const DZ=ga(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),LF=ga(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","slot","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),IF=ga(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),V7e=ga(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),EF=ga(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),z7e=ga(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),TZ=ga(["#text"]),NZ=ga(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),kF=ga(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),RZ=ga(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),MD=ga(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),U7e=pc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$7e=pc(/<%[\w\W]*|[\w\W]*%>/gm),q7e=pc(/\$\{[\w\W]*/gm),j7e=pc(/^data-[\-\w.\u00B7-\uFFFF]+$/),K7e=pc(/^aria-[\-\w]+$/),Nle=pc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G7e=pc(/^(?:\w+script|data):/i),Y7e=pc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Rle=pc(/^html$/i),X7e=pc(/^[a-z][.\w]*(-[.\w]+)+$/i);var MZ=Object.freeze({__proto__:null,ARIA_ATTR:K7e,ATTR_WHITESPACE:Y7e,CUSTOM_ELEMENT:X7e,DATA_ATTR:j7e,DOCTYPE_NAME:Rle,ERB_EXPR:$7e,IS_ALLOWED_URI:Nle,IS_SCRIPT_OR_DATA:G7e,MUSTACHE_EXPR:U7e,TMPLIT_EXPR:q7e});const G0={element:1,text:3,progressingInstruction:7,comment:8,document:9},Z7e=function(){return typeof window>"u"?null:window},Q7e=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(r){return r},createScriptURL(r){return r}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},AZ=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Mle(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Z7e();const e=Kt=>Mle(Kt);if(e.version="3.2.7",e.removed=[],!s||!s.document||s.document.nodeType!==G0.document||!s.Element)return e.isSupported=!1,e;let{document:t}=s;const i=t,n=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:r,Node:a,Element:l,NodeFilter:c,NamedNodeMap:d=s.NamedNodeMap||s.MozNamedAttrMap,HTMLFormElement:h,DOMParser:u,trustedTypes:f}=s,g=l.prototype,m=K0(g,"cloneNode"),p=K0(g,"remove"),v=K0(g,"nextSibling"),b=K0(g,"childNodes"),w=K0(g,"parentNode");if(typeof r=="function"){const Kt=t.createElement("template");Kt.content&&Kt.content.ownerDocument&&(t=Kt.content.ownerDocument)}let C,y="";const{implementation:x,createNodeIterator:S,createDocumentFragment:L,getElementsByTagName:E}=t,{importNode:M}=i;let R=AZ();e.isSupported=typeof Dle=="function"&&typeof w=="function"&&x&&x.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:T,ERB_EXPR:A,TMPLIT_EXPR:N,DATA_ATTR:P,ARIA_ATTR:W,IS_SCRIPT_OR_DATA:H,ATTR_WHITESPACE:G,CUSTOM_ELEMENT:V}=MZ;let{IS_ALLOWED_URI:U}=MZ,$=null;const Y=qi({},[...DZ,...LF,...IF,...EF,...TZ]);let se=null;const j=qi({},[...NZ,...kF,...RZ,...MD]);let ie=Object.seal(Tle(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),te=null,pe=null,J=!0,le=!0,be=!1,Ce=!0,Je=!1,qe=!0,mt=!1,Ke=!1,nt=!1,ft=!1,Pe=!1,Be=!1,Me=!0,rt=!1;const Et="user-content-";let qt=!0,Ge=!1,at={},yt=null;const Jt=qi({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let li=null;const Vi=qi({},["audio","video","img","source","image","track"]);let jt=null;const Mi=qi({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ni="http://www.w3.org/1998/Math/MathML",yn="http://www.w3.org/2000/svg",pi="http://www.w3.org/1999/xhtml";let ci=pi,Ai=!1,Li=null;const Yi=qi({},[ni,yn,pi],SF);let oi=qi({},["mi","mo","mn","ms","mtext"]),$i=qi({},["annotation-xml"]);const Ri=qi({},["title","style","font","a","script"]);let gn=null;const fe=["application/xhtml+xml","text/html"],_i="text/html";let Ii=null,Xi=null;const Es=t.createElement("form"),Ys=function(he){return he instanceof RegExp||he instanceof Function},Bs=function(){let he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Xi&&Xi===he)){if((!he||typeof he!="object")&&(he={}),he=nu(he),gn=fe.indexOf(he.PARSER_MEDIA_TYPE)===-1?_i:he.PARSER_MEDIA_TYPE,Ii=gn==="application/xhtml+xml"?SF:JT,$=Tc(he,"ALLOWED_TAGS")?qi({},he.ALLOWED_TAGS,Ii):Y,se=Tc(he,"ALLOWED_ATTR")?qi({},he.ALLOWED_ATTR,Ii):j,Li=Tc(he,"ALLOWED_NAMESPACES")?qi({},he.ALLOWED_NAMESPACES,SF):Yi,jt=Tc(he,"ADD_URI_SAFE_ATTR")?qi(nu(Mi),he.ADD_URI_SAFE_ATTR,Ii):Mi,li=Tc(he,"ADD_DATA_URI_TAGS")?qi(nu(Vi),he.ADD_DATA_URI_TAGS,Ii):Vi,yt=Tc(he,"FORBID_CONTENTS")?qi({},he.FORBID_CONTENTS,Ii):Jt,te=Tc(he,"FORBID_TAGS")?qi({},he.FORBID_TAGS,Ii):nu({}),pe=Tc(he,"FORBID_ATTR")?qi({},he.FORBID_ATTR,Ii):nu({}),at=Tc(he,"USE_PROFILES")?he.USE_PROFILES:!1,J=he.ALLOW_ARIA_ATTR!==!1,le=he.ALLOW_DATA_ATTR!==!1,be=he.ALLOW_UNKNOWN_PROTOCOLS||!1,Ce=he.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Je=he.SAFE_FOR_TEMPLATES||!1,qe=he.SAFE_FOR_XML!==!1,mt=he.WHOLE_DOCUMENT||!1,ft=he.RETURN_DOM||!1,Pe=he.RETURN_DOM_FRAGMENT||!1,Be=he.RETURN_TRUSTED_TYPE||!1,nt=he.FORCE_BODY||!1,Me=he.SANITIZE_DOM!==!1,rt=he.SANITIZE_NAMED_PROPS||!1,qt=he.KEEP_CONTENT!==!1,Ge=he.IN_PLACE||!1,U=he.ALLOWED_URI_REGEXP||Nle,ci=he.NAMESPACE||pi,oi=he.MATHML_TEXT_INTEGRATION_POINTS||oi,$i=he.HTML_INTEGRATION_POINTS||$i,ie=he.CUSTOM_ELEMENT_HANDLING||{},he.CUSTOM_ELEMENT_HANDLING&&Ys(he.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ie.tagNameCheck=he.CUSTOM_ELEMENT_HANDLING.tagNameCheck),he.CUSTOM_ELEMENT_HANDLING&&Ys(he.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ie.attributeNameCheck=he.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),he.CUSTOM_ELEMENT_HANDLING&&typeof he.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ie.allowCustomizedBuiltInElements=he.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Je&&(le=!1),Pe&&(ft=!0),at&&($=qi({},TZ),se=[],at.html===!0&&(qi($,DZ),qi(se,NZ)),at.svg===!0&&(qi($,LF),qi(se,kF),qi(se,MD)),at.svgFilters===!0&&(qi($,IF),qi(se,kF),qi(se,MD)),at.mathMl===!0&&(qi($,EF),qi(se,RZ),qi(se,MD))),he.ADD_TAGS&&($===Y&&($=nu($)),qi($,he.ADD_TAGS,Ii)),he.ADD_ATTR&&(se===j&&(se=nu(se)),qi(se,he.ADD_ATTR,Ii)),he.ADD_URI_SAFE_ATTR&&qi(jt,he.ADD_URI_SAFE_ATTR,Ii),he.FORBID_CONTENTS&&(yt===Jt&&(yt=nu(yt)),qi(yt,he.FORBID_CONTENTS,Ii)),qt&&($["#text"]=!0),mt&&qi($,["html","head","body"]),$.table&&(qi($,["tbody"]),delete te.tbody),he.TRUSTED_TYPES_POLICY){if(typeof he.TRUSTED_TYPES_POLICY.createHTML!="function")throw j0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof he.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw j0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=he.TRUSTED_TYPES_POLICY,y=C.createHTML("")}else C===void 0&&(C=Q7e(f,n)),C!==null&&typeof y=="string"&&(y=C.createHTML(""));ga&&ga(he),Xi=he}},Ca=qi({},[...LF,...IF,...V7e]),Xs=qi({},[...EF,...z7e]),Lo=function(he){let st=w(he);(!st||!st.tagName)&&(st={namespaceURI:ci,tagName:"template"});const Wt=JT(he.tagName),bs=JT(st.tagName);return Li[he.namespaceURI]?he.namespaceURI===yn?st.namespaceURI===pi?Wt==="svg":st.namespaceURI===ni?Wt==="svg"&&(bs==="annotation-xml"||oi[bs]):!!Ca[Wt]:he.namespaceURI===ni?st.namespaceURI===pi?Wt==="math":st.namespaceURI===yn?Wt==="math"&&$i[bs]:!!Xs[Wt]:he.namespaceURI===pi?st.namespaceURI===yn&&!$i[bs]||st.namespaceURI===ni&&!oi[bs]?!1:!Xs[Wt]&&(Ri[Wt]||!Ca[Wt]):!!(gn==="application/xhtml+xml"&&Li[he.namespaceURI]):!1},Ws=function(he){$0(e.removed,{element:he});try{w(he).removeChild(he)}catch{p(he)}},Hs=function(he,st){try{$0(e.removed,{attribute:st.getAttributeNode(he),from:st})}catch{$0(e.removed,{attribute:null,from:st})}if(st.removeAttribute(he),he==="is")if(ft||Pe)try{Ws(st)}catch{}else try{st.setAttribute(he,"")}catch{}},xc=function(he){let st=null,Wt=null;if(nt)he="<remove></remove>"+he;else{const ro=xF(he,/^[\r\n\t ]+/);Wt=ro&&ro[0]}gn==="application/xhtml+xml"&&ci===pi&&(he='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+he+"</body></html>");const bs=C?C.createHTML(he):he;if(ci===pi)try{st=new u().parseFromString(bs,gn)}catch{}if(!st||!st.documentElement){st=x.createDocument(ci,"template",null);try{st.documentElement.innerHTML=Ai?y:bs}catch{}}const Ir=st.body||st.documentElement;return he&&Wt&&Ir.insertBefore(t.createTextNode(Wt),Ir.childNodes[0]||null),ci===pi?E.call(st,mt?"html":"body")[0]:mt?st.documentElement:Ir},wd=function(he){return S.call(he.ownerDocument||he,he,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},yd=function(he){return he instanceof h&&(typeof he.nodeName!="string"||typeof he.textContent!="string"||typeof he.removeChild!="function"||!(he.attributes instanceof d)||typeof he.removeAttribute!="function"||typeof he.setAttribute!="function"||typeof he.namespaceURI!="string"||typeof he.insertBefore!="function"||typeof he.hasChildNodes!="function")},Of=function(he){return typeof a=="function"&&he instanceof a};function wa(Kt,he,st){RD(Kt,Wt=>{Wt.call(e,he,st,Xi)})}const Av=function(he){let st=null;if(wa(R.beforeSanitizeElements,he,null),yd(he))return Ws(he),!0;const Wt=Ii(he.nodeName);if(wa(R.uponSanitizeElement,he,{tagName:Wt,allowedTags:$}),qe&&he.hasChildNodes()&&!Of(he.firstElementChild)&&Gr(/<[/\w!]/g,he.innerHTML)&&Gr(/<[/\w!]/g,he.textContent)||he.nodeType===G0.progressingInstruction||qe&&he.nodeType===G0.comment&&Gr(/<[/\w]/g,he.data))return Ws(he),!0;if(!$[Wt]||te[Wt]){if(!te[Wt]&&i5(Wt)&&(ie.tagNameCheck instanceof RegExp&&Gr(ie.tagNameCheck,Wt)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(Wt)))return!1;if(qt&&!yt[Wt]){const bs=w(he)||he.parentNode,Ir=b(he)||he.childNodes;if(Ir&&bs){const ro=Ir.length;for(let ya=ro-1;ya>=0;--ya){const zh=m(Ir[ya],!0);zh.__removalCount=(he.__removalCount||0)+1,bs.insertBefore(zh,v(he))}}}return Ws(he),!0}return he instanceof l&&!Lo(he)||(Wt==="noscript"||Wt==="noembed"||Wt==="noframes")&&Gr(/<\/no(script|embed|frames)/i,he.innerHTML)?(Ws(he),!0):(Je&&he.nodeType===G0.text&&(st=he.textContent,RD([T,A,N],bs=>{st=q0(st,bs," ")}),he.textContent!==st&&($0(e.removed,{element:he.cloneNode()}),he.textContent=st)),wa(R.afterSanitizeElements,he,null),!1)},jk=function(he,st,Wt){if(Me&&(st==="id"||st==="name")&&(Wt in t||Wt in Es))return!1;if(!(le&&!pe[st]&&Gr(P,st))){if(!(J&&Gr(W,st))){if(!se[st]||pe[st]){if(!(i5(he)&&(ie.tagNameCheck instanceof RegExp&&Gr(ie.tagNameCheck,he)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(he))&&(ie.attributeNameCheck instanceof RegExp&&Gr(ie.attributeNameCheck,st)||ie.attributeNameCheck instanceof Function&&ie.attributeNameCheck(st,he))||st==="is"&&ie.allowCustomizedBuiltInElements&&(ie.tagNameCheck instanceof RegExp&&Gr(ie.tagNameCheck,Wt)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(Wt))))return!1}else if(!jt[st]){if(!Gr(U,q0(Wt,G,""))){if(!((st==="src"||st==="xlink:href"||st==="href")&&he!=="script"&&F7e(Wt,"data:")===0&&li[he])){if(!(be&&!Gr(H,q0(Wt,G,"")))){if(Wt)return!1}}}}}}return!0},i5=function(he){return he!=="annotation-xml"&&xF(he,V)},x0=function(he){wa(R.beforeSanitizeAttributes,he,null);const{attributes:st}=he;if(!st||yd(he))return;const Wt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se,forceKeepAttr:void 0};let bs=st.length;for(;bs--;){const Ir=st[bs],{name:ro,namespaceURI:ya,value:zh}=Ir,Pv=Ii(ro),s5=zh;let or=ro==="value"?s5:B7e(s5);if(Wt.attrName=Pv,Wt.attrValue=or,Wt.keepAttr=!0,Wt.forceKeepAttr=void 0,wa(R.uponSanitizeAttribute,he,Wt),or=Wt.attrValue,rt&&(Pv==="id"||Pv==="name")&&(Hs(ro,he),or=Et+or),qe&&Gr(/((--!?|])>)|<\/(style|title|textarea)/i,or)){Hs(ro,he);continue}if(Pv==="attributename"&&xF(or,"href")){Hs(ro,he);continue}if(Wt.forceKeepAttr)continue;if(!Wt.keepAttr){Hs(ro,he);continue}if(!Ce&&Gr(/\/>/i,or)){Hs(ro,he);continue}Je&&RD([T,A,N],NK=>{or=q0(or,NK," ")});const TK=Ii(he.nodeName);if(!jk(TK,Pv,or)){Hs(ro,he);continue}if(C&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!ya)switch(f.getAttributeType(TK,Pv)){case"TrustedHTML":{or=C.createHTML(or);break}case"TrustedScriptURL":{or=C.createScriptURL(or);break}}if(or!==s5)try{ya?he.setAttributeNS(ya,ro,or):he.setAttribute(ro,or),yd(he)?Ws(he):kZ(e.removed)}catch{Hs(ro,he)}}wa(R.afterSanitizeAttributes,he,null)},n5=function Kt(he){let st=null;const Wt=wd(he);for(wa(R.beforeSanitizeShadowDOM,he,null);st=Wt.nextNode();)wa(R.uponSanitizeShadowNode,st,null),Av(st),x0(st),st.content instanceof o&&Kt(st.content);wa(R.afterSanitizeShadowDOM,he,null)};return e.sanitize=function(Kt){let he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},st=null,Wt=null,bs=null,Ir=null;if(Ai=!Kt,Ai&&(Kt="<!-->"),typeof Kt!="string"&&!Of(Kt))if(typeof Kt.toString=="function"){if(Kt=Kt.toString(),typeof Kt!="string")throw j0("dirty is not a string, aborting")}else throw j0("toString is not a function");if(!e.isSupported)return Kt;if(Ke||Bs(he),e.removed=[],typeof Kt=="string"&&(Ge=!1),Ge){if(Kt.nodeName){const zh=Ii(Kt.nodeName);if(!$[zh]||te[zh])throw j0("root node is forbidden and cannot be sanitized in-place")}}else if(Kt instanceof a)st=xc("<!---->"),Wt=st.ownerDocument.importNode(Kt,!0),Wt.nodeType===G0.element&&Wt.nodeName==="BODY"||Wt.nodeName==="HTML"?st=Wt:st.appendChild(Wt);else{if(!ft&&!Je&&!mt&&Kt.indexOf("<")===-1)return C&&Be?C.createHTML(Kt):Kt;if(st=xc(Kt),!st)return ft?null:Be?y:""}st&&nt&&Ws(st.firstChild);const ro=wd(Ge?Kt:st);for(;bs=ro.nextNode();)Av(bs),x0(bs),bs.content instanceof o&&n5(bs.content);if(Ge)return Kt;if(ft){if(Pe)for(Ir=L.call(st.ownerDocument);st.firstChild;)Ir.appendChild(st.firstChild);else Ir=st;return(se.shadowroot||se.shadowrootmode)&&(Ir=M.call(i,Ir,!0)),Ir}let ya=mt?st.outerHTML:st.innerHTML;return mt&&$["!doctype"]&&st.ownerDocument&&st.ownerDocument.doctype&&st.ownerDocument.doctype.name&&Gr(Rle,st.ownerDocument.doctype.name)&&(ya="<!DOCTYPE "+st.ownerDocument.doctype.name+`>
`+ya),Je&&RD([T,A,N],zh=>{ya=q0(ya,zh," ")}),C&&Be?C.createHTML(ya):ya},e.setConfig=function(){let Kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Bs(Kt),Ke=!0},e.clearConfig=function(){Xi=null,Ke=!1},e.isValidAttribute=function(Kt,he,st){Xi||Bs({});const Wt=Ii(Kt),bs=Ii(he);return jk(Wt,bs,st)},e.addHook=function(Kt,he){typeof he=="function"&&$0(R[Kt],he)},e.removeHook=function(Kt,he){if(he!==void 0){const st=P7e(R[Kt],he);return st===-1?void 0:O7e(R[Kt],st,1)[0]}return kZ(R[Kt])},e.removeHooks=function(Kt){R[Kt]=[]},e.removeAllHooks=function(){R=AZ()},e}var gC=Mle();const Ale=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","s","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]),Ple=Object.freeze(["href","target","src","alt","title","for","name","role","tabindex","x-dispatch","required","checked","placeholder","type","start","width","height","align"]),DF="vscode-relative-path";function PZ(s,e){if(e.override==="*")return!0;try{const t=new URL(s,DF+"://");return!!(e.override.includes(t.protocol.replace(/:$/,""))||e.allowRelativePaths&&t.protocol===DF+":"&&!s.trim().toLowerCase().startsWith(DF))}catch{return!1}}function J7e(s,e){gC.addHook("afterSanitizeAttributes",t=>{for(const i of["href","src"])if(t.hasAttribute(i)){const n=t.getAttribute(i);i==="href"?!n.startsWith("#")&&!PZ(n,s)&&t.removeAttribute(i):PZ(n,e)||t.removeAttribute(i)}})}const eWe=Object.freeze({ALLOWED_TAGS:[...Ale],ALLOWED_ATTR:[...Ple],ALLOW_UNKNOWN_PROTOCOLS:!0});function tWe(s,e){return Ole(s,e,"trusted")}function Ole(s,e,t){var i,n;try{const o={...eWe};e!=null&&e.allowedTags&&(e.allowedTags.override&&(o.ALLOWED_TAGS=[...e.allowedTags.override]),e.allowedTags.augment&&(o.ALLOWED_TAGS=[...o.ALLOWED_TAGS??[],...e.allowedTags.augment]));let r=[...Ple];e!=null&&e.allowedAttributes&&(e.allowedAttributes.override&&(r=[...e.allowedAttributes.override]),e.allowedAttributes.augment&&(r=[...r,...e.allowedAttributes.augment])),r=r.map(c=>typeof c=="string"?c.toLowerCase():{attributeName:c.attributeName.toLowerCase(),shouldKeep:c.shouldKeep});const a=new Set(r.map(c=>typeof c=="string"?c:c.attributeName)),l=new Map;for(const c of r)typeof c=="string"?l.delete(c):l.set(c.attributeName,c);return o.ALLOWED_ATTR=Array.from(a),J7e({override:((i=e==null?void 0:e.allowedLinkProtocols)==null?void 0:i.override)??[ct.http,ct.https],allowRelativePaths:(e==null?void 0:e.allowRelativeLinkPaths)??!1},{override:((n=e==null?void 0:e.allowedMediaProtocols)==null?void 0:n.override)??[ct.http,ct.https],allowRelativePaths:(e==null?void 0:e.allowRelativeMediaPaths)??!1}),e!=null&&e.replaceWithPlaintext&&gC.addHook("uponSanitizeElement",nWe),l.size&&gC.addHook("uponSanitizeAttribute",(c,d)=>{const h=l.get(d.attrName);if(h){const u=h.shouldKeep(c,d);typeof u=="string"?(d.keepAttr=!0,d.attrValue=u):d.keepAttr=u}else d.keepAttr=a.has(d.attrName)}),t==="dom"?gC.sanitize(s,{...o,RETURN_DOM_FRAGMENT:!0}):gC.sanitize(s,{...o,RETURN_TRUSTED_TYPE:!0})}finally{gC.removeAllHooks()}}const iWe=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],nWe=(s,e,t)=>{var i,n;if(!e.allowedTags[e.tagName]&&e.tagName!=="body"){const o=Fle(s);o&&(s.nodeType===Node.COMMENT_NODE?(i=s.parentElement)==null||i.insertBefore(o,s):(n=s.parentElement)==null||n.replaceChild(o,s))}};function Fle(s){if(!s.ownerDocument)return;let e,t;if(s.nodeType===Node.COMMENT_NODE)e=`<!--${s.textContent}-->`;else if(s instanceof Element){const r=s.tagName.toLowerCase(),a=iWe.includes(r),l=s.attributes.length?" "+Array.from(s.attributes).map(c=>`${c.name}="${c.value}"`).join(" "):"";e=`<${r}${l}>`,a||(t=`</${r}>`)}else return;const i=document.createDocumentFragment(),n=s.ownerDocument.createTextNode(e);for(i.appendChild(n);s.firstChild;)i.appendChild(s.firstChild);const o=t?s.ownerDocument.createTextNode(t):void 0;return o&&i.appendChild(o),i}function Ble(s,e,t){const i=Ole(e,t,"dom");Os(s,i)}const sWe=new RegExp(`(\\\\)?\\$\\((${it.iconNameExpression}(?:${it.iconModifierExpression})?)\\)`,"g");function Hg(s){const e=new Array;let t,i=0,n=0;for(;(t=sWe.exec(s))!==null;){n=t.index||0,i<n&&e.push(s.substring(i,n)),i=(t.index||0)+t[0].length;const[,o,r]=t;e.push(o?`$(${r})`:fd({id:r}))}return i<s.length&&e.push(s.substring(i)),e}function fd(s){const e=we("span");return e.classList.add(...it.asClassNameArray(s)),e}const TF=Object.freeze({image:({href:s,title:e,text:t})=>{let i=[],n=[];return s&&({href:s,dimensions:i}=XBe(s),n.push(`src="${TD(s)}"`)),t&&n.push(`alt="${TD(t)}"`),e&&n.push(`title="${TD(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:s}){return`<p>${this.parser.parseInline(s)}</p>`},link({href:s,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof s!="string"?"":(s===i&&(i=yF(i)),e=typeof e=="string"?TD(yF(e)):"",s=yF(s),s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${s}" title="${e||s}" draggable="false">${i}</a>`)}});function oWe(s){return function(e){const{tokens:t}=e,i=t[0];if((i==null?void 0:i.type)!=="paragraph")return s.call(this,e);const n=i.tokens;if(!n||n.length===0)return s.call(this,e);const o=n[0];if((o==null?void 0:o.type)!=="text")return s.call(this,e);const r=/^\s*\[!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]\s*?\n*/i,a=o.raw.match(r);if(!a)return s.call(this,e);o.raw=o.raw.replace(r,""),o.text=o.text.replace(r,"");const l={note:"info",tip:"light-bulb",important:"comment",warning:"alert",caution:"stop"},c=a[1],d=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),h=c.toLowerCase(),u=fd({id:l[h]}).outerHTML,f=this.parser.parse(t);return`<blockquote data-severity="${h}"><p><span>${u}${d}</span>${f.substring(3)}</blockquote>
`}}function Ik(s,e={},t){var g,m,p;const i=new oe;let n=!1;const o=new kle(...e.markedExtensions??[]),{renderer:r,codeBlocks:a,syncCodeBlocks:l}=aWe(o,e,s),c=lWe(s);let d;if(e.fillInIncompleteTokens){const v={...o.defaults,...e.markedOptions,renderer:r},b=o.lexer(c,v),w=wWe(b);d=o.parser(w,v)}else d=o.parse(c,{...e==null?void 0:e.markedOptions,renderer:r,async:!1});s.supportThemeIcons&&(d=Hg(d).map(b=>typeof b=="string"?b:b.outerHTML).join(""));const h=document.createElement("div"),u=Wle(s,e.sanitizerConfig??{});Ble(h,d,u),rWe(s,e,h);let f;if(t?(f=t,Os(t,...h.children)):f=h,a.length>0)Promise.all(a).then(v=>{var C;if(n)return;const b=new Map(v),w=f.querySelectorAll("div[data-code]");for(const y of w){const x=b.get(y.dataset.code??"");x&&Os(y,x)}(C=e.asyncRenderCallback)==null||C.call(e)});else if(l.length>0){const v=new Map(l),b=f.querySelectorAll("div[data-code]");for(const w of b){const C=v.get(w.dataset.code??"");C&&Os(w,C)}}if(e.asyncRenderCallback)for(const v of f.getElementsByTagName("img")){const b=i.add(ee(v,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}if(e.actionHandler){const v=b=>{const w=new Co(je(f),b);!w.leftButton&&!w.middleButton||OZ(s,e,w)};i.add(ee(f,"click",v)),i.add(ee(f,"auxclick",v)),i.add(ee(f,"keydown",b=>{const w=new Bi(b);!w.equals(10)&&!w.equals(3)||OZ(s,e,w)}))}for(const v of[...f.getElementsByTagName("input")])if(((g=v.attributes.getNamedItem("type"))==null?void 0:g.value)==="checkbox")v.setAttribute("disabled","");else if((m=e.sanitizerConfig)!=null&&m.replaceWithPlaintext){const b=Fle(v);b?(p=v.parentElement)==null||p.replaceChild(b,v):v.remove()}else v.remove();return{element:f,dispose:()=>{n=!0,i.dispose()}}}function rWe(s,e,t){var i;for(const n of t.querySelectorAll("img, audio, video, source")){const o=n.getAttribute("src");if(o){let r=o;try{s.baseUri&&(r=C7(Ze.from(s.baseUri),r))}catch{}if(n.setAttribute("src",FZ(s,r,!0)),(i=e.sanitizerConfig)!=null&&i.remoteImageIsAllowed){const a=Ze.parse(r);a.scheme!==ct.file&&a.scheme!==ct.data&&!e.sanitizerConfig.remoteImageIsAllowed(a)&&n.replaceWith(we("",void 0,n.outerHTML))}}}for(const n of t.querySelectorAll("a")){const o=n.getAttribute("href");if(n.setAttribute("href",""),!o||/^data:|javascript:/i.test(o)||/^command:/i.test(o)&&!s.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(o))n.replaceWith(...n.childNodes);else{let r=FZ(s,o,!1);s.baseUri&&(r=C7(Ze.from(s.baseUri),o)),n.dataset.href=r}}}function aWe(s,e,t){const i=new s.Renderer(e.markedOptions);i.image=TF.image,i.link=TF.link,i.paragraph=TF.paragraph,t.supportAlertSyntax&&(i.blockquote=oWe(i.blockquote));const n=[],o=[];return e.codeBlockRendererSync?i.code=({text:r,lang:a,raw:l})=>{const c=g7.nextId(),d=e.codeBlockRendererSync(BZ(a),r,l);return o.push([c,d]),`<div class="code" data-code="${c}">${hc(r)}</div>`}:e.codeBlockRenderer&&(i.code=({text:r,lang:a})=>{const l=g7.nextId(),c=e.codeBlockRenderer(BZ(a),r);return n.push(c.then(d=>[l,d])),`<div class="code" data-code="${l}">${hc(r)}</div>`}),t.supportHtml||(i.html=({text:r})=>{var l;return(l=e.sanitizerConfig)!=null&&l.replaceWithPlaintext?hc(r):(t.isTrusted?r.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?r:""}),{renderer:i,codeBlocks:n,syncCodeBlocks:o}}function lWe(s){let e=s.value;return e.length>1e5&&(e=`${e.substr(0,1e5)}…`),s.supportThemeIcons&&(e=qBe(e)),e}function OZ(s,e,t){var n;const i=t.target.closest("a[data-href]");if(Bn(i))try{let o=i.dataset.href;o&&(s.baseUri&&(o=C7(Ze.from(s.baseUri),o)),(n=e.actionHandler)==null||n.call(e,o,s))}catch(o){_t(o)}finally{t.preventDefault()}}function cWe(s,e){let t;try{t=p7(decodeURIComponent(e))}catch{}return t?(t=Voe(t,i=>{if(s.uris&&s.uris[i])return Ze.revive(s.uris[i])}),encodeURIComponent(JSON.stringify(t))):e}function FZ(s,e,t){const i=s.uris&&s.uris[e];let n=Ze.revive(i);return t?e.startsWith(ct.data+":")?e:(n||(n=Ze.parse(e)),Qse.uriToBrowserUri(n).toString(!0)):!n||Ze.parse(e).toString()===n.toString()?e:(n.query&&(n=n.with({query:cWe(s,n.query)})),n.toString())}function BZ(s){if(!s)return"";const e=s.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:s}function C7(s,e){return/^\w[\w\d+.-]*:/.test(e)?e:s.path.endsWith("/")?bY(s,e).toString():bY(NO(s),e).toString()}function dWe(s,e,t={}){const i=Wle(e,t);return tWe(s,i)}const hWe=Object.freeze([...Ale,"input"]),uWe=Object.freeze(["align","autoplay","alt","colspan","controls","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","target","title","type","width","start","checked","disabled","value","data-code","data-href","data-severity",{attributeName:"style",shouldKeep:(s,e)=>s.tagName==="SPAN"&&e.attrName==="style"?/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z0-9]+)+\));)?(border-radius:[0-9]+px;)?$/.test(e.attrValue):!1},{attributeName:"class",shouldKeep:(s,e)=>s.tagName==="SPAN"&&e.attrName==="class"?/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(e.attrValue):!1}]);function Wle(s,e){var n,o,r;const t=s.isTrusted??!1,i=[ct.http,ct.https,ct.mailto,ct.file,ct.vscodeFileResource,ct.vscodeRemote,ct.vscodeRemoteResource,ct.vscodeNotebookCell];return t&&i.push(ct.command),(n=e.allowedLinkSchemes)!=null&&n.augment&&i.push(...e.allowedLinkSchemes.augment),{allowedTags:{override:((o=e.allowedTags)==null?void 0:o.override)??hWe},allowedAttributes:{override:((r=e.allowedAttributes)==null?void 0:r.override)??uWe},allowedLinkProtocols:{override:i},allowRelativeLinkPaths:!!s.baseUri,allowedMediaProtocols:{override:[ct.http,ct.https,ct.data,ct.file,ct.vscodeFileResource,ct.vscodeRemote,ct.vscodeRemoteResource]},allowRelativeMediaPaths:!!s.baseUri,replaceWithPlaintext:e.replaceWithPlaintext}}function fWe(s,e){if(typeof s=="string")return s;let t=s.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}…`);const i=D7e(t,{async:!1,renderer:mWe.value});return dWe(i,{isTrusted:!1},{}).toString().replace(/&(#\d+|[a-zA-Z]+);/g,n=>gWe.get(n)??n).trim()}const gWe=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function Hle(){const s=new iI;return s.code=({text:e})=>hc(e),s.blockquote=({text:e})=>e+`
`,s.html=e=>"",s.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.hr=()=>"",s.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},s.listitem=({text:e})=>e+`
`,s.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},s.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},s.tablerow=({text:e})=>e,s.tablecell=function({tokens:e}){return this.parser.parseInline(e)},s.strong=({text:e})=>e,s.em=({text:e})=>e,s.codespan=({text:e})=>hc(e),s.br=e=>`
`,s.del=({text:e})=>e,s.image=e=>"",s.text=({text:e})=>e,s.link=({text:e})=>e,s}const mWe=new bo(Hle);new bo(()=>{const s=Hle();return s.code=({text:e})=>`
\`\`\`
${hc(e)}
\`\`\`
`,s});function sI(s){let e="";return s.forEach(t=>{e+=t.raw}),e}function Vle(s){var e,t;if(s.tokens)for(let i=s.tokens.length-1;i>=0;i--){const n=s.tokens[i];if(n.type==="text"){const o=n.raw.split(`
`),r=o[o.length-1];if(r.includes("`"))return SWe(s);if(r.includes("**"))return DWe(s);if(r.match(/\*\w/))return xWe(s);if(r.match(/(^|\s)__\w/))return TWe(s);if(r.match(/(^|\s)_\w/))return LWe(s);if(pWe(r)||_We(r)&&s.tokens.slice(0,i).some(a=>a.type==="text"&&a.raw.match(/\[[^\]]*$/))){const a=s.tokens.slice(i+1);return((e=a[0])==null?void 0:e.type)==="link"&&((t=a[1])==null?void 0:t.type)==="text"&&a[1].raw.match(/^ *"[^"]*$/)||r.match(/^[^"]* +"[^"]*$/)?EWe(s):IWe(s)}else if(r.match(/(^|\s)\[\w*[^\]]*$/))return kWe(s)}}}function pWe(s){return!!s.match(/(^|\s)\[.*\]\(\w*/)}function _We(s){return!!s.match(/^[^\[]*\]\([^\)]*$/)}function bWe(s){var c;const e=s.items[s.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0,i=d=>{const h=d.items.at(-1),u=h==null?void 0:h.tokens.at(-1);return(u==null?void 0:u.type)==="heading"||(u==null?void 0:u.type)==="list"&&i(u)};let n;if((t==null?void 0:t.type)==="text"&&!("inRawBlock"in e))n=Vle(t);else if(i(s)){const d=nI(s.raw.trim()+" &nbsp;")[0];return d.type!=="list"?void 0:d}if(!n||n.type!=="paragraph")return;const o=sI(s.items.slice(0,-1)),r=(c=e.raw.match(/^(\s*(-|\d+\.|\*) +)/))==null?void 0:c[0];if(!r)return;const a=r+sI(e.tokens.slice(0,-1))+n.raw,l=nI(o+a)[0];if(l.type==="list")return l}function vWe(s,e){if(s.raw.match(/-\s*$/))return nI(e+" &nbsp;")}const CWe=3;function wWe(s){for(let e=0;e<CWe;e++){const t=yWe(s);if(t)s=t;else break}return s}function yWe(s){let e,t;for(e=0;e<s.length;e++){const n=s[e];if(n.type==="paragraph"&&n.raw.match(/(\n|^)\|/)){t=NWe(s.slice(e));break}}const i=s.at(-1);if(!t&&(i==null?void 0:i.type)==="list"){const n=bWe(i);n&&(t=[n],e=s.length-1)}if(!t&&(i==null?void 0:i.type)==="paragraph"){const n=Vle(i);n&&(t=[n],e=s.length-1)}if(t){const n=[...s.slice(0,e),...t];return n.links=s.links,n}if((i==null?void 0:i.type)==="heading"){const n=vWe(i,sI(s));if(n)return n}return null}function SWe(s){return Rm(s,"`")}function xWe(s){return Rm(s,"*")}function LWe(s){return Rm(s,"_")}function IWe(s){return Rm(s,")",!1)}function EWe(s){return Rm(s,'")',!1)}function kWe(s){return Rm(s,"](https://microsoft.com)",!1)}function DWe(s){return Rm(s,"**")}function TWe(s){return Rm(s,"__")}function Rm(s,e,t=!0){const i=sI(Array.isArray(s)?s:[s]),n=t?i.trimEnd():i;return nI(n+e)[0]}function NWe(s){const e=sI(s),t=e.split(`
`);let i,n=!1;for(let o=0;o<t.length;o++){const r=t[o].trim();if(typeof i>"u"&&r.match(/^\s*\|/)){const a=r.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(r.match(/^\s*\|/)){if(o!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){const o=n?t.slice(0,-1).join(`
`):e,r=!!o.match(/\|\s*$/),a=o+(r?"":"|")+`
|${" --- |".repeat(i)}`;return nI(a)}}let zle={showInstantHover:()=>{},showDelayedHover:()=>{},setupDelayedHover:()=>K.None,setupDelayedHoverAtMouse:()=>K.None,hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>({dispose:()=>{},show:()=>{},hide:()=>{},update:()=>{}}),showManagedHover:()=>{}};function RWe(s){zle=s}function yc(){return zle}class MWe{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}function dr(s,e,t){return Math.min(Math.max(s,e),t)}class Ule{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class AWe{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}class $m extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}var Io;(function(s){function e(o,r){if(o.start>=r.end||r.start>=o.end)return{start:0,end:0};const a=Math.max(o.start,r.start),l=Math.min(o.end,r.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}s.intersect=e;function t(o){return o.end-o.start<=0}s.isEmpty=t;function i(o,r){return!t(e(o,r))}s.intersects=i;function n(o,r){const a=[],l={start:o.start,end:Math.min(r.start,o.end)},c={start:Math.max(r.end,o.start),end:o.end};return t(l)||a.push(l),t(c)||a.push(c),a}s.relativeComplement=n})(Io||(Io={}));function WZ(s,e){const t=[];for(const i of e){if(s.start>=i.range.end)continue;if(s.end<i.range.start)break;const n=Io.intersect(s,i.range);Io.isEmpty(n)||t.push({range:n,size:i.size})}return t}function w7({start:s,end:e},t){return{start:s+t,end:e+t}}function PWe(s){const e=[];let t=null;for(const i of s){const n=i.range.start,o=i.range.end,r=i.size;if(t&&r===t.size){t.range.end=o;continue}t={range:{start:n,end:o},size:r},e.push(t)}return e}function OWe(...s){return PWe(s.reduce((e,t)=>e.concat(t),[]))}class FWe{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const n=i.length-t,o=WZ({start:0,end:e},this.groups),r=WZ({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:w7(l.range,n),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=OWe(o,a,r),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const n of this.groups){const o=n.range.end-n.range.start,r=i+o*n.size;if(e<r)return t+Math.floor((e-i)/n.size);t+=o,i=r}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const n of this.groups){const o=n.range.end-n.range.start,r=i+o;if(e<r)return this._paddingTop+t+(e-i)*n.size;t+=o*n.size,i=r}return-1}}class BWe{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const n=we(".monaco-list-row"),r=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:r}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}function WWe(s,e,t,i=[]){if(!s.dataTransfer)return;const n=we(".monaco-drag-image");n.textContent=t,n.classList.add(...i),(a=>{for(;a&&!a.classList.contains("monaco-workbench");)a=a.parentElement;return a||e.ownerDocument.body})(e).appendChild(n),s.dataTransfer.setDragImage(n,-10,-10),setTimeout(()=>n.remove(),0)}var Tf=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};const qm={CurrentDragAndDropData:void 0},Id={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(s){return[s]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class Ek{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class HWe{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class VWe{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function zWe(s,e){return Array.isArray(s)&&Array.isArray(e)?dn(s,e):s===e}class UWe{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}const kA=class kA{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:M5(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,n=Id){var r,a;if(this.virtualDelegate=t,this.domId=`list_id_${++kA.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new Pl(50),this.splicing=!1,this.dragOverAnimationStopDisposable=K.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=K.None,this.onDragLeaveTimeout=K.None,this.currentSelectionDisposable=K.None,this.disposables=new oe,this._onDidChangeContentHeight=new q,this._onDidChangeContentWidth=new q,this.onDidChangeContentHeight=Se.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(const l of i)this.renderers.set(l.templateId,l);if(this.cache=this.disposables.add(new BWe(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Id.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new UWe(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Id.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Oo.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new u0({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:l=>Vr(je(this.domNode),l)})),this.scrollableElement=this.disposables.add(new QO(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Id.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Id.verticalScrollMode,useShadows:n.useShadows??Id.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(ee(this.rowsContainer,Qi.Change,l=>this.onTouchChange(l))),this.disposables.add(ee(this.scrollableElement.getDomNode(),"scroll",l=>{const c=l.target,d=c.scrollTop;c.scrollTop=0,n.scrollToActiveElement&&this.setScrollTop(this.scrollTop+d)})),this.disposables.add(ee(this.domNode,"dragover",l=>this.onDragOver(this.toDragEvent(l)))),this.disposables.add(ee(this.domNode,"drop",l=>this.onDrop(this.toDragEvent(l)))),this.disposables.add(ee(this.domNode,"dragleave",l=>this.onDragLeave(this.toDragEvent(l)))),this.disposables.add(ee(this.domNode,"dragend",l=>this.onDragEnd(l))),n.userSelection){if(n.dnd)throw new Error("DND and user selection cannot be used simultaneously");this.disposables.add(ee(this.domNode,"mousedown",l=>this.onPotentialSelectionStart(l)))}this.setRowLineHeight=n.setRowLineHeight??Id.setRowLineHeight,this.setRowHeight=n.setRowHeight??Id.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Id.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Id.dnd),this.layout((r=n.initialSize)==null?void 0:r.height,(a=n.initialSize)==null?void 0:a.width),n.scrollToActiveElement&&this._setupFocusObserver(e)}_setupFocusObserver(e){this.disposables.add(ee(e,"focus",()=>{const t=Ss();this.activeElement!==t&&t!==null&&(this.activeElement=t,this._scrollToActiveElement(this.activeElement,e))},!0))}_scrollToActiveElement(e,t){const i=t.getBoundingClientRect(),o=e.getBoundingClientRect().top-i.top;o<0&&this.setScrollTop(this.scrollTop+o)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(e){return new FWe(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:e,end:e+t},r=Io.intersect(n,o),a=new Map;for(let y=r.end-1;y>=r.start;y--){const x=this.items[y];if(x.dragStartDisposable.dispose(),x.checkedDisposable.dispose(),x.row){let S=a.get(x.templateId);S||(S=[],a.set(x.templateId,S));const L=this.renderers.get(x.templateId);L&&L.disposeElement&&L.disposeElement(x.element,y,x.row.templateData,{height:x.size}),S.unshift(x.row)}x.row=null,x.stale=!0}const l={start:e+t,end:this.items.length},c=Io.intersect(l,n),d=Io.relativeComplement(l,n),h=i.map(y=>({id:String(this.itemId++),element:y,templateId:this.virtualDelegate.getTemplateId(y),size:this.virtualDelegate.getHeight(y),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(y),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:K.None,checkedDisposable:K.None,stale:!1}));let u;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,h),u=this.items,this.items=h):(this.rangeMap.splice(e,t,h),u=GN(this.items,e,t,h));const f=i.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),m=w7(c,f),p=Io.intersect(g,m);for(let y=p.start;y<p.end;y++)this.updateItemInDOM(this.items[y],y);const v=Io.relativeComplement(m,g);for(const y of v)for(let x=y.start;x<y.end;x++)this.removeItemFromDOM(x);const b=d.map(y=>w7(y,f)),C=[{start:e,end:e+i.length},...b].map(y=>Io.intersect(g,y)).reverse();for(const y of C)for(let x=y.end-1;x>=y.start;x--){const S=this.items[x],L=a.get(S.templateId),E=L==null?void 0:L.pop();this.insertItemInDOM(x,E)}for(const y of a.values())for(const x of y)this.cache.release(x);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),u.map(y=>y.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Vr(je(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getVisibleRange(this.lastRenderTop,this.lastRenderHeight).start}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:PTe(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:M5(this.domNode)})}render(e,t,i,n,o,r=!1,a=!1){const l=this.getRenderRange(t,i),c=Io.relativeComplement(l,e).reverse(),d=Io.relativeComplement(e,l);if(r){const h=Io.intersect(e,l);for(let u=h.start;u<h.end;u++)this.updateItemInDOM(this.items[u],u)}this.cache.transact(()=>{for(const h of d)for(let u=h.start;u<h.end;u++)this.removeItemFromDOM(u,a);for(const h of c)for(let u=h.end-1;u>=h.start;u--)this.insertItemInDOM(u)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&o!==void 0&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){var c,d;const i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{const h=this.cache.alloc(i.templateId);i.row=h.row,i.stale||(i.stale=h.isReusingConnectedDomNode)}const n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);const o=this.accessibilityProvider.isChecked(i.element),r=h=>h==="mixed"?"mixed":String(!!h);if(typeof o=="boolean"||o==="mixed")i.row.domNode.setAttribute("aria-checked",r(o));else if(o){const h=u=>i.row.domNode.setAttribute("aria-checked",r(u));h(o.value),i.checkedDisposable=o.onDidChange(()=>h(o.value))}if(i.stale||!i.row.domNode.parentElement){const h=((d=(c=this.items.at(e+1))==null?void 0:c.row)==null?void 0:d.domNode)??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==h)&&this.rowsContainer.insertBefore(i.row.domNode,h),i.stale=!1}this.updateItemInDOM(i,e);const a=this.renderers.get(i.templateId);if(!a)throw new Error(`No renderer found for template id ${i.templateId}`);a==null||a.renderElement(i.element,e,i.row.templateData,{height:i.size});const l=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!l,l&&(i.dragStartDisposable=ee(i.row.domNode,"dragstart",h=>this.onDragStart(i.element,l,h))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=M5(e.row.domNode);const t=je(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e,t){const i=this.items[e];if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const n=this.renderers.get(i.templateId);n&&n.disposeElement&&n.disposeElement(i.element,e,i.row.templateData,{height:i.size,onScroll:t}),this.cache.release(i.row),i.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return Se.map(this.disposables.add(new Si(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return Se.map(this.disposables.add(new Si(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return Se.filter(Se.map(this.disposables.add(new Si(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return Se.map(this.disposables.add(new Si(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return Se.map(this.disposables.add(new Si(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return Se.map(this.disposables.add(new Si(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return Se.any(Se.map(this.disposables.add(new Si(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),Se.map(this.disposables.add(new Si(this.domNode,Qi.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return Se.map(this.disposables.add(new Si(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return Se.map(this.disposables.add(new Si(this.rowsContainer,Qi.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,o=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:o}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth,void 0,!0),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){var r,a;if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(zb.TEXT,t);let o;this.dnd.getDragLabel&&(o=this.dnd.getDragLabel(n,i)),typeof o>"u"&&(o=String(n.length)),WWe(i,this.domNode,o,[this.domId]),this.domNode.classList.add("dragging"),this.currentDragData=new Ek(n),qm.CurrentDragAndDropData=new HWe(n),(a=(r=this.dnd).onDragStart)==null||a.call(r,this.currentDragData,i)}onPotentialSelectionStart(e){this.currentSelectionDisposable.dispose();const t=ITe(this.domNode),i=this.currentSelectionDisposable=new oe,n=i.add(new oe);n.add(ee(this.domNode,"selectstart",()=>{n.add(ee(t,"mousemove",o=>{var r;((r=t.getSelection())==null?void 0:r.isCollapsed)===!1&&this.setupDragAndDropScrollTopAnimation(o)})),i.add(Ve(()=>{const o=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.currentSelectionBounds=void 0,this.render(o,this.lastRenderTop,this.lastRenderHeight,void 0,void 0)})),i.add(ee(t,"selectionchange",()=>{const o=t.getSelection();if(!o||o.isCollapsed){n.isDisposed&&i.dispose();return}let r=this.getIndexOfListElement(o.anchorNode),a=this.getIndexOfListElement(o.focusNode);r!==void 0&&a!==void 0&&(a<r&&([r,a]=[a,r]),this.currentSelectionBounds={start:r,end:a})}))})),n.add(ee(t,"mouseup",()=>{var o;n.dispose(),this.teardownDragAndDropScrollTopAnimation(),((o=t.getSelection())==null?void 0:o.isCollapsed)!==!1&&i.dispose()}))}getIndexOfListElement(e){var t;if(!(!e||!this.domNode.contains(e)))for(;e&&e!==this.domNode;){if((t=e.dataset)!=null&&t.index)return Number(e.dataset.index);e=e.parentElement}}onDragOver(e){var o,r;if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),qm.CurrentDragAndDropData&&qm.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(qm.CurrentDragAndDropData)this.currentDragData=qm.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new VWe}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&((o=t.effect)==null?void 0:o.type)===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=uf(i).filter(a=>a>=-1&&a<this.length).sort((a,l)=>a-l),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(zWe(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=Ve(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(const a of i){const l=this.items[a];l.dropTarget=!0,(r=l.row)==null||r.domNode.classList.add(n)}this.currentDragFeedbackDisposable=Ve(()=>{var a;for(const l of i){const c=this.items[l];c.dropTarget=!1,(a=c.row)==null||a.domNode.classList.remove(n)}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=cf(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&((i=(t=this.dnd).onDragLeave)==null||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,qm.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){var t,i;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,qm.CurrentDragAndDropData=void 0,(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=K.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=goe(this.domNode).top;this.dragOverAnimationDisposable=qTe(je(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=cf(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;const i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return dr(n,0,3)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;(Bn(i)||boe(i))&&i!==this.rowsContainer&&t.contains(i);){const n=i.getAttribute("data-index");if(n){const o=Number(n);if(!isNaN(o))return o}i=i.parentElement}}getVisibleRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}getRenderRange(e,t){const i=this.getVisibleRange(e,t);if(this.currentSelectionBounds){const n=this.rangeMap.count;i.start=Math.min(i.start,this.currentSelectionBounds.start,n),i.end=Math.min(Math.max(i.end,this.currentSelectionBounds.end+1),n)}return i}_rerender(e,t,i){const n=this.getRenderRange(e,t);let o,r;e===this.elementTop(n.start)?(o=n.start,r=0):n.end-n.start>1&&(o=n.start+1,r=this.elementTop(o)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let d=l.start;d<l.end;d++){const h=this.probeDynamicHeight(d);h!==0&&this.rangeMap.splice(d,1,[this.items[d]]),a+=h,c=c||h!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const d=Io.relativeComplement(n,l);for(const u of d)for(let f=u.start;f<u.end;f++)this.items[f].row&&this.removeItemFromDOM(f);const h=Io.relativeComplement(l,n).reverse();for(const u of h)for(let f=u.end-1;f>=u.start;f--)this.insertItemInDOM(f);for(let u=l.start;u<l.end;u++)this.items[u].row&&this.updateItemInDOM(this.items[u],u);if(typeof o=="number"){const u=this.scrollable.getFutureScrollPosition().scrollTop-e,f=this.elementTop(o)-r+u;this.setScrollTop(f,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){var r,a,l;const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const c=this.virtualDelegate.getDynamicHeight(t.element);if(c!==null){const d=t.size;return t.size=c,t.lastDynamicHeightWidth=this.renderWidth,c-d}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!Ps(t.row.domNode,je(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;const{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const o=this.renderers.get(t.templateId);if(!o)throw new et("Missing renderer for templateId: "+t.templateId);return o.renderElement(t.element,e,n.templateData),t.size=n.domNode.offsetHeight,(r=o.disposeElement)==null||r.call(o,t.element,e,n.templateData),(l=(a=this.virtualDelegate).setDynamicHeight)==null||l.call(a,t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){var e,t,i;for(const n of this.items)if(n.dragStartDisposable.dispose(),n.checkedDisposable.dispose(),n.row){const o=this.renderers.get(n.row.templateId);o&&((e=o.disposeElement)==null||e.call(o,n.element,-1,n.row.templateData,void 0),o.disposeTemplate(n.row.templateData))}this.items=[],(t=this.domNode)==null||t.remove(),(i=this.dragOverAnimationDisposable)==null||i.dispose(),this.disposables.dispose()}};kA.InstanceCount=0;let _c=kA;Tf([Kn],_c.prototype,"onMouseClick",null);Tf([Kn],_c.prototype,"onMouseDblClick",null);Tf([Kn],_c.prototype,"onMouseMiddleClick",null);Tf([Kn],_c.prototype,"onMouseDown",null);Tf([Kn],_c.prototype,"onMouseOver",null);Tf([Kn],_c.prototype,"onMouseOut",null);Tf([Kn],_c.prototype,"onContextMenu",null);Tf([Kn],_c.prototype,"onTouchStart",null);Tf([Kn],_c.prototype,"onTap",null);var Mm=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};class $We{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex(o=>o.templateData===i);if(n>=0){const o=this.renderedElements[n];this.trait.unrender(i),o.index=t}else{const o={index:t,templateData:i};this.renderedElements.push(o)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const o of this.renderedElements)o.index<e?n.push(o):o.index>=e+t&&n.push({index:o.index+i-t,templateData:o.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let KR=class{get onChange(){return this._onChange.event}get name(){return this._trait}get renderer(){return new $We(this)}constructor(e){this._trait=e,this.indexes=[],this.sortedIndexes=[],this._onChange=new q}splice(e,t,i){const n=i.length-t,o=e+t,r=[];let a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)r.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&r.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=o;)r.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(r,r)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(VZ),t)}_set(e,t,i){const n=this.indexes,o=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const r=y7(o,e);return this.renderer.renderIndexes(r),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return KN(this.sortedIndexes,e,VZ)>=0}dispose(){yi(this._onChange)}};Mm([Kn],KR.prototype,"renderer",null);class qWe extends KR{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class NF{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const o=new Set(n),r=i.map(a=>o.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,r)}}function kk(s,e){return s.classList.contains(e)?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:kk(s.parentElement,e)}function xS(s){return kk(s,"monaco-editor")}function jWe(s){return kk(s,"monaco-custom-toggle")}function KWe(s){return kk(s,"action-item")}function cx(s){return kk(s,"monaco-tree-sticky-row")}function oI(s){return s.classList.contains("monaco-tree-sticky-container")}function $le(s){return s.tagName==="A"&&s.classList.contains("monaco-button")||s.tagName==="DIV"&&s.classList.contains("monaco-button-dropdown")?!0:s.classList.contains("monaco-list")||!s.parentElement?!1:$le(s.parentElement)}class qle{get onKeyDown(){return Se.chain(this.disposables.add(new Si(this.view.domNode,"keydown")).event,e=>e.filter(t=>!nd(t.target)).map(t=>new Bi(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new oe,this.multipleSelectionDisposables=new oe,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(Bt?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(cr(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}Mm([Kn],qle.prototype,"onKeyDown",null);var th;(function(s){s[s.Automatic=0]="Automatic",s[s.Trigger=1]="Trigger"})(th||(th={}));var MC;(function(s){s[s.Idle=0]="Idle",s[s.Typing=1]="Typing"})(MC||(MC={}));const GWe=new class{mightProducePrintableCharacter(s){return s.ctrlKey||s.metaKey||s.altKey?!1:s.keyCode>=31&&s.keyCode<=56||s.keyCode>=21&&s.keyCode<=30||s.keyCode>=98&&s.keyCode<=107||s.keyCode>=85&&s.keyCode<=95}};class YWe{constructor(e,t,i,n,o){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=n,this.delegate=o,this.enabled=!1,this.state=MC.Idle,this.mode=th.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new oe,this.disposables=new oe,this.updateOptions(e.options)}updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??th.Automatic}enable(){if(this.enabled)return;let e=!1;const t=Se.chain(this.enabledDisposables.add(new Si(this.view.domNode,"keydown")).event,o=>o.filter(r=>!nd(r.target)).filter(()=>this.mode===th.Automatic||this.triggered).map(r=>new Bi(r)).filter(r=>e||this.keyboardNavigationEventFilter(r)).filter(r=>this.delegate.mightProducePrintableCharacter(r)).forEach(r=>ri.stop(r,!0)).map(r=>r.browserEvent.key)),i=Se.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);Se.reduce(Se.any(t,i),(o,r)=>r===null?null:(o||"")+r,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var t;const e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){const i=(t=this.list.options.accessibilityProvider)==null?void 0:t.getAriaLabel(this.list.element(e[0]));typeof i=="string"?br(i):i&&br(i.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=MC.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===MC.Idle?1:0;this.state=MC.Typing;for(let o=0;o<this.list.length;o++){const r=(i+o+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(r)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(eI(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}const c=MBe(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}else if(typeof l>"u"||eI(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class XWe{constructor(e,t){this.list=e,this.view=t,this.disposables=new oe;const i=Se.chain(this.disposables.add(new Si(t.domNode,"keydown")).event,o=>o.filter(r=>!nd(r.target)).map(r=>new Bi(r)));Se.chain(i,o=>o.filter(r=>r.keyCode===2&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&!r.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!n||!Bn(n)||n.tabIndex===-1)return;const o=je(n).getComputedStyle(n);o.visibility==="hidden"||o.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function jle(s){return Bt?s.browserEvent.metaKey:s.browserEvent.ctrlKey}function Kle(s){return s.browserEvent.shiftKey}function ZWe(s){return BU(s)&&s.button===2}const HZ={isSelectionSingleChangeEvent:jle,isSelectionRangeChangeEvent:Kle};class Gle{get onPointer(){return this._onPointer.event}constructor(e){this.list=e,this.disposables=new oe,this._onPointer=this.disposables.add(new q),e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||HZ),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Oo.addTarget(e.getHTMLElement()))),Se.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||HZ))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){xS(e.browserEvent.target)||Ss()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(nd(e.browserEvent.target)||xS(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||nd(e.browserEvent.target)||xS(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),ZWe(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(nd(e.browserEvent.target)||xS(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));const n=Math.min(i,t),o=Math.max(i,t),r=cr(n,o+1),a=this.list.getSelection(),l=t8e(y7(a,[i]),i);if(l.length===0)return;const c=y7(r,i8e(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),o=n.filter(r=>r!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===o.length?this.list.setSelection([...o,t],e.browserEvent):this.list.setSelection(o,e.browserEvent)}}dispose(){this.disposables.dispose()}}class QWe{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const n=Ju(e.listFocusAndSelectionOutline,Ju(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image${t},
				.monaco-list${t}:focus .monaco-list-row.focused,
				.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const o=Ju(e.listSelectionOutline,e.listInactiveFocusOutline??"");o&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${o}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-enable-motion .monaco-table:hover > .monaco-split-view2,
				.monaco-enable-motion .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-enable-motion .monaco-table > .monaco-split-view2,
				.monaco-enable-motion .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}}const JWe={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:re.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:re.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:re.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},e8e={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function t8e(s,e){const t=s.indexOf(e);if(t===-1)return[];const i=[];let n=t-1;for(;n>=0&&s[n]===e-(t-n);)i.push(s[n--]);for(i.reverse(),n=t;n<s.length&&s[n]===e+(n-t);)i.push(s[n++]);return i}function y7(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){t.push(s[i]),i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):t.push(e[n++]);return t}function i8e(s,e){const t=[];let i=0,n=0;for(;i<s.length||n<e.length;)if(i>=s.length)t.push(e[n++]);else if(n>=e.length)t.push(s[i++]);else if(s[i]===e[n]){i++,n++;continue}else s[i]<e[n]?t.push(s[i++]):n++;return t}const VZ=(s,e)=>s-e;class n8e{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let o=0;for(const r of this.renderers)r.renderElement(e,t,i[o++],n)}disposeElement(e,t,i,n){var r;let o=0;for(const a of this.renderers)(r=a.disposeElement)==null||r.call(a,e,t,i[o],n),o+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class s8e{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return{container:e,disposables:new oe}}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e),o=n&&typeof n!="string"?n:Gi(n);i.disposables.add(lt(a=>{this.setAriaLabel(a.readObservable(o),i.container)}));const r=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof r=="number"?i.container.setAttribute("aria-level",`${r}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}}class o8e{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,e,t)}onDragOver(e,t,i,n,o){return this.dnd.onDragOver(e,t,i,n,o)}onDragLeave(e,t,i,n){var o,r;(r=(o=this.dnd).onDragLeave)==null||r.call(o,e,t,i,n)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}drop(e,t,i,n,o){this.dnd.drop(e,t,i,n,o)}dispose(){this.dnd.dispose()}}class nl{get onDidChangeFocus(){return Se.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return Se.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=Se.chain(this.disposables.add(new Si(this.view.domNode,"keydown")).event,o=>o.map(r=>new Bi(r)).filter(r=>e=r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>ri.stop(r,!0)).filter(()=>!1)),i=Se.chain(this.disposables.add(new Si(this.view.domNode,"keyup")).event,o=>o.forEach(()=>e=!1).map(r=>new Bi(r)).filter(r=>r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>ri.stop(r,!0)).map(({browserEvent:r})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,d=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:d,browserEvent:r}})),n=Se.chain(this.view.onContextMenu,o=>o.filter(r=>!e).map(({element:r,index:a,browserEvent:l})=>({element:r,index:a,anchor:new Co(je(this.view.domNode),l),browserEvent:l})));return Se.any(t,i,n)}get onKeyDown(){return this.disposables.add(new Si(this.view.domNode,"keydown")).event}get onDidFocus(){return Se.signal(this.disposables.add(new Si(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return Se.signal(this.disposables.add(new Si(this.view.domNode,"blur",!0)).event)}constructor(e,t,i,n,o=e8e){var c,d,h;this.user=e,this._options=o,this.focus=new KR("focused"),this.anchor=new KR("anchor"),this.eventBufferer=new ak,this._ariaLabel="",this.disposables=new oe,this._onDidDispose=new q,this.onDidDispose=this._onDidDispose.event;const r=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(c=this._options.accessibilityProvider)==null?void 0:c.getWidgetRole():"list";this.selection=new qWe(r!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(a.push(new s8e(this.accessibilityProvider)),(h=(d=this.accessibilityProvider).onDidChangeActiveDescendant)==null||h.call(d,this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(u=>new n8e(u.templateId,[...a,u]));const l={...o,dnd:o.dnd&&new o8e(this,o.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",r),o.styleController)this.styleController=o.styleController(this.view.domId);else{const u=Hl(this.view.domNode);this.styleController=new QWe(u,this.view.domId)}if(this.spliceable=new MWe([new NF(this.focus,this.view,o.identityProvider),new NF(this.selection,this.view,o.identityProvider),new NF(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new XWe(this,this.view)),(typeof o.keyboardSupport!="boolean"||o.keyboardSupport)&&(this.keyboardController=new qle(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){const u=o.keyboardNavigationDelegate||GWe;this.typeNavigationController=new YWe(this,this.view,o.keyboardNavigationLabelProvider,o.keyboardNavigationEventFilter??(()=>!0),u),this.disposables.add(this.typeNavigationController)}if(this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider){const u=this.accessibilityProvider.getWidgetAriaLabel(),f=u&&typeof u!="string"?u:Gi(u);this.disposables.add(lt(g=>{this.ariaLabel=g.readObservable(f)}))}this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,n){return new _c(e,t,i,n)}createMouseController(e){return new Gle(this)}updateOptions(e={}){var t,i;this._options={...this._options,...e},(t=this.typeNavigationController)==null||t.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(i=this.keyboardController)==null||i.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new $m(this.user,`Invalid start index: ${e}`);if(t<0)throw new $m(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new $m(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new $m(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return this.anchor.get().at(0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new $m(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;const o=this.focus.get(),r=this.findNextIndex(o.length>0?o[0]+e:0,t,n);r>-1&&this.setFocus([r],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;const o=this.focus.get(),r=this.findPreviousIndex(o.length>0?o[0]-e:0,t,n);r>-1&&this.setFocus([r],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){const o=this.findPreviousIndex(i,!1,t);o>-1&&n!==o?this.setFocus([o],e):this.setFocus([i],e)}else{const o=this.view.getScrollTop();let r=o+this.view.renderHeight;i>n&&(r-=this.view.elementHeight(i)),this.view.setScrollTop(r),this.view.getScrollTop()!==o&&(this.setFocus([]),await Sh(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n;const o=i(),r=this.view.getScrollTop()+o;r===0?n=this.view.indexAt(r):n=this.view.indexAfter(r-1);const a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){const l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{const l=r;this.view.setScrollTop(r-this.view.renderHeight-o),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await Sh(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new $m(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),o=this.view.elementTop(e),r=this.view.elementHeight(e);if(af(t)){const a=r-this.view.renderHeight+i;this.view.setScrollTop(a*dr(t,0,1)+o-i)}else{const a=o+r,l=n+this.view.renderHeight;o<n+i&&a>=l||(o<n+i||a>=l&&r>=this.view.renderHeight?this.view.setScrollTop(o-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new $m(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),o=this.view.elementHeight(e);if(n<i+t||n+o>i+this.view.renderHeight)return null;const r=o-this.view.renderHeight+t;return Math.abs((i+t-n)/r)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var t;const e=this.focus.get();if(e.length>0){let i;(t=this.accessibilityProvider)!=null&&t.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}Mm([Kn],nl.prototype,"onDidChangeFocus",null);Mm([Kn],nl.prototype,"onDidChangeSelection",null);Mm([Kn],nl.prototype,"onContextMenu",null);Mm([Kn],nl.prototype,"onKeyDown",null);Mm([Kn],nl.prototype,"onDidFocus",null);Mm([Kn],nl.prototype,"onDidBlur",null);const Zp=we,Yle="selectOption.entry.template";class r8e{get templateId(){return Yle}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=me(e,Zp(".option-text")),t.detail=me(e,Zp(".option-detail")),t.decoratorRight=me(e,Zp(".option-decorator-right")),t}renderElement(e,t,i){const n=i,o=e.text,r=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=o,n.detail.textContent=r||"",n.decoratorRight.textContent=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}}const Vd=class Vd extends K{constructor(e,t,i,n,o){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._selectionDetailsDisposables=this._register(new oe),this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=n,this.selectBoxOptions=o||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=Vd.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new q,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(yc().setupManagedHover(Fh("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return Yle}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=we(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=me(this.selectDropDownContainer,Zp(".select-box-details-pane"));const t=me(this.selectDropDownContainer,Zp(".select-box-dropdown-container-width-control")),i=me(t,Zp(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",me(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Hl(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(ee(this.selectDropDownContainer,ye.DRAG_START,n=>{ri.stop(n,!0)}))}registerListeners(){this._register(Jn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(ee(this.selectElement,ye.CLICK,t=>{ri.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(ee(this.selectElement,ye.MOUSE_DOWN,t=>{ri.stop(t)}));let e;this._register(ee(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(ee(this.selectElement,"touchend",t=>{ri.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(ee(this.selectElement,ye.KEY_DOWN,t=>{const i=new Bi(t);let n=!1;Bt?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),ri.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){dn(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){var e;(e=this.selectList)==null||e.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){const e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){const e=this.styles.selectBackground??"",t=Ju(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;const i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.textContent="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=je(this.selectElement),i=Fn(this.selectElement),n=je(this.selectElement).getComputedStyle(this.selectElement),o=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),r=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-Vd.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),d=Math.max(c,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=d,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let h=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const u=this._hasDetails?this._cachedMaxDetailsHeight:0,f=h+o+u,g=Math.floor((r-o-u)/this.getHeight()),m=Math.floor((a-o-u)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<Vd.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||g<1&&m<1?!1:(g<Vd.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&m>g&&this.options.length>g?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<Vd.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&g<1||this._dropDownPosition===1&&m<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&g+m<1)return this.hideSelectDropDown(!0),!1;f>r&&(h=g*this.getHeight())}else f>a&&(h=m*this.getHeight());return this.selectList.layout(h),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=h+o+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=h+o+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=d,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((o,r)=>{const a=o.detail?o.detail.length:0,l=o.decoratorRight?o.decoratorRight.length:0,c=o.text.length+a+l;c>n&&(i=r,n=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=Jr(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=me(e,Zp(".select-box-dropdown-list-container")),this.listRenderer=new r8e,this.selectList=this._register(new nl("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let o=n.text;return n.detail&&(o+=`. ${n.detail}`),n.decoratorRight&&(o+=`. ${n.decoratorRight}`),n.description&&(o+=`. ${n.description}`),o},getWidgetAriaLabel:()=>_(16,"Select Box"),getRole:()=>Bt?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new Si(this.selectDropDownListContainer,"keydown")),i=Se.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(o=>new Bi(o)));this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===3))(this.onEnter,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===2))(this.onEnter,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===9))(this.onEscape,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===16))(this.onUpArrow,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===18))(this.onDownArrow,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===12))(this.onPageDown,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===11))(this.onPageUp,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===14))(this.onHome,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode===13))(this.onEnd,this)),this._register(Se.chain(i,n=>n.filter(o=>o.keyCode>=21&&o.keyCode<=56||o.keyCode>=85&&o.keyCode<=113))(this.onCharacter,this)),this._register(ee(this.selectList.getHTMLElement(),ye.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(ee(this.selectDropDownContainer,ye.FOCUS_OUT,n=>{!this._isVisible||Ps(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;ri.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const n=Number(i.getAttribute("data-index")),o=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!o&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=o=>{for(let r=0;r<o.childNodes.length;r++){const a=o.childNodes.item(r);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=Ik({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this._selectionDetailsDisposables.clear(),this.selectionDetailsPane.textContent="";const t=this.options[e],i=(t==null?void 0:t.description)??"",n=(t==null?void 0:t.descriptionIsMarkdown)??!1;if(i){if(n){const o=t.descriptionMarkdownActionHandler,r=this._selectionDetailsDisposables.add(this.renderDescriptionMarkdown(i,o));this.selectionDetailsPane.appendChild(r.element)}else this.selectionDetailsPane.textContent=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){ri.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){ri.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){ri.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(ri.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){ri.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){ri.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){ri.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){ri.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=Su.toString(e.keyCode);let i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),ri.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};Vd.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32,Vd.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2,Vd.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;let S7=Vd;class a8e extends K{constructor(e,t,i,n){super(),this.selected=0,this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new q),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Oo.addTarget(this.selectElement)),[Qi.Tap].forEach(e=>{this._register(ee(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Jn(this.selectElement,"click",e=>{ri.stop(e,!0)})),this._register(Jn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Jn(this.selectElement,"keydown",e=>{let t=!1;Bt?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!dn(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}}class l8e extends va{constructor(e,t,i,n,o){super(),Bt&&!(o!=null&&o.useCustomDrawn)?this.selectBoxDelegate=new a8e(e,t,n,o):this.selectBoxDelegate=new S7(e,t,i,n,o),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class qc extends K{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof Ga&&this._register(t.onDidChange(n=>{this.element&&this.handleActionChangeEvent(n)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Mb)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Oo.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,Wr&&this._register(ee(e,ye.DRAG_START,n=>{var o;return(o=n.dataTransfer)==null?void 0:o.setData(zb.TEXT,this._action.label)}))),this._register(ee(t,Qi.Tap,n=>this.onClick(n,!0))),this._register(ee(t,ye.MOUSE_DOWN,n=>{i||ri.stop(n,!0),this._action.enabled&&n.button===0&&t.classList.add("active")})),Bt&&this._register(ee(t,ye.CONTEXT_MENU,n=>{n.button===0&&n.ctrlKey===!0&&this.onClick(n)})),this._register(ee(t,ye.CLICK,n=>{ri.stop(n,!0),this.options&&this.options.isMenu||this.onClick(n)})),this._register(ee(t,ye.DBLCLICK,n=>{ri.stop(n,!0)})),[ye.MOUSE_UP,ye.MOUSE_OUT].forEach(n=>{this._register(ee(t,n,o=>{ri.stop(o),t.classList.remove("active")}))})}onClick(e,t=!1){var n;ri.stop(e,!0);const i=vl(this._context)?(n=this.options)!=null&&n.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}getHoverContents(){return this.getTooltip()}updateTooltip(){if(!this.element)return;const e=this.getHoverContents()??"";if(this.updateAriaLabel(),!this.customHover&&e!==""){const t=this.options.hoverDelegate??Fh("element");this.customHover=this._store.add(yc().setupManagedHover(t,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){const e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class Aw extends qc{constructor(e,t,i){i={...i,icon:i.icon!==void 0?i.icon:!1,label:i.label!==void 0?i.label:!0},super(e,t,i),this.options=i,this.cssClass=""}render(e){super.render(e),ti(this.element);const t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding&&!this.options.keybindingNotRenderedWithLabel){const i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===_s.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label,this.options.keybinding&&(e=_(0,"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){var e;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(e=this.label)==null||e.classList.remove("codicon")}updateEnabled(){var e,t;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(e=this.element)==null||e.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(t=this.element)==null||t.classList.add("disabled"))}updateAriaLabel(){if(this.label){const e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class c8e extends qc{constructor(e,t,i,n,o,r,a){super(e,t),this.selectBox=new l8e(i,n,o,r,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){var e;(e=this.selectBox)==null||e.focus()}blur(){var e;(e=this.selectBox)==null||e.blur()}render(e){this.selectBox.render(e)}}class Fr extends K{get onDidBlur(){return this._onDidBlur.event}get onDidCancel(){return this._onDidCancel.event}get onDidRun(){return this._onDidRun.event}get onWillRun(){return this._onWillRun.event}constructor(e,t={}){var o,r;super(),this._actionRunnerDisposables=this._register(new oe),this.viewItemDisposables=this._register(new gO),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new q),this._onDidCancel=this._register(new q({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.cancelHasListener=!1,this._onDidRun=this._register(new q),this._onWillRun=this._register(new q),this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:((o=this.options.triggerKeys)==null?void 0:o.keyDown)??!1,keys:((r=this.options.triggerKeys)==null?void 0:r.keys)??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(sle()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Mb,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(a=>this._onDidRun.fire(a))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(a=>this._onWillRun.fire(a))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(ee(this.domNode,ye.KEY_DOWN,a=>{const l=new Bi(a);let c=!0;const d=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(l.equals(i[0])||l.equals(i[1]))?c=this.focusPrevious():n&&(l.equals(n[0])||l.equals(n[1]))?c=this.focusNext():l.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():l.equals(14)?c=this.focusFirst():l.equals(13)?c=this.focusLast():l.equals(2)&&d instanceof qc&&d.trapsArrowNavigation?c=this.focusNext(void 0,!0):this.isTriggerKeyEvent(l)?this._triggerKeys.keyDown?this.doTrigger(l):this.triggerKeyDown=!0:c=!1,c&&(l.preventDefault(),l.stopPropagation())})),this._register(ee(this.domNode,ye.KEY_UP,a=>{const l=new Bi(a);this.isTriggerKeyEvent(l)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(l)),l.preventDefault(),l.stopPropagation()):(l.equals(2)||l.equals(1026)||l.equals(16)||l.equals(18)||l.equals(15)||l.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Ol(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Ss()===this.domNode||!Ps(Ss(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof qc&&i.isEnabled());t instanceof qc&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof qc&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){var e,t;for(let i=0;i<this.actionsList.children.length;i++){const n=this.actionsList.children[i];if(Ps(Ss(),n)){this.focusedItem=i,(t=(e=this.viewItems[this.focusedItem])==null?void 0:e.showHover)==null||t.call(e);break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){var t;if(typeof e=="number")return(t=this.viewItems[e])==null?void 0:t.action;if(Bn(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===e)return this.viewItems[i].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=af(t.index)?t.index:null;if(i.forEach(o=>{const r=document.createElement("li");r.className="action-item",r.setAttribute("role","presentation");let a;const l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(o,l)),a||(a=new Aw(this.context,o,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,ee(r,ye.CONTEXT_MENU,c=>{ri.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(r),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(r),this.viewItems.push(a)):(this.actionsList.insertBefore(r,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),this.focusable){let o=!1;for(const r of this.viewItems){if(!(r instanceof qc))continue;let a;o||r.action.id===_s.ID||!r.isEnabled()&&this.options.focusOnlyEnabledItems?a=!1:a=!0,a?(r.setFocusable(!0),o=!0):r.setFocusable(!1)}}typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}getWidth(e){if(e>=0&&e<this.actionsList.children.length){const t=this.actionsList.children.item(e);if(t)return t.clientWidth}return 0}pull(e){e>=0&&e<this.viewItems.length&&(this.actionsList.childNodes[e].remove(),this.viewItemDisposables.deleteAndDispose(this.viewItems[e]),yi(this.viewItems.splice(e,1)),this.refreshRole())}clear(){this.isEmpty()||(this.viewItems=yi(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),io(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const n=this.viewItems.findIndex(o=>o.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===_s.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===_s.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var o,r;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((o=this.viewItems[this.previouslyFocusedItem])==null||o.blur());const n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let a=!0;kb(n.focus)||(a=!1),this.options.focusOnlyEnabledItems&&kb(n.isEnabled)&&!n.isEnabled()&&(a=!1),n.action.id===_s.ID&&(a=!1),a?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),a&&((r=n.showHover)==null||r.call(n))}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof qc){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=yi(this.viewItems),this.getContainer().remove(),super.dispose()}}function d8e(s,e,t,i){if(s.length===0)return e;if(e.length===0)return s;const n=[];let o=0,r=0;for(;o<s.length&&r<e.length;){const a=s[o],l=e[r],c=t(a),d=t(l);c<d?(n.push(a),o++):c>d?(n.push(l),r++):(n.push(i(a,l)),o++,r++)}for(;o<s.length;)n.push(s[o]),o++;for(;r<e.length;)n.push(e[r]),r++;return n}function GR(s,e){const t=new oe,i=s.createDecorationsCollection();return t.add(bO({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const o=e.read(n);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}function AC(s,e){return s.appendChild(e),Ve(()=>{e.remove()})}function h8e(s,e){return s.prepend(e),Ve(()=>{e.remove()})}class Xle extends K{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new ore(e,t)),this._width=ht(this,this.elementSizeObserver.getWidth()),this._height=ht(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>Ki(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function zZ(s,e,t){let i=e.get(),n=i,o=i;const r=ht("animatedValue",i);let a=-1;const l=300;let c;t.add(e0({changeTracker:{createChangeSummary:()=>({animate:!1}),handleChange:(h,u)=>(h.didChange(e)&&(u.animate=u.animate||h.change),!0)}},(h,u)=>{c!==void 0&&(s.cancelAnimationFrame(c),c=void 0),n=o,i=e.read(h),a=Date.now()-(u.animate?0:l),d()}));function d(){const h=Date.now()-a;o=Math.floor(u8e(h,n,i-n,l)),h<l?c=s.requestAnimationFrame(d):o=i,r.set(o,void 0)}return r}function u8e(s,e,t,i){return s===i?e+t:t*(-Math.pow(2,-10*s/i)+1)+e}class lq extends K{constructor(e,t,i){super(),this._register(new x7(e,i)),this._register(wm(i,{height:t.actualHeight,top:t.actualTop}))}}class PC{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=ht(this,void 0),this._actualHeight=ht(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}const DA=class DA{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${DA._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};DA._counter=0;let x7=DA;function wm(s,e){return lt(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,o=>"-"+o.toLowerCase()),s.style[i]=n})}function YR(s,e,t,i){const n=new oe,o=[];return n.add(Ao((r,a)=>{const l=e.read(r),c=new Map,d=new Map;t&&t(!0),s.changeViewZones(h=>{for(const u of o)h.removeZone(u),i==null||i.delete(u);o.length=0;for(const u of l){const f=h.addZone(u);u.setZoneId&&u.setZoneId(f),o.push(f),i==null||i.add(f),c.set(u,f)}}),t&&t(!1),a.add(e0({changeTracker:{createChangeSummary(){return{zoneIds:[]}},handleChange(h,u){const f=d.get(h.changedObservable);return f!==void 0&&u.zoneIds.push(f),!0}}},(h,u)=>{for(const f of l)f.onChange&&(d.set(f.onChange,c.get(f)),f.onChange.read(h));t&&t(!0),s.changeViewZones(f=>{for(const g of u.zoneIds)f.layoutZone(g)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),s.changeViewZones(r=>{for(const a of o)r.removeZone(a)}),i==null||i.clear(),t&&t(!1)}}),n}class f8e extends hn{dispose(){super.dispose(!0)}}function UZ(s,e){const t=BL(e,n=>n.original.startLineNumber<=s.lineNumber);if(!t)return D.fromPositions(s);if(t.original.endLineNumberExclusive<=s.lineNumber){const n=s.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return D.fromPositions(new z(n,s.column))}if(!t.innerChanges)return D.fromPositions(new z(t.modified.startLineNumber,1));const i=BL(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(s));if(!i){const n=s.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return D.fromPositions(new z(n,s.column))}if(i.originalRange.containsPosition(s))return i.modifiedRange;{const n=g8e(i.originalRange.getEndPosition(),s);return D.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function g8e(s,e){return s.lineNumber===e.lineNumber?new xs(0,e.column-s.column):new xs(e.lineNumber-s.lineNumber,e.column-1)}function m8e(s,e){let t;return s.filter(i=>{const n=e(i,t);return t=i,n})}class XR{static create(e,t=void 0){return new $Z(e,e,t)}static createWithDisposable(e,t,i=void 0){const n=new oe;return n.add(t),n.add(e),new $Z(e,n,i)}}class $Z extends XR{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new p8e(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class p8e extends XR{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}class Xo{static inverse(e,t,i){const n=[];let o=1,r=1;for(const l of e){const c=new Xo(new dt(o,l.original.startLineNumber),new dt(r,l.modified.startLineNumber));c.modified.isEmpty||n.push(c),o=l.original.endLineNumberExclusive,r=l.modified.endLineNumberExclusive}const a=new Xo(new dt(o,t+1),new dt(r,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){const n=[];for(const o of e){const r=o.original.intersect(t),a=o.modified.intersect(i);r&&!r.isEmpty&&a&&!a.isEmpty&&n.push(new Xo(r,a))}return n}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Xo(this.modified,this.original)}join(e){return new Xo(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new fr(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new et("not a valid diff");return new fr(new D(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new D(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new fr(new D(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new D(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(qZ(this.original.endLineNumberExclusive,e)&&qZ(this.modified.endLineNumberExclusive,t))return new fr(new D(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new D(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new fr(D.fromPositions(new z(this.original.startLineNumber,1),Gv(new z(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),D.fromPositions(new z(this.modified.startLineNumber,1),Gv(new z(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new fr(D.fromPositions(Gv(new z(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),Gv(new z(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),D.fromPositions(Gv(new z(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),Gv(new z(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new et}}function Gv(s,e){if(s.lineNumber<1)return new z(1,1);if(s.lineNumber>e.length)return new z(e.length,e[e.length-1].length+1);const t=e[s.lineNumber-1];return s.column>t.length+1?new z(s.lineNumber,t.length+1):s}function qZ(s,e){return s>=1&&s<=e.length}class Qa extends Xo{static fromRangeMappings(e){const t=dt.join(e.map(n=>dt.fromRangeInclusive(n.originalRange))),i=dt.join(e.map(n=>dt.fromRangeInclusive(n.modifiedRange)));return new Qa(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new Qa(this.modified,this.original,(e=this.innerChanges)==null?void 0:e.map(t=>t.flip()))}withInnerChangesFromLineRanges(){return new Qa(this.original,this.modified,[this.toRangeMapping()])}}class fr{static fromEdit(e){const t=e.getNewRanges();return e.replacements.map((n,o)=>new fr(n.range,t[o]))}static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new et("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new fr(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new os(this.originalRange,t)}}function ZR(s,e,t,i=!1){const n=[];for(const o of kU(s.map(r=>_8e(r,e,t)),(r,a)=>r.original.intersectsOrTouches(a.original)||r.modified.intersectsOrTouches(a.modified))){const r=o[0],a=o[o.length-1];n.push(new Qa(r.original.join(a.original),r.modified.join(a.modified),o.map(l=>l.innerChanges[0])))}return dm(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length.lineCount-n[n.length-1].modified.endLineNumberExclusive!==e.length.lineCount-n[n.length-1].original.endLineNumberExclusive)?!1:sk(n,(o,r)=>r.original.startLineNumber-o.original.endLineNumberExclusive===r.modified.startLineNumber-o.modified.endLineNumberExclusive&&o.original.endLineNumberExclusive<r.original.startLineNumber&&o.modified.endLineNumberExclusive<r.modified.startLineNumber)),n}function _8e(s,e,t){let i=0,n=0;s.modifiedRange.endColumn===1&&s.originalRange.endColumn===1&&s.originalRange.startLineNumber+i<=s.originalRange.endLineNumber&&s.modifiedRange.startLineNumber+i<=s.modifiedRange.endLineNumber&&(n=-1),s.modifiedRange.startColumn-1>=t.getLineLength(s.modifiedRange.startLineNumber)&&s.originalRange.startColumn-1>=e.getLineLength(s.originalRange.startLineNumber)&&s.originalRange.startLineNumber<=s.originalRange.endLineNumber+n&&s.modifiedRange.startLineNumber<=s.modifiedRange.endLineNumber+n&&(i=1);const o=new dt(s.originalRange.startLineNumber+i,s.originalRange.endLineNumber+1+n),r=new dt(s.modifiedRange.startLineNumber+i,s.modifiedRange.endLineNumber+1+n);return new Qa(o,r,[s])}const b8e={IconContribution:"base.contributions.icons"};var jZ;(function(s){function e(t,i){let n=t.defaults;for(;it.isThemeIcon(n);){const o=xv.getIcon(n.id);if(!o)return;n=o.defaults}return n}s.getDefinition=e})(jZ||(jZ={}));var KZ;(function(s){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}s.toJSONObject=e;function t(i){const n=o=>As(o)?o:void 0;if(i&&Array.isArray(i.src)&&i.src.every(o=>As(o.format)&&As(o.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(o=>({format:o.format,location:Ze.parse(o.location)}))}}s.fromJSONObject=t})(KZ||(KZ={}));const v8e=/^([\w_-]+)$/,C8e=_(2024,"The font ID must only contain letters, numbers, underscores and dashes.");class w8e extends K{constructor(){super(),this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:_(2025,"The id of the font to use. If not set, the font that is defined first is used."),pattern:v8e.source,patternErrorMessage:C8e},fontCharacter:{type:"string",description:_(2026,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${it.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const o=this.iconsById[e];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return o}const r={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=r;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(o,r)=>o.id.localeCompare(r.id),t=o=>{for(;it.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(const o of n.filter(r=>!!r.description).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|${it.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const o of n.filter(r=>!it.isThemeIcon(r.defaults)).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|`);return i.join(`
`)}}const xv=new w8e;kn.add(b8e.IconContribution,xv);function rn(s,e,t,i){return xv.registerIcon(s,e,t,i)}function Zle(){return xv}function y8e(){const s=xoe();for(const e in s){const t="\\"+s[e].toString(16);xv.registerIcon(e,{fontCharacter:t})}}y8e();const Qle="vscode://schemas/icons",Jle=kn.as(BO.JSONContribution);Jle.registerSchema(Qle,xv.getIconSchema());const GZ=new Ni(()=>Jle.notifySchemaChanged(Qle),200);xv.onDidChange(()=>{GZ.isScheduled()||GZ.schedule()});const ece=rn("widget-close",ge.close,_(2027,"Icon for the close action in widgets."));rn("goto-previous-location",ge.arrowUp,_(2028,"Icon for goto previous editor location."));rn("goto-next-location",ge.arrowDown,_(2029,"Icon for goto next editor location."));it.modify(ge.sync,"spin");it.modify(ge.loading,"spin");var cq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},dq=function(s,e){return function(t,i){e(t,i,s)}};const S8e=rn("diff-review-insert",ge.add,_(97,"Icon for 'Insert' in accessible diff viewer.")),x8e=rn("diff-review-remove",ge.remove,_(98,"Icon for 'Remove' in accessible diff viewer.")),L8e=rn("diff-review-close",ge.close,_(99,"Icon for 'Close' in accessible diff viewer."));var $1;let Qp=($1=class extends K{constructor(e,t,i,n,o,r,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=o,this._height=r,this._diffs=a,this._models=l,this._instantiationService=c,this._state=ae(this,d=>{const h=this._visible.read(d);if(this._parentNode.style.visibility=h?"visible":"hidden",!h)return null;const u=d.store.add(this._instantiationService.createInstance(L7,this._diffs,this._models,this._setVisible,this._canClose)),f=d.store.add(this._instantiationService.createInstance(I7,this._parentNode,u,this._width,this._height,this._models));return{model:u,view:f}}).recomputeInitiallyAndOnChange(this._store)}next(){Ki(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){Ki(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){Ki(e=>{this._setVisible(!1,e)})}},$1._ttPolicy=Oh("diffReview",{createHTML:e=>e}),$1);Qp=cq([dq(8,$e)],Qp);let L7=class extends K{constructor(e,t,i,n,o){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=n,this._accessibilitySignalService=o,this._groups=ht(this,[]),this._currentGroupIdx=ht(this,0),this._currentElementIdx=ht(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((r,a)=>this._groups.read(a)[r]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((r,a)=>{var l;return(l=this.currentGroup.read(a))==null?void 0:l.lines[r]}),this._register(lt(r=>{const a=this._diffs.read(r);if(!a){this._groups.set([],void 0);return}const l=I8e(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());Ki(c=>{const d=this._models.getModifiedPosition();if(d){const h=l.findIndex(u=>(d==null?void 0:d.lineNumber)<u.range.modified.endLineNumberExclusive);h!==-1&&this._currentGroupIdx.set(h,c)}this._groups.set(l,c)})})),this._register(lt(r=>{const a=this.currentElement.read(r);(a==null?void 0:a.type)===gr.Deleted?this._accessibilitySignalService.playSignal(ur.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===gr.Added&&this._accessibilitySignalService.playSignal(ur.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(lt(r=>{const a=this.currentElement.read(r);if(a&&a.type!==gr.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(D.fromPositions(new z(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||_w(t,n=>{this._currentGroupIdx.set(Ue.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),n),this._currentElementIdx.set(0,n)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||Ki(i=>{this._currentElementIdx.set(Ue.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&Ki(n=>{this._currentElementIdx.set(i,n)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===gr.Deleted?this._models.originalReveal(D.fromPositions(new z(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==gr.Header?D.fromPositions(new z(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};L7=cq([dq(4,Df)],L7);const Y0=3;function I8e(s,e,t){const i=[];for(const n of kU(s,(o,r)=>r.modified.startLineNumber-o.modified.endLineNumberExclusive<2*Y0)){const o=[];o.push(new k8e);const r=new dt(Math.max(1,n[0].original.startLineNumber-Y0),Math.min(n[n.length-1].original.endLineNumberExclusive+Y0,e+1)),a=new dt(Math.max(1,n[0].modified.startLineNumber-Y0),Math.min(n[n.length-1].modified.endLineNumberExclusive+Y0,t+1));Jse(n,(d,h)=>{const u=new dt(d?d.original.endLineNumberExclusive:r.startLineNumber,h?h.original.startLineNumber:r.endLineNumberExclusive),f=new dt(d?d.modified.endLineNumberExclusive:a.startLineNumber,h?h.modified.startLineNumber:a.endLineNumberExclusive);u.forEach(g=>{o.push(new N8e(g,f.startLineNumber+(g-u.startLineNumber)))}),h&&(h.original.forEach(g=>{o.push(new D8e(h,g))}),h.modified.forEach(g=>{o.push(new T8e(h,g))}))});const l=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);i.push(new E8e(new Xo(l,c),o))}return i}var gr;(function(s){s[s.Header=0]="Header",s[s.Unchanged=1]="Unchanged",s[s.Deleted=2]="Deleted",s[s.Added=3]="Added"})(gr||(gr={}));class E8e{constructor(e,t){this.range=e,this.lines=t}}class k8e{constructor(){this.type=gr.Header}}class D8e{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=gr.Deleted,this.modifiedLineNumber=void 0}}class T8e{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=gr.Added,this.originalLineNumber=void 0}}class N8e{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=gr.Unchanged}}let I7=class extends K{constructor(e,t,i,n,o,r){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._models=o,this._languageService=r,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new Fr(a)),this._register(lt(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(c_({id:"diffreview.close",label:_(100,"Close"),class:"close-diff-review "+it.asClassName(L8e),enabled:!0,run:async()=>t.close()}),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new vk(this._content,{})),Os(this.domNode,this._scrollbar.getDomNode(),a),this._register(lt(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(Ve(()=>{Os(this.domNode)})),this._register(wm(this.domNode,{width:this._width,height:this._height})),this._register(wm(this._content,{width:this._width,height:this._height})),this._register(Ao((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(Jn(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",_(101,"Accessible Diff Viewer. Use arrow up and down to navigate.")),js(n,i.get(59)),Os(this._content,n);const o=this._models.getOriginalModel(),r=this._models.getModifiedModel();if(!o||!r)return;const a=o.getOptions(),l=r.getOptions(),c=i.get(75),d=this._model.currentGroup.get();for(const h of(d==null?void 0:d.lines)||[]){if(!d)break;let u;if(h.type===gr.Header){const g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");const m=d.range,p=this._model.currentGroupIndex.get(),v=this._model.groups.get().length,b=x=>x===0?_(102,"no lines changed"):x===1?_(103,"1 line changed"):_(104,"{0} lines changed",x),w=b(m.original.length),C=b(m.modified.length);g.setAttribute("aria-label",_(105,"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",p+1,v,m.original.startLineNumber,w,m.modified.startLineNumber,C));const y=document.createElement("div");y.className="diff-review-cell diff-review-summary",y.appendChild(document.createTextNode(`${p+1}/${v}: @@ -${m.original.startLineNumber},${m.original.length} +${m.modified.startLineNumber},${m.modified.length} @@`)),g.appendChild(y),u=g}else u=this._createRow(h,c,this._width.get(),t,o,a,i,r,l);n.appendChild(u);const f=ae(g=>this._model.currentElement.read(g)===h);e.add(lt(g=>{const m=f.read(g);u.tabIndex=m?0:-1,m&&u.focus()})),e.add(ee(u,"focus",()=>{this._model.goToLine(h)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,o,r,a,l,c){const d=n.get(165),h=d.glyphMarginWidth+d.lineNumbersWidth,u=a.get(165),f=10+u.glyphMarginWidth+u.lineNumbersWidth;let g="diff-review-row",m="";const p="diff-review-spacer";let v=null;switch(e.type){case gr.Added:g="diff-review-row line-insert",m=" char-insert",v=S8e;break;case gr.Deleted:g="diff-review-row line-delete",m=" char-delete",v=x8e;break}const b=document.createElement("div");b.style.minWidth=i+"px",b.className=g,b.setAttribute("role","listitem"),b.ariaLevel="";const w=document.createElement("div");w.className="diff-review-cell",w.style.height=`${t}px`,b.appendChild(w);const C=document.createElement("span");C.style.width=h+"px",C.style.minWidth=h+"px",C.className="diff-review-line-number"+m,e.originalLineNumber!==void 0?C.appendChild(document.createTextNode(String(e.originalLineNumber))):C.innerText=" ",w.appendChild(C);const y=document.createElement("span");y.style.width=f+"px",y.style.minWidth=f+"px",y.style.paddingRight="10px",y.className="diff-review-line-number"+m,e.modifiedLineNumber!==void 0?y.appendChild(document.createTextNode(String(e.modifiedLineNumber))):y.innerText=" ",w.appendChild(y);const x=document.createElement("span");if(x.className=p,v){const E=document.createElement("span");E.className=it.asClassName(v),E.innerText="  ",x.appendChild(E)}else x.innerText="  ";w.appendChild(x);let S;if(e.modifiedLineNumber!==void 0){let E=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);Qp._ttPolicy&&(E=Qp._ttPolicy.createHTML(E)),w.insertAdjacentHTML("beforeend",E),S=l.getLineContent(e.modifiedLineNumber)}else{let E=this._getLineHtml(o,n,r.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);Qp._ttPolicy&&(E=Qp._ttPolicy.createHTML(E)),w.insertAdjacentHTML("beforeend",E),S=o.getLineContent(e.originalLineNumber)}S.length===0&&(S=_(106,"blank"));let L="";switch(e.type){case gr.Unchanged:e.originalLineNumber===e.modifiedLineNumber?L=_(107,"{0} unchanged line {1}",S,e.originalLineNumber):L=_(108,"{0} original line {1} modified line {2}",S,e.originalLineNumber,e.modifiedLineNumber);break;case gr.Added:L=_(109,"+ {0} modified line {1}",S,e.modifiedLineNumber);break;case gr.Deleted:L=_(110,"- {0} original line {1}",S,e.originalLineNumber);break}return b.setAttribute("aria-label",L),b}_getLineHtml(e,t,i,n,o){const r=e.getLineContent(n),a=t.get(59),l=t.get(117).verticalScrollbarSize,c=qn.createEmpty(r,o),d=el.isBasicASCII(r,e.mightContainNonBasicASCII()),h=el.containsRTL(r,d,e.mightContainRTL());return ZO(new kf(a.isMonospace&&!t.get(40),a.canUseHalfwidthRightwardsArrow,r,!1,d,h,0,c,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(133),t.get(113),t.get(108),t.get(60)!==gf.OFF,null,null,l)).html}};I7=cq([dq(5,Wn)],I7);class R8e{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}F("diffEditor.move.border","#8b8b8b9c",_(137,"The border color for text that got moved in the diff editor."));F("diffEditor.moveActive.border","#FFA500",_(138,"The active border color for text that got moved in the diff editor."));F("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},_(139,"The color of the shadow around unchanged region widgets."));const M8e=rn("diff-insert",ge.add,_(140,"Line decoration for inserts in the diff editor.")),tce=rn("diff-remove",ge.remove,_(141,"Line decoration for removals in the diff editor.")),YZ=vt.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+it.asClassName(M8e),marginClassName:"gutter-insert"}),XZ=vt.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+it.asClassName(tce),marginClassName:"gutter-delete"}),ZZ=vt.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),QZ=vt.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),JZ=vt.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),A8e=vt.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),P8e=vt.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),E7=vt.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),O8e=vt.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),F8e=vt.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),jr=Mt("editorWorkerService");var ice=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},k7=function(s,e){return function(t,i){e(t,i,s)}},rp;const nce=Mt("diffProviderFactoryService");let D7=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance(T7,e)}};D7=ice([k7(0,$e)],D7);Vt(nce,D7,1);var E_;let T7=(E_=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new q,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)==null||e.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Qa(new dt(1,2),new dt(1,t.getLineCount()+1),[new fr(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const o=JSON.stringify([e.uri.toString(),t.uri.toString()]),r=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=rp.diffCache.get(o);if(a&&a.context===r)return a.result;const l=Fs.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),d=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:d,timedOut:(c==null?void 0:c.quitEarly)??!0,detectedMoves:i.computeMoves?(c==null?void 0:c.moves.length)??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return rp.diffCache.size>10&&rp.diffCache.delete(rp.diffCache.keys().next().value),rp.diffCache.set(o,{result:c,context:r}),c}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((i=this.diffAlgorithmOnDidChangeSubscription)==null||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}},rp=E_,E_.diffCache=new Map,E_);T7=rp=ice([k7(1,jr),k7(2,Wo)],T7);class tf{static trivial(e,t){return new tf([new Ts(Ue.ofLength(e.length),Ue.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new tf([new Ts(Ue.ofLength(e.length),Ue.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class Ts{static invert(e,t){const i=[];return Jse(e,(n,o)=>{i.push(Ts.fromOffsetPairs(n?n.getEndExclusives():Bu.zero,o?o.getStarts():new Bu(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new Ts(new Ue(e.offset1,t.offset1),new Ue(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new et("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new Ts(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new Ts(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new Ts(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new Ts(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new Ts(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new Ts(t,i)}getStarts(){return new Bu(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Bu(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}const Pp=class Pp{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new Pp(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}};Pp.zero=new Pp(0,0),Pp.max=new Pp(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);let Bu=Pp;const TA=class TA{isValid(){return!0}};TA.instance=new TA;let rI=TA;class B8e{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new et("timeout must be positive")}isValid(){return!(Date.now()-this.startTime<this.timeout)&&this.valid&&(this.valid=!1),this.valid}}class RF{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function N7(s){return s===32||s===9}const Ux=class Ux{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let n=0;for(let o=e.startLineNumber-1;o<e.endLineNumberExclusive-1;o++){const r=t[o];for(let l=0;l<r.length;l++){n++;const c=r[l],d=Ux.getKey(c);this.histogram[d]=(this.histogram[d]||0)+1}n++;const a=Ux.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}};Ux.chrKeys=new Map;let QR=Ux;function sce(s,e,t,i){return e||(e=n=>n!=null),new Promise((n,o)=>{let r=!0,a=!1;const l=s.map(d=>({isFinished:e(d),error:t?t(d):!1,state:d})),c=lt(d=>{const{isFinished:h,error:u,state:f}=l.read(d);(h||u)&&(r?a=!0:c.dispose(),u?o(u===!0?f:u):n(f))});if(i){const d=i.onCancellationRequested(()=>{c.dispose(),d.dispose(),o(new Ml)});if(i.isCancellationRequested){c.dispose(),d.dispose(),o(new Ml);return}}r=!1,a&&c.dispose()})}function na(s,e,t=Ls.ofCaller()){return new W8e(typeof s=="string"?s:new So(s,void 0,void 0),e,t)}class W8e extends Jy{constructor(e,t,i){super(i),this.event=t,this.handleEvent=()=>{Ki(n=>{for(const o of this._observers)n.updateObserver(o,this),o.handleChange(this,void 0)},()=>this.debugName)},this.debugName=typeof e=="string"?e:e.getDebugName(this)??"Observable Signal From Event"}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}var H8e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},V8e=function(s,e){return function(t,i){e(t,i,s)}};let R7=class extends K{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=ht(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=ht(this,void 0),this.diff=this._diff,this._unchangedRegions=ht(this,void 0),this.unchangedRegions=ae(this,a=>{var l;return this._options.hideUnchangedRegions.read(a)?((l=this._unchangedRegions.read(a))==null?void 0:l.regions)??[]:(Ki(c=>{var d;for(const h of((d=this._unchangedRegions.read(void 0))==null?void 0:d.regions)||[])h.collapseAll(c)}),[])}),this.movedTextToCompare=ht(this,void 0),this._activeMovedText=ht(this,void 0),this._hoveredMovedText=ht(this,void 0),this.activeMovedText=ae(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new hn,this._diffProvider=ae(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=na("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(Ve(()=>this._cancellationTokenSource.cancel()));const n=xl("contentChangedSignal"),o=this._register(new Ni(()=>n.trigger(void 0),200));this._register(lt(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(g=>g.isDragged.read(a)))return;const c=l.originalDecorationIds.map(g=>e.original.getDecorationRange(g)).map(g=>g?dt.fromRangeInclusive(g):void 0),d=l.modifiedDecorationIds.map(g=>e.modified.getDecorationRange(g)).map(g=>g?dt.fromRangeInclusive(g):void 0),h=l.regions.map((g,m)=>!c[m]||!d[m]?void 0:new kg(c[m].startLineNumber,d[m].startLineNumber,c[m].length,g.visibleLineCountTop.read(a),g.visibleLineCountBottom.read(a))).filter($s),u=[];let f=!1;for(const g of kU(h,(m,p)=>m.getHiddenModifiedRange(a).endLineNumberExclusive===p.getHiddenModifiedRange(a).startLineNumber))if(g.length>1){f=!0;const m=g.reduce((v,b)=>v+b.lineCount,0),p=new kg(g[0].originalLineNumber,g[0].modifiedLineNumber,m,g[0].visibleLineCountTop.read(void 0),g[g.length-1].visibleLineCountBottom.read(void 0));u.push(p)}else u.push(g[0]);if(f){const g=e.original.deltaDecorations(l.originalDecorationIds,u.map(p=>({range:p.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations(l.modifiedDecorationIds,u.map(p=>({range:p.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));Ki(p=>{this._unchangedRegions.set({regions:u,originalDecorationIds:g,modifiedDecorationIds:m},p)})}}));const r=(a,l,c)=>{const d=kg.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let h;const u=this._unchangedRegions.get();if(u){const p=u.originalDecorationIds.map(C=>e.original.getDecorationRange(C)).map(C=>C?dt.fromRangeInclusive(C):void 0),v=u.modifiedDecorationIds.map(C=>e.modified.getDecorationRange(C)).map(C=>C?dt.fromRangeInclusive(C):void 0);let w=m8e(u.regions.map((C,y)=>{if(!p[y]||!v[y])return;const x=p[y].length;return new kg(p[y].startLineNumber,v[y].startLineNumber,x,Math.min(C.visibleLineCountTop.get(),x),Math.min(C.visibleLineCountBottom.get(),x-C.visibleLineCountTop.get()))}).filter($s),(C,y)=>!y||C.modifiedLineNumber>=y.modifiedLineNumber+y.lineCount&&C.originalLineNumber>=y.originalLineNumber+y.lineCount).map(C=>new Xo(C.getHiddenOriginalRange(c),C.getHiddenModifiedRange(c)));w=Xo.clip(w,dt.ofLength(1,e.original.getLineCount()),dt.ofLength(1,e.modified.getLineCount())),h=Xo.inverse(w,e.original.getLineCount(),e.modified.getLineCount())}const f=[];if(h)for(const p of d){const v=h.filter(b=>b.original.intersectsStrict(p.originalUnchangedRange)&&b.modified.intersectsStrict(p.modifiedUnchangedRange));f.push(...p.setVisibleRanges(v,l))}else f.push(...d);const g=e.original.deltaDecorations((u==null?void 0:u.originalDecorationIds)||[],f.map(p=>({range:p.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations((u==null?void 0:u.modifiedDecorationIds)||[],f.map(p=>({range:p.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:f,originalDecorationIds:g,modifiedDecorationIds:m},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=Fu.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),o.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=Fu.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),o.schedule()})),this._register(Ao(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),o.cancel(),n.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),this._isDiffUpToDate.set(!1,void 0);let d=[];l.add(e.original.onDidChangeContent(f=>{const g=Fu.fromModelContentChanges(f.changes);d=WR(d,g)}));let h=[];l.add(e.modified.onDidChangeContent(f=>{const g=Fu.fromModelContentChanges(f.changes);h=WR(h,g)}));let u=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(u=z8e(u,e.original,e.modified),u=(e.original,e.modified,void 0)??u,u=(e.original,e.modified,void 0)??u,Ki(f=>{r(u,f),this._lastDiff=u;const g=hq.fromDiffResult(u);this._diff.set(g,f),this._isDiffUpToDate.set(!0,f);const m=this.movedTextToCompare.read(void 0);this.movedTextToCompare.set(m?this._lastDiff.moves.find(p=>p.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,f)}))}))}ensureModifiedLineIsVisible(e,t,i){var o,r;if(((o=this.diff.get())==null?void 0:o.mappings.length)===0)return;const n=((r=this._unchangedRegions.get())==null?void 0:r.regions)||[];for(const a of n)if(a.getHiddenModifiedRange(void 0).contains(e)){a.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){var o,r;if(((o=this.diff.get())==null?void 0:o.mappings.length)===0)return;const n=((r=this._unchangedRegions.get())==null?void 0:r.regions)||[];for(const a of n)if(a.getHiddenOriginalRange(void 0).contains(e)){a.showOriginalLine(e,t,i);return}}async waitForDiff(){await sce(this.isDiffUpToDate,e=>e)}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e==null?void 0:e.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){var n;const t=(n=e.collapsedRegions)==null?void 0:n.map(o=>dt.deserialize(o.range)),i=this._unchangedRegions.get();!i||!t||Ki(o=>{for(const r of i.regions)for(const a of t)if(r.modifiedUnchangedRange.intersect(a)){r.setHiddenModifiedRange(a,o);break}})}};R7=H8e([V8e(2,nce)],R7);function z8e(s,e,t){return{changes:s.changes.map(i=>new Qa(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>U8e(n,e,t)):void 0)),moves:s.moves,identical:s.identical,quitEarly:s.quitEarly}}function U8e(s,e,t){let i=s.originalRange,n=s.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new fr(i,n)}class hq{static fromDiffResult(e){return new hq(e.changes.map(t=>new oce(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class oce{constructor(e){this.lineRangeMapping=e}}class kg{static fromDiffs(e,t,i,n,o){const r=Qa.inverse(e,t,i),a=[];for(const l of r){let c=l.original.startLineNumber,d=l.modified.startLineNumber,h=l.original.length;const u=c===1&&d===1,f=c+h===t+1&&d+h===i+1;(u||f)&&h>=o+n?(u&&!f&&(h-=o),f&&!u&&(c+=o,d+=o,h-=o),a.push(new kg(c,d,h,0,0))):h>=o*2+n&&(c+=o,d+=o,h-=o*2,a.push(new kg(c,d,h,0,0)))}return a}get originalUnchangedRange(){return dt.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return dt.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,o){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=ht(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=ht(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=ae(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=ht(this,void 0);const r=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(o,this.lineCount-n),0);RG(n===r),RG(o===a),this._visibleLineCountTop.set(r,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],n=new Sl(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let o=this.originalLineNumber,r=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of n.ranges){const d=l===n.ranges.length-1;l++;const h=(d?a:c.endLineNumberExclusive)-r,u=new kg(o,r,h,0,0);u.setHiddenModifiedRange(c,t),i.push(u),o=u.originalUnchangedRange.endLineNumberExclusive,r=u.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return dt.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return dt.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),o=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<o||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+o,i)}showOriginalLine(e,t,i){const n=e-this.originalLineNumber,o=this.originalLineNumber+this.lineCount-e;t===0&&n<o||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+o-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-o,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}function $8e(s){const{domNode:e,renderLinesResult:t,diffEntry:i,originalModel:n,clipboardService:o}=s,r=new oe;return r.add(ee(e,"copy",a=>{a.preventDefault();const l=e.ownerDocument.getSelection();if(!l||l.rangeCount===0)return;const c=l.getRangeAt(0);if(!c||c.collapsed)return;const d=c.startContainer.nodeType===Node.TEXT_NODE?c.startContainer.parentElement:c.startContainer,h=c.endContainer.nodeType===Node.TEXT_NODE?c.endContainer.parentElement:c.endContainer;if(!d||!h)return;const u=t.getModelPositionAt(d,c.startOffset),f=t.getModelPositionAt(h,c.endOffset);if(!u||!f)return;const g=u.delta(i.original.startLineNumber-1),m=f.delta(i.original.startLineNumber-1),p=m.isBefore(g)?D.fromPositions(m,g):D.fromPositions(g,m),v=n.getValueInRange(p);o.writeText(v)})),r}class q8e extends K{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,n,o,r,a,l,c,d){super(),this._getViewZoneId=e,this._marginDomNode=t,this._deletedCodeDomNode=i,this._modifiedEditor=n,this._diff=o,this._editor=r,this._renderLinesResult=a,this._originalTextModel=l,this._contextMenuService=c,this._clipboardService=d,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=it.asClassName(ge.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const h=this._modifiedEditor.getOption(75);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${h}px`,this._diffActions.style.lineHeight=`${h}px`,this._marginDomNode.appendChild(this._diffActions);let u=0;const f=n.getOption(144)&&!Al,g=(m,p,v)=>{this._contextMenuService.showContextMenu({domForShadowRoot:f?n.getDomNode()??void 0:void 0,getAnchor:()=>m,onHide:v,getActions:()=>{const b=[],w=o.modified.isEmpty;return b.push(new Ga("diff.clipboard.copyDeletedContent",w?o.original.length>1?_(112,"Copy deleted lines"):_(113,"Copy deleted line"):o.original.length>1?_(114,"Copy changed lines"):_(115,"Copy changed line"),void 0,!0,async()=>{const y=this._originalTextModel.getValueInRange(o.original.toExclusiveRange());await this._clipboardService.writeText(y)})),o.original.length>1&&b.push(new Ga("diff.clipboard.copyDeletedLineContent",w?_(116,"Copy deleted line ({0})",o.original.startLineNumber+u):_(117,"Copy changed line ({0})",o.original.startLineNumber+u),void 0,!0,async()=>{let y=this._originalTextModel.getLineContent(o.original.startLineNumber+u);y===""&&(y=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(y)})),n.getOption(104)||b.push(new Ga("diff.inline.revertChange",_(118,"Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),b},autoSelectFirstItem:!0})};this._register(Jn(this._diffActions,"mousedown",m=>{if(!m.leftButton)return;const{top:p,height:v}=Fn(this._diffActions),b=Math.floor(h/3);m.preventDefault(),g({x:m.posx,y:p+v+b})})),this._register(n.onMouseMove(m=>{(m.target.type===8||m.target.type===5)&&m.target.detail.viewZoneId===this._getViewZoneId()?(u=this._updateLightBulbPosition(this._marginDomNode,m.event.browserEvent.y,h),this.visibility=!0):this.visibility=!1})),this._register($8e({domNode:this._deletedCodeDomNode,diffEntry:o,originalModel:this._originalTextModel,renderLinesResult:this._renderLinesResult,clipboardService:d}))}_updateLightBulbPosition(e,t,i){const{top:n}=Fn(e),o=t-n,r=Math.floor(o/i),a=r*i;if(this._diffActions.style.top=`${a}px`,this._renderLinesResult.viewLineCounts){let l=0;for(let c=0;c<this._renderLinesResult.viewLineCounts.length;c++)if(l+=this._renderLinesResult.viewLineCounts[c],r<l)return c}return r}}const eQ=Oh("diffEditorWidget",{createHTML:s=>s});function Dk(s,e,t,i,n=!1){js(i,e.fontInfo);const o=t.length>0,r=new Dm(1e4);let a=0,l=0;const c=[],d=[];for(let g=0;g<s.lineTokens.length;g++){const m=g+1,p=s.lineTokens[g],v=s.lineBreakData[g],b=Qo.filter(t,m,1,Number.MAX_SAFE_INTEGER);if(v){let w=0;for(const C of v.breakOffsets){const y=p.sliceAndInflate(w,C,0),x=iQ(l,y,Qo.extractWrapped(b,w,C),o,s.mightContainNonBasicASCII,s.mightContainRTL,e,r,n);a=Math.max(a,x.maxCharWidth),d.push(new tQ(x.output.characterMapping,x.output.containsForeignElements,w)),l++,w=C}c.push(v.breakOffsets.length)}else{c.push(1);const w=iQ(l,p,b,o,s.mightContainNonBasicASCII,s.mightContainRTL,e,r,n);a=Math.max(a,w.maxCharWidth),d.push(new tQ(w.output.characterMapping,w.output.containsForeignElements,0)),l++}}a+=e.scrollBeyondLastColumn;const h=r.build(),u=eQ?eQ.createHTML(h):h;i.innerHTML=u;const f=a*e.typicalHalfwidthCharacterWidth;return new j8e(l,f,c,d,s)}class Tk{constructor(e,t=e.map(o=>null),i=!0,n=!0){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class nf{static fromEditor(e){var o;const t=e.getOptions(),i=t.get(59),n=t.get(165);return new nf(((o=e.getModel())==null?void 0:o.getOptions().tabSize)||0,i,t.get(40),i.typicalHalfwidthCharacterWidth,t.get(118),t.get(75),n.decorationsWidth,t.get(133),t.get(113),t.get(108),t.get(60),t.get(117).verticalScrollbarSize)}constructor(e,t,i,n,o,r,a,l,c,d,h,u,f=!0){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=o,this.lineHeight=r,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=d,this.fontLigatures=h,this.verticalScrollbarSize=u,this.setWidth=f}withSetWidth(e){return new nf(this.tabSize,this.fontInfo,this.disableMonospaceOptimizations,this.typicalHalfwidthCharacterWidth,this.scrollBeyondLastColumn,this.lineHeight,this.lineDecorationsWidth,this.stopRenderingLineAfter,this.renderWhitespace,this.renderControlCharacters,this.fontLigatures,this.verticalScrollbarSize,e)}withScrollBeyondLastColumn(e){return new nf(this.tabSize,this.fontInfo,this.disableMonospaceOptimizations,this.typicalHalfwidthCharacterWidth,e,this.lineHeight,this.lineDecorationsWidth,this.stopRenderingLineAfter,this.renderWhitespace,this.renderControlCharacters,this.fontLigatures,this.verticalScrollbarSize,this.setWidth)}}class j8e{constructor(e,t,i,n,o){this.heightInLines=e,this.minWidthInPx=t,this.viewLineCounts=i,this._renderOutputs=n,this._source=o}getModelPositionAt(e,t){let i=e;for(;i&&!i.classList.contains("view-line");)i=i.parentElement;if(!i)return;const n=i.parentElement;if(!n)return;const o=n.querySelectorAll(".view-line");let r=-1;for(let h=0;h<o.length;h++)if(o[h]===i){r=h;break}if(r===-1||r>=this._renderOutputs.length)return;let a=1,l=r;for(let h=0;h<this.viewLineCounts.length;h++){if(l<this.viewLineCounts[h]){a=h+1;break}l-=this.viewLineCounts[h]}if(a>this._source.lineTokens.length)return;const c=this._renderOutputs[r];if(!c)return;const d=xw(c.characterMapping,e,t)+c.offset;return new z(a,d)}}class tQ extends wR{constructor(e,t,i){super(e,t),this.offset=i}}function iQ(s,e,t,i,n,o,r,a,l){a.appendString('<div class="view-line'),!l&&!i&&a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(s*r.lineHeight)),r.setWidth?a.appendString('px;width:1000000px;">'):a.appendString('px;">');const c=e.getLineContent(),d=el.isBasicASCII(c,n),h=el.containsRTL(c,d,o),u=h0(new kf(r.fontInfo.isMonospace&&!r.disableMonospaceOptimizations,r.fontInfo.canUseHalfwidthRightwardsArrow,c,!1,d,h,0,e,t,r.tabSize,0,r.fontInfo.spaceWidth,r.fontInfo.middotWidth,r.fontInfo.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==gf.OFF,null,null,r.verticalScrollbarSize),a);a.appendString("</div>");const f=u.characterMapping.getHorizontalOffset(u.characterMapping.length);return{output:u,maxCharWidth:f}}const pa=Mt("clipboardService"),Nf=Mt("contextViewService"),sl=Mt("contextMenuService");var K8e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nQ=function(s,e){return function(t,i){e(t,i,s)}};let M7=class extends K{constructor(e,t,i,n,o,r,a,l,c,d){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=n,this._diffEditorWidget=o,this._canIgnoreViewZoneUpdateEvent=r,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=d,this._originalTopPadding=ht(this,0),this._originalScrollOffset=ht(this,0),this._originalScrollOffsetAnimated=zZ(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=ht(this,0),this._modifiedScrollOffset=ht(this,0),this._modifiedScrollOffsetAnimated=zZ(this._targetWindow,this._modifiedScrollOffset,this._store);const h=ht("invalidateAlignmentsState",0),u=this._register(new Ni(()=>{h.set(h.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(w=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(w=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(w=>{(w.hasChanged(166)||w.hasChanged(75))&&u.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(w=>{(w.hasChanged(166)||w.hasChanged(75))&&u.schedule()}));const f=this._diffModel.map(w=>w?fi(this,w.model.original.onDidChangeTokens,()=>w.model.original.tokenization.backgroundTokenizationState===2):void 0).map((w,C)=>w==null?void 0:w.read(C)),g=ae(w=>{const C=this._diffModel.read(w),y=C==null?void 0:C.diff.read(w);if(!C||!y)return null;h.read(w);const S=this._options.renderSideBySide.read(w);return sQ(this._editors.original,this._editors.modified,y.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,S)}),m=ae(w=>{var x;const C=(x=this._diffModel.read(w))==null?void 0:x.movedTextToCompare.read(w);if(!C)return null;h.read(w);const y=C.changes.map(S=>new oce(S));return sQ(this._editors.original,this._editors.modified,y,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function p(){const w=document.createElement("div");return w.className="diagonal-fill",w}const v=this._register(new oe);this.viewZones=ae(this,w=>{var G,V,U,$;v.clear();const C=g.read(w)||[],y=[],x=[],S=this._modifiedTopPadding.read(w);S>0&&x.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:S,showInHiddenAreas:!0,suppressMouseDown:!0});const L=this._originalTopPadding.read(w);L>0&&y.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:L,showInHiddenAreas:!0,suppressMouseDown:!0});const E=this._options.renderSideBySide.read(w),M=E||(G=this._editors.modified._getViewModel())==null?void 0:G.createLineBreaksComputer();if(M){const Y=this._editors.original.getModel();for(const se of C)if(se.diff)for(let j=se.originalRange.startLineNumber;j<se.originalRange.endLineNumberExclusive;j++){if(j>Y.getLineCount())return{orig:y,mod:x};M==null||M.addRequest(Y.getLineContent(j),null,null)}}const R=(M==null?void 0:M.finalize())??[];let T=0;const A=this._editors.modified.getOption(75),N=(V=this._diffModel.read(w))==null?void 0:V.movedTextToCompare.read(w),P=((U=this._editors.original.getModel())==null?void 0:U.mightContainNonBasicASCII())??!1,W=(($=this._editors.original.getModel())==null?void 0:$.mightContainRTL())??!1,H=nf.fromEditor(this._editors.modified);for(const Y of C)if(Y.diff&&!E&&(!this._options.useTrueInlineDiffRendering.read(w)||!uq(Y.diff))){if(!Y.originalRange.isEmpty){f.read(w);const j=document.createElement("div");j.classList.add("view-lines","line-delete","line-delete-selectable","monaco-mouse-cursor-text");const ie=this._editors.original.getModel();if(Y.originalRange.endLineNumberExclusive-1>ie.getLineCount())return{orig:y,mod:x};const te=new Tk(Y.originalRange.mapToLineArray(Ce=>ie.tokenization.getLineTokens(Ce)),Y.originalRange.mapToLineArray(Ce=>R[T++]),P,W),pe=[];for(const Ce of Y.diff.innerChanges||[])pe.push(new __(Ce.originalRange.delta(-(Y.diff.original.startLineNumber-1)),E7.className,0));const J=Dk(te,H,pe,j),le=document.createElement("div");if(le.className="inline-deleted-margin-view-zone",js(le,H.fontInfo),this._options.renderIndicators.read(w))for(let Ce=0;Ce<J.heightInLines;Ce++){const Je=document.createElement("div");Je.className=`delete-sign ${it.asClassName(tce)}`,Je.setAttribute("style",`position:absolute;top:${Ce*A}px;width:${H.lineDecorationsWidth}px;height:${A}px;right:0;`),le.appendChild(Je)}let be;v.add(new q8e(()=>_g(be),le,j,this._editors.modified,Y.diff,this._diffEditorWidget,J,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Ce=0;Ce<J.viewLineCounts.length;Ce++){const Je=J.viewLineCounts[Ce];Je>1&&y.push({afterLineNumber:Y.originalRange.startLineNumber+Ce,domNode:p(),heightInPx:(Je-1)*A,showInHiddenAreas:!0,suppressMouseDown:!0})}x.push({afterLineNumber:Y.modifiedRange.startLineNumber-1,domNode:j,heightInPx:J.heightInLines*A,minWidthInPx:J.minWidthInPx,marginDomNode:le,setZoneId(Ce){be=Ce},showInHiddenAreas:!0,suppressMouseDown:!1})}const se=document.createElement("div");se.className="gutter-delete",y.push({afterLineNumber:Y.originalRange.endLineNumberExclusive-1,domNode:p(),heightInPx:Y.modifiedHeightInPx,marginDomNode:se,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const se=Y.modifiedHeightInPx-Y.originalHeightInPx;if(se>0){if(N!=null&&N.lineRangeMapping.original.delta(-1).deltaLength(2).contains(Y.originalRange.endLineNumberExclusive-1))continue;y.push({afterLineNumber:Y.originalRange.endLineNumberExclusive-1,domNode:p(),heightInPx:se,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let j=function(){const te=document.createElement("div");return te.className="arrow-revert-change "+it.asClassName(ge.arrowRight),w.store.add(ee(te,"mousedown",pe=>pe.stopPropagation())),w.store.add(ee(te,"click",pe=>{pe.stopPropagation(),o.revert(Y.diff)})),we("div",{},te)};if(N!=null&&N.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(Y.modifiedRange.endLineNumberExclusive-1))continue;let ie;Y.diff&&Y.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(w)&&(ie=j()),x.push({afterLineNumber:Y.modifiedRange.endLineNumberExclusive-1,domNode:p(),heightInPx:-se,marginDomNode:ie,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const Y of m.read(w)??[]){if(!(N!=null&&N.lineRangeMapping.original.intersect(Y.originalRange))||!(N!=null&&N.lineRangeMapping.modified.intersect(Y.modifiedRange)))continue;const se=Y.modifiedHeightInPx-Y.originalHeightInPx;se>0?y.push({afterLineNumber:Y.originalRange.endLineNumberExclusive-1,domNode:p(),heightInPx:se,showInHiddenAreas:!0,suppressMouseDown:!0}):x.push({afterLineNumber:Y.modifiedRange.endLineNumberExclusive-1,domNode:p(),heightInPx:-se,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:y,mod:x}});let b=!1;this._register(this._editors.original.onDidScrollChange(w=>{w.scrollLeftChanged&&!b&&(b=!0,this._editors.modified.setScrollLeft(w.scrollLeft),b=!1)})),this._register(this._editors.modified.onDidScrollChange(w=>{w.scrollLeftChanged&&!b&&(b=!0,this._editors.original.setScrollLeft(w.scrollLeft),b=!1)})),this._originalScrollTop=fi(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=fi(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(lt(w=>{const C=this._originalScrollTop.read(w)-(this._originalScrollOffsetAnimated.read(void 0)-this._modifiedScrollOffsetAnimated.read(w))-(this._originalTopPadding.read(void 0)-this._modifiedTopPadding.read(w));C!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(C,1)})),this._register(lt(w=>{const C=this._modifiedScrollTop.read(w)-(this._modifiedScrollOffsetAnimated.read(void 0)-this._originalScrollOffsetAnimated.read(w))-(this._modifiedTopPadding.read(void 0)-this._originalTopPadding.read(w));C!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(C,1)})),this._register(lt(w=>{var x;const C=(x=this._diffModel.read(w))==null?void 0:x.movedTextToCompare.read(w);let y=0;if(C){const S=this._editors.original.getTopForLineNumber(C.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.read(void 0);y=this._editors.modified.getTopForLineNumber(C.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.read(void 0)-S}y>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(y,void 0)):y<0?(this._modifiedTopPadding.set(-y,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.read(void 0)-y,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.read(void 0)+y,void 0,!0)}))}};M7=K8e([nQ(8,pa),nQ(9,sl)],M7);function sQ(s,e,t,i,n,o){const r=new ff(oQ(s,i)),a=new ff(oQ(e,n)),l=s.getOption(75),c=e.getOption(75),d=[];let h=0,u=0;function f(g,m){for(;;){let p=r.peek(),v=a.peek();if(p&&p.lineNumber>=g&&(p=void 0),v&&v.lineNumber>=m&&(v=void 0),!p&&!v)break;const b=p?p.lineNumber-h:Number.MAX_VALUE,w=v?v.lineNumber-u:Number.MAX_VALUE;b<w?(r.dequeue(),v={lineNumber:p.lineNumber-h+u,heightInPx:0}):b>w?(a.dequeue(),p={lineNumber:v.lineNumber-u+h,heightInPx:0}):(r.dequeue(),a.dequeue()),d.push({originalRange:dt.ofLength(p.lineNumber,1),modifiedRange:dt.ofLength(v.lineNumber,1),originalHeightInPx:l+p.heightInPx,modifiedHeightInPx:c+v.heightInPx,diff:void 0})}}for(const g of t){let w=function(C,y,x=!1){var R,T;if(C<b||y<v)return;if(p)p=!1;else if(!x&&(C===b||y===v))return;const S=new dt(b,C),L=new dt(v,y);if(S.isEmpty&&L.isEmpty)return;const E=((R=r.takeWhile(A=>A.lineNumber<C))==null?void 0:R.reduce((A,N)=>A+N.heightInPx,0))??0,M=((T=a.takeWhile(A=>A.lineNumber<y))==null?void 0:T.reduce((A,N)=>A+N.heightInPx,0))??0;d.push({originalRange:S,modifiedRange:L,originalHeightInPx:S.length*l+E,modifiedHeightInPx:L.length*c+M,diff:g.lineRangeMapping}),b=C,v=y};const m=g.lineRangeMapping;f(m.original.startLineNumber,m.modified.startLineNumber);let p=!0,v=m.modified.startLineNumber,b=m.original.startLineNumber;if(o)for(const C of m.innerChanges||[]){C.originalRange.startColumn>1&&C.modifiedRange.startColumn>1&&w(C.originalRange.startLineNumber,C.modifiedRange.startLineNumber);const y=s.getModel(),x=C.originalRange.endLineNumber<=y.getLineCount()?y.getLineMaxColumn(C.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;C.originalRange.endColumn<x&&w(C.originalRange.endLineNumber,C.modifiedRange.endLineNumber)}w(m.original.endLineNumberExclusive,m.modified.endLineNumberExclusive,!0),h=m.original.endLineNumberExclusive,u=m.modified.endLineNumberExclusive}return f(Number.MAX_VALUE,Number.MAX_VALUE),d}function oQ(s,e){const t=[],i=[],n=s.getOption(166).wrappingColumn!==-1,o=s._getViewModel().coordinatesConverter,r=s.getOption(75);if(n)for(let l=1;l<=s.getModel().getLineCount();l++){const c=o.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:r*(c-1)})}for(const l of s.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:o.convertViewPositionToModelPosition(new z(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return d8e(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function uq(s){return s.innerChanges?s.innerChanges.every(e=>JR(e.modifiedRange)&&JR(e.originalRange)||e.originalRange.equalsRange(new D(1,1,1,1))):!1}function JR(s){return s.startLineNumber===s.endLineNumber}const $x=class $x extends K{constructor(e,t,i,n,o){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=o,this._originalScrollTop=fi(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=fi(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=na("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=ht(this,0),this._modifiedViewZonesChangedSignal=na("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=na("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=ae(this,d=>{var x;this._element.replaceChildren();const h=this._diffModel.read(d),u=(x=h==null?void 0:h.diff.read(d))==null?void 0:x.movedTexts;if(!u||u.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(d);const f=this._originalEditorLayoutInfo.read(d),g=this._modifiedEditorLayoutInfo.read(d);if(!f||!g){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(d),this._originalViewZonesChangedSignal.read(d);const m=u.map(S=>{function L(H,G){const V=G.getTopForLineNumber(H.startLineNumber,!0),U=G.getTopForLineNumber(H.endLineNumberExclusive,!0);return(V+U)/2}const E=L(S.lineRangeMapping.original,this._editors.original),M=this._originalScrollTop.read(d),R=L(S.lineRangeMapping.modified,this._editors.modified),T=this._modifiedScrollTop.read(d),A=E-M,N=R-T,P=Math.min(E,R),W=Math.max(E,R);return{range:new Ue(P,W),from:A,to:N,fromWithoutScroll:E,toWithoutScroll:R,move:S}});m.sort(sTe(wo(S=>S.fromWithoutScroll>S.toWithoutScroll,ioe),wo(S=>S.fromWithoutScroll>S.toWithoutScroll?S.fromWithoutScroll:-S.toWithoutScroll,aa)));const p=fq.compute(m.map(S=>S.range)),v=10,b=f.verticalScrollbarWidth,w=(p.getTrackCount()-1)*10+v*2,C=b+w+(g.contentLeft-$x.movedCodeBlockPadding);let y=0;for(const S of m){const L=p.getTrack(y),E=b+v+L*10,M=15,R=15,T=C,A=g.glyphMarginWidth+g.lineNumbersWidth,N=18,P=document.createElementNS("http://www.w3.org/2000/svg","rect");P.classList.add("arrow-rectangle"),P.setAttribute("x",`${T-A}`),P.setAttribute("y",`${S.to-N/2}`),P.setAttribute("width",`${A}`),P.setAttribute("height",`${N}`),this._element.appendChild(P);const W=document.createElementNS("http://www.w3.org/2000/svg","g"),H=document.createElementNS("http://www.w3.org/2000/svg","path");H.setAttribute("d",`M 0 ${S.from} L ${E} ${S.from} L ${E} ${S.to} L ${T-R} ${S.to}`),H.setAttribute("fill","none"),W.appendChild(H);const G=document.createElementNS("http://www.w3.org/2000/svg","polygon");G.classList.add("arrow"),d.store.add(lt(V=>{H.classList.toggle("currentMove",S.move===h.activeMovedText.read(V)),G.classList.toggle("currentMove",S.move===h.activeMovedText.read(V))})),G.setAttribute("points",`${T-R},${S.to-M/2} ${T},${S.to} ${T-R},${S.to+M/2}`),W.appendChild(G),this._element.appendChild(W),y++}this.width.set(w,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(Ve(()=>this._element.remove())),this._register(lt(d=>{const h=this._originalEditorLayoutInfo.read(d),u=this._modifiedEditorLayoutInfo.read(d);!h||!u||(this._element.style.left=`${h.width-h.verticalScrollbarWidth}px`,this._element.style.height=`${h.height}px`,this._element.style.width=`${h.verticalScrollbarWidth+h.contentLeft-$x.movedCodeBlockPadding+this.width.read(d)}px`)})),this._register(bw(this._state));const r=ae(d=>{const h=this._diffModel.read(d),u=h==null?void 0:h.diff.read(d);return u?u.movedTexts.map(f=>({move:f,original:new PC(Gi(f.lineRangeMapping.original.startLineNumber-1),18),modified:new PC(Gi(f.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(YR(this._editors.original,r.map(d=>d.map(h=>h.original)))),this._register(YR(this._editors.modified,r.map(d=>d.map(h=>h.modified)))),this._register(Ao((d,h)=>{const u=r.read(d);for(const f of u)h.add(new rQ(this._editors.original,f.original,f.move,"original",this._diffModel.get())),h.add(new rQ(this._editors.modified,f.modified,f.move,"modified",this._diffModel.get()))}));const a=na("original.onDidFocusEditorWidget",d=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0))),l=na("modified.onDidFocusEditorWidget",d=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0)));let c="modified";this._register(e0({changeTracker:{createChangeSummary:()=>{},handleChange:(d,h)=>(d.didChange(a)&&(c="original"),d.didChange(l)&&(c="modified"),!0)}},d=>{a.read(d),l.read(d);const h=this._diffModel.read(d);if(!h)return;const u=h.diff.read(d);let f;if(u&&c==="original"){const g=this._editors.originalCursor.read(d);g&&(f=u.movedTexts.find(m=>m.lineRangeMapping.original.contains(g.lineNumber)))}if(u&&c==="modified"){const g=this._editors.modifiedCursor.read(d);g&&(f=u.movedTexts.find(m=>m.lineRangeMapping.modified.contains(g.lineNumber)))}f!==h.movedTextToCompare.read(void 0)&&h.movedTextToCompare.set(void 0,void 0),h.setActiveMovedText(f)}))}};$x.movedCodeBlockPadding=4;let E1=$x;class fq{static compute(e){const t=[],i=[];for(const n of e){let o=t.findIndex(r=>!r.intersectsStrict(n));o===-1&&(t.length>=6?o=p4e(t,wo(a=>a.intersectWithRangeLength(n),aa)):(o=t.length,t.push(new KU))),t[o].addRange(n),i.push(o)}return new fq(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class rQ extends lq{constructor(e,t,i,n,o){const r=ei("div.diff-hidden-lines-widget");super(e,t,r.root),this._editor=e,this._move=i,this._kind=n,this._diffModel=o,this._nodes=ei("div.diff-moved-code-block",{style:{marginRight:"4px"}},[ei("div.text-content@textContent"),ei("div.action-bar@actionBar")]),r.root.appendChild(this._nodes.root);const a=fi(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(wm(this._nodes.root,{paddingRight:a.map(u=>u.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?_(131,"Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):_(132,"Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?_(133,"Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):_(134,"Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new Fr(this._nodes.actionBar,{highlightToggledItems:!0})),d=new Ga("",l,"",!1);c.push(d,{icon:!1,label:!0});const h=new Ga("","Compare",it.asClassName(ge.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(lt(u=>{const f=this._diffModel.movedTextToCompare.read(u)===i;h.checked=f})),c.push(h,{icon:!1,label:!0})}}class G8e extends K{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=ae(this,o=>{const r=this._diffModel.read(o),a=r==null?void 0:r.diff.read(o);if(!a)return null;const l=this._diffModel.read(o).movedTextToCompare.read(o),c=this._options.renderIndicators.read(o),d=this._options.showEmptyDecorations.read(o),h=[],u=[];if(!l)for(const g of a.mappings)if(g.lineRangeMapping.original.isEmpty||h.push({range:g.lineRangeMapping.original.toInclusiveRange(),options:c?XZ:QZ}),g.lineRangeMapping.modified.isEmpty||u.push({range:g.lineRangeMapping.modified.toInclusiveRange(),options:c?YZ:ZZ}),g.lineRangeMapping.modified.isEmpty||g.lineRangeMapping.original.isEmpty)g.lineRangeMapping.original.isEmpty||h.push({range:g.lineRangeMapping.original.toInclusiveRange(),options:O8e}),g.lineRangeMapping.modified.isEmpty||u.push({range:g.lineRangeMapping.modified.toInclusiveRange(),options:A8e});else{const m=this._options.useTrueInlineDiffRendering.read(o)&&uq(g.lineRangeMapping);for(const p of g.lineRangeMapping.innerChanges||[])if(g.lineRangeMapping.original.contains(p.originalRange.startLineNumber)&&h.push({range:p.originalRange,options:p.originalRange.isEmpty()&&d?F8e:E7}),g.lineRangeMapping.modified.contains(p.modifiedRange.startLineNumber)&&u.push({range:p.modifiedRange,options:p.modifiedRange.isEmpty()&&d&&!m?P8e:JZ}),m){const v=r.model.original.getValueInRange(p.originalRange);u.push({range:p.modifiedRange,options:{description:"deleted-text",before:{content:v,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const g of l.changes){const m=g.original.toInclusiveRange();m&&h.push({range:m,options:c?XZ:QZ});const p=g.modified.toInclusiveRange();p&&u.push({range:p,options:c?YZ:ZZ});for(const v of g.innerChanges||[])h.push({range:v.originalRange,options:E7}),u.push({range:v.modifiedRange,options:JZ})}const f=this._diffModel.read(o).activeMovedText.read(o);for(const g of a.movedTexts)h.push({range:g.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(g===f?" currentMove":""),blockPadding:[E1.movedCodeBlockPadding,0,E1.movedCodeBlockPadding,E1.movedCodeBlockPadding]}}),u.push({range:g.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(g===f?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:h,modifiedDecorations:u}}),this._register(GR(this._editors.original,this._decorations.map(o=>(o==null?void 0:o.originalDecorations)||[]))),this._register(GR(this._editors.modified,this._decorations.map(o=>(o==null?void 0:o.modifiedDecorations)||[])))}}class Ms{static equals(e,t){return e.x===t.x&&e.y===t.y}constructor(e,t){this.x=e,this.y=t}add(e){return new Ms(this.x+e.x,this.y+e.y)}deltaX(e){return new Ms(this.x+e,this.y)}deltaY(e){return new Ms(this.x,this.y+e)}toString(){return`(${this.x},${this.y})`}subtract(e){return new Ms(this.x-e.x,this.y-e.y)}scale(e){return new Ms(this.x*e,this.y*e)}mapComponents(e){return new Ms(e(this.x),e(this.y))}isZero(){return this.x===0&&this.y===0}withThreshold(e){return this.mapComponents(t=>t>e?t-e:t<-e?t+e:0)}}function bn(s){return A7.get(s)}const Jf=class Jf extends K{static get(e){let t=Jf._map.get(e);if(!t){t=new Jf(e),Jf._map.set(e,t);const i=e.onDidDispose(()=>{const n=Jf._map.get(e);n&&(Jf._map.delete(e),n.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new t0(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){var t;super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=ht(this,this.editor.getModel()),this.model=this._model,this.isReadonly=fi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(104)),this._versionId=tx({owner:this,lazy:!0},((t=this.editor.getModel())==null?void 0:t.getVersionId())??null),this.versionId=this._versionId,this._selections=tx({owner:this,equalsFn:Up(bL(Oe.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.positions=_o({owner:this,equalsFn:Up(bL(z.equals))},i=>{var n;return((n=this.selections.read(i))==null?void 0:n.map(o=>o.getStartPosition()))??null}),this.isFocused=fi(this,i=>{const n=this.editor.onDidFocusEditorWidget(i),o=this.editor.onDidBlurEditorWidget(i);return{dispose(){n.dispose(),o.dispose()}}},()=>this.editor.hasWidgetFocus()),this.isTextFocused=fi(this,i=>{const n=this.editor.onDidFocusEditorText(i),o=this.editor.onDidBlurEditorText(i);return{dispose(){n.dispose(),o.dispose()}}},()=>this.editor.hasTextFocus()),this.inComposition=fi(this,i=>{const n=this.editor.onDidCompositionStart(()=>{i(void 0)}),o=this.editor.onDidCompositionEnd(()=>{i(void 0)});return{dispose(){n.dispose(),o.dispose()}}},()=>this.editor.inComposition),this.value=MU(this,i=>{var n;return this.versionId.read(i),((n=this.model.read(i))==null?void 0:n.getValue())??""},(i,n)=>{const o=this.model.get();o!==null&&i!==o.getValue()&&o.setValue(i)}),this.valueIsEmpty=ae(this,i=>{var n;return this.versionId.read(i),((n=this.editor.getModel())==null?void 0:n.getValueLength())===0}),this.cursorSelection=_o({owner:this,equalsFn:Up(Oe.selectionsEqual)},i=>{var n;return((n=this.selections.read(i))==null?void 0:n[0])??null}),this.cursorPosition=_o({owner:this,equalsFn:z.equals},i=>{var n,o;return((o=(n=this.selections.read(i))==null?void 0:n[0])==null?void 0:o.getPosition())??null}),this.cursorLineNumber=ae(this,i=>{var n;return((n=this.cursorPosition.read(i))==null?void 0:n.lineNumber)??null}),this.onDidType=xl(this),this.onDidPaste=xl(this),this.scrollTop=fi(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=fi(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=fi(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(i=>i.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(i=>i.decorationsLeft),this.layoutInfoWidth=this.layoutInfo.map(i=>i.width),this.layoutInfoHeight=this.layoutInfo.map(i=>i.height),this.layoutInfoMinimap=this.layoutInfo.map(i=>i.minimap),this.layoutInfoVerticalScrollbarWidth=this.layoutInfo.map(i=>i.verticalScrollbarWidth),this.contentWidth=fi(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this.contentHeight=fi(this.editor.onDidContentSizeChange,()=>this.editor.getContentHeight()),this._widgetCounter=0,this.openedPeekWidgets=ht(this,0),this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidPaste(i=>{this._beginUpdate();try{this._forceUpdate(),this.onDidPaste.trigger(this._currentTransaction,i)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(i=>{var n;this._beginUpdate();try{this._versionId.set(((n=this.editor.getModel())==null?void 0:n.getVersionId())??null,this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(i=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,i),this._forceUpdate()}finally{this._endUpdate()}})),this.domNode=ae(i=>(this.model.read(i),this.editor.getDomNode()))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){var e;this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(((e=this.editor.getModel())==null?void 0:e.getVersionId())??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e,t=Ls.ofCaller()){return fi(this,i=>this.editor.onDidChangeConfiguration(n=>{n.hasChanged(e)&&i(void 0)}),()=>this.editor.getOption(e),t)}setDecorations(e){const t=new oe,i=this.editor.createDecorationsCollection();return t.add(bO({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const o=e.read(n);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._widgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const n=lt(o=>{e.position.read(o),e.minContentWidthInPx.read(o),this.editor.layoutOverlayWidget(i)});return Ve(()=>{n.dispose(),this.editor.removeOverlayWidget(i)})}createContentWidget(e){const t="observableContentWidget"+this._widgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow};this.editor.addContentWidget(i);const n=lt(o=>{e.position.read(o),this.editor.layoutContentWidget(i)});return Ve(()=>{n.dispose(),this.editor.removeContentWidget(i)})}observeLineOffsetRange(e,t){const i=this.observePosition(e.map(o=>new z(o.startLineNumber,1)),t),n=this.observePosition(e.map(o=>new z(o.endLineNumberExclusive+1,1)),t);return ae(o=>{var d;i.read(o),n.read(o);const r=e.read(o),a=(d=this.model.read(o))==null?void 0:d.getLineCount(),l=(typeof a<"u"&&r.startLineNumber>a?this.editor.getBottomForLineNumber(a):this.editor.getTopForLineNumber(r.startLineNumber))-this.scrollTop.read(o),c=r.isEmpty?l:this.editor.getBottomForLineNumber(r.endLineNumberExclusive-1)-this.scrollTop.read(o);return new Ue(l,c)})}observePosition(e,t){let i=e.get();const n=tx({owner:this,debugName:()=>`topLeftOfPosition${i==null?void 0:i.toString()}`,equalsFn:Up(Ms.equals)},new Ms(0,0)),o="observablePositionWidget"+this._widgetCounter++,r=document.createElement("div"),a={getDomNode:()=>r,getPosition:()=>i?{preference:[0],position:e.get()}:null,getId:()=>o,allowEditorOverflow:!1,afterRender:(l,c)=>{const d=this._model.get();d&&i&&i.lineNumber>d.getLineCount()?n.set(new Ms(0,this.editor.getBottomForLineNumber(d.getLineCount())-this.scrollTop.get()),void 0):n.set(c?new Ms(c.left,c.top):null,void 0)}};return this.editor.addContentWidget(a),t.add(lt(l=>{i=e.read(l),this.editor.layoutContentWidget(a)})),t.add(Ve(()=>{this.editor.removeContentWidget(a)})),n}isTargetHovered(e,t){const i=ht("isInjectedTextHovered",!1);return t.add(this.editor.onMouseMove(n=>{const o=e(n);i.set(o,void 0)})),t.add(this.editor.onMouseLeave(n=>{i.set(!1,void 0)})),i}observeLineHeightForPosition(e){return ae(t=>{const i=e instanceof z?e:e.read(t);return i===null?null:(this.getOption(75).read(t),this.editor.getLineHeightForPosition(i))})}observeLineHeightForLine(e){return typeof e=="number"?this.observeLineHeightForPosition(new z(e,1)):ae(t=>{const i=e.read(t);return i===null?null:this.observeLineHeightForPosition(new z(i,1)).read(t)})}observeLineHeightsForLineRange(e){return ae(t=>{const i=e instanceof dt?e:e.read(t),n=[];for(let o=i.startLineNumber;o<i.endLineNumberExclusive;o++)n.push(this.observeLineHeightForLine(o).read(t));return n})}};Jf._map=new Map;let A7=Jf;var Y8e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},X8e=function(s,e){return function(t,i){e(t,i,s)}},kc,$u;let aI=($u=class extends K{constructor(e,t,i,n,o,r,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=n,this._rootHeight=o,this._modifiedEditorLayoutInfo=r,this._themeService=a,this.width=kc.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=fi(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=ae(u=>{const f=l.read(u),g=f.getColor(KMe)||(f.getColor(Kp)||hB).transparent(2),m=f.getColor(GMe)||(f.getColor(yg)||uB).transparent(2);return{insertColor:g,removeColor:m}}),d=gi(document.createElement("div"));d.setClassName("diffViewport"),d.setPosition("absolute");const h=ei("div.diffOverview",{style:{position:"absolute",top:"0px",width:kc.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(AC(h,d.domNode)),this._register(Jn(h,ye.POINTER_DOWN,u=>{this._editors.modified.delegateVerticalScrollbarPointerDown(u)})),this._register(ee(h,ye.MOUSE_WHEEL,u=>{this._editors.modified.delegateScrollFromMouseWheelEvent(u)},{passive:!1})),this._register(AC(this._rootElement,h)),this._register(Ao((u,f)=>{const g=this._diffModel.read(u),m=this._editors.original.createOverviewRuler("original diffOverviewRuler");m&&(f.add(m),f.add(AC(h,m.getDomNode())));const p=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(p&&(f.add(p),f.add(AC(h,p.getDomNode()))),!m||!p)return;const v=na("viewZoneChanged",this._editors.original.onDidChangeViewZones),b=na("viewZoneChanged",this._editors.modified.onDidChangeViewZones),w=na("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),C=na("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);f.add(lt(y=>{var R;v.read(y),b.read(y),w.read(y),C.read(y);const x=c.read(y),S=(R=g==null?void 0:g.diff.read(y))==null?void 0:R.mappings;function L(T,A,N){const P=N._getViewModel();return P?T.filter(W=>W.length>0).map(W=>{const H=P.coordinatesConverter.convertModelPositionToViewPosition(new z(W.startLineNumber,1)),G=P.coordinatesConverter.convertModelPositionToViewPosition(new z(W.endLineNumberExclusive,1)),V=G.lineNumber-H.lineNumber;return new mae(H.lineNumber,G.lineNumber,V,A.toString())}):[]}const E=L((S||[]).map(T=>T.lineRangeMapping.original),x.removeColor,this._editors.original),M=L((S||[]).map(T=>T.lineRangeMapping.modified),x.insertColor,this._editors.modified);m==null||m.setZones(E),p==null||p.setZones(M)})),f.add(lt(y=>{const x=this._rootHeight.read(y),S=this._rootWidth.read(y),L=this._modifiedEditorLayoutInfo.read(y);if(L){const E=kc.ENTIRE_DIFF_OVERVIEW_WIDTH-2*kc.ONE_OVERVIEW_WIDTH;m.setLayout({top:0,height:x,right:E+kc.ONE_OVERVIEW_WIDTH,width:kc.ONE_OVERVIEW_WIDTH}),p.setLayout({top:0,height:x,right:0,width:kc.ONE_OVERVIEW_WIDTH});const M=this._editors.modifiedScrollTop.read(y),R=this._editors.modifiedScrollHeight.read(y),T=this._editors.modified.getOption(117),A=new Ew(T.verticalHasArrows?T.arrowSize:0,T.verticalScrollbarSize,0,L.height,R,M);d.setTop(A.getSliderPosition()),d.setHeight(A.getSliderSize())}else d.setTop(0),d.setHeight(0);h.style.height=x+"px",h.style.left=S-kc.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",d.setWidth(kc.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}},kc=$u,$u.ONE_OVERVIEW_WIDTH=15,$u.ENTIRE_DIFF_OVERVIEW_WIDTH=$u.ONE_OVERVIEW_WIDTH*2,$u);aI=kc=Y8e([X8e(6,Dn)],aI);var Z8e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},MF=function(s,e){return function(t,i){e(t,i,s)}};let P7=class extends K{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,n,o,r,a,l){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=n,this._createInnerEditor=o,this._contextKeyService=r,this._instantiationService=a,this._keybindingService=l,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new q),this.modifiedScrollTop=fi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=fi(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=bn(this.modified),this.originalObs=bn(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=fi(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=_o({owner:this,equalsFn:z.equals},c=>{var d;return((d=this.modifiedSelections.read(c)[0])==null?void 0:d.getPosition())??new z(1,1)}),this.originalCursor=fi(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new z(1,1)),this.isOriginalFocused=bn(this.original).isFocused,this.isModifiedFocused=bn(this.modified).isFocused,this.isFocused=ae(this,c=>this.isOriginalFocused.read(c)||this.isModifiedFocused.read(c)),this._argCodeEditorWidgetOptions=null,this._register(e0({changeTracker:{createChangeSummary:()=>({}),handleChange:(c,d)=>(c.didChange(i.editorOptions)&&Object.assign(d,c.change.changedOptions),!0)}},(c,d)=>{i.editorOptions.read(c),this._options.renderSideBySide.read(c),this.modified.updateOptions(this._adjustOptionsForRightHandSide(c,d)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(c,d))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t),o=this._contextKeyService.createKey("isInDiffLeftEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget(()=>o.set(!0))),this._register(n.onDidBlurEditorWidget(()=>o.set(!1))),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t),o=this._contextKeyService.createKey("isInDiffRightEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget(()=>o.set(!0))),this._register(n.onDidBlurEditorWidget(()=>o.set(!1))),n}_constructInnerEditor(e,t,i,n){const o=this._createInnerEditor(e,t,i,n);return this._register(o.onDidContentSizeChange(r=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+aI.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:r.contentHeightChanged,contentWidthChanged:r.contentWidthChanged})})),o}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Go.revealHorizontalRightPadding.defaultValue+aI.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.allowVariableLineHeights=!1,t.allowVariableFonts=!1,t.allowVariableFontsInAccessibilityMode=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var i;e||(e="");const t=_(111," use {0} to open the accessibility help.",(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))==null?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};P7=Z8e([MF(5,ut),MF(6,$e),MF(7,ai)],P7);var m0=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};const Q8e=!1;var e2;(function(s){s.North="north",s.South="south",s.East="east",s.West="west"})(e2||(e2={}));let J8e=4;const e6e=new q;let t6e=300;const i6e=new q;class gq{constructor(e){this.el=e,this.disposables=new oe}get onPointerMove(){return this.disposables.add(new Si(je(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new Si(je(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}m0([Kn],gq.prototype,"onPointerMove",null);m0([Kn],gq.prototype,"onPointerUp",null);class mq{get onPointerMove(){return this.disposables.add(new Si(this.el,Qi.Change)).event}get onPointerUp(){return this.disposables.add(new Si(this.el,Qi.End)).event}constructor(e){this.el=e,this.disposables=new oe}dispose(){this.disposables.dispose()}}m0([Kn],mq.prototype,"onPointerMove",null);m0([Kn],mq.prototype,"onPointerUp",null);class t2{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}m0([Kn],t2.prototype,"onPointerMove",null);m0([Kn],t2.prototype,"onPointerUp",null);const aQ="pointer-events-disabled";class Eo extends K{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}get onDidStart(){return this._onDidStart.event}get onDidChange(){return this._onDidChange.event}get onDidReset(){return this._onDidReset.event}get onDidEnd(){return this._onDidEnd.event}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=me(this.el,we(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Ve(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(ee(this._orthogonalStartDragHandle,"mouseenter",()=>Eo.onMouseEnter(e))),this.orthogonalStartDragHandleDisposables.add(ee(this._orthogonalStartDragHandle,"mouseleave",()=>Eo.onMouseLeave(e))))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=me(this.el,we(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Ve(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(ee(this._orthogonalEndDragHandle,"mouseenter",()=>Eo.onMouseEnter(e))),this.orthogonalEndDragHandleDisposables.add(ee(this._orthogonalEndDragHandle,"mouseleave",()=>Eo.onMouseLeave(e))))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=t6e,this.hoverDelayer=this._register(new Pl(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new q),this._onDidStart=this._register(new q),this._onDidChange=this._register(new q),this._onDidReset=this._register(new q),this._onDidEnd=this._register(new q),this.orthogonalStartSashDisposables=this._register(new oe),this.orthogonalStartDragHandleDisposables=this._register(new oe),this.orthogonalEndSashDisposables=this._register(new oe),this.orthogonalEndDragHandleDisposables=this._register(new oe),this.linkedSash=void 0,this.el=me(e,we(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),Bt&&this.el.classList.add("mac"),this._register(ee(this.el,"mousedown",o=>this.onPointerStart(o,new gq(e)))),this._register(ee(this.el,"dblclick",o=>this.onPointerDoublePress(o))),this._register(ee(this.el,"mouseenter",()=>Eo.onMouseEnter(this))),this._register(ee(this.el,"mouseleave",()=>Eo.onMouseLeave(this))),this._register(Oo.addTarget(this.el)),this._register(ee(this.el,Qi.Start,o=>this.onPointerStart(o,new mq(this.el))));let n;this._register(ee(this.el,Qi.Tap,o=>{if(n){clearTimeout(n),n=void 0,this.onPointerDoublePress(o);return}clearTimeout(n),n=setTimeout(()=>n=void 0,250)})),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=J8e,this._register(e6e.event(o=>{this.size=o,this.layout()}))),this._register(i6e.event(o=>this.hoverDelay=o)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",Q8e),this.layout()}onPointerStart(e,t){ri.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const g=this.getOrthogonalSash(e);g&&(i=!0,e.__orthogonalSashEvent=!0,g.onPointerStart(e,new t2(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new t2(t))),!this.state)return;const n=this.el.ownerDocument.getElementsByTagName("iframe");for(const g of n)g.classList.add(aQ);const o=e.pageX,r=e.pageY,a=e.altKey,l={startX:o,currentX:o,startY:r,currentY:r,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=Hl(this.el),d=()=>{let g="";i?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=Bt?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=Bt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${g} !important; }`},h=new oe;d(),i||this.onDidEnablementChange.event(d,null,h);const u=g=>{ri.stop(g,!1);const m={startX:o,currentX:g.pageX,startY:r,currentY:g.pageY,altKey:a};this._onDidChange.fire(m)},f=g=>{ri.stop(g,!1),c.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),h.dispose();for(const m of n)m.classList.remove(aQ)};t.onPointerMove(u,null,h),t.onPointerUp(f,null,h),h.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&Eo.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&Eo.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){Eo.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){const t=e.initialTarget??e.target;if(!(!t||!Bn(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}class n6e{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=MU(this,i=>{const n=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(n,i)},(i,n)=>{const o=this.dimensions.width.get();this._sashRatio.set(i/o,n)}),this._sashRatio=ht(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),o=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,r=100;return i<=r*2?n:o<r?r:o>i-r?i-r:o}}class rce extends K{constructor(e,t,i,n,o,r){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=n,this.sashLeft=o,this._resetSash=r,this._sash=this._register(new Eo(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(lt(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register(lt(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}const NA=class NA extends K{constructor(){super(...arguments),this._id=++NA.idCounter,this._onDidDispose=this._register(new q),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};NA.idCounter=0;let O7=NA;const ao={enableSplitViewResizing:!0,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1};function s6e(s,e){return Ef(s,(t,i)=>i??e(t))}var o6e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},r6e=function(s,e){return function(t,i){e(t,i,s)}};let F7=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=ht(this,0),this._screenReaderMode=fi(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=ae(this,n=>this._options.read(n).renderSideBySide&&this._diffEditorWidth.read(n)<=this._options.read(n).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=ae(this,n=>this._options.read(n).renderOverviewRuler),this.renderSideBySide=ae(this,n=>this.compactMode.read(n)&&this.shouldRenderInlineViewInSmartMode.read(n)?!1:this._options.read(n).renderSideBySide&&!(this._options.read(n).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(n)&&!this._screenReaderMode.read(n))),this.readOnly=ae(this,n=>this._options.read(n).readOnly),this.shouldRenderOldRevertArrows=ae(this,n=>!(!this._options.read(n).renderMarginRevertIcon||!this.renderSideBySide.read(n)||this.readOnly.read(n)||this.shouldRenderGutterMenu.read(n))),this.shouldRenderGutterMenu=ae(this,n=>this._options.read(n).renderGutterMenu),this.renderIndicators=ae(this,n=>this._options.read(n).renderIndicators),this.enableSplitViewResizing=ae(this,n=>this._options.read(n).enableSplitViewResizing),this.splitViewDefaultRatio=ae(this,n=>this._options.read(n).splitViewDefaultRatio),this.ignoreTrimWhitespace=ae(this,n=>this._options.read(n).ignoreTrimWhitespace),this.maxComputationTimeMs=ae(this,n=>this._options.read(n).maxComputationTime),this.showMoves=ae(this,n=>this._options.read(n).experimental.showMoves&&this.renderSideBySide.read(n)),this.isInEmbeddedEditor=ae(this,n=>this._options.read(n).isInEmbeddedEditor),this.diffWordWrap=ae(this,n=>this._options.read(n).diffWordWrap),this.originalEditable=ae(this,n=>this._options.read(n).originalEditable),this.diffCodeLens=ae(this,n=>this._options.read(n).diffCodeLens),this.accessibilityVerbose=ae(this,n=>this._options.read(n).accessibilityVerbose),this.diffAlgorithm=ae(this,n=>this._options.read(n).diffAlgorithm),this.showEmptyDecorations=ae(this,n=>this._options.read(n).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=ae(this,n=>this._options.read(n).onlyShowAccessibleDiffViewer),this.compactMode=ae(this,n=>this._options.read(n).compactMode),this.trueInlineDiffRenderingEnabled=ae(this,n=>this._options.read(n).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=ae(this,n=>!this.renderSideBySide.read(n)&&this.trueInlineDiffRenderingEnabled.read(n)),this.hideUnchangedRegions=ae(this,n=>this._options.read(n).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=ae(this,n=>this._options.read(n).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=ae(this,n=>this._options.read(n).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=ae(this,n=>this._options.read(n).hideUnchangedRegions.minimumLineCount),this._model=ht(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,n=>s6e(this,o=>{const r=n==null?void 0:n.diff.read(o);return r?a6e(r,this.trueInlineDiffRenderingEnabled.read(o)):void 0})).flatten().map(this,n=>!!n),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...lQ(e,ao)};this._options=ht(this,i)}updateOptions(e){const t=lQ(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};F7=o6e([r6e(1,so)],F7);function a6e(s,e){return s.mappings.every(t=>l6e(t.lineRangeMapping)||c6e(t.lineRangeMapping)||e&&uq(t.lineRangeMapping))}function l6e(s){return s.original.length===0}function c6e(s){return s.modified.length===0}function lQ(s,e){var t,i,n,o,r,a,l,c;return{enableSplitViewResizing:Ye(s.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:v2e(s.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:Ye(s.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:Ye(s.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:_u(s.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:_u(s.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:Ye(s.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:Ye(s.renderIndicators,e.renderIndicators),originalEditable:Ye(s.originalEditable,e.originalEditable),diffCodeLens:Ye(s.diffCodeLens,e.diffCodeLens),renderOverviewRuler:Ye(s.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:nn(s.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:nn(s.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:Ye(s.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:Ye((t=s.experimental)==null?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:Ye((i=s.experimental)==null?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:Ye((n=s.experimental)==null?void 0:n.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:Ye(((o=s.hideUnchangedRegions)==null?void 0:o.enabled)??((r=s.experimental)==null?void 0:r.collapseUnchangedRegions),e.hideUnchangedRegions.enabled),contextLineCount:_u((a=s.hideUnchangedRegions)==null?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:_u((l=s.hideUnchangedRegions)==null?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:_u((c=s.hideUnchangedRegions)==null?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:Ye(s.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:Ye(s.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:_u(s.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:Ye(s.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:Ye(s.renderGutterMenu,e.renderGutterMenu),compactMode:Ye(s.compactMode,e.compactMode)}}class d6e extends Mb{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new q),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=me(e,we(".monaco-dropdown")),this._label=me(this._element,we(".dropdown-label"));let i=t.labelRenderer;i||(i=o=>(o.textContent=t.label||"",null));for(const o of[ye.CLICK,ye.MOUSE_DOWN,Qi.Tap])this._register(ee(this.element,o,r=>ri.stop(r,!0)));for(const o of[ye.MOUSE_DOWN,Qi.Tap])this._register(ee(this._label,o,r=>{BU(r)&&r.button!==0||(this.visible?this.hide():this.show())}));this._register(ee(this._label,ye.KEY_DOWN,o=>{const r=new Bi(o);(r.equals(3)||r.equals(10))&&(ri.stop(o,!0),this.visible?this.hide():this.show())}));const n=i(this._label);n&&this._register(n),this._register(Oo.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class h6e extends d6e{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class i2 extends qc{get onDidChangeVisibility(){return this._onDidChangeVisibility.event}constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new q),this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=o=>(this.element=me(o,we("a.action-label")),this.renderLabel(this.element)),i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new h6e(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(o=>{var r;(r=this.element)==null||r.setAttribute("aria-expanded",`${o}`),this._onDidChangeVisibility.fire(o)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const o=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return o.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}renderLabel(e){let t=[];return typeof this.options.classNames=="string"?t=this.options.classNames.split(/\s+/g).filter(i=>!!i):this.options.classNames&&(t=this.options.classNames),t.find(i=>i==="icon")||t.push("codicon"),e.classList.add(...t),this._action.label&&this._register(yc().setupManagedHover(this.options.hoverDelegate??Fh("mouse"),e,this._action.label)),null}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){var e;(e=this.dropdownMenu)==null||e.show()}updateEnabled(){var t,i;const e=!this.action.enabled;(t=this.actionItem)==null||t.classList.toggle("disabled",e),(i=this.element)==null||i.classList.toggle("disabled",e)}}const cQ=24;class u6e extends K{get onDidChangeDropdownVisibility(){return this._onDidChangeDropdownVisibility.event}constructor(e,t,i={orientation:0}){if(super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new Qke),this.originalPrimaryActions=[],this.originalSecondaryActions=[],this.hiddenActions=[],this.disposables=this._register(new oe),i.hoverDelegate=i.hoverDelegate??this._register(sle()),this.options=i,this.toggleMenuAction=this._register(new lI(()=>{var n;return(n=this.toggleMenuActionViewItem)==null?void 0:n.show()},i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Fr(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,o)=>{if(n.id===lI.ID)return this.toggleMenuActionViewItem=new i2(n,{getActions:()=>this.toggleMenuAction.menuActions},t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:it.asClassNameArray(i.moreIcon??ge.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const r=i.actionViewItemProvider(n,o);if(r)return r}if(n instanceof vw){const r=new i2(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return r.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(r),this.disposables.add(this._onDidChangeDropdownVisibility.add(r.onDidChangeVisibility)),r}}})),this.options.responsive){this.element.classList.add("responsive");const n=new ResizeObserver(()=>{this.setToolbarMaxWidth(this.element.getBoundingClientRect().width)});n.observe(this.element),this._store.add(Ve(()=>n.disconnect()))}}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}set context(e){var t;this.actionBar.context=e,(t=this.toggleMenuActionViewItem)==null||t.setActionContext(e);for(const i of this.submenuActionViewItems)i.setActionContext(e)}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}getItemWidth(e){return this.actionBar.getWidth(e)}setActions(e,t){this.clear(),this.originalPrimaryActions=e?e.slice(0):[],this.originalSecondaryActions=t?t.slice(0):[];const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.length>0&&this.options.trailingSeparator&&i.push(new _s),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})}),this.options.responsive&&(this.hiddenActions.length=0,this.setToolbarMaxWidth(this.element.getBoundingClientRect().width))}getKeybindingLabel(e){var i,n;const t=(n=(i=this.options).getKeyBinding)==null?void 0:n.call(i,e);return(t==null?void 0:t.getLabel())??void 0}getItemsWidthResponsive(){return this.actionBar.length()*cQ}setToolbarMaxWidth(e){if(this.actionBar.isEmpty()||this.getItemsWidthResponsive()<=e&&this.hiddenActions.length===0)return;if(this.getItemsWidthResponsive()>e)for(;this.getItemsWidthResponsive()>e&&this.actionBar.length()>0;){const i=this.originalPrimaryActions.length-this.hiddenActions.length-1;if(i<0)break;const n=Math.min(cQ,this.getItemWidth(i)),o=this.originalPrimaryActions[i];this.hiddenActions.unshift({action:o,size:n}),this.actionBar.pull(i),this.originalSecondaryActions.length===0&&this.hiddenActions.length===1&&this.actionBar.push(this.toggleMenuAction,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(this.toggleMenuAction)})}else for(;this.hiddenActions.length>0;){const i=this.hiddenActions.shift();if(this.getItemsWidthResponsive()+i.size>e){this.hiddenActions.unshift(i);break}this.actionBar.push(i.action,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(i.action),index:this.originalPrimaryActions.length-this.hiddenActions.length-1}),this.originalSecondaryActions.length===0&&this.hiddenActions.length===1&&(this.toggleMenuAction.menuActions=[],this.actionBar.pull(this.actionBar.length()-1))}const t=this.hiddenActions.map(i=>i.action);if(this.originalSecondaryActions.length>0||t.length>0){const i=this.originalSecondaryActions.slice(0);this.toggleMenuAction.menuActions=_s.join(t,i)}}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}const RA=class RA extends Ga{constructor(e,t){t=t||_(17,"More Actions..."),super(RA.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};RA.ID="toolbar.toggle.more";let lI=RA;class h4{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const n=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=i(a);if(l===null)return null;n[o]=p6e(a,l,this.modifierLabels[e])}return n.join(" ")}}const pq=new h4({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:_(35,"Ctrl"),shiftKey:_(36,"Shift"),altKey:_(37,"Alt"),metaKey:_(38,"Windows"),separator:"+"},{ctrlKey:_(39,"Ctrl"),shiftKey:_(40,"Shift"),altKey:_(41,"Alt"),metaKey:_(42,"Super"),separator:"+"}),f6e=new h4({ctrlKey:_(43,"Control"),shiftKey:_(44,"Shift"),altKey:_(45,"Option"),metaKey:_(46,"Command"),separator:"+"},{ctrlKey:_(47,"Control"),shiftKey:_(48,"Shift"),altKey:_(49,"Alt"),metaKey:_(50,"Windows"),separator:"+"},{ctrlKey:_(51,"Control"),shiftKey:_(52,"Shift"),altKey:_(53,"Alt"),metaKey:_(54,"Super"),separator:"+"}),g6e=new h4({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),m6e=new h4({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function p6e(s,e,t){if(e===null)return"";const i=[];return s.ctrlKey&&i.push(t.ctrlKey),s.shiftKey&&i.push(t.shiftKey),s.altKey&&i.push(t.altKey),s.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}function _6e(s){return!!s&&typeof s=="object"&&typeof s.original=="string"&&typeof s.value=="string"}function b6e(s){return s?s.condition!==void 0:!1}var k1;(function(s){s[s.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",s[s.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(k1||(k1={}));var yp;(function(s){s[s.None=0]="None",s[s.Initialized=1]="Initialized",s[s.Closed=2]="Closed"})(yp||(yp={}));const MA=class MA extends K{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new Nb),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=yp.None,this.cache=new Map,this.flushDelayer=this._register(new Mse(MA.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)==null||t.forEach((n,o)=>this.acceptExternal(o,n)),(i=e.deleted)==null||i.forEach(n=>this.acceptExternal(n,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===yp.Closed)return;let i=!1;vl(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return vl(i)?t:i}getBoolean(e,t){const i=this.get(e);return vl(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return vl(i)?t:parseInt(i,10)}async set(e,t,i=!1){if(this.state===yp.Closed)return;if(vl(t))return this.delete(e,i);const n=ws(t)||Array.isArray(t)?T7e(t):String(t);if(this.cache.get(e)!==n)return this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===yp.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())==null||t()})}async flush(e){if(!(this.state===yp.Closed||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===k1.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}};MA.DEFAULT_FLUSH_DELAY=100;let dx=MA;class AF{constructor(){this.onDidChangeItemsExternal=Se.None,this.items=new Map}async updateItems(e){var t,i;(t=e.insert)==null||t.forEach((n,o)=>this.items.set(o,n)),(i=e.delete)==null||i.forEach(n=>this.items.delete(n))}}const eN="__$__targetStorageMarker",sr=Mt("storageService");var Vg;(function(s){s[s.NONE=0]="NONE",s[s.SHUTDOWN=1]="SHUTDOWN"})(Vg||(Vg={}));function v6e(s){const e=s.get(eN);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const AA=class AA extends K{constructor(e={flushInterval:AA.DEFAULT_FLUSH_INTERVAL}){super(),this._onDidChangeValue=this._register(new Nb),this._onDidChangeTarget=this._register(new Nb),this._onWillSaveState=this._register(new q),this.onWillSaveState=this._onWillSaveState.event,this.runFlushWhenIdle=this._register(new mi),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0,this.flushWhenIdleScheduler=this._register(new Ni(()=>this.doFlushWhenIdle(),e.flushInterval))}onDidChangeValue(e,t,i){return Se.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=bU(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}emitDidChangeValue(e,t){const{key:i,external:n}=t;if(i===eN){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:n})}get(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.get(e,i)}getBoolean(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getBoolean(e,i)}getNumber(e,t,i){var n;return(n=this.getStorage(t))==null?void 0:n.getNumber(e,i)}store(e,t,i,n,o=!1){if(vl(t)){this.remove(e,i,o);return}this.withPausedEmitters(()=>{var r;this.updateKeyTarget(e,i,n),(r=this.getStorage(i))==null||r.set(e,t,o)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var n;this.updateKeyTarget(e,t,void 0),(n=this.getStorage(t))==null||n.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,n=!1){var r,a;const o=this.getKeyTargets(t);typeof i=="number"?o[e]!==i&&(o[e]=i,(r=this.getStorage(t))==null||r.set(eN,JSON.stringify(o),n)):typeof o[e]=="number"&&(delete o[e],(a=this.getStorage(t))==null||a.set(eN,JSON.stringify(o),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?v6e(t):Object.create(null)}async flush(e=Vg.NONE){this._onWillSaveState.fire({reason:e});const t=this.getStorage(-1),i=this.getStorage(0),n=this.getStorage(1);switch(e){case Vg.NONE:await mL.settled([(t==null?void 0:t.whenFlushed())??Promise.resolve(),(i==null?void 0:i.whenFlushed())??Promise.resolve(),(n==null?void 0:n.whenFlushed())??Promise.resolve()]);break;case Vg.SHUTDOWN:await mL.settled([(t==null?void 0:t.flush(0))??Promise.resolve(),(i==null?void 0:i.flush(0))??Promise.resolve(),(n==null?void 0:n.flush(0))??Promise.resolve()]);break}}};AA.DEFAULT_FLUSH_INTERVAL=60*1e3;let B7=AA;class C6e extends B7{constructor(){super(),this.applicationStorage=this._register(new dx(new AF,{hint:k1.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new dx(new AF,{hint:k1.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new dx(new AF,{hint:k1.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}shouldFlushWhenIdle(){return!1}}function w6e(s,e){const t={...e};for(const i in s){const n=s[i];t[i]=n!==void 0?ve(n):void 0}return t}const ace={keybindingLabelBackground:ve(TAe),keybindingLabelForeground:ve(NAe),keybindingLabelBorder:ve(RAe),keybindingLabelBottomBorder:ve(MAe),keybindingLabelShadow:ve(c0)},y6e={buttonForeground:ve(GO),buttonSeparator:ve(_Ae),buttonBackground:ve(Gp),buttonHoverBackground:ve(bAe),buttonSecondaryForeground:ve(Lre),buttonSecondaryBackground:ve(bR),buttonSecondaryHoverBackground:ve(CAe),buttonBorder:ve(vAe)},S6e={progressBarBackground:ve(MMe)},n2={inputActiveOptionBorder:ve(mk),inputActiveOptionForeground:ve(pk),inputActiveOptionBackground:ve(d0)};ve(CS),ve(wAe),ve(yAe),ve(SAe),ve(xAe),ve(LAe),ve(IAe);const _q={checkboxBackground:ve(f$),checkboxBorder:ve(EAe),checkboxForeground:ve(g$),checkboxDisabledBackground:ve(kAe),checkboxDisabledForeground:ve(DAe)};ve(ja),ve($O),ve(c0),ve(c$),ve(QMe),ve(JMe),ve(eAe),ve(NMe);const s2={inputBackground:ve(_B),inputForeground:ve(Sre),inputBorder:ve(xre),inputValidationInfoBorder:ve(cAe),inputValidationInfoBackground:ve(aAe),inputValidationInfoForeground:ve(lAe),inputValidationWarningBorder:ve(uAe),inputValidationWarningBackground:ve(dAe),inputValidationWarningForeground:ve(hAe),inputValidationErrorBorder:ve(mAe),inputValidationErrorBackground:ve(fAe),inputValidationErrorForeground:ve(gAe)},x6e={listFilterWidgetBackground:ve(jAe),listFilterWidgetOutline:ve(KAe),listFilterWidgetNoMatchesOutline:ve(GAe),listFilterWidgetShadow:ve(YAe),inputBoxStyles:s2,toggleStyles:n2},lce={badgeBackground:ve(KT),badgeForeground:ve(RMe),badgeBorder:ve(Yt)};ve(XMe),ve(YMe),ve(UY),ve(UY),ve(ZMe);const p0={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:ve(AAe),listFocusForeground:ve(PAe),listFocusOutline:ve(OAe),listActiveSelectionBackground:ve(Ob),listActiveSelectionForeground:ve(AL),listActiveSelectionIconForeground:ve(Ire),listFocusAndSelectionOutline:ve(FAe),listFocusAndSelectionBackground:ve(Ob),listFocusAndSelectionForeground:ve(AL),listInactiveSelectionBackground:ve(BAe),listInactiveSelectionIconForeground:ve(HAe),listInactiveSelectionForeground:ve(WAe),listInactiveFocusBackground:ve(VAe),listInactiveFocusOutline:ve(zAe),listHoverBackground:ve(Ere),listHoverForeground:ve(kre),listDropOverBackground:ve(UAe),listDropBetweenBackground:ve($Ae),listSelectionOutline:ve(fn),listHoverOutline:ve(fn),treeIndentGuidesStroke:ve(Dre),treeInactiveIndentGuidesStroke:ve(XAe),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:ve(UO),tableColumnsBorder:ve(ZAe),tableOddRowsBackgroundColor:ve(QAe)};function Lv(s){return w6e(s,p0)}const L6e={selectBackground:ve(KO),selectListBackground:ve(pAe),selectForeground:ve(h$),decoratorRightForeground:ve(Tre),selectBorder:ve(u$),focusBorder:ve(xh),listFocusBackground:ve(OL),listInactiveSelectionIconForeground:ve(m$),listFocusForeground:ve(PL),listFocusOutline:ure(fn,re.transparent.toString()),listHoverBackground:ve(Ere),listHoverForeground:ve(kre),listHoverOutline:ve(fn),selectListBorder:ve(s$),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},I6e={shadowColor:ve(c0),borderColor:ve(ePe),foregroundColor:ve(tPe),backgroundColor:ve(iPe),selectionForegroundColor:ve(nPe),selectionBackgroundColor:ve(sPe),selectionBorderColor:ve(oPe),separatorColor:ve(rPe),scrollbarShadow:ve(UO),scrollbarSliderBackground:ve(_re),scrollbarSliderHoverBackground:ve(bre),scrollbarSliderActiveBackground:ve(vre)};function E6e(s,e){if(Ah)return!1;const t=k6e(s,e),i=s.getValue("window");return(i==null?void 0:i.menuStyle)==="native"?!(!Bt&&!t):(i==null?void 0:i.menuStyle)==="custom"?!1:t}function k6e(s,e){return e||(e=cce(s)),e==="native"}function cce(s){if(Ah)return"custom";const e=s.getValue("window");if(e){if(Bt&&e.nativeTabs===!0||Bt&&e.nativeFullScreen===!1)return"native";const n=e.titleBarStyle;if(n==="native"||n==="custom")return n}return"custom"}function D6e(s){if(Ah||Bt||cce(s)==="native")return"native";const e=s.getValue("window"),t=e==null?void 0:e.controlsStyle;return t==="custom"||t==="hidden"?t:"native"}var u4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},mr=function(s,e){return function(t,i){e(t,i,s)}};function T6e(s,e){const t=[];return N6e(s,t),t}function N6e(s,e,t){const i=Au.getInstance(),n=i.keyStatus.altKey||(no||Hr)&&i.keyStatus.shiftKey;uce(s,e,n,o=>o==="navigation")}function dce(s,e,t,i){const n={primary:[],secondary:[]};return hce(s,n,e,t,i),n}function R6e(s,e,t,i){const n=[];return hce(s,n,e,t,i),n}function hce(s,e,t,i,n){uce(s,e,!1,typeof t=="string"?r=>r===t:t,i,n)}function uce(s,e,t,i=r=>r==="navigation",n=()=>!1,o=!1){let r,a;Array.isArray(e)?(r=e,a=e):(r=e.primary,a=e.secondary);const l=new Set;for(const[c,d]of s){let h;i(c)?(h=r,h.length>0&&o&&h.push(new _s)):(h=a,h.length>0&&h.push(new _s));for(let u of d){t&&(u=u instanceof Ya&&u.alt?u.alt:u);const f=h.push(u);u instanceof vw&&l.add({group:c,action:u,index:f-1})}}for(const{group:c,action:d,index:h}of l){const u=i(c)?r:a,f=d.actions;n(d,c,u.length)&&u.splice(h,1,...f)}}let ym=class extends Aw{constructor(e,t,i,n,o,r,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable,keybinding:t==null?void 0:t.keybinding,hoverDelegate:t==null?void 0:t.hoverDelegate,keybindingNotRenderedWithLabel:t==null?void 0:t.keybindingNotRenderedWithLabel}),this._options=t,this._keybindingService=i,this._notificationService=n,this._contextKeyService=o,this._themeService=r,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new mi),this._altKey=Au.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{var o;const n=!!((o=this._menuItemAction.alt)!=null&&o.enabled)&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);n!==this._wantsAltCommand&&(this._wantsAltCommand=n,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(ee(e,"mouseleave",n=>{t=!1,i()})),this._register(ee(e,"mouseenter",n=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var o;const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?_(1644,"{0} ({1})",i,t):i;if(!this._wantsAltCommand&&((o=this._menuItemAction.alt)!=null&&o.enabled)){const r=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),c=l?_(1645,"{0} ({1})",r,l):r;n=_(1646,`{0}
[{1}] {2}`,n,pq.modifierLabels[sa].altKey,c)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const n=this._commandAction.checked&&b6e(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(n)if(it.isThemeIcon(n)){const o=it.asClassNameArray(n);i.classList.add(...o),this._itemClassDispose.value=Ve(()=>{i.classList.remove(...o)})}else i.style.backgroundImage=_f(this._themeService.getColorTheme().type)?Eh(n.dark):Eh(n.light),i.classList.add("icon"),this._itemClassDispose.value=dc(Ve(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};ym=u4([mr(2,ai),mr(3,Hn),mr(4,ut),mr(5,Dn),mr(6,sl),mr(7,so)],ym);class bq extends ym{render(e){var t;this.options.label=!0,this.options.icon=!1,super.render(e),e.classList.add("text-only"),e.classList.toggle("use-comma",((t=this._options)==null?void 0:t.useComma)??!1)}updateLabel(){var t;const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const i=bq._symbolPrintEnter(e);(t=this._options)!=null&&t.conversational?this.label.textContent=_(1647,"{1} to {0}",this._action.label,i):this.label.textContent=_(1648,"{0} ({1})",this._action.label,i)}}static _symbolPrintEnter(e){var t;return(t=e.getLabel())==null?void 0:t.replace(/\benter\b/gi,"⏎").replace(/\bEscape\b/gi,"Esc")}}let W7=class extends i2{constructor(e,t,i,n,o){const r={...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!1,classNames:(t==null?void 0:t.classNames)??(it.isThemeIcon(e.item.icon)?it.asClassName(e.item.icon):void 0),keybindingProvider:(t==null?void 0:t.keybindingProvider)??(a=>i.lookupKeybinding(a.id))};super(e,{getActions:()=>e.actions},n,r),this._keybindingService=i,this._contextMenuService=n,this._themeService=o}render(e){super.render(e),ti(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!it.isThemeIcon(i)){this.element.classList.add("icon");const n=()=>{this.element&&(this.element.style.backgroundImage=_f(this._themeService.getColorTheme().type)?Eh(i.dark):Eh(i.light))};n(),this._register(this._themeService.onDidColorThemeChange(()=>{n()}))}}};W7=u4([mr(2,ai),mr(3,sl),mr(4,Dn)],W7);let H7=class extends qc{constructor(e,t,i,n,o,r,a,l){super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=o,this._menuService=r,this._instaService=a,this._storageService=l,this._defaultActionDisposables=this._register(new oe),this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c;const d=t!=null&&t.togglePrimaryAction?l.get(this._storageKey,1):void 0;d&&(c=e.actions.find(u=>d===u.id)),c||(c=e.actions[0]),this._defaultAction=this._defaultActionDisposables.add(this._instaService.createInstance(ym,c,{keybinding:this._getDefaultActionKeybindingLabel(c)}));const h={keybindingProvider:u=>this._keybindingService.lookupKeybinding(u.id),...t,menuAsChild:(t==null?void 0:t.menuAsChild)??!0,classNames:(t==null?void 0:t.classNames)??["codicon","codicon-chevron-down"],actionRunner:(t==null?void 0:t.actionRunner)??this._register(new Mb)};this._dropdown=this._register(new i2(e,e.actions,this._contextMenuService,h)),t!=null&&t.togglePrimaryAction&&this._register(this._dropdown.actionRunner.onDidRun(u=>{u.action instanceof Ya&&this.update(u.action)}))}update(e){var t;(t=this._options)!=null&&t.togglePrimaryAction&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultActionDisposables.clear(),this._defaultAction=this._defaultActionDisposables.add(this._instaService.createInstance(ym,e,{keybinding:this._getDefaultActionKeybindingLabel(e)})),this._defaultAction.actionRunner=this._defaultActionDisposables.add(new class extends Mb{async runAction(i,n){await i.run(void 0)}}),this._container&&this._defaultAction.render(wO(this._container,we(".action-container")))}_getDefaultActionKeybindingLabel(e){var i;let t;if((i=this._options)!=null&&i.renderKeybindingWithDefaultActionLabel){const n=this._keybindingService.lookupKeybinding(e.id);n&&(t=`(${n.getLabel()})`)}return t}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}set actionRunner(e){super.actionRunner=e,this._defaultAction.actionRunner=e,this._dropdown.actionRunner=e}get actionRunner(){return super.actionRunner}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=we(".action-container");this._defaultAction.render(me(this._container,t)),this._register(ee(t,ye.KEY_DOWN,n=>{const o=new Bi(n);o.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),o.stopPropagation())}));const i=we(".dropdown-action-container");this._dropdown.render(me(this._container,i)),this._register(ee(i,ye.KEY_DOWN,n=>{var r;const o=new Bi(n);o.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(r=this._defaultAction.element)==null||r.focus(),o.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}};H7=u4([mr(2,ai),mr(3,Hn),mr(4,sl),mr(5,Vl),mr(6,$e),mr(7,sr)],H7);let V7=class extends c8e{constructor(e,t,i){super(null,e,e.actions.map(n=>({text:n.id===_s.ID?"─────────":n.label,isDisabled:!n.enabled})),0,t,L6e,{ariaLabel:e.tooltip,optionsAsChildren:!0,useCustomDrawn:!E6e(i)}),this.select(Math.max(0,e.actions.findIndex(n=>n.checked)))}render(e){super.render(e),e.style.borderColor=ve(u$)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};V7=u4([mr(1,Nf),mr(2,xt)],V7);function vq(s,e,t){return e instanceof Ya?s.createInstance(ym,e,t):e instanceof d_?e.item.isSelection?s.createInstance(V7,e):e.item.isSplitButton?s.createInstance(H7,e,{...t,togglePrimaryAction:typeof e.item.isSplitButton!="boolean"?e.item.isSplitButton.togglePrimaryAction:!1}):s.createInstance(W7,e,t):void 0}var f4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},bh=function(s,e){return function(t,i){e(t,i,s)}},mC,LS;let z7=class{constructor(e,t,i){this._commandService=e,this._keybindingService=t,this._hiddenStates=new U7(i)}createMenu(e,t,i){return new o2(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){const n=new o2(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),o=n.getActions(i);return n.dispose(),o}resetHiddenStates(e){this._hiddenStates.reset(e)}};z7=f4([bh(0,en),bh(1,ai),bh(2,sr)],z7);var k_;let U7=(k_=class{constructor(e){this._storageService=e,this._disposables=new oe,this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(mC._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,mC._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(mC._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){var o;const i=this._isHiddenByDefault(e,t),n=((o=this._data[e.id])==null?void 0:o.includes(t))??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const o=this._data[e.id];if(i)o?o.indexOf(t)<0&&o.push(t):this._data[e.id]=[t];else if(o){const r=o.indexOf(t);r>=0&&eTe(o,r),o.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(mC._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}},mC=k_,k_._key="menu.hiddenCommands",k_);U7=mC=f4([bh(0,sr)],U7);class hx{constructor(e,t){this._id=e,this._collectContextKeysForSubmenus=t,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=this._sort(qs.getMenuItems(this._id));let t;for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(hx._fillInKbExprKeys(e.when,this._structureContextKeys),f1(e)){if(e.command.precondition&&hx._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;hx._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(qs.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}}let $7=LS=class extends hx{constructor(e,t,i,n,o,r){super(e,i),this._hiddenStates=t,this._commandService=n,this._keybindingService=o,this._contextKeyService=r,this.refresh()}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[n,o]=i;let r;for(const a of o)if(this._contextKeyService.contextMatchesRules(a.when)){const l=f1(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=M6e(this._id,l?a.command:a,this._hiddenStates);if(l){const d=fce(this._commandService,this._keybindingService,a.command.id,a.when);(r??(r=[])).push(new Ya(a.command,a.alt,e,c,d,this._contextKeyService,this._commandService))}else{const d=new LS(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),h=_s.join(...d.map(u=>u[1]));h.length>0&&(r??(r=[])).push(new d_(a,c,h))}}r&&r.length>0&&t.push([n,r])}return t}_sort(e){return e.sort(LS._compareMenuItems)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const o=e.order||0,r=t.order||0;return o<r?-1:o>r?1:LS._compareTitles(f1(e)?e.command.title:e.title,f1(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};$7=LS=f4([bh(3,en),bh(4,ai),bh(5,ut)],$7);let o2=class{constructor(e,t,i,n,o,r){this._disposables=new oe,this._menuInfo=new $7(e,t,i.emitEventsForSubmenuChanges,n,o,r);const a=new Ni(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(qs.onDidChangeMenu(h=>{for(const u of this._menuInfo.allMenuIds)if(h.has(u)){a.schedule();break}}));const l=this._disposables.add(new oe),c=h=>{let u=!1,f=!1,g=!1;for(const m of h)if(u=u||m.isStructuralChange,f=f||m.isEnablementChange,g=g||m.isToggleChange,u&&f&&g)break;return{menu:this,isStructuralChange:u,isEnablementChange:f,isToggleChange:g}},d=()=>{l.add(r.onDidChangeContext(h=>{const u=h.affectsSome(this._menuInfo.structureContextKeys),f=h.affectsSome(this._menuInfo.preconditionContextKeys),g=h.affectsSome(this._menuInfo.toggledContextKeys);(u||f||g)&&this._onDidChange.fire({menu:this,isStructuralChange:u,isEnablementChange:f,isToggleChange:g})})),l.add(t.onDidChange(h=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new Tse({onWillAddFirstListener:d,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:c}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};o2=f4([bh(3,en),bh(4,ai),bh(5,ut)],o2);function M6e(s,e,t){const i=_Ne(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,o=c_({id:`hide/${s.id}/${i}`,label:_(1651,"Hide '{0}'",n),run(){t.updateHidden(s,i,!0)}}),r=c_({id:`toggle/${s.id}/${i}`,label:n,get checked(){return!t.isHidden(s,i)},run(){t.updateHidden(s,i,!!this.checked)}});return{hide:o,toggle:r,get isHidden(){return!r.checked}}}function fce(s,e,t,i=void 0,n=!0){return c_({id:`configureKeybinding/${t}`,label:_(1652,"Configure Keybinding"),enabled:n,run(){const r=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;s.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(r?` +when:${r}`:""))}})}const gce=Mt("IActionViewItemService");class A6e{constructor(){this._providers=new Map,this._onDidChange=new q,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}lookUp(e,t){return this._providers.get(this._makeKey(e,t))}_makeKey(e,t){return`${e.id}/${t instanceof He?t.id:t}`}}Vt(gce,A6e,1);var mce=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Oa=function(s,e){return function(t,i){e(t,i,s)}};let r2=class extends u6e{constructor(e,t,i,n,o,r,a,l){super(e,o,{getKeyBinding:d=>r.lookupKeybinding(d.id)??void 0,...t,allowContextMenu:!0,skipTelemetry:typeof(t==null?void 0:t.telemetrySource)=="string"}),this._options=t,this._menuService=i,this._contextKeyService=n,this._contextMenuService=o,this._keybindingService=r,this._commandService=a,this._sessionDisposables=this._store.add(new oe);const c=t==null?void 0:t.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(d=>l.publicLog2("workbenchActionExecuted",{id:d.action.id,from:c})))}setActions(e,t=[],i){var d,h,u;this._sessionDisposables.clear();const n=e.slice(),o=t.slice(),r=[];let a=0;const l=[];let c=!1;if(((d=this._options)==null?void 0:d.hiddenItemStrategy)!==-1)for(let f=0;f<n.length;f++){const g=n[f];!(g instanceof Ya)&&!(g instanceof d_)||g.hideActions&&(r.push(g.hideActions.toggle),g.hideActions.toggle.checked&&a++,g.hideActions.isHidden&&(c=!0,n[f]=void 0,((h=this._options)==null?void 0:h.hiddenItemStrategy)!==0&&(l[f]=g)))}if(((u=this._options)==null?void 0:u.overflowBehavior)!==void 0){const f=Qae(new Set(this._options.overflowBehavior.exempted),Gt.map(n,p=>p==null?void 0:p.id)),g=this._options.overflowBehavior.maxItems-f.size;let m=0;for(let p=0;p<n.length;p++){const v=n[p];v&&(m++,!f.has(v.id)&&m>=g&&(n[p]=void 0,l[p]=v))}}jG(n),jG(l),super.setActions(n,_s.join(l,o)),(r.length>0||n.length>0)&&this._sessionDisposables.add(ee(this.getElement(),"contextmenu",f=>{var b,w,C,y,x;const g=new Co(je(this.getElement()),f),m=this.getItemAction(g.target);if(!m)return;g.preventDefault(),g.stopPropagation();const p=[];if(m instanceof Ya&&m.menuKeybinding)p.push(m.menuKeybinding);else if(!(m instanceof d_||m instanceof lI)){const S=!!this._keybindingService.lookupKeybinding(m.id);p.push(fce(this._commandService,this._keybindingService,m.id,void 0,S))}if(r.length>0){let S=!1;if(a===1&&((b=this._options)==null?void 0:b.hiddenItemStrategy)===0){S=!0;for(let L=0;L<r.length;L++)if(r[L].checked){r[L]=c_({id:m.id,label:m.label,checked:!0,enabled:!1,run(){}});break}}if(!S&&(m instanceof Ya||m instanceof d_)){if(!m.hideActions)return;p.push(m.hideActions.hide)}else p.push(c_({id:"label",label:_(1649,"Hide"),enabled:!1,run(){}}))}const v=_s.join(p,r);(w=this._options)!=null&&w.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(v.push(new _s),v.push(c_({id:"resetThisMenu",label:_(1650,"Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),v.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>g,getActions:()=>v,menuId:(C=this._options)==null?void 0:C.contextMenu,menuActionOptions:{renderShortTitle:!0,...(y=this._options)==null?void 0:y.menuOptions},skipTelemetry:typeof((x=this._options)==null?void 0:x.telemetrySource)=="string",contextKeyService:this._contextKeyService})}))}};r2=mce([Oa(2,Vl),Oa(3,ut),Oa(4,sl),Oa(5,ai),Oa(6,en),Oa(7,Wo)],r2);let cI=class extends r2{get onDidChangeMenuItems(){return this._onDidChangeMenuItems.event}constructor(e,t,i,n,o,r,a,l,c,d,h){super(e,{resetMenu:t,...i,actionViewItemProvider:(g,m)=>{let p=d.lookUp(t,g instanceof d_?g.item.submenu.id:g.id);p||(p=i==null?void 0:i.actionViewItemProvider);const v=p==null?void 0:p(g,m,h,je(e).vscodeWindowId);return v||vq(h,g,m)}},n,o,r,a,l,c),this._onDidChangeMenuItems=this._store.add(new q);const u=this._store.add(n.createMenu(t,o,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:i==null?void 0:i.eventDebounceDelay})),f=()=>{var p,v,b;const{primary:g,secondary:m}=dce(u.getActions(i==null?void 0:i.menuOptions),(p=i==null?void 0:i.toolbarOptions)==null?void 0:p.primaryGroup,(v=i==null?void 0:i.toolbarOptions)==null?void 0:v.shouldInlineSubmenu,(b=i==null?void 0:i.toolbarOptions)==null?void 0:b.useSeparatorsInPrimaryActions);e.classList.toggle("has-no-actions",g.length===0&&m.length===0),super.setActions(g,m)};this._store.add(u.onDidChange(()=>{f(),this._onDidChangeMenuItems.fire(this)})),this._store.add(d.onDidChange(g=>{g===t&&f()})),f()}setActions(){throw new et("This toolbar is populated from a menu.")}};cI=mce([Oa(3,Vl),Oa(4,ut),Oa(5,sl),Oa(6,ai),Oa(7,en),Oa(8,Wo),Oa(9,gce),Oa(10,$e)],cI);var P6e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},dQ=function(s,e){return function(t,i){e(t,i,s)}};const Sr=Mt("hoverService");let Pw=class extends K{get delay(){var e;return this.isInstantlyHovering()?0:(e=this.hoverOptions)!=null&&e.dynamicDelay?t=>{var i,n;return((n=(i=this.hoverOptions)==null?void 0:i.dynamicDelay)==null?void 0:n.call(i,t))??this._delay}:this._delay}constructor(e,t,i={},n,o){super(),this.placement=e,this.hoverOptions=t,this.overrideOptions=i,this.configurationService=n,this.hoverService=o,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new oe),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(e,t){const i=typeof this.overrideOptions=="function"?this.overrideOptions(e,t):this.overrideOptions;this.hoverDisposables.clear();const n=Bn(e.target)?[e.target]:e.target.targetElements;for(const r of n)this.hoverDisposables.add(Jn(r,"keydown",a=>{a.equals(9)&&this.hoverService.hideHover()}));const o=Bn(e.content)?void 0:typeof e.content=="string"?e.content.toString():e.content.value;return this.hoverService.showInstantHover({...e,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:o,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},t)}isInstantlyHovering(){var e;return!!((e=this.hoverOptions)!=null&&e.instantHover)&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){var e;this.hoverDisposables.clear(),(e=this.hoverOptions)!=null&&e.instantHover&&(this.lastHoverHideTime=Date.now())}};Pw=P6e([dQ(3,xt),dQ(4,Sr)],Pw);const O6e={showHover:function(){throw new Error("Native hover function not implemented.")},delay:0,showNativeHover:!0};class qb extends E${constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}getLineLength(e){return this._textModel.getLineLength(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new xs(e-1,t)}}class pce extends Mb{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class F6e extends K{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=fi(this,this._editor.onDidScrollChange,r=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(r=>r===0),this.modelAttached=fi(this,this._editor.onDidChangeModel,r=>this._editor.hasModel()),this.editorOnDidChangeViewZones=na("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=na("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=xl("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const n=this._domNode.appendChild(ei("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),o=new ResizeObserver(()=>{Ki(r=>{this.domNodeSizeChanged.trigger(r)})});o.observe(this._domNode),this._register(Ve(()=>o.disconnect())),this._register(lt(r=>{n.className=this.isScrollTopZero.read(r)?"":"scroll-decoration"})),this._register(lt(r=>this.render(r)))}dispose(){super.dispose(),Os(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),n=new Set(this.views.keys()),o=Ue.ofStartAndLength(0,this._domNode.clientHeight);if(!o.isEmpty)for(const r of i){const a=new dt(r.startLineNumber,r.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);Ki(c=>{for(const d of l){if(!d.range.intersect(a))continue;n.delete(d.id);let h=this.views.get(d.id);if(h)h.item.set(d,c);else{const m=document.createElement("div");this._domNode.appendChild(m);const p=ht("item",d),v=this.itemProvider.createView(p,m);h=new B6e(p,v,m),this.views.set(d.id,h)}const u=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-t:d.range.startLineNumber>1?this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-t:0,g=(d.range.endLineNumberExclusive===1?Math.max(u,this._editor.getTopForLineNumber(d.range.startLineNumber,!1)-t):Math.max(u,this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-t))-u;h.domNode.style.top=`${u}px`,h.domNode.style.height=`${g}px`,h.gutterItemView.layout(Ue.ofStartAndLength(u,g),o)}})}for(const r of n){const a=this.views.get(r);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(r)}}}class B6e{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}var _ce=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},tN=function(s,e){return function(t,i){e(t,i,s)}};const PF=[],AD=35;let q7=class extends K{constructor(e,t,i,n,o,r,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=n,this._sashLayout=o,this._boundarySashes=r,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(He.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=fi(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(h=>h.length>0),this._showSash=ae(this,h=>this._options.renderSideBySide.read(h)&&this._hasActions.read(h)),this.width=ae(this,h=>this._hasActions.read(h)?AD:0),this.elements=ei("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:AD+"px"}},[]),this._currentDiff=ae(this,h=>{var m;const u=this._diffModel.read(h);if(!u)return;const f=(m=u.diff.read(h))==null?void 0:m.mappings,g=this._editors.modifiedCursor.read(h);if(g)return f==null?void 0:f.find(p=>p.lineRangeMapping.modified.contains(g.lineNumber))}),this._selectedDiffs=ae(this,h=>{const u=this._diffModel.read(h),f=u==null?void 0:u.diff.read(h);if(!f)return PF;const g=this._editors.modifiedSelections.read(h);if(g.every(b=>b.isEmpty()))return PF;const m=new Sl(g.map(b=>dt.fromRangeInclusive(b))),v=f.mappings.filter(b=>b.lineRangeMapping.innerChanges&&m.intersects(b.lineRangeMapping.modified)).map(b=>({mapping:b,rangeMappings:b.lineRangeMapping.innerChanges.filter(w=>g.some(C=>D.areIntersecting(w.modifiedRange,C)))}));return v.length===0||v.every(b=>b.rangeMappings.length===0)?PF:v}),this._register(h8e(e,this.elements.root)),this._register(ee(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(wm(this.elements.root,{display:this._hasActions.map(h=>h?"block":"none")})),gl(this,h=>this._showSash.read(h)?new rce(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,MU(this,f=>this._sashLayout.sashLeft.read(f)-AD,(f,g)=>this._sashLayout.sashLeft.set(f+AD,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store);const d=ae(this,h=>{const u=this._diffModel.read(h);if(!u)return[];const f=u.diff.read(h);if(!f)return[];const g=this._selectedDiffs.read(h);if(g.length>0){const p=Qa.fromRangeMappings(g.flatMap(v=>v.rangeMappings));return[new hQ(p,!0,He.DiffEditorSelectionToolbar,void 0,u.model.original.uri,u.model.modified.uri)]}const m=this._currentDiff.read(h);return f.mappings.map(p=>new hQ(p.lineRangeMapping.withInnerChangesFromLineRanges(),p.lineRangeMapping===(m==null?void 0:m.lineRangeMapping),He.DiffEditorHunkToolbar,void 0,u.model.original.uri,u.model.modified.uri))});this._register(new F6e(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(h,u)=>d.read(u),createView:(h,u)=>this._instantiationService.createInstance(j7,h,u,this)})),this._register(ee(this.elements.gutter,ye.MOUSE_WHEEL,h=>{this._editors.modified.getOption(117).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(h)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new qb(this._editors.modifiedModel.get()),n=new qb(this._editors.original.getModel());return new ra(t.map(a=>a.toTextEdit(i))).apply(n)}layout(e){this.elements.gutter.style.left=e+"px"}};q7=_ce([tN(6,$e),tN(7,ut),tN(8,Vl)],q7);class hQ{constructor(e,t,i,n,o,r){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=n,this.originalUri=o,this.modifiedUri=r}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let j7=class extends K{constructor(e,t,i,n){super(),this._item=e,this._elements=ei("div.gutterItem",{style:{height:"20px",width:"34px"}},[ei("div.background@background",{},[]),ei("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,r=>r.showAlways),this._menuId=this._item.map(this,r=>r.menuId),this._isSmall=ht(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const o=this._register(n.createInstance(Pw,"element",{instantHover:!0},{position:{hoverPosition:1}}));this._register(AC(t,this._elements.root)),this._register(lt(r=>{const a=this._showAlways.read(r);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Ao((r,a)=>{this._elements.buttons.replaceChildren();const l=a.add(n.createInstance(cI,this._elements.buttons,this._menuId.read(r),{orientation:1,hoverDelegate:o,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(r)?1:3},hiddenItemStrategy:0,actionRunner:a.add(new pce(()=>{const c=this._item.read(void 0),d=c.mapping;return{mapping:d,originalWithModifiedChanges:i.computeStagedValue(d),originalUri:c.originalUri,modifiedUri:c.modifiedUri}})),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const n=e.length/2-i/2,o=i;let r=e.start+n;const a=Ue.tryCreate(o,t.endExclusive-o-i),l=Ue.tryCreate(e.start+o,e.endExclusive-i-o);l&&a&&l.start<l.endExclusive&&(r=a.clip(r),r=l.clip(r)),this._elements.buttons.style.top=`${r-e.start}px`}};j7=_ce([tN(3,$e)],j7);var W6e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},H6e=function(s,e){return function(t,i){e(t,i,s)}},K7,Kg;let a2=(Kg=class extends K{static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=n,this._modifiedOutlineSource=gl(this,l=>{const c=this._editors.modifiedModel.read(l),d=K7._breadcrumbsSourceFactory.read(l);return!c||!d?void 0:d(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();Ki(d=>{for(const h of this._editors.original.getSelections()||[])c==null||c.ensureOriginalLineIsVisible(h.getStartPosition().lineNumber,0,d),c==null||c.ensureOriginalLineIsVisible(h.getEndPosition().lineNumber,0,d)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();Ki(d=>{for(const h of this._editors.modified.getSelections()||[])c==null||c.ensureModifiedLineIsVisible(h.getStartPosition().lineNumber,0,d),c==null||c.ensureModifiedLineIsVisible(h.getEndPosition().lineNumber,0,d)})}));const o=this._diffModel.map((l,c)=>{var h;const d=(l==null?void 0:l.unchangedRegions.read(c))??[];return d.length===1&&d[0].modifiedLineNumber===1&&d[0].lineCount===((h=this._editors.modifiedModel.read(c))==null?void 0:h.getLineCount())?[]:d});this.viewZones=ae(this,l=>{const c=this._modifiedOutlineSource.read(l);if(!c)return{origViewZones:[],modViewZones:[]};const d=[],h=[],u=this._options.renderSideBySide.read(l),f=this._options.compactMode.read(l),g=o.read(l);for(let m=0;m<g.length;m++){const p=g[m];if(!p.shouldHideControls(l)&&!(f&&(m===0||m===g.length-1)))if(f){{const v=ae(this,w=>p.getHiddenOriginalRange(w).startLineNumber-1),b=new PC(v,12);d.push(b),l.store.add(new uQ(this._editors.original,b,p,!u))}{const v=ae(this,w=>p.getHiddenModifiedRange(w).startLineNumber-1),b=new PC(v,12);h.push(b),l.store.add(new uQ(this._editors.modified,b,p))}}else{{const v=ae(this,w=>p.getHiddenOriginalRange(w).startLineNumber-1),b=new PC(v,24);d.push(b),l.store.add(new fQ(this._editors.original,b,p,p.originalUnchangedRange,!u,c,w=>this._diffModel.get().ensureModifiedLineIsVisible(w,2,void 0),this._options))}{const v=ae(this,w=>p.getHiddenModifiedRange(w).startLineNumber-1),b=new PC(v,24);h.push(b),l.store.add(new fQ(this._editors.modified,b,p,p.modifiedUnchangedRange,!1,c,w=>this._diffModel.get().ensureModifiedLineIsVisible(w,2,void 0),this._options))}}}return{origViewZones:d,modViewZones:h}});const r={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new To(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(_(124,"Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+it.asClassName(ge.fold),zIndex:10001};this._register(GR(this._editors.original,ae(this,l=>{const c=o.read(l),d=c.map(h=>({range:h.originalUnchangedRange.toInclusiveRange(),options:r}));for(const h of c)h.shouldHideControls(l)&&d.push({range:D.fromPositions(new z(h.originalLineNumber,1)),options:a});return d}))),this._register(GR(this._editors.modified,ae(this,l=>{const c=o.read(l),d=c.map(h=>({range:h.modifiedUnchangedRange.toInclusiveRange(),options:r}));for(const h of c)h.shouldHideControls(l)&&d.push({range:dt.ofLength(h.modifiedLineNumber,1).toInclusiveRange(),options:a});return d}))),this._register(lt(l=>{const c=o.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(d=>d.getHiddenOriginalRange(l).toInclusiveRange()).filter($s)),this._editors.modified.setHiddenAreas(c.map(d=>d.getHiddenModifiedRange(l).toInclusiveRange()).filter($s))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const d=l.target.position.lineNumber,h=this._diffModel.get();if(!h)return;const u=h.unchangedRegions.get().find(f=>f.modifiedUnchangedRange.contains(d));if(!u)return;u.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{var c;if(!l.event.rightButton&&l.target.position&&((c=l.target.element)!=null&&c.className.includes("fold-unchanged"))){const d=l.target.position.lineNumber,h=this._diffModel.get();if(!h)return;const u=h.unchangedRegions.get().find(f=>f.originalUnchangedRange.contains(d));if(!u)return;u.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}},K7=Kg,Kg._breadcrumbsSourceFactory=ht(Kg,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}})),Kg);a2=K7=W6e([H6e(3,$e)],a2);class uQ extends lq{constructor(e,t,i,n=!1){const o=ei("div.diff-hidden-lines-widget");super(e,t,o.root),this._unchangedRegion=i,this._hide=n,this._nodes=ei("div.diff-hidden-lines-compact",[ei("div.line-left",[]),ei("div.text@text",[]),ei("div.line-right",[])]),o.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(lt(r=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(r).length,l=_(125,"{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class fQ extends lq{constructor(e,t,i,n,o,r,a,l){const c=ei("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=n,this._hide=o,this._modifiedOutlineSource=r,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=ei("div.diff-hidden-lines",[ei("div.top@top",{title:_(126,"Click or drag to show more above")}),ei("div.center@content",{style:{display:"flex"}},[ei("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[we("a",{title:_(127,"Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Hg("$(unfold)"))]),ei("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),ei("div.bottom@bottom",{title:_(128,"Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?Os(this._nodes.first):this._register(wm(this._nodes.first,{width:bn(this._editor).layoutInfoContentLeft})),this._register(lt(h=>{const u=this._unchangedRegion.visibleLineCountTop.read(h)+this._unchangedRegion.visibleLineCountBottom.read(h)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!u),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),this._nodes.top.classList.toggle("canMoveBottom",!u);const f=this._unchangedRegion.isDragged.read(h),g=this._editor.getDomNode();g&&(g.classList.toggle("draggingUnchangedRegion",!!f),f==="top"?(g.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),g.classList.toggle("canMoveBottom",!u)):f==="bottom"?(g.classList.toggle("canMoveTop",!u),g.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0)):(g.classList.toggle("canMoveTop",!1),g.classList.toggle("canMoveBottom",!1)))}));const d=this._editor;this._register(ee(this._nodes.top,"mousedown",h=>{if(h.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let f=!1;const g=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const m=je(this._nodes.top),p=ee(m,"mousemove",b=>{const C=b.clientY-u;f=f||Math.abs(C)>2;const y=Math.round(C/d.getOption(75)),x=Math.max(0,Math.min(g+y,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(x,void 0)}),v=ee(m,"mouseup",b=>{f||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),p.dispose(),v.dispose()})})),this._register(ee(this._nodes.bottom,"mousedown",h=>{if(h.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let f=!1;const g=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const m=je(this._nodes.bottom),p=ee(m,"mousemove",b=>{const C=b.clientY-u;f=f||Math.abs(C)>2;const y=Math.round(C/d.getOption(75)),x=Math.max(0,Math.min(g-y,this._unchangedRegion.getMaxVisibleLineCountBottom())),S=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(x,void 0);const L=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(L-S))}),v=ee(m,"mouseup",b=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!f){const w=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const C=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(C-w))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),p.dispose(),v.dispose()})})),this._register(lt(h=>{const u=[];if(!this._hide){const f=i.getHiddenModifiedRange(h).length,g=_(129,"{0} hidden lines",f),m=we("span",{title:_(130,"Double click to unfold")},g);m.addEventListener("dblclick",b=>{b.button===0&&(b.preventDefault(),this._unchangedRegion.showAll(void 0))}),u.push(m);const p=this._unchangedRegion.getHiddenModifiedRange(h),v=this._modifiedOutlineSource.getBreadcrumbItems(p,h);if(v.length>0){u.push(we("span",void 0,"  |  "));for(let b=0;b<v.length;b++){const w=v[b],C=DR.toIcon(w.kind),y=ei("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[fd(C)," ",w.name,...b===v.length-1?[]:[fd(ge.chevronRight)]]).root;u.push(y),y.onclick=()=>{this._revealModifiedHiddenLine(w.startLineNumber)}}}}Os(this._nodes.others,...u)}))}}const OF=[];class V6e extends K{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=n,this._selectedDiffs=ae(this,o=>{const r=this._diffModel.read(o),a=r==null?void 0:r.diff.read(o);if(!a)return OF;const l=this._editors.modifiedSelections.read(o);if(l.every(u=>u.isEmpty()))return OF;const c=new Sl(l.map(u=>dt.fromRangeInclusive(u))),h=a.mappings.filter(u=>u.lineRangeMapping.innerChanges&&c.intersects(u.lineRangeMapping.modified)).map(u=>({mapping:u,rangeMappings:u.lineRangeMapping.innerChanges.filter(f=>l.some(g=>D.areIntersecting(f.modifiedRange,g)))}));return h.length===0||h.every(u=>u.rangeMappings.length===0)?OF:h}),this._register(Ao((o,r)=>{if(!this._options.shouldRenderOldRevertArrows.read(o))return;const a=this._diffModel.read(o),l=a==null?void 0:a.diff.read(o);if(!a||!l||a.movedTextToCompare.read(o))return;const c=[],d=this._selectedDiffs.read(o),h=new Set(d.map(u=>u.mapping));if(d.length>0){const u=this._editors.modifiedSelections.read(o),f=r.add(new l2(u[u.length-1].positionLineNumber,this._widget,d.flatMap(g=>g.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}for(const u of l.mappings)if(!h.has(u)&&!u.lineRangeMapping.modified.isEmpty&&u.lineRangeMapping.innerChanges){const f=r.add(new l2(u.lineRangeMapping.modified.startLineNumber,this._widget,u.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(f),c.push(f)}r.add(Ve(()=>{for(const u of c)this._editors.modified.removeGlyphMarginWidget(u)}))}))}}const PA=class PA extends K{getId(){return this._id}constructor(e,t,i,n){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=n,this._id=`revertButton${PA.counter++}`,this._domNode=ei("div.revertButton",{title:this._revertSelection?_(135,"Revert Selected Changes"):_(136,"Revert Change")},[fd(ge.arrowRight)]).root,this._register(ee(this._domNode,ye.MOUSE_DOWN,o=>{o.button!==2&&(o.stopPropagation(),o.preventDefault())})),this._register(ee(this._domNode,ye.MOUSE_UP,o=>{o.stopPropagation(),o.preventDefault()})),this._register(ee(this._domNode,ye.CLICK,o=>{this._diffs instanceof Xo?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),o.stopPropagation(),o.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:cd.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};PA.counter=0;let l2=PA;var z6e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},X0=function(s,e){return function(t,i){e(t,i,s)}};let kh=class extends O7{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,n,o,r,a,l){super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=o,this._codeEditorService=r,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=ei("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[ei("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),ei("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),ei("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(OU(this,void 0)),this._diffModel=ae(this,C=>{var y;return(y=this._diffModelSrc.read(C))==null?void 0:y.object}),this.onDidChangeModel=Se.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new g0([ut,this._contextKeyService]))),this._boundarySashes=ht(this,void 0),this._accessibleDiffViewerShouldBeVisible=ht(this,!1),this._accessibleDiffViewerVisible=ae(this,C=>this._options.onlyShowAccessibleDiffViewer.read(C)?!0:this._accessibleDiffViewerShouldBeVisible.read(C)),this._movedBlocksLinesPart=ht(this,void 0),this._layoutInfo=ae(this,C=>{var H,G;const y=this._rootSizeObserver.width.read(C),x=this._rootSizeObserver.height.read(C);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=x+"px";const S=this._sash.read(C),L=this._gutter.read(C),E=(L==null?void 0:L.width.read(C))??0,M=((H=this._overviewRulerPart.read(C))==null?void 0:H.width)??0;let R,T,A,N,P;if(!!S){const V=S.sashLeft.read(C),U=((G=this._movedBlocksLinesPart.read(C))==null?void 0:G.width.read(C))??0;R=0,T=V-E-U,P=V-E,A=V,N=y-A-M}else{P=0;const V=this._options.inlineViewHideOriginalLineNumbers.read(C);R=E,V?T=0:T=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(C)),A=E+T,N=y-A-M}return this.elements.original.style.left=R+"px",this.elements.original.style.width=T+"px",this._editors.original.layout({width:T,height:x},!0),L==null||L.layout(P),this.elements.modified.style.left=A+"px",this.elements.modified.style.width=N+"px",this._editors.modified.layout({width:N,height:x},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((C,y)=>C==null?void 0:C.diff.read(y)),this.onDidUpdateDiff=Se.fromObservableLight(this._diffValue),this._codeEditorService.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(Ve(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new Xle(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(F7,t),this._register(lt(C=>{this._options.setWidth(this._rootSizeObserver.width.read(C))})),this._contextKeyService.createKey(B.isEmbeddedDiffEditor.key,!1),this._register(Ad(B.isEmbeddedDiffEditor,this._contextKeyService,C=>this._options.isInEmbeddedEditor.read(C))),this._register(Ad(B.comparingMovedCode,this._contextKeyService,C=>{var y;return!!((y=this._diffModel.read(C))!=null&&y.movedTextToCompare.read(C))})),this._register(Ad(B.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,C=>this._options.couldShowInlineViewBecauseOfSize.read(C))),this._register(Ad(B.diffEditorInlineMode,this._contextKeyService,C=>!this._options.renderSideBySide.read(C))),this._register(Ad(B.hasChanges,this._contextKeyService,C=>{var y,x;return(((x=(y=this._diffModel.read(C))==null?void 0:y.diff.read(C))==null?void 0:x.mappings.length)??0)>0})),this._editors=this._register(this._instantiationService.createInstance(P7,this.elements.original,this.elements.modified,this._options,i,(C,y,x,S)=>this._createInnerEditor(C,y,x,S))),this._register(Ad(B.diffEditorOriginalWritable,this._contextKeyService,C=>this._options.originalEditable.read(C))),this._register(Ad(B.diffEditorModifiedWritable,this._contextKeyService,C=>!this._options.readOnly.read(C))),this._register(Ad(B.diffEditorOriginalUri,this._contextKeyService,C=>{var y;return((y=this._diffModel.read(C))==null?void 0:y.model.original.uri.toString())??""})),this._register(Ad(B.diffEditorModifiedUri,this._contextKeyService,C=>{var y;return((y=this._diffModel.read(C))==null?void 0:y.model.modified.uri.toString())??""})),this._overviewRulerPart=gl(this,C=>this._options.renderOverviewRuler.read(C)?this._instantiationService.createInstance(iu(aI),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(y=>y.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((C,y)=>{var x;return C-(((x=this._overviewRulerPart.read(y))==null?void 0:x.width)??0)})};this._sashLayout=new n6e(this._options,c),this._sash=gl(this,C=>{const y=this._options.renderSideBySide.read(C);return this.elements.root.classList.toggle("side-by-side",y),y?new rce(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const d=gl(this,C=>this._instantiationService.createInstance(iu(a2),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);gl(this,C=>this._instantiationService.createInstance(iu(G8e),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const h=new Set,u=new Set;let f=!1;const g=gl(this,C=>this._instantiationService.createInstance(iu(M7),je(this._domElement),this._editors,this._diffModel,this._options,this,()=>f||d.read(void 0).isUpdatingHiddenAreas,h,u)).recomputeInitiallyAndOnChange(this._store),m=ae(this,C=>{const y=g.read(C).viewZones.read(C).orig,x=d.read(C).viewZones.read(C).origViewZones;return y.concat(x)}),p=ae(this,C=>{const y=g.read(C).viewZones.read(C).mod,x=d.read(C).viewZones.read(C).modViewZones;return y.concat(x)});this._register(YR(this._editors.original,m,C=>{f=C},h));let v;this._register(YR(this._editors.modified,p,C=>{f=C,f?v=ud.capture(this._editors.modified):(v==null||v.restore(this._editors.modified),v=void 0)},u)),this._accessibleDiffViewer=gl(this,C=>this._instantiationService.createInstance(iu(Qp),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(y,x)=>this._accessibleDiffViewerShouldBeVisible.set(y,x),this._options.onlyShowAccessibleDiffViewer.map(y=>!y),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((y,x)=>{var S;return(S=y==null?void 0:y.diff.read(x))==null?void 0:S.mappings.map(L=>L.lineRangeMapping)}),new R8e(this._editors))).recomputeInitiallyAndOnChange(this._store);const b=this._accessibleDiffViewerVisible.map(C=>C?"hidden":"visible");this._register(wm(this.elements.modified,{visibility:b})),this._register(wm(this.elements.original,{visibility:b})),this._createDiffEditorContributions(),this._codeEditorService.addDiffEditor(this),this._register(Ve(()=>{this._codeEditorService.removeDiffEditor(this)})),this._gutter=gl(this,C=>this._options.shouldRenderGutterMenu.read(C)?this._instantiationService.createInstance(iu(q7),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(bw(this._layoutInfo)),gl(this,C=>new(iu(E1))(this.elements.root,this._diffModel,this._layoutInfo.map(y=>y.originalEditor),this._layoutInfo.map(y=>y.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,C=>{this._movedBlocksLinesPart.set(C,void 0)}),this._register(Se.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!0))),this._register(Se.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!1)));const w=this._diffModel.map(this,(C,y)=>{if(C)return C.diff.read(y)===void 0&&!C.isDiffUpToDate.read(y)});this._register(Ao((C,y)=>{if(w.read(C)===!0){const x=this._editorProgressService.show(!0,1e3);y.add(Ve(()=>x.done()))}})),this._register(Ao((C,y)=>{y.add(new(iu(V6e))(this._editors,this._diffModel,this._options,this))})),this._register(Ao((C,y)=>{const x=this._diffModel.read(C);if(x)for(const S of[x.model.original,x.model.modified])y.add(S.onWillDispose(L=>{_t(new et("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(lt(C=>{this._options.setModel(this._diffModel.read(C))}))}_createInnerEditor(e,t,i,n){return e.createInstance(Vb,t,i,n)}_createDiffEditorContributions(){const e=g1.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){_t(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return yk.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var i;const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:(i=this._diffModel.get())==null?void 0:i.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())==null||t.restoreSerializedState(i.modelState))}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(R7,e,this._options)}getModel(){var e;return((e=this._diffModel.get())==null?void 0:e.model)??null}setModel(e){const t=e?"model"in e?XR.create(e).createNewRef(this):XR.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==(e==null?void 0:e.object)&&_w(t,n=>{var a;const o=e==null?void 0:e.object;fi.batchEventsGlobally(n,()=>{this._editors.original.setModel(o?o.model.original:null),this._editors.modified.setModel(o?o.model.modified:null)});const r=(a=this._diffModelSrc.get())==null?void 0:a.createNewRef(this);this._diffModelSrc.set(e==null?void 0:e.createNewRef(this),n),setTimeout(()=>{r==null||r.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?U6e(e):null}getDiffComputationResult(){var t;const e=(t=this._diffModel.get())==null?void 0:t.diff.get();return e?{changes:this.getLineChanges(),changes2:e.mappings.map(i=>i.lineRangeMapping),identical:e.identical,quitEarly:e.quitEarly}:null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||(this._editors.modified.pushUndoStop(),this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}]),this._editors.modified.pushUndoStop())}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(n=>({range:n.modifiedRange,text:t.model.original.getValueInRange(n.originalRange)}));this._editors.modified.pushUndoStop(),this._editors.modified.executeEdits("diffEditor",i),this._editors.modified.pushUndoStop()}revertFocusedRangeMappings(){var l,c;const e=this._diffModel.get();if(!e||!e.isDiffUpToDate.get())return;const t=(c=(l=this._diffModel.get())==null?void 0:l.diff.get())==null?void 0:c.mappings;if(!t||t.length===0)return;const i=this._editors.modified;if(!i.hasTextFocus())return;const n=i.getPosition().lineNumber,o=i.getSelection(),r=dt.fromRange(o||new D(n,0,n,0)),a=t.filter(d=>d.lineRangeMapping.modified.intersect(r));i.pushUndoStop(),i.executeEdits("diffEditor",a.map(d=>({range:d.lineRangeMapping.modified.toExclusiveRange(),text:e.model.original.getValueInRange(d.lineRangeMapping.original.toExclusiveRange())}))),i.pushUndoStop()}_goTo(e){this._editors.modified.setPosition(new z(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){var o,r;const t=(r=(o=this._diffModel.get())==null?void 0:o.diff.get())==null?void 0:r.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let n;e==="next"?this._editors.modified.getModel().getLineCount()===i?n=t[0]:n=t.find(l=>l.lineRangeMapping.modified.startLineNumber>i)??t[0]:n=BL(t,a=>a.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(n),n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(ur.diffLineDeleted,{source:"diffEditor.goToDiff"}):n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(ur.diffLineInserted,{source:"diffEditor.goToDiff"}):n&&this._accessibilitySignalService.playSignal(ur.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{var i;const t=(i=e.diff.get())==null?void 0:i.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){var r,a;const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let n;const o=t.getSelection();if(o){const l=(a=(r=this._diffModel.get())==null?void 0:r.diff.get())==null?void 0:a.mappings.map(c=>e?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=UZ(o.getStartPosition(),l),d=UZ(o.getEndPosition(),l);n=D.plusRange(c,d)}}return{destination:i,destinationSelection:n}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&Ki(i=>{for(const n of e)n.collapseAll(i)})}showAllUnchangedRegions(){var t;const e=(t=this._diffModel.get())==null?void 0:t.unchangedRegions.get();e&&Ki(i=>{for(const n of e)n.showAll(i)})}_handleCursorPositionChange(e,t){var i,n;if((e==null?void 0:e.reason)===3){const o=(n=(i=this._diffModel.get())==null?void 0:i.diff.get())==null?void 0:n.mappings.find(r=>t?r.lineRangeMapping.modified.contains(e.position.lineNumber):r.lineRangeMapping.original.contains(e.position.lineNumber));o!=null&&o.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(ur.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):o!=null&&o.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(ur.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):o&&this._accessibilitySignalService.playSignal(ur.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};kh=z6e([X0(3,ut),X0(4,$e),X0(5,ii),X0(6,Df),X0(7,vf)],kh);function U6e(s){return s.mappings.map(e=>{const t=e.lineRangeMapping;let i,n,o,r,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(o=t.modified.startLineNumber-1,r=0,a=void 0):(o=t.modified.startLineNumber,r=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:r,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}class $6e extends Gs{constructor(){super({id:"diffEditor.toggleCollapseUnchangedRegions",title:ne(85,"Toggle Collapse Unchanged Regions"),icon:ge.map,toggled:de.has("config.diffEditor.hideUnchangedRegions.enabled"),precondition:de.has("isInDiffEditor"),menu:{when:de.has("isInDiffEditor"),id:He.EditorTitle,order:22,group:"navigation"}})}run(e,...t){const i=e.get(xt),n=!i.getValue("diffEditor.hideUnchangedRegions.enabled");i.updateValue("diffEditor.hideUnchangedRegions.enabled",n)}}class bce extends Gs{constructor(){super({id:"diffEditor.toggleShowMovedCodeBlocks",title:ne(86,"Toggle Show Moved Code Blocks"),precondition:de.has("isInDiffEditor")})}run(e,...t){const i=e.get(xt),n=!i.getValue("diffEditor.experimental.showMoves");i.updateValue("diffEditor.experimental.showMoves",n)}}class vce extends Gs{constructor(){super({id:"diffEditor.toggleUseInlineViewWhenSpaceIsLimited",title:ne(87,"Toggle Use Inline View When Space Is Limited"),precondition:de.has("isInDiffEditor")})}run(e,...t){const i=e.get(xt),n=!i.getValue("diffEditor.useInlineViewWhenSpaceIsLimited");i.updateValue("diffEditor.useInlineViewWhenSpaceIsLimited",n)}}const Nk=ne(88,"Diff Editor");class q6e extends wc{constructor(){super({id:"diffEditor.switchSide",title:ne(89,"Switch Side"),icon:ge.arrowSwap,precondition:de.has("isInDiffEditor"),f1:!0,category:Nk})}runEditorCommand(e,t,i){const n=Iv(e);if(n instanceof kh){if(i&&i.dryRun)return{destinationSelection:n.mapToOtherSide().destinationSelection};n.switchSide()}}}class j6e extends wc{constructor(){super({id:"diffEditor.exitCompareMove",title:ne(90,"Exit Compare Move"),icon:ge.close,precondition:B.comparingMovedCode,f1:!1,category:Nk,keybinding:{weight:1e4,primary:9}})}runEditorCommand(e,t,...i){const n=Iv(e);n instanceof kh&&n.exitCompareMove()}}class K6e extends wc{constructor(){super({id:"diffEditor.collapseAllUnchangedRegions",title:ne(91,"Collapse All Unchanged Regions"),icon:ge.fold,precondition:de.has("isInDiffEditor"),f1:!0,category:Nk})}runEditorCommand(e,t,...i){const n=Iv(e);n instanceof kh&&n.collapseAllUnchangedRegions()}}class G6e extends wc{constructor(){super({id:"diffEditor.showAllUnchangedRegions",title:ne(92,"Show All Unchanged Regions"),icon:ge.unfold,precondition:de.has("isInDiffEditor"),f1:!0,category:Nk})}runEditorCommand(e,t,...i){const n=Iv(e);n instanceof kh&&n.showAllUnchangedRegions()}}class G7 extends Gs{constructor(){super({id:"diffEditor.revert",title:ne(93,"Revert"),f1:!0,category:Nk,precondition:de.has("isInDiffEditor")})}run(e,t){return t?this.runViaToolbarContext(e,t):this.runViaCursorOrSelection(e)}runViaCursorOrSelection(e){const t=Iv(e);t instanceof kh&&t.revertFocusedRangeMappings()}runViaToolbarContext(e,t){const i=Y6e(e,t.originalUri,t.modifiedUri);i instanceof kh&&i.revertRangeMappings(t.mapping.innerChanges??[])}}const Cce=ne(94,"Accessible Diff Viewer"),OA=class OA extends Gs{constructor(){super({id:OA.id,title:ne(95,"Go to Next Difference"),category:Cce,precondition:de.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){const t=Iv(e);t==null||t.accessibleDiffViewerNext()}};OA.id="editor.action.accessibleDiffViewer.next";let dI=OA;const FA=class FA extends Gs{constructor(){super({id:FA.id,title:ne(96,"Go to Previous Difference"),category:Cce,precondition:de.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){const t=Iv(e);t==null||t.accessibleDiffViewerPrev()}};FA.id="editor.action.accessibleDiffViewer.prev";let c2=FA;function Y6e(s,e,t){return s.get(ii).listDiffEditors().find(o=>{var l,c;const r=o.getModifiedEditor(),a=o.getOriginalEditor();return r&&((l=r.getModel())==null?void 0:l.uri.toString())===t.toString()&&a&&((c=a.getModel())==null?void 0:c.uri.toString())===e.toString()})||null}function Iv(s){const t=s.get(ii).listDiffEditors(),i=Ss();if(i){for(const n of t)if(n.getContainerDomNode().contains(i))return n}return null}Ei($6e);Ei(bce);Ei(vce);qs.appendMenuItem(He.EditorTitle,{command:{id:new vce().desc.id,title:_(119,"Use Inline View When Space Is Limited"),toggled:de.has("config.diffEditor.useInlineViewWhenSpaceIsLimited"),precondition:de.has("isInDiffEditor")},order:11,group:"1_diff",when:de.and(B.diffEditorRenderSideBySideInlineBreakpointReached,de.has("isInDiffEditor"))});qs.appendMenuItem(He.EditorTitle,{command:{id:new bce().desc.id,title:_(120,"Show Moved Code Blocks"),icon:ge.move,toggled:i0.create("config.diffEditor.experimental.showMoves",!0),precondition:de.has("isInDiffEditor")},order:10,group:"1_diff",when:de.has("isInDiffEditor")});Ei(G7);for(const s of[{icon:ge.arrowRight,key:B.diffEditorInlineMode.toNegated()},{icon:ge.discard,key:B.diffEditorInlineMode}])qs.appendMenuItem(He.DiffEditorHunkToolbar,{command:{id:new G7().desc.id,title:_(121,"Revert Block"),icon:s.icon},when:de.and(B.diffEditorModifiedWritable,s.key),order:5,group:"primary"}),qs.appendMenuItem(He.DiffEditorSelectionToolbar,{command:{id:new G7().desc.id,title:_(122,"Revert Selection"),icon:s.icon},when:de.and(B.diffEditorModifiedWritable,s.key),order:5,group:"primary"});Ei(q6e);Ei(j6e);Ei(K6e);Ei(G6e);qs.appendMenuItem(He.EditorTitle,{command:{id:dI.id,title:_(123,"Open Accessible Diff Viewer"),precondition:de.has("isInDiffEditor")},order:10,group:"2_diff",when:de.and(B.accessibleDiffViewerVisible.negate(),de.has("isInDiffEditor"))});Zt.registerCommandAlias("editor.action.diffReview.next",dI.id);Ei(dI);Zt.registerCommandAlias("editor.action.diffReview.prev",c2.id);Ei(c2);var X6e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Z6e=function(s,e){return function(t,i){e(t,i,s)}},Y7;const g4=new Ne("selectionAnchorSet",!1);var D_;let Sm=(D_=class{static get(e){return e.getContribution(Y7.ID)}constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=g4.bindTo(t),this.modelChangeListener=e.onDidChangeModel(()=>this.selectionAnchorSetContextKey.reset())}setSelectionAnchor(){if(this.editor.hasModel()){const e=this.editor.getPosition();this.editor.changeDecorations(t=>{this.decorationId&&t.removeDecoration(this.decorationId),this.decorationId=t.addDecoration(Oe.fromPositions(e,e),{description:"selection-anchor",stickiness:1,hoverMessage:new To().appendText(_(798,"Selection Anchor")),className:"selection-anchor"})}),this.selectionAnchorSetContextKey.set(!!this.decorationId),br(_(799,"Anchor set at {0}:{1}",e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){const t=this.editor.getPosition();this.editor.setSelection(Oe.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){if(this.decorationId){const e=this.decorationId;this.editor.changeDecorations(t=>{t.removeDecoration(e),this.decorationId=void 0}),this.selectionAnchorSetContextKey.set(!1)}}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}},Y7=D_,D_.ID="editor.contrib.selectionAnchorController",D_);Sm=Y7=X6e([Z6e(1,ut)],Sm);class Q6e extends Fe{constructor(){super({id:"editor.action.setSelectionAnchor",label:ne(800,"Set Selection Anchor"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2080),weight:100}})}async run(e,t){var i;(i=Sm.get(t))==null||i.setSelectionAnchor()}}class J6e extends Fe{constructor(){super({id:"editor.action.goToSelectionAnchor",label:ne(801,"Go to Selection Anchor"),precondition:g4})}async run(e,t){var i;(i=Sm.get(t))==null||i.goToSelectionAnchor()}}class eHe extends Fe{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:ne(802,"Select from Anchor to Cursor"),precondition:g4,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2089),weight:100}})}async run(e,t){var i;(i=Sm.get(t))==null||i.selectFromAnchorToCursor()}}class tHe extends Fe{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:ne(803,"Cancel Selection Anchor"),precondition:g4,kbOpts:{kbExpr:B.editorTextFocus,primary:9,weight:100}})}async run(e,t){var i;(i=Sm.get(t))==null||i.cancelSelectionAnchor()}}Qt(Sm.ID,Sm,4);xe(Q6e);xe(J6e);xe(eHe);xe(tHe);const iHe=F("editorOverviewRuler.bracketMatchForeground","#A0A0A0",_(804,"Overview ruler marker color for matching brackets."));class nHe extends Fe{constructor(){super({id:"editor.action.jumpToBracket",label:ne(806,"Go to Bracket"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:3165,weight:100}})}run(e,t){var i;(i=jb.get(t))==null||i.jumpToBracket()}}class sHe extends Fe{constructor(){super({id:"editor.action.selectToBracket",label:ne(807,"Select to Bracket"),precondition:void 0,metadata:{description:ne(808,"Select the text inside and including the brackets or curly braces"),args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){var o;let n=!0;i&&i.selectBrackets===!1&&(n=!1),(o=jb.get(t))==null||o.selectToBracket(n)}}class oHe extends Fe{constructor(){super({id:"editor.action.removeBrackets",label:ne(809,"Remove Brackets"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:2561,weight:100},canTriggerInlineEdits:!0})}run(e,t){var i;(i=jb.get(t))==null||i.removeBrackets(this.id)}}class rHe{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}const eg=class eg extends K{static get(e){return e.getContribution(eg.ID)}constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new Ni(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(80),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(80)&&(this._matchBrackets=this._editor.getOption(80),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const n=i.getStartPosition(),o=e.bracketPairs.matchBracket(n);let r=null;if(o)o[0].containsPosition(n)&&!o[1].containsPosition(n)?r=o[1].getStartPosition():o[1].containsPosition(n)&&(r=o[0].getStartPosition());else{const a=e.bracketPairs.findEnclosingBrackets(n);if(a)r=a[1].getStartPosition();else{const l=e.bracketPairs.findNextBracket(n);l&&l.range&&(r=l.range.getStartPosition())}}return r?new Oe(r.lineNumber,r.column,r.lineNumber,r.column):new Oe(n.lineNumber,n.column,n.lineNumber,n.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(n=>{const o=n.getStartPosition();let r=t.bracketPairs.matchBracket(o);if(!r&&(r=t.bracketPairs.findEnclosingBrackets(o),!r)){const c=t.bracketPairs.findNextBracket(o);c&&c.range&&(r=t.bracketPairs.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(r){r.sort(D.compareRangesUsingStarts);const[c,d]=r;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?d.getEndPosition():d.getStartPosition(),d.containsPosition(o)){const h=a;a=l,l=h}}a&&l&&i.push(new Oe(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}removeBrackets(e){if(!this._editor.hasModel())return;const t=this._editor.getModel();this._editor.getSelections().forEach(i=>{const n=i.getPosition();let o=t.bracketPairs.matchBracket(n);o||(o=t.bracketPairs.findEnclosingBrackets(n)),o&&(this._editor.pushUndoStop(),this._editor.executeEdits(e,[{range:o[0],text:""},{range:o[1],text:""}]),this._editor.pushUndoStop())})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const e=[];let t=0;for(const i of this._lastBracketsData){const n=i.brackets;n&&(e[t++]={range:n[0],options:i.options},e[t++]={range:n[1],options:i.options})}this._decorations.set(e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let n=[];this._lastVersionId===i&&(n=this._lastBracketsData);const o=[];let r=0;for(let h=0,u=e.length;h<u;h++){const f=e[h];f.isEmpty()&&(o[r++]=f.getStartPosition())}o.length>1&&o.sort(z.compare);const a=[];let l=0,c=0;const d=n.length;for(let h=0,u=o.length;h<u;h++){const f=o[h];for(;c<d&&n[c].position.isBefore(f);)c++;if(c<d&&n[c].position.equals(f))a[l++]=n[c];else{let g=t.bracketPairs.matchBracket(f,20),m=eg._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!g&&this._matchBrackets==="always"&&(g=t.bracketPairs.findEnclosingBrackets(f,20),m=eg._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new rHe(f,g,m)}}this._lastBracketsData=a,this._lastVersionId=i}};eg.ID="editor.contrib.bracketMatchingController",eg._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=vt.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:Mn(iHe),position:Xa.Center}}),eg._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=vt.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});let jb=eg;Qt(jb.ID,jb,1);xe(sHe);xe(nHe);xe(oHe);qs.appendMenuItem(He.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:_(805,"Go to &&Bracket")},order:2});class aHe{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const i=this._selection.startLineNumber,n=this._selection.startColumn,o=this._selection.endColumn;if(!(this._isMovingLeft&&n===1)&&!(!this._isMovingLeft&&o===e.getLineMaxColumn(i)))if(this._isMovingLeft){const r=new D(i,n-1,i,n),a=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new D(i,o,i,o),a)}else{const r=new D(i,o,i,o+1),a=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new D(i,n,i,n),a)}}computeCursorState(e,t){return this._isMovingLeft?new Oe(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new Oe(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class wce extends Fe{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;const i=[],n=t.getSelections();for(const o of n)i.push(new aHe(o,this.left));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class lHe extends wce{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:ne(810,"Move Selected Text Left"),precondition:B.writable})}}class cHe extends wce{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:ne(811,"Move Selected Text Right"),precondition:B.writable})}}xe(lHe);xe(cHe);class dHe extends Fe{constructor(){super({id:"editor.action.transposeLetters",label:ne(812,"Transpose Letters"),precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=[],o=t.getSelections();for(const r of o){if(!r.isEmpty())continue;const a=r.startLineNumber,l=r.startColumn,c=i.getLineMaxColumn(a);if(a===1&&(l===1||l===2&&c===2))continue;const d=l===c?r.getPosition():bi.rightPosition(i,r.getPosition().lineNumber,r.getPosition().column),h=bi.leftPosition(i,d),u=bi.leftPosition(i,h),f=i.getValueInRange(D.fromPositions(u,h)),g=i.getValueInRange(D.fromPositions(h,d)),m=D.fromPositions(u,d);n.push(new vo(m,g+f))}n.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop())}}xe(dHe);const hHe=Mt("productService");function Cq(s,e){return{id:e,asString:async()=>s,asFile:()=>{},value:typeof s=="string"?s:void 0}}function uHe(s,e,t,i){const n={id:wv(),name:s,uri:e,data:t};return{id:i,asString:async()=>"",asFile:()=>n,value:void 0}}class yce{constructor(){this._entries=new Map}get size(){let e=0;for(const t of this._entries)e++;return e}has(e){return this._entries.has(this.toKey(e))}matches(e){const t=[...this._entries.keys()];return Gt.some(this,([i,n])=>n.asFile())&&t.push("files"),Sce(d2(e),t)}get(e){var t;return(t=this._entries.get(this.toKey(e)))==null?void 0:t[0]}append(e,t){const i=this._entries.get(e);i?i.push(t):this._entries.set(this.toKey(e),[t])}replace(e,t){this._entries.set(this.toKey(e),[t])}delete(e){this._entries.delete(this.toKey(e))}*[Symbol.iterator](){for(const[e,t]of this._entries)for(const i of t)yield[e,i]}toKey(e){return d2(e)}}function d2(s){return s.toLowerCase()}function gQ(s,e){return Sce(d2(s),e.map(d2))}function Sce(s,e){if(s==="*/*")return e.length>0;if(e.includes(s))return!0;const t=s.match(/^([a-z]+)\/([a-z]+|\*)$/i);if(!t)return!1;const[i,n,o]=t;return o==="*"?e.some(r=>r.startsWith(n+"/")):!1}const m4=Object.freeze({create:s=>uf(s.map(e=>e.toString())).join(`\r
`),split:s=>s.split(`\r
`),parse:s=>m4.split(s).filter(e=>!e.startsWith("#"))}),zd=class zd{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+zd.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new zd((this.value?[this.value,...e]:e).join(zd.sep))}};zd.sep=".",zd.None=new zd("@@none@@"),zd.Empty=new zd("");let En=zd;const fHe={ctrlCmd:!1,alt:!1};var hI;(function(s){s[s.Blur=1]="Blur",s[s.Gesture=2]="Gesture",s[s.Other=3]="Other"})(hI||(hI={}));var Hc;(function(s){s[s.NONE=0]="NONE",s[s.FIRST=1]="FIRST",s[s.SECOND=2]="SECOND",s[s.LAST=3]="LAST"})(Hc||(Hc={}));var tn;(function(s){s[s.First=1]="First",s[s.Second=2]="Second",s[s.Last=3]="Last",s[s.Next=4]="Next",s[s.Previous=5]="Previous",s[s.NextPage=6]="NextPage",s[s.PreviousPage=7]="PreviousPage",s[s.NextSeparator=8]="NextSeparator",s[s.PreviousSeparator=9]="PreviousSeparator"})(tn||(tn={}));var h2;(function(s){s[s.Title=1]="Title",s[s.Inline=2]="Inline",s[s.Input=3]="Input"})(h2||(h2={}));const Fo=Mt("quickInputService"),mQ={EDITORS:"CodeEditors",FILES:"CodeFiles"};class gHe{}const mHe={DragAndDropContribution:"workbench.contributions.dragAndDrop"};kn.add(mHe.DragAndDropContribution,new gHe);const qx=class qx{constructor(){}static getInstance(){return qx.INSTANCE}hasData(e){return e&&e===this.proto}getData(e){if(this.hasData(e))return this.data}};qx.INSTANCE=new qx;let X7=qx;function xce(s){var e,t,i,n;if(ad&&typeof((t=(e=globalThis.vscode)==null?void 0:e.webUtils)==null?void 0:t.getPathForFile)=="function")return(n=(i=globalThis.vscode)==null?void 0:i.webUtils)==null?void 0:n.getPathForFile(s)}function Lce(s){const e=new yce;for(const t of s.items){const i=t.type;if(t.kind==="string"){const n=new Promise(o=>t.getAsString(o));e.append(i,Cq(n))}else if(t.kind==="file"){const n=t.getAsFile();n&&e.append(i,pHe(n))}}return e}function pHe(s){const e=xce(s),t=e?Ze.parse(e):void 0;return uHe(s.name,t,async()=>new Uint8Array(await s.arrayBuffer()))}const _He=Object.freeze([mQ.EDITORS,mQ.FILES,zb.RESOURCES,zb.INTERNAL_URI_LIST]);function Ice(s,e=!1){const t=Lce(s),i=t.get(zb.INTERNAL_URI_LIST);if(i)t.replace(Un.uriList,i);else if(e||!t.has(Un.uriList)){const n=[];for(const o of s.items){const r=o.getAsFile();if(r){const a=xce(r);try{a?n.push(Ze.file(a).toString()):n.push(Ze.parse(r.name,!0).toString())}catch{}}}n.length&&t.replace(Un.uriList,Cq(m4.create(n)))}for(const n of _He)t.delete(n);return t}const Rk=Mt("IWorkspaceEditService");class wq{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(zg.is(t))return zg.lift(t);if(D1.is(t))return D1.lift(t);throw new Error("Unsupported edit")})}}class zg extends wq{static is(e){return e instanceof zg?!0:ws(e)&&Ze.isUri(e.resource)&&ws(e.textEdit)}static lift(e){return e instanceof zg?e:new zg(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class D1 extends wq{static is(e){return e instanceof D1?!0:ws(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof D1?e:new D1(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const yq=Mt("IEditorCancelService"),Ece=new Ne("cancellableOperation",!1,_(939,"Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));Vt(yq,class{constructor(){this._tokens=new WeakMap}add(s,e){let t=this._tokens.get(s);t||(t=s.invokeWithinContext(n=>{const o=Ece.bindTo(n.get(ut)),r=new Zo;return{key:o,tokens:r}}),this._tokens.set(s,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(s){const e=this._tokens.get(s);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);class bHe extends hn{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(yq).add(e,this))}dispose(){this._unregister(),super.dispose()}}Te(new class extends Is{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:Ece})}runEditorCommand(s,e){s.get(yq).cancel(e)}});let kce=class Z7{constructor(e,t){if(this.flags=t,(this.flags&1)!==0){const i=e.getModel();this.modelVersionId=i?Rb("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;(this.flags&4)!==0?this.position=e.getPosition():this.position=null,(this.flags&2)!==0?this.selection=e.getSelection():this.selection=null,(this.flags&8)!==0?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof Z7))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new Z7(e,this.flags))}};class Cf extends bHe{constructor(e,t,i,n){super(e,n),this._listener=new oe,t&4&&this._listener.add(e.onDidChangeCursorPosition(o=>{(!i||!D.containsPosition(i,o.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(o=>{(!i||!D.containsRange(i,o.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(o=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(o=>this.cancel())),this._listener.add(e.onDidChangeModelContent(o=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class Sq extends hn{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}var vHe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},CHe=function(s,e){return function(t,i){e(t,i,s)}};const wHe=vt.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:$se,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}}),BA=class BA extends K{constructor(e,t,i,n,o){super(),this.typeId=e,this.editor=t,this.range=i,this.delegate=o,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(n),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=we(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=we("span.icon");this.domNode.append(t),t.classList.add(...it.asClassNameArray(ge.loading),"codicon-modifier-spin");const i=()=>{const n=this.editor.getOption(75);this.domNode.style.height=`${n}px`,this.domNode.style.width=`${Math.ceil(.8*n)}px`};i(),this._register(this.editor.onDidChangeConfiguration(n=>{(n.hasChanged(61)||n.hasChanged(75))&&i()})),this._register(ee(this.domNode,ye.CLICK,n=>{this.delegate.cancel()}))}getId(){return BA.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}};BA.baseId="editor.widget.inlineProgressWidget";let Q7=BA,u2=class extends K{constructor(e,t,i){super(),this.id=e,this._editor=t,this._instantiationService=i,this._showDelay=500,this._showPromise=this._register(new mi),this._currentWidget=this._register(new mi),this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}dispose(){super.dispose(),this._currentDecorations.clear()}async showWhile(e,t,i,n,o){const r=this._operationIdPool++;this._currentOperation=r,this.clear(),this._showPromise.value=cf(()=>{const a=D.fromPositions(e);this._currentDecorations.set([{range:a,options:wHe}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(Q7,this.id,this._editor,a,t,n))},o??this._showDelay);try{return await i}finally{this._currentOperation===r&&(this.clear(),this._currentOperation=void 0)}}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};u2=vHe([CHe(2,$e)],u2);const Rf=Mt("openerService");function yHe(s,e){return s.with({fragment:`${e.startLineNumber},${e.startColumn}${e.endLineNumber?`-${e.endLineNumber}${e.endColumn?`,${e.endColumn}`:""}`:""}`})}function SHe(s){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(s.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},s=s.with({fragment:""})),{selection:e,uri:s}}var xHe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},LHe=function(s,e){return function(t,i){e(t,i,s)}};const Sc=Mt("markdownRendererService");let J7=class{constructor(e){this._openerService=e}render(e,t,i){const n={...t};n.actionHandler||(n.actionHandler=(r,a)=>Dce(this._openerService,r,a.isTrusted)),n.codeBlockRenderer||(n.codeBlockRenderer=(r,a)=>{var l;return((l=this._defaultCodeBlockRenderer)==null?void 0:l.renderCodeBlock(r,a,n??{}))??Promise.resolve(document.createElement("span"))});const o=Ik(e,n,i);return o.element.classList.add("rendered-markdown"),o}setDefaultCodeBlockRenderer(e){this._defaultCodeBlockRenderer=e}};J7=xHe([LHe(0,Rf)],J7);async function Dce(s,e,t,i){try{return await s.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:IHe(t),skipValidation:i})}catch(n){return _t(n),!1}}function IHe(s){return s===!0?!0:s&&Array.isArray(s.enabledCommands)?s.enabledCommands:!1}Vt(Sc,J7,1);var EHe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},pQ=function(s,e){return function(t,i){e(t,i,s)}},iN,Gg;let ca=(Gg=class{static get(e){return e.getContribution(iN.ID)}constructor(e,t,i){this._openerService=i,this._messageWidget=new mi,this._messageListeners=new oe,this._mouseOverMessage=!1,this._editor=e,this._visible=iN.MESSAGE_VISIBLE.bindTo(t)}dispose(){this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){if(br(ef(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),ef(e)){const n=this._messageListeners.add(Ik(e,{actionHandler:(o,r)=>{this.closeMessage(),Dce(this._openerService,o,r.isTrusted)}}));this._messageWidget.value=new FF(this._editor,t,n.element)}else this._messageWidget.value=new FF(this._editor,t,e);this._messageListeners.add(Se.debounce(this._editor.onDidBlurEditorText,(n,o)=>o,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&Ps(Ss(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(ee(this._messageWidget.value.getDomNode(),ye.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(ee(this._messageWidget.value.getDomNode(),ye.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(n=>{n.target.position&&(i?i.containsPosition(n.target.position)||this.closeMessage():i=new D(t.lineNumber-3,1,n.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(FF.fadeOut(this._messageWidget.value))}},iN=Gg,Gg.ID="editor.contrib.messageController",Gg.MESSAGE_VISIBLE=new Ne("messageVisible",!1,_(1287,"Whether the editor is currently showing an inline message")),Gg);ca=iN=EHe([pQ(1,ut),pQ(2,Rf)],ca);const kHe=Is.bindToContribution(ca.get);Te(new kHe({id:"leaveEditorMessage",precondition:ca.MESSAGE_VISIBLE,handler:s=>s.closeMessage(),kbOpts:{weight:130,primary:9}}));let FF=class{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(i),e.getDomNode().removeEventListener("animationend",t)},i=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:i},n){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const o=document.createElement("div");o.classList.add("anchor","top"),this._domNode.appendChild(o);const r=document.createElement("div");typeof n=="string"?(r.classList.add("message"),r.textContent=n):(n.classList.add("message"),r.appendChild(n)),this._domNode.appendChild(r);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};Qt(ca.ID,ca,4);class DHe{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class THe{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?vU(e,this._value,0,e.length,this._from,this._to):Qy(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class NHe{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?vU(e,this._value,0,e.length,this._from,this._to):Qy(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class RHe{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new NHe(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return D9(e,this._value.scheme);if(this._states[this._stateIdx]===2)return D9(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return pL(e,this._value.query);if(this._states[this._stateIdx]===5)return pL(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}const jx=class jx{static wrap(e){return e===void 0?jx.Val:e}static unwrap(e){return e===jx.Val?void 0:e}};jx.Val=Symbol("undefined_placeholder");let au=jx;class PD{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}class T1{static forUris(e=()=>!1,t=()=>!1){return new T1(new RHe(e,t))}static forStrings(){return new T1(new DHe)}static forConfigKeys(){return new T1(new THe)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new PD,this._root.segment=i.value());const o=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new PD,n.left.segment=i.value()),o.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new PD,n.right.segment=i.value()),o.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new PD,n.mid.segment=i.value()),o.push([0,n]),n=n.mid;else break}const r=au.unwrap(n.value);n.value=au.wrap(t),n.key=e;for(let a=o.length-1;a>=0;a--){const l=o[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const d=o[a][0],h=o[a+1][0];if(d===1&&h===1)o[a][1]=l.rotateLeft();else if(d===-1&&h===-1)o[a][1]=l.rotateRight();else if(d===1&&h===-1)l.right=o[a+1][1]=o[a+1][1].rotateRight(),o[a][1]=l.rotateLeft();else if(d===-1&&h===1)l.left=o[a+1][1]=o[a+1][1].rotateLeft(),o[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}return r}get(e){var t;return au.unwrap((t=this._getNode(e))==null?void 0:t.value)}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let o=this._root;for(;o;){const r=i.cmp(o.segment);if(r>0)n.push([-1,o]),o=o.left;else if(r<0)n.push([1,o]),o=o.right;else if(i.hasNext())i.next(),n.push([0,o]),o=o.mid;else break}if(o){if(t?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){const r=[[1,o]],a=this._min(o.right,r);if(a.key){o.key=a.key,o.value=a.value,o.segment=a.segment;const l=a.right;if(r.length>1){const[d,h]=r[r.length-1];switch(d){case-1:h.left=l;break;case 0:uL(!1);case 1:uL(!1)}}else o.right=l;const c=this._balanceByStack(r);if(n.length>0){const[d,h]=n[n.length-1];switch(d){case-1:h.left=c;break;case 0:h.mid=c;break;case 1:h.right=c;break}}else this._root=c}}else{const r=o.left??o.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=r;break;case 0:l.mid=r;break;case 1:l.right=r;break}}else this._root=r}this._root=this._balanceByStack(n)??this._root}}_min(e,t){for(;e.left;)t.push([-1,e]),e=e.left;return e}_balanceByStack(e){for(let t=e.length-1;t>=0;t--){const i=e[t][1];i.updateHeight();const n=i.balanceFactor();if(n>1?(i.right.balanceFactor()>=0||(i.right=i.right.rotateRight()),e[t][1]=i.rotateLeft()):n<-1&&(i.left.balanceFactor()<=0||(i.left=i.left.rotateLeft()),e[t][1]=i.rotateRight()),t>0)switch(e[t-1][0]){case-1:e[t-1][1].left=e[t][1];break;case 1:e[t-1][1].right=e[t][1];break;case 0:e[t-1][1].mid=e[t][1];break}else return e[0][1]}}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const o=t.cmp(i.segment);if(o>0)i=i.left;else if(o<0)i=i.right;else if(t.hasNext())t.next(),n=au.unwrap(i.value)||n,i=i.mid;else break}return i&&au.unwrap(i.value)||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const o=i.cmp(n.segment);if(o>0)n=n.left;else if(o<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?au.unwrap(n.value):void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value!==void 0&&t.push([e.key,au.unwrap(e.value)]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const wf=Mt("contextService");function eW(s){const e=s;return typeof(e==null?void 0:e.id)=="string"&&Ze.isUri(e.uri)}function MHe(s){const e=s;return typeof(e==null?void 0:e.id)=="string"&&!eW(s)&&!OHe(s)}const AHe={id:"empty-window"};function PHe(s,e){if(typeof s=="string"||typeof s>"u")return typeof s=="string"?{id:Xu(s)}:AHe;const t=s;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function OHe(s){const e=s;return typeof(e==null?void 0:e.id)=="string"&&Ze.isUri(e.configPath)}class FHe{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const tW="code-workspace";_(2050,"Code Workspace");const Tce="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function BHe(s){return s.id===Tce}var xq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},uI=function(s,e){return function(t,i){e(t,i,s)}};class Lq{constructor(e){this.copyMimeTypes=[],this.kind=e,this.providedDropEditKinds=[this.kind],this.providedPasteEditKinds=[this.kind]}async provideDocumentPasteEdits(e,t,i,n,o){const r=await this.getEdit(i,o);if(r)return{edits:[{insertText:r.insertText,title:r.title,kind:r.kind,handledMimeType:r.handledMimeType,yieldTo:r.yieldTo}],dispose(){}}}async provideDocumentDropEdits(e,t,i,n){const o=await this.getEdit(i,n);if(o)return{edits:[{insertText:o.insertText,title:o.title,kind:o.kind,handledMimeType:o.handledMimeType,yieldTo:o.yieldTo}],dispose(){}}}}const WA=class WA extends Lq{constructor(){super(En.Empty.append("text","plain")),this.id=WA.id,this.dropMimeTypes=[Un.text],this.pasteMimeTypes=[Un.text]}async getEdit(e,t){const i=e.get(Un.text);if(!i||e.has(Un.uriList))return;const n=await i.asString();return{handledMimeType:Un.text,title:_(926,"Insert Plain Text"),insertText:n,kind:this.kind}}};WA.id="text";let Kb=WA;class Nce extends Lq{constructor(){super(En.Empty.append("uri","path","absolute")),this.dropMimeTypes=[Un.uriList],this.pasteMimeTypes=[Un.uriList]}async getEdit(e,t){const i=await Rce(e);if(!i.length||t.isCancellationRequested)return;let n=0;const o=i.map(({uri:a,originalText:l})=>a.scheme===ct.file?a.fsPath:(n++,l)).join(" ");let r;return n>0?r=i.length>1?_(927,"Insert Uris"):_(928,"Insert Uri"):r=i.length>1?_(929,"Insert Paths"):_(930,"Insert Path"),{handledMimeType:Un.uriList,insertText:o,title:r,kind:this.kind}}}let f2=class extends Lq{constructor(e){super(En.Empty.append("uri","path","relative")),this._workspaceContextService=e,this.dropMimeTypes=[Un.uriList],this.pasteMimeTypes=[Un.uriList]}async getEdit(e,t){const i=await Rce(e);if(!i.length||t.isCancellationRequested)return;const n=bd(i.map(({uri:o})=>{const r=this._workspaceContextService.getWorkspaceFolder(o);return r?TNe(r.uri,o):void 0}));if(n.length)return{handledMimeType:Un.uriList,insertText:n.join(" "),title:i.length>1?_(931,"Insert Relative Paths"):_(932,"Insert Relative Path"),kind:this.kind}}};f2=xq([uI(0,wf)],f2);class WHe{constructor(){this.kind=new En("html"),this.providedPasteEditKinds=[this.kind],this.copyMimeTypes=[],this.pasteMimeTypes=["text/html"],this._yieldTo=[{mimeType:Un.text}]}async provideDocumentPasteEdits(e,t,i,n,o){var l;if(n.triggerKind!==VL.PasteAs&&!((l=n.only)!=null&&l.contains(this.kind)))return;const r=i.get("text/html"),a=await(r==null?void 0:r.asString());if(!(!a||o.isCancellationRequested))return{dispose(){},edits:[{insertText:a,yieldTo:this._yieldTo,title:_(933,"Insert HTML"),kind:this.kind}]}}}async function Rce(s){const e=s.get(Un.uriList);if(!e)return[];const t=await e.asString(),i=[];for(const n of m4.parse(t))try{i.push({uri:Ze.parse(n),originalText:n})}catch{}return i}const Jp={scheme:"*",hasAccessToAllModels:!0};let iW=class extends K{constructor(e,t){super(),this._register(e.documentDropEditProvider.register(Jp,new Kb)),this._register(e.documentDropEditProvider.register(Jp,new Nce)),this._register(e.documentDropEditProvider.register(Jp,new f2(t)))}};iW=xq([uI(0,We),uI(1,wf)],iW);let nW=class extends K{constructor(e,t){super(),this._register(e.documentPasteEditProvider.register(Jp,new Kb)),this._register(e.documentPasteEditProvider.register(Jp,new Nce)),this._register(e.documentPasteEditProvider.register(Jp,new f2(t))),this._register(e.documentPasteEditProvider.register(Jp,new WHe))}};nW=xq([uI(0,We),uI(1,wf)],nW);const Ql=class Ql{constructor(){this.value="",this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const e=this.pos;let t=0,i=this.value.charCodeAt(e),n;if(n=Ql._table[i],typeof n=="number")return this.pos+=1,{type:n,pos:e,len:1};if(Ql.isDigitCharacter(i)){n=8;do t+=1,i=this.value.charCodeAt(e+t);while(Ql.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}if(Ql.isVariableCharacter(i)){n=9;do i=this.value.charCodeAt(e+ ++t);while(Ql.isVariableCharacter(i)||Ql.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}n=10;do t+=1,i=this.value.charCodeAt(e+t);while(!isNaN(i)&&typeof Ql._table[i]>"u"&&!Ql.isDigitCharacter(i)&&!Ql.isVariableCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}};Ql._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};let sW=Ql;class _0{constructor(){this._children=[]}appendChild(e){return e instanceof pr&&this._children[this._children.length-1]instanceof pr?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,n=i.children.indexOf(e),o=i.children.slice(0);o.splice(n,1,...t),i._children=o,(function r(a,l){for(const c of a)c.parent=l,r(c.children,c)})(t,i)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof Mk)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}}class pr extends _0{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new pr(this.value)}}class Mce extends _0{}class _l extends Mce{static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}constructor(e){super(),this.index=e}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof b0?this._children[0]:void 0}clone(){const e=new _l(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}class b0 extends _0{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof pr&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const e=new b0;return this.options.forEach(e.appendChild,e),e}}class Iq extends _0{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let i=!1,n=e.replace(this.regexp,function(){return i=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(o=>o instanceof Vc&&!!o.elseValue)&&(n=this._replace([])),n}_replace(e){let t="";for(const i of this._children)if(i instanceof Vc){let n=e[i.index]||"";n=i.resolve(n),t+=n}else t+=i.toString();return t}toString(){return""}clone(){const e=new Iq;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}}class Vc extends _0{constructor(e,t,i,n){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=n}resolve(e){return this.shorthandName==="upcase"?e?e.toLocaleUpperCase():"":this.shorthandName==="downcase"?e?e.toLocaleLowerCase():"":this.shorthandName==="capitalize"?e?e[0].toLocaleUpperCase()+e.substr(1):"":this.shorthandName==="pascalcase"?e?this._toPascalCase(e):"":this.shorthandName==="camelcase"?e?this._toCamelCase(e):"":e&&typeof this.ifValue=="string"?this.ifValue:!e&&typeof this.elseValue=="string"?this.elseValue:e||""}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(i=>i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((i,n)=>n===0?i.charAt(0).toLowerCase()+i.substr(1):i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}clone(){return new Vc(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class fI extends Mce{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),t!==void 0?(this._children=[new pr(t)],!0):!1}clone(){const e=new fI(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}function _Q(s,e){const t=[...s];for(;t.length>0;){const i=t.shift();if(!e(i))break;t.unshift(...i.children)}}class Mk extends _0{get placeholderInfo(){if(!this._placeholders){const e=[];let t;this.walk(function(i){return i instanceof _l&&(e.push(i),t=!t||t.index<i.index?i:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,i=!1;return this.walk(n=>n===e?(i=!0,!1):(t+=n.len(),!0)),i?t:-1}fullLen(e){let t=0;return _Q([e],i=>(t+=i.len(),!0)),t}enclosingPlaceholders(e){const t=[];let{parent:i}=e;for(;i;)i instanceof _l&&t.push(i),i=i.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof fI&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){const e=new Mk;return this._children=this.children.map(t=>t.clone()),e}walk(e){_Q(this.children,e)}}class Gb{constructor(){this._scanner=new sW,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,i){const n=new Mk;return this.parseFragment(e,n),this.ensureFinalTabstop(n,i??!1,t??!1),n}parseFragment(e,t){const i=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););const n=new Map,o=[];t.walk(l=>(l instanceof _l&&(l.isFinalTabstop?n.set(0,void 0):!n.has(l.index)&&l.children.length>0?n.set(l.index,l.children):o.push(l)),!0));const r=(l,c)=>{const d=n.get(l.index);if(!d)return;const h=new _l(l.index);h.transform=l.transform;for(const u of d){const f=u.clone();h.appendChild(f),f instanceof _l&&n.has(f.index)&&!c.has(f.index)&&(c.add(f.index),r(f,c),c.delete(f.index))}t.replace(l,[h])},a=new Set;for(const l of o)r(l,a);return t.children.slice(i)}ensureFinalTabstop(e,t,i){(t||i&&e.placeholders.length>0)&&(e.placeholders.find(o=>o.index===0)||e.appendChild(new _l(0)))}_accept(e,t){if(e===void 0||this._token.type===e){const i=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),i}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){const n=this._scanner.next();if(n.type!==0&&n.type!==4&&n.type!==5)return!1}this._token=this._scanner.next()}const i=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new pr(t)),!0):!1}_parseTabstopOrVariableName(e){let t;const i=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new _l(Number(t)):new fI(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(i);const o=new _l(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(o),!0;if(!this._parse(o))return e.appendChild(new pr("${"+t+":")),o.children.forEach(e.appendChild,e),!0}else if(o.index>0&&this._accept(7)){const r=new b0;for(;;){if(this._parseChoiceElement(r)){if(this._accept(2))continue;if(this._accept(7)&&(o.appendChild(r),this._accept(4)))return e.appendChild(o),!0}return this._backTo(i),!1}}else return this._accept(6)?this._parseTransform(o)?(e.appendChild(o),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(o),!0):this._backTo(i)}_parseChoiceElement(e){const t=this._token,i=[];for(;!(this._token.type===2||this._token.type===7);){let n;if((n=this._accept(5,!0))?n=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||n:n=this._accept(void 0,!0),!n)return this._backTo(t),!1;i.push(n)}return i.length===0?(this._backTo(t),!1):(e.appendChild(new pr(i.join(""))),!0)}_parseComplexVariable(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(i);const o=new fI(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(o),!0;if(!this._parse(o))return e.appendChild(new pr("${"+t+":")),o.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(o)?(e.appendChild(o),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(o),!0):this._backTo(i)}_parseTransform(e){const t=new Iq;let i="",n="";for(;!this._accept(6);){let o;if(o=this._accept(5,!0)){o=this._accept(6,!0)||o,i+=o;continue}if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let o;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,t.appendChild(new pr(o));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(i,n)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);const n=this._accept(8,!0);if(n)if(i){if(this._accept(4))return e.appendChild(new Vc(Number(n))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new Vc(Number(n))),!0;else return this._backTo(t),!1;if(this._accept(6)){const o=this._accept(9,!0);return!o||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new Vc(Number(n),o)),!0)}else if(this._accept(11)){const o=this._until(4);if(o)return e.appendChild(new Vc(Number(n),void 0,o,void 0)),!0}else if(this._accept(12)){const o=this._until(4);if(o)return e.appendChild(new Vc(Number(n),void 0,void 0,o)),!0}else if(this._accept(13)){const o=this._until(1);if(o){const r=this._until(4);if(r)return e.appendChild(new Vc(Number(n),void 0,o,r)),!0}}else{const o=this._until(4);if(o)return e.appendChild(new Vc(Number(n),void 0,void 0,o)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new pr(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}function Ace(s,e,t){var i,n;return(typeof t.insertText=="string"?t.insertText==="":t.insertText.snippet==="")?{edits:((i=t.additionalEdit)==null?void 0:i.edits)??[]}:{edits:[...e.map(o=>new zg(s,{range:o,text:typeof t.insertText=="string"?Gb.escape(t.insertText)+"$0":t.insertText.snippet,insertAsSnippet:!0})),...((n=t.additionalEdit)==null?void 0:n.edits)??[]]}}function Pce(s){function e(r,a){return"mimeType"in r?r.mimeType===a.handledMimeType:!!a.kind&&r.kind.contains(a.kind)}const t=new Map;for(const r of s)for(const a of r.yieldTo??[])for(const l of s)if(l!==r&&e(a,l)){let c=t.get(r);c||(c=[],t.set(r,c)),c.push(l)}if(!t.size)return Array.from(s);const i=new Set,n=[];function o(r){if(!r.length)return[];const a=r[0];if(n.includes(a))return console.warn("Yield to cycle detected",a),r;if(i.has(a))return o(r.slice(1));let l=[];const c=t.get(a);return c&&(n.push(a),l=o(c),n.pop()),i.add(a),[...l,a,...o(r.slice(1))]}return o(Array.from(s))}re.white.toString(),re.white.toString();const HHe=Object.freeze({allowedTags:{override:["b","i","u","code","span"]},allowedAttributes:{override:["class"]}});class g2 extends K{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new q),this._onDidEscape=this._register(new q),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this.enabled=!t.disabled,this._register(Oo.addTarget(this._element)),[ye.CLICK,Qi.Tap].forEach(o=>{this._register(ee(this._element,o,r=>{if(!this.enabled){ri.stop(r);return}this._onDidClick.fire(r)}))}),this._register(ee(this._element,ye.KEY_DOWN,o=>{const r=new Bi(o);let a=!1;this.enabled&&(r.equals(3)||r.equals(10))?(this._onDidClick.fire(o),a=!0):r.equals(9)&&(this._onDidEscape.fire(o),this._element.blur(),a=!0),a&&ri.stop(r,!0)})),this._register(ee(this._element,ye.MOUSE_OVER,o=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(ee(this._element,ye.MOUSE_OUT,o=>{this.updateBackground(!1)})),this.focusTracker=this._register(Ol(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of Hg(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var n;if(this._label===e||ef(this._label)&&ef(e)&&KBe(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(ef(e)){const o=Ik(e,void 0,document.createElement("span"));o.dispose();const r=(n=o.element.querySelector("p"))==null?void 0:n.innerHTML;r?Ble(t,r,HHe):Os(t)}else this.options.supportIcons?Os(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=fWe(e)),this.setTitle(i),this._setAriaLabel(),this._label=e}get label(){return this._label}_setAriaLabel(){typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):typeof this.options.title=="string"&&this._element.setAttribute("aria-label",this.options.title)}set icon(e){this._setAriaLabel();const t=Array.from(this._element.classList).filter(i=>i.startsWith("codicon-"));this._element.classList.remove(...t),this._element.classList.add(...it.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(yc().setupManagedHover(this.options.hoverDelegate??Fh("element"),this._element,e)):this._hover&&this._hover.update(e)}}function BF(s,e){return e&&(s.stack||s.stacktrace)?_(29,"{0}: {1}",vQ(s),bQ(s.stack)||bQ(s.stacktrace)):vQ(s)}function bQ(s){return Array.isArray(s)?s.join(`
`):s}function vQ(s){return s.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${s.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof s.code=="string"&&typeof s.errno=="number"&&typeof s.syscall=="string"?_(30,"A system error occurred ({0})",s.message):s.message||_(31,"An unknown error occurred. Please consult the log for more details.")}function m2(s=null,e=!1){if(!s)return _(32,"An unknown error occurred. Please consult the log for more details.");if(Array.isArray(s)){const t=bd(s),i=m2(t[0],e);return t.length>1?_(33,"{0} ({1} errors in total)",i,t.length):i}if(As(s))return s;if(s.detail){const t=s.detail;if(t.error)return BF(t.error,e);if(t.exception)return BF(t.exception,e)}return s.stack?BF(s,e):s.message?s.message:_(34,"An unknown error occurred. Please consult the log for more details.")}const OD=we,VHe={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class v0 extends K{constructor(e,t,i){super(),this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const n=this.options.keybindingLabelForeground;this.domNode=me(e,OD(".monaco-keybinding")),n&&(this.domNode.style.color=n),this.hover=this._register(yc().setupManagedHover(Fh("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}set(e,t){this.didEverRender&&this.keybinding===e&&v0.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let i=1;i<e.length;i++)me(this.domNode,OD("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[i],this.matches?this.matches.chordPart:null);const t=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(t),this.domNode.setAttribute("aria-label",t||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){io(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const n=pq.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,!!(i!=null&&i.ctrlKey),n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,!!(i!=null&&i.shiftKey),n.separator),t.altKey&&this.renderKey(e,n.altKey,!!(i!=null&&i.altKey),n.separator),t.metaKey&&this.renderKey(e,n.metaKey,!!(i!=null&&i.metaKey),n.separator);const o=t.keyLabel;o&&this.renderKey(e,o,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,n){me(e,this.createKeyElement(t,i?".highlight":"")),n&&me(e,OD("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){me(e,this.createKeyElement(_(15,"Unbound")))}createKeyElement(e,t=""){const i=OD("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&la(e.firstPart,t.firstPart)&&la(e.chordPart,t.chordPart)}}const Bh=Mt("layoutService");var Oce=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nN=function(s,e){return function(t,i){e(t,i,s)}};const Fce="acceptSelectedCodeAction",Bce="previewSelectedCodeAction";class zHe{get templateId(){return"header"}renderTemplate(e){e.classList.add("group-header");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){var n;i.text.textContent=((n=e.group)==null?void 0:n.title)??e.label??""}disposeTemplate(e){}}class UHe{get templateId(){return"separator"}renderTemplate(e){e.classList.add("separator");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){i.text.textContent=e.label??""}disposeTemplate(e){}}let oW=class{get templateId(){return"action"}constructor(e,t){this._supportsPreview=e,this._keybindingService=t}renderTemplate(e){e.classList.add(this.templateId);const t=document.createElement("div");t.className="icon",e.append(t);const i=document.createElement("span");i.className="title",e.append(i);const n=document.createElement("span");n.className="description",e.append(n);const o=new v0(e,sa);return{container:e,icon:t,text:i,description:n,keybinding:o}}renderElement(e,t,i){var r,a,l;if((r=e.group)!=null&&r.icon?(i.icon.className=it.asClassName(e.group.icon),e.group.icon.color&&(i.icon.style.color=ve(e.group.icon.color.id))):(i.icon.className=it.asClassName(ge.lightBulb),i.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!e.item||!e.label)return;$Te(!e.hideIcon,i.icon),i.text.textContent=p2(e.label),e.keybinding?(i.description.textContent=e.keybinding.getLabel(),i.description.style.display="inline",i.description.style.letterSpacing="0.5px"):e.description?(i.description.textContent=p2(e.description),i.description.style.display="inline"):(i.description.textContent="",i.description.style.display="none");const n=(a=this._keybindingService.lookupKeybinding(Fce))==null?void 0:a.getLabel(),o=(l=this._keybindingService.lookupKeybinding(Bce))==null?void 0:l.getLabel();i.container.classList.toggle("option-disabled",e.disabled),e.tooltip?i.container.title=e.tooltip:e.disabled?i.container.title=e.label:n&&o?this._supportsPreview&&e.canPreview?i.container.title=_(1653,"{0} to Apply, {1} to Preview",n,o):i.container.title=_(1654,"{0} to Apply",n):i.container.title=""}disposeTemplate(e){e.keybinding.dispose()}};oW=Oce([nN(1,ai)],oW);class $He extends UIEvent{constructor(){super("acceptSelectedAction")}}class CQ extends UIEvent{constructor(){super("previewSelectedAction")}}function qHe(s){if(s.kind==="action")return s.label}let rW=class extends K{constructor(e,t,i,n,o,r,a,l){super(),this._delegate=n,this._contextViewService=r,this._keybindingService=a,this._layoutService=l,this._actionLineHeight=28,this._headerLineHeight=28,this._separatorLineHeight=8,this.cts=this._register(new hn),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const c={getHeight:d=>{switch(d.kind){case"header":return this._headerLineHeight;case"separator":return this._separatorLineHeight;default:return this._actionLineHeight}},getTemplateId:d=>d.kind};this._list=this._register(new nl(e,this.domNode,c,[new oW(t,this._keybindingService),new zHe,new UHe],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:qHe},accessibilityProvider:{getAriaLabel:d=>{if(d.kind==="action"){let h=d.label?p2(d==null?void 0:d.label):"";return d.description&&(h=h+", "+p2(d.description)),d.disabled&&(h=_(1655,"{0}, Disabled Reason: {1}",h,d.disabled)),h}return null},getWidgetAriaLabel:()=>_(1656,"Action Widget"),getRole:d=>{switch(d.kind){case"action":return"option";case"separator":return"separator";default:return"separator"}},getWidgetRole:()=>"listbox",...o}})),this._list.style(p0),this._register(this._list.onMouseClick(d=>this.onListClick(d))),this._register(this._list.onMouseOver(d=>this.onListHover(d))),this._register(this._list.onDidChangeFocus(()=>this.onFocus())),this._register(this._list.onDidChangeSelection(d=>this.onListSelection(d))),this._allMenuItems=i,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(e){return!e.disabled&&e.kind==="action"}hide(e){this._delegate.onHide(e),this.cts.cancel(),this._contextViewService.hideContextView()}layout(e){const t=this._allMenuItems.filter(d=>d.kind==="header").length,i=this._allMenuItems.filter(d=>d.kind==="separator").length,r=this._allMenuItems.length*this._actionLineHeight+t*this._headerLineHeight-t*this._actionLineHeight+i*this._separatorLineHeight-i*this._actionLineHeight;this._list.layout(r);let a=e;if(this._allMenuItems.length>=50)a=380;else{const d=this._allMenuItems.map((h,u)=>{const f=this.domNode.ownerDocument.getElementById(this._list.getElementID(u));if(f){f.style.width="auto";const g=f.getBoundingClientRect().width;return f.style.width="",g}return 0});a=Math.max(...d,e)}const c=Math.min(r,this._layoutService.getContainer(je(this.domNode)).clientHeight*.7);return this._list.layout(c,a),this.domNode.style.height=`${c}px`,this._list.domFocus(),a}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(e){const t=this._list.getFocus();if(t.length===0)return;const i=t[0],n=this._list.element(i);if(!this.focusCondition(n))return;const o=e?new CQ:new $He;this._list.setSelection([i],o)}onListSelection(e){if(!e.elements.length)return;const t=e.elements[0];t.item&&this.focusCondition(t)?this._delegate.onSelect(t.item,e.browserEvent instanceof CQ):this._list.setSelection([])}onFocus(){var n,o;const e=this._list.getFocus();if(e.length===0)return;const t=e[0],i=this._list.element(t);(o=(n=this._delegate).onFocus)==null||o.call(n,i.item)}async onListHover(e){const t=e.element;if(t&&t.item&&this.focusCondition(t)){if(this._delegate.onHover&&!t.disabled&&t.kind==="action"){const i=await this._delegate.onHover(t.item,this.cts.token);t.canPreview=i?i.canPreview:void 0}e.index&&this._list.splice(e.index,1,[t])}this._list.setFocus(typeof e.index=="number"?[e.index]:[])}onListClick(e){e.element&&this.focusCondition(e.element)&&this._list.setFocus([])}};rW=Oce([nN(5,Nf),nN(6,ai),nN(7,Bh)],rW);function p2(s){return s.replace(/\r\n|\r|\n/g," ")}var jHe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},WF=function(s,e){return function(t,i){e(t,i,s)}};F("actionBar.toggledBackground",d0,_(1657,"Background color for toggled action items in action bar."));const Yb={Visible:new Ne("codeActionMenuVisible",!1,_(1658,"Whether the action widget list is visible"))},Am=Mt("actionWidgetService");let Xb=class extends K{get isVisible(){return Yb.Visible.getValue(this._contextKeyService)||!1}constructor(e,t,i){super(),this._contextViewService=e,this._contextKeyService=t,this._instantiationService=i,this._list=this._register(new mi)}show(e,t,i,n,o,r,a,l){const c=Yb.Visible.bindTo(this._contextKeyService),d=this._instantiationService.createInstance(rW,e,t,i,n,l);this._contextViewService.showContextView({getAnchor:()=>o,render:h=>(c.set(!0),this._renderWidget(h,d,a??[])),onHide:h=>{c.reset(),this._onWidgetClosed(h)}},r,!1)}acceptSelected(e){var t;(t=this._list.value)==null||t.acceptSelected(e)}focusPrevious(){var e,t;(t=(e=this._list)==null?void 0:e.value)==null||t.focusPrevious()}focusNext(){var e,t;(t=(e=this._list)==null?void 0:e.value)==null||t.focusNext()}hide(e){var t;(t=this._list.value)==null||t.hide(e),this._list.clear()}_renderWidget(e,t,i){var f;const n=document.createElement("div");if(n.classList.add("action-widget"),e.appendChild(n),this._list.value=t,this._list.value)n.appendChild(this._list.value.domNode);else throw new Error("List has no value");const o=new oe,r=document.createElement("div"),a=e.appendChild(r);a.classList.add("context-view-block"),o.add(ee(a,ye.MOUSE_DOWN,g=>g.stopPropagation()));const l=document.createElement("div"),c=e.appendChild(l);c.classList.add("context-view-pointerBlock"),o.add(ee(c,ye.POINTER_MOVE,()=>c.remove())),o.add(ee(c,ye.MOUSE_DOWN,()=>c.remove()));let d=0;if(i.length){const g=this._createActionBar(".action-widget-action-bar",i);g&&(n.appendChild(g.getContainer().parentElement),o.add(g),d=g.getContainer().offsetWidth)}const h=(f=this._list.value)==null?void 0:f.layout(d);n.style.width=`${h}px`;const u=o.add(Ol(e));return o.add(u.onDidBlur(()=>this.hide(!0))),o}_createActionBar(e,t){if(!t.length)return;const i=we(e),n=new Fr(i);return n.push(t,{icon:!1,label:!0}),n}_onWidgetClosed(e){var t;(t=this._list.value)==null||t.hide(e)}};Xb=jHe([WF(0,Nf),WF(1,ut),WF(2,$e)],Xb);Vt(Am,Xb,1);const Ak=1100;Ei(class extends Gs{constructor(){super({id:"hideCodeActionWidget",title:ne(1659,"Hide action widget"),precondition:Yb.Visible,keybinding:{weight:Ak,primary:9,secondary:[1033]}})}run(s){s.get(Am).hide(!0)}});Ei(class extends Gs{constructor(){super({id:"selectPrevCodeAction",title:ne(1660,"Select previous action"),precondition:Yb.Visible,keybinding:{weight:Ak,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(s){const e=s.get(Am);e instanceof Xb&&e.focusPrevious()}});Ei(class extends Gs{constructor(){super({id:"selectNextCodeAction",title:ne(1661,"Select next action"),precondition:Yb.Visible,keybinding:{weight:Ak,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(s){const e=s.get(Am);e instanceof Xb&&e.focusNext()}});Ei(class extends Gs{constructor(){super({id:Fce,title:ne(1662,"Accept selected action"),precondition:Yb.Visible,keybinding:{weight:Ak,primary:3,secondary:[2137]}})}run(s){const e=s.get(Am);e instanceof Xb&&e.acceptSelected()}});Ei(class extends Gs{constructor(){super({id:Bce,title:ne(1663,"Preview selected action"),precondition:Yb.Visible,keybinding:{weight:Ak,primary:2051}})}run(s){const e=s.get(Am);e instanceof Xb&&e.acceptSelected(!0)}});var Wce=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},N1=function(s,e){return function(t,i){e(t,i,s)}},aW,T_;let lW=(T_=class extends K{constructor(e,t,i,n,o,r,a,l,c,d,h){super(),this.typeId=e,this.editor=t,this.showCommand=n,this.range=o,this.edits=r,this.onSelectNewEdit=a,this.additionalActions=l,this._keybindingService=d,this._actionWidgetService=h,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=i.bindTo(c),this.visibleContext.set(!0),this._register(Ve(()=>this.visibleContext.reset())),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register(Ve((()=>this.editor.removeContentWidget(this)))),this._register(this.editor.onDidChangeCursorPosition(u=>{this.dispose()})),this._register(Se.runAndSubscribe(d.onDidUpdateKeybindings,()=>{this._updateButtonTitle()}))}_updateButtonTitle(){var t;const e=(t=this._keybindingService.lookupKeybinding(this.showCommand.id))==null?void 0:t.getLabel();this.button.element.title=this.showCommand.label+(e?` (${e})`:"")}create(){this.domNode=we(".post-edit-widget"),this.button=this._register(new g2(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(ee(this.domNode,ye.CLICK,()=>this.showSelector()))}getId(){return aW.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){const e=Fn(this.button.element),t={x:e.left+e.width,y:e.top+e.height};this._actionWidgetService.show("postEditWidget",!1,this.edits.allEdits.map((i,n)=>({kind:"action",item:i,label:i.title,disabled:!1,canPreview:!1,group:{title:"",icon:it.fromId(n===this.edits.activeEditIndex?ge.check.id:ge.blank.id)}})),{onHide:()=>{this.editor.focus()},onSelect:i=>{this._actionWidgetService.hide(!1);const n=this.edits.allEdits.findIndex(o=>o===i);if(n!==this.edits.activeEditIndex)return this.onSelectNewEdit(n)}},t,this.editor.getDomNode()??void 0,this.additionalActions)}},aW=T_,T_.baseId="editor.widget.postEditWidget",T_);lW=aW=Wce([N1(8,ut),N1(9,ai),N1(10,Am)],lW);let _2=class extends K{constructor(e,t,i,n,o,r,a,l){super(),this._id=e,this._editor=t,this._visibleContext=i,this._showCommand=n,this._getAdditionalActions=o,this._instantiationService=r,this._bulkEditService=a,this._notificationService=l,this._currentWidget=this._register(new mi),this._register(Se.any(t.onDidChangeModel,t.onDidChangeModelContent)(()=>this.clear()))}async applyEditAndShowIfNeeded(e,t,i,n,o){if(!e.length||!this._editor.hasModel())return;const r=this._editor.getModel(),a=t.allEdits.at(t.activeEditIndex);if(!a)return;const l=async v=>{const b=this._editor.getModel();b&&(await b.undo(),this.applyEditAndShowIfNeeded(e,{activeEditIndex:v,allEdits:t.allEdits},i,n,o))},c=(v,b)=>{il(v)||(this._notificationService.error(b),i&&this.show(e[0],t,l))},d=new Cf(this._editor,3,void 0,o);let h;try{h=await Jke(n(a,d.token),d.token)}catch(v){return c(v,_(937,`Error resolving edit '{0}':
{1}`,a.title,m2(v)))}finally{d.dispose()}if(o.isCancellationRequested)return;const u=Ace(r.uri,e,h),f=e[0],g=r.deltaDecorations([],[{range:f,options:{description:"paste-line-suffix",stickiness:0}}]);this._editor.focus();let m,p;try{m=await this._bulkEditService.apply(u,{editor:this._editor,token:o}),p=r.getDecorationRange(g[0])}catch(v){return c(v,_(938,`Error applying edit '{0}':
{1}`,a.title,m2(v)))}finally{r.deltaDecorations(g,[])}o.isCancellationRequested||i&&m.isApplied&&t.allEdits.length>1&&this.show(p??f,t,l)}show(e,t,i){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(lW,this._id,this._editor,this._visibleContext,this._showCommand,e,t,i,this._getAdditionalActions()))}clear(){this._currentWidget.clear()}tryShowSelector(){var e;(e=this._currentWidget.value)==null||e.showSelector()}};_2=Wce([N1(5,$e),N1(6,Rk),N1(7,Hn)],_2);var KHe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Yh=function(s,e){return function(t,i){e(t,i,s)}},Xl;const Hce="editor.changePasteType",GHe="editor.pasteAs.preferences",Eq=new Ne("pasteWidgetVisible",!1,_(917,"Whether the paste widget is showing")),HF="application/vnd.code.copymetadata";var N_;let yf=(N_=class extends K{static get(e){return e.getContribution(Xl.ID)}constructor(e,t,i,n,o,r,a,l,c,d){super(),this._logService=i,this._bulkEditService=n,this._clipboardService=o,this._commandService=r,this._configService=a,this._languageFeaturesService=l,this._quickInputService=c,this._progressService=d,this._editor=e;const h=e.getContainerDomNode();this._register(ee(h,"copy",u=>this.handleCopy(u))),this._register(ee(h,"cut",u=>this.handleCopy(u))),this._register(ee(h,"paste",u=>this.handlePaste(u),!0)),this._pasteProgressManager=this._register(new u2("pasteIntoEditor",e,t)),this._postPasteWidgetManager=this._register(t.createInstance(_2,"pasteIntoEditor",e,Eq,{id:Hce,label:_(918,"Show paste options...")},()=>Xl._configureDefaultAction?[Xl._configureDefaultAction]:[]))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}async pasteAs(e){this._logService.trace("CopyPasteController.pasteAs"),this._editor.focus();try{this._logService.trace("Before calling editor.action.clipboardPasteAction"),this._pasteAsActionContext={preferred:e},await this._commandService.executeCommand("editor.action.clipboardPasteAction")}finally{this._pasteAsActionContext=void 0}}clearWidgets(){this._postPasteWidgetManager.clear()}isPasteAsEnabled(){return this._editor.getOption(97).enabled}async finishedPaste(){await this._currentPasteOperation}handleCopy(e){var p,v,b,w;let t=null;if(e.clipboardData){const[C,y]=h_.getTextData(e.clipboardData),x=y||mh.INSTANCE.get(C);t=(x==null?void 0:x.id)||null,this._logService.trace("CopyPasteController#handleCopy for id : ",t," with text.length : ",C.length)}else this._logService.trace("CopyPasteController#handleCopy");if(!this._editor.hasTextFocus()||((v=(p=this._clipboardService).clearInternalState)==null||v.call(p),!e.clipboardData||!this.isPasteAsEnabled()))return;const i=this._editor.getModel(),n=this._editor.getSelections();if(!i||!(n!=null&&n.length))return;const o=this._editor.getOption(45);let r=n;const a=n.length===1&&n[0].isEmpty();if(a){if(!o)return;r=[new D(r[0].startLineNumber,1,r[0].startLineNumber,1+i.getLineLength(r[0].startLineNumber))]}const l=(b=this._editor._getViewModel())==null?void 0:b.getPlainTextToCopy(n,o,no),d={multicursorText:Array.isArray(l)?l:null,pasteOnNewLine:a,mode:null},h=this._languageFeaturesService.documentPasteEditProvider.ordered(i).filter(C=>!!C.prepareDocumentPaste);if(!h.length){this.setCopyMetadata(e.clipboardData,{defaultPastePayload:d});return}const u=Lce(e.clipboardData),f=h.flatMap(C=>C.copyMimeTypes??[]),g=t??wv();this.setCopyMetadata(e.clipboardData,{id:g,providerCopyMimeTypes:f,defaultPastePayload:d});const m=h.map(C=>({providerMimeTypes:C.copyMimeTypes,operation:ys(y=>C.prepareDocumentPaste(i,r,u,y).catch(x=>{console.error(x)}))}));(w=Xl._currentCopyOperation)==null||w.operations.forEach(C=>C.operation.cancel()),Xl._currentCopyOperation={handle:g,operations:m}}async handlePaste(e){var c,d,h;if(e.clipboardData){const[u,f]=h_.getTextData(e.clipboardData),g=f||mh.INSTANCE.get(u);this._logService.trace("CopyPasteController#handlePaste for id : ",g==null?void 0:g.id)}else this._logService.trace("CopyPasteController#handlePaste");if(!e.clipboardData||!this._editor.hasTextFocus())return;(c=ca.get(this._editor))==null||c.closeMessage(),(d=this._currentPasteOperation)==null||d.cancel(),this._currentPasteOperation=void 0;const t=this._editor.getModel(),i=this._editor.getSelections();if(!(i!=null&&i.length)||!t||this._editor.getOption(104)||!this.isPasteAsEnabled()&&!this._pasteAsActionContext)return;const n=this.fetchCopyMetadata(e);this._logService.trace("CopyPasteController#handlePaste with metadata : ",n==null?void 0:n.id," and text.length : ",e.clipboardData.getData("text/plain").length);const o=Ice(e.clipboardData);o.delete(HF);const r=Array.from(e.clipboardData.files).map(u=>u.type),a=[...e.clipboardData.types,...r,...(n==null?void 0:n.providerCopyMimeTypes)??[],Un.uriList],l=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(u=>{var g,m;const f=(g=this._pasteAsActionContext)==null?void 0:g.preferred;return f&&!this.providerMatchesPreference(u,f)?!1:(m=u.pasteMimeTypes)==null?void 0:m.some(p=>gQ(p,a))});if(!l.length){(h=this._pasteAsActionContext)!=null&&h.preferred&&(this.showPasteAsNoEditMessage(i,this._pasteAsActionContext.preferred),e.preventDefault(),e.stopImmediatePropagation());return}e.preventDefault(),e.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferred,l,i,o,n):this.doPasteInline(l,i,o,n,e)}showPasteAsNoEditMessage(e,t){var n;const i="only"in t?t.only.value:"preferences"in t?t.preferences.length?t.preferences.map(o=>o.value).join(", "):_(919,"empty"):t.providerId;(n=ca.get(this._editor))==null||n.showMessage(_(920,"No paste edits for '{0}' found",i),e[0].getStartPosition())}doPasteInline(e,t,i,n,o){this._logService.trace("CopyPasteController#doPasteInline");const r=this._editor;if(!r.hasModel())return;const a=new Cf(r,3,void 0),l=ys(async c=>{const d=this._editor;if(!d.hasModel())return;const h=d.getModel(),u=new oe,f=u.add(new hn(c));u.add(a.token.onCancellationRequested(()=>f.cancel()));const g=f.token;try{if(await this.mergeInDataFromCopy(e,i,n,g),g.isCancellationRequested)return;const m=e.filter(b=>this.isSupportedPasteProvider(b,i));if(!m.length||m.length===1&&m[0]instanceof Kb)return this.applyDefaultPasteHandler(i,n,g,o);const p={triggerKind:VL.Automatic},v=await this.getPasteEdits(m,i,h,t,p,g);if(u.add(v),g.isCancellationRequested)return;if(v.edits.length===1&&v.edits[0].provider instanceof Kb)return this.applyDefaultPasteHandler(i,n,g,o);if(v.edits.length){const b=d.getOption(97).showPasteSelector==="afterPaste";return this._postPasteWidgetManager.applyEditAndShowIfNeeded(t,{activeEditIndex:this.getInitialActiveEditIndex(h,v.edits),allEdits:v.edits},b,async(w,C)=>{if(!w.provider.resolveDocumentPasteEdit)return w;const y=w.provider.resolveDocumentPasteEdit(w,C),x=new gv,S=await this._pasteProgressManager.showWhile(t[0].getEndPosition(),_(921,"Resolving paste edit for '{0}'. Click to cancel",w.title),mw(Promise.race([x.p,y]),C),{cancel:()=>x.cancel()},0);return S&&(w.insertText=S.insertText,w.additionalEdit=S.additionalEdit),w},g)}await this.applyDefaultPasteHandler(i,n,g,o)}finally{u.dispose(),this._currentPasteOperation===l&&(this._currentPasteOperation=void 0)}});this._pasteProgressManager.showWhile(t[0].getEndPosition(),_(922,"Running paste handlers. Click to cancel and do basic paste"),l,{cancel:async()=>{l.cancel(),!a.token.isCancellationRequested&&await this.applyDefaultPasteHandler(i,n,a.token,o)}}).finally(()=>{a.dispose()}),this._currentPasteOperation=l}showPasteAsPick(e,t,i,n,o){this._logService.trace("CopyPasteController#showPasteAsPick");const r=ys(async a=>{var u;const l=this._editor;if(!l.hasModel())return;const c=l.getModel(),d=new oe,h=d.add(new Cf(l,3,void 0,a));try{if(await this.mergeInDataFromCopy(t,n,o,h.token),h.token.isCancellationRequested)return;let f=t.filter(b=>this.isSupportedPasteProvider(b,n,e));e&&(f=f.filter(b=>this.providerMatchesPreference(b,e)));const g={triggerKind:VL.PasteAs,only:e&&"only"in e?e.only:void 0};let m=d.add(await this.getPasteEdits(f,n,c,i,g,h.token));if(h.token.isCancellationRequested)return;if(e&&(m={edits:m.edits.filter(b=>"only"in e?e.only.contains(b.kind):"preferences"in e?e.preferences.some(w=>w.contains(b.kind)):e.providerId===b.provider.id),dispose:m.dispose}),!m.edits.length){e&&this.showPasteAsNoEditMessage(i,e);return}let p;if(e)p=m.edits.at(0);else{const b={id:"editor.pasteAs.default",label:_(923,"Configure default paste action"),edit:void 0},w=await this._quickInputService.pick([...m.edits.map(C=>{var y;return{label:C.title,description:(y=C.kind)==null?void 0:y.value,edit:C}}),...Xl._configureDefaultAction?[{type:"separator"},{label:Xl._configureDefaultAction.label,edit:void 0}]:[]],{placeHolder:_(924,"Select Paste Action")});if(w===b){(u=Xl._configureDefaultAction)==null||u.run();return}p=w==null?void 0:w.edit}if(!p)return;const v=Ace(c.uri,i,p);await this._bulkEditService.apply(v,{editor:this._editor})}finally{d.dispose(),this._currentPasteOperation===r&&(this._currentPasteOperation=void 0)}});this._progressService.withProgress({location:10,title:_(925,"Running paste handlers")},()=>r)}setCopyMetadata(e,t){this._logService.trace("CopyPasteController#setCopyMetadata new id : ",t.id),e.setData(HF,JSON.stringify(t))}fetchCopyMetadata(e){if(this._logService.trace("CopyPasteController#fetchCopyMetadata"),!e.clipboardData)return;const t=e.clipboardData.getData(HF);if(t)try{return JSON.parse(t)}catch{return}const[i,n]=h_.getTextData(e.clipboardData);if(n)return{defaultPastePayload:{mode:n.mode,multicursorText:n.multicursorText??null,pasteOnNewLine:!!n.isFromEmptySelection}}}async mergeInDataFromCopy(e,t,i,n){var o;if(this._logService.trace("CopyPasteController#mergeInDataFromCopy with metadata : ",i==null?void 0:i.id),i!=null&&i.id&&((o=Xl._currentCopyOperation)==null?void 0:o.handle)===i.id){const r=Xl._currentCopyOperation.operations.filter(l=>e.some(c=>c.pasteMimeTypes.some(d=>gQ(d,l.providerMimeTypes)))).map(l=>l.operation),a=await Promise.all(r);if(n.isCancellationRequested)return;for(const l of a.reverse())if(l)for(const[c,d]of l)t.replace(c,d)}if(!t.has(Un.uriList)){const r=await this._clipboardService.readResources();if(n.isCancellationRequested)return;r.length&&t.append(Un.uriList,Cq(m4.create(r)))}}async getPasteEdits(e,t,i,n,o,r){const a=new oe,l=await mw(Promise.all(e.map(async d=>{var h,u;try{const f=await((h=d.provideDocumentPasteEdits)==null?void 0:h.call(d,i,n,t,o,r));return f&&a.add(f),(u=f==null?void 0:f.edits)==null?void 0:u.map(g=>({...g,provider:d}))}catch(f){il(f)||console.error(f);return}})),r),c=bd(l??[]).flat().filter(d=>!o.only||o.only.contains(d.kind));return{edits:Pce(c),dispose:()=>a.dispose()}}async applyDefaultPasteHandler(e,t,i,n){const o=e.get(Un.text)??e.get("text"),r=await(o==null?void 0:o.asString())??"";if(i.isCancellationRequested)return;const a={clipboardEvent:n,text:r,pasteOnNewLine:(t==null?void 0:t.defaultPastePayload.pasteOnNewLine)??!1,multicursorText:(t==null?void 0:t.defaultPastePayload.multicursorText)??null,mode:null};this._logService.trace("CopyPasteController#applyDefaultPasteHandler for id : ",t==null?void 0:t.id),this._editor.trigger("keyboard","paste",a)}isSupportedPasteProvider(e,t,i){var n;return(n=e.pasteMimeTypes)!=null&&n.some(o=>t.matches(o))?!i||this.providerMatchesPreference(e,i):!1}providerMatchesPreference(e,t){return"only"in t?e.providedPasteEditKinds.some(i=>t.only.contains(i)):"preferences"in t?t.preferences.some(i=>t.preferences.some(n=>n.contains(i))):e.id===t.providerId}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(GHe,{resource:e.uri});for(const n of Array.isArray(i)?i:[]){const o=new En(n),r=t.findIndex(a=>o.contains(a.kind));if(r>=0)return r}return 0}},Xl=N_,N_.ID="editor.contrib.copyPasteActionController",N_);yf=Xl=KHe([Yh(1,$e),Yh(2,Ji),Yh(3,Rk),Yh(4,pa),Yh(5,en),Yh(6,xt),Yh(7,We),Yh(8,Fo),Yh(9,nle)],yf);const Zb="9_cutcopypaste",YHe=ad||document.queryCommandSupported("cut"),Vce=ad||document.queryCommandSupported("copy"),XHe=typeof navigator.clipboard>"u"||Wr?document.queryCommandSupported("paste"):!0;function kq(s){return s.register(),s}const ZHe=YHe?kq(new n0({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:ad?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:He.MenubarEditMenu,group:"2_ccp",title:_(813,"Cu&&t"),order:1},{menuId:He.EditorContext,group:Zb,title:_(814,"Cut"),when:B.writable,order:1},{menuId:He.CommandPalette,group:"",title:_(815,"Cut"),order:1},{menuId:He.SimpleEditorContext,group:Zb,title:_(816,"Cut"),when:B.writable,order:1}]})):void 0,QHe=Vce?kq(new n0({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:ad?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:He.MenubarEditMenu,group:"2_ccp",title:_(817,"&&Copy"),order:2},{menuId:He.EditorContext,group:Zb,title:_(818,"Copy"),order:2},{menuId:He.CommandPalette,group:"",title:_(819,"Copy"),order:1},{menuId:He.SimpleEditorContext,group:Zb,title:_(820,"Copy"),order:2}]})):void 0;qs.appendMenuItem(He.MenubarEditMenu,{submenu:He.MenubarCopy,title:ne(825,"Copy As"),group:"2_ccp",order:3});qs.appendMenuItem(He.EditorContext,{submenu:He.EditorContextCopy,title:ne(826,"Copy As"),group:Zb,order:3});qs.appendMenuItem(He.EditorContext,{submenu:He.EditorContextShare,title:ne(827,"Share"),group:"11_share",order:-1,when:de.and(de.notEquals("resourceScheme","output"),B.editorTextFocus)});qs.appendMenuItem(He.ExplorerContext,{submenu:He.ExplorerContextShare,title:ne(828,"Share"),group:"11_share",order:-1});const VF=XHe?kq(new n0({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:ad?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:He.MenubarEditMenu,group:"2_ccp",title:_(821,"&&Paste"),order:4},{menuId:He.EditorContext,group:Zb,title:_(822,"Paste"),when:B.writable,order:4},{menuId:He.CommandPalette,group:"",title:_(823,"Paste"),order:1},{menuId:He.SimpleEditorContext,group:Zb,title:_(824,"Paste"),when:B.writable,order:4}]})):void 0;class JHe extends Fe{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:ne(829,"Copy with Syntax Highlighting"),precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:0,weight:100}})}run(e,t){const i=e.get(Ji);i.trace("ExecCommandCopyWithSyntaxHighlightingAction#run"),!(!t.hasModel()||!t.getOption(45)&&t.getSelection().isEmpty())&&(wB.forceCopyWithSyntaxHighlighting=!0,t.focus(),i.trace("ExecCommandCopyWithSyntaxHighlightingAction (before execCommand copy)"),t.getContainerDomNode().ownerDocument.execCommand("copy"),i.trace("ExecCommandCopyWithSyntaxHighlightingAction (after execCommand copy)"),wB.forceCopyWithSyntaxHighlighting=!1)}}function zce(s,e){s&&(s.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(Ji);n.trace("registerExecCommandImpl (addImplementation code-editor for : ",e,")");const o=t.get(ii).getFocusedCodeEditor();if(o&&o.hasTextFocus()){const r=o.getOption(45),a=o.getSelection();return a&&a.isEmpty()&&!r||(o.getOption(170)&&e==="cut"?(wQ(o),n.trace("registerExecCommandImpl (before execCommand copy)"),o.getContainerDomNode().ownerDocument.execCommand("copy"),o.trigger(void 0,"cut",void 0),n.trace("registerExecCommandImpl (after execCommand copy)")):(wQ(o),n.trace("registerExecCommandImpl (before execCommand "+e+")"),o.getContainerDomNode().ownerDocument.execCommand(e),n.trace("registerExecCommandImpl (after execCommand "+e+")"))),!0}return!1}),s.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(Ji);return n.trace("registerExecCommandImpl (addImplementation generic-dom for : ",e,")"),n.trace("registerExecCommandImpl (before execCommand "+e+")"),uk().execCommand(e),n.trace("registerExecCommandImpl (after execCommand "+e+")"),!0}))}function wQ(s){if(s.getOption(170)){const t=k$.get(s.getId());t&&t.onWillCopy()}}zce(ZHe,"cut");zce(QHe,"copy");VF&&(VF.addImplementation(1e4,"code-editor",(s,e)=>{const t=s.get(Ji);t.trace("registerExecCommandImpl (addImplementation code-editor for : paste)");const i=s.get(ii),n=s.get(pa),o=s.get(Wo),r=s.get(hHe),a=i.getFocusedCodeEditor();if(a&&a.hasModel()&&a.hasTextFocus()){if(a.getOption(170)){const h=k$.get(a.getId());h&&h.onWillPaste()}const c=Fs.create(!0);t.trace("registerExecCommandImpl (before triggerPaste)");const d=n.triggerPaste(xi().vscodeWindowId);return d?(t.trace("registerExecCommandImpl (triggerPaste defined)"),d.then(async()=>{var h;if(t.trace("registerExecCommandImpl (after triggerPaste)"),r.quality!=="stable"){const u=c.elapsed();o.publicLog2("editorAsyncPaste",{duration:u})}return((h=yf.get(a))==null?void 0:h.finishedPaste())??Promise.resolve()})):(t.trace("registerExecCommandImpl (triggerPaste undefined)"),Ah?(t.trace("registerExecCommandImpl (Paste handling on web)"),(async()=>{const h=await n.readText();if(h!==""){const u=mh.INSTANCE.get(h);let f=!1,g=null,m=null;u&&(f=a.getOption(45)&&!!u.isFromEmptySelection,g=typeof u.multicursorText<"u"?u.multicursorText:null,m=u.mode),t.trace("registerExecCommandImpl (clipboardText.length : ",h.length," id : ",u==null?void 0:u.id,")"),a.trigger("keyboard","paste",{text:h,pasteOnNewLine:f,multicursorText:g,mode:m})}})()):!0)}return!1}),VF.addImplementation(0,"generic-dom",(s,e)=>(s.get(Ji).trace("registerExecCommandImpl (addImplementation generic-dom for : paste)"),s.get(pa).triggerPaste(xi().vscodeWindowId)??!1)));Vce&&xe(JHe);const p4=Object.freeze({id:"editor",order:5,type:"object",title:_(147,"Editor"),scope:6}),b2={...p4,properties:{"editor.tabSize":{type:"number",default:po.tabSize,minimum:1,maximum:100,markdownDescription:_(148,"The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:_(149,'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:po.insertSpaces,markdownDescription:_(150,"Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:po.detectIndentation,markdownDescription:_(151,"Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:po.trimAutoWhitespace,description:_(152,"Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:po.largeFileOptimizations,description:_(153,"Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[_(154,"Turn off Word Based Suggestions."),_(155,"Only suggest words from the active document."),_(156,"Suggest words from all open documents of the same language."),_(157,"Suggest words from all open documents.")],description:_(158,"Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[_(159,"Semantic highlighting enabled for all color themes."),_(160,"Semantic highlighting disabled for all color themes."),_(161,"Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:_(162,"Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:_(163,"Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:_(164,"Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:_(165,"Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:_(166,"Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:_(167,"Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:_(168,"Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `#editor.experimental.preferTreeSitter#` for specific languages will take precedence."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.css":{type:"boolean",default:!1,markdownDescription:_(169,"Controls whether tree sitter parsing should be turned on for css. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for css."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.typescript":{type:"boolean",default:!1,markdownDescription:_(170,"Controls whether tree sitter parsing should be turned on for typescript. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for typescript."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.ini":{type:"boolean",default:!1,markdownDescription:_(171,"Controls whether tree sitter parsing should be turned on for ini. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for ini."),tags:["experimental"],experiment:{mode:"auto"}},"editor.experimental.preferTreeSitter.regex":{type:"boolean",default:!1,markdownDescription:_(172,"Controls whether tree sitter parsing should be turned on for regex. This will take precedence over `#editor.experimental.treeSitterTelemetry#` for regex."),tags:["experimental"],experiment:{mode:"auto"}},"editor.language.brackets":{type:["array","null"],default:null,description:_(173,"Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:_(174,"The opening bracket character or string sequence.")},{type:"string",description:_(175,"The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:_(176,"Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:_(177,"The opening bracket character or string sequence.")},{type:"string",description:_(178,"The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:ao.maxComputationTime,description:_(179,"Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:ao.maxFileSize,description:_(180,"Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:ao.renderSideBySide,description:_(181,"Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:ao.renderSideBySideInlineBreakpoint,description:_(182,"If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:ao.useInlineViewWhenSpaceIsLimited,description:_(183,"If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:ao.renderMarginRevertIcon,description:_(184,"When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:ao.renderGutterMenu,description:_(185,"When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:ao.ignoreTrimWhitespace,description:_(186,"When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:ao.renderIndicators,description:_(187,"Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:ao.diffCodeLens,description:_(188,"Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:ao.diffWordWrap,markdownEnumDescriptions:[_(189,"Lines will never wrap."),_(190,"Lines will wrap at the viewport width."),_(191,"Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:ao.diffAlgorithm,markdownEnumDescriptions:[_(192,"Uses the legacy diffing algorithm."),_(193,"Uses the advanced diffing algorithm.")]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:ao.hideUnchangedRegions.enabled,markdownDescription:_(194,"Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:ao.hideUnchangedRegions.revealLineCount,markdownDescription:_(195,"Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:ao.hideUnchangedRegions.minimumLineCount,markdownDescription:_(196,"Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:ao.hideUnchangedRegions.contextLineCount,markdownDescription:_(197,"Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:ao.experimental.showMoves,markdownDescription:_(198,"Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:ao.experimental.showEmptyDecorations,description:_(199,"Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:ao.experimental.useTrueInlineView,description:_(200,"If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function eVe(s){return typeof s.type<"u"||typeof s.anyOf<"u"}for(const s of EC){const e=s.schema;if(typeof e<"u")if(eVe(e))b2.properties[`editor.${s.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(b2.properties[t]=e[t])}let FD=null;function Uce(){return FD===null&&(FD=Object.create(null),Object.keys(b2.properties).forEach(s=>{FD[s]=!0})),FD}function tVe(s){return Uce()[`editor.${s}`]||!1}function iVe(s){return Uce()[`diffEditor.${s}`]||!1}const nVe=kn.as(vd.Configuration);nVe.registerConfiguration(b2);const cn=new class{constructor(){this.QuickFix=new En("quickfix"),this.Refactor=new En("refactor"),this.RefactorExtract=this.Refactor.append("extract"),this.RefactorInline=this.Refactor.append("inline"),this.RefactorMove=this.Refactor.append("move"),this.RefactorRewrite=this.Refactor.append("rewrite"),this.Notebook=new En("notebook"),this.Source=new En("source"),this.SourceOrganizeImports=this.Source.append("organizeImports"),this.SourceFixAll=this.Source.append("fixAll"),this.SurroundWith=this.Refactor.append("surround")}};var _a;(function(s){s.Refactor="refactor",s.RefactorPreview="refactor preview",s.Lightbulb="lightbulb",s.Default="other (default)",s.SourceAction="source action",s.QuickFix="quick fix action",s.FixAll="fix all",s.OrganizeImports="organize imports",s.AutoFix="auto fix",s.QuickFixHover="quick fix hover window",s.OnSave="save participants",s.ProblemsView="problems view"})(_a||(_a={}));function sVe(s,e){return!(s.include&&!s.include.intersects(e)||s.excludes&&s.excludes.some(t=>$ce(e,t,s.include))||!s.includeSourceActions&&cn.Source.contains(e))}function oVe(s,e){const t=e.kind?new En(e.kind):void 0;return!(s.include&&(!t||!s.include.contains(t))||s.excludes&&t&&s.excludes.some(i=>$ce(t,i,s.include))||!s.includeSourceActions&&t&&cn.Source.contains(t)||s.onlyIncludePreferredActions&&!e.isPreferred)}function $ce(s,e,t){return!(!e.contains(s)||t&&e.contains(t))}class ih{static fromUser(e,t){return!e||typeof e!="object"?new ih(t.kind,t.apply,!1):new ih(ih.getKindFromUser(e,t.kind),ih.getApplyFromUser(e,t.apply),ih.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new En(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}}class rVe{constructor(e,t,i){this.action=e,this.provider=t,this.highlightRange=i}async resolve(e){var t;if((t=this.provider)!=null&&t.resolveCodeAction&&!this.action.edit){let i;try{i=await this.provider.resolveCodeAction(this.action,e)}catch(n){as(n)}i&&(this.action.edit=i.edit)}return this}}const qce="editor.action.codeAction",Dq="editor.action.quickFix",jce="editor.action.autoFix",Kce="editor.action.refactor",Gce="editor.action.sourceAction",cW="editor.action.organizeImports",dW="editor.action.fixAll",aVe=1e3;class ux extends K{static codeActionsPreferredComparator(e,t){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:0}static codeActionsComparator({action:e},{action:t}){return e.isAI&&!t.isAI?1:!e.isAI&&t.isAI?-1:er(e.diagnostics)?er(t.diagnostics)?ux.codeActionsPreferredComparator(e,t):-1:er(t.diagnostics)?1:ux.codeActionsPreferredComparator(e,t)}constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(ux.codeActionsComparator),this.validActions=this.allActions.filter(({action:n})=>!n.disabled)}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&cn.QuickFix.contains(new En(e.kind))&&!!e.isPreferred)}get hasAIFix(){return this.validActions.some(({action:e})=>!!e.isAI)}get allAIFixes(){return this.validActions.every(({action:e})=>!!e.isAI)}}const yQ={actions:[],documentation:void 0};async function OC(s,e,t,i,n,o){var m;const r=i.filter||{},a={...r,excludes:[...r.excludes||[],cn.Notebook]},l={only:(m=r.include)==null?void 0:m.value,trigger:i.type},c=new Sq(e,o),d=i.type===2,h=lVe(s,e,d?a:r),u=new oe,f=h.map(async p=>{const v=setTimeout(()=>n.report(p),1250);try{const b=await p.provideCodeActions(e,t,l,c.token);if(c.token.isCancellationRequested)return b==null||b.dispose(),yQ;b&&u.add(b);const w=((b==null?void 0:b.actions)||[]).filter(y=>y&&oVe(r,y)),C=dVe(p,w,r.include);return{actions:w.map(y=>new rVe(y,p)),documentation:C}}catch(b){if(il(b))throw b;return as(b),yQ}finally{clearTimeout(v)}}),g=s.onDidChange(()=>{const p=s.all(e);dn(p,h)||c.cancel()});try{const p=await Promise.all(f),v=p.map(C=>C.actions).flat(),b=[...bd(p.map(C=>C.documentation)),...cVe(s,e,i,v)],w=new ux(v,b,u);return u.add(w),w}catch(p){throw u.dispose(),p}finally{g.dispose(),c.dispose()}}function lVe(s,e,t){return s.all(e).filter(i=>i.providedCodeActionKinds?i.providedCodeActionKinds.some(n=>sVe(t,new En(n))):!0)}function*cVe(s,e,t,i){var n,o,r;if(e&&i.length)for(const a of s.all(e))a._getAdditionalMenuItems&&(yield*(r=a._getAdditionalMenuItems)==null?void 0:r.call(a,{trigger:t.type,only:(o=(n=t.filter)==null?void 0:n.include)==null?void 0:o.value},i.map(l=>l.action)))}function dVe(s,e,t){if(!s.documentation)return;const i=s.documentation.map(n=>({kind:new En(n.kind),command:n.command}));if(t){let n;for(const o of i)o.kind.contains(t)&&(n?n.kind.contains(o.kind)&&(n=o):n=o);if(n)return n==null?void 0:n.command}for(const n of e)if(n.kind){for(const o of i)if(o.kind.contains(new En(n.kind)))return o.command}}var Dg;(function(s){s.OnSave="onSave",s.FromProblemsView="fromProblemsView",s.FromCodeActions="fromCodeActions",s.FromAILightbulb="fromAILightbulb",s.FromProblemsHover="fromProblemsHover"})(Dg||(Dg={}));async function hVe(s,e,t,i,n=Ft.None){var d,h;const o=s.get(Rk),r=s.get(en),a=s.get(Wo),l=s.get(Hn),c=s.get(Df);if(a.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred,reason:t}),c.playSignal(ur.codeActionTriggered),await e.resolve(n),!n.isCancellationRequested&&!((d=e.action.edit)!=null&&d.edits.length&&!(await o.apply(e.action.edit,{editor:i==null?void 0:i.editor,label:e.action.title,quotableLabel:e.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:t!==Dg.OnSave,showPreview:i==null?void 0:i.preview,reason:ko.codeAction({kind:e.action.kind,providerId:n4.fromExtensionId((h=e.provider)==null?void 0:h.extensionId)})})).isApplied)){if(e.action.command)try{await r.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(u){const f=uVe(u);l.error(typeof f=="string"?f:_(830,"An unknown error occurred while applying the code action"))}setTimeout(()=>c.playSignal(ur.codeActionApplied),aVe)}}function uVe(s){return typeof s=="string"?s:s instanceof Error&&typeof s.message=="string"?s.message:void 0}Zt.registerCommand("_executeCodeActionProvider",async function(s,e,t,i,n){if(!(e instanceof Ze))throw kl();const{codeActionProvider:o}=s.get(We),r=s.get(Cn).getModel(e);if(!r)throw kl();const a=Oe.isISelection(t)?Oe.liftSelection(t):D.isIRange(t)?r.validateRange(t):void 0;if(!a)throw kl();const l=typeof i=="string"?new En(i):void 0,c=await OC(o,r,a,{type:1,triggerAction:_a.Default,filter:{includeSourceActions:!0,include:l}},ed.None,Ft.None),d=[],h=Math.min(c.validActions.length,typeof n=="number"?n:0);for(let u=0;u<h;u++)d.push(c.validActions[u].resolve(Ft.None));try{return await Promise.all(d),c.validActions.map(u=>u.action)}finally{setTimeout(()=>c.dispose(),100)}});var In;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})(In||(In={}));(function(s){function e(l,c){return c-l}s.compare=e;const t=Object.create(null);t[s.Error]=_(1732,"Error"),t[s.Warning]=_(1733,"Warning"),t[s.Info]=_(1734,"Info");function i(l){return t[l]||""}s.toString=i;const n=Object.create(null);n[s.Error]=_(1735,"Errors"),n[s.Warning]=_(1736,"Warnings"),n[s.Info]=_(1737,"Infos");function o(l){return n[l]||""}s.toStringPlural=o;function r(l){switch(l){case xn.Error:return s.Error;case xn.Warning:return s.Warning;case xn.Info:return s.Info;case xn.Ignore:return s.Hint}}s.fromSeverity=r;function a(l){switch(l){case s.Error:return xn.Error;case s.Warning:return xn.Warning;case s.Info:return xn.Info;case s.Hint:return xn.Ignore}}s.toSeverity=a})(In||(In={}));var v2;(function(s){function t(n){return i(n,!0)}s.makeKey=t;function i(n,o){const r=[""];return n.source?r.push(n.source.replace("¦","\\¦")):r.push(""),n.code?typeof n.code=="string"?r.push(n.code.replace("¦","\\¦")):r.push(n.code.value.replace("¦","\\¦")):r.push(""),n.severity!==void 0&&n.severity!==null?r.push(In.toString(n.severity)):r.push(""),n.message&&o?r.push(n.message.replace("¦","\\¦")):r.push(""),n.startLineNumber!==void 0&&n.startLineNumber!==null?r.push(n.startLineNumber.toString()):r.push(""),n.startColumn!==void 0&&n.startColumn!==null?r.push(n.startColumn.toString()):r.push(""),n.endLineNumber!==void 0&&n.endLineNumber!==null?r.push(n.endLineNumber.toString()):r.push(""),n.endColumn!==void 0&&n.endColumn!==null?r.push(n.endColumn.toString()):r.push(""),r.push(""),r.join("¦")}s.makeKeyOptionalMessage=i})(v2||(v2={}));const Wh=Mt("markerService");var fVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},gVe=function(s,e){return function(t,i){e(t,i,s)}},hW,R_;let uW=(R_=class{constructor(e){this.keybindingService=e}getResolver(){const e=new bo(()=>this.keybindingService.getKeybindings().filter(t=>hW.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===cW?i={kind:cn.SourceOrganizeImports.value}:t.command===dW&&(i={kind:cn.SourceFixAll.value}),{resolvedKeybinding:t.resolvedKeybinding,...ih.fromUser(i,{kind:En.None,apply:"never"})}}));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.value);return i==null?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new En(e.kind);return t.filter(n=>n.kind.contains(i)).filter(n=>n.preferred?e.isPreferred:!0).reduceRight((n,o)=>n?n.kind.contains(o.kind)?o:n:o,void 0)}},hW=R_,R_.codeActionCommands=[Kce,qce,Gce,cW,dW],R_);uW=hW=fVe([gVe(0,ai)],uW);F("symbolIcon.arrayForeground",Ht,_(1495,"The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.booleanForeground",Ht,_(1496,"The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},_(1497,"The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.colorForeground",Ht,_(1498,"The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.constantForeground",Ht,_(1499,"The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_(1500,"The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},_(1501,"The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_(1502,"The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},_(1503,"The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_(1504,"The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.fileForeground",Ht,_(1505,"The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.folderForeground",Ht,_(1506,"The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_(1507,"The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_(1508,"The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.keyForeground",Ht,_(1509,"The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.keywordForeground",Ht,_(1510,"The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_(1511,"The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.moduleForeground",Ht,_(1512,"The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.namespaceForeground",Ht,_(1513,"The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.nullForeground",Ht,_(1514,"The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.numberForeground",Ht,_(1515,"The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.objectForeground",Ht,_(1516,"The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.operatorForeground",Ht,_(1517,"The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.packageForeground",Ht,_(1518,"The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.propertyForeground",Ht,_(1519,"The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.referenceForeground",Ht,_(1520,"The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.snippetForeground",Ht,_(1521,"The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.stringForeground",Ht,_(1522,"The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.structForeground",Ht,_(1523,"The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.textForeground",Ht,_(1524,"The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.typeParameterForeground",Ht,_(1525,"The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.unitForeground",Ht,_(1526,"The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));F("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_(1527,"The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const Yce=Object.freeze({kind:En.Empty,title:_(866,"More Actions...")}),mVe=Object.freeze([{kind:cn.QuickFix,title:_(867,"Quick Fix")},{kind:cn.RefactorExtract,title:_(868,"Extract"),icon:ge.wrench},{kind:cn.RefactorInline,title:_(869,"Inline"),icon:ge.wrench},{kind:cn.RefactorRewrite,title:_(870,"Rewrite"),icon:ge.wrench},{kind:cn.RefactorMove,title:_(871,"Move"),icon:ge.wrench},{kind:cn.SurroundWith,title:_(872,"Surround With"),icon:ge.surroundWith},{kind:cn.Source,title:_(873,"Source Action"),icon:ge.symbolFile},Yce]);function pVe(s,e,t){if(!e)return s.map(o=>{var r;return{kind:"action",item:o,group:Yce,disabled:!!o.action.disabled,label:o.action.disabled||o.action.title,canPreview:!!((r=o.action.edit)!=null&&r.edits.length)}});const i=mVe.map(o=>({group:o,actions:[]}));for(const o of s){const r=o.action.kind?new En(o.action.kind):En.None;for(const a of i)if(a.group.kind.contains(r)){a.actions.push(o);break}}const n=[];for(const o of i)if(o.actions.length){n.push({kind:"header",group:o.group});for(const r of o.actions){const a=o.group;n.push({kind:"action",item:r,group:r.action.isAI?{title:a.title,kind:a.kind,icon:ge.sparkle}:a,label:r.action.title,disabled:!!r.action.disabled,keybinding:t(r.action)})}}return n}const Xce=new Ne("supportedCodeAction",""),SQ="_typescript.applyFixAllCodeAction";class _Ve extends K{constructor(e,t,i,n=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=n,this._autoTriggerTimer=this._register(new ha),this._register(this._markerService.onMarkerChanged(o=>this._onMarkerChanges(o))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);this._signalChange(t?{trigger:e,selection:t}:void 0)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>gm(i,t.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:_a.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getSelection();if(e.type===1)return t;const i=this._editor.getOption(73).enabled;if(i!==ic.Off){{if(i===ic.On)return t;if(i===ic.OnCode){if(!t.isEmpty())return t;const o=this._editor.getModel(),{lineNumber:r,column:a}=t.getPosition(),l=o.getLineContent(r);if(l.length===0)return;if(a===1){if(/\s/.test(l[0]))return}else if(a===o.getLineMaxColumn(r)){if(/\s/.test(l[l.length-1]))return}else if(/\s/.test(l[a-2])&&/\s/.test(l[a-1]))return}}return t}}}var Sp;(function(s){s.Empty={type:0};class e{constructor(i,n,o){this.trigger=i,this.position=n,this._cancellablePromise=o,this.type=1,this.actions=o.catch(r=>{if(il(r))return fW;throw r})}cancel(){this._cancellablePromise.cancel()}}s.Triggered=e})(Sp||(Sp={}));const fW=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1,hasAIFix:!1,allAIFixes:!1});class bVe extends K{constructor(e,t,i,n,o,r){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=o,this._configurationService=r,this._codeActionOracle=this._register(new mi),this._state=Sp.Empty,this._onDidChangeState=this._register(new q),this.onDidChangeState=this._onDidChangeState.event,this.codeActionsDisposable=this._register(new mi),this._disposed=!1,this._supportedCodeActions=Xce.bindTo(n),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._register(this._editor.onDidChangeConfiguration(a=>{a.hasChanged(73)&&this._update()})),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(Sp.Empty,!0))}_settingEnabledNearbyQuickfixes(){var t;const e=(t=this._editor)==null?void 0:t.getModel();return this._configurationService?this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickFixes",{resource:e==null?void 0:e.uri}):!1}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(Sp.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(104)){const t=this._registry.all(e).flatMap(i=>i.providedCodeActionKinds??[]);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new _Ve(this._editor,this._markerService,i=>{var l;if(!i){this.setState(Sp.Empty);return}const n=i.selection.getStartPosition(),o=ys(async c=>{var h,u,f,g,m,p,v,b,w,C;if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===_a.QuickFix||(u=(h=i.trigger.filter)==null?void 0:h.include)!=null&&u.contains(cn.QuickFix))){const y=await OC(this._registry,e,i.selection,i.trigger,ed.None,c);this.codeActionsDisposable.value=y;const x=[...y.allActions];if(c.isCancellationRequested)return y.dispose(),fW;const S=(f=y.validActions)==null?void 0:f.some(E=>E.action.kind&&cn.QuickFix.contains(new En(E.action.kind))&&!E.action.isAI),L=this._markerService.read({resource:e.uri});if(S){for(const E of y.validActions)(m=(g=E.action.command)==null?void 0:g.arguments)!=null&&m.some(M=>typeof M=="string"&&M.includes(SQ))&&(E.action.diagnostics=[...L.filter(M=>M.relatedInformation)]);return{validActions:y.validActions,allActions:x,documentation:y.documentation,hasAutoFix:y.hasAutoFix,hasAIFix:y.hasAIFix,allAIFixes:y.allAIFixes,dispose:()=>{this.codeActionsDisposable.value=y}}}else if(!S&&L.length>0){const E=i.selection.getPosition();let M=E,R=Number.MAX_VALUE;const T=[...y.validActions];for(const N of L){const P=N.endColumn,W=N.endLineNumber,H=N.startLineNumber;if(W===E.lineNumber||H===E.lineNumber){M=new z(W,P);const G={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:(p=i.trigger.filter)!=null&&p.include?(v=i.trigger.filter)==null?void 0:v.include:cn.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:((b=i.trigger.context)==null?void 0:b.notAvailableMessage)||"",position:M}},V=new Oe(M.lineNumber,M.column,M.lineNumber,M.column),U=await OC(this._registry,e,V,G,ed.None,c);if(c.isCancellationRequested)return U.dispose(),fW;if(U.validActions.length!==0){for(const $ of U.validActions)(C=(w=$.action.command)==null?void 0:w.arguments)!=null&&C.some(Y=>typeof Y=="string"&&Y.includes(SQ))&&($.action.diagnostics=[...L.filter(Y=>Y.relatedInformation)]);y.allActions.length===0&&x.push(...U.allActions),Math.abs(E.column-P)<R?T.unshift(...U.validActions):T.push(...U.validActions)}R=Math.abs(E.column-P)}}const A=T.filter((N,P,W)=>W.findIndex(H=>H.action.title===N.action.title)===P);return A.sort((N,P)=>N.action.isPreferred&&!P.action.isPreferred?-1:!N.action.isPreferred&&P.action.isPreferred||N.action.isAI&&!P.action.isAI?1:!N.action.isAI&&P.action.isAI?-1:0),{validActions:A,allActions:x,documentation:y.documentation,hasAutoFix:y.hasAutoFix,hasAIFix:y.hasAIFix,allAIFixes:y.allAIFixes,dispose:()=>{this.codeActionsDisposable.value=y}}}}if(i.trigger.type===1){const y=await OC(this._registry,e,i.selection,i.trigger,ed.None,c);return this.codeActionsDisposable.value=y,y}const d=await OC(this._registry,e,i.selection,i.trigger,ed.None,c);return this.codeActionsDisposable.value=d,d});i.trigger.type===1&&((l=this._progressService)==null||l.showWhile(o,250));const r=new Sp.Triggered(i.trigger,n,o);let a=!1;this._state.type===1&&(a=this._state.trigger.type===1&&r.type===1&&r.trigger.type===2&&this._state.position!==r.position),a?setTimeout(()=>{this.setState(r)},500):this.setState(r)},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:_a.Default})}else this._supportedCodeActions.reset()}trigger(e){var t;(t=this._codeActionOracle.value)==null||t.trigger(e),this.codeActionsDisposable.dispose()}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!this._disposed&&this._onDidChangeState.fire(e))}}var vVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},CVe=function(s,e){return function(t,i){e(t,i,s)}},pC;const xQ=rn("gutter-lightbulb",ge.lightBulb,_(874,"Icon which spawns code actions menu from the gutter when there is no space in the editor.")),LQ=rn("gutter-lightbulb-auto-fix",ge.lightbulbAutofix,_(875,"Icon which spawns code actions menu from the gutter when there is no space in the editor and a quick fix is available.")),IQ=rn("gutter-lightbulb-sparkle",ge.lightbulbSparkle,_(876,"Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix is available.")),EQ=rn("gutter-lightbulb-aifix-auto-fix",ge.lightbulbSparkleAutofix,_(877,"Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available.")),kQ=rn("gutter-lightbulb-sparkle-filled",ge.sparkleFilled,_(878,"Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available."));var Nc;(function(s){s.Hidden={type:0};class e{constructor(i,n,o,r){this.actions=i,this.trigger=n,this.editorPosition=o,this.widgetPosition=r,this.type=1}}s.Showing=e})(Nc||(Nc={}));var qu;let gI=(qu=class extends K{constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._onClick=this._register(new q),this.onClick=this._onClick.event,this._state=Nc.Hidden,this._gutterState=Nc.Hidden,this._iconClasses=[],this.lightbulbClasses=["codicon-"+xQ.id,"codicon-"+EQ.id,"codicon-"+LQ.id,"codicon-"+IQ.id,"codicon-"+kQ.id],this.gutterDecoration=pC.GUTTER_DECORATION,this._domNode=we("div.lightBulbWidget"),this._domNode.role="listbox",this._register(Oo.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(i=>{const n=this._editor.getModel();(this.state.type!==1||!n||this.state.editorPosition.lineNumber>=n.getLineCount())&&this.hide(),(this.gutterState.type!==1||!n||this.gutterState.editorPosition.lineNumber>=n.getLineCount())&&this.gutterHide()})),this._register(RTe(this._domNode,i=>{if(this.state.type!==1)return;this._editor.focus(),i.preventDefault();const{top:n,height:o}=Fn(this._domNode),r=this._editor.getOption(75);let a=Math.floor(r/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.posx,y:n+o+a,actions:this.state.actions,trigger:this.state.trigger})})),this._register(ee(this._domNode,"mouseenter",i=>{(i.buttons&1)===1&&this.hide()})),this._register(Se.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings,()=>{var i,n;this._preferredKbLabel=((i=this._keybindingService.lookupKeybinding(jce))==null?void 0:i.getLabel())??void 0,this._quickFixKbLabel=((n=this._keybindingService.lookupKeybinding(Dq))==null?void 0:n.getLabel())??void 0,this._updateLightBulbTitleAndIcon()})),this._register(this._editor.onMouseDown(async i=>{if(!i.target.element||!this.lightbulbClasses.some(l=>i.target.element&&i.target.element.classList.contains(l))||this.gutterState.type!==1)return;this._editor.focus();const{top:n,height:o}=Fn(i.target.element),r=this._editor.getOption(75);let a=Math.floor(r/3);this.gutterState.widgetPosition.position!==null&&this.gutterState.widgetPosition.position.lineNumber<this.gutterState.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.event.posx,y:n+o+a,actions:this.gutterState.actions,trigger:this.gutterState.trigger})}))}dispose(){super.dispose(),this._editor.removeContentWidget(this),this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.gutterHide(),this.hide();if(!this._editor.hasTextFocus())return this.gutterHide(),this.hide();if(!this._editor.getOptions().get(73).enabled)return this.gutterHide(),this.hide();const r=this._editor.getModel();if(!r)return this.gutterHide(),this.hide();const{lineNumber:a,column:l}=r.validatePosition(i),c=r.getOptions().tabSize,d=this._editor.getOptions().get(59),h=r.getLineContent(a),u=t4(h,c),f=d.spaceWidth*u>22,g=y=>y>2&&this._editor.getTopForLineNumber(y)===this._editor.getTopForLineNumber(y-1),m=this._editor.getLineDecorations(a);let p=!1;if(m)for(const y of m){const x=y.options.glyphMarginClassName;if(x&&!this.lightbulbClasses.some(S=>x.includes(S))){p=!0;break}}let v=a,b=1;if(!f){const y=x=>{const S=r.getLineContent(x);return/^\s*$|^\s+/.test(S)||S.length<=b};if(a>1&&!g(a-1)){const x=r.getLineCount(),S=a===x,L=a>1&&y(a-1),E=!S&&y(a+1),M=y(a),R=!E&&!L;if(!E&&!L&&!p)return this.gutterState=new Nc.Showing(e,t,i,{position:{lineNumber:v,column:b},preference:pC._posPref}),this.renderGutterLightbub(),this.hide();L||S||L&&!M?v-=1:(E||R&&M)&&(v+=1)}else if(a===1&&(a===r.getLineCount()||!y(a+1)&&!y(a)))if(this.gutterState=new Nc.Showing(e,t,i,{position:{lineNumber:v,column:b},preference:pC._posPref}),p)this.gutterHide();else return this.renderGutterLightbub(),this.hide();else if(a<r.getLineCount()&&!g(a+1))v+=1;else if(l*d.spaceWidth<22)return this.hide();b=/^\S\s*$/.test(r.getLineContent(v))?2:1}this.state=new Nc.Showing(e,t,i,{position:{lineNumber:v,column:b},preference:pC._posPref}),this._gutterDecorationID&&(this._removeGutterDecoration(this._gutterDecorationID),this.gutterHide());const w=e.validActions,C=e.validActions[0].action.kind;if(w.length!==1||!C){this._editor.layoutContentWidget(this);return}this._editor.layoutContentWidget(this)}hide(){this.state!==Nc.Hidden&&(this.state=Nc.Hidden,this._editor.layoutContentWidget(this))}gutterHide(){this.gutterState!==Nc.Hidden&&(this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID),this.gutterState=Nc.Hidden)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}get gutterState(){return this._gutterState}set gutterState(e){this._gutterState=e,this._updateGutterLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this._domNode.classList.remove(...this._iconClasses),this._iconClasses=[],this.state.type!==1)return;let e,t=!1;this.state.actions.allAIFixes?(e=ge.sparkleFilled,this.state.actions.validActions.length===1&&(t=!0)):this.state.actions.hasAutoFix?this.state.actions.hasAIFix?e=ge.lightbulbSparkleAutofix:e=ge.lightbulbAutofix:this.state.actions.hasAIFix?e=ge.lightbulbSparkle:e=ge.lightBulb,this._updateLightbulbTitle(this.state.actions.hasAutoFix,t),this._iconClasses=it.asClassNameArray(e),this._domNode.classList.add(...this._iconClasses)}_updateGutterLightBulbTitleAndIcon(){if(this.gutterState.type!==1)return;let e,t=!1;this.gutterState.actions.allAIFixes?(e=kQ,this.gutterState.actions.validActions.length===1&&(t=!0)):this.gutterState.actions.hasAutoFix?this.gutterState.actions.hasAIFix?e=EQ:e=LQ:this.gutterState.actions.hasAIFix?e=IQ:e=xQ,this._updateLightbulbTitle(this.gutterState.actions.hasAutoFix,t);const i=vt.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:it.asClassName(e),glyphMargin:{position:cd.Left},stickiness:1});this.gutterDecoration=i}renderGutterLightbub(){const e=this._editor.getSelection();e&&(this._gutterDecorationID===void 0?this._addGutterDecoration(e.startLineNumber):this._updateGutterDecoration(this._gutterDecorationID,e.startLineNumber))}_addGutterDecoration(e){this._editor.changeDecorations(t=>{this._gutterDecorationID=t.addDecoration(new D(e,0,e,0),this.gutterDecoration)})}_removeGutterDecoration(e){this._editor.changeDecorations(t=>{t.removeDecoration(e),this._gutterDecorationID=void 0})}_updateGutterDecoration(e,t){this._editor.changeDecorations(i=>{i.changeDecoration(e,new D(t,0,t,0)),i.changeDecorationOptions(e,this.gutterDecoration)})}_updateLightbulbTitle(e,t){this.state.type===1&&(t?this.title=_(879,"Run: {0}",this.state.actions.validActions[0].action.title):e&&this._preferredKbLabel?this.title=_(880,"Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel):!e&&this._quickFixKbLabel?this.title=_(881,"Show Code Actions ({0})",this._quickFixKbLabel):e||(this.title=_(882,"Show Code Actions")))}set title(e){this._domNode.title=e}},pC=qu,qu.GUTTER_DECORATION=vt.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:it.asClassName(ge.lightBulb),glyphMargin:{position:cd.Left},stickiness:1}),qu.ID="editor.contrib.lightbulbWidget",qu._posPref=[0],qu);gI=pC=vVe([CVe(1,ai)],gI);var wVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ed=function(s,e){return function(t,i){e(t,i,s)}},_C;const yVe="quickfix-edit-highlight";var Yg;let Qb=(Yg=class extends K{static get(e){return e.getContribution(_C.ID)}constructor(e,t,i,n,o,r,a,l,c,d,h){super(),this._commandService=a,this._configurationService=l,this._actionWidgetService=c,this._instantiationService=d,this._progressService=h,this._activeCodeActions=this._register(new mi),this._showDisabled=!1,this._disposed=!1,this._editor=e,this._model=this._register(new bVe(this._editor,o.codeActionProvider,t,i,r,l)),this._register(this._model.onDidChangeState(u=>this.update(u))),this._lightBulbWidget=new bo(()=>{const u=this._editor.getContribution(gI.ID);return u&&this._register(u.onClick(f=>this.showCodeActionsFromLightbulb(f.actions,f))),u}),this._resolver=n.createInstance(uW),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){this._disposed=!0,super.dispose()}async showCodeActionsFromLightbulb(e,t){if(e.allAIFixes&&e.validActions.length===1){const i=e.validActions[0],n=i.action.command;n&&n.id==="inlineChat.start"&&n.arguments&&n.arguments.length>=1&&n.arguments[0]&&(n.arguments[0]={...n.arguments[0],autoSend:!1}),await this.applyCodeAction(i,!1,!1,Dg.FromAILightbulb);return}await this.showCodeActionList(e,t,{includeDisabledActions:!1,fromLightbulb:!0})}showCodeActions(e,t,i){return this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(e,t,i,n){var r;if(!this._editor.hasModel())return;(r=ca.get(this._editor))==null||r.closeMessage();const o=this._editor.getPosition();this._trigger({type:1,triggerAction:t,filter:i,autoApply:n,context:{notAvailableMessage:e,position:o}})}_trigger(e){return this._model.trigger(e)}async applyCodeAction(e,t,i,n){const o=this._progressService.show(!0,500);try{await this._instantiationService.invokeFunction(hVe,e,n,{preview:i,editor:this._editor})}finally{t&&this._trigger({type:2,triggerAction:_a.QuickFix,filter:{}}),o.done()}}hideLightBulbWidget(){var e,t;(e=this._lightBulbWidget.rawValue)==null||e.hide(),(t=this._lightBulbWidget.rawValue)==null||t.gutterHide()}async update(e){var n,o,r,a,l;if(e.type!==1){this.hideLightBulbWidget();return}let t;try{t=await e.actions}catch(c){_t(c);return}if(this._disposed)return;const i=this._editor.getSelection();if((i==null?void 0:i.startLineNumber)===e.position.lineNumber)if((n=this._lightBulbWidget.value)==null||n.update(t,e.trigger,e.position),e.trigger.type===1){if((o=e.trigger.filter)!=null&&o.include){const d=this.tryGetValidActionToApply(e.trigger,t);if(d){try{this.hideLightBulbWidget(),await this.applyCodeAction(d,!1,!1,Dg.FromCodeActions)}finally{t.dispose()}return}if(e.trigger.context){const h=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,t);if(h&&h.action.disabled){(r=ca.get(this._editor))==null||r.showMessage(h.action.disabled,e.trigger.context.position),t.dispose();return}}}const c=!!((a=e.trigger.filter)!=null&&a.include);if(e.trigger.context&&(!t.allActions.length||!c&&!t.validActions.length)){(l=ca.get(this._editor))==null||l.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=t,t.dispose();return}this._activeCodeActions.value=t,this.showCodeActionList(t,this.toCoords(e.position),{includeDisabledActions:c,fromLightbulb:!1})}else this._actionWidgetService.isVisible?t.dispose():this._activeCodeActions.value=t}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}async showCodeActionList(e,t,i){const n=this._editor.createDecorationsCollection(),o=this._editor.getDomNode();if(!o)return;const r=i.includeDisabledActions&&(this._showDisabled||e.validActions.length===0)?e.allActions:e.validActions;if(!r.length)return;const a=z.isIPosition(t)?this.toCoords(t):t,l={onSelect:async(c,d)=>{this.applyCodeAction(c,!0,!!d,i.fromLightbulb?Dg.FromAILightbulb:Dg.FromCodeActions),this._actionWidgetService.hide(!1),n.clear()},onHide:c=>{var d;(d=this._editor)==null||d.focus(),n.clear()},onHover:async(c,d)=>{var f;if(d.isCancellationRequested)return;let h=!1;const u=c.action.kind;if(u){const g=new En(u);h=[cn.RefactorExtract,cn.RefactorInline,cn.RefactorRewrite,cn.RefactorMove,cn.Source].some(p=>p.contains(g))}return{canPreview:h||!!((f=c.action.edit)!=null&&f.edits.length)}},onFocus:c=>{var d,h;if(c&&c.action){const u=c.action.ranges,f=c.action.diagnostics;if(n.clear(),u&&u.length>0){const g=f&&(f==null?void 0:f.length)>1?f.map(m=>({range:m,options:_C.DECORATION})):u.map(m=>({range:m,options:_C.DECORATION}));n.set(g)}else if(f&&f.length>0){const g=f.map(p=>({range:p,options:_C.DECORATION}));n.set(g);const m=f[0];if(m.startLineNumber&&m.startColumn){const p=(h=(d=this._editor.getModel())==null?void 0:d.getWordAtPosition({lineNumber:m.startLineNumber,column:m.startColumn}))==null?void 0:h.word;ld(_(863,"Context: {0} at line {1} and column {2}.",p,m.startLineNumber,m.startColumn))}}}else n.clear()}};this._actionWidgetService.show("codeActionWidget",!0,pVe(r,this._shouldShowHeaders(),this._resolver.getResolver()),l,a,o,this._getActionBarActions(e,t,i))}toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=Fn(this._editor.getDomNode()),n=i.left+t.left,o=i.top+t.top+t.height;return{x:n,y:o}}_shouldShowHeaders(){var t;const e=(t=this._editor)==null?void 0:t.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:e==null?void 0:e.uri})}_getActionBarActions(e,t,i){if(i.fromLightbulb)return[];const n=e.documentation.map(o=>({id:o.id,label:o.title,tooltip:o.tooltip??"",class:void 0,enabled:!0,run:()=>this._commandService.executeCommand(o.id,...o.arguments??[])}));return i.includeDisabledActions&&e.validActions.length>0&&e.allActions.length!==e.validActions.length&&n.push(this._showDisabled?{id:"hideMoreActions",label:_(864,"Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(e,t,i))}:{id:"showMoreActions",label:_(865,"Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(e,t,i))}),n}},_C=Yg,Yg.ID="editor.contrib.codeActionController",Yg.DECORATION=vt.register({description:"quickfix-highlight",className:yVe}),Yg);Qb=_C=wVe([Ed(1,Wh),Ed(2,ut),Ed(3,$e),Ed(4,We),Ed(5,vf),Ed(6,en),Ed(7,xt),Ed(8,Am),Ed(9,$e),Ed(10,vf)],Qb);Ul((s,e)=>{((n,o)=>{o&&e.addRule(`.monaco-editor ${n} { background-color: ${o}; }`)})(".quickfix-edit-highlight",s.getColor(Pu));const i=s.getColor(wg);i&&e.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${od(s.type)?"dotted":"solid"} ${i}; box-sizing: border-box; }`)});function Pk(s){return de.regex(Xce.keys()[0],new RegExp("(\\s|^)"+ua(s.value)+"\\b"))}const Tq={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:_(831,"Kind of the code action to run.")},apply:{type:"string",description:_(832,"Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[_(833,"Always apply the first returned code action."),_(834,"Apply the first returned code action if it is the only one."),_(835,"Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:_(836,"Controls if only preferred code actions should be returned.")}}};function Ev(s,e,t,i,n=_a.Default){if(s.hasModel()){const o=Qb.get(s);o==null||o.manualTriggerAtCurrentPosition(e,n,t,i)}}class SVe extends Fe{constructor(){super({id:Dq,label:ne(853,"Quick Fix..."),precondition:de.and(B.writable,B.hasCodeActionsProvider),kbOpts:{kbExpr:B.textInputFocus,primary:2137,weight:100}})}run(e,t){return Ev(t,_(837,"No code actions available"),void 0,void 0,_a.QuickFix)}}class xVe extends Is{constructor(){super({id:qce,precondition:de.and(B.writable,B.hasCodeActionsProvider),metadata:{description:"Trigger a code action",args:[{name:"args",schema:Tq}]}})}runEditorCommand(e,t,i){const n=ih.fromUser(i,{kind:En.Empty,apply:"ifSingle"});return Ev(t,typeof(i==null?void 0:i.kind)=="string"?n.preferred?_(838,"No preferred code actions for '{0}' available",i.kind):_(839,"No code actions for '{0}' available",i.kind):n.preferred?_(840,"No preferred code actions available"):_(841,"No code actions available"),{include:n.kind,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply)}}class LVe extends Fe{constructor(){super({id:Kce,label:ne(854,"Refactor..."),precondition:de.and(B.writable,B.hasCodeActionsProvider),kbOpts:{kbExpr:B.textInputFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:de.and(B.writable,Pk(cn.Refactor))},metadata:{description:"Refactor...",args:[{name:"args",schema:Tq}]}})}run(e,t,i){const n=ih.fromUser(i,{kind:cn.Refactor,apply:"never"});return Ev(t,typeof(i==null?void 0:i.kind)=="string"?n.preferred?_(842,"No preferred refactorings for '{0}' available",i.kind):_(843,"No refactorings for '{0}' available",i.kind):n.preferred?_(844,"No preferred refactorings available"):_(845,"No refactorings available"),{include:cn.Refactor.contains(n.kind)?n.kind:En.None,onlyIncludePreferredActions:n.preferred},n.apply,_a.Refactor)}}class IVe extends Fe{constructor(){super({id:Gce,label:ne(855,"Source Action..."),precondition:de.and(B.writable,B.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:de.and(B.writable,Pk(cn.Source))},metadata:{description:"Source Action...",args:[{name:"args",schema:Tq}]}})}run(e,t,i){const n=ih.fromUser(i,{kind:cn.Source,apply:"never"});return Ev(t,typeof(i==null?void 0:i.kind)=="string"?n.preferred?_(846,"No preferred source actions for '{0}' available",i.kind):_(847,"No source actions for '{0}' available",i.kind):n.preferred?_(848,"No preferred source actions available"):_(849,"No source actions available"),{include:cn.Source.contains(n.kind)?n.kind:En.None,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply,_a.SourceAction)}}class EVe extends Fe{constructor(){super({id:cW,label:ne(856,"Organize Imports"),precondition:de.and(B.writable,Pk(cn.SourceOrganizeImports)),kbOpts:{kbExpr:B.textInputFocus,primary:1581,weight:100},metadata:{description:ne(857,"Organize imports in the current file. Also called 'Optimize Imports' by some tools")}})}run(e,t){return Ev(t,_(850,"No organize imports action available"),{include:cn.SourceOrganizeImports,includeSourceActions:!0},"ifSingle",_a.OrganizeImports)}}class kVe extends Fe{constructor(){super({id:dW,label:ne(858,"Fix All"),precondition:de.and(B.writable,Pk(cn.SourceFixAll))})}run(e,t){return Ev(t,_(851,"No fix all action available"),{include:cn.SourceFixAll,includeSourceActions:!0},"ifSingle",_a.FixAll)}}class DVe extends Fe{constructor(){super({id:jce,label:ne(859,"Auto Fix..."),precondition:de.and(B.writable,Pk(cn.QuickFix)),kbOpts:{kbExpr:B.textInputFocus,primary:1625,mac:{primary:2649},weight:100}})}run(e,t){return Ev(t,_(852,"No auto fixes available"),{include:cn.QuickFix,onlyIncludePreferredActions:!0},"ifSingle",_a.AutoFix)}}Qt(Qb.ID,Qb,3);Qt(gI.ID,gI,4);xe(SVe);xe(LVe);xe(IVe);xe(EVe);xe(DVe);xe(kVe);Te(new xVe);kn.as(vd.Configuration).registerConfiguration({...p4,properties:{"editor.codeActionWidget.showHeaders":{type:"boolean",scope:6,description:_(860,"Enable/disable showing group headers in the Code Action menu."),default:!0}}});kn.as(vd.Configuration).registerConfiguration({...p4,properties:{"editor.codeActionWidget.includeNearbyQuickFixes":{type:"boolean",scope:6,description:_(861,"Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic."),default:!0}}});kn.as(vd.Configuration).registerConfiguration({...p4,properties:{"editor.codeActions.triggerOnFocusChange":{type:"boolean",scope:6,markdownDescription:_(862,"Enable triggering {0} when {1} is set to {2}. Code Actions must be set to {3} to be triggered for window and focus changes.","`#editor.codeActionsOnSave#`","`#files.autoSave#`","`afterDelay`","`always`"),default:!1}}});const HA=class HA{constructor(){this.lenses=[]}dispose(){var e;(e=this._store)==null||e.dispose()}get isDisposed(){var e;return((e=this._store)==null?void 0:e.isDisposed)??!1}add(e,t){fv(e)&&(this._store??(this._store=new oe),this._store.add(e));for(const i of e.lenses)this.lenses.push({symbol:i,provider:t})}};HA.Empty=new HA;let Ow=HA;async function Zce(s,e,t){const i=s.ordered(e),n=new Map,o=new Ow,r=i.map(async(a,l)=>{n.set(a,l);try{const c=await Promise.resolve(a.provideCodeLenses(e,t));c&&o.add(c,a)}catch(c){as(c)}});return await Promise.all(r),t.isCancellationRequested?(o.dispose(),Ow.Empty):(o.lenses=o.lenses.sort((a,l)=>a.symbol.range.startLineNumber<l.symbol.range.startLineNumber?-1:a.symbol.range.startLineNumber>l.symbol.range.startLineNumber?1:n.get(a.provider)<n.get(l.provider)?-1:n.get(a.provider)>n.get(l.provider)?1:a.symbol.range.startColumn<l.symbol.range.startColumn?-1:a.symbol.range.startColumn>l.symbol.range.startColumn?1:0),o)}Zt.registerCommand("_executeCodeLensProvider",function(s,...e){let[t,i]=e;ti(Ze.isUri(t)),ti(typeof i=="number"||!i);const{codeLensProvider:n}=s.get(We),o=s.get(Cn).getModel(t);if(!o)throw kl();const r=[],a=new oe;return Zce(n,o,Ft.None).then(l=>{a.add(l);const c=[];for(const d of l.lenses)i==null||d.symbol.command?r.push(d.symbol):i-- >0&&d.provider.resolveCodeLens&&c.push(Promise.resolve(d.provider.resolveCodeLens(o,d.symbol,Ft.None)).then(h=>r.push(h||d.symbol)));return Promise.all(c)}).then(()=>r).finally(()=>{setTimeout(()=>a.dispose(),100)})});var TVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},NVe=function(s,e){return function(t,i){e(t,i,s)}};const Qce=Mt("ICodeLensCache");class DQ{constructor(e,t){this.lineCount=e,this.data=t}}let gW=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new Cc(20,.75);const t="codelens/cache";vS(Ti,()=>e.remove(t,1));const i="codelens/cache2",n=e.get(i,1,"{}");this._deserialize(n);const o=Se.filter(e.onWillSaveState,r=>r.reason===Vg.SHUTDOWN);Se.once(o)(r=>{e.store(i,this._serialize(),1,1)})}put(e,t){const i=t.lenses.map(r=>{var a;return{range:r.symbol.range,command:r.symbol.command&&{id:"",title:(a=r.symbol.command)==null?void 0:a.title}}}),n=new Ow;n.add({lenses:i},this._fakeProvider);const o=new DQ(e.getLineCount(),n);this._cache.set(e.uri.toString(),o)}get(e){const t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){const e=Object.create(null);for(const[t,i]of this._cache){const n=new Set;for(const o of i.data.lenses)n.add(o.symbol.range.startLineNumber);e[t]={lineCount:i.lineCount,lines:[...n.values()]}}return JSON.stringify(e)}_deserialize(e){try{const t=JSON.parse(e);for(const i in t){const n=t[i],o=[];for(const a of n.lines)o.push({range:new D(a,1,a,11)});const r=new Ow;r.add({lenses:o},this._fakeProvider),this._cache.set(i,new DQ(n.lineCount,r))}}catch{}}};gW=TVe([NVe(0,sr)],gW);Vt(Qce,gW,1);class RVe{constructor(e,t,i){this.afterColumn=1073741824,this.afterLineNumber=e,this.heightInPx=t,this._onHeight=i,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){this._lastHeight===void 0?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}}const Kx=class Kx{constructor(e,t){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=e,this._id=`codelens.widget-${Kx._idPool++}`,this.updatePosition(t),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(e,t){this._commands.clear();const i=[];let n=!1;for(let o=0;o<e.length;o++){const r=e[o];if(r&&(n=!0,r.command)){const a=Hg(r.command.title.trim());if(r.command.id){const l=`c${Kx._idPool++}`;i.push(we("a",{id:l,title:r.command.tooltip,role:"button"},...a)),this._commands.set(l,r.command)}else i.push(we("span",{title:r.command.tooltip},...a));o+1<e.length&&i.push(we("span",void 0," | "))}}n?(Os(this._domNode,...i),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):Os(this._domNode,we("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){const t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}};Kx._idPool=0;let mW=Kx;class zF{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){const t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let i=0,n=t.length;i<n;i++)this._addDecorationsCallbacks[i](t[i])}}const TQ=vt.register({collapseOnReplaceEdit:!0,description:"codelens"});class NQ{constructor(e,t,i,n,o,r){this._isDisposed=!1,this._editor=t,this._data=e,this._decorationIds=[];let a;const l=[];this._data.forEach((c,d)=>{c.symbol.command&&l.push(c.symbol),i.addDecoration({range:c.symbol.range,options:TQ},h=>this._decorationIds[d]=h),a?a=D.plusRange(a,c.symbol.range):a=D.lift(c.symbol.range)}),this._viewZone=new RVe(a.startLineNumber-1,o,r),this._viewZoneId=n.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new mW(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t==null||t.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((e,t)=>{const i=this._editor.getModel().getDecorationRange(e),n=this._data[t].symbol;return!!(i&&D.isEmpty(n.range)===i.isEmpty())})}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach((i,n)=>{t.addDecoration({range:i.symbol.range,options:TQ},o=>this._decorationIds[n]=o)})}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){const i=e.getDecorationRange(this._decorationIds[t]);i&&(this._data[t].symbol.range=i)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){const i=e[t];if(i){const{symbol:n}=this._data[t];n.command=i.command||n.command}}}getCommand(e){var t;return(t=this._contentWidget)==null?void 0:t.getCommand(e)}getLineNumber(){const e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}const Nq=Mt("environmentService");var MVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},RQ=function(s,e){return function(t,i){e(t,i,s)}};const $l=Mt("ILanguageFeatureDebounceService");var C2;(function(s){const e=new WeakMap;let t=0;function i(n){let o=e.get(n);return o===void 0&&(o=++t,e.set(n,o)),o}s.of=i})(C2||(C2={}));class AVe{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class PVe{constructor(e,t,i,n,o,r){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=o,this._max=r,this._cache=new Cc(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>pO(C2.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?dr(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new AWe(6),this._cache.set(i,n));const o=dr(n.update(t),this._min,this._max);return mO(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${o}ms`),o}_overall(){const e=new Ule;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return dr(e,this._min,this._max)}}let pW=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){const n=(i==null?void 0:i.min)??50,o=(i==null?void 0:i.max)??n**2,r=(i==null?void 0:i.key)??void 0,a=`${C2.of(e)},${n}${r?","+r:""}`;let l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new AVe(n*1.5)):l=new PVe(this._logService,t,e,this._overallAverage()|0||n*1.5,n,o),this._data.set(a,l)),l}_overallAverage(){const e=new Ule;for(const t of this._data.values())e.update(t.default());return e.value}};pW=MVe([RQ(0,Ji),RQ(1,Nq)],pW);Vt($l,pW,1);var OVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Z0=function(s,e){return function(t,i){e(t,i,s)}},q1;let mI=(q1=class{constructor(e,t,i,n,o,r){this._editor=e,this._languageFeaturesService=t,this._commandService=n,this._notificationService=o,this._codeLensCache=r,this._disposables=new oe,this._localToDispose=new oe,this._lenses=[],this._oldCodeLensModels=new oe,this._provideCodeLensDebounce=i.for(t.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=i.for(t.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new Ni(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{(a.hasChanged(59)||a.hasChanged(25)||a.hasChanged(24))&&this._updateLensStyle(),a.hasChanged(23)&&this._onModelChange()})),this._disposables.add(t.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}dispose(){var e;this._localDispose(),this._localToDispose.dispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),(e=this._currentCodeLensModel)==null||e.dispose()}_getLayoutInfo(){const e=Math.max(1.3,this._editor.getOption(75)/this._editor.getOption(61));let t=this._editor.getOption(25);return(!t||t<5)&&(t=this._editor.getOption(61)*.9|0),{fontSize:t,codeLensHeight:t*e|0}}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),i=this._editor.getOption(24),n=this._editor.getOption(59),{style:o}=this._editor.getContainerDomNode();o.setProperty("--vscode-editorCodeLens-lineHeight",`${e}px`),o.setProperty("--vscode-editorCodeLens-fontSize",`${t}px`),o.setProperty("--vscode-editorCodeLens-fontFeatureSettings",n.fontFeatureSettings),i&&(o.setProperty("--vscode-editorCodeLens-fontFamily",i),o.setProperty("--vscode-editorCodeLens-fontFamilyDefault",Or.fontFamily)),this._editor.changeViewZones(r=>{for(const a of this._lenses)a.updateHeight(e,r)})}_localDispose(){var e,t,i;(e=this._getCodeLensModelPromise)==null||e.cancel(),this._getCodeLensModelPromise=void 0,(t=this._resolveCodeLensesPromise)==null||t.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),(i=this._currentCodeLensModel)==null||i.dispose()}_onModelChange(){this._localDispose();const e=this._editor.getModel();if(!e||!this._editor.getOption(23)||e.isTooLargeForTokenization())return;const t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!this._languageFeaturesService.codeLensProvider.has(e)){t&&cf(()=>{const n=this._codeLensCache.get(e);t===n&&(this._codeLensCache.delete(e),this._onModelChange())},30*1e3,this._localToDispose);return}for(const n of this._languageFeaturesService.codeLensProvider.all(e))if(typeof n.onDidChange=="function"){const o=n.onDidChange(()=>i.schedule());this._localToDispose.add(o)}const i=new Ni(()=>{var o;const n=Date.now();(o=this._getCodeLensModelPromise)==null||o.cancel(),this._getCodeLensModelPromise=ys(r=>Zce(this._languageFeaturesService.codeLensProvider,e,r)),this._getCodeLensModelPromise.then(r=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=r,this._codeLensCache.put(e,r);const a=this._provideCodeLensDebounce.update(e,Date.now()-n);i.delay=a,this._renderCodeLensSymbols(r),this._resolveCodeLensesInViewportSoon()},_t)},this._provideCodeLensDebounce.get(e));this._localToDispose.add(i),this._localToDispose.add(Ve(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{var n;this._editor.changeDecorations(o=>{this._editor.changeViewZones(r=>{const a=[];let l=-1;this._lenses.forEach(d=>{!d.isValid()||l===d.getLineNumber()?a.push(d):(d.update(r),l=d.getLineNumber())});const c=new zF;a.forEach(d=>{d.dispose(c,r),this._lenses.splice(this._lenses.indexOf(d),1)}),c.commit(o)})}),i.schedule(),this._resolveCodeLensesScheduler.cancel(),(n=this._resolveCodeLensesPromise)==null||n.cancel(),this._resolveCodeLensesPromise=void 0})),this._localToDispose.add(this._editor.onDidFocusEditorText(()=>{i.schedule()})),this._localToDispose.add(this._editor.onDidBlurEditorText(()=>{i.cancel()})),this._localToDispose.add(this._editor.onDidScrollChange(n=>{n.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(Ve(()=>{if(this._editor.getModel()){const n=ud.capture(this._editor);this._editor.changeDecorations(o=>{this._editor.changeViewZones(r=>{this._disposeAllLenses(o,r)})}),n.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(n=>{if(n.target.type!==9)return;let o=n.target.element;if((o==null?void 0:o.tagName)==="SPAN"&&(o=o.parentElement),(o==null?void 0:o.tagName)==="A")for(const r of this._lenses){const a=r.getCommand(o);if(a){this._commandService.executeCommand(a.id,...a.arguments||[]).catch(l=>this._notificationService.error(l));break}}})),i.schedule()}_disposeAllLenses(e,t){const i=new zF;for(const n of this._lenses)n.dispose(i,t);e&&i.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;const t=this._editor.getModel().getLineCount(),i=[];let n;for(const a of e.lenses){const l=a.symbol.range.startLineNumber;l<1||l>t||(n&&n[n.length-1].symbol.range.startLineNumber===l?n.push(a):(n=[a],i.push(n)))}if(!i.length&&!this._lenses.length)return;const o=ud.capture(this._editor),r=this._getLayoutInfo();this._editor.changeDecorations(a=>{this._editor.changeViewZones(l=>{const c=new zF;let d=0,h=0;for(;h<i.length&&d<this._lenses.length;){const u=i[h][0].symbol.range.startLineNumber,f=this._lenses[d].getLineNumber();f<u?(this._lenses[d].dispose(c,l),this._lenses.splice(d,1)):f===u?(this._lenses[d].updateCodeLensSymbols(i[h],c),h++,d++):(this._lenses.splice(d,0,new NQ(i[h],this._editor,c,l,r.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),d++,h++)}for(;d<this._lenses.length;)this._lenses[d].dispose(c,l),this._lenses.splice(d,1);for(;h<i.length;)this._lenses.push(new NQ(i[h],this._editor,c,l,r.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),h++;c.commit(a)})}),o.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var r;(r=this._resolveCodeLensesPromise)==null||r.cancel(),this._resolveCodeLensesPromise=void 0;const e=this._editor.getModel();if(!e)return;const t=[],i=[];if(this._lenses.forEach(a=>{const l=a.computeIfNecessary(e);l&&(t.push(l),i.push(a))}),t.length===0){this._oldCodeLensModels.clear();return}const n=Date.now(),o=ys(a=>{const l=t.map((c,d)=>{const h=new Array(c.length),u=c.map((f,g)=>!f.symbol.command&&typeof f.provider.resolveCodeLens=="function"?Promise.resolve(f.provider.resolveCodeLens(e,f.symbol,a)).then(m=>{h[g]=m},as):(h[g]=f.symbol,Promise.resolve(void 0)));return Promise.all(u).then(()=>{!a.isCancellationRequested&&!i[d].isDisposed()&&i[d].updateCommands(h)})});return Promise.all(l)});this._resolveCodeLensesPromise=o,this._resolveCodeLensesPromise.then(()=>{const a=this._resolveCodeLensesDebounce.update(e,Date.now()-n);this._resolveCodeLensesScheduler.delay=a,this._currentCodeLensModel&&this._codeLensCache.put(e,this._currentCodeLensModel),this._oldCodeLensModels.clear(),o===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},a=>{_t(a),o===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}async getModel(){var e;return await this._getCodeLensModelPromise,await this._resolveCodeLensesPromise,(e=this._currentCodeLensModel)!=null&&e.isDisposed?void 0:this._currentCodeLensModel}},q1.ID="css.editor.codeLens",q1);mI=OVe([Z0(1,We),Z0(2,$l),Z0(3,en),Z0(4,Hn),Z0(5,Qce)],mI);Qt(mI.ID,mI,1);xe(class extends Fe{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:B.hasCodeLensProvider,label:ne(884,"Show CodeLens Commands for Current Line")})}async run(e,t){if(!t.hasModel())return;const i=e.get(Fo),n=e.get(en),o=e.get(Hn),r=t.getSelection().positionLineNumber,a=t.getContribution(mI.ID);if(!a)return;const l=await a.getModel();if(!l)return;const c=[];for(const u of l.lenses)u.symbol.command&&u.symbol.range.startLineNumber===r&&c.push({label:u.symbol.command.title,command:u.symbol.command});if(c.length===0)return;const d=await i.pick(c,{canPickMany:!1,placeHolder:_(883,"Select a command")});if(!d)return;let h=d.command;if(l.isDisposed){const u=await a.getModel(),f=u==null?void 0:u.lenses.find(g=>{var m;return g.symbol.range.startLineNumber===r&&((m=g.symbol.command)==null?void 0:m.title)===h.title});if(!f||!f.symbol.command)return;h=f.symbol.command}try{await n.executeCommand(h.id,...h.arguments||[])}catch(u){o.error(u)}}});const Jce=[];function C0(s){Jce.push(s)}function FVe(){return Jce.slice(0)}class UF{constructor(e,t,i,n){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=n,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}class IS{constructor(e,t,i,n,o,r){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=n,this.initialMousePosY=o,this.supportsMarkerHover=r,this.type=2}equals(e){return e.type===2&&this.owner===e.owner}canAdoptVisibleHover(e,t){return e.type===2&&this.owner===e.owner}}class Jb{constructor(e,t){this.renderedHoverParts=e,this.disposables=t}dispose(){var e;for(const t of this.renderedHoverParts)t.dispose();(e=this.disposables)==null||e.dispose()}}const kv=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};var ede=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_W=function(s,e){return function(t,i){e(t,i,s)}};let pI=class{constructor(e){this._editorWorkerService=e}async provideDocumentColors(e,t){return this._editorWorkerService.computeDefaultDocumentColors(e.uri)}provideColorPresentations(e,t,i){const n=t.range,o=t.color,r=o.alpha,a=new re(new ce(Math.round(255*o.red),Math.round(255*o.green),Math.round(255*o.blue),r)),l=r?re.Format.CSS.formatRGBA(a):re.Format.CSS.formatRGB(a),c=r?re.Format.CSS.formatHSLA(a):re.Format.CSS.formatHSL(a),d=r?re.Format.CSS.formatHexA(a):re.Format.CSS.formatHex(a),h=[];return h.push({label:l,textEdit:{range:n,text:l}}),h.push({label:c,textEdit:{range:n,text:c}}),h.push({label:d,textEdit:{range:n,text:d}}),h}};pI=ede([_W(0,jr)],pI);let bW=class extends K{constructor(e,t){super(),this._register(e.colorProvider.register("*",new pI(t)))}};bW=ede([_W(0,We),_W(1,jr)],bW);async function tde(s,e,t,i="auto"){return Rq(new BVe,s,e,t,i)}function ide(s,e,t,i){return Promise.resolve(t.provideColorPresentations(s,e,i))}class BVe{constructor(){}async compute(e,t,i,n){const o=await e.provideDocumentColors(t,i);if(Array.isArray(o))for(const r of o)n.push({colorInfo:r,provider:e});return Array.isArray(o)}}class WVe{constructor(){}async compute(e,t,i,n){const o=await e.provideDocumentColors(t,i);if(Array.isArray(o))for(const r of o)n.push({range:r.range,color:[r.color.red,r.color.green,r.color.blue,r.color.alpha]});return Array.isArray(o)}}class HVe{constructor(e){this.colorInfo=e}async compute(e,t,i,n){const o=await e.provideColorPresentations(t,this.colorInfo,Ft.None);return Array.isArray(o)&&n.push(...o),Array.isArray(o)}}async function Rq(s,e,t,i,n){let o=!1,r;const a=[],l=e.ordered(t);for(let c=l.length-1;c>=0;c--){const d=l[c];if(n!=="always"&&d instanceof pI)r=d;else try{await s.compute(d,t,i,a)&&(o=!0)}catch(h){as(h)}}return o?a:r&&n!=="never"?(await s.compute(r,t,i,a),a):[]}function nde(s,e){const{colorProvider:t}=s.get(We),i=s.get(Cn).getModel(e);if(!i)throw kl();const n=s.get(xt).getValue("editor.defaultColorDecorators",{resource:e});return{model:i,colorProviderRegistry:t,defaultColorDecoratorsEnablement:n}}var VVe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$F=function(s,e){return function(t,i){e(t,i,s)}},vW;const sde=Object.create({});var Xg;let Fw=(Xg=class extends K{constructor(e,t,i,n){super(),this._editor=e,this._configurationService=t,this._languageFeaturesService=i,this._localToDispose=this._register(new oe),this._decorationsIds=[],this._colorDatas=new Map,this._decoratorLimitReporter=this._register(new zVe),this._colorDecorationClassRefs=this._register(new oe),this._colorDecoratorIds=this._editor.createDecorationsCollection(),this._ruleFactory=this._register(new vR(this._editor)),this._debounceInformation=n.for(i.colorProvider,"Document Colors",{min:vW.RECOMPUTE_TIME}),this._register(e.onDidChangeModel(()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()})),this._register(e.onDidChangeModelLanguage(()=>this.updateColors())),this._register(i.colorProvider.onDidChange(()=>this.updateColors())),this._register(e.onDidChangeConfiguration(o=>{const r=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._defaultColorDecoratorsEnablement=this._editor.getOption(167);const a=r!==this._isColorDecoratorsEnabled||o.hasChanged(27),l=o.hasChanged(167);(a||l)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._defaultColorDecoratorsEnablement=this._editor.getOption(167),this.updateColors()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageId(),i=this._configurationService.getValue(t);if(i&&typeof i=="object"){const n=i.colorDecorators;if(n&&n.enable!==void 0&&!n.enable)return n.enable}return this._editor.getOption(26)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;const e=this._editor.getModel();!e||!this._languageFeaturesService.colorProvider.has(e)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new ha,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},this._debounceInformation.get(e)))})),this.beginCompute())}async beginCompute(){this._computePromise=ys(async e=>{const t=this._editor.getModel();if(!t)return[];const i=new Fs(!1),n=await tde(this._languageFeaturesService.colorProvider,t,e,this._defaultColorDecoratorsEnablement);return this._debounceInformation.update(t,i.elapsed()),n});try{const e=await this._computePromise;this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}catch(e){_t(e)}}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map(i=>({range:{startLineNumber:i.colorInfo.range.startLineNumber,startColumn:i.colorInfo.range.startColumn,endLineNumber:i.colorInfo.range.endLineNumber,endColumn:i.colorInfo.range.endColumn},options:vt.EMPTY}));this._editor.changeDecorations(i=>{this._decorationsIds=i.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((n,o)=>this._colorDatas.set(n,e[o]))})}updateColorDecorators(e){this._colorDecorationClassRefs.clear();const t=[],i=this._editor.getOption(27);for(let o=0;o<e.length&&t.length<i;o++){const{red:r,green:a,blue:l,alpha:c}=e[o].colorInfo.color,d=new ce(Math.round(r*255),Math.round(a*255),Math.round(l*255),c),h=`rgba(${d.r}, ${d.g}, ${d.b}, ${d.a})`,u=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:h}));t.push({range:{startLineNumber:e[o].colorInfo.range.startLineNumber,startColumn:e[o].colorInfo.range.startColumn,endLineNumber:e[o].colorInfo.range.endLineNumber,endColumn:e[o].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:$se,inlineClassName:`${u.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:sde}}})}const n=i<e.length?i:!1;this._decoratorLimitReporter.update(e.length,n),this._colorDecoratorIds.set(t)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(e){const t=this._editor.getModel();if(!t)return null;const i=t.getDecorationsInRange(D.fromPositions(e,e)).filter(n=>this._colorDatas.has(n.id));return i.length===0?null:this._colorDatas.get(i[0].id)}isColorDecoration(e){return this._colorDecoratorIds.has(e)}},vW=Xg,Xg.ID="editor.contrib.colorDetector",Xg.RECOMPUTE_TIME=1e3,Xg);Fw=vW=VVe([$F(1,xt),$F(2,We),$F(3,$l)],Fw);class zVe extends K{constructor(){super(...arguments),this._onDidChange=this._register(new q),this._computed=0,this._limited=!1}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}const ode="editor.action.showHover",UVe="editor.action.showDefinitionPreviewHover",$Ve="editor.action.hideHover",qVe="editor.action.scrollUpHover",jVe="editor.action.scrollDownHover",KVe="editor.action.scrollLeftHover",GVe="editor.action.scrollRightHover",YVe="editor.action.pageUpHover",XVe="editor.action.pageDownHover",ZVe="editor.action.goToTopHover",QVe="editor.action.goToBottomHover",_4="editor.action.increaseHoverVerbosityLevel",JVe=_(1102,"Increase Hover Verbosity Level"),b4="editor.action.decreaseHoverVerbosityLevel",eze=_(1103,"Decrease Hover Verbosity Level"),_I="editor.action.inlineSuggest.commit",rde="editor.action.inlineSuggest.showPrevious",ade="editor.action.inlineSuggest.showNext",tze="editor.action.inlineSuggest.jump",lde="editor.action.inlineSuggest.hide",CW="editor.action.inlineSuggest.toggleShowCollapsed";var Mq=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ac=function(s,e){return function(t,i){e(t,i,s)}},sN;let wW=class extends K{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=fi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(71).showToolbar==="always"),this.sessionPosition=void 0,this.position=ae(this,n=>{var l,c;const o=(l=this.model.read(n))==null?void 0:l.primaryGhostText.read(n);if(!this.alwaysShowToolbar.read(n)||!o||o.parts.length===0)return this.sessionPosition=void 0,null;const r=o.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==o.lineNumber&&(this.sessionPosition=void 0);const a=new z(o.lineNumber,Math.min(r,((c=this.sessionPosition)==null?void 0:c.column)??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Ao((n,o)=>{const r=this.model.read(n);if(!r||!this.alwaysShowToolbar.read(n))return;const a=ae(c=>{const d=c.store.add(this.instantiationService.createInstance(Bw.hot.read(c),this.editor,!0,this.position,r.selectedInlineCompletionIndex,r.inlineCompletionsCount,r.activeCommands,r.warning,()=>{}));return e.addContentWidget(d),c.store.add(Ve(()=>e.removeContentWidget(d))),c.store.add(lt(h=>{this.position.read(h)&&r.lastTriggerKind.read(h)!==Tr.Explicit&&r.triggerExplicitly()})),d}),l=Ef(this,(c,d)=>!!this.position.read(c)||!!d);o.add(lt(c=>{l.read(c)&&a.read(c)}))}))}};wW=Mq([ac(2,$e)],wW);const ize=rn("inline-suggestion-hints-next",ge.chevronRight,_(1207,"Icon for show next parameter hint.")),nze=rn("inline-suggestion-hints-previous",ge.chevronLeft,_(1208,"Icon for show previous parameter hint."));var oh;let Bw=(oh=class extends K{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const n=new Ga(e,t,i,!0,()=>this._commandService.executeCommand(e)),o=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let r=t;return o&&(r=_(1209,"{0} ({1})",t,o.getLabel())),n.tooltip=r,n}constructor(e,t,i,n,o,r,a,l,c,d,h,u,f){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=n,this._suggestionCount=o,this._extraCommands=r,this._warning=a,this._relayout=l,this._commandService=c,this.keybindingService=h,this._contextKeyService=u,this._menuService=f,this.id=`InlineSuggestionHintsContentWidget${sN.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._warningMessageContentNode=ae(g=>{const m=this._warning.read(g);return m?typeof m.message=="string"?m.message:g.store.add(Ik(m.message)).element:void 0}),this._warningMessageNode=kt.div({class:"warningMessage",style:{maxWidth:400,margin:4,marginBottom:4,display:ae(g=>this._warning.read(g)?"block":"none")}},[this._warningMessageContentNode]).keepUpdated(this._store),this.nodes=ei("div.inlineSuggestionsHints",{className:this.withBorder?"monaco-hover monaco-hover-content":""},[this._warningMessageNode.element,ei("div@toolBar")]),this.previousAction=this._register(this.createCommandAction(rde,_(1210,"Previous"),it.asClassName(nze))),this.availableSuggestionCountAction=this._register(new Ga("inlineSuggestionHints.availableSuggestionCount","",void 0,!1)),this.nextAction=this._register(this.createCommandAction(ade,_(1211,"Next"),it.asClassName(ize))),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(He.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new Ni(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new Ni(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this._register(lt(g=>{this._warningMessageContentNode.read(g),this._warningMessageNode.readEffect(g),this._relayout()})),this.toolBar=this._register(d.createInstance(yW,this.nodes.toolBar,He.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:g=>g.startsWith("primary")},actionViewItemProvider:(g,m)=>{if(g instanceof Ya)return d.createInstance(oze,g,void 0);if(g===this.availableSuggestionCountAction){const p=new sze(void 0,g,{label:!0,icon:!1});return p.setClass("availableSuggestionCount"),p}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(g=>{sN._dropDownVisible=g})),this._register(lt(g=>{this._position.read(g),this.editor.layoutContentWidget(this)})),this._register(lt(g=>{const m=this._suggestionCount.read(g),p=this._currentSuggestionIdx.read(g);m!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${p+1}/${m}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),m!==void 0&&m>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(lt(g=>{const p=this._extraCommands.read(g).map(v=>({class:void 0,id:v.command.id,enabled:!0,tooltip:v.command.tooltip||"",label:v.command.title,run:b=>this._commandService.executeCommand(v.command.id)}));for(const[v,b]of this.inlineCompletionsActionsMenus.getActions())for(const w of b)w instanceof Ya&&p.push(w);p.length>0&&p.unshift(new _s),this.toolBar.setAdditionalSecondaryActions(p)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}},sN=oh,oh.hot=a4(oh),oh._dropDownVisible=!1,oh.id=0,oh);Bw=sN=Mq([ac(8,en),ac(9,$e),ac(10,ai),ac(11,ut),ac(12,Vl)],Bw);class sze extends Aw{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}updateTooltip(){}}class oze extends ym{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService,!0);if(!e)return super.updateLabel();if(this.label){const t=ei("div.keybinding").root;this._register(new v0(t,sa,{disableTitle:!0,...VHe})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}}let yW=class extends r2{constructor(e,t,i,n,o,r,a,l,c){super(e,{resetMenu:t,...i},n,o,r,a,l,c),this.menuId=t,this.options2=i,this.menuService=n,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this.additionalPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){var i,n,o,r,a,l,c;const{primary:e,secondary:t}=dce(this.menu.getActions((i=this.options2)==null?void 0:i.menuOptions),(o=(n=this.options2)==null?void 0:n.toolbarOptions)==null?void 0:o.primaryGroup,(a=(r=this.options2)==null?void 0:r.toolbarOptions)==null?void 0:a.shouldInlineSubmenu,(c=(l=this.options2)==null?void 0:l.toolbarOptions)==null?void 0:c.useSeparatorsInPrimaryActions);t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),e.push(...this.additionalPrimaryActions),this.setActions(e,t)}setPrependedPrimaryActions(e){dn(this.prependedPrimaryActions,e,(t,i)=>t===i)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){dn(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};yW=Mq([ac(3,Vl),ac(4,ut),ac(5,sl),ac(6,ai),ac(7,en),ac(8,Wo)],yW);function v4(s,e,t){const i=Fn(s);return!(e<i.left||e>i.left+i.width||t<i.top||t>i.top+i.height)}class rze{constructor(e,t,i,n){this.value=e,this.isComplete=t,this.hasLoadingMessage=i,this.options=n}}class cde extends K{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new q),this.onResult=this._onResult.event,this._asyncComputationScheduler=this._register(new qF(i=>this._triggerAsyncComputation(i),0)),this._syncComputationScheduler=this._register(new qF(i=>this._triggerSyncComputation(i),0)),this._loadingMessageScheduler=this._register(new qF(i=>this._triggerLoadingMessage(i),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._options=void 0,super.dispose()}get _hoverTime(){return this._editor.getOption(69).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t){this._options=t,this._state=e,this._fireResult(t)}_triggerAsyncComputation(e){this._setState(2,e),this._syncComputationScheduler.schedule(e,this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=oDe(t=>this._computer.computeAsync(e,t)),(async()=>{try{for await(const t of this._asyncIterable)t&&(this._result.push(t),this._fireResult(e));this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0,e)}catch(t){_t(t)}})()):this._asyncIterableDone=!0}_triggerSyncComputation(e){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync(e))),this._setState(this._asyncIterableDone?0:3,e)}_triggerLoadingMessage(e){this._state===3&&this._setState(4,e)}_fireResult(e){if(this._state===1||this._state===2)return;const t=this._state===0,i=this._state===4;this._onResult.fire(new rze(this._result.slice(0),t,i,e))}start(e,t){if(e===0)this._state===0&&(this._setState(1,t),this._asyncComputationScheduler.schedule(t,this._firstWaitTime),this._loadingMessageScheduler.schedule(t,this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(t),this._syncComputationScheduler.cancel(),this._triggerSyncComputation(t);break;case 2:this._syncComputationScheduler.cancel(),this._triggerSyncComputation(t);break}}cancel(){this._asyncComputationScheduler.cancel(),this._syncComputationScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._options=void 0,this._state=0}get options(){return this._options}}class qF extends K{constructor(e,t){super(),this._scheduler=this._register(new Ni(()=>e(this._options),t))}schedule(e,t){this._options=e,this._scheduler.schedule(t)}cancel(){this._scheduler.cancel()}}class Aq{get onDidWillResize(){return this._onDidWillResize.event}get onDidResize(){return this._onDidResize.event}constructor(){this._onDidWillResize=new q,this._onDidResize=new q,this._sashListener=new oe,this._size=new wi(0,0),this._minSize=new wi(0,0),this._maxSize=new wi(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Eo(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Eo(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Eo(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:e2.North}),this._southSash=new Eo(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:e2.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(Se.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(Se.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(n=>{e&&(i=n.currentX-n.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(n=>{e&&(i=-(n.currentX-n.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(n=>{e&&(t=-(n.currentY-n.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(n=>{e&&(t=n.currentY-n.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(Se.any(this._eastSash.onDidReset,this._westSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(Se.any(this._northSash.onDidReset,this._southSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,n){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=n?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:n}=this._minSize,{height:o,width:r}=this._maxSize;e=Math.max(i,Math.min(o,e)),t=Math.max(n,Math.min(r,t));const a=new wi(t,e);wi.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}const aze=30,lze=24;class cze extends K{constructor(e,t=new wi(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new Aq),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=wi.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(i=>{this._resize(new wi(i.dimension.width,i.dimension.height)),i.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var e;return(e=this._contentPosition)!=null&&e.position?z.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);return!t||!i?void 0:Fn(t).top+i.top-aze}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const n=Fn(t),o=um(t.ownerDocument.body),r=n.top+i.top+i.height;return o.height-r-lze}_findPositionPreference(e,t){const i=Math.min(this._availableVerticalSpaceBelow(t)??1/0,e),n=Math.min(this._availableVerticalSpaceAbove(t)??1/0,e),o=Math.min(Math.max(n,i),e),r=Math.min(e,o);let a;return this._editor.getOption(69).above?a=r<=n?1:2:a=r<=i?2:1,a===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),a}_resize(e){this._resizableNode.layout(e.height,e.width)}}const BD=we;let Pq=class extends K{constructor(e){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.classList.toggle("fade-in",!!e),this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new vk(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class C4 extends K{static render(e,t,i){return new C4(e,t,i)}constructor(e,t,i){super(),this.actionLabel=t.label,this.actionKeybindingLabel=i,this.actionContainer=me(e,BD("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=me(this.actionContainer,BD("a.action")),this.action.setAttribute("role","button"),t.iconClass&&me(this.action,BD("span.icon")).classList.add(...t.iconClass.split(" ")),this.actionRenderedLabel=i?`${t.label} (${i})`:t.label;const n=me(this.action,BD("span"));n.textContent=this.actionRenderedLabel,this._store.add(new hde(this.actionContainer,t.run)),this._store.add(new ude(this.actionContainer,t.run,[3,10])),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function dde(s,e){return s&&e?_(7,"Inspect this in the accessible view with {0}.",e):s?_(8,"Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class hde extends K{constructor(e,t){super(),this._register(ee(e,ye.CLICK,i=>{i.stopPropagation(),i.preventDefault(),t(e)}))}}class ude extends K{constructor(e,t,i){super(),this._register(ee(e,ye.KEY_DOWN,n=>{const o=new Bi(n);i.some(r=>o.equals(r))&&(n.stopPropagation(),n.preventDefault(),t(e))}))}}var dze=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},WD=function(s,e){return function(t,i){e(t,i,s)}},Zl;const MQ=30;var Zg;let SW=(Zg=class extends cze{get isVisibleFromKeyboard(){var e;return((e=this._renderedHover)==null?void 0:e.source)===2}get isVisible(){return this._hoverVisibleKey.get()??!1}get isFocused(){return this._hoverFocusedKey.get()??!1}constructor(e,t,i,n,o){const r=e.getOption(75)+8,a=150,l=new wi(a,r);super(e,l),this._configurationService=i,this._accessibilityService=n,this._keybindingService=o,this._hover=this._register(new Pq(!0)),this._onDidResize=this._register(new q),this.onDidResize=this._onDidResize.event,this._onDidScroll=this._register(new q),this.onDidScroll=this._onDidScroll.event,this._onContentsChanged=this._register(new q),this.onContentsChanged=this._onContentsChanged.event,this._minimumSize=l,this._hoverVisibleKey=B.hoverVisible.bindTo(t),this._hoverFocusedKey=B.hoverFocused.bindTo(t),me(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._resizableNode.domNode.className="monaco-resizable-hover",this._register(this._editor.onDidLayoutChange(()=>{this.isVisible&&this._updateMaxDimensions()})),this._register(this._editor.onDidChangeConfiguration(d=>{d.hasChanged(59)&&this._updateFont()}));const c=this._register(Ol(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._register(this._hover.scrollbar.onScroll(d=>{this._onDidScroll.fire(d)})),this._setRenderedHover(void 0),this._editor.addContentWidget(this)}dispose(){var e;super.dispose(),(e=this._renderedHover)==null||e.dispose(),this._editor.removeContentWidget(this)}getId(){return Zl.ID}static _applyDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,o=typeof i=="number"?`${i}px`:i;e.style.width=n,e.style.height=o}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return Zl._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return Zl._applyDimensions(i,e,t)}_setScrollableElementDimensions(e,t){const i=this._hover.scrollbar.getDomNode();return Zl._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContainerDomNodeDimensions(e,t),this._setScrollableElementDimensions(e,t),this._setContentsDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,o=typeof i=="number"?`${i}px`:i;e.style.maxWidth=n,e.style.maxHeight=o}_setHoverWidgetMaxDimensions(e,t){Zl._applyMaxDimensions(this._hover.contentsDomNode,e,t),Zl._applyMaxDimensions(this._hover.scrollbar.getDomNode(),e,t),Zl._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none"),this._setHoverWidgetDimensions(e.width,e.height)}_updateResizableNodeMaxDimensions(){const e=this._findMaximumRenderingWidth()??1/0,t=this._findMaximumRenderingHeight()??1/0;this._resizableNode.maxSize=new wi(e,t),this._setHoverWidgetMaxDimensions(e,t)}_resize(e){Zl._lastDimensions=new wi(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),this._onDidResize.fire()}_findAvailableSpaceVertically(){var t;const e=(t=this._renderedHover)==null?void 0:t.showAtPosition;if(e)return this._positionPreference===1?this._availableVerticalSpaceAbove(e):this._availableVerticalSpaceBelow(e)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let i=this._hover.contentsDomNode.children.length-1;return Array.from(this._hover.contentsDomNode.children).forEach(n=>{i+=n.clientHeight}),Math.min(e,i)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some(t=>t.scrollWidth>t.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t=typeof this._contentWidth>"u"?0:this._contentWidth;return e||this._hover.containerDomNode.clientWidth<t?um(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth}isMouseGettingCloser(e,t){if(!this._renderedHover)return!1;if(this._renderedHover.initialMousePosX===void 0||this._renderedHover.initialMousePosY===void 0)return this._renderedHover.initialMousePosX=e,this._renderedHover.initialMousePosY=t,!1;const i=Fn(this.getDomNode());this._renderedHover.closestMouseDistance===void 0&&(this._renderedHover.closestMouseDistance=AQ(this._renderedHover.initialMousePosX,this._renderedHover.initialMousePosY,i.left,i.top,i.width,i.height));const n=AQ(e,t,i.left,i.top,i.width,i.height);return n>this._renderedHover.closestMouseDistance+4?!1:(this._renderedHover.closestMouseDistance=Math.min(this._renderedHover.closestMouseDistance,n),!0)}_setRenderedHover(e){var t;(t=this._renderedHover)==null||t.dispose(),this._renderedHover=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_updateFont(){const{fontSize:e,lineHeight:t}=this._editor.getOption(59),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=`${t/e}`,Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(o=>this._editor.applyFontInfo(o))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,Zl._lastDimensions.height),t=Math.max(this._editor.getLayoutInfo().width*.66,750,Zl._lastDimensions.width);this._resizableNode.maxSize=new wi(t,e),this._setHoverWidgetMaxDimensions(t,e)}_render(e){this._setRenderedHover(e),this._updateFont(),this._updateContent(e.domNode),this.handleContentsChanged(),this._editor.render()}getPosition(){return this._renderedHover?{position:this._renderedHover.showAtPosition,secondaryPosition:this._renderedHover.showAtSecondaryPosition,positionAffinity:this._renderedHover.shouldAppearBeforeContent?3:void 0,preference:[this._positionPreference??1]}:null}show(e){var r;if(!this._editor||!this._editor.hasModel())return;this._render(e);const t=Mu(this._hover.containerDomNode),i=e.showAtPosition;this._positionPreference=this._findPositionPreference(t,i)??1,this.handleContentsChanged(),e.shouldFocus&&this._hover.containerDomNode.focus(),this._onDidResize.fire();const o=this._hover.containerDomNode.ownerDocument.activeElement===this._hover.containerDomNode&&dde(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),((r=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:r.getAriaLabel())??"");o&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+o)}hide(){if(!this._renderedHover)return;const e=this._renderedHover.shouldFocus||this._hoverFocusedKey.get();this._setRenderedHover(void 0),this._resizableNode.maxSize=new wi(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto"),this._updateMaxDimensions()}setMinimumDimensions(e){this._minimumSize=new wi(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new wi(e,this._minimumSize.height)}handleContentsChanged(){var n;this._removeConstraintsRenderNormally();const e=this._hover.contentsDomNode;let t=Mu(e),i=Jr(e)+2;if(this._resizableNode.layout(t,i),this._setHoverWidgetDimensions(i,t),t=Mu(e),i=Jr(e),this._contentWidth=i,this._updateMinimumWidth(),this._resizableNode.layout(t,i),(n=this._renderedHover)!=null&&n.showAtPosition){const o=Mu(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(o,this._renderedHover.showAtPosition)}this._layoutContentWidget(),this._onContentsChanged.fire()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(59);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(59);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-MQ})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+MQ})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}},Zl=Zg,Zg.ID="editor.contrib.resizableContentHoverWidget",Zg._lastDimensions=new wi(0,0),Zg);SW=Zl=dze([WD(1,ut),WD(2,xt),WD(3,so),WD(4,ai)],SW);function AQ(s,e,t,i,n,o){const r=t+n/2,a=i+o/2,l=Math.max(Math.abs(s-r)-n/2,0),c=Math.max(Math.abs(e-a)-o/2,0);return Math.sqrt(l*l+c*c)}class w2{constructor(e,t){this._editor=e,this._participants=t}static _getLineDecorations(e,t){if(t.type!==1&&!t.supportsMarkerHover)return[];const i=e.getModel(),n=t.range.startLineNumber;if(n>i.getLineCount())return[];const o=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter(r=>{if(r.options.isWholeLine)return!0;const a=r.range.startLineNumber===n?r.range.startColumn:1,l=r.range.endLineNumber===n?r.range.endColumn:o;if(r.options.showIfCollapsed){if(a>t.range.startColumn+1||t.range.endColumn-1>l)return!1}else if(a>t.range.startColumn||t.range.endColumn>l)return!1;return!0})}computeAsync(e,t){const i=e.anchor;if(!this._editor.hasModel()||!i)return Dl.EMPTY;const n=w2._getLineDecorations(this._editor,i);return Dl.merge(this._participants.map(o=>o.computeAsync?o.computeAsync(i,n,e.source,t):Dl.EMPTY))}computeSync(e){if(!this._editor.hasModel())return[];const t=e.anchor,i=w2._getLineDecorations(this._editor,t);let n=[];for(const o of this._participants)n=n.concat(o.computeSync(t,i,e.source));return bd(n)}}class fde{constructor(e,t,i){this.hoverParts=e,this.isComplete=t,this.options=i}filter(e){const t=this.hoverParts.filter(i=>i.isValidForHoverAnchor(e));return t.length===this.hoverParts.length?this:new hze(this,t,this.isComplete,this.options)}}class hze extends fde{constructor(e,t,i,n){super(t,i,n),this.original=e}filter(e){return this.original.filter(e)}}var uze=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},PQ=function(s,e){return function(t,i){e(t,i,s)}};const OQ=we;let y2=class extends K{get hasContent(){return this._hasContent}constructor(e,t){super(),this._keybindingService=e,this._hoverService=t,this.actions=[],this._hasContent=!1,this.hoverElement=OQ("div.hover-row.status-bar"),this.hoverElement.tabIndex=0,this.actionsElement=me(this.hoverElement,OQ("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;this._hasContent=!0;const n=this._register(C4.render(this.actionsElement,e,i));return this._register(this._hoverService.setupManagedHover(Fh("element"),n.actionContainer,n.actionRenderedLabel)),this.actions.push(n),n}append(e){const t=me(this.actionsElement,e);return this._hasContent=!0,t}};y2=uze([PQ(0,ai),PQ(1,Sr)],y2);const gde={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};class Mf extends va{get onChange(){return this._onChange.event}get onKeyDown(){return this._onKeyDown.event}constructor(e){super(),this._onChange=this._register(new q),this._onKeyDown=this._register(new q),this._opts=e,this._title=this._opts.title,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...it.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._register(yc().setupDelayedHover(this.domNode,()=>({content:this._title,style:1}),this._opts.hoverLifecycleOptions)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.setTitle(this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(this.enabled){if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)}})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}setIcon(e){this._icon&&this.domNode.classList.remove(...it.asClassNameArray(this._icon)),this._icon=e,this._icon&&this.domNode.classList.add(...it.asClassNameArray(this._icon))}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1)),this.domNode.classList.remove("disabled")}disable(){this.domNode.setAttribute("aria-disabled",String(!0)),this.domNode.classList.add("disabled")}setTitle(e){this._title=e,this.domNode.setAttribute("aria-label",e)}set visible(e){this.domNode.style.display=e?"":"none"}get visible(){return this.domNode.style.display!=="none"}}const vK=class vK extends va{constructor(e,t,i){super(),this.checkbox=e,this.domNode=t,this.styles=i,this._onChange=this._register(new q),this.onChange=this._onChange.event,this.applyStyles()}get enabled(){return this.checkbox.enabled}enable(){this.checkbox.enable(),this.applyStyles(!0)}disable(){this.checkbox.disable(),this.applyStyles(!1)}setTitle(e){this.checkbox.setTitle(e)}applyStyles(e=this.enabled){this.domNode.style.color=(e?this.styles.checkboxForeground:this.styles.checkboxDisabledForeground)||"",this.domNode.style.backgroundColor=(e?this.styles.checkboxBackground:this.styles.checkboxDisabledBackground)||"",this.domNode.style.borderColor=(e?this.styles.checkboxBorder:this.styles.checkboxDisabledBackground)||"";const t=this.styles.size||18;this.domNode.style.width=this.domNode.style.height=this.domNode.style.fontSize=`${t}px`,this.domNode.style.fontSize=`${t-2}px`}};vK.CLASS_NAME="monaco-checkbox";let bI=vK;class mde extends bI{constructor(e,t,i){const n=new Mf({title:e,isChecked:t,icon:ge.check,actionClassName:bI.CLASS_NAME,hoverLifecycleOptions:i.hoverLifecycleOptions,...gde});super(n,n.domNode,i),this._register(n),this._register(this.checkbox.onChange(o=>{this.applyStyles(),this._onChange.fire(o)}))}get checked(){return this.checkbox.checked}set checked(e){this.checkbox.checked=e,this.applyStyles()}applyStyles(e){this.checkbox.checked?this.checkbox.setIcon(ge.check):this.checkbox.setIcon(void 0),super.applyStyles(e)}}class pde extends bI{constructor(e,t,i){let n;switch(t){case!0:n=ge.check;break;case"mixed":n=ge.dash;break;case!1:n=void 0;break}const o=new Mf({title:e,isChecked:t===!0,icon:n,actionClassName:mde.CLASS_NAME,hoverLifecycleOptions:i.hoverLifecycleOptions,...gde});super(o,o.domNode,i),this._state=t,this._register(o),this._register(this.checkbox.onChange(r=>{this._state=this.checkbox.checked,this.applyStyles(),this._onChange.fire(r)}))}get checked(){return this._state}set checked(e){this._state!==e&&(this._state=e,this.checkbox.checked=e===!0,this.applyStyles())}applyStyles(e){switch(this._state){case!0:this.checkbox.setIcon(ge.check);break;case"mixed":this.checkbox.setIcon(ge.dash);break;case!1:this.checkbox.setIcon(void 0);break}super.applyStyles(e)}}const Vo=class Vo{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const n=i.options;if(n===Vo._FIND_MATCH_DECORATION||n===Vo._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let n=0,o=this._decorations.length;n<o;n++){const r=this._editor.getModel().getDecorationRange(this._decorations[n]);if(e.equalsRange(r)){t=this._decorations[n],i=n+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(n=>{if(this._highlightedDecorationId!==null&&(n.changeDecorationOptions(this._highlightedDecorationId,Vo._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,n.changeDecorationOptions(this._highlightedDecorationId,Vo._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(n.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let o=this._editor.getModel().getDecorationRange(t);if(o.startLineNumber!==o.endLineNumber&&o.endColumn===1){const r=o.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(r);o=new D(o.startLineNumber,o.startColumn,r,a)}this._rangeHighlightDecorationId=n.addDecoration(o,Vo._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let n=Vo._FIND_MATCH_DECORATION;const o=[];if(e.length>1e3){n=Vo._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,d=Math.max(2,Math.ceil(3/c));let h=e[0].range.startLineNumber,u=e[0].range.endLineNumber;for(let f=1,g=e.length;f<g;f++){const m=e[f].range;u+d>=m.startLineNumber?m.endLineNumber>u&&(u=m.endLineNumber):(o.push({range:new D(h,1,u,1),options:Vo._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),h=m.startLineNumber,u=m.endLineNumber)}o.push({range:new D(h,1,u,1),options:Vo._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const r=new Array(e.length);for(let a=0,l=e.length;a<l;a++)r[a]={range:e[a].range,options:n};this._decorations=i.deltaDecorations(this._decorations,r),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,o),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t!=null&&t.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,Vo._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(!(!n||n.endLineNumber>e.lineNumber)){if(n.endLineNumber<e.lineNumber)return n;if(!(n.endColumn>e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){const n=this._decorations[t],o=this._editor.getModel().getDecorationRange(n);if(!(!o||o.startLineNumber<e.lineNumber)){if(o.startLineNumber>e.lineNumber)return o;if(!(o.startColumn<e.column))return o}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}};Vo._CURRENT_FIND_MATCH_DECORATION=vt.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",inlineClassName:"currentFindMatchInline",showIfCollapsed:!0,overviewRuler:{color:Mn(K5),position:Xa.Center},minimap:{color:Mn(pB),position:1}}),Vo._FIND_MATCH_DECORATION=vt.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",inlineClassName:"findMatchInline",showIfCollapsed:!0,overviewRuler:{color:Mn(K5),position:Xa.Center},minimap:{color:Mn(pB),position:1}}),Vo._FIND_MATCH_NO_OVERVIEW_DECORATION=vt.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),Vo._FIND_MATCH_ONLY_OVERVIEW_DECORATION=vt.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:Mn(K5),position:Xa.Center}}),Vo._RANGE_HIGHLIGHT_DECORATION=vt.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),Vo._FIND_SCOPE_DECORATION=vt.register({description:"find-scope",className:"findScope",isWholeLine:!0});let xW=Vo;class fze{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const i=[];for(let r=0;r<this._ranges.length;r++)i.push({range:this._ranges[r],text:this._replaceStrings[r]});i.sort((r,a)=>D.compareRangesUsingStarts(r.range,a.range));const n=[];let o=i[0];for(let r=1;r<i.length;r++)o.range.endLineNumber===i[r].range.startLineNumber&&o.range.endColumn===i[r].range.startColumn?(o.range=o.range.plusRange(i[r].range),o.text=o.text+i[r].text):(n.push(o),o=i[r]);n.push(o);for(const r of n)t.addEditOperation(r.range,r.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function _de(s,e){if(s&&s[0]!==""){const t=FQ(s,e,"-"),i=FQ(s,e,"_");return t&&!i?BQ(s,e,"-"):!t&&i?BQ(s,e,"_"):s[0].toUpperCase()===s[0]?e.toUpperCase():s[0].toLowerCase()===s[0]?e.toLowerCase():vDe(s[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):s[0][0].toUpperCase()!==s[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function FQ(s,e,t){return s[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&s[0].split(t).length===e.split(t).length}function BQ(s,e,t){const i=e.split(t),n=s[0].split(t);let o="";return i.forEach((r,a)=>{o+=_de([n[a]],r)+t}),o.slice(0,-1)}class WQ{constructor(e){this.staticValue=e,this.kind=0}}class gze{constructor(e){this.pieces=e,this.kind=1}}class Ww{static fromStaticValue(e){return new Ww([b_.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(e){!e||e.length===0?this._state=new WQ(""):e.length===1&&e[0].staticValue!==null?this._state=new WQ(e[0].staticValue):this._state=new gze(e)}buildReplaceString(e,t){if(this._state.kind===0)return t?_de(e,this._state.staticValue):this._state.staticValue;let i="";for(let n=0,o=this._state.pieces.length;n<o;n++){const r=this._state.pieces[n];if(r.staticValue!==null){i+=r.staticValue;continue}let a=Ww._substitute(r.matchIndex,e);if(r.caseOps!==null&&r.caseOps.length>0){const l=[],c=r.caseOps.length;let d=0;for(let h=0,u=a.length;h<u;h++){if(d>=c){l.push(a.slice(h));break}switch(r.caseOps[d]){case"U":l.push(a[h].toUpperCase());break;case"u":l.push(a[h].toUpperCase()),d++;break;case"L":l.push(a[h].toLowerCase());break;case"l":l.push(a[h].toLowerCase()),d++;break;default:l.push(a[h])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class b_{static staticValue(e){return new b_(e,-1,null)}static caseOps(e,t){return new b_(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}}class mze{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=b_.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=b_.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=b_.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new Ww(this._result)}}function pze(s){if(!s||s.length===0)return new Ww(null);const e=[],t=new mze(s);for(let i=0,n=s.length;i<n;i++){const o=s.charCodeAt(i);if(o===92){if(i++,i>=n)break;const r=s.charCodeAt(i);switch(r){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(r));break}continue}if(o===36){if(i++,i>=n)break;const r=s.charCodeAt(i);if(r===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(r===48||r===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=r&&r<=57){let a=r-48;if(i+1<n){const l=s.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const Af=new Ne("findWidgetVisible",!1);Af.toNegated();const w4=new Ne("findInputFocussed",!1),Oq=new Ne("replaceInputFocussed",!1),HD={primary:545,mac:{primary:2593}},VD={primary:565,mac:{primary:2613}},zD={primary:560,mac:{primary:2608}},UD={primary:554,mac:{primary:2602}},$D={primary:558,mac:{primary:2606}},Zi={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},Tg=19999,_ze=240;class fx{constructor(e,t){this._toDispose=new oe,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new ha,this._decorations=new xW(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new Ni(()=>{if(this._editor.hasModel())return this.research(!1)},100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,yi(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},_ze)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new D(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));const n=this._findMatches(i,!1,Tg);this._decorations.set(n,i);const o=this._editor.getSelection();let r=this._decorations.getCurrentMatchesPosition(o);if(r===0&&n.length>0){const a=WL(n.map(l=>l.range),l=>D.compareRangesUsingStarts(l,o)>=0);r=a>0?a-1+1:r}this._state.changeMatchInfo(r,this._decorations.getCount(),void 0),e&&this._editor.getOption(50).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const o=this._editor.getModel();return t||n===1?(i===1?i=o.getLineCount():i--,n=o.getLineMaxColumn(i)):n--,new z(i,n)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const d=this._decorations.matchAfterPosition(e);d&&this._setCurrentFindMatch(d);return}if(this._decorations.getCount()<Tg){let d=this._decorations.matchBeforePosition(e);d&&d.isEmpty()&&d.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),d=this._decorations.matchBeforePosition(e)),d&&this._setCurrentFindMatch(d);return}if(this._cannotFind())return;const i=this._decorations.getFindScope(),n=fx._getSearchRange(this._editor.getModel(),i);n.getEndPosition().isBefore(e)&&(e=n.getEndPosition()),e.isBefore(n.getStartPosition())&&(e=n.getEndPosition());const{lineNumber:o,column:r}=e,a=this._editor.getModel();let l=new z(o,r),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(148):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(148):null,!1)),!!c){if(!t&&!n.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const o=this._editor.getModel();return t||n===o.getLineMaxColumn(i)?(i===o.getLineCount()?i=1:i++,n=1):n++,new z(i,n)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<Tg){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,n=!1){if(this._cannotFind())return null;const o=this._decorations.getFindScope(),r=fx._getSearchRange(this._editor.getModel(),o);r.getEndPosition().isBefore(e)&&(e=r.getStartPosition()),e.isBefore(r.getStartPosition())&&(e=r.getStartPosition());const{lineNumber:a,column:l}=e,c=this._editor.getModel();let d=new z(a,l),h=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(148):null,t);return i&&h&&h.range.isEmpty()&&h.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),h=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(148):null,t)),h?!n&&!r.containsRange(h.range)?this._getNextMatch(h.range.getEndPosition(),t,i,!0):h:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?pze(this._state.replaceString):Ww.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const n=e.buildReplaceString(i.matches,this._state.preserveCase),o=new vo(t,n);this._executeEditorCommand("replace",o),this._decorations.setStartPosition(new z(t.startLineNumber,t.startColumn+n.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const n=(e||[null]).map(o=>fx._getSearchRange(this._editor.getModel(),o));return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(148):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=Tg?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new np(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(148):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let h="mu";i.ignoreCase&&(h+="i"),i.global&&(h+="g"),i=new RegExp(i.source,h)}const n=this._editor.getModel(),o=n.getValue(1),r=n.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=o.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=o.replace(i,a.buildReplaceString(null,c));const d=new UU(r,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",d)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),n=[];for(let r=0,a=i.length;r<a;r++)n[r]=t.buildReplaceString(i[r].matches,this._state.preserveCase);const o=new fze(this._editor.getSelection(),i.map(r=>r.range),n);this._executeEditorCommand("replaceAll",o)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let i=this._findMatches(e,!1,1073741824).map(o=>new Oe(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn));const n=this._editor.getSelection();for(let o=0,r=i.length;o<r;o++)if(i[o].equalsRange(n)){i=[n].concat(i.slice(0,o)).concat(i.slice(o+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}const bze=_(2,"Match Case"),vze=_(3,"Match Whole Word"),Cze=_(4,"Use Regular Expression");class bde extends Mf{constructor(e){super({icon:ge.caseSensitive,title:bze+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class vde extends Mf{constructor(e){super({icon:ge.wholeWord,title:vze+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Cde extends Mf{constructor(e){super({icon:ge.regex,title:Cze+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}function wze(s,e,t){const i=t??document.createElement("div");return i.textContent=s,i}function yze(s,e,t){const i=t??document.createElement("div");return i.textContent="",wde(i,xze(s),e==null?void 0:e.actionHandler,e==null?void 0:e.renderCodeSegments),i}class Sze{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function wde(s,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){const o=document.createElement("a");t.disposables.add(Jn(o,"click",r=>{t.callback(String(e.index),r)})),n=o}else e.type===8?n=document.createElement("br"):e.type===1&&(n=s);n&&s!==n&&s.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(o=>{wde(n,o,t,i)})}function xze(s,e){const t={type:1,children:[]};let i=0,n=t;const o=[],r=new Sze(s);for(;!r.eos();){let a=r.next();const l=a==="\\"&&LW(r.peek())!==0;if(l&&(a=r.next()),!l&&Lze(a)&&a===r.peek()){r.advance(),n.type===2&&(n=o.pop());const c=LW(a);if(n.type===c||n.type===5&&c===6)n=o.pop();else{const d={type:c,children:[]};c===5&&(d.index=i,i++),n.children.push(d),o.push(n),n=d}}else if(a===`
`)n.type===2&&(n=o.pop()),n.children.push({type:8});else if(n.type!==2){const c={type:2,content:a};n.children.push(c),o.push(n),n=c}else n.content+=a}return n.type===2&&(n=o.pop()),t}function Lze(s,e){return LW(s)!==0}function LW(s,e){switch(s){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return 0;default:return 0}}class Ize{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class Eze{constructor(e=new Set,t=10){this._history=e,this._limit=t,this._onChange(),this._history.onDidChange&&(this._disposable=this._history.onDidChange(()=>this._onChange()))}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new Ize(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;if(e.length>this._limit){const t=e.slice(e.length-this._limit);this._history.replace?this._history.replace(t):this._history=new Set(t)}}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}dispose(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0)}}const Yv=we;let kze=class extends va{get onDidChange(){return this._onDidChange.event}get onDidHeightChange(){return this._onDidHeightChange.event}constructor(e,t,i){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this.hover=this._register(new mi),this._onDidChange=this._register(new q),this._onDidHeightChange=this._register(new q),this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=me(e,Yv(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",o=me(this.element,Yv(".ibwrapper"));if(this.input=me(o,Yv(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=me(o,Yv("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new Hre(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),me(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));const r=this._register(new Si(e.ownerDocument,"selectionchange")),a=Se.filter(r.event,()=>{const l=e.ownerDocument.getSelection();return(l==null?void 0:l.anchorNode)===o});this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Fr(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover.value||(this.hover.value=this._register(yc().setupDelayedHoverAtMouse(this.input,()=>({content:this.tooltip,appearance:{compact:!0}}))))}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:Mu(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return CO(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const e=this.input.selectionStart;if(e===null)return null;const t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&la(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Ju(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=Jr(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=me(n,Yv(".monaco-inputbox-container")),t();const o=Yv("span.monaco-inputbox-message");this.message.formatContent?yze(this.message.content,void 0,o):wze(this.message.content,void 0,o),o.classList.add(this.classForType(this.message.type));const r=this.stylesForType(this.message.type);return o.style.backgroundColor=r.background??"",o.style.color=r.foreground??"",o.style.border=r.border?`1px solid ${r.border}`:"",me(e,o),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=_(9,"Error: {0}",this.message.content):this.message.type===2?i=_(10,"Warning: {0}",this.message.content):i=_(11,"Info: {0}",this.message.content),br(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText=" ",this.layout()}applyStyles(){const e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Ju(n,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=Mu(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,o=t.value;i!==null&&n!==null&&(this.value=o.substr(0,i)+e+o.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){var e;this._hideMessage(),this.message=null,(e=this.actionbar)==null||e.dispose(),super.dispose()}};class yde extends kze{constructor(e,t,i){const n=_(12," or {0} for history","⇅"),o=_(13," ({0} for history)","⇅");super(e,t,i),this._onDidFocus=this._register(new q),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new q),this.onDidBlur=this._onDidBlur.event,this.history=this._register(new Eze(i.history,100));const r=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){const a=this.placeholder.endsWith(")")?n:o,l=this.placeholder+a;i.showPlaceholderOnFocus&&!CO(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(c=>{c.target.textContent||r()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>r()),this.onblur(this.input,()=>{const a=l=>{if(this.placeholder.endsWith(l)){const c=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=c:this.setPlaceHolder(c),!0}else return!1};a(o)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",ld(this.value?this.value:_(14,"Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,ld(this.value))}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const Dze=_(1,"input");class Sde extends va{get onDidOptionChange(){return this._onDidOptionChange.event}get onKeyDown(){return this._onKeyDown.event}get onMouseDown(){return this._onMouseDown.event}get onCaseSensitiveKeyDown(){return this._onCaseSensitiveKeyDown.event}get onRegexKeyDown(){return this._onRegexKeyDown.event}constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new mi),this.additionalToggles=[],this._onDidOptionChange=this._register(new q),this._onKeyDown=this._register(new q),this._onMouseDown=this._register(new q),this._onInput=this._register(new q),this._onKeyUp=this._register(new q),this._onCaseSensitiveKeyDown=this._register(new q),this._onRegexKeyDown=this._register(new q),this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||Dze,this.showCommonFindToggles=!!i.showCommonFindToggles;const n=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",r=i.appendRegexLabel||"",a=!!i.flexibleHeight,l=!!i.flexibleWidth,c=i.flexibleMaxHeight;if(this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new yde(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},showHistoryHint:i.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:i.inputBoxStyles,history:i.history})),this.showCommonFindToggles){const d=(i==null?void 0:i.hoverLifecycleOptions)||{groupId:"find-input"};this.regex=this._register(new Cde({appendTitle:r,isChecked:!1,hoverLifecycleOptions:d,...i.toggleStyles})),this._register(this.regex.onChange(u=>{this._onDidOptionChange.fire(u),!u&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(u=>{this._onRegexKeyDown.fire(u)})),this.wholeWords=this._register(new vde({appendTitle:o,isChecked:!1,hoverLifecycleOptions:d,...i.toggleStyles})),this._register(this.wholeWords.onChange(u=>{this._onDidOptionChange.fire(u),!u&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new bde({appendTitle:n,isChecked:!1,hoverLifecycleOptions:d,...i.toggleStyles})),this._register(this.caseSensitive.onChange(u=>{this._onDidOptionChange.fire(u),!u&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(u=>{this._onCaseSensitiveKeyDown.fire(u)}));const h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,u=>{if(u.equals(15)||u.equals(17)||u.equals(9)){const f=h.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;u.equals(17)?g=(f+1)%h.length:u.equals(15)&&(f===0?g=h.length-1:g=f-1),u.equals(9)?(h[f].blur(),this.inputBox.focus()):g>=0&&h[g].focus(),ri.stop(u,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i==null?void 0:i.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e==null||e.appendChild(this.domNode),this._register(ee(this.inputBox.inputElement,"compositionstart",d=>{this.imeSessionInProgress=!0})),this._register(ee(this.inputBox.inputElement,"compositionend",d=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,d=>this._onKeyDown.fire(d)),this.onkeyup(this.inputBox.inputElement,d=>this._onKeyUp.fire(d)),this.oninput(this.inputBox.inputElement,d=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,d=>this._onMouseDown.fire(d))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){var e,t,i;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(e=this.regex)==null||e.enable(),(t=this.wholeWords)==null||t.enable(),(i=this.caseSensitive)==null||i.enable();for(const n of this.additionalToggles)n.enable()}disable(){var e,t,i;this.domNode.classList.add("disabled"),this.inputBox.disable(),(e=this.regex)==null||e.disable(),(t=this.wholeWords)==null||t.disable(),(i=this.caseSensitive)==null||i.disable();for(const n of this.additionalToggles)n.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new oe;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){var t,i,n;e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(((t=this.caseSensitive)==null?void 0:t.width())??0)+(((i=this.wholeWords)==null?void 0:i.width())??0)+(((n=this.regex)==null?void 0:n.width())??0)+this.additionalToggles.reduce((o,r)=>o+r.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var e;return((e=this.caseSensitive)==null?void 0:e.checked)??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){var e;return((e=this.wholeWords)==null?void 0:e.checked)??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){var e;return((e=this.regex)==null?void 0:e.checked)??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){var e;(e=this.caseSensitive)==null||e.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}const Tze=_(5,"input"),Nze=_(6,"Preserve Case");class Rze extends Mf{constructor(e){super({icon:ge.preserveCase,title:Nze+e.appendTitle,isChecked:e.isChecked,hoverLifecycleOptions:e.hoverLifecycleOptions,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Mze extends va{get onDidOptionChange(){return this._onDidOptionChange.event}get onKeyDown(){return this._onKeyDown.event}get onPreserveCaseKeyDown(){return this._onPreserveCaseKeyDown.event}constructor(e,t,i,n){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new q),this._onKeyDown=this._register(new q),this._onMouseDown=this._register(new q),this._onInput=this._register(new q),this._onKeyUp=this._register(new q),this._onPreserveCaseKeyDown=this._register(new q),this.contextViewProvider=t,this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||Tze;const o=n.appendPreserveCaseLabel||"",r=n.history||new Set([]),a=!!n.flexibleHeight,l=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new yde(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:r,showHistoryHint:n.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles})),this.preserveCase=this._register(new Rze({appendTitle:o,isChecked:!1,hoverLifecycleOptions:n.hoverLifecycleOptions,...n.toggleStyles})),this._register(this.preserveCase.onChange(u=>{this._onDidOptionChange.fire(u),!u&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(u=>{this._onPreserveCaseKeyDown.fire(u)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const d=[this.preserveCase.domNode];this.onkeydown(this.domNode,u=>{if(u.equals(15)||u.equals(17)||u.equals(9)){const f=d.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let g=-1;u.equals(17)?g=(f+1)%d.length:u.equals(15)&&(f===0?g=d.length-1:g=f-1),u.equals(9)?(d[f].blur(),this.inputBox.focus()):g>=0&&d[g].focus(),ri.stop(u,!0)}}});const h=document.createElement("div");h.className="controls",h.style.display=this._showOptionButtons?"block":"none",h.appendChild(this.preserveCase.domNode),this.domNode.appendChild(h),e==null||e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){var e;(e=this.inputBox)==null||e.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var xde=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Lde=function(s,e){return function(t,i){e(t,i,s)}};const Fq=new Ne("suggestWidgetVisible",!1,_(1698,"Whether suggestion are visible")),Bq="historyNavigationWidgetFocus",Ide="historyNavigationForwardsEnabled",Ede="historyNavigationBackwardsEnabled";let sf;const qD=[];function kde(s,e){if(qD.includes(e))throw new Error("Cannot register the same widget multiple times");qD.push(e);const t=new oe,i=new Ne(Bq,!1).bindTo(s),n=new Ne(Ide,!0).bindTo(s),o=new Ne(Ede,!0).bindTo(s),r=()=>{i.set(!0),sf=e},a=()=>{i.set(!1),sf===e&&(sf=void 0)};return CO(e.element)&&r(),t.add(e.onDidFocus(()=>r())),t.add(e.onDidBlur(()=>a())),t.add(Ve(()=>{qD.splice(qD.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:o,dispose(){t.dispose()}}}let IW=class extends Sde{constructor(e,t,i,n){super(e,t,i);const o=this._register(n.createScoped(this.inputBox.element));this._register(kde(o,this.inputBox))}};IW=xde([Lde(3,ut)],IW);let EW=class extends Mze{constructor(e,t,i,n,o=!1){super(e,t,o,i);const r=this._register(n.createScoped(this.inputBox.element));this._register(kde(r,this.inputBox))}};EW=xde([Lde(3,ut)],EW);Ks.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:de.and(de.has(Bq),de.equals(Ede,!0),de.not("isComposing"),Fq.isEqualTo(!1)),primary:16,secondary:[528],handler:s=>{sf==null||sf.showPreviousValue()}});Ks.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:de.and(de.has(Bq),de.equals(Ide,!0),de.not("isComposing"),Fq.isEqualTo(!1)),primary:18,secondary:[530],handler:s=>{sf==null||sf.showNextValue()}});function HQ(s){var e,t;return((e=s.lookupKeybinding("history.showPrevious"))==null?void 0:e.getElectronAccelerator())==="Up"&&((t=s.lookupKeybinding("history.showNext"))==null?void 0:t.getElectronAccelerator())==="Down"}const VQ=rn("find-collapsed",ge.chevronRight,_(956,"Icon to indicate that the editor find widget is collapsed.")),zQ=rn("find-expanded",ge.chevronDown,_(957,"Icon to indicate that the editor find widget is expanded.")),Aze=rn("find-selection",ge.selection,_(958,"Icon for 'Find in Selection' in the editor find widget.")),Pze=rn("find-replace",ge.replace,_(959,"Icon for 'Replace' in the editor find widget.")),Oze=rn("find-replace-all",ge.replaceAll,_(960,"Icon for 'Replace All' in the editor find widget.")),Fze=rn("find-previous-match",ge.arrowUp,_(961,"Icon for 'Find Previous' in the editor find widget.")),Bze=rn("find-next-match",ge.arrowDown,_(962,"Icon for 'Find Next' in the editor find widget.")),Wze=_(963,"Find / Replace"),Hze=_(964,"Find"),Vze=_(965,"Find"),zze=_(966,"Previous Match"),Uze=_(967,"Next Match"),$ze=_(968,"Find in Selection"),qze=_(969,"Close"),jze=_(970,"Replace"),Kze=_(971,"Replace"),Gze=_(972,"Replace"),Yze=_(973,"Replace All"),Xze=_(974,"Toggle Replace"),Zze=_(975,"Only the first {0} results are highlighted, but all find operations work on the entire text.",Tg),Qze=_(976,"{0} of {1}"),UQ=_(977,"No results"),kd=419,Jze=275,eUe=Jze-54;let Q0=69;const tUe=33,$Q=Bt?256:2048;class jF{constructor(e){this.afterLineNumber=e,this.heightInPx=tUe,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function qQ(s,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){s.stopPropagation();return}}function jQ(s,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){s.stopPropagation();return}}const VA=class VA extends va{constructor(e,t,i,n,o,r,a,l,c){super(),this._hoverService=a,this._findWidgetSearchHistory=l,this._replaceWidgetHistory=c,this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=n,this._keybindingService=o,this._contextKeyService=r,this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new Pl(500),this._register(Ve(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(d=>this._onStateChanged(d))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(d=>{if(d.hasChanged(104)&&(this._codeEditor.getOption(104)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),d.hasChanged(165)&&this._tryUpdateWidgetWidth(),d.hasChanged(2)&&this.updateAccessibilitySupport(),d.hasChanged(50)){const h=this._codeEditor.getOption(50).loop;this._state.change({loop:h},!1);const u=this._codeEditor.getOption(50).addExtraSpaceOnTop;u&&!this._viewZone&&(this._viewZone=new jF(0),this._showViewZone()),!u&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(async()=>{if(this._isVisible){const d=await this._controller.getGlobalBufferTerm();d&&d!==this._state.searchString&&(this._state.change({searchString:d},!1),this._findInput.select())}})),this._findInputFocused=w4.bindTo(r),this._findFocusTracker=this._register(Ol(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=Oq.bindTo(r),this._replaceFocusTracker=this._register(Ol(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(50).addExtraSpaceOnTop&&(this._viewZone=new jF(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(d=>{if(d.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return VA.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(104)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=Jr(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,_t)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){var t;this._matchesCount.style.minWidth=Q0+"px",this._state.matchesCount>=Tg?this._matchesCount.title=Zze:this._matchesCount.title="",(t=this._matchesCount.firstChild)==null||t.remove();let e;if(this._state.matchesCount>0){let i=String(this._state.matchesCount);this._state.matchesCount>=Tg&&(i+="+");let n=String(this._state.matchesPosition);n==="0"&&(n="?"),e=Rb(Qze,n,i)}else e=UQ;this._matchesCount.appendChild(document.createTextNode(e)),br(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),Q0=Math.max(Q0,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===UQ)return i===""?_(978,"{0} found",e):_(979,"{0} found for '{1}'",e,i);if(t){const n=_(980,"{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),o=this._codeEditor.getModel();return o&&t.startLineNumber<=o.getLineCount()&&t.startLineNumber>=1?`${o.getLineContent(t.startLineNumber)}, ${n}`:n}return _(981,"{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(104);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(50).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(50).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const n=Fn(i),o=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),r=n.left+(o?o.left:0),a=o?o.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=goe(this._domNode).left;r>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());n.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(50).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(n=>{i.heightInPx=this._getHeight(),this._viewZoneId=n.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(50).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new jF(0));const i=this._viewZone;this._codeEditor.changeViewZones(n=>{if(this._viewZoneId!==void 0){const o=this._getHeight();if(o===i.heightInPx)return;const r=o-i.heightInPx;i.heightInPx=o,n.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r);return}else{let o=this._getHeight();if(o-=this._codeEditor.getOption(96).top,o<=0)return;i.heightInPx=o,this._viewZoneId=n.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!this._domNode.isConnected)return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,n=e.minimap.minimapWidth;let o=!1,r=!1,a=!1;if(this._resized&&Jr(this._domNode)>kd){this._domNode.style.maxWidth=`${i-28-n-15}px`,this._replaceInput.width=Jr(this._findInput.domNode);return}if(kd+28+n>=i&&(r=!0),kd+28+n-Q0>=i&&(a=!0),kd+28+n-Q0>=i+50&&(o=!0),this._domNode.classList.toggle("collapsed-find-widget",o),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",r),!a&&!o&&(this._domNode.style.maxWidth=`${i-28-n-15}px`),this._findInput.layout({collapsedFindWidget:o,narrowFindWidget:a,reducedFindWidget:r}),this._resized){const l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=Jr(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!D.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals($Q|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return qQ(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return jQ(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals($Q|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return qQ(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return jQ(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){const i=this._codeEditor.getOption(50).history,n=this._codeEditor.getOption(50).replaceHistory;this._findInput=this._register(new IW(null,this._contextViewProvider,{width:eUe,label:Hze,placeholder:Vze,appendCaseSensitiveLabel:this._keybindingLabelFor(Zi.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(Zi.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(Zi.ToggleRegexCommand),validation:h=>{if(h.length===0||!this._findInput.getRegex())return null;try{return new RegExp(h,"gu"),null}catch(u){return{content:u.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>HQ(this._keybindingService),inputBoxStyles:s2,toggleStyles:n2,history:i==="workspace"?this._findWidgetSearchHistory:new Set([])},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(h=>{h.equals(3)&&!this._codeEditor.getOption(50).findOnType&&this._state.change({searchString:this._findInput.getValue()},!0),this._onFindInputKeyDown(h)})),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||!this._codeEditor.getOption(50).findOnType||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(h=>{h.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),h.preventDefault())})),this._register(this._findInput.onRegexKeyDown(h=>{h.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),h.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(h=>{this._tryUpdateHeight()&&this._showViewZone()})),Hr&&this._register(this._findInput.onMouseDown(h=>this._onFindInputMouseDown(h))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount();const o={groupId:"find-widget"};this._prevBtn=this._register(new ap({label:zze+this._keybindingLabelFor(Zi.PreviousMatchFindAction),icon:Fze,hoverLifecycleOptions:o,onTrigger:()=>{_g(this._codeEditor.getAction(Zi.PreviousMatchFindAction)).run().then(void 0,_t)}},this._hoverService)),this._nextBtn=this._register(new ap({label:Uze+this._keybindingLabelFor(Zi.NextMatchFindAction),icon:Bze,hoverLifecycleOptions:o,onTrigger:()=>{_g(this._codeEditor.getAction(Zi.NextMatchFindAction)).run().then(void 0,_t)}},this._hoverService));const r=document.createElement("div");r.className="find-part",r.appendChild(this._findInput.domNode);const a=document.createElement("div");a.className="find-actions",r.appendChild(a),a.appendChild(this._matchesCount),a.appendChild(this._prevBtn.domNode),a.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Mf({icon:Aze,title:$ze+this._keybindingLabelFor(Zi.ToggleSearchScopeCommand),isChecked:!1,hoverLifecycleOptions:o,inputActiveOptionBackground:ve(d0),inputActiveOptionBorder:ve(mk),inputActiveOptionForeground:ve(pk)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let h=this._codeEditor.getSelections();h=h.map(u=>(u.endColumn===1&&u.endLineNumber>u.startLineNumber&&(u=u.setEndPosition(u.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(u.endLineNumber-1))),u.isEmpty()?null:u)).filter(u=>!!u),h.length&&this._state.change({searchScope:h},!0)}}else this._state.change({searchScope:null},!0)})),a.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new ap({label:qze+this._keybindingLabelFor(Zi.CloseFindWidgetCommand),icon:ece,hoverLifecycleOptions:o,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:h=>{h.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),h.preventDefault())}},this._hoverService)),this._replaceInput=this._register(new EW(null,void 0,{label:jze,placeholder:Kze,appendPreserveCaseLabel:this._keybindingLabelFor(Zi.TogglePreserveCaseCommand),history:n==="workspace"?this._replaceWidgetHistory:new Set([]),flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>HQ(this._keybindingService),inputBoxStyles:s2,toggleStyles:n2,hoverLifecycleOptions:o},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(h=>this._onReplaceInputKeyDown(h))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(h=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(h=>{h.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),h.preventDefault())})),this._replaceBtn=this._register(new ap({label:Gze+this._keybindingLabelFor(Zi.ReplaceOneAction),icon:Pze,hoverLifecycleOptions:o,onTrigger:()=>{this._controller.replace()},onKeyDown:h=>{h.equals(1026)&&(this._closeBtn.focus(),h.preventDefault())}},this._hoverService)),this._replaceAllBtn=this._register(new ap({label:Yze+this._keybindingLabelFor(Zi.ReplaceAllAction),icon:Oze,hoverLifecycleOptions:o,onTrigger:()=>{this._controller.replaceAll()}},this._hoverService));const l=document.createElement("div");l.className="replace-part",l.appendChild(this._replaceInput.domNode);const c=document.createElement("div");c.className="replace-actions",l.appendChild(c),c.appendChild(this._replaceBtn.domNode),c.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new ap({label:Xze,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=Jr(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}},this._hoverService)),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=Wze,this._domNode.role="dialog",this._domNode.style.width=`${kd}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(r),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(l),this._resizeSash=this._register(new Eo(this._domNode,this,{orientation:0,size:2})),this._resized=!1;let d=kd;this._register(this._resizeSash.onDidStart(()=>{d=Jr(this._domNode)})),this._register(this._resizeSash.onDidChange(h=>{this._resized=!0;const u=d+h.startX-h.currentX;if(u<kd)return;const f=parseFloat(vO(this._domNode).maxWidth)||0;u>f||(this._domNode.style.width=`${u}px`,this._isReplaceVisible&&(this._replaceInput.width=Jr(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const h=Jr(this._domNode);if(h<kd)return;let u=kd;if(!this._resized||h===kd){const f=this._codeEditor.getLayoutInfo();u=f.width-28-f.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${u}px`,this._isReplaceVisible&&(this._replaceInput.width=Jr(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}getViewState(){let e=!1;return this._viewZone&&this._viewZoneId&&(e=this._viewZone.heightInPx>this._codeEditor.getScrollTop()),{widgetViewZoneVisible:e,scrollTop:this._codeEditor.getScrollTop()}}setViewState(e){e&&e.widgetViewZoneVisible&&this._layoutViewZone(e.scrollTop)}};VA.ID="editor.contrib.findWidget";let kW=VA;class ap extends va{constructor(e,t){super(),this._opts=e;let i="button";this._opts.className&&(i=i+" "+this._opts.className),this._opts.icon&&(i=i+" "+it.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.tabIndex=0,this._domNode.className=i,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this._register(t.setupDelayedHover(this._domNode,{content:this._opts.label,style:1},e.hoverLifecycleOptions)),this.onclick(this._domNode,n=>{this._opts.onTrigger(),n.preventDefault()}),this.onkeydown(this._domNode,n=>{var o,r;if(n.equals(10)||n.equals(3)){this._opts.onTrigger(),n.preventDefault();return}(r=(o=this._opts).onKeyDown)==null||r.call(o,n)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...it.asClassNameArray(VQ)),this._domNode.classList.add(...it.asClassNameArray(zQ))):(this._domNode.classList.remove(...it.asClassNameArray(zQ)),this._domNode.classList.add(...it.asClassNameArray(VQ)))}}Ul((s,e)=>{const t=s.getColor(wg);t&&e.addRule(`.monaco-editor .findMatch { border: 1px ${od(s.type)?"dotted":"solid"} ${t}; box-sizing: border-box; }`);const i=s.getColor(VMe);i&&e.addRule(`.monaco-editor .findScope { border: 1px ${od(s.type)?"dashed":"solid"} ${i}; }`);const n=s.getColor(Yt);n&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${n}; }`);const o=s.getColor(WMe);o&&e.addRule(`.monaco-editor .findMatchInline { color: ${o}; }`);const r=s.getColor(HMe);r&&e.addRule(`.monaco-editor .currentFindMatchInline { color: ${r}; }`)});var iUe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},KQ=function(s,e){return function(t,i){e(t,i,s)}};let DW=class extends K{constructor(e,t,i,n){super(),this._container=e,this._getContent=t,this._clipboardService=i,this._hoverService=n,this._container.classList.add("hover-row-with-copy"),this._button=this._register(new ap({label:_(1128,"Copy"),icon:ge.copy,onTrigger:()=>this._copyContent(),className:"hover-copy-button"},this._hoverService)),this._container.appendChild(this._button.domNode)}async _copyContent(){const e=this._getContent();e&&(await this._clipboardService.writeText(e),ld(_(1129,"Copied to clipboard")))}};DW=iUe([KQ(2,pa),KQ(3,Sr)],DW);class nUe{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}async function sUe(s,e,t,i,n){const o=await Promise.resolve(s.provideHover(t,i,n)).catch(as);if(!(!o||!oUe(o)))return new nUe(s,o,e)}function Wq(s,e,t,i,n=!1){const r=s.ordered(e,n).map((a,l)=>sUe(a,l,e,t,i));return Dl.fromPromisesResolveOrder(r).coalesce()}async function Dde(s,e,t,i,n=!1){const o=[];for await(const r of Wq(s,e,t,i,n))o.push(r.hover);return o}qr("_executeHoverProvider",(s,e,t)=>{const i=s.get(We);return Dde(i.hoverProvider,e,t,Ft.None)});qr("_executeHoverProvider_recursive",(s,e,t)=>{const i=s.get(We);return Dde(i.hoverProvider,e,t,Ft.None,!0)});function oUe(s){const e=typeof s.range<"u",t=typeof s.contents<"u"&&s.contents&&s.contents.length>0;return e&&t}var rUe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xv=function(s,e){return function(t,i){e(t,i,s)}};const e_=we,aUe=rn("hover-increase-verbosity",ge.add,_(1130,"Icon for increaseing hover verbosity.")),lUe=rn("hover-decrease-verbosity",ge.remove,_(1131,"Icon for decreasing hover verbosity."));class cc{constructor(e,t,i,n,o,r=void 0){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=n,this.ordinal=o,this.source=r}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}class Tde{constructor(e,t,i){this.hover=e,this.hoverProvider=t,this.hoverPosition=i}supportsVerbosityAction(e){switch(e){case ea.Increase:return this.hover.canIncreaseVerbosity??!1;case ea.Decrease:return this.hover.canDecreaseVerbosity??!1}}}let vI=class{constructor(e,t,i,n,o,r,a){this._editor=e,this._markdownRendererService=t,this._configurationService=i,this._languageFeaturesService=n,this._keybindingService=o,this._hoverService=r,this._commandService=a,this.hoverOrdinal=3}createLoadingMessage(e){return new cc(this,e.range,[new To().appendText(_(1132,"Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),r=[];let a=1e3;const l=i.getLineLength(n),c=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),d=this._editor.getOption(133),h=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let u=!1;d>=0&&l>d&&e.range.startColumn>=d&&(u=!0,r.push(new cc(this,e.range,[{value:_(1133,"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!u&&typeof h=="number"&&l>=h&&r.push(new cc(this,e.range,[{value:_(1134,"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let f=!1;for(const g of t){const m=g.range.startLineNumber===n?g.range.startColumn:1,p=g.range.endLineNumber===n?g.range.endColumn:o,v=g.options.hoverMessage;if(!v||Mw(v))continue;g.options.beforeContentClassName&&(f=!0);const b=new D(e.range.startLineNumber,m,e.range.startLineNumber,p);r.push(new cc(this,b,DU(v),f,a++))}return r}computeAsync(e,t,i,n){if(!this._editor.hasModel()||e.type!==1)return Dl.EMPTY;const o=this._editor.getModel(),r=this._languageFeaturesService.hoverProvider;return r.has(o)?this._getMarkdownHovers(r,o,e,n):Dl.EMPTY}async*_getMarkdownHovers(e,t,i,n){const o=i.range.getStartPosition(),r=Wq(e,t,o,n);for await(const a of r)if(!Mw(a.hover.contents)){const l=a.hover.range?D.lift(a.hover.range):i.range,c=new Tde(a.hover,a.provider,o);yield new cc(this,l,a.hover.contents,!1,a.ordinal,c)}}renderHoverParts(e,t){return this._renderedHoverParts=new cUe(t,e.fragment,this,this._editor,this._commandService,this._keybindingService,this._hoverService,this._configurationService,this._markdownRendererService,e.onContentsChanged),this._renderedHoverParts}handleScroll(e){var t;(t=this._renderedHoverParts)==null||t.handleScroll(e)}getAccessibleContent(e){var t;return((t=this._renderedHoverParts)==null?void 0:t.getAccessibleContent(e))??""}updateMarkdownHoverVerbosityLevel(e,t){var i;return Promise.resolve((i=this._renderedHoverParts)==null?void 0:i.updateMarkdownHoverPartVerbosityLevel(e,t))}};vI=rUe([Xv(1,Sc),Xv(2,xt),Xv(3,We),Xv(4,ai),Xv(5,Sr),Xv(6,en)],vI);class jD{constructor(e,t,i,n){this.hoverPart=e,this.hoverElement=t,this.disposables=i,this.actionsContainer=n}dispose(){this.disposables.dispose()}}class cUe{constructor(e,t,i,n,o,r,a,l,c,d){this._hoverParticipant=i,this._editor=n,this._commandService=o,this._keybindingService=r,this._hoverService=a,this._configurationService=l,this._markdownRendererService=c,this._onFinishedRendering=d,this._ongoingHoverOperations=new Map,this._disposables=new oe,this.renderedHoverParts=this._renderHoverParts(e,t,this._onFinishedRendering),this._disposables.add(Ve(()=>{this.renderedHoverParts.forEach(h=>{h.dispose()}),this._ongoingHoverOperations.forEach(h=>{h.tokenSource.dispose(!0)})}))}_renderHoverParts(e,t,i){return e.sort(wo(n=>n.ordinal,aa)),e.map(n=>{const o=this._renderHoverPart(n,i);return t.appendChild(o.hoverElement),o})}_renderHoverPart(e,t){const i=this._renderMarkdownHover(e,t),n=i.hoverElement,o=e.source,r=new oe;if(r.add(i),!o)return new jD(e,n,r);const a=o.supportsVerbosityAction(ea.Increase),l=o.supportsVerbosityAction(ea.Decrease);if(!a&&!l)return new jD(e,n,r);const c=e_("div.verbosity-actions");n.prepend(c);const d=e_("div.verbosity-actions-inner");return c.append(d),r.add(this._renderHoverExpansionAction(d,ea.Increase,a)),r.add(this._renderHoverExpansionAction(d,ea.Decrease,l)),new jD(e,n,r,d)}_renderMarkdownHover(e,t){return Nde(this._editor,e,this._markdownRendererService,t)}_renderHoverExpansionAction(e,t,i){const n=new oe,o=t===ea.Increase,r=me(e,e_(it.asCSSSelector(o?aUe:lUe)));r.tabIndex=0;const a=new Pw("mouse",void 0,{target:e,position:{hoverPosition:0}},this._configurationService,this._hoverService);if(n.add(this._hoverService.setupManagedHover(a,r,hUe(this._keybindingService,t))),!i)return r.classList.add("disabled"),n;r.classList.add("enabled");const l=()=>this._commandService.executeCommand(t===ea.Increase?_4:b4,{focus:!0});return n.add(new hde(r,l)),n.add(new ude(r,l,[3,10])),n}handleScroll(e){this.renderedHoverParts.forEach(t=>{const i=t.actionsContainer;if(!i)return;const n=t.hoverElement,r=e.scrollTop+e.height,a=n.offsetTop,l=n.clientHeight,c=a+l,d=22;let h;c<=r||a>=r?h=l-d:h=r-a-d,i.style.top=`${h}px`})}async updateMarkdownHoverPartVerbosityLevel(e,t){const i=this._editor.getModel();if(!i)return;const n=this._getRenderedHoverPartAtIndex(t),o=n==null?void 0:n.hoverPart.source;if(!n||!(o!=null&&o.supportsVerbosityAction(e)))return;const r=await this._fetchHover(o,i,e);if(!r)return;const a=new Tde(r,o.hoverProvider,o.hoverPosition),l=n.hoverPart,c=new cc(this._hoverParticipant,l.range,r.contents,l.isBeforeContent,l.ordinal,a),d=this._updateRenderedHoverPart(t,c);if(d)return{hoverPart:c,hoverElement:d.hoverElement}}getAccessibleContent(e){const t=this.renderedHoverParts.findIndex(r=>r.hoverPart===e);if(t===-1)return;const i=this._getRenderedHoverPartAtIndex(t);return i?i.hoverElement.innerText.replace(/[^\S\n\r]+/gu," "):void 0}async _fetchHover(e,t,i){let n=i===ea.Increase?1:-1;const o=e.hoverProvider,r=this._ongoingHoverOperations.get(o);r&&(r.tokenSource.cancel(),n+=r.verbosityDelta);const a=new hn;this._ongoingHoverOperations.set(o,{verbosityDelta:n,tokenSource:a});const l={verbosityRequest:{verbosityDelta:n,previousHover:e.hover}};let c;try{c=await Promise.resolve(o.provideHover(t,e.hoverPosition,a.token,l))}catch(d){as(d)}return a.dispose(),this._ongoingHoverOperations.delete(o),c}_updateRenderedHoverPart(e,t){if(e>=this.renderedHoverParts.length||e<0)return;const i=this._renderHoverPart(t,this._onFinishedRendering),n=this.renderedHoverParts[e],o=n.hoverElement,r=i.hoverElement,a=Array.from(r.children);o.replaceChildren(...a);const l=new jD(t,o,i.disposables,i.actionsContainer);return n.dispose(),this.renderedHoverParts[e]=l,l}_getRenderedHoverPartAtIndex(e){return this.renderedHoverParts[e]}dispose(){this._disposables.dispose()}}function dUe(s,e,t,i){e.sort(wo(o=>o.ordinal,aa));const n=[];for(const o of e){const r=Nde(t,o,i,s.onContentsChanged);s.fragment.appendChild(r.hoverElement),n.push(r)}return new Jb(n)}function Nde(s,e,t,i){const n=new oe,o=e_("div.hover-row"),r=e_("div.hover-row-contents");o.appendChild(r);const a=e.contents;for(const c of a){if(Mw(c))continue;const d=e_("div.markdown-hover"),h=me(d,e_("div.hover-contents")),u=n.add(t.render(c,{context:s,asyncRenderCallback:()=>{h.className="hover-contents code-hover-contents",i()}}));h.appendChild(u.element),r.appendChild(d)}return{hoverPart:e,hoverElement:o,dispose(){n.dispose()}}}function hUe(s,e){switch(e){case ea.Increase:{const t=s.lookupKeybinding(_4);return t?_(1135,"Increase Hover Verbosity ({0})",t.getLabel()):_(1136,"Increase Hover Verbosity")}case ea.Decrease:{const t=s.lookupKeybinding(b4);return t?_(1137,"Decrease Hover Verbosity ({0})",t.getLabel()):_(1138,"Decrease Hover Verbosity")}}}const GQ=we;class uUe extends K{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new q,this.onColorFlushed=this._onColorFlushed.event,this._domNode=GQ(".saturation-wrap"),me(e,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",me(this._domNode,this._canvas),this.selection=GQ(".saturation-selection"),me(this._domNode,this.selection),this.layout(),this._register(ee(this._domNode,ye.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}get domNode(){return this._domNode}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;this.monitor=this._register(new l0);const t=Fn(this._domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>this.onDidChangePosition(n.pageX-t.left,n.pageY-t.top),()=>null);const i=ee(e.target.ownerDocument,ye.POINTER_UP,()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),n=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(i,n),this._onDidChange.fire({s:i,v:n})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new re(new dh(e.h,1,1,1)),i=this._canvas.getContext("2d"),n=i.createLinearGradient(0,0,this._canvas.width,0);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)");const o=i.createLinearGradient(0,0,0,this._canvas.height);o.addColorStop(0,"rgba(0, 0, 0, 0)"),o.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this._canvas.width,this._canvas.height),i.fillStyle=re.Format.CSS.format(t),i.fill(),i.fillStyle=n,i.fill(),i.fillStyle=o,i.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(e){if(this.monitor&&this.monitor.isMonitoring())return;this.paint();const t=e.hsva;this.paintSelection(t.s,t.v)}}class fUe extends K{constructor(e){super(),this._onClicked=this._register(new q),this.onClicked=this._onClicked.event,this._button=me(e,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._register(ee(this._button,ye.CLICK,()=>{this._onClicked.fire()}))}get button(){return this._button}}const J0=we;class Rde extends K{constructor(e,t,i){super(),this.model=t,this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new q,this.onColorFlushed=this._onColorFlushed.event,i==="standalone"?(this.domNode=me(e,J0(".standalone-strip")),this.overlay=me(this.domNode,J0(".standalone-overlay"))):(this.domNode=me(e,J0(".strip")),this.overlay=me(this.domNode,J0(".overlay"))),this.slider=me(this.domNode,J0(".slider")),this.slider.style.top="0px",this._register(ee(this.domNode,ye.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onDidChangeColor(e){const t=this.getValue(e);this.updateSliderPosition(t)}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._register(new l0),i=Fn(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.pointerId,e.buttons,o=>this.onDidChangeTop(o.pageY-i.top),()=>null);const n=ee(e.target.ownerDocument,ye.POINTER_UP,()=>{this._onColorFlushed.fire(),n.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}}class gUe extends Rde{constructor(e,t,i){super(e,t,i),this.domNode.classList.add("opacity-strip"),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){super.onDidChangeColor(e);const{r:t,g:i,b:n}=e.rgba,o=new re(new ce(t,i,n,1)),r=new re(new ce(t,i,n,0));this.overlay.style.background=`linear-gradient(to bottom, ${o} 0%, ${r} 100%)`}getValue(e){return e.hsva.a}}class mUe extends Rde{constructor(e,t,i){super(e,t,i),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}const pUe=we;class _Ue extends K{constructor(e,t,i,n){super(),this.model=t,this.pixelRatio=i,this._insertButton=null,this._domNode=pUe(".colorpicker-body"),me(e,this._domNode),this._saturationBox=new uUe(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new gUe(this._domNode,this.model,n),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new mUe(this._domNode,this.model,n),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),n==="standalone"&&(this._insertButton=this._register(new fUe(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva;this.model.color=new re(new dh(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new re(new dh(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=(1-e)*360;this.model.color=new re(new dh(i===360?0:i,t.s,t.v,t.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}}const bUe=we;class vUe extends K{constructor(e){super(),this._onClicked=this._register(new q),this.onClicked=this._onClicked.event,this._button=document.createElement("div"),this._button.classList.add("close-button"),me(e,this._button);const t=document.createElement("div");t.classList.add("close-button-inner-div"),me(this._button,t),me(t,bUe(".button"+it.asCSSSelector(rn("color-picker-close",ge.close,_(885,"Icon to close the color picker"))))).classList.add("close-icon"),this._register(ee(this._button,ye.CLICK,()=>{this._onClicked.fire()}))}}const KD=we;class CUe extends K{constructor(e,t,i,n){super(),this.model=t,this.type=n,this._closeButton=null,this._domNode=KD(".colorpicker-header"),me(e,this._domNode),this._pickedColorNode=me(this._domNode,KD(".picked-color")),me(this._pickedColorNode,KD("span.codicon.codicon-color-mode")),this._pickedColorPresentation=me(this._pickedColorNode,document.createElement("span")),this._pickedColorPresentation.classList.add("picked-color-presentation");const o=_(886,"Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",o),this._originalColorNode=me(this._domNode,KD(".original-color")),this._originalColorNode.style.backgroundColor=re.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=i.getColorTheme().getColor(_R)||re.white,this._register(i.onDidColorThemeChange(r=>{this.backgroundColor=r.getColor(_R)||re.white})),this._register(ee(this._pickedColorNode,ye.CLICK,()=>this.model.selectNextColorPresentation())),this._register(ee(this._originalColorNode,ye.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=re.Format.CSS.format(t.color)||"",this._pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter()),this.onDidChangeColor(this.model.color),this.type==="standalone"&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new vUe(this._domNode)))}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(e){this._pickedColorNode.style.backgroundColor=re.Format.CSS.format(e)||"",this._pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorPresentation.textContent=this.model.presentation?this.model.presentation.label:""}}const wUe=we;class Mde extends va{constructor(e,t,i,n,o){super(),this.model=t,this.pixelRatio=i,this._register(DL.getInstance(je(e)).onDidChange(()=>this.layout())),this._domNode=wUe(".colorpicker-widget"),e.appendChild(this._domNode),this.header=this._register(new CUe(this._domNode,this.model,n,o)),this.body=this._register(new _Ue(this._domNode,this.model,this.pixelRatio,o))}layout(){this.body.layout()}get domNode(){return this._domNode}}class yUe{get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new q,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new q,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new q,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){let i=-1;for(let n=0;n<this.colorPresentations.length;n++)if(t.toLowerCase()===this.colorPresentations[n].label){i=n;break}if(i===-1){const n=t.split("(")[0].toLowerCase();for(let o=0;o<this.colorPresentations.length;o++)if(this.colorPresentations[o].label.toLowerCase().startsWith(n)){i=o;break}}i!==-1&&i!==this.presentationIndex&&(this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}}async function Ade(s,e,t){const i=s.getValueInRange(e.range),{red:n,green:o,blue:r,alpha:a}=e.color,l=new ce(Math.round(n*255),Math.round(o*255),Math.round(r*255),a),c=new re(l),d=await ide(s,e,t,Ft.None),h=new yUe(c,[],0);return h.colorPresentations=d||[],h.guessColorPresentation(c,i),{range:D.lift(e.range),model:h,provider:t}}function Pde(s,e,t){const i=[],n=t.presentation.textEdit??{range:e,text:t.presentation.label,forceMoveMarkers:!1};i.push(n),t.presentation.additionalTextEdits&&i.push(...t.presentation.additionalTextEdits);const o=D.lift(n.range),r=s.getModel()._setTrackedRange(null,o,3);return s.executeEdits("colorpicker",i),s.pushUndoStop(),s.getModel()._getTrackedRange(r)??o}async function CI(s,e,t,i,n){const o=await ide(s,{range:i,color:{red:t.rgba.r/255,green:t.rgba.g/255,blue:t.rgba.b/255,alpha:t.rgba.a}},n.provider,Ft.None);e.colorPresentations=o||[]}var SUe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},xUe=function(s,e){return function(t,i){e(t,i,s)}};class S2{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}static fromBaseColor(e,t){return new S2(e,t.range,t.model,t.provider)}}let x2=class{constructor(e,t){this._editor=e,this._themeService=t,this.hoverOrdinal=2}computeSync(e,t,i){return[]}computeAsync(e,t,i,n){return Dl.fromPromise(this._computeAsync(e,t,i))}async _computeAsync(e,t,i){if(!this._editor.hasModel())return[];if(!this._isValidRequest(i))return[];const n=Fw.get(this._editor);if(!n)return[];for(const o of t){if(!n.isColorDecoration(o))continue;const r=n.getColorData(o.range.getStartPosition());if(r)return[S2.fromBaseColor(this,await Ade(this._editor.getModel(),r.colorInfo,r.provider))]}return[]}_isValidRequest(e){const t=this._editor.getOption(168);switch(e){case 0:return t==="hover"||t==="clickAndHover";case 1:return t==="click"||t==="clickAndHover";case 2:return!0}}renderHoverParts(e,t){const i=this._editor;if(t.length===0||!i.hasModel())return new Jb([]);const n=i.getOption(75)+8;e.setMinimumDimensions(new wi(302,n));const o=new oe,r=t[0],a=i.getModel(),l=r.model;this._colorPicker=o.add(new Mde(e.fragment,l,i.getOption(163),this._themeService,"hover"));let c=!1,d=new D(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn);o.add(l.onColorFlushed(async u=>{await CI(a,l,u,d,r),c=!0,d=Pde(i,d,l)})),o.add(l.onDidChangeColor(u=>{CI(a,l,u,d,r)})),o.add(i.onDidChangeModelContent(u=>{c?c=!1:(e.hide(),i.focus())}));const h={hoverPart:S2.fromBaseColor(this,r),hoverElement:this._colorPicker.domNode,dispose(){o.dispose()}};return new Jb([h])}getAccessibleContent(e){return _(887,"There is a color picker here.")}handleResize(){var e;(e=this._colorPicker)==null||e.layout()}handleContentsChanged(){var e;(e=this._colorPicker)==null||e.layout()}handleHide(){var e;(e=this._colorPicker)==null||e.dispose(),this._colorPicker=void 0}isColorPickerVisible(){return!!this._colorPicker}};x2=SUe([xUe(1,Dn)],x2);class Pn{static insert(e,t){return{range:new D(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function TW(s,e){return!!s[e]}class KF{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.mouseMiddleClickAction=t.mouseMiddleClickAction,this.hasTriggerModifier=TW(e.event,t.triggerModifier),this.isMiddleClick&&t.mouseMiddleClickAction==="ctrlLeftClick"&&(this.isMiddleClick=!1,this.isLeftClick=!0,this.hasTriggerModifier=!0),this.hasSideBySideModifier=TW(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class YQ{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=TW(e,t.triggerModifier)}}class GD{constructor(e,t,i,n,o){this.mouseMiddleClickAction=o,this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier&&this.mouseMiddleClickAction===e.mouseMiddleClickAction}}function XQ(s,e){return s==="altKey"?Bt?new GD(57,"metaKey",6,"altKey",e):new GD(5,"ctrlKey",6,"altKey",e):Bt?new GD(6,"altKey",57,"metaKey",e):new GD(6,"altKey",5,"ctrlKey",e)}class y4 extends K{constructor(e,t){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new q),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new q),this.onExecute=this._onExecute.event,this._onCancel=this._register(new q),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=(t==null?void 0:t.extractLineNumberFromMouseEvent)??(i=>i.target.position?i.target.position.lineNumber:0),this._opts=XQ(this._editor.getOption(86),this._editor.getOption(87)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(i=>{if(i.hasChanged(86)||i.hasChanged(87)){const n=XQ(this._editor.getOption(86),this._editor.getOption(87));if(this._opts.equals(n))return;this._opts=n,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(i=>this._onEditorMouseMove(new KF(i,this._opts)))),this._register(this._editor.onMouseDown(i=>this._onEditorMouseDown(new KF(i,this._opts)))),this._register(this._editor.onMouseUp(i=>this._onEditorMouseUp(new KF(i,this._opts)))),this._register(this._editor.onKeyDown(i=>this._onEditorKeyDown(new YQ(i,this._opts)))),this._register(this._editor.onKeyUp(i=>this._onEditorKeyUp(new YQ(i,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(i=>this._onDidChangeCursorSelection(i))),this._register(this._editor.onDidChangeModel(i=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(i=>{(i.scrollTopChanged||i.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);!!this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&(this._hasTriggerKeyOnMouseDown||e.isMiddleClick&&e.mouseMiddleClickAction==="openLink")&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}class Ode{constructor(e,t){this.range=e,this.direction=t}}class Hq{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new Hq(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}async resolve(e){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return await this._currentResolve,e.isCancellationRequested?void 0:this.resolve(e);this._isResolved||(this._currentResolve=this._doResolve(e).finally(()=>this._currentResolve=void 0)),await this._currentResolve}}async _doResolve(e){try{const t=await Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=(t==null?void 0:t.tooltip)??this.hint.tooltip,this.hint.label=(t==null?void 0:t.label)??this.hint.label,this.hint.textEdits=(t==null?void 0:t.textEdits)??this.hint.textEdits,this._isResolved=!0}catch(t){as(t),this._isResolved=!1}}}const n1=class n1{static async create(e,t,i,n){const o=[],r=e.ordered(t).reverse().map(a=>i.map(async l=>{try{const c=await a.provideInlayHints(t,l,n);(c!=null&&c.hints.length||a.onDidChangeInlayHints)&&o.push([c??n1._emptyInlayHintList,a])}catch(c){as(c)}}));if(await Promise.all(r.flat()),n.isCancellationRequested||t.isDisposed())throw new Ml;return new n1(i,o,t)}constructor(e,t,i){this._disposables=new oe,this.ranges=e,this.provider=new Set;const n=[];for(const[o,r]of t){this._disposables.add(o),this.provider.add(r);for(const a of o.hints){const l=i.validatePosition(a.position);let c="before";const d=n1._getRangeAtPosition(i,l);let h;d.getStartPosition().isBefore(l)?(h=D.fromPositions(d.getStartPosition(),l),c="after"):(h=D.fromPositions(l,d.getEndPosition()),c="before"),n.push(new Hq(a,new Ode(h,c),r))}}this.items=n.sort((o,r)=>z.compare(o.hint.position,r.hint.position))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new D(i,n.startColumn,i,n.endColumn);e.tokenization.tokenizeIfCheap(i);const o=e.tokenization.getLineTokens(i),r=t.column-1,a=o.findTokenIndexAtOffset(r);let l=o.getStartOffset(a),c=o.getEndOffset(a);return c-l===1&&(l===r&&a>1?(l=o.getStartOffset(a-1),c=o.getEndOffset(a-1)):c===r&&a<o.getCount()-1&&(l=o.getStartOffset(a+1),c=o.getEndOffset(a+1))),new D(i,l+1,i,c+1)}};n1._emptyInlayHintList=Object.freeze({dispose(){},hints:[]});let L2=n1;function LUe(s){return _le(s.id,...s.arguments??[]).toString()}function gd(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===yk.ICodeEditor:!1}function Vq(s){return s&&typeof s.getEditorType=="function"?s.getEditorType()===yk.IDiffEditor:!1}function IUe(s){return!!s&&typeof s=="object"&&typeof s.onDidChangeActiveEditor=="function"}function Fde(s){return gd(s)?s:Vq(s)?s.getModifiedEditor():IUe(s)&&gd(s.activeCodeEditor)?s.activeCodeEditor:null}var EUe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xh=function(s,e){return function(t,i){e(t,i,s)}};let Sf=class extends Vb{constructor(e,t,i,n,o,r,a,l,c,d,h,u,f){super(e,{...n.getRawOptions(),overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()},i,o,r,a,l,c,d,h,u,f),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration(g=>this._onParentConfigurationChanged(g)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){OO(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};Sf=EUe([Xh(4,$e),Xh(5,ii),Xh(6,en),Xh(7,ut),Xh(8,Dn),Xh(9,Hn),Xh(10,so),Xh(11,wn),Xh(12,We)],Sf);function Bde(s){const e=s.get(ii).getFocusedCodeEditor();return e instanceof Sf?e.getParentEditor():e}const ZQ=new re(new ce(0,122,204)),kUe={showArrow:!0,showFrame:!0,className:"",frameColor:ZQ,arrowColor:ZQ,keepEditorSelection:!1},DUe="vs.editor.contrib.zoneWidget";class TUe{constructor(e,t,i,n,o,r,a,l){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=n,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=o,this._onComputedHeight=r}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class NUe{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}const zA=class zA{constructor(e){this._editor=e,this._ruleName=zA._IdGenerator.nextId(),this._color=null,this._height=-1,this._decorations=this._editor.createDecorationsCollection()}dispose(){this.hide(),dB(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){dB(this._ruleName),mR(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `)}show(e){e.column===1&&(e={lineNumber:e.lineNumber,column:2}),this._decorations.set([{range:D.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}};zA._IdGenerator=new eq(".arrow-decoration-");let NW=zA;class RUe{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._isSashResizeHeight=!1,this._viewZone=null,this._disposables=new oe,this.container=null,this._isShowing=!1,this.editor=e,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=Xd(t),OO(this.options,kUe,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const n=this._getWidth(i);this.domNode.style.width=n+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(n)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new NW(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){const e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){var t;if(this.domNode.style.height=`${e}px`,this.container){const i=e-this._decoratingElementsHeight();this.container.style.height=`${i}px`;const n=this.editor.getLayoutInfo();this._doLayout(i,this._getWidth(n))}(t=this._resizeSash)==null||t.layout()}get position(){const e=this._positionMarkerId.getRange(0);if(e)return e.getStartPosition()}show(e,t){const i=D.isIRange(e)?D.lift(e):D.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:vt.EMPTY}])}hide(){var e;this._viewZone&&(this.editor.changeViewZones(t=>{this._viewZone&&t.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),(e=this._arrow)==null||e.hide(),this._positionMarkerId.clear(),this._isSashResizeHeight=!1}_decoratingElementsHeight(){const e=this.editor.getOption(75);let t=0;if(this.options.showArrow){const i=Math.round(e/3);t+=2*i}if(this.options.showFrame){const i=this.options.frameWidth??Math.round(e/9);t+=2*i}return t}_getMaximumHeightInLines(){return Math.max(12,this.editor.getLayoutInfo().height/this.editor.getOption(75)*.8)}_showImpl(e,t){const i=e.getStartPosition(),n=this.editor.getLayoutInfo(),o=this._getWidth(n);this.domNode.style.width=`${o}px`,this.domNode.style.left=this._getLeft(n)+"px";const r=document.createElement("div");r.style.overflow="hidden";const a=this.editor.getOption(75),l=this._getMaximumHeightInLines();l!==void 0&&(t=Math.min(t,l));let c=0,d=0;if(this._arrow&&this.options.showArrow&&(c=Math.round(a/3),this._arrow.height=c,this._arrow.show(i)),this.options.showFrame&&(d=Math.round(a/9)),this.editor.changeViewZones(f=>{this._viewZone&&f.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new TUe(r,i.lineNumber,i.column,t,g=>this._onViewZoneTop(g),g=>this._onViewZoneHeight(g),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=f.addZone(this._viewZone),this._overlayWidget=new NUe(DUe+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this._updateSashEnablement(),this.container&&this.options.showFrame){const f=this.options.frameWidth?this.options.frameWidth:d;this.container.style.borderTopWidth=f+"px",this.container.style.borderBottomWidth=f+"px"}const h=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=c+"px",this.container.style.height=h+"px",this.container.style.overflow="hidden"),this._doLayout(h,o),this.options.keepEditorSelection||this.editor.setSelection(e);const u=this.editor.getModel();if(u){const f=u.validateRange(new D(e.startLineNumber,1,e.endLineNumber+1,1));this.revealRange(f,f.startLineNumber===u.getLineCount())}}revealRange(e,t){t?this.editor.revealLineNearTop(e.endLineNumber,0):this.editor.revealRange(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e,t){const i=this._getMaximumHeightInLines(),n=t&&i!==void 0?Math.min(i,e):e;this._viewZone&&this._viewZone.heightInLines!==n&&(this.editor.changeViewZones(o=>{this._viewZone&&(this._viewZone.heightInLines=n,o.layoutZone(this._viewZone.id))}),this._updateSashEnablement())}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new Eo(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines,...this._getResizeBounds()})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){const i=(t.currentY-e.startY)/this.editor.getOption(75),n=i<0?Math.ceil(i):Math.floor(i),o=e.heightInLines+n;o>e.minLines&&o<e.maxLines&&(this._isSashResizeHeight=!0,this._relayout(o))}}))}_updateSashEnablement(){if(this._resizeSash){const{minLines:e,maxLines:t}=this._getResizeBounds();this._resizeSash.state=e===t?0:3}}_getResizeBounds(){return{minLines:5,maxLines:35}}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var Wde=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Hde=function(s,e){return function(t,i){e(t,i,s)}};const Vde=Mt("IPeekViewService");Vt(Vde,class{constructor(){this._widgets=new Map}addExclusiveWidget(s,e){const t=this._widgets.get(s);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const n=this._widgets.get(s);n&&n.widget===e&&(n.listener.dispose(),this._widgets.delete(s))};this._widgets.set(s,{widget:e,listener:e.onDidClose(i)})}},1);var Ur;(function(s){s.inPeekEditor=new Ne("inReferenceSearchEditor",!0,_(1316,"Whether the current code editor is embedded inside peek")),s.notInPeekEditor=s.inPeekEditor.toNegated()})(Ur||(Ur={}));var j1;let I2=(j1=class{constructor(e,t){e instanceof Sf&&Ur.inPeekEditor.bindTo(t)}dispose(){}},j1.ID="editor.contrib.referenceController",j1);I2=Wde([Hde(1,ut)],I2);Qt(I2.ID,I2,0);const MUe={headerBackgroundColor:re.white,primaryHeadingColor:re.fromHex("#333333"),secondaryHeadingColor:re.fromHex("#6c6c6cb3")};let E2=class extends RUe{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new q,this.onDidClose=this._onDidClose.event,OO(this.options,MUe,!1);const n=bn(this.editor);n.openedPeekWidgets.set(n.openedPeekWidgets.get()+1,void 0)}dispose(){if(!this.disposed){this.disposed=!0,super.dispose(),this._onDidClose.fire(this);const e=bn(this.editor);e.openedPeekWidgets.set(e.openedPeekWidgets.get()-1,void 0)}}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=we(".head"),this._bodyElement=we(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=we(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),Jn(this._titleElement,"click",o=>this._onTitleClick(o))),me(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=we("span.filename"),this._secondaryHeading=we("span.dirname"),this._metaHeading=we("span.meta"),me(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=we(".peekview-actions");me(this._headElement,i);const n=this._getActionBarOptions();this._actionbarWidget=new Fr(i,n),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(this._disposables.add(new Ga("peekview.close",_(1317,"Close"),it.asClassName(ge.close),!0,()=>(this.dispose(),Promise.resolve()))),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:vq.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:io(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,ta(this._metaHeading)):hr(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(75)*1.2),n=Math.round(e-(i+1));this._doLayoutHead(i,t),this._doLayoutBody(n,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};E2=Wde([Hde(2,$e)],E2);const AUe=F("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:re.black,hcLight:re.white},_(1318,"Background color of the peek view title area.")),zde=F("peekViewTitleLabel.foreground",{dark:re.white,light:re.black,hcDark:re.white,hcLight:Ph},_(1319,"Color of the peek view title.")),Ude=F("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},_(1320,"Color of the peek view title info.")),PUe=F("peekView.border",{dark:Lh,light:Lh,hcDark:Yt,hcLight:Yt},_(1321,"Color of the peek view borders and arrow.")),OUe=F("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:re.black,hcLight:re.white},_(1322,"Background color of the peek view result list."));F("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:re.white,hcLight:Ph},_(1323,"Foreground color for line nodes in the peek view result list."));F("peekViewResult.fileForeground",{dark:re.white,light:"#1E1E1E",hcDark:re.white,hcLight:Ph},_(1324,"Foreground color for file nodes in the peek view result list."));F("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},_(1325,"Background color of the selected entry in the peek view result list."));F("peekViewResult.selectionForeground",{dark:re.white,light:"#6C6C6C",hcDark:re.white,hcLight:Ph},_(1326,"Foreground color of the selected entry in the peek view result list."));const zq=F("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:re.black,hcLight:re.white},_(1327,"Background color of the peek view editor."));F("peekViewEditorGutter.background",zq,_(1328,"Background color of the gutter in the peek view editor."));F("peekViewEditorStickyScroll.background",zq,_(1329,"Background color of sticky scroll in the peek view editor."));F("peekViewEditorStickyScrollGutter.background",zq,_(1330,"Background color of the gutter part of sticky scroll in the peek view editor."));F("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},_(1331,"Match highlight color in the peek view result list."));F("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},_(1332,"Match highlight color in the peek view editor."));F("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:fn,hcLight:fn},_(1333,"Match highlight border in the peek view editor."));class FUe{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:K.None}}renderElement(e,t,i,n){var l;if((l=i.disposable)==null||l.dispose(),!i.data)return;const o=this.modelProvider();if(o.isResolved(e))return this.renderer.renderElement(o.get(e),e,i.data,n);const r=new hn,a=o.resolve(e,r.token);i.disposable={dispose:()=>r.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(c=>this.renderer.renderElement(c,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class BUe{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function WUe(s,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new BUe(s,e.accessibilityProvider)}}class HUe{constructor(e,t,i,n,o={}){this.modelDisposables=new oe;const r=()=>this.model,a=n.map(l=>new FUe(l,r));this.list=new nl(e,t,i,a,WUe(r,o))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Se.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return Se.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return Se.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this.modelDisposables.clear(),this._model=e,this.list.splice(0,this.list.length,cr(e.length)),this.modelDisposables.add(e.onDidIncrementLength(t=>this.list.splice(this.list.length,0,cr(this.list.length,t))))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose(),this.modelDisposables.dispose()}}const VUe={separatorBorder:re.transparent};class $de{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){var i,n;if(e!==this.visible){e?(this.size=dr(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{(n=(i=this.view).setVisible)==null||n.call(i,e)}catch(o){console.error("Splitview: Failed to set visible view"),console.error(o)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}}class zUe extends $de{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class UUe extends $de{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var lu;(function(s){s[s.Idle=0]="Idle",s[s.Busy=1]="Busy"})(lu||(lu={}));var k2;(function(s){s.Distribute={type:"distribute"};function e(n){return{type:"split",index:n}}s.Split=e;function t(n){return{type:"auto",index:n}}s.Auto=t;function i(n){return{type:"invisible",cachedVisibleSize:n}}s.Invisible=i})(k2||(k2={}));class qde extends K{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=lu.Idle,this._onDidSashChange=this._register(new q),this._onDidSashReset=this._register(new q),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=me(this.el,we(".sash-container")),this.viewContainer=we(".split-view-container"),this.scrollable=this._register(new u0({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>Vr(je(this.el),n)})),this.scrollableElement=this._register(new QO(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));const i=this._register(new Si(this.viewContainer,"scroll")).event;this._register(i(n=>{const o=this.scrollableElement.getScrollPosition(),r=Math.abs(this.viewContainer.scrollLeft-o.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-o.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(r!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:r,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),me(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||VUe),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,o)=>{const r=Mo(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,r,o,!0)}),this._contentSize=this.viewItems.reduce((n,o)=>n+o.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let o=0;o<this.viewItems.length;o++){const r=this.viewItems[o],a=this.proportions[o];typeof a=="number"?n+=a:e-=r.size}for(let o=0;o<this.viewItems.length;o++){const r=this.viewItems[o],a=this.proportions[o];typeof a=="number"&&n>0&&(r.size=dr(Math.round(a*e/n),r.minimumSize,r.maximumSize))}}else{const n=cr(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,o,r)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const n=this.sashItems.findIndex(a=>a.sash===e),o=dc(ee(this.el.ownerDocument.body,"keydown",a=>r(this.sashDragState.current,a.altKey)),ee(this.el.ownerDocument.body,"keyup",()=>r(this.sashDragState.current,!1))),r=(a,l)=>{const c=this.viewItems.map(g=>g.size);let d=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){const m=this.viewItems[n];d=(m.minimumSize-m.size)/2,h=(m.maximumSize-m.size)/2}else{const m=this.viewItems[n+1];d=(m.size-m.maximumSize)/2,h=(m.size-m.minimumSize)/2}let u,f;if(!l){const g=cr(n,-1),m=cr(n+1,this.viewItems.length),p=g.reduce((L,E)=>L+(this.viewItems[E].minimumSize-c[E]),0),v=g.reduce((L,E)=>L+(this.viewItems[E].viewMaximumSize-c[E]),0),b=m.length===0?Number.POSITIVE_INFINITY:m.reduce((L,E)=>L+(c[E]-this.viewItems[E].minimumSize),0),w=m.length===0?Number.NEGATIVE_INFINITY:m.reduce((L,E)=>L+(c[E]-this.viewItems[E].viewMaximumSize),0),C=Math.max(p,w),y=Math.min(b,v),x=this.findFirstSnapIndex(g),S=this.findFirstSnapIndex(m);if(typeof x=="number"){const L=this.viewItems[x],E=Math.floor(L.viewMinimumSize/2);u={index:x,limitDelta:L.visible?C-E:C+E,size:L.size}}if(typeof S=="number"){const L=this.viewItems[S],E=Math.floor(L.viewMinimumSize/2);f={index:S,limitDelta:L.visible?y+E:y-E,size:L.size}}}this.sashDragState={start:a,current:a,index:n,sizes:c,minDelta:d,maxDelta:h,alt:l,snapBefore:u,snapAfter:f,disposable:o}};r(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:o,minDelta:r,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const d=e-i,h=this.resize(t,d,n,void 0,void 0,r,a,l,c);if(o){const u=t===this.sashItems.length-1,f=this.viewItems.map(w=>w.size),g=u?t:t+1,m=this.viewItems[g],p=m.size-m.maximumSize,v=m.size-m.minimumSize,b=u?t-1:t+1;this.resize(b,-h,f,void 0,void 0,p,v)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=dr(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==lu.Idle)throw new Error("Cant modify splitview");this.state=lu.Busy;try{const i=cr(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],o=i.filter(a=>this.viewItems[a].priority===2),r=this.viewItems[e];t=Math.round(t),t=dr(t,r.minimumSize,Math.min(r.maximumSize,this.size)),r.size=t,this.relayout(n,o)}finally{this.state=lu.Idle}}}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=dr(i,a.minimumSize,a.maximumSize);const n=cr(this.viewItems.length),o=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);this.relayout(o,r)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==lu.Idle)throw new Error("Cant modify splitview");this.state=lu.Busy;try{const o=we(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));const r=e.onDidChange(u=>this.onViewChange(d,u)),a=Ve(()=>o.remove()),l=dc(r,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const d=this.orientation===0?new zUe(o,e,c,l):new UUe(o,e,c,l);if(this.viewItems.splice(i,0,d),this.viewItems.length>1){const u={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},f=this.orientation===0?new Eo(this.sashContainer,{getHorizontalSashTop:L=>this.getSashPosition(L),getHorizontalSashWidth:this.getSashOrthogonalSize},{...u,orientation:1}):new Eo(this.sashContainer,{getVerticalSashLeft:L=>this.getSashPosition(L),getVerticalSashHeight:this.getSashOrthogonalSize},{...u,orientation:0}),g=this.orientation===0?L=>({sash:f,start:L.startY,current:L.currentY,alt:L.altKey}):L=>({sash:f,start:L.startX,current:L.currentX,alt:L.altKey}),p=Se.map(f.onDidStart,g)(this.onSashStart,this),b=Se.map(f.onDidChange,g)(this.onSashChange,this),C=Se.map(f.onDidEnd,()=>this.sashItems.findIndex(L=>L.sash===f))(this.onSashEnd,this),y=f.onDidReset(()=>{const L=this.sashItems.findIndex(A=>A.sash===f),E=cr(L,-1),M=cr(L+1,this.viewItems.length),R=this.findFirstSnapIndex(E),T=this.findFirstSnapIndex(M);typeof R=="number"&&!this.viewItems[R].visible||typeof T=="number"&&!this.viewItems[T].visible||this._onDidSashReset.fire(L)}),x=dc(p,b,C,y,f),S={sash:f,disposable:x};this.sashItems.splice(i-1,0,S)}o.appendChild(e.element);let h;typeof t!="number"&&t.type==="split"&&(h=[t.index]),n||this.relayout([i],h),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=lu.Idle}}relayout(e,t){const i=this.viewItems.reduce((n,o)=>n+o.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(d=>d.size),n,o,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const d=cr(e,-1),h=cr(e+1,this.viewItems.length);if(o)for(const S of o)T5(d,S),T5(h,S);if(n)for(const S of n)oD(d,S),oD(h,S);const u=d.map(S=>this.viewItems[S]),f=d.map(S=>i[S]),g=h.map(S=>this.viewItems[S]),m=h.map(S=>i[S]),p=d.reduce((S,L)=>S+(this.viewItems[L].minimumSize-i[L]),0),v=d.reduce((S,L)=>S+(this.viewItems[L].maximumSize-i[L]),0),b=h.length===0?Number.POSITIVE_INFINITY:h.reduce((S,L)=>S+(i[L]-this.viewItems[L].minimumSize),0),w=h.length===0?Number.NEGATIVE_INFINITY:h.reduce((S,L)=>S+(i[L]-this.viewItems[L].maximumSize),0),C=Math.max(p,w,r),y=Math.min(b,v,a);let x=!1;if(l){const S=this.viewItems[l.index],L=t>=l.limitDelta;x=L!==S.visible,S.setVisible(L,l.size)}if(!x&&c){const S=this.viewItems[c.index],L=t<c.limitDelta;x=L!==S.visible,S.setVisible(L,c.size)}if(x)return this.resize(e,t,i,n,o,r,a);t=dr(t,C,y);for(let S=0,L=t;S<u.length;S++){const E=u[S],M=dr(f[S]+L,E.minimumSize,E.maximumSize),R=M-f[S];L-=R,E.size=M}for(let S=0,L=t;S<g.length;S++){const E=g[S],M=dr(m[S]-L,E.minimumSize,E.maximumSize),R=M-m[S];L+=R,E.size=M}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const n=cr(this.viewItems.length-1,-1),o=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);for(const a of r)T5(n,a);for(const a of o)oD(n,a);typeof e=="number"&&oD(n,e);for(let a=0;i!==0&&a<n.length;a++){const l=this.viewItems[n[a]],c=dr(l.size+i,l.minimumSize,l.maximumSize),d=c-l.size;i-=d,l.size=c}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;const o=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const r=n.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],d=this.viewItems[l];a+=d.size;const h=!(t[l]&&r[l+1]),u=!(i[l]&&o[l+1]);if(h&&u){const f=cr(l,-1),g=cr(l+1,this.viewItems.length),m=this.findFirstSnapIndex(f),p=this.findFirstSnapIndex(g),v=typeof m=="number"&&!this.viewItems[m].visible,b=typeof p=="number"&&!this.viewItems[p].visible;v&&o[l]&&(a>0||this.startSnappingEnabled)?c.state=1:b&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else h&&!u?c.state=1:!h&&u?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){var e;(e=this.sashDragState)==null||e.disposable.dispose(),yi(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}}const UA=class UA{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=UA.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map(o=>[o.templateId,o]));this.renderers=[];for(const o of e){const r=n.get(o.templateId);if(!r)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(r)}}renderTemplate(e){const t=me(e,we(".monaco-table-tr")),i=[],n=[];for(let r=0;r<this.columns.length;r++){const a=this.renderers[r],l=me(t,we(".monaco-table-td",{"data-col-index":r}));l.style.width=`${this.getColumnSize(r)}px`,i.push(l),n.push(a.renderTemplate(l))}const o={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(o),o}renderElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){const a=this.columns[o].project(e);this.renderers[o].renderElement(a,t,i.cellTemplateData[o],n)}}disposeElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){const r=this.renderers[o];if(r.disposeElement){const l=this.columns[o].project(e);r.disposeElement(l,t,i.cellTemplateData[o],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);io(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}};UA.TemplateId="row";let D2=UA;function $Ue(s){return{getHeight(e){return s.getHeight(e)},getTemplateId(){return D2.TemplateId}}}class qUe extends K{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??Se.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new q,this.onDidLayout=this._onDidLayout.event,this.element=we(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register(yc().setupManagedHover(Fh("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}const $A=class $A{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,n,o,r){this.virtualDelegate=i,this.columns=n,this.domId=`table_id_${++$A.InstanceCount}`,this.disposables=new oe,this.cachedWidth=0,this.cachedHeight=0,this.domNode=me(t,we(`.monaco-table.${this.domId}`));const a=n.map((d,h)=>this.disposables.add(new qUe(d,h))),l={size:a.reduce((d,h)=>d+h.column.weight,0),views:a.map(d=>({size:d.column.weight,view:d}))};this.splitview=this.disposables.add(new qde(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new D2(n,o,d=>this.splitview.getViewSize(d));this.list=this.disposables.add(new nl(e,this.domNode,$Ue(i),[c],r)),Se.any(...a.map(d=>d.onDidLayout))(([d,h])=>c.layoutColumn(d,h),null,this.disposables),this.splitview.onDidSashReset(d=>{const h=n.reduce((f,g)=>f+g.weight,0),u=n[d].weight/h*this.cachedWidth;this.splitview.resizeView(d,u)},null,this.disposables),this.styleElement=Hl(this.domNode),this.style(JWe)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}};$A.InstanceCount=0;let RW=$A;var Fa;(function(s){s[s.Expanded=0]="Expanded",s[s.Collapsed=1]="Collapsed",s[s.PreserveOrExpanded=2]="PreserveOrExpanded",s[s.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(Fa||(Fa={}));var t_;(function(s){s[s.Unknown=0]="Unknown",s[s.Twistie=1]="Twistie",s[s.Element=2]="Element",s[s.Filter=3]="Filter"})(t_||(t_={}));class za extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class Uq{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}class qf{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class QQ{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function jUe(s,e,t){return new nh(new QQ(s),new QQ(e)).ComputeDiff(t).changes}class Zv{static Assert(e,t){if(!e)throw new Error(t)}}class Qv{static Copy(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}static Copy2(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}}class JQ{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new qf(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class nh{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,o,r]=nh._getElements(e),[a,l,c]=nh._getElements(t);this._hasStrings=r&&c,this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(nh._isStringArray(t)){const i=new Int32Array(t.length);for(let n=0,o=t.length;n<o;n++)i[n]=IU(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=nh._getStrictElement(this._originalSequence,e),n=nh._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,o){const r=[!1];let a=this.ComputeDiffRecursive(e,t,i,n,r);return o&&(a=this.PrettifyChanges(a)),{quitEarly:r[0],changes:a}}ComputeDiffRecursive(e,t,i,n,o){for(o[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let h;return i<=n?(Zv.Assert(e===t+1,"originalStart should only be one more than originalEnd"),h=[new qf(e,0,i,n-i+1)]):e<=t?(Zv.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),h=[new qf(e,t-e+1,i,0)]):(Zv.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Zv.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),h=[]),h}const r=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,r,a,o),c=r[0],d=a[0];if(l!==null)return l;if(!o[0]){const h=this.ComputeDiffRecursive(e,c,i,d,o);let u=[];return o[0]?u=[new qf(c+1,t-(c+1)+1,d+1,n-(d+1)+1)]:u=this.ComputeDiffRecursive(c+1,t,d+1,n,o),this.ConcatenateChanges(h,u)}return[new qf(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,o,r,a,l,c,d,h,u,f,g,m,p,v,b){let w=null,C=null,y=new JQ,x=t,S=i,L=f[0]-p[0]-n,E=-1073741824,M=this.m_forwardHistory.length-1;do{const R=L+e;R===x||R<S&&c[R-1]<c[R+1]?(h=c[R+1],g=h-L-n,h<E&&y.MarkNextChange(),E=h,y.AddModifiedElement(h+1,g),L=R+1-e):(h=c[R-1]+1,g=h-L-n,h<E&&y.MarkNextChange(),E=h-1,y.AddOriginalElement(h,g+1),L=R-1-e),M>=0&&(c=this.m_forwardHistory[M],e=c[0],x=1,S=c.length-1)}while(--M>=-1);if(w=y.getReverseChanges(),b[0]){let R=f[0]+1,T=p[0]+1;if(w!==null&&w.length>0){const A=w[w.length-1];R=Math.max(R,A.getOriginalEnd()),T=Math.max(T,A.getModifiedEnd())}C=[new qf(R,u-R+1,T,m-T+1)]}else{y=new JQ,x=r,S=a,L=f[0]-p[0]-l,E=1073741824,M=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const R=L+o;R===x||R<S&&d[R-1]>=d[R+1]?(h=d[R+1]-1,g=h-L-l,h>E&&y.MarkNextChange(),E=h+1,y.AddOriginalElement(h+1,g+1),L=R+1-o):(h=d[R-1],g=h-L-l,h>E&&y.MarkNextChange(),E=h,y.AddModifiedElement(h+1,g+1),L=R-1-o),M>=0&&(d=this.m_reverseHistory[M],o=d[0],x=1,S=d.length-1)}while(--M>=-1);C=y.getChanges()}return this.ConcatenateChanges(w,C)}ComputeRecursionPoint(e,t,i,n,o,r,a){let l=0,c=0,d=0,h=0,u=0,f=0;e--,i--,o[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const g=t-e+(n-i),m=g+1,p=new Int32Array(m),v=new Int32Array(m),b=n-i,w=t-e,C=e-i,y=t-n,S=(w-b)%2===0;p[b]=e,v[w]=t,a[0]=!1;for(let L=1;L<=g/2+1;L++){let E=0,M=0;d=this.ClipDiagonalBound(b-L,L,b,m),h=this.ClipDiagonalBound(b+L,L,b,m);for(let T=d;T<=h;T+=2){T===d||T<h&&p[T-1]<p[T+1]?l=p[T+1]:l=p[T-1]+1,c=l-(T-b)-C;const A=l;for(;l<t&&c<n&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(p[T]=l,l+c>E+M&&(E=l,M=c),!S&&Math.abs(T-w)<=L-1&&l>=v[T])return o[0]=l,r[0]=c,A<=v[T]&&L<=1448?this.WALKTRACE(b,d,h,C,w,u,f,y,p,v,l,t,o,c,n,r,S,a):null}const R=(E-e+(M-i)-L)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(E,R))return a[0]=!0,o[0]=E,r[0]=M,R>0&&L<=1448?this.WALKTRACE(b,d,h,C,w,u,f,y,p,v,l,t,o,c,n,r,S,a):(e++,i++,[new qf(e,t-e+1,i,n-i+1)]);u=this.ClipDiagonalBound(w-L,L,w,m),f=this.ClipDiagonalBound(w+L,L,w,m);for(let T=u;T<=f;T+=2){T===u||T<f&&v[T-1]>=v[T+1]?l=v[T+1]-1:l=v[T-1],c=l-(T-w)-y;const A=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(v[T]=l,S&&Math.abs(T-b)<=L&&l<=p[T])return o[0]=l,r[0]=c,A>=p[T]&&L<=1448?this.WALKTRACE(b,d,h,C,w,u,f,y,p,v,l,t,o,c,n,r,S,a):null}if(L<=1447){let T=new Int32Array(h-d+2);T[0]=b-d+1,Qv.Copy2(p,d,T,1,h-d+1),this.m_forwardHistory.push(T),T=new Int32Array(f-u+2),T[0]=w-u+1,Qv.Copy2(v,u,T,1,f-u+1),this.m_reverseHistory.push(T)}}return this.WALKTRACE(b,d,h,C,w,u,f,y,p,v,l,t,o,c,n,r,S,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,o=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,r=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<o&&(!r||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,o=0;if(t>0){const h=e[t-1];n=h.originalStart+h.originalLength,o=h.modifiedStart+h.modifiedLength}const r=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let h=1;;h++){const u=i.originalStart-h,f=i.modifiedStart-h;if(u<n||f<o||r&&!this.OriginalElementsAreEqual(u,u+i.originalLength)||a&&!this.ModifiedElementsAreEqual(f,f+i.modifiedLength))break;const m=(u===n&&f===o?5:0)+this._boundaryScore(u,i.originalLength,f,i.modifiedLength);m>c&&(c=m,l=h)}i.originalStart-=l,i.modifiedStart-=l;const d=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],d)){e[t-1]=d[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const n=e[t-1],o=e[t],r=o.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=o.originalStart+o.originalLength,c=l-a,d=n.modifiedStart,h=o.modifiedStart+o.modifiedLength,u=h-d;if(r<5&&c<20&&u<20){const f=this._findBetterContiguousSequence(a,c,d,u,r);if(f){const[g,m]=f;(g!==n.originalStart+n.originalLength||m!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=g-n.originalStart,n.modifiedLength=m-n.modifiedStart,o.originalStart=g+r,o.modifiedStart=m+r,o.originalLength=l-o.originalStart,o.modifiedLength=h-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,o){if(t<o||n<o)return null;const r=e+t-o+1,a=i+n-o+1;let l=0,c=0,d=0;for(let h=e;h<r;h++)for(let u=i;u<a;u++){const f=this._contiguousSequenceScore(h,u,o);f>0&&f>l&&(l=f,c=h,d=u)}return l>0?[c,d]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(e+o,t+o))return 0;n+=this._originalStringElements[e+o].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){const o=this._OriginalRegionIsBoundary(e,t)?1:0,r=this._ModifiedRegionIsBoundary(i,n)?1:0;return o+r}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return Qv.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],Qv.Copy(t,1,n,e.length,t.length-1),n}else{const n=new Array(e.length+t.length);return Qv.Copy(e,0,n,0,e.length),Qv.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(Zv.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Zv.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let o=e.originalLength;const r=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(o=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new qf(n,o,r,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const o=i,r=n-i-1,a=t%2===0;if(e<0){const l=o%2===0;return a===l?0:1}else{const l=r%2===0;return a===l?n-1:n-2}}}function Ok(s){return!!s&&s.visibility!==void 0}function ev(s){switch(s){case!0:return 1;case!1:return 0;default:return s}}function GF(s){return"collapsible"in s}class KUe{constructor(e,t,i={}){this.user=e,this.rootRef=[],this.eventBufferer=new ak,this._onDidSpliceModel=new q,this.onDidSpliceModel=this._onDidSpliceModel.event,this._onDidSpliceRenderedNodes=new q,this.onDidSpliceRenderedNodes=this._onDidSpliceRenderedNodes.event,this._onDidChangeCollapseState=new q,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new q,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this.refilterDelayer=new Pl(Rse),this.collapseByDefault=typeof i.collapseByDefault>"u"?!1:i.collapseByDefault,this.allowNonCollapsibleParents=i.allowNonCollapsibleParents??!1,this.filter=i.filter,this.autoExpandSingleChildren=typeof i.autoExpandSingleChildren>"u"?!1:i.autoExpandSingleChildren,this.root={parent:void 0,element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=Gt.empty(),n={}){if(e.length===0)throw new za(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=Gt.empty(),o,r=o.diffDepth??0){const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,o);const l=[...n],c=t[t.length-1],d=new nh({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+i)].map(m=>e.getId(m.element).toString())}).ComputeDiff(!1);if(d.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,o);const h=t.slice(0,-1),u=(m,p,v)=>{if(r>0)for(let b=0;b<v;b++)m--,p--,this.spliceSmart(e,[...h,m,0],Number.MAX_SAFE_INTEGER,l[p].children,o,r-1)};let f=Math.min(a.children.length,c+i),g=l.length;for(const m of d.changes.sort((p,v)=>v.originalStart-p.originalStart))u(f,g,f-(m.originalStart+m.originalLength)),f=m.originalStart,g=m.modifiedStart-c,this.spliceSimple([...h,f],m.originalLength,Gt.slice(l,g,g+m.modifiedLength),o);u(f,g,f)}spliceSimple(e,t,i=Gt.empty(),{onDidCreateNode:n,onDidDeleteNode:o,diffIdentityProvider:r}){const{parentNode:a,listIndex:l,revealed:c,visible:d}=this.getParentNodeWithListIndex(e),h=[],u=Gt.map(i,y=>this.createTreeNode(y,a,a.visible?1:0,c,h,n)),f=e[e.length-1];let g=0;for(let y=f;y>=0&&y<a.children.length;y--){const x=a.children[y];if(x.visible){g=x.visibleChildIndex;break}}const m=[];let p=0,v=0;for(const y of u)m.push(y),v+=y.renderNodeCount,y.visible&&(y.visibleChildIndex=g+p++);const b=GN(a.children,f,t,m);r?a.lastDiffIds?GN(a.lastDiffIds,f,t,m.map(y=>r.getId(y.element).toString())):a.lastDiffIds=a.children.map(y=>r.getId(y.element).toString()):a.lastDiffIds=void 0;let w=0;for(const y of b)y.visible&&w++;if(w!==0)for(let y=f+m.length;y<a.children.length;y++){const x=a.children[y];x.visible&&(x.visibleChildIndex-=w)}if(a.visibleChildrenCount+=p-w,b.length>0&&o){const y=x=>{o(x),x.children.forEach(y)};b.forEach(y)}if(c&&d){const y=b.reduce((x,S)=>x+(S.visible?S.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,v-y),this._onDidSpliceRenderedNodes.fire({start:l,deleteCount:y,elements:h})}this._onDidSpliceModel.fire({insertedNodes:m,deletedNodes:b});let C=a;for(;C;){if(C.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}C=C.parent}}rerender(e){if(e.length===0)throw new za(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this._onDidSpliceRenderedNodes.fire({start:i,deleteCount:1,elements:[t]})}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);const o={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,o))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:o}=this.getTreeNodeWithListIndex(e),r=this._setListNodeCollapseState(i,n,o,t);if(i!==this.root&&this.autoExpandSingleChildren&&r&&!GF(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return r}_setListNodeCollapseState(e,t,i,n){const o=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!o)return o;const r=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=r-(t===-1?0:1);return this._onDidSpliceRenderedNodes.fire({start:t+1,deleteCount:l,elements:a.slice(1)}),o}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(GF(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!GF(t)&&t.recursive)for(const o of e.children)n=this._setNodeCollapseState(o,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this._onDidSpliceRenderedNodes.fire({start:0,deleteCount:e,elements:t}),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,o,r){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&o.push(a);const c=e.children||Gt.empty(),d=n&&l!==0&&!a.collapsed;let h=0,u=1;for(const f of c){const g=this.createTreeNode(f,a,l,d,o,r);a.children.push(g),u+=g.renderNodeCount,g.visible&&(g.visibleChildIndex=h++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=h,a.visible=l===2?h>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=u):(a.renderNodeCount=0,n&&o.pop()),r==null||r(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let o;if(e!==this.root){if(o=this._filterNode(e,t),o===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const r=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||o!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,o,i,n&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=o===2?a:o===1,e.visibility=o),e.visible?e.collapsed||(e.renderNodeCount+=i.length-r):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):Ok(i)?(e.filterData=i.data,ev(i.visibility)):(e.filterData=void 0,ev(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new za(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:o}=this.getParentNodeWithListIndex(e),r=e[e.length-1];if(r<0||r>t.children.length)throw new za(this.user,"Invalid tree location");const a=t.children[r];return{node:a,listIndex:i,revealed:n,visible:o&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,o=!0){const[r,...a]=e;if(r<0||r>t.children.length)throw new za(this.user,"Invalid tree location");for(let l=0;l<r;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,o=o&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:o}:this.getParentNodeWithListIndex(a,t.children[r],i+1,n,o)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:JDe(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class GUe extends Ek{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function YF(s){return s instanceof Ek?new GUe(s):s}class YUe{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=K.None,this.disposables=new oe}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,YF(e),t)}onDragOver(e,t,i,n,o,r=!0){const a=this.dnd.onDragOver(YF(e),t&&t.element,i,n,o),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=cf(()=>{const f=this.modelProvider(),g=f.getNodeLocation(t);f.isCollapsed(g)&&f.setCollapsed(g,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!r){const f=typeof a=="boolean"?a:a.accept,g=typeof a=="boolean"?void 0:a.effect;return{accept:f,effect:g,feedback:[i]}}return a}if(a.bubble===1){const f=this.modelProvider(),g=f.getNodeLocation(t),m=f.getParentNodeLocation(g),p=f.getNode(m),v=m&&f.getListIndex(m);return this.onDragOver(e,p,v,n,o,!1)}const c=this.modelProvider(),d=c.getNodeLocation(t),h=c.getListIndex(d),u=c.getListRenderCount(d);return{...a,feedback:cr(h,h+u)}}drop(e,t,i,n,o){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(YF(e),t&&t.element,i,n,o)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function XUe(s,e,t){return t&&{...t,identityProvider:t.identityProvider&&{getId(i){return t.identityProvider.getId(i.element)}},dnd:t.dnd&&e.add(new YUe(s,t.dnd)),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent(i){return t.multipleSelectionController.isSelectionSingleChangeEvent({...i,element:i.element})},isSelectionRangeChangeEvent(i){return t.multipleSelectionController.isSelectionRangeChangeEvent({...i,element:i.element})}},accessibilityProvider:t.accessibilityProvider&&{...t.accessibilityProvider,getSetSize(i){const n=s(),o=n.getNodeLocation(i),r=n.getParentNodeLocation(o);return n.getNode(r).visibleChildrenCount},getPosInSet(i){return i.visibleChildIndex+1},isChecked:t.accessibilityProvider&&t.accessibilityProvider.isChecked?i=>t.accessibilityProvider.isChecked(i.element):void 0,getRole:t.accessibilityProvider&&t.accessibilityProvider.getRole?i=>t.accessibilityProvider.getRole(i.element):()=>"treeitem",getAriaLabel(i){return t.accessibilityProvider.getAriaLabel(i.element)},getWidgetAriaLabel(){return t.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:t.accessibilityProvider&&t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider&&t.accessibilityProvider.getAriaLevel?i=>t.accessibilityProvider.getAriaLevel(i.element):i=>i.depth,getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(i=>t.accessibilityProvider.getActiveDescendantId(i.element))},keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(i){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(i.element)}}}}class $q{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,n;(n=(i=this.delegate).setDynamicHeight)==null||n.call(i,e.element,t)}}var tv;(function(s){s.None="none",s.OnHover="onHover",s.Always="always"})(tv||(tv={}));class ZUe{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new oe,this.onDidChange=Se.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}const s1=class s1{constructor(e,t,i,n,o,r={}){var a;this.renderer=e,this.model=t,this.activeNodes=n,this.renderedIndentGuides=o,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=s1.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=K.None,this.disposables=new oe,this.templateId=e.templateId,this.updateOptions(r),Se.map(i,l=>l.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(a=e.onDidChangeTwistieState)==null||a.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=dr(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,n]of this.renderedNodes)n.indentSize=s1.DefaultIndent+(i.depth-1)*this.indent,this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==tv.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){const i=new oe;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=me(e,we(".monaco-tl-row")),i=me(t,we(".monaco-tl-indent")),n=me(t,we(".monaco-tl-twistie")),o=me(t,we(".monaco-tl-contents")),r=this.renderer.renderTemplate(o);return{container:e,indent:i,twistie:n,indentGuidesDisposable:K.None,indentSize:0,templateData:r}}renderElement(e,t,i,n){i.indentSize=s1.DefaultIndent+(e.depth-1)*this.indent,this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,{...n,indent:i.indentSize})}disposeElement(e,t,i,n){var o,r;i.indentGuidesDisposable.dispose(),(r=(o=this.renderer).disposeElement)==null||r.call(o,e,t,i.templateData,{...n,indent:i.indentSize}),typeof(n==null?void 0:n.height)=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){t.twistie.style.paddingLeft=`${t.indentSize}px`,t.indent.style.width=`${t.indentSize+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...it.asClassNameArray(ge.treeItemExpanded));let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...it.asClassNameArray(ge.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(io(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new oe;for(;;){const n=this.model.getNodeLocation(e),o=this.model.getParentNodeLocation(n);if(!o)break;const r=this.model.getNode(o),a=we(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(r)&&a.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(r,a),i.add(Ve(()=>this.renderedIndentGuides.delete(r,a))),e=r}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set;e.forEach(i=>{const n=this.model.getNodeLocation(i);try{const o=this.model.getParentNodeLocation(n);i.collapsible&&i.children.length>0&&!i.collapsed?t.add(i):o&&t.add(this.model.getNode(o))}catch{}}),this.activeIndentNodes.forEach(i=>{t.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.remove("active"))}),t.forEach(i=>{this.activeIndentNodes.has(i)||this.renderedIndentGuides.forEach(i,n=>n.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),yi(this.disposables)}};s1.DefaultIndent=8;let MW=s1;function QUe(s,e){const t=e.toLowerCase().indexOf(s);let i;if(t>-1){i=[Number.MAX_SAFE_INTEGER,0];for(let n=s.length;n>0;n--)i.push(t+n-1)}return i}class jde{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set findMatchType(e){this._findMatchType=e}get findMatchType(){return this._findMatchType}set findMode(e){this._findMode=e}get findMode(){return this._findMode}constructor(e,t,i){this._keyboardNavigationLabelProvider=e,this._filter=t,this._defaultFindVisibility=i,this._totalCount=0,this._matchCount=0,this._findMatchType=Zc.Fuzzy,this._findMode=Ua.Highlight,this._pattern="",this._lowercasePattern="",this.disposables=new oe}filter(e,t){let i=1;if(this._filter){const r=this._filter.filter(e,t);if(typeof r=="boolean"?i=r?1:0:Ok(r)?i=ev(r.visibility):i=r,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:fc.Default,visibility:i};const n=this._keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),o=Array.isArray(n)?n:[n];for(const r of o){const a=r&&r.toString();if(typeof a>"u")return{data:fc.Default,visibility:i};let l;if(this._findMatchType===Zc.Contiguous?l=QUe(this._lowercasePattern,a.toLowerCase()):l=Ub(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0}),l)return this._matchCount++,o.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this._findMode===Ua.Filter?typeof this._defaultFindVisibility=="number"?this._defaultFindVisibility:this._defaultFindVisibility?this._defaultFindVisibility(e):2:{data:fc.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){yi(this.disposables)}}class JUe{constructor(e){this.stateMap=new Map(e.map(t=>[t.id,{...t}]))}get(e){const t=this.stateMap.get(e);if(t===void 0)throw new Error(`No state found for toggle id ${e}`);return t.isChecked}set(e,t){const i=this.stateMap.get(e);if(i===void 0)throw new Error(`No state found for toggle id ${e}`);return i.isChecked===t?!1:(i.isChecked=t,!0)}}var Ua;(function(s){s[s.Highlight=0]="Highlight",s[s.Filter=1]="Filter"})(Ua||(Ua={}));var Zc;(function(s){s[s.Fuzzy=0]="Fuzzy",s[s.Contiguous=1]="Contiguous"})(Zc||(Zc={}));var Xf;(function(s){s.Mode="mode",s.MatchType="matchType"})(Xf||(Xf={}));class e$e{get pattern(){return this._pattern}get placeholder(){return this._placeholder}set placeholder(e){var t;this._placeholder=e,(t=this.widget)==null||t.setPlaceHolder(e)}constructor(e,t,i,n={}){this.tree=e,this.filter=t,this.contextViewProvider=i,this.options=n,this._pattern="",this._onDidChangePattern=new q,this._onDidChangeOpenState=new q,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new oe,this.disposables=new oe,this.toggles=new JUe(n.toggles??[]),this._placeholder=n.placeholder??_(20,"Type to search")}isOpened(){return!!this.widget}updateToggleState(e,t){var i;this.toggles.set(e,t),(i=this.widget)==null||i.setToggleState(e,t)}renderMessage(e,t){var i,n,o;e?this.tree.options.showNotFoundMessage??!0?(i=this.widget)==null||i.showMessage({type:2,content:t??_(21,"No results found.")}):(n=this.widget)==null||n.showMessage({type:2}):(o=this.widget)==null||o.clearMessage()}alertResults(e){br(e?_(23,"{0} results",e):_(22,"No results"))}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}}let Kde=class extends e$e{get mode(){return this.toggles.get(Xf.Mode)?Ua.Filter:Ua.Highlight}set mode(e){if(e===this.mode)return;const t=e===Ua.Filter;this.updateToggleState(Xf.Mode,t),this.placeholder=t?_(24,"Type to filter"):_(25,"Type to search"),this.filter.findMode=e,this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e)}get matchType(){return this.toggles.get(Xf.MatchType)?Zc.Fuzzy:Zc.Contiguous}set matchType(e){e!==this.matchType&&(this.updateToggleState(Xf.MatchType,e===Zc.Fuzzy),this.filter.findMatchType=e,this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,n={}){const o=n.defaultFindMode??Ua.Highlight,r=n.defaultFindMatchType??Zc.Fuzzy,a=[{id:Xf.Mode,icon:ge.listFilter,title:_(26,"Filter"),isChecked:o===Ua.Filter},{id:Xf.MatchType,icon:ge.searchFuzzy,title:_(27,"Fuzzy Match"),isChecked:r===Zc.Fuzzy}];t.findMatchType=r,t.findMode=o,super(e,t,i,{...n,toggles:a}),this.filter=t,this._onDidChangeMode=new q,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new q,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this.disposables.add(this.tree.onDidChangeModel(()=>{this.isOpened()&&(this.pattern.length!==0&&this.tree.refilter(),this.render())})),this.disposables.add(this.tree.onWillRefilter(()=>this.filter.reset()))}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}shouldAllowFocus(e){return!this.isOpened()||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!fc.isDefault(e.filterData)}render(){const t=this.filter.matchCount===0&&this.filter.totalCount>0&&this.pattern.length>0;this.renderMessage(t),this.pattern.length&&this.alertResults(this.filter.matchCount)}};function t$e(s,e){return s.position===e.position&&Gde(s,e)}function Gde(s,e){return s.node.element===e.node.element&&s.startIndex===e.startIndex&&s.height===e.height&&s.endIndex===e.endIndex}class i$e{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return dn(this.stickyNodes,e.stickyNodes,t$e)}contains(e){return this.stickyNodes.some(t=>t.node.element===e.element)}lastNodePartiallyVisible(){if(this.count===0)return!1;const e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!dn(this.stickyNodes,e.stickyNodes,Gde)||this.count===0)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class n$e{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){const o=e[n];if(o.position+o.height>i||n>=t)return e.slice(0,n)}return e}}let eJ=class extends K{constructor(e,t,i,n,o,r={}){super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=o,this.maxWidgetViewRatio=.4;const a=this.validateStickySettings(r);this.stickyScrollMaxItemCount=a.stickyScrollMaxItemCount,this.stickyScrollDelegate=r.stickyScrollDelegate??new n$e,this.paddingTop=r.paddingTop??0,this._widget=this._register(new s$e(i.getScrollableElement(),i,e,n,o,r.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this._register(t.onDidSpliceRenderedNodes(l=>{const c=this._widget.state;if(!c)return;if(l.deleteCount>0&&c.stickyNodes.some(u=>!this.model.has(this.model.getNodeLocation(u.node)))){this.update();return}c.stickyNodes.some(u=>{const f=this.model.getListIndex(this.model.getNodeLocation(u.node));return f>=l.start&&f<l.start+l.deleteCount&&c.contains(u.node)})&&this._widget.rerender()})),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(e===0?t=this.view.firstVisibleIndex:t=this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(this.paddingTop);if(!e||this.tree.scrollTop<=this.paddingTop){this._widget.setState(void 0);return}const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,n=0,o=this.getNextStickyNode(i,void 0,n);for(;o&&(t.push(o),n+=o.height,!(t.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(o),!i)));)o=this.getNextStickyNode(i,o.node,n);const r=this.constrainStickyNodes(t);return r.length?new i$e(r):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const n=this.getAncestorUnderPrevious(e,t);if(n&&!(n===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,i))))return this.createStickyScrollNode(n,i)}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),n=this.view.getElementTop(i),o=t;return this.view.scrollTop===n-o}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:n,endIndex:o}=this.getNodeRange(e),r=this.calculateStickyNodePosition(o,t,i);return{node:e,position:r,height:i,startIndex:n,endIndex:o}}getAncestorUnderPrevious(e,t=void 0){let i=e,n=this.getParentNode(i);for(;n;){if(n===t)return i;i=n,n=this.getParentNode(i)}if(t===void 0)return i}calculateStickyNodePosition(e,t,i){let n=this.view.getRelativeTop(e);if(n===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const c=this.treeDelegate.getHeight(this.view.element(e)),d=this.view.getRelativeTop(e+1);n=d?d-c/this.view.renderHeight:null}if(n===null)return t;const o=this.view.element(e),r=this.treeDelegate.getHeight(o),l=n*this.view.renderHeight+r;return t+i>l&&t<=l?l-i:t}constrainStickyNodes(e){if(e.length===0)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const n=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!n.length)return[];const o=n[n.length-1];if(n.length>this.stickyScrollMaxItemCount||o.position+o.height>t)throw new Error("stickyScrollDelegate violates constraints");return n}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");const n=this.model.getListRenderCount(t),o=i+n-1;return{startIndex:i,endIndex:o}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let n=0;for(let o=0;o<t.length&&o<this.stickyScrollMaxItemCount;o++)n+=this.treeDelegate.getHeight(t[o]);return n}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(e.paddingTop!==void 0&&(this.paddingTop=e.paddingTop),e.stickyScrollMaxItemCount!==void 0){const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}}validateStickySettings(e){let t=7;return typeof e.stickyScrollMaxItemCount=="number"&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}},s$e=class{get state(){return this._previousState}constructor(e,t,i,n,o,r){this.view=t,this.tree=i,this.treeRenderers=n,this.treeDelegate=o,this.accessibilityProvider=r,this._previousElements=[],this._previousStateDisposables=new oe,this._rootDomNode=we(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const a=we(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new o$e(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const n=e.stickyNodes[e.count-1];this._previousState&&e.animationStateChanged(this._previousState)?this._previousElements[this._previousState.count-1].style.top=`${n.position}px`:this.renderState(e),this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}renderState(e){this._previousStateDisposables.clear();const t=Array(e.count);for(let i=e.count-1;i>=0;i--){const n=e.stickyNodes[i],{element:o,disposable:r}=this.createElement(n,i,e.count);t[i]=o,this._rootDomNode.appendChild(o),this._previousStateDisposables.add(r)}this.stickyScrollFocus.updateElements(t,e),this._previousElements=t}rerender(){this._previousState&&this.renderState(this._previousState)}createElement(e,t,i){const n=e.startIndex,o=document.createElement("div");o.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(o.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(o.style.lineHeight=`${e.height}px`),o.classList.add("monaco-tree-sticky-row"),o.classList.add("monaco-list-row"),o.setAttribute("data-index",`${n}`),o.setAttribute("data-parity",n%2===0?"even":"odd"),o.setAttribute("id",this.view.getElementID(n));const r=this.setAccessibilityAttributes(o,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(u=>u.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let c=e.node;c===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(c=new Proxy(e.node,{}));const d=l.renderTemplate(o);l.renderElement(c,e.startIndex,d,{height:e.height});const h=Ve(()=>{r.dispose(),l.disposeElement(c,e.startIndex,d,{height:e.height}),l.disposeTemplate(d),o.remove()});return{element:o,disposable:h}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return K.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");const o=this.accessibilityProvider.getAriaLabel(t),r=o&&typeof o!="string"?o:Gi(o),a=lt(c=>{const d=c.readObservable(r);d?e.setAttribute("aria-label",d):e.removeAttribute("aria-label")});typeof o=="string"||o&&e.setAttribute("aria-label",o.get());const l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}};class o$e extends K{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new q,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new q,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(ee(this.container,"focus",()=>this.onFocus())),this._register(ee(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}handleContextMenu(e){const t=e.browserEvent.target;if(!oI(t)&&!cx(t)){this.focusedLast()&&this.view.domFocus();return}if(!pu(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const r=this.state.stickyNodes.findIndex(a=>{var l;return a.node.element===((l=e.element)==null?void 0:l.element)});if(r===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(r);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const n=this.state.stickyNodes[this.focusedIndex].node.element,o=this.elements[this.focusedIndex];this._onContextMenu.fire({element:n,anchor:o,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){const t=e.browserEvent.target;!oI(t)&&!cx(t)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&t.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const n=dr(i,0,t.count-1);this.setFocus(n)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],n=t.count>1?t.stickyNodes[t.count-2]:void 0,o=this.view.getElementTop(e),r=n?n.position+n.height+i.height:i.height;this.view.scrollTop=o-r}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function YD(s){let e=t_.Unknown;return A5(s.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=t_.Twistie:A5(s.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=t_.Element:A5(s.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=t_.Filter),{browserEvent:s.browserEvent,element:s.element?s.element.element:null,target:e}}function r$e(s){const e=oI(s.browserEvent.target);return{element:s.element?s.element.element:null,browserEvent:s.browserEvent,anchor:s.anchor,isStickyScroll:e}}function oN(s,e){e(s),s.children.forEach(t=>oN(t,e))}class XF{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new q,this.onDidChange=this._onDidChange.event}set(e,t){const i=t;!(i!=null&&i.__forceEvent)&&dn(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=d=>l.delete(d);t.forEach(d=>oN(d,c)),this.set([...l.values()]);return}const i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>oN(l,n));const o=new Map,r=l=>o.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>oN(l,r));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const h=o.get(c);h&&h.visible&&a.push(h)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class a$e extends Gle{constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if($le(e.browserEvent.target)||nd(e.browserEvent.target)||xS(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,o=cx(e.browserEvent.target);let r=!1;if(o?r=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?r=this.tree.expandOnlyOnTwistieClick(t.element):r=!!this.tree.expandOnlyOnTwistieClick,o)this.handleStickyScrollMouseEvent(e,t);else{if(r&&!n&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(t.collapsible&&(!o||n)){const a=this.tree.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),this.tree.toggleCollapsed(a,l),n){e.browserEvent.isHandledByList=!0;return}}o||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if(jWe(e.browserEvent.target)||KWe(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const n=this.list.indexOf(t),o=this.list.getElementTop(n),r=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=o-r,this.list.domFocus(),this.list.setFocus([n]),this.list.setSelection([n])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){const t=e.browserEvent.target;if(!oI(t)&&!cx(t)){super.onMouseDown(e);return}}onContextMenu(e){const t=e.browserEvent.target;if(!oI(t)&&!cx(t)){super.onContextMenu(e);return}}}class l$e extends nl{constructor(e,t,i,n,o,r,a,l){super(e,t,i,n,l),this.focusTrait=o,this.selectionTrait=r,this.anchorTrait=a}createMouseController(e){return new a$e(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const n=[],o=[];let r;i.forEach((a,l)=>{this.focusTrait.has(a)&&n.push(e+l),this.selectionTrait.has(a)&&o.push(e+l),this.anchorTrait.has(a)&&(r=e+l)}),n.length>0&&super.setFocus(uf([...super.getFocus(),...n])),o.length>0&&super.setSelection(uf([...super.getSelection(),...o])),typeof r=="number"&&super.setAnchor(r)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(n=>this.element(n)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(n=>this.element(n)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class Yde{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Se.filter(Se.map(this.view.onMouseDblClick,YD),e=>e.target!==t_.Filter)}get onMouseOver(){return Se.map(this.view.onMouseOver,YD)}get onMouseOut(){return Se.map(this.view.onMouseOut,YD)}get onContextMenu(){var e;return Se.any(Se.filter(Se.map(this.view.onContextMenu,r$e),t=>!t.isStickyScroll),((e=this.stickyScrollController)==null?void 0:e.onContextMenu)??Se.None)}get onPointer(){return Se.map(this.view.onPointer,YD)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return Se.any(this.onDidChangeModelRelay.event,this.onDidSwapModel.event)}get onDidChangeCollapseState(){return this.onDidChangeCollapseStateRelay.event}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,n,o={}){this._user=e,this._options=o,this.eventBufferer=new ak,this.onDidChangeFindOpenState=Se.None,this.onDidChangeStickyScrollFocused=Se.None,this.disposables=new oe,this.onDidSwapModel=this.disposables.add(new q),this.onDidChangeModelRelay=this.disposables.add(new N0),this.onDidSpliceModelRelay=this.disposables.add(new N0),this.onDidChangeCollapseStateRelay=this.disposables.add(new N0),this.onDidChangeRenderNodeCountRelay=this.disposables.add(new N0),this.onDidChangeActiveNodesRelay=this.disposables.add(new N0),this._onWillRefilter=new q,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new q,this.modelDisposables=new oe,o.keyboardNavigationLabelProvider&&(o.findWidgetEnabled??!0)&&(this.findFilter=new jde(o.keyboardNavigationLabelProvider,o.filter,o.defaultFindVisibility),o={...o,filter:this.findFilter},this.disposables.add(this.findFilter)),this.model=this.createModel(e,o),this.treeDelegate=new $q(i);const r=this.disposables.add(new ZUe(this.onDidChangeActiveNodesRelay.event)),a=new Eoe;this.renderers=n.map(l=>new MW(l,this.model,this.onDidChangeCollapseStateRelay.event,r,a,o));for(const l of this.renderers)this.disposables.add(l);if(this.focus=new XF(()=>this.view.getFocusedElements()[0],o.identityProvider),this.selection=new XF(()=>this.view.getSelectedElements()[0],o.identityProvider),this.anchor=new XF(()=>this.view.getAnchorElement(),o.identityProvider),this.view=new l$e(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...XUe(()=>this.model,this.disposables,o),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.setupModel(this.model),o.keyboardSupport!==!1){const l=Se.chain(this.view.onKeyDown,c=>c.filter(d=>!nd(d.target)).map(d=>new Bi(d)));Se.chain(l,c=>c.filter(d=>d.keyCode===15))(this.onLeftArrow,this,this.disposables),Se.chain(l,c=>c.filter(d=>d.keyCode===17))(this.onRightArrow,this,this.disposables),Se.chain(l,c=>c.filter(d=>d.keyCode===10))(this.onSpace,this,this.disposables)}if((o.findWidgetEnabled??!0)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider){const l={styles:o.findWidgetStyles,defaultFindMode:o.defaultFindMode,defaultFindMatchType:o.defaultFindMatchType,showNotFoundMessage:o.showNotFoundMessage};this.findController=this.disposables.add(new Kde(this,this.findFilter,o.contextViewProvider,l)),this.focusNavigationFilter=c=>this.findController.shouldAllowFocus(c),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=Se.None,this.onDidChangeFindMatchType=Se.None;o.enableStickyScroll&&(this.stickyScrollController=new eJ(this,this.model,this.view,this.renderers,this.treeDelegate,o),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Hl(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===tv.Always)}updateOptions(e={}){var t;this._options={...this._options,...e};for(const i of this.renderers)i.updateOptions(e);this.view.updateOptions(this._options),(t=this.findController)==null||t.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===tv.Always)}get options(){return this._options}updateStickyScroll(e){var t;!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new eJ(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=Se.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),(t=this.stickyScrollController)==null||t.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){var e;(e=this.stickyScrollController)!=null&&e.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){this.view.layout(e,t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { opacity: 1; border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { opacity: 1; border-color: ${e.treeIndentGuidesStroke}; }`));const n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const o=Ju(e.listFocusAndSelectionOutline,Ju(e.listSelectionOutline,e.listFocusOutline??""));o&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${o}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(o=>this.model.getNode(o));this.selection.set(i,t);const n=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(o=>this.model.getNode(o));this.focus.set(i,t);const n=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=pu(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=pu(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=pu(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=pu(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>{var i;return((i=this.stickyScrollController)==null?void 0:i.height)??0})}focusLast(e,t=pu(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=pu(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{const n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const r=this.model.getParentNodeLocation(n);if(!r)return;const a=this.model.getListIndex(r);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;const[r]=this.view.getFocus(),a=r+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i),o=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,o)}setupModel(e){this.modelDisposables.clear(),this.modelDisposables.add(e.onDidSpliceRenderedNodes(({start:o,deleteCount:r,elements:a})=>this.view.splice(o,r,a)));const t=Se.forEach(e.onDidSpliceModel,o=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(o),this.selection.onDidModelSplice(o)})},this.modelDisposables);t(()=>null,null,this.modelDisposables);const i=this.modelDisposables.add(new q),n=this.modelDisposables.add(new Pl(0));this.modelDisposables.add(Se.any(t,this.focus.onDidChange,this.selection.onDidChange)(()=>{n.trigger(()=>{const o=new Set;for(const r of this.focus.getNodes())o.add(r);for(const r of this.selection.getNodes())o.add(r);i.fire([...o.values()])})})),this.onDidChangeActiveNodesRelay.input=i.event,this.onDidChangeModelRelay.input=Se.signal(e.onDidSpliceModel),this.onDidChangeCollapseStateRelay.input=e.onDidChangeCollapseState,this.onDidChangeRenderNodeCountRelay.input=e.onDidChangeRenderNodeCount,this.onDidSpliceModelRelay.input=e.onDidSpliceModel}dispose(){var e;yi(this.disposables),(e=this.stickyScrollController)==null||e.dispose(),this.view.dispose(),this.modelDisposables.dispose()}}class qq{constructor(e,t={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new KUe(e,null,t),this.onDidSpliceModel=this.model.onDidSpliceModel,this.onDidSpliceRenderedNodes=this.model.onDidSpliceRenderedNodes,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,t.sorter&&(this.sorter={compare(i,n){return t.sorter.compare(i.element,n.element)}}),this.identityProvider=t.identityProvider}setChildren(e,t=Gt.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=Gt.empty(),i){const n=new Set,o=new Set,r=l=>{var d;if(l.element===null)return;const c=l;if(n.add(c.element),this.nodes.set(c.element,c),this.identityProvider){const h=this.identityProvider.getId(c.element).toString();o.add(h),this.nodesByIdentity.set(h,c)}(d=i.onDidCreateNode)==null||d.call(i,c)},a=l=>{var d;if(l.element===null)return;const c=l;if(n.has(c.element)||this.nodes.delete(c.element),this.identityProvider){const h=this.identityProvider.getId(c.element).toString();o.has(h)||this.nodesByIdentity.delete(h)}(d=i.onDidDeleteNode)==null||d.call(i,c)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:r,onDidDeleteNode:a})}preserveCollapseState(e=Gt.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Gt.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const r=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(r)}if(!i){let r;return typeof t.collapsed>"u"?r=void 0:t.collapsed===Fa.Collapsed||t.collapsed===Fa.PreserveOrCollapsed?r=!0:t.collapsed===Fa.Expanded||t.collapsed===Fa.PreserveOrExpanded?r=!1:r=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:r}}const n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let o;return typeof t.collapsed>"u"||t.collapsed===Fa.PreserveOrCollapsed||t.collapsed===Fa.PreserveOrExpanded?o=i.collapsed:t.collapsed===Fa.Collapsed?o=!0:t.collapsed===Fa.Expanded?o=!1:o=!!t.collapsed,{...t,collapsible:n,collapsed:o,children:this.preserveCollapseState(t.children)}})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}resort(e=null,t=!0){if(!this.sorter)return;const i=this.getElementLocation(e),n=this.model.getNode(i);this._setChildren(i,this.resortChildren(n,t),{})}resortChildren(e,t,i=!0){let n=[...e.children];return(t||i)&&(n=n.sort(this.sorter.compare.bind(this.sorter))),Gt.map(n,o=>({element:o.element,collapsible:o.collapsible,collapsed:o.collapsed,children:this.resortChildren(o,t,!1)}))}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new za(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new za(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new za(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new za(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function rN(s){const e=[s.element],t=s.incompressible||!1;return{element:{elements:e,incompressible:t},children:Gt.map(Gt.from(s.children),rN),collapsible:s.collapsible,collapsed:s.collapsed}}function aN(s){const e=[s.element],t=s.incompressible||!1;let i,n;for(;[n,i]=Gt.consume(Gt.from(s.children),2),!(n.length!==1||n[0].incompressible);)s=n[0],e.push(s.element);return{element:{elements:e,incompressible:t},children:Gt.map(Gt.concat(n,i),aN),collapsible:s.collapsible,collapsed:s.collapsed}}function AW(s,e=0){let t;return e<s.element.elements.length-1?t=[AW(s,e+1)]:t=Gt.map(Gt.from(s.children),i=>AW(i,0)),e===0&&s.element.incompressible?{element:s.element.elements[e],children:t,incompressible:!0,collapsible:s.collapsible,collapsed:s.collapsed}:{element:s.element.elements[e],children:t,collapsible:s.collapsible,collapsed:s.collapsed}}function tJ(s){return AW(s,0)}function Xde(s,e,t){return s.element===e?{...s,children:t}:{...s,children:Gt.map(Gt.from(s.children),i=>Xde(i,e,t))}}const c$e=s=>({getId(e){return e.elements.map(t=>s.getId(t).toString()).join("\0")}});class d$e{get onDidSpliceRenderedNodes(){return this.model.onDidSpliceRenderedNodes}get onDidSpliceModel(){return this.model.onDidSpliceModel}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new qq(e,t),this.enabled=typeof t.compressionEnabled>"u"?!0:t.compressionEnabled,this.identityProvider=t.identityProvider}setChildren(e,t=Gt.empty(),i){const n=i.diffIdentityProvider&&c$e(i.diffIdentityProvider);if(e===null){const g=Gt.map(t,this.enabled?aN:rN);this._setChildren(null,g,{diffIdentityProvider:n,diffDepth:1/0});return}const o=this.nodes.get(e);if(!o)throw new za(this.user,"Unknown compressed tree node");const r=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),c=tJ(r),d=Xde(c,e,t),h=(this.enabled?aN:rN)(d),u=i.diffIdentityProvider?((g,m)=>i.diffIdentityProvider.getId(g)===i.diffIdentityProvider.getId(m)):void 0;if(dn(h.element.elements,r.element.elements,u)){this._setChildren(o,h.children||Gt.empty(),{diffIdentityProvider:n,diffDepth:1});return}const f=l.children.map(g=>g===r?h:g);this._setChildren(l.element,f,{diffIdentityProvider:n,diffDepth:r.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,n=Gt.map(i,tJ),o=Gt.map(n,e?aN:rN);this._setChildren(null,o,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const n=new Set,o=a=>{for(const l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},r=a=>{for(const l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:o,onDidDeleteNode:r})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}resort(e=null,t=!0){const i=this.getCompressedNode(e);this.model.resort(i,t)}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new za(this.user,`Tree element not found: ${e}`);return t}}const h$e=s=>s[s.length-1];class jq{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new jq(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function u$e(s,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(s(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){const n=t.elements;for(let o=0;o<n.length-1;o++){const r=e.filter.filter(n[o],i);i=ev(Ok(r)?r.visibility:r)}return e.filter.filter(n[n.length-1],i)}}}}class f$e{get onDidSpliceModel(){return Se.map(this.model.onDidSpliceModel,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidSpliceRenderedNodes(){return Se.map(this.model.onDidSpliceRenderedNodes,({start:e,deleteCount:t,elements:i})=>({start:e,deleteCount:t,elements:i.map(n=>this.nodeMapper.map(n))}))}get onDidChangeCollapseState(){return Se.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return Se.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t={}){this.rootRef=null,this.elementMapper=t.elementMapper||h$e;const i=n=>this.elementMapper(n.elements);this.nodeMapper=new Uq(n=>new jq(i,n)),this.model=new d$e(e,u$e(i,t))}setChildren(e,t=Gt.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}resort(e=null,t=!0){return this.model.resort(e,t)}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var g$e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};class Kq extends Yde{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,n,o={}){super(e,t,i,n,o),this.user=e}setChildren(e,t=Gt.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}resort(e,t=!0){this.model.resort(e,t)}hasElement(e){return this.model.has(e)}createModel(e,t){return new qq(e,t)}}class Zde{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t,i){this._compressedTreeNodeProvider=e,this.stickyScrollDelegate=t,this.renderer=i,this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let o=this.stickyScrollDelegate.getCompressedNode(e);o||(o=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),o.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,t,i.data,n))}disposeElement(e,t,i,n){var o,r,a,l;i.compressedTreeNode?(r=(o=this.renderer).disposeCompressedElements)==null||r.call(o,i.compressedTreeNode,t,i.data,n):(l=(a=this.renderer).disposeElement)==null||l.call(a,e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){var i,n;return((n=(i=this.renderer).renderTwistie)==null?void 0:n.call(i,e,t))??!1}}g$e([Kn],Zde.prototype,"compressedTreeNodeProvider",null);class m$e{constructor(e){this.modelProvider=e,this.compressedStickyNodes=new Map}getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){const o=e[n],r=o.position+o.height;if(n+1<e.length&&r+e[n+1].height>i||n>=t-1&&t<e.length){const l=e.slice(0,n),c=e.slice(n),d=this.compressStickyNodes(c);return[...l,d]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");const t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];const i=[];for(let c=0;c<e.length;c++){const d=e[c],h=t.getCompressedTreeNode(d.node.element);if(h.element){if(c!==0&&h.element.incompressible)break;i.push(...h.element.elements)}}if(i.length<2)return e[0];const n=e[e.length-1],o={elements:i,incompressible:!1},r={...n.node,children:[],element:o},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,r),l}}function p$e(s,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=s().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}class Qde extends Kq{constructor(e,t,i,n,o={}){const r=()=>this,a=new m$e(()=>this.model),l=n.map(c=>new Zde(r,a,c));super(e,t,i,l,{...p$e(r,o),stickyScrollDelegate:a})}setChildren(e,t=Gt.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t){return new f$e(e,t)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}function ZF(s){return{...s,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function PW(s,e){return e.parent?e.parent===s?!0:PW(s,e.parent):!1}function _$e(s,e){return s===e||PW(s,e)||PW(e,s)}class Gq{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new Gq(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class b$e{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...it.asClassNameArray(ge.treeItemLoading)),!0):(t.classList.remove(...it.asClassNameArray(ge.treeItemLoading)),!1)}disposeElement(e,t,i,n){var o,r;(r=(o=this.renderer).disposeElement)==null||r.call(o,this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function iJ(s){return{browserEvent:s.browserEvent,elements:s.elements.map(e=>e.element)}}function nJ(s){return{browserEvent:s.browserEvent,element:s.element&&s.element.element,target:s.target}}class v$e extends Ek{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function QF(s){return s instanceof Ek?new v$e(s):s}class C$e{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,n;(n=(i=this.dnd).onDragStart)==null||n.call(i,QF(e),t)}onDragOver(e,t,i,n,o,r=!0){return this.dnd.onDragOver(QF(e),t&&t.element,i,n,o)}drop(e,t,i,n,o){this.dnd.drop(QF(e),t&&t.element,i,n,o)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)==null||i.call(t,e)}dispose(){this.dnd.dispose()}}class w$e extends jde{constructor(e,t,i){super(t,i),this.findProvider=e,this.isFindSessionActive=!1}filter(e,t){const i=super.filter(e,t);if(!this.isFindSessionActive||this.findMode===Ua.Highlight||!this.findProvider.isVisible)return i;const n=Ok(i)?i.visibility:i;return ev(n)===0?0:this.findProvider.isVisible(e)?i:0}}class y$e extends Kde{constructor(e,t,i,n,o){super(e,i,n,o),this.findProvider=t,this.filter=i,this.activeSession=!1,this.asyncWorkInProgress=!1,this.disposables.add(Ve(async()=>{var r,a;this.activeSession&&await((a=(r=this.findProvider).endSession)==null?void 0:a.call(r))}))}render(){if(this.asyncWorkInProgress||!this.activeFindMetadata)return;const e=this.activeFindMetadata.matchCount===0&&this.pattern.length>0;this.renderMessage(e),this.pattern.length&&this.alertResults(this.activeFindMetadata.matchCount)}shouldAllowFocus(e){return this.shouldFocusWhenNavigating(e)}shouldFocusWhenNavigating(e){var i;if(!this.activeSession||!this.activeFindMetadata)return!0;const t=(i=e.element)==null?void 0:i.element;return t&&this.activeFindMetadata.isMatch(t)?!0:!fc.isDefault(e.filterData)}}function Jde(s){return s&&{...s,collapseByDefault:!0,identityProvider:s.identityProvider&&{getId(e){return s.identityProvider.getId(e.element)}},dnd:s.dnd&&new C$e(s.dnd),multipleSelectionController:s.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return s.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return s.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:s.accessibilityProvider&&{...s.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:s.accessibilityProvider.getRole?e=>s.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:s.accessibilityProvider.isChecked?e=>{var t;return!!((t=s.accessibilityProvider)!=null&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return s.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return s.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:s.accessibilityProvider.getWidgetRole?()=>s.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:s.accessibilityProvider.getAriaLevel&&(e=>s.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:s.accessibilityProvider.getActiveDescendantId&&(e=>s.accessibilityProvider.getActiveDescendantId(e.element))},filter:s.filter&&{filter(e,t){return s.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:s.keyboardNavigationLabelProvider&&{...s.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return s.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof s.expandOnlyOnTwistieClick>"u"?void 0:typeof s.expandOnlyOnTwistieClick!="function"?s.expandOnlyOnTwistieClick:(e=>s.expandOnlyOnTwistieClick(e.element)),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof s.defaultFindVisibility=="number"?s.defaultFindVisibility:typeof s.defaultFindVisibility>"u"?2:s.defaultFindVisibility(e.element),stickyScrollDelegate:s.stickyScrollDelegate}}function OW(s,e){e(s),s.children.forEach(t=>OW(t,e))}class ehe{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return Se.map(this.tree.onDidChangeFocus,iJ)}get onDidChangeSelection(){return Se.map(this.tree.onDidChangeSelection,iJ)}get onMouseDblClick(){return Se.map(this.tree.onMouseDblClick,nJ)}get onPointer(){return Se.map(this.tree.onPointer,nJ)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,n,o,r={}){this.user=e,this.dataSource=o,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new q,this._onDidChangeNodeSlowState=new q,this.nodeMapper=new Uq(c=>new Gq(c)),this.disposables=new oe,this.identityProvider=r.identityProvider,this.autoExpandSingleChildren=typeof r.autoExpandSingleChildren>"u"?!1:r.autoExpandSingleChildren,this.sorter=r.sorter,this.getDefaultCollapseState=c=>r.collapseByDefault?r.collapseByDefault(c)?Fa.PreserveOrCollapsed:Fa.PreserveOrExpanded:void 0;let a=!1,l;if(r.findProvider&&(r.findWidgetEnabled??!0)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider&&(a=!0,l=new w$e(r.findProvider,r.keyboardNavigationLabelProvider,r.filter)),this.tree=this.createTree(e,t,i,n,{...r,findWidgetEnabled:!a,filter:l??r.filter}),this.root=ZF({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables),a){const c={styles:r.findWidgetStyles,showNotFoundMessage:r.showNotFoundMessage,defaultFindMatchType:r.defaultFindMatchType,defaultFindMode:r.defaultFindMode};this.findController=this.disposables.add(new y$e(this.tree,r.findProvider,l,this.tree.options.contextViewProvider,c)),this.focusNavigationFilter=d=>this.findController.shouldFocusWhenNavigating(d),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindOpenState=this.tree.onDidChangeFindOpenState,this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType}createTree(e,t,i,n,o){const r=new $q(i),a=n.map(c=>new b$e(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=Jde(o)||{};return new Kq(e,t,r,a,l)}updateOptions(e={}){this.findController&&(e.defaultFindMode!==void 0&&(this.findController.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.findController.matchType=e.defaultFindMatchType)),this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.cancelAllRefreshPromises(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}cancelAllRefreshPromises(e=!1){this.refreshPromises.forEach(t=>t.cancel()),this.refreshPromises.clear(),e&&(this.subTreeRefreshPromises.forEach(t=>t.cancel()),this.subTreeRefreshPromises.clear())}async _updateChildren(e=this.root.element,t=!0,i=!1,n,o){if(typeof this.root.element>"u")throw new za(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await Se.toPromise(this._onDidRender.event));const r=this.getDataNode(e);if(await this.refreshAndRenderNode(r,t,n,o),i)try{this.tree.rerender(r)}catch{}}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new za(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await Se.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await i.refreshPromise,await Se.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await i.refreshPromise,await Se.toPromise(this._onDidRender.event)),n}setSelection(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){var i;const t=this.nodes.get(e===this.root.element?null:e);if(!t){const n=(i=this.identityProvider)==null?void 0:i.getId(e).toString();throw new za(this.user,`Data tree node not found${n?`: ${n}`:""}`)}return t}async refreshAndRenderNode(e,t,i,n){this.disposables.isDisposed||(await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n))}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((o,r)=>{!n&&_$e(r,e)&&(n=o.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){const n=ys(async()=>{const o=await this.doRefreshNode(e,t,i);e.stale=!1,await mL.settled(o.map(r=>this.doRefreshSubTree(r,t,i)))});return e.refreshPromise=n,this.subTreeRefreshPromises.set(e,n),n.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)}),n}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(Gt.empty());else{const o=this.doGetChildren(e);if(v9(o))n=Promise.resolve(o);else{const r=Sh(800);r.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=o.finally(()=>r.cancel())}}try{const o=await n;return this.setChildren(e,o,t,i)}catch(o){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),il(o))return[];throw o}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return v9(i)?this.processChildren(i):(t=ys(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(_t))}setChildren(e,t,i,n){const o=[...t];if(e.children.length===0&&o.length===0)return[];const r=new Map,a=new Map;for(const d of e.children)r.set(d.element,d),this.identityProvider&&a.set(d.id,{node:d,collapsed:this.tree.hasElement(d)&&this.tree.isCollapsed(d)});const l=[],c=o.map(d=>{const h=!!this.dataSource.hasChildren(d);if(!this.identityProvider){const m=ZF({element:d,parent:e,hasChildren:h,defaultCollapseState:this.getDefaultCollapseState(d)});return h&&m.defaultCollapseState===Fa.PreserveOrExpanded&&l.push(m),m}const u=this.identityProvider.getId(d).toString(),f=a.get(u);if(f){const m=f.node;return r.delete(m.element),this.nodes.delete(m.element),this.nodes.set(d,m),m.element=d,m.hasChildren=h,i?f.collapsed?(m.children.forEach(p=>OW(p,v=>this.nodes.delete(v.element))),m.children.splice(0,m.children.length),m.stale=!0):l.push(m):h&&!f.collapsed&&l.push(m),m}const g=ZF({element:d,parent:e,id:u,hasChildren:h,defaultCollapseState:this.getDefaultCollapseState(d)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(u)>-1&&n.focus.push(g),n&&n.viewState.selection&&n.viewState.selection.indexOf(u)>-1&&n.selection.push(g),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(u)>-1||h&&g.defaultCollapseState===Fa.PreserveOrExpanded)&&l.push(g),g});for(const d of r.values())OW(d,h=>this.nodes.delete(h.element));for(const d of c)this.nodes.set(d.element,d);return GN(e.children,0,e.children.length,c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].forceExpanded=!0,l.push(c[0])),l}render(e,t,i){const n=e.children.map(r=>this.asTreeElement(r,t)),o=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(r){return i.diffIdentityProvider.getId(r.element)}}};this.tree.setChildren(e===this.root?null:e,n,o),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?Gt.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class Yq{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new Yq(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class S$e{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...it.asClassNameArray(ge.treeItemLoading)),!0):(t.classList.remove(...it.asClassNameArray(ge.treeItemLoading)),!1)}disposeElement(e,t,i,n){var o,r;(r=(o=this.renderer).disposeElement)==null||r.call(o,this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){var o,r;(r=(o=this.renderer).disposeCompressedElements)==null||r.call(o,this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=yi(this.disposables)}}function x$e(s){const e=s&&Jde(s);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return s.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}},stickyScrollDelegate:e.stickyScrollDelegate}}class L$e extends ehe{constructor(e,t,i,n,o,r,a={}){super(e,t,i,o,r,a),this.compressionDelegate=n,this.compressibleNodeMapper=new Uq(l=>new Yq(l)),this.filter=a.filter}createTree(e,t,i,n,o){const r=new $q(i),a=n.map(c=>new S$e(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=x$e(o)||{};return new Qde(e,t,r,a,l)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const n=f=>this.identityProvider.getId(f).toString(),o=f=>{const g=new Set;for(const m of f){const p=this.tree.getCompressedTreeNode(m===this.root?null:m);if(p.element)for(const v of p.element.elements)g.add(n(v.element))}return g},r=o(this.tree.getSelection()),a=o(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let c=!1;const d=this.getFocus();let h=!1;const u=f=>{const g=f.element;if(g)for(let m=0;m<g.elements.length;m++){const p=n(g.elements[m].element),v=g.elements[g.elements.length-1].element;r.has(p)&&l.indexOf(v)===-1&&(l.push(v),c=!0),a.has(p)&&d.indexOf(v)===-1&&(d.push(v),h=!0)}f.children.forEach(u)};u(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(l),h&&this.setFocus(d)}processChildren(e){return this.filter&&(e=Gt.filter(e,t=>{const i=this.filter.filter(t,1),n=I$e(i);if(n===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return n===1})),super.processChildren(e)}}function I$e(s){return typeof s=="boolean"?s?1:0:Ok(s)?ev(s.visibility):ev(s)}class E$e extends Yde{constructor(e,t,i,n,o,r={}){super(e,t,i,n,r),this.user=e,this.dataSource=o,this.identityProvider=r.identityProvider}createModel(e,t){return new qq(e,t)}}new Ne("isMac",Bt,_(1684,"Whether the operating system is macOS"));new Ne("isLinux",Hr,_(1685,"Whether the operating system is Linux"));const S4=new Ne("isWindows",no,_(1686,"Whether the operating system is Windows")),the=new Ne("isWeb",Ah,_(1687,"Whether the platform is a web browser"));new Ne("isMacNative",Bt&&!Ah,_(1688,"Whether the operating system is macOS on a non-browser platform"));new Ne("isIOS",Al,_(1689,"Whether the operating system is iOS"));new Ne("isMobile",Lse,_(1690,"Whether the platform is a mobile web browser"));new Ne("isDevelopment",!1,!0);new Ne("productQualityType","",_(1691,"Quality type of VS Code"));const ihe="inputFocus",Xq=new Ne(ihe,!1,_(1692,"Whether keyboard focus is inside an input box"));var Pf=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},on=function(s,e){return function(t,i){e(t,i,s)}};const ql=Mt("listService");class k$e{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new oe,this.lists=[],this._lastFocusedWidget=void 0}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&((t=this._lastFocusedWidget)==null||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,(i=this._lastFocusedWidget)==null||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this.lists.some(n=>n.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),CO(e.getHTMLElement())&&this.setLastFocusedList(e),dc(e.onDidFocus(()=>this.setLastFocusedList(e)),Ve(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(n=>n!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const wI=new Ne("listScrollAtBoundary","none");de.or(wI.isEqualTo("top"),wI.isEqualTo("both"));de.or(wI.isEqualTo("bottom"),wI.isEqualTo("both"));const nhe=new Ne("listFocus",!0),she=new Ne("treestickyScrollFocused",!1),x4=new Ne("listSupportsMultiselect",!0),ohe=de.and(nhe,de.not(ihe),she.negate()),Zq=new Ne("listHasSelectionOrFocus",!1),Qq=new Ne("listDoubleSelection",!1),Jq=new Ne("listMultiSelection",!1),L4=new Ne("listSelectionNavigation",!1),D$e=new Ne("listSupportsFind",!0),ej=new Ne("treeElementCanCollapse",!1),T$e=new Ne("treeElementHasParent",!1),tj=new Ne("treeElementCanExpand",!1),N$e=new Ne("treeElementHasChild",!1),R$e=new Ne("treeFindOpen",!1),rhe="listTypeNavigationMode",ahe="listAutomaticKeyboardNavigation";function I4(s,e){const t=s.createScoped(e.getHTMLElement());return nhe.bindTo(t),t}function E4(s,e){const t=wI.bindTo(s),i=()=>{const n=e.scrollTop===0,o=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&o?t.set("both"):n?t.set("top"):o?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const Dv="workbench.list.multiSelectModifier",lN="workbench.list.openMode",Nl="workbench.list.horizontalScrolling",ij="workbench.list.defaultFindMode",nj="workbench.list.typeNavigationMode",T2="workbench.list.keyboardNavigation",md="workbench.list.scrollByPage",sj="workbench.list.defaultFindMatchType",yI="workbench.tree.indent",N2="workbench.tree.renderIndentGuides",pd="workbench.list.smoothScrolling",Dh="workbench.list.mouseWheelScrollSensitivity",Th="workbench.list.fastScrollSensitivity",R2="workbench.tree.expandMode",M2="workbench.tree.enableStickyScroll",A2="workbench.tree.stickyScrollMaxItemCount";function Nh(s){return s.getValue(Dv)==="alt"}class M$e extends K{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Nh(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Dv)&&(this.useAltAsMultipleSelectionModifier=Nh(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:jle(e)}isSelectionRangeChangeEvent(e){return Kle(e)}}function k4(s,e){const t=s.get(xt),i=s.get(ai),n=new oe;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(r){return i.mightProducePrintableCharacter(r)}},smoothScrolling:!!t.getValue(pd),mouseWheelScrollSensitivity:t.getValue(Dh),fastScrollSensitivity:t.getValue(Th),multipleSelectionController:e.multipleSelectionController??n.add(new M$e(t)),keyboardNavigationEventFilter:O$e(i),scrollByPage:!!t.getValue(md)},n]}let sJ=class extends nl{constructor(e,t,i,n,o,r,a,l,c){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(Nl),[h,u]=c.invokeFunction(k4,o);super(e,t,i,n,{keyboardSupport:!1,...h,horizontalScrolling:d}),this.disposables.add(u),this.contextKeyService=I4(r,this),this.disposables.add(E4(this.contextKeyService,this)),this.listSupportsMultiSelect=x4.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),L4.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=Zq.bindTo(this.contextKeyService),this.listDoubleSelection=Qq.bindTo(this.contextKeyService),this.listMultiSelection=Jq.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Nh(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const g=this.getSelection(),m=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||m.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const g=this.getSelection(),m=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||m.length>0)})),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(Dv)&&(this._useAltAsMultipleSelectionModifier=Nh(l));let m={};if(g.affectsConfiguration(Nl)&&this.horizontalScrolling===void 0){const p=!!l.getValue(Nl);m={...m,horizontalScrolling:p}}if(g.affectsConfiguration(md)){const p=!!l.getValue(md);m={...m,scrollByPage:p}}if(g.affectsConfiguration(pd)){const p=!!l.getValue(pd);m={...m,smoothScrolling:p}}if(g.affectsConfiguration(Dh)){const p=l.getValue(Dh);m={...m,mouseWheelScrollSensitivity:p}}if(g.affectsConfiguration(Th)){const p=l.getValue(Th);m={...m,fastScrollSensitivity:p}}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new lhe(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Lv(e):p0)}};sJ=Pf([on(5,ut),on(6,ql),on(7,xt),on(8,$e)],sJ);let oJ=class extends HUe{constructor(e,t,i,n,o,r,a,l,c){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue(Nl),[h,u]=c.invokeFunction(k4,o);super(e,t,i,n,{keyboardSupport:!1,...h,horizontalScrolling:d}),this.disposables=new oe,this.disposables.add(u),this.contextKeyService=I4(r,this),this.disposables.add(E4(this.contextKeyService,this.widget)),this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=x4.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),L4.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this._useAltAsMultipleSelectionModifier=Nh(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(Dv)&&(this._useAltAsMultipleSelectionModifier=Nh(l));let m={};if(g.affectsConfiguration(Nl)&&this.horizontalScrolling===void 0){const p=!!l.getValue(Nl);m={...m,horizontalScrolling:p}}if(g.affectsConfiguration(md)){const p=!!l.getValue(md);m={...m,scrollByPage:p}}if(g.affectsConfiguration(pd)){const p=!!l.getValue(pd);m={...m,smoothScrolling:p}}if(g.affectsConfiguration(Dh)){const p=l.getValue(Dh);m={...m,mouseWheelScrollSensitivity:p}}if(g.affectsConfiguration(Th)){const p=l.getValue(Th);m={...m,fastScrollSensitivity:p}}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new lhe(this,{configurationService:l,...o}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Lv(e):p0)}dispose(){this.disposables.dispose(),super.dispose()}};oJ=Pf([on(5,ut),on(6,ql),on(7,xt),on(8,$e)],oJ);let rJ=class extends RW{constructor(e,t,i,n,o,r,a,l,c,d){const h=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!c.getValue(Nl),[u,f]=d.invokeFunction(k4,r);super(e,t,i,n,o,{keyboardSupport:!1,...u,horizontalScrolling:h}),this.disposables.add(f),this.contextKeyService=I4(a,this),this.disposables.add(E4(this.contextKeyService,this)),this.listSupportsMultiSelect=x4.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),L4.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=Zq.bindTo(this.contextKeyService),this.listDoubleSelection=Qq.bindTo(this.contextKeyService),this.listMultiSelection=Jq.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Nh(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const m=this.getSelection(),p=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(m.length>0||p.length>0),this.listMultiSelection.set(m.length>1),this.listDoubleSelection.set(m.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const m=this.getSelection(),p=this.getFocus();this.listHasSelectionOrFocus.set(m.length>0||p.length>0)})),this.disposables.add(c.onDidChangeConfiguration(m=>{m.affectsConfiguration(Dv)&&(this._useAltAsMultipleSelectionModifier=Nh(c));let p={};if(m.affectsConfiguration(Nl)&&this.horizontalScrolling===void 0){const v=!!c.getValue(Nl);p={...p,horizontalScrolling:v}}if(m.affectsConfiguration(md)){const v=!!c.getValue(md);p={...p,scrollByPage:v}}if(m.affectsConfiguration(pd)){const v=!!c.getValue(pd);p={...p,smoothScrolling:v}}if(m.affectsConfiguration(Dh)){const v=c.getValue(Dh);p={...p,mouseWheelScrollSensitivity:v}}if(m.affectsConfiguration(Th)){const v=c.getValue(Th);p={...p,fastScrollSensitivity:v}}Object.keys(p).length>0&&this.updateOptions(p)})),this.navigator=new A$e(this,{configurationService:c,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Lv(e):p0)}dispose(){this.disposables.dispose(),super.dispose()}};rJ=Pf([on(6,ut),on(7,ql),on(8,xt),on(9,$e)],rJ);class oj extends K{constructor(e,t){super(),this.widget=e,this._onDidOpen=this._register(new q),this.onDidOpen=this._onDidOpen.event,this._register(Se.filter(this.widget.onDidChangeSelection,i=>pu(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(lN))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(lN)&&(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(lN))!=="doubleClick")}))):this.openOnSingleClick=(t==null?void 0:t.openOnSingleClick)??!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,n=typeof t.pinned=="boolean"?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const n=t.button===1,o=!0,r=n,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,o,r,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const o=!1,r=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,o,r,a,t)}_open(e,t,i,n,o){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:o})}}class lhe extends oj{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class A$e extends oj{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class P$e extends oj{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function O$e(s){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=s.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let P2=class extends Kq{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,r,a,l,c){const{options:d,getTypeNavigationMode:h,disposable:u}=r.invokeFunction(Fk,o);super(e,t,i,n,d),this.disposables.add(u),this.internals=new iv(this,o,h,o.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};P2=Pf([on(5,$e),on(6,ut),on(7,ql),on(8,xt)],P2);let aJ=class extends Qde{constructor(e,t,i,n,o,r,a,l,c){const{options:d,getTypeNavigationMode:h,disposable:u}=r.invokeFunction(Fk,o);super(e,t,i,n,d),this.disposables.add(u),this.internals=new iv(this,o,h,o.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};aJ=Pf([on(5,$e),on(6,ut),on(7,ql),on(8,xt)],aJ);let lJ=class extends E$e{constructor(e,t,i,n,o,r,a,l,c,d){const{options:h,getTypeNavigationMode:u,disposable:f}=a.invokeFunction(Fk,r);super(e,t,i,n,o,h),this.disposables.add(f),this.internals=new iv(this,r,u,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};lJ=Pf([on(6,$e),on(7,ut),on(8,ql),on(9,xt)],lJ);let FW=class extends ehe{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,o,r,a,l,c,d){const{options:h,getTypeNavigationMode:u,disposable:f}=a.invokeFunction(Fk,r);super(e,t,i,n,o,h),this.disposables.add(f),this.internals=new iv(this,r,u,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};FW=Pf([on(6,$e),on(7,ut),on(8,ql),on(9,xt)],FW);let cJ=class extends L$e{constructor(e,t,i,n,o,r,a,l,c,d,h){const{options:u,getTypeNavigationMode:f,disposable:g}=l.invokeFunction(Fk,a);super(e,t,i,n,o,r,u),this.disposables.add(g),this.internals=new iv(this,a,f,a.overrideStyles,c,d,h),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};cJ=Pf([on(7,$e),on(8,ut),on(9,ql),on(10,xt)],cJ);function che(s){const e=s.getValue(ij);if(e==="highlight")return Ua.Highlight;if(e==="filter")return Ua.Filter;const t=s.getValue(T2);if(t==="simple"||t==="highlight")return Ua.Highlight;if(t==="filter")return Ua.Filter}function dhe(s){const e=s.getValue(sj);if(e==="fuzzy")return Zc.Fuzzy;if(e==="contiguous")return Zc.Contiguous}function Fk(s,e){const t=s.get(xt),i=s.get(Nf),n=s.get(ut),o=s.get($e),r=()=>{const u=n.getContextKeyValue(rhe);if(u==="automatic")return th.Automatic;if(u==="trigger"||n.getContextKeyValue(ahe)===!1)return th.Trigger;const g=t.getValue(nj);if(g==="automatic")return th.Automatic;if(g==="trigger")return th.Trigger},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(Nl),[l,c]=o.invokeFunction(k4,e),d=e.paddingBottom,h=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(N2);return{getTypeNavigationMode:r,disposable:c,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(yI)=="number"?t.getValue(yI):void 0,renderIndentGuides:h,smoothScrolling:!!t.getValue(pd),defaultFindMode:e.defaultFindMode??che(t),defaultFindMatchType:e.defaultFindMatchType??dhe(t),horizontalScrolling:a,scrollByPage:!!t.getValue(md),paddingBottom:d,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(R2)==="doubleClick",contextViewProvider:i,findWidgetStyles:x6e,enableStickyScroll:!!t.getValue(M2),stickyScrollMaxItemCount:Number(t.getValue(A2))}}}let iv=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,o,r,a){this.tree=e,this.disposables=[],this.contextKeyService=I4(o,e),this.disposables.push(E4(this.contextKeyService,e)),this.listSupportsMultiSelect=x4.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),L4.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=D$e.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=Zq.bindTo(this.contextKeyService),this.hasDoubleSelection=Qq.bindTo(this.contextKeyService),this.hasMultiSelection=Jq.bindTo(this.contextKeyService),this.treeElementCanCollapse=ej.bindTo(this.contextKeyService),this.treeElementHasParent=T$e.bindTo(this.contextKeyService),this.treeElementCanExpand=tj.bindTo(this.contextKeyService),this.treeElementHasChild=N$e.bindTo(this.contextKeyService),this.treeFindOpen=R$e.bindTo(this.contextKeyService),this.treeStickyScrollFocused=she.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Nh(a),this.updateStyleOverrides(n);const c=()=>{const h=e.getFocus()[0];if(!h)return;const u=e.getNode(h);this.treeElementCanCollapse.set(u.collapsible&&!u.collapsed),this.treeElementHasParent.set(!!e.getParentElement(h)),this.treeElementCanExpand.set(u.collapsible&&u.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(h))},d=new Set;d.add(rhe),d.add(ahe),this.disposables.push(this.contextKeyService,r.register(e),e.onDidChangeSelection(()=>{const h=e.getSelection(),u=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(h.length>0||u.length>0),this.hasMultiSelection.set(h.length>1),this.hasDoubleSelection.set(h.length===2)})}),e.onDidChangeFocus(()=>{const h=e.getSelection(),u=e.getFocus();this.hasSelectionOrFocus.set(h.length>0||u.length>0),c()}),e.onDidChangeCollapseState(c),e.onDidChangeModel(c),e.onDidChangeFindOpenState(h=>this.treeFindOpen.set(h)),e.onDidChangeStickyScrollFocused(h=>this.treeStickyScrollFocused.set(h)),a.onDidChangeConfiguration(h=>{let u={};if(h.affectsConfiguration(Dv)&&(this._useAltAsMultipleSelectionModifier=Nh(a)),h.affectsConfiguration(yI)){const f=a.getValue(yI);u={...u,indent:f}}if(h.affectsConfiguration(N2)&&t.renderIndentGuides===void 0){const f=a.getValue(N2);u={...u,renderIndentGuides:f}}if(h.affectsConfiguration(pd)){const f=!!a.getValue(pd);u={...u,smoothScrolling:f}}if(h.affectsConfiguration(ij)||h.affectsConfiguration(T2)){const f=che(a);u={...u,defaultFindMode:f}}if(h.affectsConfiguration(nj)||h.affectsConfiguration(T2)){const f=i();u={...u,typeNavigationMode:f}}if(h.affectsConfiguration(sj)){const f=dhe(a);u={...u,defaultFindMatchType:f}}if(h.affectsConfiguration(Nl)&&t.horizontalScrolling===void 0){const f=!!a.getValue(Nl);u={...u,horizontalScrolling:f}}if(h.affectsConfiguration(md)){const f=!!a.getValue(md);u={...u,scrollByPage:f}}if(h.affectsConfiguration(R2)&&t.expandOnlyOnTwistieClick===void 0&&(u={...u,expandOnlyOnTwistieClick:a.getValue(R2)==="doubleClick"}),h.affectsConfiguration(M2)){const f=a.getValue(M2);u={...u,enableStickyScroll:f}}if(h.affectsConfiguration(A2)){const f=Math.max(1,a.getValue(A2));u={...u,stickyScrollMaxItemCount:f}}if(h.affectsConfiguration(Dh)){const f=a.getValue(Dh);u={...u,mouseWheelScrollSensitivity:f}}if(h.affectsConfiguration(Th)){const f=a.getValue(Th);u={...u,fastScrollSensitivity:f}}Object.keys(u).length>0&&e.updateOptions(u)}),this.contextKeyService.onDidChangeContext(h=>{h.affectsSome(d)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new P$e(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?Lv(e):p0)}dispose(){this.disposables=yi(this.disposables)}};iv=Pf([on(4,ut),on(5,ql),on(6,xt)],iv);const F$e=kn.as(vd.Configuration);F$e.registerConfiguration({id:"workbench",order:7,title:_(1705,"Workbench"),type:"object",properties:{[Dv]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[_(1706,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),_(1707,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:_(1708,"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[lN]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:_(1709,"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Nl]:{type:"boolean",default:!1,description:_(1710,"Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[md]:{type:"boolean",default:!1,description:_(1711,"Controls whether clicks in the scrollbar scroll page by page.")},[yI]:{type:"number",default:8,minimum:4,maximum:40,description:_(1712,"Controls tree indentation in pixels.")},[N2]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:_(1713,"Controls whether the tree should render indent guides.")},[pd]:{type:"boolean",default:!1,description:_(1714,"Controls whether lists and trees have smooth scrolling.")},[Dh]:{type:"number",default:1,markdownDescription:_(1715,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Th]:{type:"number",default:5,markdownDescription:_(1716,"Scrolling speed multiplier when pressing `Alt`.")},[ij]:{type:"string",enum:["highlight","filter"],enumDescriptions:[_(1717,"Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),_(1718,"Filter elements when searching.")],default:"highlight",description:_(1719,"Controls the default find mode for lists and trees in the workbench.")},[T2]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[_(1720,"Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),_(1721,"Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),_(1722,"Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:_(1723,"Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:_(1724,"Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[sj]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[_(1725,"Use fuzzy matching when searching."),_(1726,"Use contiguous matching when searching.")],default:"fuzzy",description:_(1727,"Controls the type of matching used when searching lists and trees in the workbench.")},[R2]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:_(1728,"Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[M2]:{type:"boolean",default:!0,description:_(1729,"Controls whether sticky scrolling is enabled in trees.")},[A2]:{type:"number",minimum:1,default:7,markdownDescription:_(1730,"Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[nj]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:_(1731,"Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});class xf{constructor(e,t,i,n){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=n,this.id=g7.nextId()}get uri(){return this.link.uri}get range(){return this._range??this.link.targetSelectionRange??this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var t;const e=(t=this.parent.getPreview(this))==null?void 0:t.preview(this.range);return e?_(1088,"{0} in {1} on line {2} at column {3}",e.value,Fl(this.uri),this.range.startLineNumber,this.range.startColumn):_(1087,"in {0} on line {1} at column {2}",Fl(this.uri),this.range.startLineNumber,this.range.startColumn)}}class B$e{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:n,startColumn:o,endLineNumber:r,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:n,column:o-t}),c=new D(n,l.startColumn,n,o),d=new D(r,a,r,1073741824),h=i.getValueInRange(c).replace(/^\s+/,""),u=i.getValueInRange(e),f=i.getValueInRange(d).replace(/\s+$/,"");return{value:h+u+f,highlight:{start:h.length,end:h.length+u.length}}}}class Hw{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new ts}dispose(){yi(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?_(1089,"1 symbol in {0}, full path {1}",Fl(this.uri),this.uri.fsPath):_(1090,"{0} symbols in {1}, full path {2}",e,Fl(this.uri),this.uri.fsPath)}async resolve(e){if(this._previews.size!==0)return this;for(const t of this.children)if(!this._previews.has(t.uri))try{const i=await e.createModelReference(t.uri);this._previews.set(t.uri,new B$e(i))}catch(i){_t(i)}return this}}class da{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new q,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(da._compareReferences);let n;for(const o of e)if((!n||!un.isEqual(n.uri,o.uri,!0))&&(n=new Hw(this,o.uri),this.groups.push(n)),n.children.length===0||da._compareReferences(o,n.children[n.children.length-1])!==0){const r=new xf(i===o,n,o,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(r),n.children.push(r)}}dispose(){yi(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new da(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?_(1091,"No results found"):this.references.length===1?_(1092,"Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?_(1093,"Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):_(1094,"Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let n=i.children.indexOf(e);const o=i.children.length,r=i.parent.groups.length;return r===1||t&&n+1<o||!t&&n>0?(t?n=(n+1)%o:n=(n+o-1)%o,i.children[n]):(n=i.parent.groups.indexOf(i),t?(n=(n+1)%r,i.parent.groups[n].children[0]):(n=(n+r-1)%r,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(e,t){const i=this.references.map((n,o)=>({idx:o,prefixLen:mc(n.uri.toString(),e.toString()),offsetDist:Math.abs(n.range.startLineNumber-t.lineNumber)*100+Math.abs(n.range.startColumn-t.column)})).sort((n,o)=>n.prefixLen>o.prefixLen?-1:n.prefixLen<o.prefixLen?1:n.offsetDist<o.offsetDist?-1:n.offsetDist>o.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&D.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return un.compare(e.uri,t.uri)||D.compareRangesUsingStarts(e.range,t.range)}}class BW extends K{constructor(e,t,i){super(),this.options=t,this.styles=i,this.count=0,this.hover=this._register(new mi),this.element=me(e,we(".monaco-count-badge")),this._register(Ve(()=>e.removeChild(this.element))),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0),this.updateHover()}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.updateHover(),this.render()}updateHover(){this.titleFormat!==""&&!this.hover.value?this.hover.value=yc().setupDelayedHoverAtMouse(this.element,()=>({content:Rb(this.titleFormat,this.count),appearance:{compact:!0}})):this.titleFormat===""&&this.hover.value&&(this.hover.value=void 0)}render(){this.element.textContent=Rb(this.countFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}class Ug extends K{constructor(e,t){super(),this.options=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.domNode=me(e,we("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n,o){e||(e=""),n&&(e=Ug.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&la(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render(o))}render(e){var n;const t=[];let i=0;for(const o of this.highlights){if(o.end===o.start)continue;if(i<o.start){const l=this.text.substring(i,o.start);e?t.push(...Hg(l)):t.push(l),i=o.start}const r=this.text.substring(i,o.end),a=we("span.highlight",void 0,...e?Hg(r):[r]);o.extraClasses&&a.classList.add(...o.extraClasses),t.push(a),i=o.end}if(i<this.text.length){const o=this.text.substring(i);e?t.push(...Hg(o)):t.push(o)}if(Os(this.domNode,...t),!this.customHover&&this.title!==""){const o=((n=this.options)==null?void 0:n.hoverDelegate)??Fh("mouse");this.customHover=this._register(yc().setupManagedHover(o,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,(o,r)=>{n=o===`\r
`?-1:0,r+=i;for(const a of t)a.end<=r||(a.start>=r&&(a.start+=n),a.end>=r&&(a.end+=n));return i+=n,"⏎"})}}class eS{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||la(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class SI extends K{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new eS(me(e,we(".monaco-icon-label")))),this.labelContainer=me(this.domNode.element,we(".monaco-icon-label-container")),this.nameContainer=me(this.labelContainer,we("span.monaco-icon-name-container")),t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=this._register(new V$e(this.nameContainer,!!t.supportIcons)):this.nameNode=new W$e(this.nameContainer),this.hoverDelegate=(t==null?void 0:t.hoverDelegate)??Fh("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){var l;const n=["monaco-icon-label"],o=["monaco-icon-label-container"];let r="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.bold&&n.push("bold"),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&o.push("disabled"),i.title&&(typeof i.title=="string"?r+=i.title:r+=e));const a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i!=null&&i.iconPath){let c;if(!a||!Bn(a)?(c=we(".monaco-icon-label-iconpath"),this.domNode.element.prepend(c)):c=a,it.isThemeIcon(i.iconPath)){const d=it.asClassName(i.iconPath);c.className=`monaco-icon-label-iconpath ${d}`,c.style.backgroundImage=""}else c.style.backgroundImage=Eh(i==null?void 0:i.iconPath);c.style.backgroundRepeat="no-repeat",c.style.backgroundPosition="center",c.style.backgroundSize="contain"}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",r),this.labelContainer.classList.value="",this.labelContainer.classList.add(...o),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const c=this.getOrCreateDescriptionNode();if(c instanceof Ug){const d=(i==null?void 0:i.supportIcons)??((l=this.creationOptions)==null?void 0:l.supportIcons);c.set(t||"",i?i.descriptionMatches:void 0,void 0,i==null?void 0:i.labelEscapeNewLines,d),this.setupHover(c.element,i==null?void 0:i.descriptionTitle)}else c.textContent=t&&(i!=null&&i.labelEscapeNewLines)?Ug.escapeNewLines(t,[]):t||"",this.setupHover(c.element,(i==null?void 0:i.descriptionTitle)||""),c.empty=!t}if(i!=null&&i.suffix||this.suffixNode){const c=this.getOrCreateSuffixNode();c.textContent=(i==null?void 0:i.suffix)??""}}setupHover(e,t){var r;const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}let n=e;if((r=this.creationOptions)!=null&&r.hoverTargetOverride){if(!Ps(e,this.creationOptions.hoverTargetOverride))throw new Error("hoverTargetOverrride must be an ancestor of the htmlElement");n=this.creationOptions.hoverTargetOverride}const o=yc().setupManagedHover(this.hoverDelegate,n,t);o&&this.customHovers.set(e,o)}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new eS(zTe(this.nameContainer,we("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new eS(me(e.element,we("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){var e;if(!this.descriptionNode){const t=this._register(new eS(me(this.labelContainer,we("span.monaco-icon-description-container"))));(e=this.creationOptions)!=null&&e.supportDescriptionHighlights?this.descriptionNode=this._register(new Ug(me(t.element,we("span.label-description")))):this.descriptionNode=this._register(new eS(me(t.element,we("span.label-description"))))}return this.descriptionNode}}class W$e{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&la(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.textContent="",this.container.classList.remove("multiple"),this.singleLabel=me(this.container,we("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.textContent="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],o=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;me(this.container,we("a.label-name",{id:o,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&me(this.container,we("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function H$e(s,e,t){if(!t)return;let i=0;return s.map(n=>{const o={start:i,end:i+n.length},r=t.map(a=>Io.intersect(o,a)).filter(a=>!Io.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=o.end+e.length,r})}class V$e extends K{constructor(e,t){super(),this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label===e&&la(this.options,t))return;this.label=e,this.options=t;const i=(t==null?void 0:t.supportIcons)??this.supportIcons;if(typeof e=="string")this.singleLabel||(this.container.textContent="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new Ug(me(this.container,we("a.label-name",{id:t==null?void 0:t.domId}))))),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines,i);else{this.container.textContent="",this.container.classList.add("multiple"),this.singleLabel=void 0;const n=(t==null?void 0:t.separator)||"/",o=H$e(e,n,t==null?void 0:t.matches);for(let r=0;r<e.length;r++){const a=e[r],l=o?o[r]:void 0,c=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${r}`,d=we("a.label-name",{id:c,"data-icon-label-count":e.length,"data-icon-label-index":r,role:"treeitem"});this._register(new Ug(me(this.container,d))).set(a,l,void 0,t==null?void 0:t.labelEscapeNewLines,i),r<e.length-1&&me(d,we("span.label-separator",void 0,n))}}}}const nv=Mt("labelService");var D4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},T4=function(s,e){return function(t,i){e(t,i,s)}},WW;let HW=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof da||e instanceof Hw}getChildren(e){if(e instanceof da)return e.groups;if(e instanceof Hw)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};HW=D4([T4(0,nr)],HW);class z$e{getHeight(){return 23}getTemplateId(e){return e instanceof Hw?O2.id:F2.id}}let VW=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof xf){const i=(t=e.parent.getPreview(e))==null?void 0:t.preview(e.range);if(i)return i.value}return Fl(e.uri)}};VW=D4([T4(0,ai)],VW);class U$e{getId(e){return e instanceof xf?e.id:e.uri}}let zW=class extends K{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new SI(i,{supportHighlights:!0})),this.badge=this._register(new BW(me(i,we(".count")),{},lce)),e.appendChild(i)}set(e,t){const i=NO(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat(_(1081,"{0} references",n)):this.badge.setTitleFormat(_(1082,"{0} reference",n))}};zW=D4([T4(1,nv)],zW);var M_;let O2=(M_=class{constructor(e){this._instantiationService=e,this.templateId=WW.id}renderTemplate(e){return this._instantiationService.createInstance(zW,e)}renderElement(e,t,i){i.set(e.element,Sk(e.filterData))}disposeTemplate(e){e.dispose()}},WW=M_,M_.id="FileReferencesRenderer",M_);O2=WW=D4([T4(0,$e)],O2);class $$e extends K{constructor(e){super(),this.label=this._register(new Ug(e))}set(e,t){var n;const i=(n=e.parent.getPreview(e))==null?void 0:n.preview(e.range);if(!i||!i.value)this.label.set(`${Fl(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:o,highlight:r}=i;t&&!fc.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(o,Sk(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(o,[r]))}}}const qA=class qA{constructor(){this.templateId=qA.id}renderTemplate(e){return new $$e(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}};qA.id="OneReferenceRenderer";let F2=qA;class q$e{getWidgetAriaLabel(){return _(1083,"References")}getAriaLabel(e){return e.ariaMessage}}var hhe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},lp=function(s,e){return function(t,i){e(t,i,s)}};const jA=class jA{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new oe,this._callOnModelChange=new oe,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(const t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let n=0,o=e.children.length;n<o;n++){const r=e.children[n];this._decorationIgnoreSet.has(r.id)||r.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:r.range,options:jA.DecorationOptions}),i.push(n))}this._editor.changeDecorations(n=>{const o=n.deltaDecorations([],t);for(let r=0;r<o.length;r++)this._decorations.set(o[r],e.children[i[r]])})}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,n]of this._decorations){const o=t.getDecorationRange(i);if(!o)continue;let r=!1;if(!D.equalsRange(o,n.range)){if(D.spansMultipleLines(o))r=!0;else{const a=n.range.endColumn-n.range.startColumn,l=o.endColumn-o.startColumn;a!==l&&(r=!0)}r?(this._decorationIgnoreSet.add(n.id),e.push(i)):n.range=o}}for(let i=0,n=e.length;i<n;i++)this._decorations.delete(e[i]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}};jA.DecorationOptions=vt.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});let UW=jA;class j$e{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const n=JSON.parse(e);t=n.ratio,i=n.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class K$e extends FW{}let $W=class{constructor(e){this.labelService=e,this.disposables=new oe}getDragURI(e){return e instanceof Hw?e.uri.toString():e instanceof xf?yHe(e.uri,e.range).toString():null}getDragLabel(e){return e.length===0?void 0:e.map(i=>this.labelService.getUriBasenameLabel(i.uri)).join(", ")}onDragStart(e,t){if(!t.dataTransfer)return;const n=e.elements.map(o=>this.getDragURI(o)).filter(Boolean);n.length&&(t.dataTransfer.setData(zb.RESOURCES,JSON.stringify(n)),t.dataTransfer.setData(zb.TEXT,n.join(`
`)))}onDragOver(){return!1}drop(){}dispose(){this.disposables.dispose()}};$W=hhe([lp(0,nv)],$W);let qW=class extends E2{constructor(e,t,i,n,o,r,a,l,c){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=o,this._instantiationService=r,this._peekViewService=a,this._uriLabel=l,this._keybindingService=c,this._disposeOnNewModel=new oe,this._callOnDispose=new oe,this._onDidSelectReference=new q,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new wi(0,0),this._isClosing=!1,this._applyTheme(n.getColorTheme()),this._callOnDispose.add(n.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}get isClosing(){return this._isClosing}dispose(){this._isClosing=!0,this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),yi(this._preview),yi(this._previewNotAvailableMessage),yi(this._tree),yi(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(PUe)||re.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(AUe)||re.transparent,primaryHeadingColor:e.getColor(zde),secondaryHeadingColor:e.getColor(Ude)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=me(e,we("div.messages")),hr(this._messageContainer),this._splitView=new qde(e,{orientation:1}),this._previewContainer=me(e,we("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(Sf,this._previewContainer,t,{},this.editor),hr(this._previewContainer),this._previewNotAvailableMessage=this._instantiationService.createInstance(Hb,_(1084,"no preview available"),Za,Hb.DEFAULT_CREATION_OPTIONS,null),this._treeContainer=me(e,we("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new q$e,keyboardNavigationLabelProvider:this._instantiationService.createInstance(VW),identityProvider:new U$e,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:OUe},dnd:this._instantiationService.createInstance($W)};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(Jn(this._treeContainer,"keydown",o=>{o.equals(9)&&(this._keybindingService.dispatchEvent(o,o.target),o.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(K$e,"ReferencesWidget",this._treeContainer,new z$e,[this._instantiationService.createInstance(O2),this._instantiationService.createInstance(F2)],this._instantiationService.createInstance(HW),i),this._splitView.addView({onDidChange:Se.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:o=>{this._preview.layout({height:this._dim.height,width:o})}},k2.Distribute),this._splitView.addView({onDidChange:Se.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:o=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${o}px`,this._tree.layout(this._dim.height,o)}},k2.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const n=(o,r)=>{o instanceof xf&&(r==="show"&&this._revealReference(o,!1),this._onDidSelectReference.fire({element:o,kind:r,source:"tree"}))};this._disposables.add(this._tree.onDidOpen(o=>{o.sideBySide?n(o.element,"side"):o.editorOptions.pinned?n(o.element,"goto"):n(o.element,"show")})),hr(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new wi(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=_(1085,"No results"),ta(this._messageContainer),Promise.resolve(void 0)):(hr(this._messageContainer),this._decorationsManager=new UW(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const n=this._getFocusedReference();n&&this._onDidSelectReference.fire({element:{uri:n.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),ta(this._treeContainer),ta(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof xf)return e;if(e instanceof Hw&&e.children.length>0)return e.children[0]}async revealReference(e){await this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}async _revealReference(e,t){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==ct.inMemory?this.setTitle(ENe(e.uri),this._uriLabel.getUriLabel(NO(e.uri))):this.setTitle(_(1086,"References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),await this._tree.expand(e.parent),this._tree.reveal(e));const n=await i;if(!this._model){n.dispose();return}yi(this._previewModelReference);const o=n.object;if(o){const r=this._preview.getModel()===o.textEditorModel?0:1,a=D.lift(e.range).collapseToStart();this._previewModelReference=n,this._preview.setModel(o.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,r)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()}};qW=hhe([lp(3,Dn),lp(4,nr),lp(5,$e),lp(6,Vde),lp(7,nv),lp(8,ai)],qW);var G$e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Jv=function(s,e){return function(t,i){e(t,i,s)}},cN;const Tv=new Ne("referenceSearchVisible",!1,_(1078,"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));var A_;let sv=(A_=class{static get(e){return e.getContribution(cN.ID)}constructor(e,t,i,n,o,r,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=n,this._notificationService=o,this._instantiationService=r,this._storageService=a,this._configurationService=l,this._disposables=new oe,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=Tv.bindTo(i)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),(e=this._widget)==null||e.dispose(),(t=this._model)==null||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&e.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const o="peekViewLayout",r=j$e.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(qW,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(_(1079,"Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget?(this._storageService.store(o,JSON.stringify(this._widget.layoutData),0,1),this._widget.isClosing||this.closeWidget(),this._widget=void 0):this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{const{element:c,kind:d}=l;if(c)switch(d){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c,!0):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{var c;if(a!==this._requestIdPool||!this._widget){l.dispose();return}return(c=this._model)==null||c.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(_(1080,"{0} ({1})",this._model.title,this._model.references.length));const d=this._editor.getModel().uri,h=new z(e.startLineNumber,e.startColumn),u=this._model.nearestReference(d,h);if(u)return this._widget.setSelection(u).then(()=>{this._widget&&this._editor.getOption(99)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}async goToNextOrPreviousReference(e){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const n=this._model.nextOrPreviousReference(i,e),o=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();await this._widget.setSelection(n),await this._gotoReference(n,!1),o?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}async revealReference(e){!this._editor.hasModel()||!this._model||!this._widget||await this._widget.revealReference(e)}closeWidget(e=!0){var t,i;(t=this._widget)==null||t.dispose(),(i=this._model)==null||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){var n;(n=this._widget)==null||n.hide(),this._ignoreModelChangeEvent=!0;const i=D.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:i,selectionSource:"code.jump",pinned:t}},this._editor).then(o=>{if(this._ignoreModelChangeEvent=!1,!o||!this._widget){this.closeWidget();return}if(this._editor===o)this._widget.show(i),this._widget.focusOnReferenceTree();else{const r=cN.get(o),a=this._model.clone();this.closeWidget(),o.focus(),r==null||r.toggleWidget(i,ys(l=>Promise.resolve(a)),this._peekMode??!1)}},o=>{this._ignoreModelChangeEvent=!1,_t(o)})}openReference(e,t,i){t||this.closeWidget();const{uri:n,range:o}=e;this._editorService.openCodeEditor({resource:n,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor,t)}},cN=A_,A_.ID="editor.contrib.referencesController",A_);sv=cN=G$e([Jv(2,ut),Jv(3,ii),Jv(4,Hn),Jv(5,$e),Jv(6,sr),Jv(7,xt)],sv);function Nv(s,e){const t=Bde(s);if(!t)return;const i=sv.get(t);i&&e(i)}Ks.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:ls(2089,60),when:de.or(Tv,Ur.inPeekEditor),handler(s){Nv(s,e=>{e.changeFocusBetweenPreviewAndReferences()})}});Ks.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:de.or(Tv,Ur.inPeekEditor),handler(s){Nv(s,e=>{e.goToNextOrPreviousReference(!0)})}});Ks.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:de.or(Tv,Ur.inPeekEditor),handler(s){Nv(s,e=>{e.goToNextOrPreviousReference(!1)})}});Zt.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");Zt.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");Zt.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");Zt.registerCommand("closeReferenceSearch",s=>Nv(s,e=>e.closeWidget()));Ks.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:de.and(Ur.inPeekEditor,de.not("config.editor.stablePeek"))});Ks.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:de.and(Tv,de.not("config.editor.stablePeek"),de.or(B.editorTextFocus,Xq.negate()))});Ks.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:de.and(Tv,ohe,ej.negate(),tj.negate()),handler(s){var i;const t=(i=s.get(ql).lastFocusedList)==null?void 0:i.getFocus();Array.isArray(t)&&t[0]instanceof xf&&Nv(s,n=>n.revealReference(t[0]))}});Ks.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:de.and(Tv,ohe,ej.negate(),tj.negate()),handler(s){var i;const t=(i=s.get(ql).lastFocusedList)==null?void 0:i.getFocus();Array.isArray(t)&&t[0]instanceof xf&&Nv(s,n=>n.openReference(t[0],!0,!0))}});Zt.registerCommand("openReference",s=>{var i;const t=(i=s.get(ql).lastFocusedList)==null?void 0:i.getFocus();Array.isArray(t)&&t[0]instanceof xf&&Nv(s,n=>n.openReference(t[0],!1,!0))});var uhe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ES=function(s,e){return function(t,i){e(t,i,s)}};const rj=new Ne("hasSymbols",!1,_(1095,"Whether there are symbol locations that can be navigated via keyboard-only.")),N4=Mt("ISymbolNavigationService");let jW=class{constructor(e,t,i,n){this._editorService=t,this._notificationService=i,this._keybindingService=n,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=rj.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),(e=this._currentState)==null||e.dispose(),(t=this._currentMessage)==null||t.close(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new KW(this._editorService),n=i.onDidChange(o=>{if(this._ignoreEditorChange)return;const r=this._editorService.getActiveCodeEditor();if(!r)return;const a=r.getModel(),l=r.getPosition();if(!a||!l)return;let c=!1,d=!1;for(const h of t.references)if(gm(h.uri,a.uri))c=!0,d=d||D.containsPosition(h.range,l);else if(c)break;(!c||!d)&&this.reset()});this._currentState=dc(i,n)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:D.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var i;(i=this._currentMessage)==null||i.close();const e=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),t=e?_(1096,"Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,e.getLabel()):_(1097,"Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(t)}};jW=uhe([ES(0,ut),ES(1,ii),ES(2,Hn),ES(3,ai)],jW);Vt(N4,jW,1);Te(new class extends Is{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:rj,kbOpts:{weight:100,primary:70}})}runEditorCommand(s,e){return s.get(N4).revealNext(e)}});Ks.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:rj,primary:9,handler(s){s.get(N4).reset()}});let KW=class{constructor(e){this._listener=new Map,this._disposables=new oe,this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),yi(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,dc(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){var t;(t=this._listener.get(e))==null||t.dispose(),this._listener.delete(e)}};KW=uhe([ES(0,ii)],KW);function GW(s,e){return e.uri.scheme===s.uri.scheme?!0:!R9(e.uri,ct.walkThroughSnippet,ct.vscodeChatCodeBlock,ct.vscodeChatCodeCompareBlock)}async function Bk(s,e,t,i,n){const r=t.ordered(s,i).map(l=>Promise.resolve(n(l,s,e)).then(void 0,c=>{as(c)})),a=await Promise.all(r);return bd(a.flat()).filter(l=>GW(s,l))}function Wk(s,e,t,i,n){return Bk(e,t,s,i,(o,r,a)=>o.provideDefinition(r,a,n))}function aj(s,e,t,i,n){return Bk(e,t,s,i,(o,r,a)=>o.provideDeclaration(r,a,n))}function lj(s,e,t,i,n){return Bk(e,t,s,i,(o,r,a)=>o.provideImplementation(r,a,n))}function cj(s,e,t,i,n){return Bk(e,t,s,i,(o,r,a)=>o.provideTypeDefinition(r,a,n))}function Hk(s,e,t,i,n,o){return Bk(e,t,s,n,async(r,a,l)=>{var h,u;const c=(h=await r.provideReferences(a,l,{includeDeclaration:!0},o))==null?void 0:h.filter(f=>GW(a,f));if(!i||!c||c.length!==2)return c;const d=(u=await r.provideReferences(a,l,{includeDeclaration:!1},o))==null?void 0:u.filter(f=>GW(a,f));return d&&d.length===1?d:c})}async function Hh(s){const e=await s(),t=new da(e,""),i=t.references.map(n=>n.link);return t.dispose(),i}qr("_executeDefinitionProvider",(s,e,t)=>{const i=s.get(We),n=Wk(i.definitionProvider,e,t,!1,Ft.None);return Hh(()=>n)});qr("_executeDefinitionProvider_recursive",(s,e,t)=>{const i=s.get(We),n=Wk(i.definitionProvider,e,t,!0,Ft.None);return Hh(()=>n)});qr("_executeTypeDefinitionProvider",(s,e,t)=>{const i=s.get(We),n=cj(i.typeDefinitionProvider,e,t,!1,Ft.None);return Hh(()=>n)});qr("_executeTypeDefinitionProvider_recursive",(s,e,t)=>{const i=s.get(We),n=cj(i.typeDefinitionProvider,e,t,!0,Ft.None);return Hh(()=>n)});qr("_executeDeclarationProvider",(s,e,t)=>{const i=s.get(We),n=aj(i.declarationProvider,e,t,!1,Ft.None);return Hh(()=>n)});qr("_executeDeclarationProvider_recursive",(s,e,t)=>{const i=s.get(We),n=aj(i.declarationProvider,e,t,!0,Ft.None);return Hh(()=>n)});qr("_executeReferenceProvider",(s,e,t)=>{const i=s.get(We),n=Hk(i.referenceProvider,e,t,!1,!1,Ft.None);return Hh(()=>n)});qr("_executeReferenceProvider_recursive",(s,e,t)=>{const i=s.get(We),n=Hk(i.referenceProvider,e,t,!1,!0,Ft.None);return Hh(()=>n)});qr("_executeImplementationProvider",(s,e,t)=>{const i=s.get(We),n=lj(i.implementationProvider,e,t,!1,Ft.None);return Hh(()=>n)});qr("_executeImplementationProvider_recursive",(s,e,t)=>{const i=s.get(We),n=lj(i.implementationProvider,e,t,!0,Ft.None);return Hh(()=>n)});qs.appendMenuItem(He.EditorContext,{submenu:He.EditorContextPeek,title:_(1038,"Peek"),group:"navigation",order:100});class Vw{static is(e){return!e||typeof e!="object"?!1:!!(e instanceof Vw||z.isIPosition(e.position)&&e.model)}constructor(e,t){this.model=e,this.position=t}}const Jl=class Jl extends wc{static all(){return Jl._allSymbolNavigationCommands.values()}static _patchConfig(e){const t={...e,f1:!0};if(t.menu)for(const i of Gt.wrap(t.menu))(i.id===He.EditorContext||i.id===He.EditorContextPeek)&&(i.when=de.and(e.precondition,i.when));return t}constructor(e,t){super(Jl._patchConfig(t)),this.configuration=e,Jl._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,n){if(!t.hasModel())return Promise.resolve(void 0);const o=e.get(Hn),r=e.get(ii),a=e.get(vf),l=e.get(N4),c=e.get(We),d=e.get($e),h=t.getModel(),u=t.getPosition(),f=Vw.is(i)?i:new Vw(h,u),g=new Cf(t,5),m=mw(this._getLocationModel(c,f.model,f.position,g.token),g.token).then(async p=>{var w;if(!p||g.token.isCancellationRequested)return;br(p.ariaMessage);let v;if(p.referenceAt(h.uri,u)){const C=this._getAlternativeCommand(t);C!==void 0&&!Jl._activeAlternativeCommands.has(C)&&Jl._allSymbolNavigationCommands.has(C)&&(v=Jl._allSymbolNavigationCommands.get(C))}const b=p.references.length;if(b===0){if(!this.configuration.muteMessage){const C=h.getWordAtPosition(u);(w=ca.get(t))==null||w.showMessage(this._getNoResultFoundMessage(C),u)}}else if(b===1&&v)Jl._activeAlternativeCommands.add(this.desc.id),d.invokeFunction(C=>v.runEditorCommand(C,t,i,n).finally(()=>{Jl._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(r,l,t,p,n)},p=>{o.error(p)}).finally(()=>{g.dispose()});return a.showWhile(m,250),m}async _onResult(e,t,i,n,o){const r=this._getGoToPreference(i);if(!(i instanceof Sf)&&(this.configuration.openInPeek||r==="peek"&&n.references.length>1))this._openInPeek(i,n,o);else{const a=n.firstReference(),l=n.references.length>1&&r==="gotoAndPeek",c=await this._openReference(i,e,a,this.configuration.openToSide,!l);l&&c?this._openInPeek(c,n,o):n.dispose(),r==="goto"&&t.put(a)}}async _openReference(e,t,i,n,o){let r;if(E4e(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const a=await t.openCodeEditor({resource:i.uri,options:{selection:D.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,n);if(a){if(o){const l=a.getModel(),c=a.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&c.clear()},350)}return a}}_openInPeek(e,t,i){const n=sv.get(e);n&&e.hasModel()?n.toggleWidget(i??e.getSelection(),ys(o=>Promise.resolve(t)),this.configuration.openInPeek):t.dispose()}};Jl._allSymbolNavigationCommands=new Map,Jl._activeAlternativeCommands=new Set;let Lf=Jl;class Vk extends Lf{async _getLocationModel(e,t,i,n){return new da(await Wk(e.definitionProvider,t,i,!1,n),_(1039,"Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?_(1040,"No definition found for '{0}'",e.word):_(1041,"No definition found")}_getAlternativeCommand(e){return e.getOption(67).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(67).multipleDefinitions}}var Qg;Ei((Qg=class extends Vk{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Qg.id,title:{...ne(1065,"Go to Definition"),mnemonicTitle:_(1042,"Go to &&Definition")},precondition:B.hasDefinitionProvider,keybinding:[{when:B.editorTextFocus,primary:70,weight:100},{when:de.and(B.editorTextFocus,the),primary:2118,weight:100}],menu:[{id:He.EditorContext,group:"navigation",order:1.1},{id:He.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),Zt.registerCommandAlias("editor.action.goToDeclaration",Qg.id)}},Qg.id="editor.action.revealDefinition",Qg));var Jg;Ei((Jg=class extends Vk{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:Jg.id,title:ne(1066,"Open Definition to the Side"),precondition:de.and(B.hasDefinitionProvider,B.isInEmbeddedEditor.toNegated()),keybinding:[{when:B.editorTextFocus,primary:ls(2089,70),weight:100},{when:de.and(B.editorTextFocus,the),primary:ls(2089,2118),weight:100}]}),Zt.registerCommandAlias("editor.action.openDeclarationToTheSide",Jg.id)}},Jg.id="editor.action.revealDefinitionAside",Jg));var em;Ei((em=class extends Vk{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:em.id,title:ne(1067,"Peek Definition"),precondition:de.and(B.hasDefinitionProvider,Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated()),keybinding:{when:B.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:He.EditorContextPeek,group:"peek",order:2}}),Zt.registerCommandAlias("editor.action.previewDeclaration",em.id)}},em.id="editor.action.peekDefinition",em));class fhe extends Lf{async _getLocationModel(e,t,i,n){return new da(await aj(e.declarationProvider,t,i,!1,n),_(1043,"Declarations"))}_getNoResultFoundMessage(e){return e&&e.word?_(1044,"No declaration found for '{0}'",e.word):_(1045,"No declaration found")}_getAlternativeCommand(e){return e.getOption(67).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(67).multipleDeclarations}}var P_;Ei((P_=class extends fhe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:P_.id,title:{...ne(1068,"Go to Declaration"),mnemonicTitle:_(1046,"Go to &&Declaration")},precondition:de.and(B.hasDeclarationProvider,B.isInEmbeddedEditor.toNegated()),menu:[{id:He.EditorContext,group:"navigation",order:1.3},{id:He.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?_(1047,"No declaration found for '{0}'",e.word):_(1048,"No declaration found")}},P_.id="editor.action.revealDeclaration",P_));Ei(class extends fhe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:ne(1069,"Peek Declaration"),precondition:de.and(B.hasDeclarationProvider,Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated()),menu:{id:He.EditorContextPeek,group:"peek",order:3}})}});class ghe extends Lf{async _getLocationModel(e,t,i,n){return new da(await cj(e.typeDefinitionProvider,t,i,!1,n),_(1049,"Type Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?_(1050,"No type definition found for '{0}'",e.word):_(1051,"No type definition found")}_getAlternativeCommand(e){return e.getOption(67).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(67).multipleTypeDefinitions}}var O_;Ei((O_=class extends ghe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:O_.ID,title:{...ne(1070,"Go to Type Definition"),mnemonicTitle:_(1052,"Go to &&Type Definition")},precondition:B.hasTypeDefinitionProvider,keybinding:{when:B.editorTextFocus,primary:0,weight:100},menu:[{id:He.EditorContext,group:"navigation",order:1.4},{id:He.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},O_.ID="editor.action.goToTypeDefinition",O_));var F_;Ei((F_=class extends ghe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:F_.ID,title:ne(1071,"Peek Type Definition"),precondition:de.and(B.hasTypeDefinitionProvider,Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated()),menu:{id:He.EditorContextPeek,group:"peek",order:4}})}},F_.ID="editor.action.peekTypeDefinition",F_));class mhe extends Lf{async _getLocationModel(e,t,i,n){return new da(await lj(e.implementationProvider,t,i,!1,n),_(1053,"Implementations"))}_getNoResultFoundMessage(e){return e&&e.word?_(1054,"No implementation found for '{0}'",e.word):_(1055,"No implementation found")}_getAlternativeCommand(e){return e.getOption(67).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(67).multipleImplementations}}var B_;Ei((B_=class extends mhe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:B_.ID,title:{...ne(1072,"Go to Implementations"),mnemonicTitle:_(1056,"Go to &&Implementations")},precondition:B.hasImplementationProvider,keybinding:{when:B.editorTextFocus,primary:2118,weight:100},menu:[{id:He.EditorContext,group:"navigation",order:1.45},{id:He.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},B_.ID="editor.action.goToImplementation",B_));var W_;Ei((W_=class extends mhe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:W_.ID,title:ne(1073,"Peek Implementations"),precondition:de.and(B.hasImplementationProvider,Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated()),keybinding:{when:B.editorTextFocus,primary:3142,weight:100},menu:{id:He.EditorContextPeek,group:"peek",order:5}})}},W_.ID="editor.action.peekImplementation",W_));class phe extends Lf{_getNoResultFoundMessage(e){return e?_(1057,"No references found for '{0}'",e.word):_(1058,"No references found")}_getAlternativeCommand(e){return e.getOption(67).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(67).multipleReferences}}Ei(class extends phe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{...ne(1074,"Go to References"),mnemonicTitle:_(1059,"Go to &&References")},precondition:de.and(B.hasReferenceProvider,Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated()),keybinding:{when:B.editorTextFocus,primary:1094,weight:100},menu:[{id:He.EditorContext,group:"navigation",order:1.45},{id:He.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}async _getLocationModel(e,t,i,n){return new da(await Hk(e.referenceProvider,t,i,!0,!1,n),_(1060,"References"))}});Ei(class extends phe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:ne(1075,"Peek References"),precondition:de.and(B.hasReferenceProvider,Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated()),menu:{id:He.EditorContextPeek,group:"peek",order:6}})}async _getLocationModel(e,t,i,n){return new da(await Hk(e.referenceProvider,t,i,!1,!1,n),_(1061,"References"))}});class Y$e extends Lf{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:ne(1076,"Go to Any Symbol"),precondition:de.and(Ur.notInPeekEditor,B.isInEmbeddedEditor.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}async _getLocationModel(e,t,i,n){return new da(this._references,_(1062,"Locations"))}_getNoResultFoundMessage(e){return e&&_(1063,"No results for '{0}'",e.word)||""}_getGoToPreference(e){return this._gotoMultipleBehaviour??e.getOption(67).multipleReferences}_getAlternativeCommand(){}}Zt.registerCommand({id:"editor.action.goToLocations",metadata:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Ze},{name:"position",description:"The position at which to start",constraint:z.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:async(s,e,t,i,n,o,r)=>{ti(Ze.isUri(e)),ti(z.isIPosition(t)),ti(Array.isArray(i)),ti(typeof n>"u"||typeof n=="string"),ti(typeof r>"u"||typeof r=="boolean");const a=s.get(ii),l=await a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(gd(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const d=new class extends Y$e{_getNoResultFoundMessage(h){return o||super._getNoResultFoundMessage(h)}}({muteMessage:!o,openInPeek:!!r,openToSide:!1},i,n);c.get($e).invokeFunction(d.run.bind(d),l)})}});Zt.registerCommand({id:"editor.action.peekLocations",metadata:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:Ze},{name:"position",description:"The position at which to start",constraint:z.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"}]},handler:async(s,e,t,i,n)=>{s.get(en).executeCommand("editor.action.goToLocations",e,t,i,n,void 0,!0)}});Zt.registerCommand({id:"editor.action.findReferences",handler:(s,e,t)=>{ti(Ze.isUri(e)),ti(z.isIPosition(t));const i=s.get(We),n=s.get(ii);return n.openCodeEditor({resource:e},n.getFocusedCodeEditor()).then(o=>{if(!gd(o)||!o.hasModel())return;const r=sv.get(o);if(!r)return;const a=ys(c=>Hk(i.referenceProvider,o.getModel(),z.lift(t),!1,!1,c).then(d=>new da(d,_(1064,"References")))),l=new D(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(r.toggleWidget(l,a,!1))})}});Zt.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");async function X$e(s,e,t,i){const n=s.get(nr),o=s.get(sl),r=s.get(en),a=s.get($e),l=s.get(Hn);if(await i.item.resolve(Ft.None),!i.part.location)return;const c=i.part.location,d=[],h=new Set(qs.getMenuItems(He.EditorContext).map(f=>f1(f)?f.command.id:wv()));for(const f of Lf.all())h.has(f.desc.id)&&d.push(new Ga(f.desc.id,Ya.label(f.desc,{renderShortTitle:!0}),void 0,!0,async()=>{const g=await n.createModelReference(c.uri);try{const m=new Vw(g.object.textEditorModel,D.getStartPosition(c.range)),p=i.item.anchor.range;await a.invokeFunction(f.runEditorCommand.bind(f),e,m,p)}finally{g.dispose()}}));if(i.part.command){const{command:f}=i.part;d.push(new _s),d.push(new Ga(f.id,f.title,void 0,!0,async()=>{try{await r.executeCommand(f.id,...f.arguments??[])}catch(g){l.notify({severity:f0.Error,source:i.item.provider.displayName,message:g})}}))}const u=e.getOption(144);o.showContextMenu({domForShadowRoot:u?e.getDomNode()??void 0:void 0,getAnchor:()=>{const f=Fn(t);return{x:f.left,y:f.top+f.height+8}},getActions:()=>d,onHide:()=>{e.focus()},autoSelectFirstItem:!0})}async function _he(s,e,t,i){const o=await s.get(nr).createModelReference(i.uri);await t.invokeWithinContext(async r=>{const a=e.hasSideBySideModifier,l=r.get(ut),c=Ur.inPeekEditor.getValue(l),d=!a&&t.getOption(101)&&!c;return new Vk({openToSide:a,openInPeek:d,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(r,new Vw(o.object.textEditorModel,D.getStartPosition(i.range)),D.lift(i.range))}),o.dispose()}var Z$e=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},eC=function(s,e){return function(t,i){e(t,i,s)}},bC;class B2{constructor(){this._entries=new Cc(50)}get(e){const t=B2._key(e);return this._entries.get(t)}set(e,t){const i=B2._key(e);this._entries.set(i,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const bhe=Mt("IInlayHintsCache");Vt(bhe,B2,1);class YW{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return typeof e=="string"?{label:e}:e[this.index]}}class Q$e{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}class J$e{constructor(){this._store=new mi,this._tokenSource=new hn}dispose(){this._store.dispose(),this._tokenSource.dispose(!0)}reset(){return this._tokenSource.dispose(!0),this._tokenSource=new hn,this._store.value=new oe,{store:this._store.value,token:this._tokenSource.token}}}var ju;let xI=(ju=class{static get(e){return e.getContribution(bC.ID)??void 0}constructor(e,t,i,n,o,r,a){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=o,this._notificationService=r,this._instaService=a,this._disposables=new oe,this._sessionDisposables=new oe,this._decorationsMetadata=new Map,this._activeRenderMode=0,this._ruleFactory=this._disposables.add(new vR(this._editor)),this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange(()=>this._update())),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(l=>{l.hasChanged(159)&&this._update()})),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(159);if(e.enabled==="off")return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;if(e.enabled==="on")this._activeRenderMode=0;else{let c,d;e.enabled==="onUnlessPressed"?(c=0,d=1):(c=1,d=0),this._activeRenderMode=c,this._sessionDisposables.add(Au.getInstance().event(h=>{if(!this._editor.hasModel())return;const u=h.altKey&&h.ctrlKey&&!(h.shiftKey||h.metaKey)?d:c;if(u!==this._activeRenderMode){this._activeRenderMode=u;const f=this._editor.getModel(),g=this._copyInlayHintsWithCurrentAnchor(f);this._updateHintsDecorators([f.getFullModelRange()],g),a.schedule(0)}}))}const i=this._inlayHintsCache.get(t);i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add(Ve(()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)}));let n;const o=new Set;this._sessionDisposables.add(t.onWillDispose(()=>n==null?void 0:n.cancel()));const r=this._sessionDisposables.add(new J$e),a=new Ni(async()=>{const c=Date.now(),{store:d,token:h}=r.reset();try{const u=await L2.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),h);if(a.delay=this._debounceInfo.update(t,Date.now()-c),h.isCancellationRequested){u.dispose();return}for(const f of u.provider)typeof f.onDidChangeInlayHints=="function"&&!o.has(f)&&(o.add(f),d.add(f.onDidChangeInlayHints(()=>{a.isScheduled()||a.schedule()})));d.add(u),this._updateHintsDecorators(u.ranges,u.items),this._cacheHintsForFastRestore(t)}catch(u){_t(u)}},this._debounceInfo.get(t));this._sessionDisposables.add(a),a.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange(c=>{(c.scrollTopChanged||!a.isScheduled())&&a.schedule()}));const l=this._sessionDisposables.add(new mi);this._sessionDisposables.add(this._editor.onDidChangeModelContent(c=>{const d=Math.max(a.delay,800);this._cursorInfo={position:this._editor.getPosition(),notEarlierThan:Date.now()+d},l.value=cf(()=>a.schedule(0),d),a.schedule()})),this._sessionDisposables.add(this._editor.onDidChangeConfiguration(c=>{c.hasChanged(159)&&a.schedule()})),this._sessionDisposables.add(this._installDblClickGesture(()=>a.schedule(0))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new oe,t=e.add(new y4(this._editor)),i=new oe;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown(n=>{const[o]=n,r=this._getInlayHintLabelPart(o),a=this._editor.getModel();if(!r||!a){i.clear();return}const l=new hn;i.add(Ve(()=>l.dispose(!0))),r.item.resolve(l.token),this._activeInlayHintPart=r.part.command||r.part.location?new Q$e(r,o.hasTriggerModifier):void 0;const c=a.validatePosition(r.item.hint.position).lineNumber,d=new D(c,1,c,a.getLineMaxColumn(c)),h=this._getInlineHintsForRange(d);this._updateHintsDecorators([d],h),i.add(Ve(()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([d],h)}))})),e.add(t.onCancel(()=>i.clear())),e.add(t.onExecute(async n=>{const o=this._getInlayHintLabelPart(n);if(o){const r=o.part;r.location?this._instaService.invokeFunction(_he,n,this._editor,r.location):DB.is(r.command)&&await this._invokeCommand(r.command,o.item)}})),e}_getInlineHintsForRange(e){const t=new Set;for(const i of this._decorationsMetadata.values())e.containsRange(i.item.anchor.range)&&t.add(i.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp(async t=>{if(t.event.detail!==2)return;const i=this._getInlayHintLabelPart(t);if(i&&(t.event.preventDefault(),await i.item.resolve(Ft.None),er(i.item.hint.textEdits))){const n=i.item.hint.textEdits.map(o=>Pn.replace(D.lift(o.range),o.text));this._editor.executeEdits("inlayHint.default",n),e()}})}_installContextMenu(){return this._editor.onContextMenu(async e=>{if(!Bn(e.event.target))return;const t=this._getInlayHintLabelPart(e);t&&await this._instaService.invokeFunction(X$e,this._editor,e.event.target,t)})}_getInlayHintLabelPart(e){var i;if(e.target.type!==6)return;const t=(i=e.target.detail.injectedText)==null?void 0:i.options;if(t instanceof Cm&&(t==null?void 0:t.attachedData)instanceof YW)return t.attachedData}async _invokeCommand(e,t){try{await this._commandService.executeCommand(e.id,...e.arguments??[])}catch(i){this._notificationService.notify({severity:f0.Error,source:t.provider.displayName,message:i})}}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;const o=e.getDecorationRange(i);if(o){const r=new Ode(o,n.item.anchor.direction),a=n.item.with({anchor:r});t.set(n.item,a)}}return Array.from(t.values())}_getHintsRanges(){const t=this._editor.getModel(),i=this._editor.getVisibleRangesPlusViewportAboveBelow(),n=[];for(const o of i.sort(D.compareRangesUsingStarts)){const r=t.validateRange(new D(o.startLineNumber-30,o.startColumn,o.endLineNumber+30,o.endColumn));n.length===0||!D.areIntersectingOrTouching(n[n.length-1],r)?n.push(r):n[n.length-1]=D.plusRange(n[n.length-1],r)}return n}_updateHintsDecorators(e,t){var p,v;const i=new Map;if(this._cursorInfo&&this._cursorInfo.notEarlierThan>Date.now()&&e.some(b=>b.containsPosition(this._cursorInfo.position))){const{position:b}=this._cursorInfo;this._cursorInfo=void 0;const w=new Map;for(const S of this._editor.getLineDecorations(b.lineNumber)??[]){const L=this._decorationsMetadata.get(S.id);if(S.range.startColumn>b.column)continue;const E=L==null?void 0:L.decoration.options[L.item.anchor.direction];if(E&&E.attachedData!==bC._whitespaceData){const M=w.get(L.item)??0;w.set(L.item,M+E.content.length)}}const C=t.filter(S=>S.anchor.range.startLineNumber===b.lineNumber&&S.anchor.range.endColumn<=b.column),y=Array.from(w.values());let x;for(;;){const S=C.shift(),L=y.shift();if(!L&&!S)break;if(S)i.set(S,L??0),x=S;else if(x&&L){let E=i.get(x);E+=L,E+=y.reduce((M,R)=>M+R,0),y.length=0;break}}}const n=[],o=(b,w,C,y,x)=>{const S={content:C,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:w.className,cursorStops:y,attachedData:x};n.push({item:b,classNameRef:w,decoration:{range:b.anchor.range,options:{description:"InlayHint",showIfCollapsed:b.anchor.range.isEmpty(),collapseOnReplaceEdit:!b.anchor.range.isEmpty(),stickiness:0,[b.anchor.direction]:this._activeRenderMode===0?S:void 0}}})},r=(b,w)=>{const C=this._ruleFactory.createClassNameRef({width:`${a/3|0}px`,display:"inline-block"});o(b,C," ",w?wl.Right:wl.None,bC._whitespaceData)},{fontSize:a,fontFamily:l,padding:c,isUniform:d}=this._getLayoutInfo(),h=this._editor.getOption(159).maximumLength,u="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(u,l);let f={line:0,totalLen:0};for(let b=0;b<t.length;b++){const w=t[b];if(f.line!==w.anchor.range.startLineNumber&&(f={line:w.anchor.range.startLineNumber,totalLen:0}),h&&f.totalLen>h)continue;w.hint.paddingLeft&&r(w,!1);const C=typeof w.hint.label=="string"?[{label:w.hint.label}]:w.hint.label,y=i.get(w);let x=0;for(let S=0;S<C.length;S++){const L=C[S],E=S===0,M=S===C.length-1,R={fontSize:`${a}px`,fontFamily:`var(${u}), ${Or.fontFamily}`,verticalAlign:d?"baseline":"middle",unicodeBidi:"isolate"};er(w.hint.textEdits)&&(R.cursor="default"),this._fillInColors(R,w.hint),(L.command||L.location)&&((p=this._activeInlayHintPart)==null?void 0:p.part.item)===w&&this._activeInlayHintPart.part.index===S&&(R.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(R.color=Mn(FMe),R.cursor="pointer"));let T=L.label;f.totalLen+=T.length;let A=!1;const N=h!==0?f.totalLen-h:0;if(N>0&&(T=T.slice(0,-N)+"…",A=!0),x+=T.length,y!==void 0){const P=x-y;P>=0&&(x-=P,T=T.slice(0,-(1+P))+"…",A=!0)}if(c&&(E&&(M||A)?(R.padding=`1px ${Math.max(1,a/4)|0}px`,R.borderRadius=`${a/4|0}px`):E?(R.padding=`1px 0 1px ${Math.max(1,a/4)|0}px`,R.borderRadius=`${a/4|0}px 0 0 ${a/4|0}px`):M||A?(R.padding=`1px ${Math.max(1,a/4)|0}px 1px 0`,R.borderRadius=`0 ${a/4|0}px ${a/4|0}px 0`):R.padding="1px 0 1px 0"),o(w,this._ruleFactory.createClassNameRef(R),eqe(T),M&&!w.hint.paddingRight?wl.Right:wl.None,new YW(w,S)),A)break}if(y!==void 0&&x<y){const S=y-x;o(w,this._ruleFactory.createClassNameRef({})," ".repeat(S),wl.None)}if(w.hint.paddingRight&&r(w,!0),n.length>bC._MAX_DECORATORS)break}const g=[];for(const[b,w]of this._decorationsMetadata){const C=(v=this._editor.getModel())==null?void 0:v.getDecorationRange(b);C&&e.some(y=>y.containsRange(C))&&(g.push(b),w.classNameRef.dispose(),this._decorationsMetadata.delete(b))}const m=ud.capture(this._editor);this._editor.changeDecorations(b=>{const w=b.deltaDecorations(g,n.map(C=>C.decoration));for(let C=0;C<w.length;C++){const y=n[C];this._decorationsMetadata.set(w[C],y)}}),m.restore(this._editor)}_fillInColors(e,t){t.kind===TR.Parameter?(e.backgroundColor=Mn(qMe),e.color=Mn($Me)):t.kind===TR.Type?(e.backgroundColor=Mn(UMe),e.color=Mn(zMe)):(e.backgroundColor=Mn(l$),e.color=Mn(a$))}_getLayoutInfo(){const e=this._editor.getOption(159),t=e.padding,i=this._editor.getOption(61),n=this._editor.getOption(58);let o=e.fontSize;(!o||o<5||o>i)&&(o=i);const r=e.fontFamily||n;return{fontSize:o,fontFamily:r,padding:t,isUniform:!t&&r===n&&o===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}},bC=ju,ju.ID="editor.contrib.InlayHints",ju._MAX_DECORATORS=1500,ju._whitespaceData={},ju);xI=bC=Z$e([eC(1,We),eC(2,$l),eC(3,bhe),eC(4,en),eC(5,Hn),eC(6,$e)],xI);function eqe(s){return s.replace(/[ \t]/g," ")}Zt.registerCommand("_executeInlayHintProvider",async(s,...e)=>{const[t,i]=e;ti(Ze.isUri(t)),ti(D.isIRange(i));const{inlayHintsProvider:n}=s.get(We),o=await s.get(nr).createModelReference(t);try{const r=await L2.create(n,o.object.textEditorModel,[D.lift(i)],Ft.None),a=r.items.map(l=>l.hint);return setTimeout(()=>r.dispose(),0),a}finally{o.dispose()}});var tqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},jm=function(s,e){return function(t,i){e(t,i,s)}};class dJ extends IS{constructor(e,t,i,n){super(10,t,e.item.anchor.range,i,n,!0),this.part=e}}let W2=class extends vI{constructor(e,t,i,n,o,r,a,l){super(e,t,o,a,i,n,l),this._resolverService=r,this.hoverOrdinal=6}suggestHoverAnchor(e){var n;if(!xI.get(this._editor)||e.target.type!==6)return null;const i=(n=e.target.detail.injectedText)==null?void 0:n.options;return i instanceof Cm&&i.attachedData instanceof YW?new dJ(i.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,t,i,n){return e instanceof dJ?new Dl(async o=>{const{part:r}=e;if(await r.item.resolve(n),n.isCancellationRequested)return;let a;typeof r.item.hint.tooltip=="string"?a=new To().appendText(r.item.hint.tooltip):r.item.hint.tooltip&&(a=r.item.hint.tooltip),a&&o.emitOne(new cc(this,e.range,[a],!1,0)),er(r.item.hint.textEdits)&&o.emitOne(new cc(this,e.range,[new To().appendText(_(1164,"Double-click to insert"))],!1,10001));let l;if(typeof r.part.tooltip=="string"?l=new To().appendText(r.part.tooltip):r.part.tooltip&&(l=r.part.tooltip),l&&o.emitOne(new cc(this,e.range,[l],!1,1)),r.part.location||r.part.command){let d;const u=this._editor.getOption(86)==="altKey"?Bt?_(1165,"cmd + click"):_(1166,"ctrl + click"):Bt?_(1167,"option + click"):_(1168,"alt + click");r.part.location&&r.part.command?d=new To().appendText(_(1169,"Go to Definition ({0}), right click for more",u)):r.part.location?d=new To().appendText(_(1170,"Go to Definition ({0})",u)):r.part.command&&(d=new To(`[${_(1171,"Execute Command")}](${LUe(r.part.command)} "${r.part.command.title}") (${u})`,{isTrusted:!0})),d&&o.emitOne(new cc(this,e.range,[d],!1,1e4))}const c=this._resolveInlayHintLabelPartHover(r,n);for await(const d of c)o.emitOne(d)}):Dl.EMPTY}async*_resolveInlayHintLabelPartHover(e,t){if(!e.part.location)return;const{uri:i,range:n}=e.part.location,o=await this._resolverService.createModelReference(i);try{const r=o.object.textEditorModel;if(!this._languageFeaturesService.hoverProvider.has(r))return;for await(const a of Wq(this._languageFeaturesService.hoverProvider,r,new z(n.startLineNumber,n.startColumn),t))Mw(a.hover.contents)||(yield new cc(this,e.item.anchor.range,a.hover.contents,!1,2+a.ordinal))}finally{o.dispose()}}};W2=tqe([jm(1,Sc),jm(2,ai),jm(3,Sr),jm(4,xt),jm(5,nr),jm(6,We),jm(7,en)],W2);var vhe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},H2=function(s,e){return function(t,i){e(t,i,s)}};class hJ{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let XW=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new q,this.onDidChange=this._onDidChange.event,this._dispoables=new oe,this._markers=[],this._nextIdx=-1,Ze.isUri(e)?this._resourceFilter=a=>a.toString()===e.toString():e&&(this._resourceFilter=e);const n=this._configService.getValue("problems.sortOrder"),o=(a,l)=>{let c=pL(a.resource.toString(),l.resource.toString());return c===0&&(n==="position"?c=D.compareRangesUsingStarts(a,l)||In.compare(a.severity,l.severity):c=In.compare(a.severity,l.severity)||D.compareRangesUsingStarts(a,l)),c},r=()=>{let a=this._markerService.read({resource:Ze.isUri(e)?e:void 0,severities:In.Error|In.Warning|In.Info});return typeof e=="function"&&(a=a.filter(l=>this._resourceFilter(l.resource))),a.sort(o),dn(a,this._markers,(l,c)=>l.resource.toString()===c.resource.toString()&&l.startLineNumber===c.startLineNumber&&l.startColumn===c.startColumn&&l.endLineNumber===c.endLineNumber&&l.endColumn===c.endColumn&&l.severity===c.severity&&l.message===c.message)?!1:(this._markers=a,!0)};r(),this._dispoables.add(t.onMarkerChanged(a=>{(!this._resourceFilter||a.some(l=>this._resourceFilter(l)))&&r()&&(this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new hJ(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let n=this._markers.findIndex(o=>gm(o.resource,e.uri));if(n<0)n=EU(this._markers.length,o=>pL(this._markers[o].resource.toString(),e.uri.toString())),n<0&&(n=~n),i?this._nextIdx=n:this._nextIdx=(this._markers.length+n-1)%this._markers.length;else{let o=!1,r=!1;for(let a=n;a<this._markers.length;a++){let l=D.lift(this._markers[a]);if(l.isEmpty()){const c=e.getWordAtPosition(l.getStartPosition());c&&(l=new D(l.startLineNumber,c.startColumn,l.startLineNumber,c.endColumn))}if(t&&(l.containsPosition(t)||t.isBeforeOrEqual(l.getStartPosition()))){this._nextIdx=a,o=!0,r=!l.containsPosition(t);break}if(this._markers[a].resource.toString()!==e.uri.toString())break}o?r&&!i&&(this._nextIdx-=1):this._nextIdx=i?0:this._markers.length-1}this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;const n=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),n!==this._nextIdx}find(e,t){let i=this._markers.findIndex(n=>n.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(D.containsPosition(this._markers[i],t))return new hJ(this._markers[i],i+1,this._markers.length)}}};XW=vhe([H2(1,Wh),H2(2,xt)],XW);const Che=Mt("IMarkerNavigationService");let ZW=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new Zo}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new XW(e,this._markerService,this._configService)}};ZW=vhe([H2(0,Wh),H2(1,xt)],ZW);Vt(Che,ZW,1);var QW;(function(s){function e(t){switch(t){case xn.Ignore:return"severity-ignore "+it.asClassName(ge.info);case xn.Info:return it.asClassName(ge.info);case xn.Warning:return it.asClassName(ge.warning);case xn.Error:return it.asClassName(ge.error);default:return""}}s.className=e})(QW||(QW={}));var iqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},tC=function(s,e){return function(t,i){e(t,i,s)}},JW;class nqe{constructor(e,t,i,n,o){this._openerService=n,this._labelService=o,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new oe,this._editor=t;const r=document.createElement("div");r.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),r.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),r.appendChild(this._relatedBlock),this._disposables.add(Jn(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new Hre(r,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{r.style.left=`-${a.scrollLeft}px`,r.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){yi(this._disposables)}update(e){const{source:t,message:i,relatedInformation:n,code:o}=e;let r=((t==null?void 0:t.length)||0)+2;o&&(typeof o=="string"?r+=o.length:r+=o.value.length);const a=fa(i);this._lines=a.length,this._longestLineLength=0;for(const u of a)this._longestLineLength=Math.max(u.length+r,this._longestLineLength);io(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const u of a)l=document.createElement("div"),l.innerText=u,u===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||o){const u=document.createElement("span");if(u.classList.add("details"),l.appendChild(u),t){const f=document.createElement("span");f.innerText=t,f.classList.add("source"),u.appendChild(f)}if(o)if(typeof o=="string"){const f=document.createElement("span");f.innerText=`(${o})`,f.classList.add("code"),u.appendChild(f)}else{this._codeLink=we("a.code-link"),this._codeLink.setAttribute("href",`${o.target.toString()}`),this._codeLink.onclick=g=>{this._openerService.open(o.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()};const f=me(this._codeLink,we("span"));f.innerText=o.value,u.appendChild(this._codeLink)}}if(io(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),er(n)){const u=this._relatedBlock.appendChild(document.createElement("div"));u.style.paddingTop=`${Math.floor(this._editor.getOption(75)*.66)}px`,this._lines+=1;for(const f of n){const g=document.createElement("div"),m=document.createElement("a");m.classList.add("filename"),m.innerText=`${this._labelService.getUriBasenameLabel(f.resource)}(${f.startLineNumber}, ${f.startColumn}): `,m.title=this._labelService.getUriLabel(f.resource),this._relatedDiagnostics.set(m,f);const p=document.createElement("span");p.innerText=f.message,g.appendChild(m),g.appendChild(p),this._lines+=1,u.appendChild(g)}}const c=this._editor.getOption(59),d=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),h=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:h})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case In.Error:t=_(1024,"Error");break;case In.Warning:t=_(1025,"Warning");break;case In.Info:t=_(1026,"Info");break;case In.Hint:t=_(1027,"Hint");break}let i=_(1028,"{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const n=this._editor.getModel();return n&&e.startLineNumber<=n.getLineCount()&&e.startLineNumber>=1&&(i=`${n.getLineContent(e.startLineNumber)}, ${i}`),i}}var H_;let LI=(H_=class extends E2{constructor(e,t,i,n,o,r,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},o),this._themeService=t,this._openerService=i,this._menuService=n,this._contextKeyService=r,this._labelService=a,this._callOnDispose=new oe,this._onDidSelectRelatedInformation=new q,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=In.Warning,this._backgroundColor=re.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(aqe);let t=e8,i=sqe;this._severity===In.Warning?(t=dN,i=oqe):this._severity===In.Info&&(t=t8,i=rqe);const n=e.getColor(t),o=e.getColor(i);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:o,primaryHeadingColor:e.getColor(zde),secondaryHeadingColor:e.getColor(Ude)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(n=>this.editor.focus()));const t=this._menuService.getMenuActions(JW.TitleMenu,this._contextKeyService),i=R6e(t);this._actionbarWidget.push(i,{label:!1,icon:!0,index:0})}_fillTitleIcon(e){this._icon=me(e,we(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new nqe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const n=D.lift(e),o=this.editor.getPosition(),r=o&&n.containsPosition(o)?o:n.getStartPosition();super.show(r,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?_(1029,"{0} of {1} problems",t,i):_(1030,"{0} of {1} problem",t,i);this.setTitle(Fl(a.uri),l)}this._icon.className=`codicon ${QW.className(In.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}},JW=H_,H_.TitleMenu=new He("gotoErrorTitleMenu"),H_);LI=JW=iqe([tC(1,Dn),tC(2,Rf),tC(3,Vl),tC(4,$e),tC(5,ut),tC(6,nv)],LI);const uJ=NL(qO,AMe),fJ=NL(mf,RL),gJ=NL(Lh,ML),e8=F("editorMarkerNavigationError.background",{dark:uJ,light:uJ,hcDark:Yt,hcLight:Yt},_(1031,"Editor marker navigation widget error color.")),sqe=F("editorMarkerNavigationError.headerBackground",{dark:Ct(e8,.1),light:Ct(e8,.1),hcDark:null,hcLight:null},_(1032,"Editor marker navigation widget error heading background.")),dN=F("editorMarkerNavigationWarning.background",{dark:fJ,light:fJ,hcDark:Yt,hcLight:Yt},_(1033,"Editor marker navigation widget warning color.")),oqe=F("editorMarkerNavigationWarning.headerBackground",{dark:Ct(dN,.1),light:Ct(dN,.1),hcDark:"#0C141F",hcLight:Ct(dN,.2)},_(1034,"Editor marker navigation widget warning heading background.")),t8=F("editorMarkerNavigationInfo.background",{dark:gJ,light:gJ,hcDark:Yt,hcLight:Yt},_(1035,"Editor marker navigation widget info color.")),rqe=F("editorMarkerNavigationInfo.headerBackground",{dark:Ct(t8,.1),light:Ct(t8,.1),hcDark:null,hcLight:null},_(1036,"Editor marker navigation widget info heading background.")),aqe=F("editorMarkerNavigation.background",es,_(1037,"Editor marker navigation widget background."));var lqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},XD=function(s,e){return function(t,i){e(t,i,s)}},kS,V_;let ov=(V_=class{static get(e){return e.getContribution(kS.ID)}constructor(e,t,i,n,o){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=n,this._instantiationService=o,this._sessionDispoables=new oe,this._editor=e,this._widgetVisible=whe.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(LI,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{var n,o,r;(!((n=this._model)!=null&&n.selected)||!D.containsPosition((o=this._model)==null?void 0:o.selected.marker,i.position))&&((r=this._model)==null||r.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:D.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._getOrCreateModel(t.uri);i.resetIndex(),i.move(!0,t,new z(e.startLineNumber,e.startColumn)),i.selected&&this._widget.showAtMarker(i.selected.marker,i.selected.index,i.selected.total)}async navigate(e,t){var o,r;if(!this._editor.hasModel())return;const i=this._editor.getModel(),n=this._getOrCreateModel(t?void 0:i.uri);if(n.move(e,i,this._editor.getPosition()),!!n.selected)if(n.selected.marker.resource.toString()!==i.uri.toString()){this._cleanUp();const a=await this._editorService.openCodeEditor({resource:n.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:n.selected.marker}},this._editor);a&&((o=kS.get(a))==null||o.close(),(r=kS.get(a))==null||r.navigate(e,t))}else this._widget.showAtMarker(n.selected.marker,n.selected.index,n.selected.total)}},kS=V_,V_.ID="editor.contrib.markerController",V_);ov=kS=lqe([XD(1,Che),XD(2,ut),XD(3,ii),XD(4,$e)],ov);class R4 extends Fe{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}async run(e,t){var i;t.hasModel()&&await((i=ov.get(t))==null?void 0:i.navigate(this._next,this._multiFile))}}const Op=class Op extends R4{constructor(){super(!0,!1,{id:Op.ID,label:Op.LABEL,precondition:void 0,kbOpts:{kbExpr:B.focus,primary:578,weight:100},menuOpts:{menuId:LI.TitleMenu,title:Op.LABEL.value,icon:rn("marker-navigation-next",ge.arrowDown,_(1016,"Icon for goto next marker.")),group:"navigation",order:1}})}};Op.ID="editor.action.marker.next",Op.LABEL=ne(1020,"Go to Next Problem (Error, Warning, Info)");let V2=Op;const Fp=class Fp extends R4{constructor(){super(!1,!1,{id:Fp.ID,label:Fp.LABEL,precondition:void 0,kbOpts:{kbExpr:B.focus,primary:1602,weight:100},menuOpts:{menuId:LI.TitleMenu,title:Fp.LABEL.value,icon:rn("marker-navigation-previous",ge.arrowUp,_(1017,"Icon for goto previous marker.")),group:"navigation",order:2}})}};Fp.ID="editor.action.marker.prev",Fp.LABEL=ne(1021,"Go to Previous Problem (Error, Warning, Info)");let i8=Fp;class cqe extends R4{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:ne(1022,"Go to Next Problem in Files (Error, Warning, Info)"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:66,weight:100},menuOpts:{menuId:He.MenubarGoMenu,title:_(1018,"Next &&Problem"),group:"6_problem_nav",order:1}})}}class dqe extends R4{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:ne(1023,"Go to Previous Problem in Files (Error, Warning, Info)"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:1090,weight:100},menuOpts:{menuId:He.MenubarGoMenu,title:_(1019,"Previous &&Problem"),group:"6_problem_nav",order:2}})}}Qt(ov.ID,ov,4);xe(V2);xe(i8);xe(cqe);xe(dqe);const whe=new Ne("markersNavigationVisible",!1),hqe=Is.bindToContribution(ov.get);Te(new hqe({id:"closeMarkersNavigation",precondition:whe,handler:s=>s.close(),kbOpts:{weight:150,kbExpr:B.focus,primary:9,secondary:[1033]}}));var uqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},JF=function(s,e){return function(t,i){e(t,i,s)}};const Kl=we;class yhe{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const mJ={type:1,filter:{include:cn.QuickFix},triggerAction:_a.QuickFixHover};let n8=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),n=e.range;if(!i.isValidRange(e.range))return[];const o=n.startLineNumber,r=i.getLineMaxColumn(o),a=[];for(const l of t){const c=l.range.startLineNumber===o?l.range.startColumn:1,d=l.range.endLineNumber===o?l.range.endColumn:r,h=this._markerDecorationsService.getMarker(i.uri,l);if(!h)continue;const u=new D(e.range.startLineNumber,c,e.range.startLineNumber,d);a.push(new yhe(this,u,h))}return a}renderHoverParts(e,t){if(!t.length)return new Jb([]);const i=[];t.forEach(r=>{const a=this._renderMarkerHover(r);e.fragment.appendChild(a.hoverElement),i.push(a)});const n=t.length===1?t[0]:t.sort((r,a)=>In.compare(r.marker.severity,a.marker.severity))[0],o=this._renderMarkerStatusbar(e,n);return new Jb(i,o)}getAccessibleContent(e){return e.marker.message}_renderMarkerHover(e){const t=new oe,i=Kl("div.hover-row"),n=me(i,Kl("div.marker.hover-contents")),{source:o,message:r,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(n);const c=me(n,Kl("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=r,o||a)if(a&&typeof a!="string"){const h=Kl("span");if(o){const m=me(h,Kl("span"));m.innerText=o}const u=me(h,Kl("a.code-link"));u.setAttribute("href",a.target.toString(!0)),t.add(ee(u,"click",m=>{this._openerService.open(a.target,{allowCommands:!0}),m.preventDefault(),m.stopPropagation()}));const f=me(u,Kl("span"));f.innerText=a.value;const g=me(n,h);g.style.opacity="0.6",g.style.paddingLeft="6px"}else{const h=me(n,Kl("span"));h.style.opacity="0.6",h.style.paddingLeft="6px",h.innerText=o&&a?`${o}(${a})`:o||`(${a})`}if(er(l))for(const{message:h,resource:u,startLineNumber:f,startColumn:g}of l){const m=me(n,Kl("div"));m.style.marginTop="8px";const p=me(m,Kl("a"));p.innerText=`${Fl(u)}(${f}, ${g}): `,p.style.cursor="pointer",t.add(ee(p,"click",b=>{if(b.stopPropagation(),b.preventDefault(),this._openerService){const w={selection:{startLineNumber:f,startColumn:g}};this._openerService.open(u,{fromUserGesture:!0,editorOptions:w}).catch(_t)}}));const v=me(m,Kl("span"));v.innerText=h,this._editor.applyFontInfo(v)}return{hoverPart:e,hoverElement:i,dispose:()=>t.dispose()}}_renderMarkerStatusbar(e,t){const i=new oe;if(t.marker.severity===In.Error||t.marker.severity===In.Warning||t.marker.severity===In.Info){const n=ov.get(this._editor);n&&e.statusBar.addAction({label:_(1139,"View Problem"),commandId:V2.ID,run:()=>{e.hide(),n.showAtMarker(t.marker),this._editor.focus()}})}if(!this._editor.getOption(104)){const n=e.statusBar.append(Kl("div"));this.recentMarkerCodeActionsInfo&&(v2.makeKey(this.recentMarkerCodeActionsInfo.marker)===v2.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=_(1140,"No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const o=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?K.None:cf(()=>n.textContent=_(1141,"Checking for quick fixes..."),200,i);n.textContent||(n.textContent=" ");const r=this.getCodeActions(t.marker);i.add(Ve(()=>r.cancel())),r.then(a=>{var d;if(o.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),n.textContent=_(1142,"No quick fixes available");return}n.style.display="none";let l=!1;i.add(Ve(()=>{l||a.dispose()})),e.statusBar.addAction({label:_(1143,"Quick Fix..."),commandId:Dq,run:h=>{l=!0;const u=Qb.get(this._editor),f=Fn(h);e.hide(),u==null||u.showCodeActions(mJ,a,{x:f.left,y:f.top,width:f.width,height:f.height})}});const c=a.validActions.find(h=>h.action.isAI);c&&e.statusBar.addAction({label:c.action.title,commandId:((d=c.action.command)==null?void 0:d.id)??"",iconClass:it.asClassName(ge.sparkle),run:()=>{const h=Qb.get(this._editor);h==null||h.applyCodeAction(c,!1,!1,Dg.FromProblemsHover)}}),e.onContentsChanged()},_t)}return i}getCodeActions(e){return ys(t=>OC(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new D(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),mJ,ed.None,t))}};n8=uqe([JF(1,t$),JF(2,Rf),JF(3,We)],n8);var She=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},R1=function(s,e){return function(t,i){e(t,i,s)}},s8,o8;let r8=s8=class extends K{constructor(e,t,i,n,o,r,a){super();const l=t.hoverParts;this._renderedHoverParts=this._register(new a8(e,i,l,n,o,r,a));const c=t.options,d=c.anchor,{showAtPosition:h,showAtSecondaryPosition:u}=s8.computeHoverPositions(e,d.range,l);this.shouldAppearBeforeContent=l.some(f=>f.isBeforeContent),this.showAtPosition=h,this.showAtSecondaryPosition=u,this.initialMousePosX=d.initialMousePosX,this.initialMousePosY=d.initialMousePosY,this.shouldFocus=c.shouldFocus,this.source=c.source}get domNode(){return this._renderedHoverParts.domNode}get domNodeHasChildren(){return this._renderedHoverParts.domNodeHasChildren}get focusedHoverPartIndex(){return this._renderedHoverParts.focusedHoverPartIndex}get hoverPartsCount(){return this._renderedHoverParts.hoverPartsCount}focusHoverPartWithIndex(e){this._renderedHoverParts.focusHoverPartWithIndex(e)}async updateHoverVerbosityLevel(e,t,i){this._renderedHoverParts.updateHoverVerbosityLevel(e,t,i)}isColorPickerVisible(){return this._renderedHoverParts.isColorPickerVisible()}static computeHoverPositions(e,t,i){let n=1;if(e.hasModel()){const d=e._getViewModel(),h=d.coordinatesConverter,u=h.convertModelRangeToViewRange(t),f=d.getLineMinColumn(u.startLineNumber),g=new z(u.startLineNumber,f);n=h.convertViewPositionToModelPosition(g).column}const o=t.startLineNumber;let r=t.startColumn,a;for(const d of i){const h=d.range,u=h.startLineNumber===o,f=h.endLineNumber===o;if(u&&f){const m=h.startColumn,p=Math.min(r,m);r=Math.max(p,n)}d.forceShowAtRange&&(a=h)}let l,c;if(a){const d=a.getStartPosition();l=d,c=d}else l=t.getStartPosition(),c=new z(o,r);return{showAtPosition:l,showAtSecondaryPosition:c}}};r8=s8=She([R1(4,ai),R1(5,Sr),R1(6,pa)],r8);class fqe{constructor(e,t){this._statusBar=t,e.appendChild(this._statusBar.hoverElement)}get hoverElement(){return this._statusBar.hoverElement}get actions(){return this._statusBar.actions}dispose(){this._statusBar.dispose()}}var z_;let a8=(z_=class extends K{constructor(e,t,i,n,o,r,a){super(),this._hoverService=r,this._clipboardService=a,this._renderedParts=[],this._focusedHoverPartIndex=-1,this._context=n,this._fragment=document.createDocumentFragment(),this._register(this._renderParts(t,i,n,o,this._hoverService)),this._register(this._registerListenersOnRenderedParts()),this._register(this._createEditorDecorations(e,i)),this._updateMarkdownAndColorParticipantInfo(t)}_createEditorDecorations(e,t){if(t.length===0)return K.None;let i=t[0].range;for(const o of t){const r=o.range;i=D.plusRange(i,r)}const n=e.createDecorationsCollection();return n.set([{range:i,options:o8._DECORATION_OPTIONS}]),Ve(()=>{n.clear()})}_renderParts(e,t,i,n,o){const r=new y2(n,o),a={fragment:this._fragment,statusBar:r,...i},l=new oe;l.add(r);for(const d of e){const h=this._renderHoverPartsForParticipant(t,d,a);l.add(h);for(const u of h.renderedHoverParts)this._renderedParts.push({type:"hoverPart",participant:d,hoverPart:u.hoverPart,hoverElement:u.hoverElement})}const c=this._renderStatusBar(this._fragment,r);return c&&(l.add(c),this._renderedParts.push({type:"statusBar",hoverElement:c.hoverElement,actions:c.actions})),l}_renderHoverPartsForParticipant(e,t,i){const n=e.filter(r=>r.owner===t);return n.length>0?t.renderHoverParts(i,n):new Jb([])}_renderStatusBar(e,t){if(t.hasContent)return new fqe(e,t)}_registerListenersOnRenderedParts(){const e=new oe;return this._renderedParts.forEach((t,i)=>{const n=t.hoverElement;n.tabIndex=0,e.add(ee(n,ye.FOCUS_IN,o=>{o.stopPropagation(),this._focusedHoverPartIndex=i})),e.add(ee(n,ye.FOCUS_OUT,o=>{o.stopPropagation(),this._focusedHoverPartIndex=-1})),t.type==="hoverPart"&&t.hoverPart instanceof yhe&&e.add(new DW(n,()=>t.participant.getAccessibleContent(t.hoverPart),this._clipboardService,this._hoverService))}),e}_updateMarkdownAndColorParticipantInfo(e){const t=e.find(i=>i instanceof vI&&!(i instanceof W2));t&&(this._markdownHoverParticipant=t),this._colorHoverParticipant=e.find(i=>i instanceof x2)}focusHoverPartWithIndex(e){e<0||e>=this._renderedParts.length||this._renderedParts[e].hoverElement.focus()}async updateHoverVerbosityLevel(e,t,i){if(!this._markdownHoverParticipant)return;let n;t>=0?n={start:t,endExclusive:t+1}:n=this._findRangeOfMarkdownHoverParts(this._markdownHoverParticipant);for(let o=n.start;o<n.endExclusive;o++){const r=this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant,o);if(r===void 0)continue;const a=await this._markdownHoverParticipant.updateMarkdownHoverVerbosityLevel(e,r);a&&(this._renderedParts[o]={type:"hoverPart",participant:this._markdownHoverParticipant,hoverPart:a.hoverPart,hoverElement:a.hoverElement})}i&&(t>=0?this.focusHoverPartWithIndex(t):this._context.focus()),this._context.onContentsChanged()}isColorPickerVisible(){var e;return((e=this._colorHoverParticipant)==null?void 0:e.isColorPickerVisible())??!1}_normalizedIndexToMarkdownHoverIndexRange(e,t){const i=this._renderedParts[t];if(!i||i.type!=="hoverPart"||!(i.participant===e))return;const o=this._renderedParts.findIndex(r=>r.type==="hoverPart"&&r.participant===e);if(o===-1)throw new et;return t-o}_findRangeOfMarkdownHoverParts(e){const t=this._renderedParts.slice(),i=t.findIndex(r=>r.type==="hoverPart"&&r.participant===e),n=t.reverse().findIndex(r=>r.type==="hoverPart"&&r.participant===e),o=n>=0?t.length-n:n;return{start:i,endExclusive:o+1}}get domNode(){return this._fragment}get domNodeHasChildren(){return this._fragment.hasChildNodes()}get focusedHoverPartIndex(){return this._focusedHoverPartIndex}get hoverPartsCount(){return this._renderedParts.length}},o8=z_,z_._DECORATION_OPTIONS=vt.register({description:"content-hover-highlight",className:"hoverHighlight"}),z_);a8=o8=She([R1(4,ai),R1(5,Sr),R1(6,pa)],a8);var gqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ZD=function(s,e){return function(t,i){e(t,i,s)}};let l8=class extends K{constructor(e,t,i,n,o){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._hoverService=n,this._clipboardService=o,this._currentResult=null,this._renderedContentHover=this._register(new mi),this._onContentsChanged=this._register(new q),this.onContentsChanged=this._onContentsChanged.event,this._contentHoverWidget=this._register(this._instantiationService.createInstance(SW,this._editor)),this._participants=this._initializeHoverParticipants(),this._hoverOperation=this._register(new cde(this._editor,new w2(this._editor,this._participants))),this._registerListeners()}_initializeHoverParticipants(){const e=[];for(const t of kv.getAll()){const i=this._instantiationService.createInstance(t,this._editor);e.push(i)}return e.sort((t,i)=>t.hoverOrdinal-i.hoverOrdinal),this._register(this._contentHoverWidget.onDidResize(()=>{this._participants.forEach(t=>{var i;return(i=t.handleResize)==null?void 0:i.call(t)})})),this._register(this._contentHoverWidget.onDidScroll(t=>{this._participants.forEach(i=>{var n;return(n=i.handleScroll)==null?void 0:n.call(i,t)})})),this._register(this._contentHoverWidget.onContentsChanged(()=>{this._participants.forEach(t=>{var i;return(i=t.handleContentsChanged)==null?void 0:i.call(t)})})),e}_registerListeners(){this._register(this._hoverOperation.onResult(t=>{const i=t.hasLoadingMessage?this._addLoadingMessage(t):t.value;this._withResult(new fde(i,t.isComplete,t.options))}));const e=this._contentHoverWidget.getDomNode();this._register(Jn(e,"keydown",t=>{t.equals(9)&&this.hide()})),this._register(Jn(e,"mouseleave",t=>{this._onMouseLeave(t)})),this._register(An.onDidChange(()=>{this._contentHoverWidget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)})),this._register(this._contentHoverWidget.onContentsChanged(()=>{this._onContentsChanged.fire()}))}_startShowingOrUpdateHover(e,t,i,n,o){if(!(this._contentHoverWidget.position&&this._currentResult))return e?(this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):!1;const a=this._editor.getOption(69).sticky,l=o&&this._contentHoverWidget.isMouseGettingCloser(o.event.posx,o.event.posy);return a&&l?(e&&this._startHoverOperationIfNecessary(e,t,i,n,!0),!0):e?this._currentResult&&this._currentResult.options.anchor.equals(e)?!0:this._currentResult&&e.canAdoptVisibleHover(this._currentResult.options.anchor,this._contentHoverWidget.position)?(this._currentResult&&this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,n,o){if(this._hoverOperation.options&&this._hoverOperation.options.anchor.equals(e))return;this._hoverOperation.cancel();const a={anchor:e,source:i,shouldFocus:n,insistOnKeepingHoverVisible:o};this._hoverOperation.start(t,a)}_setCurrentResult(e){let t=e;if(this._currentResult===t)return;t&&t.hoverParts.length===0&&(t=null),this._currentResult=t,this._currentResult?this._showHover(this._currentResult):this._hideHover()}_addLoadingMessage(e){for(const t of this._participants){if(!t.createLoadingMessage)continue;const i=t.createLoadingMessage(e.options.anchor);if(i)return e.value.slice(0).concat([i])}return e.value}_withResult(e){if(this._contentHoverWidget.position&&this._currentResult&&this._currentResult.isComplete||this._setCurrentResult(e),!e.isComplete)return;const n=e.hoverParts.length===0,o=e.options.insistOnKeepingHoverVisible;n&&o||this._setCurrentResult(e)}_showHover(e){const t=this._getHoverContext();this._renderedContentHover.value=new r8(this._editor,e,this._participants,t,this._keybindingService,this._hoverService,this._clipboardService),this._renderedContentHover.value.domNodeHasChildren?this._contentHoverWidget.show(this._renderedContentHover.value):this._renderedContentHover.clear()}_hideHover(){this._contentHoverWidget.hide(),this._participants.forEach(e=>{var t;return(t=e.handleHide)==null?void 0:t.call(e)})}_getHoverContext(){return{hide:()=>{this.hide()},onContentsChanged:()=>{this._contentHoverWidget.handleContentsChanged()},setMinimumDimensions:o=>{this._contentHoverWidget.setMinimumDimensions(o)},focus:()=>this.focus()}}showsOrWillShow(e){if(this._contentHoverWidget.isResizing)return!0;const i=this._findHoverAnchorCandidates(e);if(!(i.length>0))return this._startShowingOrUpdateHover(null,0,0,!1,e);const o=i[0];return this._startShowingOrUpdateHover(o,0,0,!1,e)}_findHoverAnchorCandidates(e){const t=[];for(const n of this._participants){if(!n.suggestHoverAnchor)continue;const o=n.suggestHoverAnchor(e);o&&t.push(o)}const i=e.target;switch(i.type){case 6:{t.push(new UF(0,i.range,e.event.posx,e.event.posy));break}case 7:{const n=this._editor.getOption(59).typicalHalfwidthCharacterWidth/2;if(!(!i.detail.isAfterLines&&typeof i.detail.horizontalDistanceToText=="number"&&i.detail.horizontalDistanceToText<n))break;t.push(new UF(0,i.range,e.event.posx,e.event.posy));break}}return t.sort((n,o)=>o.priority-n.priority),t}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!v4(t,e.x,e.y))&&this.hide()}startShowingAtRange(e,t,i,n){this._startShowingOrUpdateHover(new UF(0,e,void 0,void 0),t,i,n,null)}async updateHoverVerbosityLevel(e,t,i){var n;(n=this._renderedContentHover.value)==null||n.updateHoverVerbosityLevel(e,t,i)}focusedHoverPartIndex(){var e;return((e=this._renderedContentHover.value)==null?void 0:e.focusedHoverPartIndex)??-1}containsNode(e){return e?this._contentHoverWidget.getDomNode().contains(e):!1}focus(){var t;if(((t=this._renderedContentHover.value)==null?void 0:t.hoverPartsCount)===1){this.focusHoverPartWithIndex(0);return}this._contentHoverWidget.focus()}focusHoverPartWithIndex(e){var t;(t=this._renderedContentHover.value)==null||t.focusHoverPartWithIndex(e)}scrollUp(){this._contentHoverWidget.scrollUp()}scrollDown(){this._contentHoverWidget.scrollDown()}scrollLeft(){this._contentHoverWidget.scrollLeft()}scrollRight(){this._contentHoverWidget.scrollRight()}pageUp(){this._contentHoverWidget.pageUp()}pageDown(){this._contentHoverWidget.pageDown()}goToTop(){this._contentHoverWidget.goToTop()}goToBottom(){this._contentHoverWidget.goToBottom()}hide(){this._hoverOperation.cancel(),this._setCurrentResult(null)}getDomNode(){return this._contentHoverWidget.getDomNode()}get isColorPickerVisible(){var e;return((e=this._renderedContentHover.value)==null?void 0:e.isColorPickerVisible())??!1}get isVisibleFromKeyboard(){return this._contentHoverWidget.isVisibleFromKeyboard}get isVisible(){return this._contentHoverWidget.isVisible}get isFocused(){return this._contentHoverWidget.isFocused}get isResizing(){return this._contentHoverWidget.isResizing}get widget(){return this._contentHoverWidget}};l8=gqe([ZD(1,$e),ZD(2,ai),ZD(3,Sr),ZD(4,pa)],l8);function xhe(s){var t;const e=s.target;return!!e&&e.type===6&&((t=e.detail.injectedText)==null?void 0:t.options.attachedData)===sde}var mqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},e3=function(s,e){return function(t,i){e(t,i,s)}},c8,U_;let Bo=(U_=class extends K{constructor(e,t,i,n){super(),this._editor=e,this._instantiationService=i,this._keybindingService=n,this._onHoverContentsChanged=this._register(new q),this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new oe,this._isMouseDown=!1,this._ignoreMouseEvents=!1,this._reactToEditorMouseMoveRunner=this._register(new Ni(()=>{this._mouseMoveEvent&&this._reactToEditorMouseMove(this._mouseMoveEvent)},0)),this._register(t.onDidShowContextMenu(()=>{this.hideContentHover(),this._ignoreMouseEvents=!0})),this._register(t.onDidHideContextMenu(()=>{this._ignoreMouseEvents=!1})),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(o=>{o.hasChanged(69)&&(this._unhookListeners(),this._hookListeners())}))}static get(e){return e.getContribution(c8.ID)}_hookListeners(){const e=this._editor.getOption(69);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled||this._cancelSchedulerAndHide(),this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>this._cancelSchedulerAndHide())),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelSchedulerAndHide(){this._cancelScheduler(),this.hideContentHover()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){this._ignoreMouseEvents||(e.scrollTopChanged||e.scrollLeftChanged)&&this.hideContentHover()}_onEditorMouseDown(e){this._ignoreMouseEvents||(this._isMouseDown=!0,this._shouldKeepHoverWidgetVisible(e))||this.hideContentHover()}_shouldKeepHoverWidgetVisible(e){return this._isMouseOnContentHoverWidget(e)||this._isContentWidgetResizing()||xhe(e)}_isMouseOnContentHoverWidget(e){return this._contentWidget?v4(this._contentWidget.getDomNode(),e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._ignoreMouseEvents||(this._isMouseDown=!1)}_onEditorMouseLeave(e){this._ignoreMouseEvents||this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._shouldKeepHoverWidgetVisible(e))||this.hideContentHover()}_shouldKeepCurrentHover(e){const t=this._contentWidget;if(!t)return!1;const i=this._hoverSettings.sticky,n=(d,h)=>{const u=this._isMouseOnContentHoverWidget(d);return h&&u},o=d=>{const h=t.isColorPickerVisible,u=this._isMouseOnContentHoverWidget(d),f=h&&u,g=h&&this._isMouseDown;return f||g},r=(d,h)=>{var f;const u=d.event.browserEvent.view;return u?h&&t.containsNode(u.document.activeElement)&&!((f=u.getSelection())!=null&&f.isCollapsed):!1},a=t.isFocused,l=t.isResizing,c=this._hoverSettings.sticky&&t.isVisibleFromKeyboard;return this.shouldKeepOpenOnEditorMouseMoveOrLeave||a||l||c||n(e,i)||o(e)||r(e,i)}_onEditorMouseMove(e){if(this._ignoreMouseEvents)return;if(this._mouseMoveEvent=e,this._shouldKeepCurrentHover(e)){this._reactToEditorMouseMoveRunner.cancel();return}if(this._shouldRescheduleHoverComputation()){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(this._hoverSettings.hidingDelay);return}this._reactToEditorMouseMove(e)}_shouldRescheduleHoverComputation(){var i;const e=this._hoverSettings.hidingDelay;return(((i=this._contentWidget)==null?void 0:i.isVisible)??!1)&&this._hoverSettings.sticky&&e>0}_reactToEditorMouseMove(e){this._hoverSettings.enabled&&this._getOrCreateContentWidget().showsOrWillShow(e)||this.hideContentHover()}_onKeyDown(e){if(this._ignoreMouseEvents||!this._contentWidget)return;const t=this._isPotentialKeyboardShortcut(e),i=this._isModifierKeyPressed(e);t||i||this._contentWidget.isFocused&&e.keyCode===2||this.hideContentHover()}_isPotentialKeyboardShortcut(e){if(!this._editor.hasModel()||!this._contentWidget)return!1;const t=this._keybindingService.softDispatch(e,this._editor.getDomNode()),i=t.kind===1,n=t.kind===2&&(t.commandId===ode||t.commandId===_4||t.commandId===b4)&&this._contentWidget.isVisible;return i||n}_isModifierKeyPressed(e){return e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4}hideContentHover(){var e;Bw.dropDownVisible||(e=this._contentWidget)==null||e.hide()}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(l8,this._editor),this._listenersStore.add(this._contentWidget.onContentsChanged(()=>this._onHoverContentsChanged.fire()))),this._contentWidget}showContentHover(e,t,i,n){this._getOrCreateContentWidget().startShowingAtRange(e,t,i,n)}_isContentWidgetResizing(){var e;return((e=this._contentWidget)==null?void 0:e.widget.isResizing)||!1}focusedHoverPartIndex(){return this._getOrCreateContentWidget().focusedHoverPartIndex()}updateHoverVerbosityLevel(e,t,i){this._getOrCreateContentWidget().updateHoverVerbosityLevel(e,t,i)}focus(){var e;(e=this._contentWidget)==null||e.focus()}scrollUp(){var e;(e=this._contentWidget)==null||e.scrollUp()}scrollDown(){var e;(e=this._contentWidget)==null||e.scrollDown()}scrollLeft(){var e;(e=this._contentWidget)==null||e.scrollLeft()}scrollRight(){var e;(e=this._contentWidget)==null||e.scrollRight()}pageUp(){var e;(e=this._contentWidget)==null||e.pageUp()}pageDown(){var e;(e=this._contentWidget)==null||e.pageDown()}goToTop(){var e;(e=this._contentWidget)==null||e.goToTop()}goToBottom(){var e;(e=this._contentWidget)==null||e.goToBottom()}get isColorPickerVisible(){var e;return(e=this._contentWidget)==null?void 0:e.isColorPickerVisible}get isHoverVisible(){var e;return(e=this._contentWidget)==null?void 0:e.isVisible}dispose(){var e;super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),(e=this._contentWidget)==null||e.dispose()}},c8=U_,U_.ID="editor.contrib.contentHover",U_);Bo=c8=mqe([e3(1,sl),e3(2,$e),e3(3,ai)],Bo);const CK=class CK extends K{constructor(e){super(),this._editor=e,this._register(e.onMouseDown(t=>this.onMouseDown(t)))}dispose(){super.dispose()}onMouseDown(e){const t=this._editor.getOption(168);if(t!=="click"&&t!=="clickAndHover"||!xhe(e))return;const i=this._editor.getContribution(Bo.ID);if(!i||i.isColorPickerVisible)return;const n=e.target.range;if(!n)return;const o=new D(n.startLineNumber,n.startColumn+1,n.endLineNumber,n.endColumn+1);i.showContentHover(o,1,1,!1)}};CK.ID="editor.contrib.colorContribution";let z2=CK;var pqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_qe=function(s,e){return function(t,i){e(t,i,s)}};class dj{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n}static fromBaseColor(e,t){return new dj(e,t.range,t.model,t.provider)}}class bqe extends K{constructor(e,t,i,n){super();const o=e.getModel(),r=i.model;this.color=i.model.color,this.colorPicker=this._register(new Mde(t.fragment,r,e.getOption(163),n,"standalone")),this._register(r.onColorFlushed(a=>{this.color=a})),this._register(r.onDidChangeColor(a=>{CI(o,r,a,i.range,i)})),this._register(e.onDidChangeModelContent(a=>{t.hide(),e.focus()})),CI(o,r,this.color,i.range,i)}}let d8=class{constructor(e,t){this._editor=e,this._themeService=t}async createColorHover(e,t,i){if(!this._editor.hasModel()||!Fw.get(this._editor))return null;const o=await tde(i,this._editor.getModel(),Ft.None);let r=null,a=null;for(const u of o){const f=u.colorInfo;D.containsRange(f.range,e.range)&&(r=f,a=u.provider)}const l=r??e,c=a??t,d=!!r;return{colorHover:dj.fromBaseColor(this,await Ade(this._editor.getModel(),l,c)),foundInEditor:d}}async updateEditorModel(e){if(!this._editor.hasModel())return;const t=e.model;let i=new D(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn);this._color&&(await CI(this._editor.getModel(),t,this._color,i,e),i=Pde(this._editor,i,t))}renderHoverParts(e,t){if(!(t.length===0||!this._editor.hasModel()))return this._setMinimumDimensions(e),this._renderedParts=new bqe(this._editor,e,t[0],this._themeService),this._renderedParts}_setMinimumDimensions(e){const t=this._editor.getOption(75)+8;e.setMinimumDimensions(new wi(302,t))}get _color(){var e;return(e=this._renderedParts)==null?void 0:e.color}};d8=pqe([_qe(1,Dn)],d8);var vqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},tS=function(s,e){return function(t,i){e(t,i,s)}},h8;class Cqe{constructor(e,t){this.value=e,this.foundInEditor=t}}const pJ=8,wqe=22;var $_;let u8=($_=class extends K{constructor(e,t,i,n,o,r,a,l){var u;super(),this._editor=e,this._standaloneColorPickerVisible=t,this._standaloneColorPickerFocused=i,this._keybindingService=o,this._languageFeaturesService=r,this._editorWorkerService=a,this._hoverService=l,this.allowEditorOverflow=!0,this._position=void 0,this._body=document.createElement("div"),this._colorHover=null,this._selectionSetInEditor=!1,this._onResult=this._register(new q),this.onResult=this._onResult.event,this._renderedHoverParts=this._register(new mi),this._renderedStatusBar=this._register(new mi),this._standaloneColorPickerVisible.set(!0),this._standaloneColorPickerParticipant=n.createInstance(d8,this._editor),this._position=(u=this._editor._getViewModel())==null?void 0:u.getPrimaryCursorState().modelState.position;const c=this._editor.getSelection(),d=c?{startLineNumber:c.startLineNumber,startColumn:c.startColumn,endLineNumber:c.endLineNumber,endColumn:c.endColumn}:{startLineNumber:0,endLineNumber:0,endColumn:0,startColumn:0},h=this._register(Ol(this._body));this._register(h.onDidBlur(f=>{this.hide()})),this._register(h.onDidFocus(f=>{this.focus()})),this._register(this._editor.onDidChangeCursorPosition(()=>{this._selectionSetInEditor?this._selectionSetInEditor=!1:this.hide()})),this._register(this._editor.onMouseMove(f=>{var m;const g=(m=f.target.element)==null?void 0:m.classList;g&&g.contains("colorpicker-color-decoration")&&this.hide()})),this._register(this.onResult(f=>{this._render(f.value,f.foundInEditor)})),this._start(d),this._body.style.zIndex="50",this._editor.addContentWidget(this)}updateEditor(){this._colorHover&&this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover)}getId(){return h8.ID}getDomNode(){return this._body}getPosition(){if(!this._position)return null;const e=this._editor.getOption(69).above;return{position:this._position,secondaryPosition:this._position,preference:e?[1,2]:[2,1],positionAffinity:2}}hide(){this.dispose(),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerFocused.set(!1),this._editor.removeContentWidget(this),this._editor.focus()}focus(){this._standaloneColorPickerFocused.set(!0),this._body.focus()}async _start(e){const t=await this._computeAsync(e);t&&this._onResult.fire(new Cqe(t.result,t.foundInEditor))}async _computeAsync(e){if(!this._editor.hasModel())return null;const t={range:e,color:{red:0,green:0,blue:0,alpha:1}},i=await this._standaloneColorPickerParticipant.createColorHover(t,new pI(this._editorWorkerService),this._languageFeaturesService.colorProvider);return i?{result:i.colorHover,foundInEditor:i.foundInEditor}:null}_render(e,t){const i=document.createDocumentFragment();this._renderedStatusBar.value=this._register(new y2(this._keybindingService,this._hoverService));const n={fragment:i,statusBar:this._renderedStatusBar.value,onContentsChanged:()=>{},setMinimumDimensions:()=>{},hide:()=>this.hide(),focus:()=>this.focus()};if(this._colorHover=e,this._renderedHoverParts.value=this._standaloneColorPickerParticipant.renderHoverParts(n,[e]),!this._renderedHoverParts.value){this._renderedStatusBar.clear(),this._renderedHoverParts.clear();return}const o=this._renderedHoverParts.value.colorPicker;this._body.classList.add("standalone-colorpicker-body"),this._body.style.maxHeight=Math.max(this._editor.getLayoutInfo().height/4,250)+"px",this._body.style.maxWidth=Math.max(this._editor.getLayoutInfo().width*.66,500)+"px",this._body.tabIndex=0,this._body.appendChild(i),o.layout();const r=o.body,a=r.saturationBox.domNode.clientWidth,l=r.domNode.clientWidth-a-wqe-pJ,c=o.body.enterButton;c==null||c.onClicked(()=>{this.updateEditor(),this.hide()});const d=o.header,h=d.pickedColorNode;h.style.width=a+pJ+"px";const u=d.originalColorNode;u.style.width=l+"px";const f=o.header.closeButton;f==null||f.onClicked(()=>{this.hide()}),t&&(c&&(c.button.textContent="Replace"),this._selectionSetInEditor=!0,this._editor.setSelection(e.range)),this._editor.layoutContentWidget(this)}},h8=$_,$_.ID="editor.contrib.standaloneColorPickerWidget",$_);u8=h8=vqe([tS(3,$e),tS(4,ai),tS(5,We),tS(6,jr),tS(7,Sr)],u8);var yqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},_J=function(s,e){return function(t,i){e(t,i,s)}},f8,q_;let rv=(q_=class extends K{constructor(e,t,i){super(),this._editor=e,this._instantiationService=i,this._standaloneColorPickerWidget=null,this._standaloneColorPickerVisible=B.standaloneColorPickerVisible.bindTo(t),this._standaloneColorPickerFocused=B.standaloneColorPickerFocused.bindTo(t)}showOrFocus(){var e;this._editor.hasModel()&&(this._standaloneColorPickerVisible.get()?this._standaloneColorPickerFocused.get()||(e=this._standaloneColorPickerWidget)==null||e.focus():this._standaloneColorPickerWidget=this._instantiationService.createInstance(u8,this._editor,this._standaloneColorPickerVisible,this._standaloneColorPickerFocused))}hide(){var e;this._standaloneColorPickerFocused.set(!1),this._standaloneColorPickerVisible.set(!1),(e=this._standaloneColorPickerWidget)==null||e.hide(),this._editor.focus()}insertColor(){var e;(e=this._standaloneColorPickerWidget)==null||e.updateEditor(),this.hide()}static get(e){return e.getContribution(f8.ID)}},f8=q_,q_.ID="editor.contrib.standaloneColorPickerController",q_);rv=f8=yqe([_J(1,ut),_J(2,$e)],rv);class Sqe extends wc{constructor(){super({id:"editor.action.showOrFocusStandaloneColorPicker",title:{...ne(889,"Show or Focus Standalone Color Picker"),mnemonicTitle:_(888,"&&Show or Focus Standalone Color Picker")},precondition:void 0,menu:[{id:He.CommandPalette}],metadata:{description:ne(890,"Show or focus a standalone color picker which uses the default color provider. It displays hex/rgb/hsl colors.")}})}runEditorCommand(e,t){var i;(i=rv.get(t))==null||i.showOrFocus()}}class xqe extends Fe{constructor(){super({id:"editor.action.hideColorPicker",label:ne(891,"Hide the Color Picker"),precondition:B.standaloneColorPickerVisible.isEqualTo(!0),kbOpts:{primary:9,weight:100},metadata:{description:ne(892,"Hide the standalone color picker.")}})}run(e,t){var i;(i=rv.get(t))==null||i.hide()}}class Lqe extends Fe{constructor(){super({id:"editor.action.insertColorWithStandaloneColorPicker",label:ne(893,"Insert Color with Standalone Color Picker"),precondition:B.standaloneColorPickerFocused.isEqualTo(!0),kbOpts:{primary:3,weight:100},metadata:{description:ne(894,"Insert hex/rgb/hsl colors with the focused standalone color picker.")}})}run(e,t){var i;(i=rv.get(t))==null||i.insertColor()}}xe(xqe);xe(Lqe);Ei(Sqe);Qt(z2.ID,z2,2);Qt(rv.ID,rv,1);Qt(Fw.ID,Fw,1);C0(bW);kv.register(x2);Zt.registerCommand("_executeDocumentColorProvider",function(s,...e){const[t]=e;if(!(t instanceof Ze))throw kl();const{model:i,colorProviderRegistry:n,defaultColorDecoratorsEnablement:o}=nde(s,t);return Rq(new WVe,n,i,Ft.None,o)});Zt.registerCommand("_executeColorPresentationProvider",function(s,...e){const[t,i]=e;if(!i)return;const{uri:n,range:o}=i;if(!(n instanceof Ze)||!Array.isArray(t)||t.length!==4||!D.isIRange(o))throw kl();const{model:r,colorProviderRegistry:a,defaultColorDecoratorsEnablement:l}=nde(s,n),[c,d,h,u]=t;return Rq(new HVe({range:o,color:{red:c,green:d,blue:h,alpha:u}}),a,r,Ft.None,l)});class Ng{constructor(e,t,i){this.languageConfigurationService=i,this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,i){if(i<0)return!1;const n=t.length,o=e.length;if(i+n>o)return!1;for(let r=0;r<n;r++){const a=e.charCodeAt(i+r),l=t.charCodeAt(r);if(a!==l&&!(a>=65&&a<=90&&a+32===l)&&!(l>=65&&l<=90&&l+32===a))return!1}return!0}_createOperationsForBlockComment(e,t,i,n,o,r){const a=e.startLineNumber,l=e.startColumn,c=e.endLineNumber,d=e.endColumn,h=o.getLineContent(a),u=o.getLineContent(c);let f=h.lastIndexOf(t,l-1+t.length),g=u.indexOf(i,d-1-i.length);if(f!==-1&&g!==-1)if(a===c)h.substring(f+t.length,g).indexOf(i)>=0&&(f=-1,g=-1);else{const p=h.substring(f+t.length),v=u.substring(0,g);(p.indexOf(i)>=0||v.indexOf(i)>=0)&&(f=-1,g=-1)}let m;f!==-1&&g!==-1?(n&&f+t.length<h.length&&h.charCodeAt(f+t.length)===32&&(t=t+" "),n&&g>0&&u.charCodeAt(g-1)===32&&(i=" "+i,g-=1),m=Ng._createRemoveBlockCommentOperations(new D(a,f+t.length+1,c,g+1),t,i)):(m=Ng._createAddBlockCommentOperations(e,t,i,this._insertSpace),this._usedEndToken=m.length===1?i:null);for(const p of m)r.addTrackedEditOperation(p.range,p.text)}static _createRemoveBlockCommentOperations(e,t,i){const n=[];return D.isEmpty(e)?n.push(Pn.delete(new D(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+i.length))):(n.push(Pn.delete(new D(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),n.push(Pn.delete(new D(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+i.length)))),n}static _createAddBlockCommentOperations(e,t,i,n){const o=[];return D.isEmpty(e)?o.push(Pn.replace(new D(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+i)):(o.push(Pn.insert(new z(e.startLineNumber,e.startColumn),t+(n?" ":""))),o.push(Pn.insert(new z(e.endLineNumber,e.endColumn),(n?" ":"")+i))),o}getEditOperations(e,t){const i=this._selection.startLineNumber,n=this._selection.startColumn;e.tokenization.tokenizeIfCheap(i);const o=e.getLanguageIdAtPosition(i,n),r=this.languageConfigurationService.getLanguageConfiguration(o).comments;!r||!r.blockCommentStartToken||!r.blockCommentEndToken||this._createOperationsForBlockComment(this._selection,r.blockCommentStartToken,r.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length===2){const n=i[0],o=i[1];return new Oe(n.range.endLineNumber,n.range.endColumn,o.range.startLineNumber,o.range.startColumn)}else{const n=i[0].range,o=this._usedEndToken?-this._usedEndToken.length-1:0;return new Oe(n.endLineNumber,n.endColumn+o,n.endLineNumber,n.endColumn+o)}}}class cu{constructor(e,t,i,n,o,r,a){this.languageConfigurationService=e,this._selection=t,this._indentSize=i,this._type=n,this._insertSpace=o,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=a||!1}static _gatherPreflightCommentStrings(e,t,i,n){e.tokenization.tokenizeIfCheap(t);const o=e.getLanguageIdAtPosition(t,1),r=n.getLanguageConfiguration(o).comments,a=r?r.lineCommentToken:null;if(!a)return null;const l=[];for(let c=0,d=i-t+1;c<d;c++)l[c]={ignore:!1,commentStr:a,commentStrOffset:0,commentStrLength:a.length};return l}static _analyzeLines(e,t,i,n,o,r,a,l,c){let d=!0;const h=l.getLanguageConfiguration(c).comments,u=(h==null?void 0:h.lineCommentNoIndent)??!1;let f;e===0?f=!0:e===1?f=!1:f=!0;for(let g=0,m=n.length;g<m;g++){const p=n[g],v=o+g;if(v===o&&a){p.ignore=!0;continue}const b=i.getLineContent(v),w=Jo(b);if(w===-1){p.ignore=r,p.commentStrOffset=u?0:b.length;continue}d=!1;const C=u?0:w;if(p.ignore=!1,p.commentStrOffset=C,f&&!Ng._haystackHasNeedleAtOffset(b,p.commentStr,C)&&(e===0?f=!1:e===1||(p.ignore=!0)),f&&t){const y=w+p.commentStrLength;y<b.length&&b.charCodeAt(y)===32&&(p.commentStrLength+=1)}}if(e===0&&d){f=!1;for(let g=0,m=n.length;g<m;g++)n[g].ignore=!1}return{supported:!0,shouldRemoveComments:f,lines:n}}static _gatherPreflightData(e,t,i,n,o,r,a,l){const c=cu._gatherPreflightCommentStrings(i,n,o,l),d=i.getLanguageIdAtPosition(n,1);return c===null?{supported:!1}:cu._analyzeLines(e,t,i,c,n,r,a,l,d)}_executeLineComments(e,t,i,n){let o;i.shouldRemoveComments?o=cu._createRemoveLineCommentsOperations(i.lines,n.startLineNumber):(cu._normalizeInsertionPoint(e,i.lines,n.startLineNumber,this._indentSize),o=this._createAddLineCommentsOperations(i.lines,n.startLineNumber));const r=new z(n.positionLineNumber,n.positionColumn);for(let a=0,l=o.length;a<l;a++)t.addEditOperation(o[a].range,o[a].text),D.isEmpty(o[a].range)&&D.getStartPosition(o[a].range).equals(r)&&e.getLineContent(r.lineNumber).length+1===r.column&&(this._deltaColumn=(o[a].text||"").length);this._selectionId=t.trackSelection(n)}_attemptRemoveBlockComment(e,t,i,n){let o=t.startLineNumber,r=t.endLineNumber;const a=n.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn);let l=e.getLineContent(o).lastIndexOf(i,a-1),c=e.getLineContent(r).indexOf(n,t.endColumn-1-i.length);return l!==-1&&c===-1&&(c=e.getLineContent(o).indexOf(n,l+i.length),r=o),l===-1&&c!==-1&&(l=e.getLineContent(r).lastIndexOf(i,c),o=r),t.isEmpty()&&(l===-1||c===-1)&&(l=e.getLineContent(o).indexOf(i),l!==-1&&(c=e.getLineContent(o).indexOf(n,l+i.length))),l!==-1&&e.getLineContent(o).charCodeAt(l+i.length)===32&&(i+=" "),c!==-1&&e.getLineContent(r).charCodeAt(c-1)===32&&(n=" "+n,c-=1),l!==-1&&c!==-1?Ng._createRemoveBlockCommentOperations(new D(o,l+i.length+1,r,c+1),i,n):null}_executeBlockComment(e,t,i){e.tokenization.tokenizeIfCheap(i.startLineNumber);const n=e.getLanguageIdAtPosition(i.startLineNumber,1),o=this.languageConfigurationService.getLanguageConfiguration(n).comments;if(!o||!o.blockCommentStartToken||!o.blockCommentEndToken)return;const r=o.blockCommentStartToken,a=o.blockCommentEndToken;let l=this._attemptRemoveBlockComment(e,i,r,a);if(!l){if(i.isEmpty()){const c=e.getLineContent(i.startLineNumber);let d=Jo(c);d===-1&&(d=c.length),l=Ng._createAddBlockCommentOperations(new D(i.startLineNumber,d+1,i.startLineNumber,c.length+1),r,a,this._insertSpace)}else l=Ng._createAddBlockCommentOperations(new D(i.startLineNumber,e.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),r,a,this._insertSpace);l.length===1&&(this._deltaColumn=r.length+1)}this._selectionId=t.trackSelection(i);for(const c of l)t.addEditOperation(c.range,c.text)}getEditOperations(e,t){let i=this._selection;if(this._moveEndPositionDown=!1,i.startLineNumber===i.endLineNumber&&this._ignoreFirstLine){t.addEditOperation(new D(i.startLineNumber,e.getLineMaxColumn(i.startLineNumber),i.startLineNumber+1,1),i.startLineNumber===e.getLineCount()?"":`
`),this._selectionId=t.trackSelection(i);return}i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=cu._gatherPreflightData(this._type,this._insertSpace,e,i.startLineNumber,i.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return n.supported?this._executeLineComments(e,t,n,i):this._executeBlockComment(e,t,i)}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),new Oe(i.selectionStartLineNumber,i.selectionStartColumn+this._deltaColumn,i.positionLineNumber,i.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){const i=[];for(let n=0,o=e.length;n<o;n++){const r=e[n];r.ignore||i.push(Pn.delete(new D(t+n,r.commentStrOffset+1,t+n,r.commentStrOffset+r.commentStrLength+1)))}return i}_createAddLineCommentsOperations(e,t){const i=[],n=this._insertSpace?" ":"";for(let o=0,r=e.length;o<r;o++){const a=e[o];a.ignore||i.push(Pn.insert(new z(t+o,a.commentStrOffset+1),a.commentStr+n))}return i}static nextVisibleColumn(e,t,i,n){return i?e+(t-e%t):e+n}static _normalizeInsertionPoint(e,t,i,n){let o=1073741824,r,a;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let h=0;for(let u=0,f=t[l].commentStrOffset;h<o&&u<f;u++)h=cu.nextVisibleColumn(h,n,d.charCodeAt(u)===9,1);h<o&&(o=h)}o=Math.floor(o/n)*n;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let h=0;for(r=0,a=t[l].commentStrOffset;h<o&&r<a;r++)h=cu.nextVisibleColumn(h,n,d.charCodeAt(r)===9,1);h>o?t[l].commentStrOffset=r-1:t[l].commentStrOffset=r}}}class hj extends Fe{constructor(e,t){super(t),this._type=e}run(e,t){const i=e.get(wn);if(!t.hasModel())return;const n=t.getModel(),o=[],r=n.getOptions(),a=t.getOption(29),l=t.getSelections().map((d,h)=>({selection:d,index:h,ignoreFirstLine:!1}));l.sort((d,h)=>D.compareRangesUsingStarts(d.selection,h.selection));let c=l[0];for(let d=1;d<l.length;d++){const h=l[d];c.selection.endLineNumber===h.selection.startLineNumber&&(c.index<h.index?h.ignoreFirstLine=!0:(c.ignoreFirstLine=!0,c=h))}for(const d of l)o.push(new cu(i,d.selection,r.indentSize,this._type,a.insertSpace,a.ignoreEmptyLines,d.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class Iqe extends hj{constructor(){super(0,{id:"editor.action.commentLine",label:ne(897,"Toggle Line Comment"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:2138,weight:100},menuOpts:{menuId:He.MenubarEditMenu,group:"5_insert",title:_(895,"&&Toggle Line Comment"),order:1},canTriggerInlineEdits:!0})}}class Eqe extends hj{constructor(){super(1,{id:"editor.action.addCommentLine",label:ne(898,"Add Line Comment"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2081),weight:100},canTriggerInlineEdits:!0})}}class kqe extends hj{constructor(){super(2,{id:"editor.action.removeCommentLine",label:ne(899,"Remove Line Comment"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2099),weight:100},canTriggerInlineEdits:!0})}}class Dqe extends Fe{constructor(){super({id:"editor.action.blockComment",label:ne(900,"Toggle Block Comment"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:He.MenubarEditMenu,group:"5_insert",title:_(896,"Toggle &&Block Comment"),order:2},canTriggerInlineEdits:!0})}run(e,t){const i=e.get(wn);if(!t.hasModel())return;const n=t.getOption(29),o=[],r=t.getSelections();for(const a of r)o.push(new Ng(a,n.insertSpace,i));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}xe(Iqe);xe(Eqe);xe(kqe);xe(Dqe);var Tqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Km=function(s,e){return function(t,i){e(t,i,s)}},g8,j_;let II=(j_=class{static get(e){return e.getContribution(g8.ID)}constructor(e,t,i,n,o,r,a,l){this._contextMenuService=t,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=o,this._menuService=r,this._configurationService=a,this._workspaceContextService=l,this._toDispose=new oe,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu(c=>this._onContextMenu(c))),this._toDispose.add(this._editor.onMouseWheel(c=>{if(this._contextMenuIsBeingShownCount>0){const d=this._contextViewService.getContextViewElement(),h=c.srcElement;h.shadowRoot&&fm(d)===h.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(c=>{this._editor.getOption(30)&&c.keyCode===58&&(c.preventDefault(),c.stopPropagation(),this.showContextMenu())}))}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(30)){this._editor.focus(),e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position);return}if(e.target.type===12||e.target.type===6&&e.target.detail.injectedText)return;if(e.event.preventDefault(),e.event.stopPropagation(),e.target.type===11)return this._showScrollbarContextMenu(e.event);if(e.target.type!==6&&e.target.type!==7&&e.target.type!==1)return;if(this._editor.focus(),e.target.position){let i=!1;for(const n of this._editor.getSelections())if(n.containsPosition(e.target.position)){i=!0;break}i||this._editor.setPosition(e.target.position)}let t=null;e.target.type!==1&&(t=e.event),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(30)||!this._editor.hasModel())return;const t=this._getMenuActions(this._editor.getModel(),this._editor.contextMenuId);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){const i=[],n=this._menuService.getMenuActions(t,this._contextKeyService,{arg:e.uri});for(const o of n){const[,r]=o;let a=0;for(const l of r)if(l instanceof d_){const c=this._getMenuActions(e,l.item.submenu);c.length>0&&(i.push(new vw(l.id,l.label,c)),a++)}else i.push(l),a++;a&&i.push(new _s)}return i.length&&i.pop(),i}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;let i=t;if(!i){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const o=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),r=Fn(this._editor.getDomNode()),a=r.left+o.left,l=r.top+o.top+o.height;i={x:a,y:l}}const n=this._editor.getOption(144)&&!Al;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:n?this._editor.getOverflowWidgetsDomNode()??this._editor.getDomNode():void 0,getAnchor:()=>i,getActions:()=>e,getActionViewItem:o=>{const r=this._keybindingFor(o);if(r)return new Aw(o,o,{label:!0,keybinding:r.getLabel(),isMenu:!0});const a=o;return typeof a.getActionViewItem=="function"?a.getActionViewItem():new Aw(o,o,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:o=>this._keybindingFor(o),onHide:o=>{this._contextMenuIsBeingShownCount--}})}_showScrollbarContextMenu(e){if(!this._editor.hasModel()||BHe(this._workspaceContextService.getWorkspace()))return;const t=this._editor.getOption(81);let i=0;const n=c=>({id:`menu-action-${++i}`,label:c.label,tooltip:"",class:void 0,enabled:typeof c.enabled>"u"?!0:c.enabled,checked:c.checked,run:c.run}),o=(c,d)=>new vw(`menu-action-${++i}`,c,d,void 0),r=(c,d,h,u,f)=>{if(!d)return n({label:c,enabled:d,run:()=>{}});const g=p=>()=>{this._configurationService.updateValue(h,p)},m=[];for(const p of f)m.push(n({label:p.label,checked:u===p.value,run:g(p.value)}));return o(c,m)},a=[];a.push(n({label:_(901,"Minimap"),checked:t.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!t.enabled)}})),a.push(new _s),a.push(n({label:_(902,"Render Characters"),enabled:t.enabled,checked:t.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!t.renderCharacters)}})),a.push(r(_(903,"Vertical size"),t.enabled,"editor.minimap.size",t.size,[{label:_(904,"Proportional"),value:"proportional"},{label:_(905,"Fill"),value:"fill"},{label:_(906,"Fit"),value:"fit"}])),a.push(r(_(907,"Slider"),t.enabled,"editor.minimap.showSlider",t.showSlider,[{label:_(908,"Mouse Over"),value:"mouseover"},{label:_(909,"Always"),value:"always"}]));const l=this._editor.getOption(144)&&!Al;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>e,getActions:()=>a,onHide:c=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}},g8=j_,j_.ID="editor.contrib.contextmenu",j_);II=g8=Tqe([Km(1,sl),Km(2,Nf),Km(3,ut),Km(4,ai),Km(5,Vl),Km(6,xt),Km(7,wf)],II);class Nqe extends Fe{constructor(){super({id:"editor.action.showContextMenu",label:ne(910,"Show Editor Context Menu"),precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:1092,weight:100}})}run(e,t){var i;(i=II.get(t))==null||i.showContextMenu()}}Qt(II.ID,II,2);xe(Nqe);class t3{constructor(e){this.selections=e}equals(e){const t=this.selections.length,i=e.selections.length;if(t!==i)return!1;for(let n=0;n<t;n++)if(!this.selections[n].equalsSelection(e.selections[n]))return!1;return!0}}class i3{constructor(e,t,i){this.cursorState=e,this.scrollTop=t,this.scrollLeft=i}}const KA=class KA extends K{static get(e){return e.getContribution(KA.ID)}constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeModelContent(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeCursorSelection(t=>{if(this._isCursorUndoRedo||!t.oldSelections||t.oldModelVersionId!==t.modelVersionId)return;const i=new t3(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(i)||(this._undoStack.push(new i3(i,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())}))}cursorUndo(){!this._editor.hasModel()||this._undoStack.length===0||(this._redoStack.push(new i3(new t3(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){!this._editor.hasModel()||this._redoStack.length===0||(this._undoStack.push(new i3(new t3(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}};KA.ID="editor.contrib.cursorUndoRedoController";let zw=KA;class Rqe extends Fe{constructor(){super({id:"cursorUndo",label:ne(911,"Cursor Undo"),precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:2099,weight:100}})}run(e,t,i){var n;(n=zw.get(t))==null||n.cursorUndo()}}class Mqe extends Fe{constructor(){super({id:"cursorRedo",label:ne(912,"Cursor Redo"),precondition:void 0})}run(e,t,i){var n;(n=zw.get(t))==null||n.cursorRedo()}}Qt(zw.ID,zw,0);xe(Rqe);xe(Mqe);class Aqe{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){const i=e.getValueInRange(this.selection);if(this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new D(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),this.selection.containsPosition(this.targetPosition)&&!(this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition)))){this.targetSelection=this.selection;return}if(this.copy){this.targetSelection=new Oe(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber>this.selection.endLineNumber){this.targetSelection=new Oe(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber<this.selection.endLineNumber){this.targetSelection=new Oe(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new Oe(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column-this.selection.endColumn+this.selection.startColumn:this.targetPosition.column-this.selection.endColumn+this.selection.startColumn,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new Oe(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn)}computeCursorState(e,t){return this.targetSelection}}function iC(s){return Bt?s.altKey:s.ctrlKey}const tg=class tg extends K{constructor(e){super(),this._editor=e,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._register(this._editor.onMouseUp(t=>this._onEditorMouseUp(t))),this._register(this._editor.onMouseDrag(t=>this._onEditorMouseDrag(t))),this._register(this._editor.onMouseDrop(t=>this._onEditorMouseDrop(t))),this._register(this._editor.onMouseDropCanceled(()=>this._onEditorMouseDropCanceled())),this._register(this._editor.onKeyDown(t=>this.onEditorKeyDown(t))),this._register(this._editor.onKeyUp(t=>this.onEditorKeyUp(t))),this._register(this._editor.onDidBlurEditorWidget(()=>this.onEditorBlur())),this._register(this._editor.onDidBlurEditorText(()=>this.onEditorBlur())),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){!this._editor.getOption(42)||this._editor.getOption(28)||(iC(e)&&(this._modifierPressed=!0),this._mouseDown&&iC(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){!this._editor.getOption(42)||this._editor.getOption(28)||(iC(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===tg.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){const t=e.target;if(this._dragSelection===null){const n=(this._editor.getSelections()||[]).filter(o=>t.position&&o.containsPosition(t.position));if(n.length===1)this._dragSelection=n[0];else return}iC(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){const t=new z(e.target.position.lineNumber,e.target.position.column);if(this._dragSelection===null){let i=null;if(e.event.shiftKey){const n=this._editor.getSelection();if(n){const{selectionStartLineNumber:o,selectionStartColumn:r}=n;i=[new Oe(o,r,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map(n=>n.containsPosition(t)?new Oe(t.lineNumber,t.column,t.lineNumber,t.column):n);this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(iC(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(tg.ID,new Aqe(this._dragSelection,t,iC(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){this._dndDecorationIds.set([{range:new D(e.lineNumber,e.column,e.lineNumber,e.column),options:tg._DECORATION_OPTIONS}]),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(e){return e.type===6||e.type===7}_hitMargin(e){return e.type===2||e.type===3||e.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}};tg.ID="editor.contrib.dragAndDrop",tg.TRIGGER_KEY_VALUE=Bt?6:5,tg._DECORATION_OPTIONS=vt.register({description:"dnd-target",className:"dnd-target"});let U2=tg;Qt(U2.ID,U2,2);const Pqe="editor.action.pasteAs";Qt(yf.ID,yf,0);C0(nW);Te(new class extends Is{constructor(){super({id:Hce,precondition:Eq,kbOpts:{weight:100,primary:2137}})}runEditorCommand(s,e){var t;return(t=yf.get(e))==null?void 0:t.changePasteType()}});Te(new class extends Is{constructor(){super({id:"editor.hidePasteWidget",precondition:Eq,kbOpts:{weight:100,primary:9}})}runEditorCommand(s,e){var t;(t=yf.get(e))==null||t.clearWidgets()}});var K_;xe((K_=class extends Fe{constructor(){super({id:Pqe,label:ne(915,"Paste As..."),precondition:B.writable,metadata:{description:"Paste as",args:[{name:"args",schema:K_.argsSchema}]},canTriggerInlineEdits:!0})}run(e,t,i){var o;let n;return i&&("kind"in i?n={only:new En(i.kind)}:"preferences"in i&&(n={preferences:i.preferences.map(r=>new En(r))})),(o=yf.get(t))==null?void 0:o.pasteAs(n)}},K_.argsSchema={oneOf:[{type:"object",required:["kind"],properties:{kind:{type:"string",description:_(913,`The kind of the paste edit to try pasting with.
If there are multiple edits for this kind, the editor will show a picker. If there are no edits of this kind, the editor will show an error message.`)}}},{type:"object",required:["preferences"],properties:{preferences:{type:"array",description:_(914,`List of preferred paste edit kind to try applying.
The first edit matching the preferences will be applied.`),items:{type:"string"}}}}]},K_));xe(class extends Fe{constructor(){super({id:"editor.action.pasteAsText",label:ne(916,"Paste as Text"),precondition:B.writable,canTriggerInlineEdits:!0})}run(s,e){var t;return(t=yf.get(e))==null?void 0:t.pasteAs({providerId:Kb.id})}});class Oqe{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}}class bJ{constructor(e){this.identifier=e}}const Lhe=Mt("treeViewsDndService");Vt(Lhe,Oqe,1);var Fqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},QD=function(s,e){return function(t,i){e(t,i,s)}},su;const Bqe="editor.dropIntoEditor.preferences",Ihe="editor.changeDropType",uj=new Ne("dropWidgetVisible",!1,_(934,"Whether the drop widget is showing"));var G_;let Uw=(G_=class extends K{static get(e){return e.getContribution(su.ID)}constructor(e,t,i,n,o){super(),this._configService=i,this._languageFeaturesService=n,this._treeViewsDragAndDropService=o,this.treeItemsTransfer=X7.getInstance(),this._dropProgressManager=this._register(t.createInstance(u2,"dropIntoEditor",e)),this._postDropWidgetManager=this._register(t.createInstance(_2,"dropIntoEditor",e,uj,{id:Ihe,label:_(935,"Show drop options...")},()=>su._configureDefaultAction?[su._configureDefaultAction]:[])),this._register(e.onDropIntoEditor(r=>this.onDropIntoEditor(e,r.position,r.event)))}clearWidgets(){this._postDropWidgetManager.clear()}changeDropType(){this._postDropWidgetManager.tryShowSelector()}async onDropIntoEditor(e,t,i){var o;if(!i.dataTransfer||!e.hasModel())return;(o=su._currentDropOperation)==null||o.cancel(),e.focus(),e.setPosition(t);const n=ys(async r=>{const a=new oe,l=a.add(new Cf(e,1,void 0,r));try{const c=await this.extractDataTransferData(i);if(c.size===0||l.token.isCancellationRequested)return;const d=e.getModel();if(!d)return;const h=this._languageFeaturesService.documentDropEditProvider.ordered(d).filter(f=>f.dropMimeTypes?f.dropMimeTypes.some(g=>c.matches(g)):!0),u=a.add(await this.getDropEdits(h,d,t,c,l.token));if(l.token.isCancellationRequested)return;if(u.edits.length){const f=this.getInitialActiveEditIndex(d,u.edits),g=e.getOption(43).showDropSelector==="afterDrop";await this._postDropWidgetManager.applyEditAndShowIfNeeded([D.fromPositions(t)],{activeEditIndex:f,allEdits:u.edits},g,async m=>m,r)}}finally{a.dispose(),su._currentDropOperation===n&&(su._currentDropOperation=void 0)}});this._dropProgressManager.showWhile(t,_(936,"Running drop handlers. Click to cancel"),n,{cancel:()=>n.cancel()}),su._currentDropOperation=n}async getDropEdits(e,t,i,n,o){const r=new oe,a=await mw(Promise.all(e.map(async c=>{try{const d=await c.provideDocumentDropEdits(t,i,n,o);return d&&r.add(d),d==null?void 0:d.edits.map(h=>({...h,providerId:c.id}))}catch(d){il(d)||console.error(d),console.error(d)}})),o),l=bd(a??[]).flat();return{edits:Pce(l),dispose:()=>r.dispose()}}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(Bqe,{resource:e.uri});for(const n of Array.isArray(i)?i:[]){const o=new En(n),r=t.findIndex(a=>a.kind&&o.contains(a.kind));if(r>=0)return r}return 0}async extractDataTransferData(e){if(!e.dataTransfer)return new yce;const t=Ice(e.dataTransfer);if(this.treeItemsTransfer.hasData(bJ.prototype)){const i=this.treeItemsTransfer.getData(bJ.prototype);if(Array.isArray(i))for(const n of i){const o=await this._treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(o)for(const[r,a]of o)t.replace(r,a)}}return t}},su=G_,G_.ID="editor.contrib.dropIntoEditorController",G_);Uw=su=Fqe([QD(1,$e),QD(2,xt),QD(3,We),QD(4,Lhe)],Uw);Qt(Uw.ID,Uw,2);C0(iW);Te(new class extends Is{constructor(){super({id:Ihe,precondition:uj,kbOpts:{weight:100,primary:2137}})}runEditorCommand(s,e,t){var i;(i=Uw.get(e))==null||i.changeDropType()}});Te(new class extends Is{constructor(){super({id:"editor.hideDropWidget",precondition:uj,kbOpts:{weight:100,primary:9}})}runEditorCommand(s,e,t){var i;(i=Uw.get(e))==null||i.clearWidgets()}});const GA=class GA extends va{constructor(e,t,i){super(),this._hideSoon=this._register(new Ni(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const n={inputActiveOptionBorder:ve(mk),inputActiveOptionForeground:ve(pk),inputActiveOptionBackground:ve(d0)},o={groupId:"find-options-widget"};this.caseSensitive=this._register(new bde({appendTitle:this._keybindingLabelFor(Zi.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,hoverLifecycleOptions:o,...n})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new vde({appendTitle:this._keybindingLabelFor(Zi.ToggleWholeWordCommand),isChecked:this._state.wholeWord,hoverLifecycleOptions:o,...n})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new Cde({appendTitle:this._keybindingLabelFor(Zi.ToggleRegexCommand),isChecked:this._state.isRegex,hoverLifecycleOptions:o,...n})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(r=>{let a=!1;r.isRegex&&(this.regex.checked=this._state.isRegex,a=!0),r.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,a=!0),r.matchCase&&(this.caseSensitive.checked=this._state.matchCase,a=!0),!this._state.isRevealed&&a&&this._revealTemporarily()})),this._register(ee(this._domNode,ye.MOUSE_LEAVE,r=>this._onMouseLeave())),this._register(ee(this._domNode,"mouseover",r=>this._onMouseOver()))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return GA.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}};GA.ID="editor.contrib.findOptionsWidget";let m8=GA;function JD(s,e){return s===1?!0:s===2?!1:e}class Wqe extends K{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return JD(this._isRegexOverride,this._isRegex)}get wholeWord(){return JD(this._wholeWordOverride,this._wholeWord)}get matchCase(){return JD(this._matchCaseOverride,this._matchCase)}get preserveCase(){return JD(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new q),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const n={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,n.matchesPosition=!0,o=!0),this._matchesCount!==t&&(this._matchesCount=t,n.matchesCount=!0,o=!0),typeof i<"u"&&(D.equalsRange(this._currentMatch,i)||(this._currentMatch=i,n.currentMatch=!0,o=!0)),o&&this._onFindReplaceStateChange.fire(n)}change(e,t,i=!0){var d;const n={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;const r=this.isRegex,a=this.wholeWord,l=this.matchCase,c=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,n.searchString=!0,o=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,n.replaceString=!0,o=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,n.isRevealed=!0,o=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,n.isReplaceRevealed=!0,o=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&((d=e.searchScope)!=null&&d.every(h=>{var u;return(u=this._searchScope)==null?void 0:u.some(f=>!D.equalsRange(f,h))})||(this._searchScope=e.searchScope,n.searchScope=!0,o=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,n.loop=!0,o=!0),typeof e.isSearching<"u"&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,n.isSearching=!0,o=!0),typeof e.filters<"u"&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,n.filters=!0,o=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,r!==this.isRegex&&(o=!0,n.isRegex=!0),a!==this.wholeWord&&(o=!0,n.wholeWord=!0),l!==this.matchCase&&(o=!0,n.matchCase=!0),c!==this.preserveCase&&(o=!0,n.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(n)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=Tg}}var Hqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vqe=function(s,e){return function(t,i){e(t,i,s)}},jf,tm;let p8=(tm=class{static getOrCreate(e){return jf._instance||(jf._instance=new jf(e)),jf._instance}constructor(e){this.storageService=e,this.inMemoryValues=new Set,this._onDidChangeEmitter=new q,this.onDidChange=this._onDidChangeEmitter.event,this.load()}delete(e){const t=this.inMemoryValues.delete(e);return this.save(),t}add(e){return this.inMemoryValues.add(e),this.save(),this}has(e){return this.inMemoryValues.has(e)}forEach(e,t){return this.load(),this.inMemoryValues.forEach(e)}replace(e){this.inMemoryValues=new Set(e),this.save()}load(){let e;const t=this.storageService.get(jf.FIND_HISTORY_KEY,1);if(t)try{e=JSON.parse(t)}catch{}this.inMemoryValues=new Set(e||[])}save(){const e=[];return this.inMemoryValues.forEach(t=>e.push(t)),new Promise(t=>{this.storageService.store(jf.FIND_HISTORY_KEY,JSON.stringify(e),1,0),this._onDidChangeEmitter.fire(e),t()})}},jf=tm,tm.FIND_HISTORY_KEY="workbench.find.history",tm._instance=null,tm);p8=jf=Hqe([Vqe(0,sr)],p8);var zqe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Uqe=function(s,e){return function(t,i){e(t,i,s)}},Kf,im;let _8=(im=class{static getOrCreate(e){return Kf._instance||(Kf._instance=new Kf(e)),Kf._instance}constructor(e){this.storageService=e,this.inMemoryValues=new Set,this._onDidChangeEmitter=new q,this.onDidChange=this._onDidChangeEmitter.event,this.load()}delete(e){const t=this.inMemoryValues.delete(e);return this.save(),t}add(e){return this.inMemoryValues.add(e),this.save(),this}has(e){return this.inMemoryValues.has(e)}forEach(e,t){return this.load(),this.inMemoryValues.forEach(e)}replace(e){this.inMemoryValues=new Set(e),this.save()}load(){let e;const t=this.storageService.get(Kf.FIND_HISTORY_KEY,1);if(t)try{e=JSON.parse(t)}catch{}this.inMemoryValues=new Set(e||[])}save(){const e=[];return this.inMemoryValues.forEach(t=>e.push(t)),new Promise(t=>{this.storageService.store(Kf.FIND_HISTORY_KEY,JSON.stringify(e),1,0),this._onDidChangeEmitter.fire(e),t()})}},Kf=im,im.FIND_HISTORY_KEY="workbench.replace.history",im._instance=null,im);_8=Kf=zqe([Uqe(0,sr)],_8);var Ehe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nc=function(s,e){return function(t,i){e(t,i,s)}},b8;const $qe=524288;function v8(s,e="single",t=!1){if(!s.hasModel())return null;const i=s.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const n=s.getConfiguredWordAtPosition(i.getStartPosition());if(n&&t===!1)return n.word}else if(s.getModel().getValueLengthInRange(i)<$qe)return s.getModel().getValueInRange(i)}return null}var Y_;let $r=(Y_=class extends K{get editor(){return this._editor}static get(e){return e.getContribution(b8.ID)}constructor(e,t,i,n,o,r){super(),this._editor=e,this._findWidgetVisible=Af.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=n,this._notificationService=o,this._hoverService=r,this._updateHistoryDelayer=new Pl(500),this._state=this._register(new Wqe),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(a=>this._onStateChanged(a))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const a=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),a&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(50).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!w4.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e=e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=ua(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}async _start(e,t){if(this.disposeModel(),!this._editor.hasModel())return;const i={...t,isRevealed:!0};if(e.seedSearchStringFromSelection==="single"){const n=v8(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);n&&(this._state.isRegex?i.searchString=ua(n):i.searchString=n)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){const n=v8(this._editor,e.seedSearchStringFromSelection);n&&(i.searchString=n)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const n=await this.getGlobalBufferTerm();if(!this._editor.hasModel())return;n&&(i.searchString=n)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const n=this._editor.getSelections();n.some(o=>!o.isEmpty())&&(i.searchScope=n)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new fx(this._editor,this._state))}start(e,t){return this._start(e,t)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(e){return this._model?(this._model.moveToMatch(e),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){var e;return this._model?(e=this._editor.getModel())!=null&&e.isTooLargeForHeapOperation()?(this._notificationService.warn(_(940,"The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}async getGlobalBufferTerm(){return this._editor.getOption(50).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}setGlobalBufferTerm(e){this._editor.getOption(50).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}},b8=Y_,Y_.ID="editor.contrib.findController",Y_);$r=b8=Ehe([nc(1,ut),nc(2,sr),nc(3,pa),nc(4,Hn),nc(5,Sr)],$r);let C8=class extends $r{constructor(e,t,i,n,o,r,a,l){super(e,i,r,a,o,l),this._contextViewService=t,this._keybindingService=n,this._widget=null,this._findOptionsWidget=null,this._findWidgetSearchHistory=p8.getOrCreate(r),this._replaceWidgetHistory=_8.getOrCreate(r)}async _start(e,t){this._widget||this._createFindWidget();const i=this._editor.getSelection();let n=!1;switch(this._editor.getOption(50).autoFindInSelection){case"always":n=!0;break;case"never":n=!1;break;case"multiline":{n=!!i&&i.startLineNumber!==i.endLineNumber;break}}e.updateSearchScope=e.updateSearchScope||n,await super._start(e,t),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new kW(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._hoverService,this._findWidgetSearchHistory,this._replaceWidgetHistory)),this._findOptionsWidget=this._register(new m8(this._editor,this._state,this._keybindingService))}saveViewState(){var e;return(e=this._widget)==null?void 0:e.getViewState()}restoreViewState(e){var t;(t=this._widget)==null||t.setViewState(e)}};C8=Ehe([nc(1,Nf),nc(2,ut),nc(3,ai),nc(4,Hn),nc(5,sr),nc(6,pa),nc(7,Sr)],C8);const qqe=AO(new MO({id:Zi.StartFindAction,label:ne(947,"Find"),precondition:de.or(B.focus,de.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:He.MenubarEditMenu,group:"3_find",title:_(941,"&&Find"),order:1}}));qqe.addImplementation(0,(s,e,t)=>{const i=$r.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(50).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(50).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(50).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(50).loop}):!1});const jqe={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},isRegex:{type:"boolean"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},preserveCase:{type:"boolean"},findInSelection:{type:"boolean"}}}}]};class Kqe extends Fe{constructor(){super({id:Zi.StartFindWithArgs,label:ne(948,"Find with Arguments"),precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},metadata:jqe})}async run(e,t,i){const n=$r.get(t);if(n){const o=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:i.replaceString!==void 0,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};await n.start({forceRevealReplace:!1,seedSearchStringFromSelection:n.getState().searchString.length===0&&t.getOption(50).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(50).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(i==null?void 0:i.findInSelection)||!1,loop:t.getOption(50).loop},o),n.setGlobalBufferTerm(n.getState().searchString)}}}class Gqe extends Fe{constructor(){super({id:Zi.StartFindWithSelection,label:ne(949,"Find with Selection"),precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}async run(e,t){const i=$r.get(t);i&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(50).loop}),i.setGlobalBufferTerm(i.getState().searchString))}}async function khe(s,e){const t=$r.get(s);if(!t)return;const i=()=>(e?t.moveToNextMatch():t.moveToPrevMatch())?(t.editor.pushUndoStop(),!0):!1;i()||(await t.start({forceRevealReplace:!1,seedSearchStringFromSelection:t.getState().searchString.length===0&&s.getOption(50).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:s.getOption(50).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:s.getOption(50).loop}),i())}const Yqe=AO(new MO({id:Zi.NextMatchFindAction,label:ne(950,"Find Next"),precondition:void 0,kbOpts:[{kbExpr:B.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:de.and(B.focus,w4),primary:3,weight:100}]}));Yqe.addImplementation(0,async(s,e,t)=>khe(e,!0));const Xqe=AO(new MO({id:Zi.PreviousMatchFindAction,label:ne(951,"Find Previous"),precondition:void 0,kbOpts:[{kbExpr:B.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:de.and(B.focus,w4),primary:1027,weight:100}]}));Xqe.addImplementation(0,async(s,e,t)=>khe(e,!1));class Zqe extends Fe{constructor(){super({id:Zi.GoToMatchFindAction,label:ne(952,"Go to Match..."),precondition:Af}),this._highlightDecorations=[]}run(e,t,i){const n=$r.get(t);if(!n)return;const o=n.getState().matchesCount;if(o<1){e.get(Hn).notify({severity:f0.Warning,message:_(942,"No matches. Try searching for something else.")});return}const r=e.get(Fo),a=new oe,l=a.add(r.createInputBox());l.placeholder=_(943,"Type a number to go to a specific match (between 1 and {0})",o);const c=h=>{const u=parseInt(h);if(isNaN(u))return;const f=n.getState().matchesCount;if(u>0&&u<=f)return u-1;if(u<0&&u>=-f)return f+u},d=h=>{const u=c(h);if(typeof u=="number"){l.validationMessage=void 0,n.goToMatch(u);const f=n.getState().currentMatch;f&&this.addDecorations(t,f)}else l.validationMessage=_(944,"Please type a number between 1 and {0}",n.getState().matchesCount),this.clearDecorations(t)};a.add(l.onDidChangeValue(h=>{d(h)})),a.add(l.onDidAccept(()=>{const h=c(l.value);typeof h=="number"?(n.goToMatch(h),l.hide()):l.validationMessage=_(945,"Please type a number between 1 and {0}",n.getState().matchesCount)})),a.add(l.onDidHide(()=>{this.clearDecorations(t),a.dispose()})),l.show()}clearDecorations(e){e.changeDecorations(t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])})}addDecorations(e,t){e.changeDecorations(i=>{this._highlightDecorations=i.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:Mn(Jre),position:Xa.Full}}}])})}}class Dhe extends Fe{async run(e,t){const i=$r.get(t);if(!i)return;const n=v8(t,"single",!1);n&&i.setSearchString(n),this._run(i)||(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(50).loop}),this._run(i))}}class Qqe extends Dhe{constructor(){super({id:Zi.NextSelectionMatchFindAction,label:ne(953,"Find Next Selection"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class Jqe extends Dhe{constructor(){super({id:Zi.PreviousSelectionMatchFindAction,label:ne(954,"Find Previous Selection"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const eje=AO(new MO({id:Zi.StartFindReplaceAction,label:ne(955,"Replace"),precondition:de.or(B.focus,de.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:He.MenubarEditMenu,group:"3_find",title:_(946,"&&Replace"),order:2}}));eje.addImplementation(0,(s,e,t)=>{if(!e.hasModel()||e.getOption(104))return!1;const i=$r.get(e);if(!i)return!1;const n=e.getSelection(),o=i.isFindInputFocused(),r=!n.isEmpty()&&n.startLineNumber===n.endLineNumber&&e.getOption(50).seedSearchStringFromSelection!=="never"&&!o,a=o||r?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(50).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(50).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(50).loop})});Qt($r.ID,C8,0);xe(Kqe);xe(Gqe);xe(Zqe);xe(Qqe);xe(Jqe);const Cd=Is.bindToContribution($r.get);Te(new Cd({id:Zi.CloseFindWidgetCommand,precondition:Af,handler:s=>s.closeFindWidget(),kbOpts:{weight:105,kbExpr:de.and(B.focus,de.not("isComposing")),primary:9,secondary:[1033]}}));Te(new Cd({id:Zi.ToggleCaseSensitiveCommand,precondition:void 0,handler:s=>s.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:B.focus,primary:HD.primary,mac:HD.mac,win:HD.win,linux:HD.linux}}));Te(new Cd({id:Zi.ToggleWholeWordCommand,precondition:void 0,handler:s=>s.toggleWholeWords(),kbOpts:{weight:105,kbExpr:B.focus,primary:VD.primary,mac:VD.mac,win:VD.win,linux:VD.linux}}));Te(new Cd({id:Zi.ToggleRegexCommand,precondition:void 0,handler:s=>s.toggleRegex(),kbOpts:{weight:105,kbExpr:B.focus,primary:zD.primary,mac:zD.mac,win:zD.win,linux:zD.linux}}));Te(new Cd({id:Zi.ToggleSearchScopeCommand,precondition:void 0,handler:s=>s.toggleSearchScope(),kbOpts:{weight:105,kbExpr:B.focus,primary:UD.primary,mac:UD.mac,win:UD.win,linux:UD.linux}}));Te(new Cd({id:Zi.TogglePreserveCaseCommand,precondition:void 0,handler:s=>s.togglePreserveCase(),kbOpts:{weight:105,kbExpr:B.focus,primary:$D.primary,mac:$D.mac,win:$D.win,linux:$D.linux}}));Te(new Cd({id:Zi.ReplaceOneAction,precondition:Af,handler:s=>s.replace(),kbOpts:{weight:105,kbExpr:B.focus,primary:3094}}));Te(new Cd({id:Zi.ReplaceOneAction,precondition:Af,handler:s=>s.replace(),kbOpts:{weight:105,kbExpr:de.and(B.focus,Oq),primary:3}}));Te(new Cd({id:Zi.ReplaceAllAction,precondition:Af,handler:s=>s.replaceAll(),kbOpts:{weight:105,kbExpr:B.focus,primary:2563}}));Te(new Cd({id:Zi.ReplaceAllAction,precondition:Af,handler:s=>s.replaceAll(),kbOpts:{weight:105,kbExpr:de.and(B.focus,Oq),primary:void 0,mac:{primary:2051}}}));Te(new Cd({id:Zi.SelectAllMatchesAction,precondition:Af,handler:s=>s.selectAllMatches(),kbOpts:{weight:105,kbExpr:B.focus,primary:515}}));const tje={0:" ",1:"u",2:"r"},vJ=65535,zc=16777215,CJ=4278190080;class n3{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return(this._states[t]&1<<i)!==0}set(e,t){const i=e/32|0,n=e%32,o=this._states[i];t?this._states[i]=o|1<<n:this._states[i]=o&~(1<<n)}}class Ha{constructor(e,t,i){if(e.length!==t.length||e.length>vJ)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new n3(e.length),this._userDefinedStates=new n3(e.length),this._recoveredStates=new n3(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(i,n)=>{const o=e[e.length-1];return this.getStartLineNumber(o)<=i&&this.getEndLineNumber(o)>=n};for(let i=0,n=this._startIndexes.length;i<n;i++){const o=this._startIndexes[i],r=this._endIndexes[i];if(o>zc||r>zc)throw new Error("startLineNumber or endLineNumber must not exceed "+zc);for(;e.length>0&&!t(o,r);)e.pop();const a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=o+((a&255)<<24),this._endIndexes[i]=r+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&zc}getEndLineNumber(e){return this._endIndexes[e]&zc}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let n=0;n<this._types.length;n++)this._types[n]===e&&(this.setCollapsed(n,t),i=!0);return i}toRegion(e){return new ije(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&CJ)>>>24)+((this._endIndexes[e]&CJ)>>>16);return t===vJ?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){const n=Math.floor((t+i)/2);e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${tje[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&zc,endLineNumber:this._endIndexes[e]&zc,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),n=new Uint32Array(t);let o=[],r=!1;for(let l=0;l<t;l++){const c=e[l];i[l]=c.startLineNumber,n[l]=c.endLineNumber,o.push(c.type),c.type&&(r=!0)}r||(o=void 0);const a=new Ha(i,n,o);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,i,n){i=i??Number.MAX_VALUE;const o=(p,v)=>Array.isArray(p)?(b=>b<v?p[b]:void 0):(b=>b<v?p.toFoldRange(b):void 0),r=o(e,e.length),a=o(t,t.length);let l=0,c=0,d=r(0),h=a(0);const u=[];let f,g=0;const m=[];for(;d||h;){let p;if(h&&(!d||d.startLineNumber>=h.startLineNumber))d&&d.startLineNumber===h.startLineNumber?(h.source===1?p=h:(p=d,p.isCollapsed=h.isCollapsed&&(d.endLineNumber===h.endLineNumber||!(n!=null&&n.startsInside(d.startLineNumber+1,d.endLineNumber+1))),p.source=0),d=r(++l)):(p=h,h.isCollapsed&&h.source===0&&(p.source=2)),h=a(++c);else{let v=c,b=h;for(;;){if(!b||b.startLineNumber>d.endLineNumber){p=d;break}if(b.source===1&&b.endLineNumber>d.endLineNumber)break;b=a(++v)}d=r(++l)}if(p){for(;f&&f.endLineNumber<p.startLineNumber;)f=u.pop();p.endLineNumber>p.startLineNumber&&p.startLineNumber>g&&p.endLineNumber<=i&&(!f||f.endLineNumber>=p.endLineNumber)&&(m.push(p),g=p.startLineNumber,f&&u.push(f),f=p)}}return m}}class ije{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class nje{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new q,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new Ha(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,n)=>i.regionIndex-n.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let n=0,o=-1,r=-1;const a=l=>{for(;n<l;){const c=this._regions.getEndLineNumber(n),d=this._regions.isCollapsed(n);if(c<=o){const h=this.regions.getSource(n)!==0;i.changeDecorationOptions(this._editorDecorationIds[n],this._decorationProvider.getDecorationOption(d,c<=r,h))}d&&c>r&&(r=c),n++}};for(const l of e){const c=l.regionIndex,d=this._editorDecorationIds[c];if(d&&!t[d]){t[d]=!0,a(c);const h=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,h),o=Math.max(o,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=n=>{for(const o of e)if(!(o.startLineNumber>n.endLineNumber||n.startLineNumber>o.endLineNumber))return!0;return!1};for(let n=0;n<this._regions.length;n++){const o=this._regions.toFoldRange(n);(o.source===0||!i(o))&&t.push(o)}this.updatePost(Ha.fromFoldRanges(t))}update(e,t){const i=this._currentFoldedOrManualRanges(t),n=Ha.sanitizeAndMerge(e,i,this._textModel.getLineCount(),t);this.updatePost(Ha.fromFoldRanges(n))}updatePost(e){const t=[];let i=-1;for(let n=0,o=e.length;n<o;n++){const r=e.getStartLineNumber(n),a=e.getEndLineNumber(n),l=e.isCollapsed(n),c=e.getSource(n)!==0,d={startLineNumber:r,startColumn:this._textModel.getLineMaxColumn(r),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:d,options:this._decorationProvider.getDecorationOption(l,a<=i,c)}),l&&a>i&&(i=a)}this._decorationProvider.changeDecorations(n=>this._editorDecorationIds=n.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e){const t=[];for(let i=0,n=this._regions.length;i<n;i++){let o=this.regions.isCollapsed(i);const r=this.regions.getSource(i);if(o||r!==0){const a=this._regions.toFoldRange(i),l=this._textModel.getDecorationRange(this._editorDecorationIds[i]);l&&(o&&(e!=null&&e.startsInside(l.startLineNumber+1,l.endLineNumber))&&(o=!1),t.push({startLineNumber:l.startLineNumber,endLineNumber:l.endLineNumber,type:a.type,isCollapsed:o,source:r}))}}return t}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let n=0,o=e.length;n<o;n++){const r=e[n];if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>i)continue;const a=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);t.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,isCollapsed:r.isCollapsed,source:r.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){if(!Array.isArray(e))return;const t=[],i=this._textModel.getLineCount();for(const o of e){if(o.startLineNumber>=o.endLineNumber||o.startLineNumber<1||o.endLineNumber>i)continue;const r=this._getLinesChecksum(o.startLineNumber+1,o.endLineNumber);(!o.checksum||r===o.checksum)&&t.push({startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,type:void 0,isCollapsed:o.isCollapsed??!0,source:o.source??0})}const n=Ha.sanitizeAndMerge(this._regions,t,i);this.updatePost(Ha.fromFoldRanges(n))}_getLinesChecksum(e,t){return dk(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let n=this._regions.findRange(e),o=1;for(;n>=0;){const r=this._regions.toRegion(n);(!t||t(r,o))&&i.push(r),o++,n=r.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],n=e?e.regionIndex+1:0,o=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const r=[];for(let a=n,l=this._regions.length;a<l;a++){const c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<o){for(;r.length>0&&!c.containedBy(r[r.length-1]);)r.pop();r.push(c),t(c,r.length)&&i.push(c)}else break}}else for(let r=n,a=this._regions.length;r<a;r++){const l=this._regions.toRegion(r);if(this._regions.getStartLineNumber(r)<o)(!t||t(l))&&i.push(l);else break}return i}}function fj(s,e,t){const i=[];for(const n of t){const o=s.getRegionAtLine(n);if(o){const r=!o.isCollapsed;if(i.push(o),e>1){const a=s.getRegionsInside(o,(l,c)=>l.isCollapsed!==r&&c<e);i.push(...a)}}}s.toggleCollapseState(i)}function w0(s,e,t=Number.MAX_VALUE,i){const n=[];if(i&&i.length>0)for(const o of i){const r=s.getRegionAtLine(o);if(r&&(r.isCollapsed!==e&&n.push(r),t>1)){const a=s.getRegionsInside(r,(l,c)=>l.isCollapsed!==e&&c<t);n.push(...a)}}else{const o=s.getRegionsInside(null,(r,a)=>r.isCollapsed!==e&&a<t);n.push(...o)}s.toggleCollapseState(n)}function The(s,e,t,i){const n=[];for(const o of i){const r=s.getAllRegionsAtLine(o,(a,l)=>a.isCollapsed!==e&&l<=t);n.push(...r)}s.toggleCollapseState(n)}function sje(s,e,t){const i=[];for(const n of t){const o=s.getAllRegionsAtLine(n,r=>r.isCollapsed!==e);o.length>0&&i.push(o[0])}s.toggleCollapseState(i)}function oje(s,e,t,i){const n=(r,a)=>a===e&&r.isCollapsed!==t&&!i.some(l=>r.containsLine(l)),o=s.getRegionsInside(null,n);s.toggleCollapseState(o)}function Nhe(s,e,t){const i=[];for(const r of t){const a=s.getAllRegionsAtLine(r,void 0);a.length>0&&i.push(a[0])}const n=r=>i.every(a=>!a.containedBy(r)&&!r.containedBy(a))&&r.isCollapsed!==e,o=s.getRegionsInside(null,n);s.toggleCollapseState(o)}function gj(s,e,t){const i=s.textModel,n=s.regions,o=[];for(let r=n.length-1;r>=0;r--)if(t!==n.isCollapsed(r)){const a=n.getStartLineNumber(r);e.test(i.getLineContent(a))&&o.push(n.toRegion(r))}s.toggleCollapseState(o)}function mj(s,e,t){const i=s.regions,n=[];for(let o=i.length-1;o>=0;o--)t!==i.isCollapsed(o)&&e===i.getType(o)&&n.push(i.toRegion(o));s.toggleCollapseState(n)}function rje(s,e){let t=null;const i=e.getRegionAtLine(s);if(i!==null&&(t=i.startLineNumber,s===t)){const n=i.parentIndex;n!==-1?t=e.regions.getStartLineNumber(n):t=null}return t}function aje(s,e){let t=e.getRegionAtLine(s);if(t!==null&&t.startLineNumber===s){if(s!==t.startLineNumber)return t.startLineNumber;{const i=t.parentIndex;let n=0;for(i!==-1&&(n=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<s)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function lje(s,e){let t=e.getRegionAtLine(s);if(t!==null&&t.startLineNumber===s){const i=t.parentIndex;let n=0;if(i!==-1)n=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;n=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>s)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class cje{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new q,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||bm(t.text)[0]!==0))}updateHiddenRanges(){let e=!1;const t=[];let i=0,n=0,o=Number.MAX_VALUE,r=-1;const a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;const l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);o<=l&&c<=r||(!e&&n<this._hiddenRanges.length&&this._hiddenRanges[n].startLineNumber===l&&this._hiddenRanges[n].endLineNumber===c?(t.push(this._hiddenRanges[n]),n++):(e=!0,t.push(new D(l,1,c,1))),o=l,r=c)}(this._hasLineChanges||e||n<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return wJ(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let n=null;const o=r=>((!n||!dje(r,n))&&(n=wJ(this._hiddenRanges,r)),n?n.startLineNumber-1:null);for(let r=0,a=e.length;r<a;r++){let l=e[r];const c=o(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);const d=o(l.endLineNumber);d&&(l=l.setEndPosition(d,i.getLineMaxColumn(d)),t=!0),e[r]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function dje(s,e){return s>=e.startLineNumber&&s<=e.endLineNumber}function wJ(s,e){const t=WL(s,i=>e<i.startLineNumber)-1;return t>=0&&s[t].endLineNumber>=e?s[t]:null}const hje=5e3,uje="indent";class pj{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=uje}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,n=t&&t.markers;return Promise.resolve(mje(this.editorModel,i,n,this.foldingRangesLimit))}}let fje=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>zc||t>zc)return;const n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const i=new Uint32Array(this._length),n=new Uint32Array(this._length);for(let o=this._length-1,r=0;o>=0;o--,r++)i[r]=this._startIndexes[o],n[r]=this._endIndexes[o];return new Ha(i,n)}else{this._foldingRangesLimit.update(this._length,t);let i=0,n=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){const c=this._indentOccurrences[l];if(c){if(c+i>t){n=l;break}i+=c}}const o=e.getOptions().tabSize,r=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,c=0;l>=0;l--){const d=this._startIndexes[l],h=e.getLineContent(d),u=t4(h,o);(u<n||u===n&&i++<t)&&(r[c]=d,a[c]=this._endIndexes[l],c++)}return new Ha(r,a)}}};const gje={limit:hje,update:()=>{}};function mje(s,e,t,i=gje){const n=s.getOptions().tabSize,o=new fje(i);let r;t&&(r=new RegExp(`(${t.start.source})|(?:${t.end.source})`));const a=[],l=s.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=s.getLineCount();c>0;c--){const d=s.getLineContent(c),h=t4(d,n);let u=a[a.length-1];if(h===-1){e&&(u.endAbove=c);continue}let f;if(r&&(f=d.match(r)))if(f[1]){let g=a.length-1;for(;g>0&&a[g].indent!==-2;)g--;if(g>0){a.length=g+1,u=a[g],o.insertFirst(c,u.line,h),u.line=c,u.indent=h,u.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(u.indent>h){do a.pop(),u=a[a.length-1];while(u.indent>h);const g=u.endAbove-1;g-c>=1&&o.insertFirst(c,g,h)}u.indent===h?u.endAbove=c:a.push({indent:h,endAbove:c,line:c})}return o.toIndentRanges(s)}const pje=F("editor.foldBackground",{light:Ct(Cg,.3),dark:Ct(Cg,.3),hcDark:null,hcLight:null},_(1002,"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.foldPlaceholderForeground",{light:"#808080",dark:"#808080",hcDark:null,hcLight:null},_(1003,"Color of the collapsed text after the first line of a folded range."));F("editorGutter.foldingControlForeground",pR,_(1004,"Color of the folding control in the editor gutter."));const $2=rn("folding-expanded",ge.chevronDown,_(1005,"Icon for expanded ranges in the editor glyph margin.")),q2=rn("folding-collapsed",ge.chevronRight,_(1006,"Icon for collapsed ranges in the editor glyph margin.")),yJ=rn("folding-manual-collapsed",q2,_(1007,"Icon for manually collapsed ranges in the editor glyph margin.")),SJ=rn("folding-manual-expanded",$2,_(1008,"Icon for manually expanded ranges in the editor glyph margin.")),s3={color:Mn(pje),position:1},nC=_(1009,"Click to expand the range."),eT=_(1010,"Click to collapse the range."),ds=class ds{constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?ds.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?ds.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:ds.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:ds.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?ds.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:ds.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?ds.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:ds.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?i?ds.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:ds.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?ds.MANUALLY_EXPANDED_VISUAL_DECORATION:ds.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}};ds.COLLAPSED_VISUAL_DECORATION=vt.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:it.asClassName(q2)}),ds.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=vt.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:s3,isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:it.asClassName(q2)}),ds.MANUALLY_COLLAPSED_VISUAL_DECORATION=vt.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:it.asClassName(yJ)}),ds.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=vt.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:s3,isWholeLine:!0,linesDecorationsTooltip:nC,firstLineDecorationClassName:it.asClassName(yJ)}),ds.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=vt.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:nC}),ds.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=vt.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:s3,isWholeLine:!0,linesDecorationsTooltip:nC}),ds.EXPANDED_VISUAL_DECORATION=vt.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+it.asClassName($2),linesDecorationsTooltip:eT}),ds.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=vt.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:it.asClassName($2),linesDecorationsTooltip:eT}),ds.MANUALLY_EXPANDED_VISUAL_DECORATION=vt.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+it.asClassName(SJ),linesDecorationsTooltip:eT}),ds.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=vt.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:it.asClassName(SJ),linesDecorationsTooltip:eT}),ds.NO_CONTROLS_EXPANDED_RANGE_DECORATION=vt.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0}),ds.HIDDEN_RANGE_DECORATION=vt.register({description:"folding-hidden-range-decoration",stickiness:1});let w8=ds;const _je={},bje="syntax";class _j{constructor(e,t,i,n,o){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=n,this.fallbackRangeProvider=o,this.id=bje,this.disposables=new oe,o&&this.disposables.add(o);for(const r of t)typeof r.onDidChange=="function"&&this.disposables.add(r.onDidChange(i))}compute(e){return vje(this.providers,this.editorModel,e).then(t=>{var i;return this.editorModel.isDisposed()?null:t?wje(t,this.foldingRangesLimit):((i=this.fallbackRangeProvider)==null?void 0:i.compute(e))??null})}dispose(){this.disposables.dispose()}}function vje(s,e,t){let i=null;const n=s.map((o,r)=>Promise.resolve(o.provideFoldingRanges(e,_je,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);const l=e.getLineCount();for(const c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:r,kind:c.kind})}},as));return Promise.all(n).then(o=>i)}class Cje{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,n){if(e>zc||t>zc)return;const o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=t,this._nestingLevels[o]=n,this._types[o]=i,this._length++,n<30&&(this._nestingLevelCounts[n]=(this._nestingLevelCounts[n]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let n=0;n<this._length;n++)t[n]=this._startIndexes[n],i[n]=this._endIndexes[n];return new Ha(t,i,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){const l=this._nestingLevelCounts[a];if(l){if(l+t>e){i=a;break}t+=l}}const n=new Uint32Array(e),o=new Uint32Array(e),r=[];for(let a=0,l=0;a<this._length;a++){const c=this._nestingLevels[a];(c<i||c===i&&t++<e)&&(n[l]=this._startIndexes[a],o[l]=this._endIndexes[a],r[l]=this._types[a],l++)}return new Ha(n,o,r)}}}function wje(s,e){const t=s.sort((r,a)=>{let l=r.start-a.start;return l===0&&(l=r.rank-a.rank),l}),i=new Cje(e);let n;const o=[];for(const r of t)if(!n)n=r,i.add(r.start,r.end,r.kind&&r.kind.value,o.length);else if(r.start>n.start)if(r.end<=n.end)o.push(n),n=r,i.add(r.start,r.end,r.kind&&r.kind.value,o.length);else{if(r.start>n.end){do n=o.pop();while(n&&r.start>n.end);n&&o.push(n),n=r}i.add(r.start,r.end,r.kind&&r.kind.value,o.length)}return i.toIndentRanges()}var yje=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},iS=function(s,e){return function(t,i){e(t,i,s)}},cp;const oo=new Ne("foldingEnabled",!1);var X_;let xm=(X_=class extends K{static get(e){return e.getContribution(cp.ID)}static getFoldingRangeProviders(e,t){var n;const i=e.foldingRangeProvider.ordered(t);return((n=cp._foldingRangeSelector)==null?void 0:n.call(cp,i,t))??i}constructor(e,t,i,n,o,r){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=r,this.localToDispose=this._register(new oe),this.editor=e,this._foldingLimitReporter=this._register(new Rhe(e));const a=this.editor.getOptions();this._isEnabled=a.get(52),this._useFoldingProviders=a.get(53)!=="indentation",this._unfoldOnClickAfterEndOfLine=a.get(57),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=a.get(55),this.updateDebounceInfo=o.for(r.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new w8(e),this.foldingDecorationProvider.showFoldingControls=a.get(126),this.foldingDecorationProvider.showFoldingHighlights=a.get(54),this.foldingEnabled=oo.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(l=>{if(l.hasChanged(52)&&(this._isEnabled=this.editor.getOptions().get(52),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),l.hasChanged(56)&&this.onModelChanged(),l.hasChanged(126)||l.hasChanged(54)){const c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(126),this.foldingDecorationProvider.showFoldingHighlights=c.get(54),this.triggerFoldingModelChanged()}l.hasChanged(53)&&(this._useFoldingProviders=this.editor.getOptions().get(53)!=="indentation",this.onFoldingStrategyChanged()),l.hasChanged(57)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(57)),l.hasChanged(55)&&(this._foldingImportsByDefault=this.editor.getOptions().get(55))})),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(!(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new nje(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new cje(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new Pl(this.updateDebounceInfo.get(e)),this.localToDispose.add(this.updateScheduler),this.cursorChangedScheduler=new Ni(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(t=>this.onDidChangeModelContent(t))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{var t,i;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),(t=this.updateScheduler)==null||t.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,(i=this.rangeProvider)==null||i.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var e;(e=this.rangeProvider)==null||e.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new pj(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=cp.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new _j(e,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var t;(t=this.hiddenRangeModel)==null||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=new Fs,i=this.getRangeProvider(e.textModel),n=this.foldingRegionPromise=ys(o=>i.compute(o));return n.then(o=>{if(o&&n===this.foldingRegionPromise){let r;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const c=o.setCollapsedAllOfType(yv.Imports.value,!0);c&&(r=ud.capture(this.editor),this._currentModelHasFoldedImports=c)}const a=this.editor.getSelections();e.update(o,Sje(a)),r==null||r.restore(this.editor);const l=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=l)}return e})}).then(void 0,e=>(_t(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const n=[];for(const o of i){const r=o.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(r)&&n.push(...t.getAllRegionsAtLine(r,a=>a.isCollapsed&&r>a.startLineNumber))}n.length&&(t.toggleCollapseState(n),this.reveal(i[0].getPosition()))}}}).then(void 0,_t)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const n=e.target.detail,o=e.target.element.offsetLeft;if(n.offsetX-o<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const n=this.editor.getModel();if(n&&t.startColumn===n.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,n=this.mouseDownInfo.iconClicked,o=e.target.range;if(!o||o.startLineNumber!==i)return;if(n){if(e.target.type!==4)return}else{const a=this.editor.getModel();if(!a||o.startColumn!==a.getLineMaxColumn(i))return}const r=t.getRegionAtLine(i);if(r&&r.startLineNumber===i){const a=r.isCollapsed;if(n||a){const l=e.event.altKey;let c=[];if(l){const d=u=>!u.containedBy(r)&&!r.containedBy(u),h=t.getRegionsInside(null,d);for(const u of h)u.isCollapsed&&c.push(u);c.length===0&&(c=h)}else{const d=e.event.middleButton||e.event.shiftKey;if(d)for(const h of t.getRegionsInside(r))h.isCollapsed===a&&c.push(h);(a||!d||c.length===0)&&c.push(r)}t.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}},cp=X_,X_.ID="editor.contrib.folding",X_);xm=cp=yje([iS(1,ut),iS(2,wn),iS(3,Hn),iS(4,$l),iS(5,We)],xm);class Rhe extends K{constructor(e){super(),this.editor=e,this._onDidChange=this._register(new q),this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(56)}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}class xo extends Fe{runEditorCommand(e,t,i){const n=e.get(wn),o=xm.get(t);if(!o)return;const r=o.getFoldingModel();if(r)return this.reportTelemetry(e,t),r.then(a=>{if(a){this.invoke(o,a,t,i,n);const l=t.getSelection();l&&o.reveal(l.getStartPosition())}})}getSelectedLines(e){const t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function Sje(s){return!s||s.length===0?{startsInside:()=>!1}:{startsInside(e,t){for(const i of s){const n=i.startLineNumber;if(n>=e&&n<=t)return!0}return!1}}}function Mhe(s){if(!Mo(s)){if(!ws(s))return!1;const e=s;if(!Mo(e.levels)&&!af(e.levels)||!Mo(e.direction)&&!As(e.direction)||!Mo(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(af)))return!1}return!0}class xje extends xo{constructor(){super({id:"editor.unfold",label:ne(982,"Unfold"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},metadata:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:Mhe,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const o=n&&n.levels||1,r=this.getLineNumbers(n,i);n&&n.direction==="up"?The(t,!1,o,r):w0(t,!1,o,r)}}class Lje extends xo{constructor(){super({id:"editor.unfoldRecursively",label:ne(983,"Unfold Recursively"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2142),weight:100}})}invoke(e,t,i,n){w0(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class Ije extends xo{constructor(){super({id:"editor.fold",label:ne(984,"Fold"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},metadata:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:Mhe,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const o=this.getLineNumbers(n,i),r=n&&n.levels,a=n&&n.direction;typeof r!="number"&&typeof a!="string"?sje(t,!0,o):a==="up"?The(t,!0,r||1,o):w0(t,!0,r||1,o)}}class Eje extends xo{constructor(){super({id:"editor.toggleFold",label:ne(985,"Toggle Fold"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2090),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);fj(t,1,n)}}class kje extends xo{constructor(){super({id:"editor.foldRecursively",label:ne(986,"Fold Recursively"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2140),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);w0(t,!0,Number.MAX_VALUE,n)}}class Dje extends xo{constructor(){super({id:"editor.toggleFoldRecursively",label:ne(987,"Toggle Fold Recursively"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,3114),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);fj(t,Number.MAX_VALUE,n)}}class Tje extends xo{constructor(){super({id:"editor.foldAllBlockComments",label:ne(988,"Fold All Block Comments"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2138),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())mj(t,yv.Comment.value,!0);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).comments;if(a&&a.blockCommentStartToken){const l=new RegExp("^\\s*"+ua(a.blockCommentStartToken));gj(t,l,!0)}}}}class Nje extends xo{constructor(){super({id:"editor.foldAllMarkerRegions",label:ne(989,"Fold All Regions"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2077),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())mj(t,yv.Region.value,!0);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);gj(t,l,!0)}}}}class Rje extends xo{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:ne(990,"Unfold All Regions"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2078),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())mj(t,yv.Region.value,!1);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);gj(t,l,!1)}}}}class Mje extends xo{constructor(){super({id:"editor.foldAllExcept",label:ne(991,"Fold All Except Selected"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2136),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);Nhe(t,!0,n)}}class Aje extends xo{constructor(){super({id:"editor.unfoldAllExcept",label:ne(992,"Unfold All Except Selected"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2134),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);Nhe(t,!1,n)}}class Pje extends xo{constructor(){super({id:"editor.foldAll",label:ne(993,"Fold All"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2069),weight:100}})}invoke(e,t,i){w0(t,!0)}}class Oje extends xo{constructor(){super({id:"editor.unfoldAll",label:ne(994,"Unfold All"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2088),weight:100}})}invoke(e,t,i){w0(t,!1)}}const o1=class o1 extends xo{getFoldingLevel(){return parseInt(this.id.substr(o1.ID_PREFIX.length))}invoke(e,t,i){oje(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}};o1.ID_PREFIX="editor.foldLevel",o1.ID=e=>o1.ID_PREFIX+e;let j2=o1;class Fje extends xo{constructor(){super({id:"editor.gotoParentFold",label:ne(995,"Go to Parent Fold"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const o=rje(n[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class Bje extends xo{constructor(){super({id:"editor.gotoPreviousFold",label:ne(996,"Go to Previous Folding Range"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const o=aje(n[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class Wje extends xo{constructor(){super({id:"editor.gotoNextFold",label:ne(997,"Go to Next Folding Range"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const o=lje(n[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class Hje extends xo{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:ne(998,"Create Folding Range from Selection"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2135),weight:100}})}invoke(e,t,i){var r;const n=[],o=i.getSelections();if(o){for(const a of o){let l=a.endLineNumber;a.endColumn===1&&--l,l>a.startLineNumber&&(n.push({startLineNumber:a.startLineNumber,endLineNumber:l,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:a.startLineNumber,startColumn:1,endLineNumber:a.startLineNumber,endColumn:1}))}if(n.length>0){n.sort((l,c)=>l.startLineNumber-c.startLineNumber);const a=Ha.sanitizeAndMerge(t.regions,n,(r=i.getModel())==null?void 0:r.getLineCount());t.updatePost(Ha.fromFoldRanges(a))}}}}class Vje extends xo{constructor(){super({id:"editor.removeManualFoldingRanges",label:ne(999,"Remove Manual Folding Ranges"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2137),weight:100}})}invoke(e,t,i){const n=i.getSelections();if(n){const o=[];for(const r of n){const{startLineNumber:a,endLineNumber:l}=r;o.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(o),e.triggerFoldingModelChanged()}}}class zje extends xo{constructor(){super({id:"editor.toggleImportFold",label:ne(1e3,"Toggle Import Fold"),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,weight:100}})}async invoke(e,t){const i=[],n=t.regions;for(let o=n.length-1;o>=0;o--)n.getType(o)===yv.Imports.value&&i.push(n.toRegion(o));t.toggleCollapseState(i),e.triggerFoldingModelChanged()}}Qt(xm.ID,xm,0);xe(xje);xe(Lje);xe(Ije);xe(kje);xe(Dje);xe(Pje);xe(Oje);xe(Tje);xe(Nje);xe(Rje);xe(Mje);xe(Aje);xe(Eje);xe(Fje);xe(Bje);xe(Wje);xe(Hje);xe(Vje);xe(zje);for(let s=1;s<=7;s++)FNe(new j2({id:j2.ID(s),label:ne(1001,"Fold Level {0}",s),precondition:oo,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2048|21+s),weight:100}}));Zt.registerCommand("_executeFoldingRangeProvider",async function(s,...e){const[t]=e;if(!(t instanceof Ze))throw kl();const i=s.get(We),n=s.get(Cn).getModel(t);if(!n)throw kl();const o=s.get(xt);if(!o.getValue("editor.folding",{resource:t}))return[];const r=s.get(wn),a=o.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return o.getValue("editor.foldingMaximumRegions",{resource:t})},update:(f,g)=>{}},c=new pj(n,r,l);let d=c;if(a!=="indentation"){const f=xm.getFoldingRangeProviders(i,n);f.length&&(d=new _j(n,f,()=>{},l,c))}const h=await d.compute(Ft.None),u=[];try{if(h)for(let f=0;f<h.length;f++){const g=h.getType(f);u.push({start:h.getStartLineNumber(f),end:h.getEndLineNumber(f),kind:g?yv.fromValue(g):void 0})}return u}finally{d.dispose()}});class Uje extends Fe{constructor(){super({id:"editor.action.fontZoomIn",label:ne(1011,"Increase Editor Font Size"),precondition:void 0})}run(e,t){yl.setZoomLevel(yl.getZoomLevel()+1)}}class $je extends Fe{constructor(){super({id:"editor.action.fontZoomOut",label:ne(1012,"Decrease Editor Font Size"),precondition:void 0})}run(e,t){yl.setZoomLevel(yl.getZoomLevel()-1)}}class qje extends Fe{constructor(){super({id:"editor.action.fontZoomReset",label:ne(1013,"Reset Editor Font Size"),precondition:void 0})}run(e,t){yl.setZoomLevel(0)}}xe(Uje);xe($je);xe(qje);class $w{static _handleEolEdits(e,t){let i;const n=[];for(const o of t)typeof o.eol=="number"&&(i=o.eol),o.range&&typeof o.text=="string"&&n.push(o);return typeof i=="number"&&e.hasModel()&&e.getModel().pushEOL(i),n}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),n=i.validateRange(t.range);return i.getFullModelRange().equalsRange(n)}static execute(e,t,i){i&&e.pushUndoStop();const n=ud.capture(e),o=$w._handleEolEdits(e,t);o.length===1&&$w._isFullModelReplaceEdit(e,o[0])?e.executeEdits("formatEditsCommand",o.map(r=>Pn.replace(D.lift(r.range),r.text))):e.executeEdits("formatEditsCommand",o.map(r=>Pn.replaceMove(D.lift(r.range),r.text))),i&&e.pushUndoStop(),n.restoreRelativeVerticalPositionOfCursor(e)}}class xJ{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class jje{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(xJ.toKey(e))}has(e){return this._set.has(xJ.toKey(e))}}function Ahe(s,e,t){const i=[],n=new jje,o=s.ordered(t);for(const a of o)i.push(a),a.extensionId&&n.add(a.extensionId);const r=e.ordered(t);for(const a of r){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,d){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,d)}})}return i}const Gx=class Gx{static setFormatterSelector(e){return{dispose:Gx._selectors.unshift(e)}}static async select(e,t,i,n){if(e.length===0)return;const o=Gt.first(Gx._selectors);if(o)return await o(e,t,i,n)}};Gx._selectors=new Zo;let EI=Gx;async function Phe(s,e,t,i,n,o,r){const a=s.get($e),{documentRangeFormattingEditProvider:l}=s.get(We),c=gd(e)?e.getModel():e,d=l.ordered(c),h=await EI.select(d,c,i,2);h&&(n.report(h),await a.invokeFunction(Kje,h,e,t,o,r))}async function Kje(s,e,t,i,n,o){var v,b;const r=s.get(jr),a=s.get(Ji),l=s.get(Df);let c,d;gd(t)?(c=t.getModel(),d=new Cf(t,5,void 0,n)):(c=t,d=new Sq(t,n));const h=[];let u=0;for(const w of DU(i).sort(D.compareRangesUsingStarts))u>0&&D.areIntersectingOrTouching(h[u-1],w)?h[u-1]=D.fromPositions(h[u-1].getStartPosition(),w.getEndPosition()):u=h.push(w);const f=async w=>{var y,x;a.trace("[format][provideDocumentRangeFormattingEdits] (request)",(y=e.extensionId)==null?void 0:y.value,w);const C=await e.provideDocumentRangeFormattingEdits(c,w,c.getFormattingOptions(),d.token)||[];return a.trace("[format][provideDocumentRangeFormattingEdits] (response)",(x=e.extensionId)==null?void 0:x.value,C),C},g=(w,C)=>{if(!w.length||!C.length)return!1;const y=w.reduce((x,S)=>D.plusRange(x,S.range),w[0].range);if(!C.some(x=>D.intersectRanges(y,x.range)))return!1;for(const x of w)for(const S of C)if(D.intersectRanges(x.range,S.range))return!0;return!1},m=[],p=[];try{if(typeof e.provideDocumentRangesFormattingEdits=="function"){a.trace("[format][provideDocumentRangeFormattingEdits] (request)",(v=e.extensionId)==null?void 0:v.value,h);const w=await e.provideDocumentRangesFormattingEdits(c,h,c.getFormattingOptions(),d.token)||[];a.trace("[format][provideDocumentRangeFormattingEdits] (response)",(b=e.extensionId)==null?void 0:b.value,w),p.push(w)}else{for(const w of h){if(d.token.isCancellationRequested)return!0;p.push(await f(w))}for(let w=0;w<h.length;++w)for(let C=w+1;C<h.length;++C){if(d.token.isCancellationRequested)return!0;if(g(p[w],p[C])){const y=D.plusRange(h[w],h[C]),x=await f(y);h.splice(C,1),h.splice(w,1),h.push(y),p.splice(C,1),p.splice(w,1),p.push(x),w=0,C=0}}}for(const w of p){if(d.token.isCancellationRequested)return!0;const C=await r.computeMoreMinimalEdits(c.uri,w);C&&m.push(...C)}if(d.token.isCancellationRequested)return!0}finally{d.dispose()}if(m.length===0)return!1;if(gd(t))$w.execute(t,m,!0),t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:w}]=m,C=new Oe(w.startLineNumber,w.startColumn,w.endLineNumber,w.endColumn);c.pushEditOperations([C],m.map(y=>({text:y.text,range:D.lift(y.range),forceMoveMarkers:!0})),y=>{for(const{range:x}of y)if(D.areIntersectingOrTouching(x,C))return[new Oe(x.startLineNumber,x.startColumn,x.endLineNumber,x.endColumn)];return null})}return l.playSignal(ur.format,{userGesture:o}),!0}async function Gje(s,e,t,i,n,o){const r=s.get($e),a=s.get(We),l=gd(e)?e.getModel():e,c=Ahe(a.documentFormattingEditProvider,a.documentRangeFormattingEditProvider,l),d=await EI.select(c,l,t,1);d&&(i.report(d),await r.invokeFunction(Yje,d,e,t,n,o))}async function Yje(s,e,t,i,n,o){const r=s.get(jr),a=s.get(Df);let l,c;gd(t)?(l=t.getModel(),c=new Cf(t,5,void 0,n)):(l=t,c=new Sq(t,n));let d;try{const h=await e.provideDocumentFormattingEdits(l,l.getFormattingOptions(),c.token);if(d=await r.computeMoreMinimalEdits(l.uri,h),c.token.isCancellationRequested)return!0}finally{c.dispose()}if(!d||d.length===0)return!1;if(gd(t))$w.execute(t,d,i!==2),i!==2&&t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:h}]=d,u=new Oe(h.startLineNumber,h.startColumn,h.endLineNumber,h.endColumn);l.pushEditOperations([u],d.map(f=>({text:f.text,range:D.lift(f.range),forceMoveMarkers:!0})),f=>{for(const{range:g}of f)if(D.areIntersectingOrTouching(g,u))return[new Oe(g.startLineNumber,g.startColumn,g.endLineNumber,g.endColumn)];return null})}return a.playSignal(ur.format,{userGesture:o}),!0}async function Xje(s,e,t,i,n,o){const r=e.documentRangeFormattingEditProvider.ordered(t);for(const a of r){const l=await Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,n,o)).catch(as);if(er(l))return await s.computeMoreMinimalEdits(t.uri,l)}}async function Zje(s,e,t,i,n){const o=Ahe(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const r of o){const a=await Promise.resolve(r.provideDocumentFormattingEdits(t,i,n)).catch(as);if(er(a))return await s.computeMoreMinimalEdits(t.uri,a)}}function Ohe(s,e,t,i,n,o,r){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,n,o,r)).catch(as).then(l=>s.computeMoreMinimalEdits(t.uri,l))}Zt.registerCommand("_executeFormatRangeProvider",async function(s,...e){const[t,i,n]=e;ti(Ze.isUri(t)),ti(D.isIRange(i));const o=s.get(nr),r=s.get(jr),a=s.get(We),l=await o.createModelReference(t);try{return Xje(r,a,l.object.textEditorModel,D.lift(i),n,Ft.None)}finally{l.dispose()}});Zt.registerCommand("_executeFormatDocumentProvider",async function(s,...e){const[t,i]=e;ti(Ze.isUri(t));const n=s.get(nr),o=s.get(jr),r=s.get(We),a=await n.createModelReference(t);try{return Zje(o,r,a.object.textEditorModel,i,Ft.None)}finally{a.dispose()}});Zt.registerCommand("_executeFormatOnTypeProvider",async function(s,...e){const[t,i,n,o]=e;ti(Ze.isUri(t)),ti(z.isIPosition(i)),ti(typeof n=="string");const r=s.get(nr),a=s.get(jr),l=s.get(We),c=await r.createModelReference(t);try{return Ohe(a,l,c.object.textEditorModel,z.lift(i),n,o,Ft.None)}finally{c.dispose()}});var Fhe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},gx=function(s,e){return function(t,i){e(t,i,s)}},K1;let K2=(K1=class{constructor(e,t,i,n){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._accessibilitySignalService=n,this._disposables=new oe,this._sessionDisposables=new oe,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(o=>{o.hasChanged(65)&&this._update()})),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(65)||!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;const i=new nR;for(const n of t.autoFormatTriggerCharacters)i.add(n.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType(n=>{const o=n.charCodeAt(n.length-1);i.has(o)&&this._trigger(String.fromCharCode(o))}))}_trigger(e){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=new hn,o=this._editor.onDidChangeModelContent(r=>{if(r.isFlush){n.cancel(),o.dispose();return}for(let a=0,l=r.changes.length;a<l;a++)if(r.changes[a].range.endLineNumber<=i.lineNumber){n.cancel(),o.dispose();return}});Ohe(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),n.token).then(r=>{n.token.isCancellationRequested||er(r)&&(this._accessibilitySignalService.playSignal(ur.format,{userGesture:!1}),$w.execute(this._editor,r,!0))}).finally(()=>{o.dispose()})}},K1.ID="editor.contrib.autoFormat",K1);K2=Fhe([gx(1,We),gx(2,jr),gx(3,Df)],K2);var G1;let G2=(G1=class{constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new oe,this._callOnModel=new oe,this._callOnDispose.add(e.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(e.onDidChangeModel(()=>this._update())),this._callOnDispose.add(e.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(64)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste(({range:e})=>this._trigger(e)))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(Phe,this.editor,e,2,ed.None,Ft.None,!1).catch(_t))}},G1.ID="editor.contrib.formatOnPaste",G1);G2=Fhe([gx(1,We),gx(2,$e)],G2);class Qje extends Fe{constructor(){super({id:"editor.action.formatDocument",label:ne(1014,"Format Document"),precondition:de.and(B.notInCompositeEditor,B.writable,B.hasDocumentFormattingProvider),kbOpts:{kbExpr:B.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}async run(e,t){if(t.hasModel()){const i=e.get($e);await e.get(vf).showWhile(i.invokeFunction(Gje,t,1,ed.None,Ft.None,!0),250)}}}class Jje extends Fe{constructor(){super({id:"editor.action.formatSelection",label:ne(1015,"Format Selection"),precondition:de.and(B.writable,B.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2084),weight:100},contextMenuOpts:{when:B.hasNonEmptySelection,group:"1_modification",order:1.31}})}async run(e,t){if(!t.hasModel())return;const i=e.get($e),n=t.getModel(),o=t.getSelections().map(a=>a.isEmpty()?new D(a.startLineNumber,1,a.startLineNumber,n.getLineMaxColumn(a.startLineNumber)):a);await e.get(vf).showWhile(i.invokeFunction(Phe,t,o,1,ed.None,Ft.None,!0),250)}}Qt(K2.ID,K2,2);Qt(G2.ID,G2,2);xe(Qje);xe(Jje);Zt.registerCommand("editor.action.format",async s=>{const e=s.get(ii).getFocusedCodeEditor();if(!e||!e.hasModel())return;const t=s.get(en);e.getSelection().isEmpty()?await t.executeCommand("editor.action.formatDocument"):await t.executeCommand("editor.action.formatSelection")});var eKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},o3=function(s,e){return function(t,i){e(t,i,s)}};class FC{remove(){var e;(e=this.parent)==null||e.children.delete(this.id)}static findId(e,t){let i;typeof e=="string"?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,t.children.get(i)!==void 0&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let o=0;t.children.get(n)!==void 0;o++)n=`${i}_${o}`;return n}static empty(e){return e.children.size===0}}class y8 extends FC{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class Bhe extends FC{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class Cu extends FC{static create(e,t,i){const n=new hn(i),o=new Cu(t.uri),r=e.ordered(t),a=r.map((c,d)=>{const h=FC.findId(`provider_${d}`,o),u=new Bhe(h,o,c.displayName??"Unknown Outline Provider",d);return Promise.resolve(c.provideDocumentSymbols(t,n.token)).then(f=>{for(const g of f||[])Cu._makeOutlineElement(g,u);return u},f=>(as(f),u)).then(f=>{FC.empty(f)?f.remove():o._groups.set(h,f)})}),l=e.onDidChange(()=>{const c=e.ordered(t);dn(c,r)||n.cancel()});return Promise.all(a).then(()=>n.token.isCancellationRequested&&!i.isCancellationRequested?Cu.create(e,t,i):o._compact()).finally(()=>{n.dispose(),l.dispose(),n.dispose()})}static _makeOutlineElement(e,t){const i=FC.findId(e,t),n=new y8(i,t,e);if(e.children)for(const o of e.children)Cu._makeOutlineElement(o,n);t.children.set(n.id,n)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)i.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{const t=Gt.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof y8?e.push(t.symbol):e.push(...Gt.map(t.children.values(),i=>i.symbol));return e.sort((t,i)=>D.compareRangesUsingStarts(t.range,i.range))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return Cu._flattenDocumentSymbols(t,e,""),t.sort((i,n)=>z.compare(D.getStartPosition(i.range),D.getStartPosition(n.range))||z.compare(D.getEndPosition(n.range),D.getEndPosition(i.range)))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&Cu._flattenDocumentSymbols(e,n.children,n.name)}}const zk=Mt("IOutlineModelService");let S8=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new oe,this._cache=new Cc(15,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved(n=>{this._cache.delete(n.id)}))}dispose(){this._disposables.dispose()}async getOrCreate(e,t){const i=this._languageFeaturesService.documentSymbolProvider,n=i.ordered(e);let o=this._cache.get(e.id);if(!o||o.versionId!==e.getVersionId()||!dn(o.provider,n)){const a=new hn;o={versionId:e.getVersionId(),provider:n,promiseCnt:0,source:a,promise:Cu.create(i,e,a.token),model:void 0},this._cache.set(e.id,o);const l=Date.now();o.promise.then(c=>{o.model=c,this._debounceInformation.update(e,Date.now()-l)}).catch(c=>{this._cache.delete(e.id)})}if(o.model)return o.model;o.promiseCnt+=1;const r=t.onCancellationRequested(()=>{--o.promiseCnt===0&&(o.source.cancel(),this._cache.delete(e.id))});try{return await o.promise}finally{r.dispose()}}};S8=eKe([o3(0,We),o3(1,$l),o3(2,Cn)],S8);Vt(zk,S8,1);Zt.registerCommand("_executeDocumentSymbolProvider",async function(s,...e){const[t]=e;ti(Ze.isUri(t));const i=s.get(zk),o=await s.get(nr).createModelReference(t);try{return(await i.getOrCreate(o.object.textEditorModel,Ft.None)).getTopLevelSymbols()}finally{o.dispose()}});const M4=new class{constructor(){this._implementations=[]}register(e){return this._implementations.push(e),{dispose:()=>{const t=this._implementations.indexOf(e);t!==-1&&this._implementations.splice(t,1)}}}getImplementations(){return this._implementations}};var tKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},iKe=function(s,e){return function(t,i){e(t,i,s)}};function nKe(s){return s instanceof Whe?s._instance:s}let Whe=class{constructor(e){this.instantiationService=e}init(...e){}};function sKe(s){return s.get()}let LJ=class extends Whe{constructor(e,t){super(t),this.init(e)}};LJ=tKe([iKe(1,$e)],LJ);class Uk{validateOrThrow(e){const t=this.validate(e);if(t.error)throw new Error(t.error.message);return t.content}}class A4 extends Uk{constructor(e){super(),this.type=e}validate(e){return typeof e!==this.type?{content:void 0,error:{message:`Expected ${this.type}, but got ${typeof e}`}}:{content:e,error:void 0}}getJSONSchema(){return{type:this.type}}}const oKe=new A4("string");function rKe(){return oKe}new A4("number");const aKe=new A4("boolean");function IJ(){return aKe}new A4("object");class Hhe extends Uk{validate(e){return e!==void 0?{content:void 0,error:{message:`Expected undefined, but got ${typeof e}`}}:{content:void 0,error:void 0}}getJSONSchema(){return{}}}function lKe(){return new Hhe}class x8{constructor(e){this.validator=e}}function r3(s){return new x8(s)}class cKe extends Uk{constructor(e){super(),this.properties=e}validate(e){if(typeof e!="object"||e===null)return{content:void 0,error:{message:"Expected object"}};const t={};for(const i in this.properties){const n=this.properties[i],o=e[i],r=n instanceof x8,a=r?n.validator:n;if(r&&o===void 0)continue;const{content:l,error:c}=a.validate(o);if(c)return{content:void 0,error:{message:`Error in property '${i}': ${c.message}`}};t[i]=l}return{content:t,error:void 0}}getJSONSchema(){const e=[],t={};for(const[n,o]of Object.entries(this.properties)){const r=o instanceof x8,a=r?o.validator:o;t[n]=a.getJSONSchema(),r||e.push(n)}return{type:"object",properties:t,...e.length>0?{required:e}:{}}}}function dKe(s){return new cKe(s)}class hKe extends Uk{constructor(e){super(),this.validators=e}validate(e){let t;for(const i of this.validators){const{content:n,error:o}=i.validate(e);if(!o)return{content:n,error:void 0};t=o}return{content:void 0,error:t}}getJSONSchema(){return{oneOf:iTe(this.validators,e=>{if(!(e instanceof Hhe))return e.getJSONSchema()})}}}function uKe(...s){return new hKe(s)}class fKe extends Uk{constructor(e,t){super(),this._ref=e,this._validator=t}validate(e){return this._validator.validate(e)}getJSONSchema(){return{$ref:this._ref}}}function gKe(s,e){return new fKe(s,e)}const Pt={Visible:Fq,HasFocusedSuggestion:new Ne("suggestWidgetHasFocusedSuggestion",!1,_(1455,"Whether any suggestion is focused")),DetailsVisible:new Ne("suggestWidgetDetailsVisible",!1,_(1456,"Whether suggestion details are visible")),MultipleSuggestions:new Ne("suggestWidgetMultipleSuggestions",!1,_(1457,"Whether there are multiple suggestions to pick from")),MakesTextEdit:new Ne("suggestionMakesTextEdit",!0,_(1458,"Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new Ne("acceptSuggestionOnEnter",!0,_(1459,"Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new Ne("suggestionHasInsertAndReplaceRange",!1,_(1460,"Whether the current suggestion has insert and replace behaviour")),InsertMode:new Ne("suggestionInsertMode",void 0,{type:"string",description:_(1461,"Whether the default behaviour is to insert or replace")}),CanResolve:new Ne("suggestionCanResolve",!1,_(1462,"Whether the current suggestion supports to resolve further details"))},$g=new He("suggestWidgetStatusBar");class mKe{constructor(e,t,i,n){var o;this.position=e,this.completion=t,this.container=i,this.provider=n,this.isInvalid=!1,this.score=fc.Default,this.distance=0,this.textLabel=typeof t.label=="string"?t.label:(o=t.label)==null?void 0:o.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),this.extensionId=t.extensionId,D.isIRange(t.range)?(this.editStart=new z(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new z(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new z(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||D.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new z(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new z(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new z(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||D.spansMultipleLines(t.range.insert)||D.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof n.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(e){if(!this._resolveCache){const t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),i=new Fs(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(n=>{Object.assign(this.completion,n),this._resolveDuration=i.elapsed()},n=>{il(n)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{t.dispose()})}return this._resolveCache}}const YA=class YA{constructor(e=2,t=new Set,i=new Set,n=new Map,o=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=i,this.providerItemsToReuse=n,this.showDeprecated=o}};YA.default=new YA;let kI=YA;class pKe{constructor(e,t,i,n){this.items=e,this.needsClipboard=t,this.durations=i,this.disposable=n}}async function bj(s,e,t,i=kI.default,n={triggerKind:0},o=Ft.None){const r=new Fs;t=t.clone();const a=e.getWordAtPosition(t),l=a?new D(t.lineNumber,a.startColumn,t.lineNumber,a.endColumn):D.fromPositions(t),c={replace:l,insert:l.setEndPosition(t.lineNumber,t.column)},d=[],h=new oe,u=[];let f=!1;const g=(p,v,b)=>{var C;let w=!1;if(!v)return w;for(const y of v.suggestions)if(!i.kindFilter.has(y.kind)){if(!i.showDeprecated&&((C=y==null?void 0:y.tags)!=null&&C.includes(1)))continue;y.range||(y.range=c),y.sortText||(y.sortText=typeof y.label=="string"?y.label:y.label.label),!f&&y.insertTextRules&&y.insertTextRules&4&&(f=Gb.guessNeedsClipboard(y.insertText)),d.push(new mKe(t,y,v,p)),w=!0}return fv(v)&&h.add(v),u.push({providerName:p._debugDisplayName??"unknown_provider",elapsedProvider:v.duration??-1,elapsedOverall:b.elapsed()}),w},m=(async()=>{})();for(const p of s.orderedGroups(e)){let v=!1;if(await Promise.all(p.map(async b=>{if(i.providerItemsToReuse.has(b)){const w=i.providerItemsToReuse.get(b);w.forEach(C=>d.push(C)),v=v||w.length>0;return}if(!(i.providerFilter.size>0&&!i.providerFilter.has(b)))try{const w=new Fs,C=await b.provideCompletionItems(e,t,n,o);v=g(b,C,w)||v}catch(w){as(w)}})),v||o.isCancellationRequested)break}return await m,o.isCancellationRequested?(h.dispose(),Promise.reject(new Ml)):new pKe(d.sort(vKe(i.snippetSortOrder)),f,{entries:u,elapsed:r.elapsed()},h)}function vj(s,e){if(s.sortTextLow&&e.sortTextLow){if(s.sortTextLow<e.sortTextLow)return-1;if(s.sortTextLow>e.sortTextLow)return 1}return s.textLabel<e.textLabel?-1:s.textLabel>e.textLabel?1:s.completion.kind-e.completion.kind}function _Ke(s,e){if(s.completion.kind!==e.completion.kind){if(s.completion.kind===28)return-1;if(e.completion.kind===28)return 1}return vj(s,e)}function bKe(s,e){if(s.completion.kind!==e.completion.kind){if(s.completion.kind===28)return 1;if(e.completion.kind===28)return-1}return vj(s,e)}const P4=new Map;P4.set(0,_Ke);P4.set(2,bKe);P4.set(1,vj);function vKe(s){return P4.get(s)}Zt.registerCommand("_executeCompletionItemProvider",async(s,...e)=>{const[t,i,n,o]=e;ti(Ze.isUri(t)),ti(z.isIPosition(i)),ti(typeof n=="string"||!n),ti(typeof o=="number"||!o);const{completionProvider:r}=s.get(We),a=await s.get(nr).createModelReference(t);try{const l={incomplete:!1,suggestions:[]},c=[],d=a.object.textEditorModel.validatePosition(i),h=await bj(r,a.object.textEditorModel,d,void 0,{triggerCharacter:n??void 0,triggerKind:n?1:0});for(const u of h.items)c.length<(o??0)&&c.push(u.resolve(Ft.None)),l.incomplete=l.incomplete||u.container.incomplete,l.suggestions.push(u.completion);try{return await Promise.all(c),l}finally{setTimeout(()=>h.disposable.dispose(),100)}}finally{a.dispose()}});function CKe(s,e){var t;(t=s.getContribution("editor.contrib.suggestController"))==null||t.triggerSuggest(new Set().add(e),void 0,!0)}class BC{static isAllOff(e){return e.other==="off"&&e.comments==="off"&&e.strings==="off"}static isAllOn(e){return e.other==="on"&&e.comments==="on"&&e.strings==="on"}static valueFor(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}}const Da=class Da{};Da.inlineSuggestionVisible=new Ne("inlineSuggestionVisible",!1,_(1192,"Whether an inline suggestion is visible")),Da.inlineSuggestionHasIndentation=new Ne("inlineSuggestionHasIndentation",!1,_(1193,"Whether the inline suggestion starts with whitespace")),Da.inlineSuggestionHasIndentationLessThanTabSize=new Ne("inlineSuggestionHasIndentationLessThanTabSize",!0,_(1194,"Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),Da.suppressSuggestions=new Ne("inlineSuggestionSuppressSuggestions",void 0,_(1195,"Whether suggestions should be suppressed for the current suggestion")),Da.cursorBeforeGhostText=new Ne("cursorBeforeGhostText",!1,_(1196,"Whether the cursor is at ghost text")),Da.cursorInIndentation=new Ne("cursorInIndentation",!1,_(1197,"Whether the cursor is in indentation")),Da.hasSelection=new Ne("editor.hasSelection",!1,_(1198,"Whether the editor has a selection")),Da.cursorAtInlineEdit=new Ne("cursorAtInlineEdit",!1,_(1199,"Whether the cursor is at an inline edit")),Da.inlineEditVisible=new Ne("inlineEditIsVisible",!1,_(1200,"Whether an inline edit is visible")),Da.tabShouldJumpToInlineEdit=new Ne("tabShouldJumpToInlineEdit",!1,_(1201,"Whether tab should jump to an inline edit.")),Da.tabShouldAcceptInlineEdit=new Ne("tabShouldAcceptInlineEdit",!1,_(1202,"Whether tab should accept the inline edit.")),Da.inInlineEditsPreviewEditor=new Ne("inInlineEditsPreviewEditor",!0,_(1203,"Whether the current code editor is showing an inline edits preview"));let Fi=Da;class wKe{constructor(e,t,i){this._selection=e,this._cursors=t,this._selectionId=null,this._trimInRegexesAndStrings=i}getEditOperations(e,t){const i=yKe(e,this._cursors,this._trimInRegexesAndStrings);for(let n=0,o=i.length;n<o;n++){const r=i[n];t.addEditOperation(r.range,r.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function yKe(s,e,t){e.sort((a,l)=>a.lineNumber===l.lineNumber?a.column-l.column:a.lineNumber-l.lineNumber);for(let a=e.length-2;a>=0;a--)e[a].lineNumber===e[a+1].lineNumber&&e.splice(a,1);const i=[];let n=0,o=0;const r=e.length;for(let a=1,l=s.getLineCount();a<=l;a++){const c=s.getLineContent(a),d=c.length+1;let h=0;if(o<r&&e[o].lineNumber===a&&(h=e[o].column,o++,h===d)||c.length===0)continue;const u=uc(c);let f=0;if(u===-1)f=1;else if(u!==c.length-1)f=u+2;else continue;if(!t){if(!s.tokenization.hasAccurateTokensForLine(a))continue;const g=s.tokenization.getLineTokens(a),m=g.getStandardTokenType(g.findTokenIndexAtOffset(f));if(m===2||m===3)continue}f=Math.max(h,f),i[n++]=Pn.delete(new D(a,f,a,d))}return i}class Vhe{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=[];for(let r=i.startLineNumber;r<=i.endLineNumber;r++)n.push(e.getLineContent(r));const o=n.join(`
`);o===""&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new D(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":`
`):this._isCopyingDown?t.addEditOperation(new D(i.startLineNumber,1,i.startLineNumber,1),o+`
`):t.addEditOperation(new D(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),`
`+o),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let n=i.startLineNumber,o=i.startColumn,r=i.endLineNumber,a=i.endColumn;this._startLineNumberDelta!==0&&(n=n+this._startLineNumberDelta,o=1),this._endLineNumberDelta!==0&&(r=r+this._endLineNumberDelta,a=1),i=Oe.createWithDirection(n,o,r,a,this._selectionDirection)}return i}}function Zr(s,e){let t=0;for(let i=0;i<s.length;i++)s.charAt(i)==="	"?t+=e:t++;return t}function mx(s,e,t){s=s<0?0:s;let i="";if(!t){const n=Math.floor(s/e);s=s%e;for(let o=0;o<n;o++)i+="	"}for(let n=0;n<s;n++)i+=" ";return i}var SKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},xKe=function(s,e){return function(t,i){e(t,i,s)}};let L8=class{constructor(e,t,i,n){this._languageConfigurationService=n,this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const i=()=>e.getLanguageId(),n=(h,u)=>e.getLanguageIdAtPosition(h,u),o=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===o){this._selectionId=t.trackSelection(this._selection);return}if(!this._isMovingDown&&this._selection.startLineNumber===1){this._selectionId=t.trackSelection(this._selection);return}this._moveEndPositionDown=!1;let r=this._selection;r.startLineNumber<r.endLineNumber&&r.endColumn===1&&(this._moveEndPositionDown=!0,r=r.setEndPosition(r.endLineNumber-1,e.getLineMaxColumn(r.endLineNumber-1)));const{tabSize:a,indentSize:l,insertSpaces:c}=e.getOptions(),d=this.buildIndentConverter(a,l,c);if(r.startLineNumber===r.endLineNumber&&e.getLineMaxColumn(r.startLineNumber)===1){const h=r.startLineNumber,u=this._isMovingDown?h+1:h-1;e.getLineMaxColumn(u)===1?t.addEditOperation(new D(1,1,1,1),null):(t.addEditOperation(new D(h,1,h,1),e.getLineContent(u)),t.addEditOperation(new D(u,1,u,e.getLineMaxColumn(u)),null)),r=new Oe(u,1,u,1)}else{let h,u;if(this._isMovingDown){h=r.endLineNumber+1,u=e.getLineContent(h),t.addEditOperation(new D(h-1,e.getLineMaxColumn(h-1),h,e.getLineMaxColumn(h)),null);let f=u;if(this.shouldAutoIndent(e,r)){const g=this.matchEnterRule(e,d,a,h,r.startLineNumber-1);if(g!==null){const p=Ui(e.getLineContent(h)),v=g+Zr(p,a);f=mx(v,a,c)+this.trimStart(u)}else{const p={tokenization:{getLineTokens:b=>b===r.startLineNumber?e.tokenization.getLineTokens(h):e.tokenization.getLineTokens(b),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:b=>b===r.startLineNumber?e.getLineContent(h):e.getLineContent(b)},v=$S(this._autoIndent,p,e.getLanguageIdAtPosition(h,1),r.startLineNumber,d,this._languageConfigurationService);if(v!==null){const b=Ui(e.getLineContent(h)),w=Zr(v,a),C=Zr(b,a);w!==C&&(f=mx(w,a,c)+this.trimStart(u))}}t.addEditOperation(new D(r.startLineNumber,1,r.startLineNumber,1),f+`
`);const m=this.matchEnterRuleMovingDown(e,d,a,r.startLineNumber,h,f);if(m!==null)m!==0&&this.getIndentEditsOfMovingBlock(e,t,r,a,c,m);else{const p={tokenization:{getLineTokens:b=>b===r.startLineNumber?e.tokenization.getLineTokens(h):b>=r.startLineNumber+1&&b<=r.endLineNumber+1?e.tokenization.getLineTokens(b-1):e.tokenization.getLineTokens(b),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:b=>b===r.startLineNumber?f:b>=r.startLineNumber+1&&b<=r.endLineNumber+1?e.getLineContent(b-1):e.getLineContent(b)},v=$S(this._autoIndent,p,e.getLanguageIdAtPosition(h,1),r.startLineNumber+1,d,this._languageConfigurationService);if(v!==null){const b=Ui(e.getLineContent(r.startLineNumber)),w=Zr(v,a),C=Zr(b,a);if(w!==C){const y=w-C;this.getIndentEditsOfMovingBlock(e,t,r,a,c,y)}}}}else t.addEditOperation(new D(r.startLineNumber,1,r.startLineNumber,1),f+`
`)}else if(h=r.startLineNumber-1,u=e.getLineContent(h),t.addEditOperation(new D(h,1,h+1,1),null),t.addEditOperation(new D(r.endLineNumber,e.getLineMaxColumn(r.endLineNumber),r.endLineNumber,e.getLineMaxColumn(r.endLineNumber)),`
`+u),this.shouldAutoIndent(e,r)){const f={tokenization:{getLineTokens:m=>m===h?e.tokenization.getLineTokens(r.startLineNumber):e.tokenization.getLineTokens(m),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:m=>m===h?e.getLineContent(r.startLineNumber):e.getLineContent(m)},g=this.matchEnterRule(e,d,a,r.startLineNumber,r.startLineNumber-2);if(g!==null)g!==0&&this.getIndentEditsOfMovingBlock(e,t,r,a,c,g);else{const m=$S(this._autoIndent,f,e.getLanguageIdAtPosition(r.startLineNumber,1),h,d,this._languageConfigurationService);if(m!==null){const p=Ui(e.getLineContent(r.startLineNumber)),v=Zr(m,a),b=Zr(p,a);if(v!==b){const w=v-b;this.getIndentEditsOfMovingBlock(e,t,r,a,c,w)}}}}}this._selectionId=t.trackSelection(r)}buildIndentConverter(e,t,i){return{shiftIndent:n=>Wl.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>Wl.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,o){if(o){let r=o.indentation;o.indentAction===us.None||o.indentAction===us.Indent?r=o.indentation+o.appendText:o.indentAction===us.IndentOutdent?r=o.indentation:o.indentAction===us.Outdent&&(r=t.unshiftIndent(o.indentation)+o.appendText);const a=e.getLineContent(n);if(this.trimStart(a).indexOf(this.trimStart(r))>=0){const l=Ui(e.getLineContent(n));let c=Ui(r);const d=ire(e,n,this._languageConfigurationService);d!==null&&d&2&&(c=t.unshiftIndent(c));const h=Zr(c,i),u=Zr(l,i);return h-u}}return null}matchEnterRuleMovingDown(e,t,i,n,o,r){if(uc(r)>=0){const a=e.getLineMaxColumn(o),l=p1(this._autoIndent,e,new D(o,a,o,a),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,l)}else{let a=n-1;for(;a>=1;){const d=e.getLineContent(a);if(uc(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=p1(this._autoIndent,e,new D(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}}matchEnterRule(e,t,i,n,o,r){let a=o;for(;a>=1;){let d;if(a===o&&r!==void 0?d=r:d=e.getLineContent(a),uc(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=p1(this._autoIndent,e,new D(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}trimStart(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4||!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const i=e.getLanguageIdAtPosition(t.startLineNumber,1),n=e.getLanguageIdAtPosition(t.endLineNumber,1);return!(i!==n||this._languageConfigurationService.getLanguageConfiguration(i).indentRulesSupport===null)}getIndentEditsOfMovingBlock(e,t,i,n,o,r){for(let a=i.startLineNumber;a<=i.endLineNumber;a++){const l=e.getLineContent(a),c=Ui(l),h=Zr(c,n)+r,u=mx(h,n,o);u!==c&&(t.addEditOperation(new D(a,1,a,c.length+1),u),a===i.endLineNumber&&i.endColumn<=c.length+1&&u===""&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}};L8=SKe([xKe(3,wn)],L8);const wK=class wK{constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const i=LKe(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(e===null)return!1;const n=zhe(e,t,i);if(!n)return!1;for(let o=0,r=n.before.length;o<r;o++)if(n.before[o]!==n.after[o])return!0;return!1}};wK._COLLATOR=bv.Collator();let DI=wK;function zhe(s,e,t){const i=e.startLineNumber;let n=e.endLineNumber;if(e.endColumn===1&&n--,i>=n)return null;const o=[];for(let a=i;a<=n;a++)o.push(s.getLineContent(a));let r=o.slice(0);return r.sort(DI._COLLATOR.value.compare),t===!0&&(r=r.reverse()),{startLineNumber:i,endLineNumber:n,before:o,after:r}}function LKe(s,e,t){const i=zhe(s,e,t);return i?Pn.replace(new D(i.startLineNumber,1,i.endLineNumber,s.getLineMaxColumn(i.endLineNumber)),i.after.join(`
`)):null}class Uhe extends Fe{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map((r,a)=>({selection:r,index:a,ignore:!1}));i.sort((r,a)=>D.compareRangesUsingStarts(r.selection,a.selection));let n=i[0];for(let r=1;r<i.length;r++){const a=i[r];n.selection.endLineNumber===a.selection.startLineNumber&&(n.index<a.index?a.ignore=!0:(n.ignore=!0,n=a))}const o=[];for(const r of i)o.push(new Vhe(r.selection,this.down,r.ignore));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class IKe extends Uhe{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:ne(1249,"Copy Line Up"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"2_line",title:_(1244,"&&Copy Line Up"),order:1},canTriggerInlineEdits:!0})}}class EKe extends Uhe{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:ne(1250,"Copy Line Down"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"2_line",title:_(1245,"Co&&py Line Down"),order:2},canTriggerInlineEdits:!0})}}class kKe extends Fe{constructor(){super({id:"editor.action.duplicateSelection",label:ne(1251,"Duplicate Selection"),precondition:B.writable,menuOpts:{menuId:He.MenubarSelectionMenu,group:"2_line",title:_(1246,"&&Duplicate Selection"),order:5},canTriggerInlineEdits:!0})}run(e,t,i){if(!t.hasModel())return;const n=[],o=t.getSelections(),r=t.getModel();for(const a of o)if(a.isEmpty())n.push(new Vhe(a,!0));else{const l=new Oe(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn);n.push(new GNe(l,r.getValueInRange(a)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class $he extends Fe{constructor(e,t){super(t),this.down=e}run(e,t){const i=e.get(wn),n=[],o=t.getSelections()||[],r=t.getOption(16);for(const a of o)n.push(new L8(a,this.down,r,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class DKe extends $he{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:ne(1252,"Move Line Up"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"2_line",title:_(1247,"Mo&&ve Line Up"),order:3},canTriggerInlineEdits:!0})}}class TKe extends $he{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:ne(1253,"Move Line Down"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"2_line",title:_(1248,"Move &&Line Down"),order:4},canTriggerInlineEdits:!0})}}class qhe extends Fe{constructor(e,t){super(t),this.descending=e}run(e,t){if(!t.hasModel())return;const i=t.getModel();let n=t.getSelections();n.length===1&&n[0].isEmpty()&&(n=[new Oe(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))]);for(const r of n)if(!DI.canRun(t.getModel(),r,this.descending))return;const o=[];for(let r=0,a=n.length;r<a;r++)o[r]=new DI(n[r],this.descending);t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class NKe extends qhe{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:ne(1254,"Sort Lines Ascending"),precondition:B.writable,canTriggerInlineEdits:!0})}}class RKe extends qhe{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:ne(1255,"Sort Lines Descending"),precondition:B.writable,canTriggerInlineEdits:!0})}}class MKe extends Fe{constructor(){super({id:"editor.action.removeDuplicateLines",label:ne(1256,"Delete Duplicate Lines"),precondition:B.writable,canTriggerInlineEdits:!0})}run(e,t){if(!t.hasModel())return;const i=t.getModel();if(i.getLineCount()===1&&i.getLineMaxColumn(1)===1)return;const n=[],o=[];let r=0,a=!0,l=t.getSelections();l.length===1&&l[0].isEmpty()&&(l=[new Oe(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))],a=!1);for(const c of l){const d=new Set,h=[];for(let m=c.startLineNumber;m<=c.endLineNumber;m++){const p=i.getLineContent(m);d.has(p)||(h.push(p),d.add(p))}const u=new Oe(c.startLineNumber,1,c.endLineNumber,i.getLineMaxColumn(c.endLineNumber)),f=c.startLineNumber-r,g=new Oe(f,1,f+h.length-1,h[h.length-1].length);n.push(Pn.replace(u,h.join(`
`))),o.push(g),r+=c.endLineNumber-c.startLineNumber+1-h.length}t.pushUndoStop(),t.executeEdits(this.id,n,a?o:void 0),t.pushUndoStop()}}class AKe extends Fe{constructor(){super({id:"editor.action.reverseLines",label:ne(1257,"Reverse lines"),precondition:B.writable,canTriggerInlineEdits:!0})}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=t.getSelections();let o=n;o.length===1&&o[0].isEmpty()&&(o=[new Oe(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))]);const r=[],a=[];for(let l=0;l<o.length;l++){const c=o[l],d=n[l];let h=c.endLineNumber;c.startLineNumber<c.endLineNumber&&c.endColumn===1&&h--;let u=new D(c.startLineNumber,1,h,i.getLineMaxColumn(h));h===i.getLineCount()&&i.getLineContent(u.endLineNumber)===""&&(u=u.setEndPosition(u.endLineNumber-1,i.getLineMaxColumn(u.endLineNumber-1)));const f=[];for(let v=u.endLineNumber;v>=u.startLineNumber;v--)f.push(i.getLineContent(v));const g=Pn.replace(u,f.join(`
`));r.push(g);const m=function(v){return v<=u.endLineNumber?u.endLineNumber-v+u.startLineNumber:v},p=function(v){if(v.isEmpty())return new Oe(m(v.positionLineNumber),v.positionColumn,m(v.positionLineNumber),v.positionColumn);{const b=m(v.selectionStartLineNumber),w=m(v.positionLineNumber),C=v.selectionStartColumn,y=v.positionColumn;return new Oe(b,C,w,y)}};a.push(p(d))}t.pushUndoStop(),t.executeEdits(this.id,r,a),t.pushUndoStop()}}const XA=class XA extends Fe{constructor(){super({id:XA.ID,label:ne(1258,"Trim Trailing Whitespace"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2102),weight:100}})}run(e,t,i){let n=[];i.reason==="auto-save"&&(n=(t.getSelections()||[]).map(d=>new z(d.positionLineNumber,d.positionColumn)));const o=t.getSelection();if(o===null)return;const r=e.get(xt),a=t.getModel(),l=r.getValue("files.trimTrailingWhitespaceInRegexAndStrings",{overrideIdentifier:a==null?void 0:a.getLanguageId(),resource:a==null?void 0:a.uri}),c=new wKe(o,n,l);t.pushUndoStop(),t.executeCommands(this.id,[c]),t.pushUndoStop()}};XA.ID="editor.action.trimTrailingWhitespace";let I8=XA;class PKe extends Fe{constructor(){super({id:"editor.action.deleteLines",label:ne(1259,"Delete Line"),precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:3113,weight:100},canTriggerInlineEdits:!0})}run(e,t){if(!t.hasModel())return;const i=this._getLinesToRemove(t),n=t.getModel();if(n.getLineCount()===1&&n.getLineMaxColumn(1)===1)return;let o=0;const r=[],a=[];for(let l=0,c=i.length;l<c;l++){const d=i[l];let h=d.startLineNumber,u=d.endLineNumber,f=1,g=n.getLineMaxColumn(u);u<n.getLineCount()?(u+=1,g=1):h>1&&(h-=1,f=n.getLineMaxColumn(h)),r.push(Pn.replace(new Oe(h,f,u,g),"")),a.push(new Oe(h-o,d.positionColumn,h-o,d.positionColumn)),o+=d.endLineNumber-d.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,r,a),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map(o=>{let r=o.endLineNumber;return o.startLineNumber<o.endLineNumber&&o.endColumn===1&&(r-=1),{startLineNumber:o.startLineNumber,selectionStartColumn:o.selectionStartColumn,endLineNumber:r,positionColumn:o.positionColumn}});t.sort((o,r)=>o.startLineNumber===r.startLineNumber?o.endLineNumber-r.endLineNumber:o.startLineNumber-r.startLineNumber);const i=[];let n=t[0];for(let o=1;o<t.length;o++)n.endLineNumber+1>=t[o].startLineNumber?n.endLineNumber=t[o].endLineNumber:(i.push(n),n=t[o]);return i.push(n),i}}class OKe extends Fe{constructor(){super({id:"editor.action.indentLines",label:ne(1260,"Indent Line"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:2142,weight:100},canTriggerInlineEdits:!0})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,ag.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class FKe extends Fe{constructor(){super({id:"editor.action.outdentLines",label:ne(1261,"Outdent Line"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:2140,weight:100},canTriggerInlineEdits:!0})}run(e,t){_1.Outdent.runEditorCommand(e,t,null)}}const ZA=class ZA extends Fe{constructor(){super({id:ZA.ID,label:ne(1262,"Insert Line Above"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:3075,weight:100},canTriggerInlineEdits:!0})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,WO.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}};ZA.ID="editor.action.insertLineBefore";let Y2=ZA;const QA=class QA extends Fe{constructor(){super({id:QA.ID,label:ne(1263,"Insert Line Below"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:2051,weight:100},canTriggerInlineEdits:!0})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,WO.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}};QA.ID="editor.action.insertLineAfter";let X2=QA;class jhe extends Fe{run(e,t){if(!t.hasModel())return;const i=t.getSelection(),n=this._getRangesToDelete(t),o=[];for(let l=0,c=n.length-1;l<c;l++){const d=n[l],h=n[l+1];D.intersectRanges(d,h)===null?o.push(d):n[l+1]=D.plusRange(d,h)}o.push(n[n.length-1]);const r=this._getEndCursorState(i,o),a=o.map(l=>Pn.replace(l,""));t.pushUndoStop(),t.executeEdits(this.id,a,r),t.pushUndoStop()}}class BKe extends jhe{constructor(){super({id:"deleteAllLeft",label:ne(1264,"Delete All Left"),precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:2049},weight:100},canTriggerInlineEdits:!0})}_getEndCursorState(e,t){let i=null;const n=[];let o=0;return t.forEach(r=>{let a;if(r.endColumn===1&&o>0){const l=r.startLineNumber-o;a=new Oe(l,r.startColumn,l,r.startColumn)}else a=new Oe(r.startLineNumber,r.startColumn,r.startLineNumber,r.startColumn);o+=r.endLineNumber-r.startLineNumber,r.intersectRanges(e)?i=a:n.push(a)}),i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getSelections();if(t===null)return[];let i=t;const n=e.getModel();return n===null?[]:(i.sort(D.compareRangesUsingStarts),i=i.map(o=>{if(o.isEmpty())if(o.startColumn===1){const r=Math.max(1,o.startLineNumber-1),a=o.startLineNumber===1?1:n.getLineLength(r)+1;return new D(r,a,o.startLineNumber,1)}else return new D(o.startLineNumber,1,o.startLineNumber,o.startColumn);else return new D(o.startLineNumber,1,o.endLineNumber,o.endColumn)}),i)}}class WKe extends jhe{constructor(){super({id:"deleteAllRight",label:ne(1265,"Delete All Right"),precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100},canTriggerInlineEdits:!0})}_getEndCursorState(e,t){let i=null;const n=[];for(let o=0,r=t.length,a=0;o<r;o++){const l=t[o],c=new Oe(l.startLineNumber-a,l.startColumn,l.startLineNumber-a,l.startColumn);l.intersectRanges(e)?i=c:n.push(c)}return i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getModel();if(t===null)return[];const i=e.getSelections();if(i===null)return[];const n=i.map(o=>{if(o.isEmpty()){const r=t.getLineMaxColumn(o.startLineNumber);return o.startColumn===r?new D(o.startLineNumber,o.startColumn,o.startLineNumber+1,1):new D(o.startLineNumber,o.startColumn,o.startLineNumber,r)}return o});return n.sort(D.compareRangesUsingStarts),n}}class HKe extends Fe{constructor(){super({id:"editor.action.joinLines",label:ne(1266,"Join Lines"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:0,mac:{primary:296},weight:100},canTriggerInlineEdits:!0})}run(e,t){const i=t.getSelections();if(i===null)return;let n=t.getSelection();if(n===null)return;i.sort(D.compareRangesUsingStarts);const o=[],r=i.reduce((u,f)=>u.isEmpty()?u.endLineNumber===f.startLineNumber?(n.equalsSelection(u)&&(n=f),f):f.startLineNumber>u.endLineNumber+1?(o.push(u),f):new Oe(u.startLineNumber,u.startColumn,f.endLineNumber,f.endColumn):f.startLineNumber>u.endLineNumber?(o.push(u),f):new Oe(u.startLineNumber,u.startColumn,f.endLineNumber,f.endColumn));o.push(r);const a=t.getModel();if(a===null)return;const l=[],c=[];let d=n,h=0;for(let u=0,f=o.length;u<f;u++){const g=o[u],m=g.startLineNumber,p=1;let v=0,b,w;const C=a.getLineLength(g.endLineNumber)-g.endColumn;if(g.isEmpty()||g.startLineNumber===g.endLineNumber){const S=g.getStartPosition();S.lineNumber<a.getLineCount()?(b=m+1,w=a.getLineMaxColumn(b)):(b=S.lineNumber,w=a.getLineMaxColumn(S.lineNumber))}else b=g.endLineNumber,w=a.getLineMaxColumn(b);let y=a.getLineContent(m);for(let S=m+1;S<=b;S++){const L=a.getLineContent(S),E=a.getLineFirstNonWhitespaceColumn(S);if(E>=1){let M=!0;y===""&&(M=!1),M&&(y.charAt(y.length-1)===" "||y.charAt(y.length-1)==="	")&&(M=!1,y=y.replace(/[\s\uFEFF\xA0]+$/g," "));const R=L.substr(E-1);y+=(M?" ":"")+R,M?v=R.length+1:v=R.length}else v=0}const x=new D(m,p,b,w);if(!x.isEmpty()){let S;g.isEmpty()?(l.push(Pn.replace(x,y)),S=new Oe(x.startLineNumber-h,y.length-v+1,m-h,y.length-v+1)):g.startLineNumber===g.endLineNumber?(l.push(Pn.replace(x,y)),S=new Oe(g.startLineNumber-h,g.startColumn,g.endLineNumber-h,g.endColumn)):(l.push(Pn.replace(x,y)),S=new Oe(g.startLineNumber-h,g.startColumn,g.startLineNumber-h,y.length-C)),D.intersectRanges(x,n)!==null?d=S:c.push(S)}h+=x.endLineNumber-x.startLineNumber}c.unshift(d),t.pushUndoStop(),t.executeEdits(this.id,l,c),t.pushUndoStop()}}class VKe extends Fe{constructor(){super({id:"editor.action.transpose",label:ne(1267,"Transpose Characters around the Cursor"),precondition:B.writable,canTriggerInlineEdits:!0})}run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const o=[];for(let r=0,a=i.length;r<a;r++){const l=i[r];if(!l.isEmpty())continue;const c=l.getStartPosition(),d=n.getLineMaxColumn(c.lineNumber);if(c.column>=d){if(c.lineNumber===n.getLineCount())continue;const h=new D(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),u=n.getValueInRange(h).split("").reverse().join("");o.push(new vo(new Oe(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),u))}else{const h=new D(c.lineNumber,Math.max(1,c.column-1),c.lineNumber,c.column+1),u=n.getValueInRange(h).split("").reverse().join("");o.push(new UU(h,u,new Oe(c.lineNumber,c.column+1,c.lineNumber,c.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class Rv extends Fe{run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const o=t.getOption(148),r=[];for(const a of i)if(a.isEmpty()){const l=a.getStartPosition(),c=t.getConfiguredWordAtPosition(l);if(!c)continue;const d=new D(l.lineNumber,c.startColumn,l.lineNumber,c.endColumn),h=n.getValueInRange(d);r.push(Pn.replace(d,this._modifyText(h,o)))}else{const l=n.getValueInRange(a);r.push(Pn.replace(a,this._modifyText(l,o)))}t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop()}}class zKe extends Rv{constructor(){super({id:"editor.action.transformToUppercase",label:ne(1268,"Transform to Uppercase"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){return e.toLocaleUpperCase()}}class UKe extends Rv{constructor(){super({id:"editor.action.transformToLowercase",label:ne(1269,"Transform to Lowercase"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){return e.toLocaleLowerCase()}}class gc{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}}const JA=class JA extends Rv{constructor(){super({id:"editor.action.transformToTitlecase",label:ne(1270,"Transform to Title Case"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){const i=JA.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,n=>n.toLocaleUpperCase()):e}};JA.titleBoundary=new gc("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");let Z2=JA;const r1=class r1 extends Rv{constructor(){super({id:"editor.action.transformToSnakecase",label:ne(1271,"Transform to Snake Case"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){const i=r1.caseBoundary.get(),n=r1.singleLetters.get();return!i||!n?e:e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase()}};r1.caseBoundary=new gc("(\\p{Ll})(\\p{Lu})","gmu"),r1.singleLetters=new gc("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");let px=r1;const ig=class ig extends Rv{constructor(){super({id:"editor.action.transformToCamelcase",label:ne(1272,"Transform to Camel Case"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){var a;const i=/\r\n|\r|\n/.test(e)?ig.multiLineWordBoundary.get():ig.singleLineWordBoundary.get(),n=ig.validWordStart.get();if(!i||!n)return e;const o=e.split(i);return((a=o.shift())==null?void 0:a.replace(n,l=>l.toLocaleLowerCase()))+o.map(l=>l.substring(0,1).toLocaleUpperCase()+l.substring(1)).join("")}};ig.singleLineWordBoundary=new gc("[_\\s-]+","gm"),ig.multiLineWordBoundary=new gc("[_-]+","gm"),ig.validWordStart=new gc("^(\\p{Lu}[^\\p{Lu}])","gmu");let _x=ig;const ng=class ng extends Rv{constructor(){super({id:"editor.action.transformToPascalcase",label:ne(1273,"Transform to Pascal Case"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){const i=ng.wordBoundary.get(),n=ng.wordBoundaryToMaintain.get(),o=ng.upperCaseWordMatcher.get();return!i||!n||!o?e:e.split(n).map(l=>l.split(i)).flat().map(l=>{const c=l.charAt(0).toLocaleUpperCase()+l.slice(1);return c.length>1&&o.test(c)?c.charAt(0)+c.slice(1).toLocaleLowerCase():c}).join("")}};ng.wordBoundary=new gc("[_ \\t-]","gm"),ng.wordBoundaryToMaintain=new gc("(?<=\\.)","gm"),ng.upperCaseWordMatcher=new gc("^\\p{Lu}+$","mu");let Q2=ng;const sg=class sg extends Rv{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every(t=>t.isSupported())}constructor(){super({id:"editor.action.transformToKebabcase",label:ne(1274,"Transform to Kebab Case"),precondition:B.writable,canTriggerInlineEdits:!0})}_modifyText(e,t){const i=sg.caseBoundary.get(),n=sg.singleLetters.get(),o=sg.underscoreBoundary.get();return!i||!n||!o?e:e.replace(o,"$1-$3").replace(i,"$1-$2").replace(n,"$1-$2").toLocaleLowerCase()}};sg.caseBoundary=new gc("(\\p{Ll})(\\p{Lu})","gmu"),sg.singleLetters=new gc("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),sg.underscoreBoundary=new gc("(\\S)(_)(\\S)","gm");let J2=sg;xe(IKe);xe(EKe);xe(kKe);xe(DKe);xe(TKe);xe(NKe);xe(RKe);xe(MKe);xe(I8);xe(PKe);xe(OKe);xe(FKe);xe(Y2);xe(X2);xe(BKe);xe(WKe);xe(HKe);xe(VKe);xe(zKe);xe(UKe);xe(AKe);px.caseBoundary.isSupported()&&px.singleLetters.isSupported()&&xe(px);_x.singleLineWordBoundary.isSupported()&&_x.multiLineWordBoundary.isSupported()&&xe(_x);Q2.wordBoundary.isSupported()&&xe(Q2);Z2.titleBoundary.isSupported()&&xe(Z2);J2.isSupported()&&xe(J2);const Cj=Mt("dataChannelService");class $Ke{getDataChannel(e){return{sendData:()=>{}}}}var qKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},EJ=function(s,e){return function(t,i){e(t,i,s)}};function jKe(s){var e;return s.sourceId+" @@ "+JSON.stringify({...s,modelUri:(e=s.modelUri)==null?void 0:e.toString(),sourceId:void 0})}let eM=class extends K{static cast(){return this}constructor(e,t,i){super(),this._key=e,this._contextKeyService=t,this._dataChannelService=i,this._isEnabledContextKeyValue=KKe("structuredLogger.enabled:"+this._key,this._contextKeyService).recomputeInitiallyAndOnChange(this._store),this.isEnabled=this._isEnabledContextKeyValue.map(n=>n!==void 0)}log(e){return this._isEnabledContextKeyValue.get()?(this._dataChannelService.getDataChannel("structuredLogger:"+this._key).sendData(e),!0):!1}};eM=qKe([EJ(1,ut),EJ(2,Cj)],eM);function KKe(s,e){return fi(e.onDidChangeContext,()=>e.getContextKeyValue(s))}var GKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},kJ=function(s,e){return function(t,i){e(t,i,s)}};let E8=class extends K{constructor(e,t,i){var r;super(),this._editor=e,this._instantiationService=t,this._loggerService=i,this._structuredLogger=this._register(this._instantiationService.createInstance(eM.cast(),"editor.inlineSuggest.logChangeReason.commandId"));const n=(r=this._loggerService)==null?void 0:r.createLogger("textModelChanges",{hidden:!1,name:"Text Model Changes Reason"}),o=fi(this,n.onDidChangeLogLevel,()=>n.getLevel());this._register(lt(a=>{Moe(o.read(a),Ns.Trace)&&a.store.add(this._editor.onDidChangeModelContent(l=>{var c;((c=this._editor.getModel())==null?void 0:c.uri.scheme)!=="output"&&n.trace("onDidChangeModelContent: "+l.detailedReasons.map(d=>d.toKey(Number.MAX_VALUE)).join(", "))}))})),this._register(lt(a=>{this._editor instanceof Vb&&this._structuredLogger.isEnabled.read(a)&&a.store.add(this._editor.onDidChangeModelContent(l=>{const c=this._editor.getModel();if(!c)return;const d=l.detailedReasons[0],h={...d.metadata,sourceId:"TextModel.setChangeReason",source:d.metadata.source,time:Date.now(),modelUri:c.uri,modelVersion:c.getVersionId()};setTimeout(()=>{this._structuredLogger.log(h)},0)}))}))}};E8=GKe([kJ(1,$e),kJ(2,Noe)],E8);function DJ(s,e=no){return LNe(s,e)?s.charAt(0).toUpperCase()+s.slice(1):s}var YKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},XKe=function(s,e){return function(t,i){e(t,i,s)}};class TJ{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){const i=t.resolve(e);if(i!==void 0)return i}}}class NJ{constructor(e,t,i,n){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=n}resolve(e){const{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){const o=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);o&&(i=o.value,n=o.multiline)}if(i&&n&&e.snippet){const o=this._model.getLineContent(this._selection.startLineNumber),r=Ui(o,0,this._selection.startColumn-1);let a=r;e.snippet.walk(c=>c===e?!1:(c instanceof pr&&(a=Ui(fa(c.value).pop())),!0));const l=mc(a,r);i=i.replace(/(\r\n|\r|\n)(.*)/g,(c,d,h)=>`${d}${a.substr(l)}${h}`)}return i}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){const i=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return i&&i.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(t==="CURSOR_INDEX")return String(this._selectionIdx);if(t==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}}class RJ{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if(t==="TM_FILENAME")return Xu(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){const i=Xu(this._model.uri.fsPath),n=i.lastIndexOf(".");return n<=0?i:i.slice(0,n)}else{if(t==="TM_DIRECTORY")return BT(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(NO(this._model.uri));if(t==="TM_DIRECTORY_BASE")return BT(this._model.uri.fsPath)==="."?"":Xu(BT(this._model.uri.fsPath));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class MJ{constructor(e,t,i,n){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=n}resolve(e){if(e.name!=="CLIPBOARD")return;const t=this._readClipboardText();if(t){if(this._spread){const i=t.split(/\r\n|\n|\r/).filter(n=>!Ose(n));if(i.length===this._selectionCount)return i[this._selectionIdx]}return t}}}let tM=class{constructor(e,t,i){this._model=e,this._selection=t,this._languageConfigurationService=i}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),n=this._languageConfigurationService.getLanguageConfiguration(i).comments;if(n){if(t==="LINE_COMMENT")return n.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return n.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return n.blockCommentEndToken||void 0}}};tM=YKe([XKe(2,wn)],tM);const Ud=class Ud{constructor(){this._date=new Date}resolve(e){const{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return Ud.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return Ud.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return Ud.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return Ud.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(t==="CURRENT_TIMEZONE_OFFSET"){const i=this._date.getTimezoneOffset(),n=i>0?"-":"+",o=Math.trunc(Math.abs(i/60)),r=o<10?"0"+o:o,a=Math.abs(i)-o*60,l=a<10?"0"+a:a;return n+r+":"+l}}};Ud.dayNames=[_(1406,"Sunday"),_(1407,"Monday"),_(1408,"Tuesday"),_(1409,"Wednesday"),_(1410,"Thursday"),_(1411,"Friday"),_(1412,"Saturday")],Ud.dayNamesShort=[_(1413,"Sun"),_(1414,"Mon"),_(1415,"Tue"),_(1416,"Wed"),_(1417,"Thu"),_(1418,"Fri"),_(1419,"Sat")],Ud.monthNames=[_(1420,"January"),_(1421,"February"),_(1422,"March"),_(1423,"April"),_(1424,"May"),_(1425,"June"),_(1426,"July"),_(1427,"August"),_(1428,"September"),_(1429,"October"),_(1430,"November"),_(1431,"December")],Ud.monthNamesShort=[_(1432,"Jan"),_(1433,"Feb"),_(1434,"Mar"),_(1435,"Apr"),_(1436,"May"),_(1437,"Jun"),_(1438,"Jul"),_(1439,"Aug"),_(1440,"Sep"),_(1441,"Oct"),_(1442,"Nov"),_(1443,"Dec")];let iM=Ud;class AJ{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=PHe(this._workspaceService.getWorkspace());if(!MHe(t)){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(eW(e))return Xu(e.uri.path);let t=Xu(e.configPath.path);return t.endsWith(tW)&&(t=t.substr(0,t.length-tW.length-1)),t}_resoveWorkspacePath(e){if(eW(e))return DJ(e.uri.fsPath);const t=Xu(e.configPath.path);let i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?DJ(i):"/"}}class PJ{resolve(e){const{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return wv()}}var ZKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},QKe=function(s,e){return function(t,i){e(t,i,s)}},Dc;const ec=class ec{constructor(e,t,i){this._editor=e,this._snippet=t,this._snippetLineLeadingWhitespace=i,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=qG(t.placeholders,_l.compareByIndex),this._placeholderGroupsIdx=-1}initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations(t=>{for(const i of this._snippet.placeholders){const n=this._snippet.offset(i),o=this._snippet.fullLen(i),r=D.fromPositions(e.getPositionAt(this._offset+n),e.getPositionAt(this._offset+n+o)),a=i.isFinalTabstop?ec._decor.inactiveFinal:ec._decor.inactive,l=t.addDecoration(r,a);this._placeholderDecorations.set(i,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const n=[];for(const o of this._placeholderGroups[this._placeholderGroupsIdx])if(o.transform){const r=this._placeholderDecorations.get(o),a=this._editor.getModel().getDecorationRange(r),l=this._editor.getModel().getValueInRange(a),c=o.transform.resolve(l).split(/\r\n|\r|\n/);for(let d=1;d<c.length;d++)c[d]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+c[d]);n.push(Pn.replace(a,c.join(this._editor.getModel().getEOL())))}n.length>0&&this._editor.executeEdits("snippet.placeholderTransform",n)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations(n=>{const o=new Set,r=[];for(const a of this._placeholderGroups[this._placeholderGroupsIdx]){const l=this._placeholderDecorations.get(a),c=this._editor.getModel().getDecorationRange(l);r.push(new Oe(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),n.changeDecorationOptions(l,a.isFinalTabstop?ec._decor.activeFinal:ec._decor.active),o.add(a);for(const d of this._snippet.enclosingPlaceholders(a)){const h=this._placeholderDecorations.get(d);n.changeDecorationOptions(h,d.isFinalTabstop?ec._decor.activeFinal:ec._decor.active),o.add(d)}}for(const[a,l]of this._placeholderDecorations)o.has(a)||n.changeDecorationOptions(l,a.isFinalTabstop?ec._decor.inactiveFinal:ec._decor.inactive);return r});return t?this.move(e):i??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof _l){const i=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(i).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[e]=this._snippet.placeholders;if(e.isFinalTabstop&&this._snippet.rightMostDescendant===e)return!0}return!1}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const n of t){if(n.isFinalTabstop)break;i||(i=[],e.set(n.index,i));const o=this._placeholderDecorations.get(n),r=this._editor.getModel().getDecorationRange(o);if(!r){e.delete(n.index);break}i.push(r)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;const e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!(e!=null&&e.choice))return;const t=this._placeholderDecorations.get(e);if(!t)return;const i=this._editor.getModel().getDecorationRange(t);if(i)return{range:i,choice:e.choice}}get hasChoice(){let e=!1;return this._snippet.walk(t=>(e=t instanceof b0,!e)),e}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(i=>{for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const o=e.shift();console.assert(o._offset!==-1),console.assert(!o._placeholderDecorations);const r=o._snippet.placeholderInfo.last.index;for(const l of o._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=n.index+(r+1)/this._nestingLevel:l.index=n.index+l.index/this._nestingLevel;this._snippet.replace(n,o._snippet.children);const a=this._placeholderDecorations.get(n);i.removeDecoration(a),this._placeholderDecorations.delete(n);for(const l of o._snippet.placeholders){const c=o._snippet.offset(l),d=o._snippet.fullLen(l),h=D.fromPositions(t.getPositionAt(o._offset+c),t.getPositionAt(o._offset+c+d)),u=i.addDecoration(h,ec._decor.inactive);this._placeholderDecorations.set(l,u)}}this._placeholderGroups=qG(this._snippet.placeholders,_l.compareByIndex)})}};ec._decor={active:vt.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:vt.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:vt.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:vt.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};let nM=ec;const OJ={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let sM=Dc=class{static adjustWhitespace(e,t,i,n,o){const r=e.getLineContent(t.lineNumber),a=Ui(r,0,t.column-1);let l;return n.walk(c=>{if(!(c instanceof pr)||c.parent instanceof b0||o&&!o.has(c))return!0;const d=c.value.split(/\r\n|\r|\n/);if(i){const u=n.offset(c);if(u===0)d[0]=e.normalizeIndentation(d[0]);else{l=l??n.toString();const f=l.charCodeAt(u-1);(f===10||f===13)&&(d[0]=e.normalizeIndentation(a+d[0]))}for(let f=1;f<d.length;f++)d[f]=e.normalizeIndentation(a+d[f])}const h=d.join(e.getEOL());return h!==c.value&&(c.parent.replace(c,[new pr(h)]),l=void 0),!0}),a}static adjustSelection(e,t,i,n){if(i!==0||n!==0){const{positionLineNumber:o,positionColumn:r}=t,a=r-i,l=r+n,c=e.validateRange({startLineNumber:o,startColumn:a,endLineNumber:o,endColumn:l});t=Oe.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(e,t,i,n,o,r,a,l,c){const d=[],h=[];if(!e.hasModel())return{edits:d,snippets:h};const u=e.getModel(),f=e.invokeWithinContext(C=>C.get(wf)),g=e.invokeWithinContext(C=>new RJ(C.get(nv),u)),m=()=>a,p=u.getValueInRange(Dc.adjustSelection(u,e.getSelection(),i,0)),v=u.getValueInRange(Dc.adjustSelection(u,e.getSelection(),0,n)),b=u.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber),w=e.getSelections().map((C,y)=>({selection:C,idx:y})).sort((C,y)=>D.compareRangesUsingStarts(C.selection,y.selection));for(const{selection:C,idx:y}of w){let x=Dc.adjustSelection(u,C,i,0),S=Dc.adjustSelection(u,C,0,n);p!==u.getValueInRange(x)&&(x=C),v!==u.getValueInRange(S)&&(S=C);const L=C.setStartPosition(x.startLineNumber,x.startColumn).setEndPosition(S.endLineNumber,S.endColumn),E=new Gb().parse(t,!0,o),M=L.getStartPosition(),R=Dc.adjustWhitespace(u,M,r||y>0&&b!==u.getLineFirstNonWhitespaceColumn(C.positionLineNumber),E);E.resolveVariables(new TJ([g,new MJ(m,y,w.length,e.getOption(88)==="spread"),new NJ(u,C,y,l),new tM(u,C,c),new iM,new AJ(f),new PJ])),d[y]=Pn.replace(L,E.toString()),d[y].identifier={major:y,minor:0},d[y]._isTracked=!0,h[y]=new nM(e,E,R)}return{edits:d,snippets:h}}static createEditsAndSnippetsFromEdits(e,t,i,n,o,r,a){if(!e.hasModel()||t.length===0)return{edits:[],snippets:[]};const l=[],c=e.getModel(),d=new Gb,h=new Mk,u=new TJ([e.invokeWithinContext(g=>new RJ(g.get(nv),c)),new MJ(()=>o,0,e.getSelections().length,e.getOption(88)==="spread"),new NJ(c,e.getSelection(),0,r),new tM(c,e.getSelection(),a),new iM,new AJ(e.invokeWithinContext(g=>g.get(wf))),new PJ]);t=t.sort((g,m)=>D.compareRangesUsingStarts(g.range,m.range));let f=0;for(let g=0;g<t.length;g++){const{range:m,template:p,keepWhitespace:v}=t[g];if(g>0){const x=t[g-1].range,S=D.fromPositions(x.getEndPosition(),m.getStartPosition()),L=new pr(c.getValueInRange(S));h.appendChild(L),f+=L.value.length}const b=d.parseFragment(p,h);Dc.adjustWhitespace(c,m.getStartPosition(),v!==void 0?!v:n,h,new Set(b)),h.resolveVariables(u);const w=h.toString(),C=w.slice(f);f=w.length;const y=Pn.replace(m,C);y.identifier={major:g,minor:0},y._isTracked=!0,l.push(y)}return d.ensureFinalTabstop(h,i,!0),{edits:l,snippets:[new nM(e,h,"")]}}constructor(e,t,i=OJ,n){this._editor=e,this._template=t,this._options=i,this._languageConfigurationService=n,this._templateMerges=[],this._snippets=[]}dispose(){yi(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(e){if(!this._editor.hasModel())return;const{edits:t,snippets:i}=typeof this._template=="string"?Dc.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):Dc.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=i,this._editor.executeEdits(e??ko.snippet(),t,n=>{const o=n.filter(r=>!!r.identifier);for(let r=0;r<i.length;r++)i[r].initialize(o[r].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):o.map(r=>Oe.fromPositions(r.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=OJ){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:i,snippets:n}=Dc.createEditsAndSnippetsFromSelections(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",i,o=>{const r=o.filter(l=>!!l.identifier);for(let l=0;l<n.length;l++)n[l].initialize(r[l].textChange);const a=n[0].isTrivialSnippet;if(!a){for(const l of this._snippets)l.merge(n);console.assert(n.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):r.map(l=>Oe.fromPositions(l.range.getEndPosition()))})}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const n=i.move(e);t.push(...n)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;const t=new Map;for(const i of this._snippets){const n=i.computePossibleSelections();if(t.size===0)for(const[o,r]of n){r.sort(D.compareRangesUsingStarts);for(const a of e)if(r[0].containsRange(a)){t.set(o,[]);break}}if(t.size===0)return!1;t.forEach((o,r)=>{o.push(...n.get(r))})}e.sort(D.compareRangesUsingStarts);for(const[i,n]of t){if(n.length!==e.length){t.delete(i);continue}n.sort(D.compareRangesUsingStarts);for(let o=0;o<n.length;o++)if(!n[o].containsRange(e[o])){t.delete(i);continue}}return t.size>0}};sM=Dc=ZKe([QKe(3,wn)],sM);var JKe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},tT=function(s,e){return function(t,i){e(t,i,s)}},vC;const FJ={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};var rh;let tr=(rh=class{static get(e){return e.getContribution(vC.ID)}constructor(e,t,i,n,o){this._editor=e,this._logService=t,this._languageFeaturesService=i,this._languageConfigurationService=o,this._inSnippetObservable=ht(this,!1),this._snippetListener=new oe,this._modelVersionId=-1,this._inSnippet=vC.InSnippetMode.bindTo(n),this._hasNextTabstop=vC.HasNextTabstop.bindTo(n),this._hasPrevTabstop=vC.HasPrevTabstop.bindTo(n)}dispose(){var e;this._inSnippet.reset(),this._inSnippetObservable.set(!1,void 0),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),(e=this._session)==null||e.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,typeof t>"u"?FJ:{...FJ,...t})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){var i;if(this._editor.hasModel()){if(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof e!="string"&&this.cancel(),this._session?(ti(typeof e=="string"),this._session.merge(e,t)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new sM(this._editor,e,t,this._languageConfigurationService),this._session.insert(t.reason)),t.undoStopAfter&&this._editor.getModel().pushStackElement(),(i=this._session)!=null&&i.hasChoice){const n={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(d,h)=>{if(!this._session||d!==this._editor.getModel()||!z.equals(this._editor.getPosition(),h))return;const{activeChoice:u}=this._session;if(!u||u.choice.options.length===0)return;const f=d.getValueInRange(u.range),g=!!u.choice.options.find(p=>p.value===f),m=[];for(let p=0;p<u.choice.options.length;p++){const v=u.choice.options[p];m.push({kind:13,label:v.value,insertText:v.value,sortText:"a".repeat(p+1),range:u.range,filterText:g?`${f}_${v.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:_(1405,"Go to next placeholder...")}})}return{suggestions:m}}},o=this._editor.getModel();let r,a=!1;const l=()=>{r==null||r.dispose(),a=!1},c=()=>{a||(r=this._languageFeaturesService.completionProvider.register({language:o.getLanguageId(),pattern:o.uri.fsPath,scheme:o.uri.scheme,exclusive:!0},n),this._snippetListener.add(r),a=!0)};this._choiceCompletions={provider:n,enable:c,disable:l}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(n=>n.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._inSnippetObservable.set(!0,void 0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){var t;if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{activeChoice:e}=this._session;if(!e||!this._choiceCompletions){(t=this._choiceCompletions)==null||t.disable(),this._currentChoice=void 0;return}this._currentChoice!==e.choice&&(this._currentChoice=e.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{CKe(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){var t;this._inSnippet.reset(),this._inSnippetObservable.set(!1,void 0),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,(t=this._session)==null||t.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){var e;(e=this._session)==null||e.prev(),this._updateState()}next(){var e;(e=this._session)==null||e.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}get isInSnippetObservable(){return this._inSnippetObservable}},vC=rh,rh.ID="snippetController2",rh.InSnippetMode=new Ne("inSnippetMode",!1,_(1402,"Whether the editor in current in snippet mode")),rh.HasNextTabstop=new Ne("hasNextTabstop",!1,_(1403,"Whether there is a next tab stop when in snippet mode")),rh.HasPrevTabstop=new Ne("hasPrevTabstop",!1,_(1404,"Whether there is a previous tab stop when in snippet mode")),rh);tr=vC=JKe([tT(1,Ji),tT(2,We),tT(3,ut),tT(4,wn)],tr);Qt(tr.ID,tr,4);const O4=Is.bindToContribution(tr.get);Te(new O4({id:"jumpToNextSnippetPlaceholder",precondition:de.and(tr.InSnippetMode,tr.HasNextTabstop),handler:s=>s.next(),kbOpts:{weight:130,kbExpr:B.textInputFocus,primary:2}}));Te(new O4({id:"jumpToPrevSnippetPlaceholder",precondition:de.and(tr.InSnippetMode,tr.HasPrevTabstop),handler:s=>s.prev(),kbOpts:{weight:130,kbExpr:B.textInputFocus,primary:1026}}));Te(new O4({id:"leaveSnippet",precondition:tr.InSnippetMode,handler:s=>s.cancel(!0),kbOpts:{weight:130,kbExpr:B.textInputFocus,primary:9,secondary:[1033]}}));Te(new O4({id:"acceptSnippet",precondition:tr.InSnippetMode,handler:s=>s.finish()}));function TI(s){return new eGe(s)}class eGe extends Sae{constructor(e){super(),this._textModel=e}getOffset(e){return this._textModel.getOffsetAt(e)}getPosition(e){return this._textModel.getPositionAt(e)}}const tGe=[];function iGe(){return tGe}function BJ(s){return nGe(s).map(t=>t.getEndPosition())}function nGe(s){const e=YN.createSortPermutation(s,wo(n=>n.range,D.compareRangesUsingStarts)),i=new ra(e.apply(s)).getNewRanges();return e.inverse().apply(i)}function sGe(s,e){const t=TI(e),i=e.getValue();return s.map(r=>t.getStringReplacement(r)).map(r=>r.removeCommonSuffixPrefix(i)).map(r=>t.getTextReplacement(r))}function oGe(s,e){const t=ht("result",[]),i=[];return e.add(lt(n=>{const o=s.read(n);Ki(r=>{if(o.length!==i.length){i.length=o.length;for(let a=0;a<i.length;a++)i[a]||(i[a]=ht("item",o[a]));t.set([...i],r)}i.forEach((a,l)=>a.set(o[l],r))})})),t}class rGe{constructor(e){this._contextKeyService=e}bind(e,t){return Ad(e,this._contextKeyService,t instanceof Function?t:i=>t.read(i))}}function WJ(s,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},s);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}class aGe{constructor(e,t,i,n=lGe){this.startValue=e,this.endValue=t,this.durationMs=i,this._interpolationFunction=n,this.startTimeMs=Date.now(),e===t&&(this.durationMs=0)}isFinished(){return Date.now()>=this.startTimeMs+this.durationMs}getValue(){const e=Date.now()-this.startTimeMs;return e>=this.durationMs?this.endValue:this._interpolationFunction(e,this.startValue,this.endValue-this.startValue,this.durationMs)}}function lGe(s,e,t,i){return s===i?e+t:t*(-Math.pow(2,-10*s/i)+1)+e}function cGe(s,e,t,i){return t*((s=s/i-1)*s*s+1)+e}class dGe{constructor(e){this._value=ht(this,e)}getValue(e){const t=this._value.read(e);return t.isFinished()||oM.instance.invalidateOnNextAnimationFrame(e),t.getValue()}}const eP=class eP{constructor(){this._counter=xl(this),this._isScheduled=!1}invalidateOnNextAnimationFrame(e){this._counter.read(e),this._isScheduled||(this._isScheduled=!0,xi().requestAnimationFrame(()=>{this._isScheduled=!1,this._update()}))}_update(){this._counter.trigger(void 0)}};eP.instance=new eP;let oM=eP;class NI{constructor(e,t){this.lineNumber=e,this.parts=t,dm(()=>sk(t,(i,n)=>i.column<=n.column))}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every((t,i)=>t.equals(e.parts[i]))}renderForScreenReader(e){if(this.parts.length===0)return"";const t=this.parts[this.parts.length-1],i=e.substr(0,t.column-1);return new ra([...this.parts.map(o=>new os(D.fromPositions(new z(1,o.column)),o.lines.map(r=>r.line).join(`
`)))]).applyToString(i).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(e=>e.lines.length===0)}get lineCount(){return 1+this.parts.reduce((e,t)=>e+t.lines.length-1,0)}}class rM{constructor(e,t,i,n=[]){this.column=e,this.text=t,this.preview=i,this._inlineDecorations=n,this.lines=fa(this.text).map((o,r)=>({line:o,lineDecorations:Qo.filter(this._inlineDecorations,r+1,1,o.length+1)}))}equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every((t,i)=>t.line===e.lines[i].line&&Qo.equalsArr(t.lineDecorations,e.lines[i].lineDecorations))}}class k8{constructor(e,t,i,n=0){this.lineNumber=e,this.columnRange=t,this.text=i,this.additionalReservedLineCount=n,this.parts=[new rM(this.columnRange.endColumnExclusive,this.text,!1)],this.newLines=fa(this.text)}renderForScreenReader(e){return this.newLines.join(`
`)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(e=>e.lines.length===0)}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every((t,i)=>t===e.newLines[i])&&this.additionalReservedLineCount===e.additionalReservedLineCount}}function HJ(s,e){return dn(s,e,Khe)}function Khe(s,e){return s===e?!0:!s||!e?!1:s instanceof NI&&e instanceof NI||s instanceof k8&&e instanceof k8?s.equals(e):!1}function Wu(s,e,t){const i=t?s.range.intersectRanges(t):s.range;if(!i)return s;const n=s.text.replaceAll(`\r
`,`
`),o=e.getValueInRange(i,1),r=mc(o,n),a=xs.ofText(o.substring(0,r)).addToPosition(s.range.getStartPosition()),l=n.substring(r),c=D.fromPositions(a,s.range.getEndPosition());return new os(c,l)}function Ghe(s,e){return s.text.startsWith(e.text)&&hGe(s.range,e.range)}function hGe(s,e){return e.getStartPosition().equals(s.getStartPosition())&&e.getEndPosition().isBeforeOrEqual(s.getEndPosition())}function VJ(s,e,t,i,n=0){let o=Wu(s,e);if(o.range.endLineNumber!==o.range.startLineNumber)return;const r=e.getLineContent(o.range.startLineNumber),a=Ui(r).length;if(o.range.startColumn-1<=a){const g=Ui(o.text).length,m=r.substring(o.range.startColumn-1,a),[p,v]=[o.range.getStartPosition(),o.range.getEndPosition()],b=p.column+m.length<=v.column?p.delta(0,m.length):v,w=D.fromPositions(b,v),C=o.text.startsWith(m)?o.text.substring(m.length):o.text.substring(g);o=new os(w,C)}const c=e.getValueInRange(o.range),d=uGe(c,o.text);if(!d)return;const h=o.range.startLineNumber,u=new Array;if(t==="prefix"){const g=d.filter(m=>m.originalLength===0);if(g.length>1||g.length===1&&g[0].originalStart!==c.length)return}const f=o.text.length-n;for(const g of d){const m=o.range.startColumn+g.originalStart+g.originalLength;if(t==="subwordSmart"&&i&&i.lineNumber===o.range.startLineNumber&&m<i.column||g.originalLength>0)return;if(g.modifiedLength===0)continue;const p=g.modifiedStart+g.modifiedLength,v=Math.max(g.modifiedStart,Math.min(p,f)),b=o.text.substring(g.modifiedStart,v),w=o.text.substring(v,Math.max(g.modifiedStart,p));b.length>0&&u.push(new rM(m,b,!1)),w.length>0&&u.push(new rM(m,w,!0))}return new NI(h,u)}let Dd;function uGe(s,e){if((Dd==null?void 0:Dd.originalValue)===s&&(Dd==null?void 0:Dd.newValue)===e)return Dd==null?void 0:Dd.changes;{let t=UJ(s,e,!0);if(t){const i=zJ(t);if(i>0){const n=UJ(s,e,!1);n&&zJ(n)<i&&(t=n)}}return Dd={originalValue:s,newValue:e,changes:t},t}}function zJ(s){let e=0;for(const t of s)e+=t.originalLength;return e}function UJ(s,e,t){if(s.length>5e3||e.length>5e3)return;function i(c){let d=0;for(let h=0,u=c.length;h<u;h++){const f=c.charCodeAt(h);f>d&&(d=f)}return d}const n=Math.max(i(s),i(e));function o(c){if(c<0)throw new Error("unexpected");return n+c+1}function r(c){let d=0,h=0;const u=new Int32Array(c.length);for(let f=0,g=c.length;f<g;f++)if(t&&c[f]==="("){const m=h*100+d;u[f]=o(2*m),d++}else if(t&&c[f]===")"){d=Math.max(d-1,0);const m=h*100+d;u[f]=o(2*m+1),d===0&&h++}else u[f]=c.charCodeAt(f);return u}const a=r(s),l=r(e);return new nh({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}function fGe(s,e){let t,i=!1;const n=new aoe(new So(s,void 0,e.update),(o,r)=>{i||(t=e.initial instanceof Function?e.initial():e.initial,i=!0);const a=e.update(o,t,r);return t=a,a},e.changeTracker,()=>{var o;i&&((o=e.disposeFinal)==null||o.call(e,t),i=!1)},e.equalityComparer??Ja,(o,r,a)=>{if(!i)throw new et("Can only set when there is a listener! This is to prevent leaks.");_w(r,l=>{t=o,n.setValue(o,l,a)})},Ls.ofCaller());return n}var gGe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$J=function(s,e){return function(t,i){e(t,i,s)}};class mGe{constructor(e,t){this._baseService=e,this._intercept=t}publicLog2(e,t){this._intercept(e,t),this._baseService.publicLog2(e,t)}}let D8=class extends mGe{constructor(e,t){super(e,(i,n)=>{let o=!0;n&&T8 in n&&(o=!!n[T8]),o&&t.getDataChannel("editTelemetry").sendData({eventName:i,data:n??{}})})}};D8=gGe([$J(0,Wo),$J(1,Cj)],D8);const T8=Symbol("shouldForwardToChannel");function pGe(s){return{[T8]:s}}function qJ(s){if(!s)return!1;const e=s.toLowerCase();return e==="github.copilot"||e==="github.copilot-chat"}function _Ge(s){const e=s.map(i=>new to(Ue.ofStartAndLength(i.rangeOffset,i.rangeLength),i.text));return e.reverse(),new bf(e)}function bGe(s,e){s.publicLog2("inlineCompletion.endOfLife",e)}class hN{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class Yhe{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}const vGe=3;class CGe{computeDiff(e,t,i){var l;const o=new SGe(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),r=[];let a=null;for(const c of o.changes){let d;c.originalEndLineNumber===0?d=new dt(c.originalStartLineNumber+1,c.originalStartLineNumber+1):d=new dt(c.originalStartLineNumber,c.originalEndLineNumber+1);let h;c.modifiedEndLineNumber===0?h=new dt(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):h=new dt(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let u=new Qa(d,h,(l=c.charChanges)==null?void 0:l.map(f=>new fr(new D(f.originalStartLineNumber,f.originalStartColumn,f.originalEndLineNumber,f.originalEndColumn),new D(f.modifiedStartLineNumber,f.modifiedStartColumn,f.modifiedEndLineNumber,f.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===u.modified.startLineNumber||a.original.endLineNumberExclusive===u.original.startLineNumber)&&(u=new Qa(a.original.join(u.original),a.modified.join(u.modified),a.innerChanges&&u.innerChanges?a.innerChanges.concat(u.innerChanges):void 0),r.pop()),r.push(u),a=u}return dm(()=>sk(r,(c,d)=>d.original.startLineNumber-c.original.endLineNumberExclusive===d.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<d.original.startLineNumber&&c.modified.endLineNumberExclusive<d.modified.startLineNumber)),new hN(r,[],o.quitEarly)}}function Xhe(s,e,t,i){return new nh(s,e,t).ComputeDiff(i)}let jJ=class{constructor(e){const t=[],i=[];for(let n=0,o=e.length;n<o;n++)t[n]=N8(e[n],1),i[n]=R8(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],o=[],r=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],d=e?this._startColumns[l]:1,h=e?this._endColumns[l]:c.length+1;for(let u=d;u<h;u++)n[a]=c.charCodeAt(u-1),o[a]=l+1,r[a]=u,a++;!e&&l<i&&(n[a]=10,o[a]=l+1,r[a]=c.length+1,a++)}return new wGe(n,o,r)}};class wGe{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class M1{constructor(e,t,i,n,o,r,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=o,this.modifiedStartColumn=r,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),o=t.getStartColumn(e.originalStart),r=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),h=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new M1(n,o,r,a,l,c,d,h)}}function yGe(s){if(s.length<=1)return s;const e=[s[0]];let t=e[0];for(let i=1,n=s.length;i<n;i++){const o=s[i],r=o.originalStart-(t.originalStart+t.originalLength),a=o.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(r,a)<vGe?(t.originalLength=o.originalStart+o.originalLength-t.originalStart,t.modifiedLength=o.modifiedStart+o.modifiedLength-t.modifiedStart):(e.push(o),t=o)}return e}class bx{constructor(e,t,i,n,o){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=o}static createFromDiffResult(e,t,i,n,o,r,a){let l,c,d,h,u;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(d=n.getStartLineNumber(t.modifiedStart)-1,h=0):(d=n.getStartLineNumber(t.modifiedStart),h=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),r&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&o()){const f=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),g=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(f.getElements().length>0&&g.getElements().length>0){let m=Xhe(f,g,o,!0).changes;a&&(m=yGe(m)),u=[];for(let p=0,v=m.length;p<v;p++)u.push(M1.createFromDiffChange(m[p],f,g))}}return new bx(l,c,d,h,u)}}class SGe{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new jJ(e),this.modified=new jJ(t),this.continueLineDiff=KJ(i.maxComputationTime),this.continueCharDiff=KJ(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=Xhe(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(bx.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let o=0,r=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,d=c?c.originalStart:this.originalLines.length,h=c?c.modifiedStart:this.modifiedLines.length;for(;o<d&&r<h;){const u=this.originalLines[o],f=this.modifiedLines[r];if(u!==f){{let g=N8(u,1),m=N8(f,1);for(;g>1&&m>1;){const p=u.charCodeAt(g-2),v=f.charCodeAt(m-2);if(p!==v)break;g--,m--}(g>1||m>1)&&this._pushTrimWhitespaceCharChange(n,o+1,1,g,r+1,1,m)}{let g=R8(u,1),m=R8(f,1);const p=u.length+1,v=f.length+1;for(;g<p&&m<v;){const b=u.charCodeAt(g-1),w=u.charCodeAt(m-1);if(b!==w)break;g++,m++}(g<p||m<v)&&this._pushTrimWhitespaceCharChange(n,o+1,g,p,r+1,m,v)}}o++,r++}c&&(n.push(bx.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),o+=c.originalLength,r+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,o,r,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,o,r,a))return;let l;this.shouldComputeCharChanges&&(l=[new M1(t,i,t,n,o,r,o,a)]),e.push(new bx(t,t,o,o,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,o,r,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===o?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new M1(t,i,t,n,o,r,o,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===o?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=o,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new M1(t,i,t,n,o,r,o,a)),!0):!1}}function N8(s,e){const t=Jo(s);return t===-1?e:t+1}function R8(s,e){const t=uc(s);return t===-1?e:t+2}function KJ(s){if(s===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<s}class xGe{compute(e,t,i=rI.instance,n){if(e.length===0||t.length===0)return tf.trivial(e,t);const o=new RF(e.length,t.length),r=new RF(e.length,t.length),a=new RF(e.length,t.length);for(let g=0;g<e.length;g++)for(let m=0;m<t.length;m++){if(!i.isValid())return tf.trivialTimedOut(e,t);const p=g===0?0:o.get(g-1,m),v=m===0?0:o.get(g,m-1);let b;e.getElement(g)===t.getElement(m)?(g===0||m===0?b=0:b=o.get(g-1,m-1),g>0&&m>0&&r.get(g-1,m-1)===3&&(b+=a.get(g-1,m-1)),b+=n?n(g,m):1):b=-1;const w=Math.max(p,v,b);if(w===b){const C=g>0&&m>0?a.get(g-1,m-1):0;a.set(g,m,C+1),r.set(g,m,3)}else w===p?(a.set(g,m,0),r.set(g,m,1)):w===v&&(a.set(g,m,0),r.set(g,m,2));o.set(g,m,w)}const l=[];let c=e.length,d=t.length;function h(g,m){(g+1!==c||m+1!==d)&&l.push(new Ts(new Ue(g+1,c),new Ue(m+1,d))),c=g,d=m}let u=e.length-1,f=t.length-1;for(;u>=0&&f>=0;)r.get(u,f)===3?(h(u,f),u--,f--):r.get(u,f)===1?u--:f--;return h(-1,-1),l.reverse(),new tf(l,!1)}}class Zhe{compute(e,t,i=rI.instance){if(e.length===0||t.length===0)return tf.trivial(e,t);const n=e,o=t;function r(m,p){for(;m<n.length&&p<o.length&&n.getElement(m)===o.getElement(p);)m++,p++;return m}let a=0;const l=new LGe;l.set(0,r(0,0));const c=new IGe;c.set(0,l.get(0)===0?null:new GJ(null,0,0,l.get(0)));let d=0;e:for(;;){if(a++,!i.isValid())return tf.trivialTimedOut(n,o);const m=-Math.min(a,o.length+a%2),p=Math.min(a,n.length+a%2);for(d=m;d<=p;d+=2){const v=d===p?-1:l.get(d+1),b=d===m?-1:l.get(d-1)+1,w=Math.min(Math.max(v,b),n.length),C=w-d;if(w>n.length||C>o.length)continue;const y=r(w,C);l.set(d,y);const x=w===v?c.get(d+1):c.get(d-1);if(c.set(d,y!==w?new GJ(x,w,C,y-w):x),l.get(d)===n.length&&l.get(d)-d===o.length)break e}}let h=c.get(d);const u=[];let f=n.length,g=o.length;for(;;){const m=h?h.x+h.length:0,p=h?h.y+h.length:0;if((m!==f||p!==g)&&u.push(new Ts(new Ue(m,f),new Ue(p,g))),!h)break;f=h.x,g=h.y,h=h.prev}return u.reverse(),new tf(u,!1)}}class GJ{constructor(e,t,i,n){this.prev=e,this.x=t,this.y=i,this.length=n}}class LGe{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class IGe{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class aM{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let o=e[n-1],r=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(r=this.range.startColumn-1,o=o.substring(r)),this.lineStartOffsets.push(r);let a=0;if(!i){const c=o.trimStart();a=o.length-c.length,o=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-r-a,o.length):o.length;for(let c=0;c<l;c++)this.elements.push(o.charCodeAt(c));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Ue(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=ZJ(e>0?this.elements[e-1]:-1),i=ZJ(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=XJ(t),n+=XJ(i),n}translateOffset(e,t="right"){const i=Dw(this.firstElementOffsetByLineIdx,o=>o<=e),n=e-this.firstElementOffsetByLineIdx[i];return new z(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?D.fromPositions(i,i):D.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!sC(this.elements[e]))return;let t=e;for(;t>0&&sC(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&sC(this.elements[i]);)i++;return new Ue(t,i)}findSubWordContaining(e){if(e<0||e>=this.elements.length||!sC(this.elements[e]))return;let t=e;for(;t>0&&sC(this.elements[t-1])&&!YJ(this.elements[t]);)t--;let i=e;for(;i<this.elements.length&&sC(this.elements[i])&&!YJ(this.elements[i]);)i++;return new Ue(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=kw(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=m4e(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new Ue(t,i)}}function sC(s){return s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57}function YJ(s){return s>=65&&s<=90}const EGe={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function XJ(s){return EGe[s]}function ZJ(s){return s===10?8:s===13?7:N7(s)?6:s>=97&&s<=122?0:s>=65&&s<=90?1:s>=48&&s<=57?2:s===-1?3:s===44||s===59?5:4}function kGe(s,e,t,i,n,o){let{moves:r,excludedChanges:a}=TGe(s,e,t,o);if(!o.isValid())return[];const l=s.filter(d=>!a.has(d)),c=NGe(l,i,n,e,t,o);return F9(r,c),r=RGe(r),r=r.filter(d=>{const h=d.original.toOffsetRange().slice(e).map(f=>f.trim());return h.join(`
`).length>=15&&DGe(h,f=>f.length>=2)>=2}),r=MGe(s,r),r}function DGe(s,e){let t=0;for(const i of s)e(i)&&t++;return t}function TGe(s,e,t,i){const n=[],o=s.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new QR(l.original,e,l)),r=new Set(s.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new QR(l.modified,t,l))),a=new Set;for(const l of o){let c=-1,d;for(const h of r){const u=l.computeSimilarity(h);u>c&&(c=u,d=h)}if(c>.9&&d&&(r.delete(d),n.push(new Xo(l.range,d.range)),a.add(l.source),a.add(d.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function NGe(s,e,t,i,n,o){const r=[],a=new Eoe;for(const u of s)for(let f=u.original.startLineNumber;f<u.original.endLineNumberExclusive-2;f++){const g=`${e[f-1]}:${e[f+1-1]}:${e[f+2-1]}`;a.add(g,{range:new dt(f,f+3)})}const l=[];s.sort(wo(u=>u.modified.startLineNumber,aa));for(const u of s){let f=[];for(let g=u.modified.startLineNumber;g<u.modified.endLineNumberExclusive-2;g++){const m=`${t[g-1]}:${t[g+1-1]}:${t[g+2-1]}`,p=new dt(g,g+3),v=[];a.forEach(m,({range:b})=>{for(const C of f)if(C.originalLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive&&C.modifiedLineRange.endLineNumberExclusive+1===p.endLineNumberExclusive){C.originalLineRange=new dt(C.originalLineRange.startLineNumber,b.endLineNumberExclusive),C.modifiedLineRange=new dt(C.modifiedLineRange.startLineNumber,p.endLineNumberExclusive),v.push(C);return}const w={modifiedLineRange:p,originalLineRange:b};l.push(w),v.push(w)}),f=v}if(!o.isValid())return[]}l.sort(noe(wo(u=>u.modifiedLineRange.length,aa)));const c=new Sl,d=new Sl;for(const u of l){const f=u.modifiedLineRange.startLineNumber-u.originalLineRange.startLineNumber,g=c.subtractFrom(u.modifiedLineRange),m=d.subtractFrom(u.originalLineRange).getWithDelta(f),p=g.getIntersection(m);for(const v of p.ranges){if(v.length<3)continue;const b=v,w=v.delta(-f);r.push(new Xo(w,b)),c.addRange(b),d.addRange(w)}}r.sort(wo(u=>u.original.startLineNumber,aa));const h=new LR(s);for(let u=0;u<r.length;u++){const f=r[u],g=h.findLastMonotonous(x=>x.original.startLineNumber<=f.original.startLineNumber),m=kw(s,x=>x.modified.startLineNumber<=f.modified.startLineNumber),p=Math.max(f.original.startLineNumber-g.original.startLineNumber,f.modified.startLineNumber-m.modified.startLineNumber),v=h.findLastMonotonous(x=>x.original.startLineNumber<f.original.endLineNumberExclusive),b=kw(s,x=>x.modified.startLineNumber<f.modified.endLineNumberExclusive),w=Math.max(v.original.endLineNumberExclusive-f.original.endLineNumberExclusive,b.modified.endLineNumberExclusive-f.modified.endLineNumberExclusive);let C;for(C=0;C<p;C++){const x=f.original.startLineNumber-C-1,S=f.modified.startLineNumber-C-1;if(x>i.length||S>n.length||c.contains(S)||d.contains(x)||!QJ(i[x-1],n[S-1],o))break}C>0&&(d.addRange(new dt(f.original.startLineNumber-C,f.original.startLineNumber)),c.addRange(new dt(f.modified.startLineNumber-C,f.modified.startLineNumber)));let y;for(y=0;y<w;y++){const x=f.original.endLineNumberExclusive+y,S=f.modified.endLineNumberExclusive+y;if(x>i.length||S>n.length||c.contains(S)||d.contains(x)||!QJ(i[x-1],n[S-1],o))break}y>0&&(d.addRange(new dt(f.original.endLineNumberExclusive,f.original.endLineNumberExclusive+y)),c.addRange(new dt(f.modified.endLineNumberExclusive,f.modified.endLineNumberExclusive+y))),(C>0||y>0)&&(r[u]=new Xo(new dt(f.original.startLineNumber-C,f.original.endLineNumberExclusive+y),new dt(f.modified.startLineNumber-C,f.modified.endLineNumberExclusive+y)))}return r}function QJ(s,e,t){if(s.trim()===e.trim())return!0;if(s.length>300&&e.length>300)return!1;const n=new Zhe().compute(new aM([s],new D(1,1,1,s.length),!1),new aM([e],new D(1,1,1,e.length),!1),t);let o=0;const r=Ts.invert(n.diffs,s.length);for(const d of r)d.seq1Range.forEach(h=>{N7(s.charCodeAt(h))||o++});function a(d){let h=0;for(let u=0;u<s.length;u++)N7(d.charCodeAt(u))||h++;return h}const l=a(s.length>e.length?s:e);return o/l>.6&&l>10}function RGe(s){if(s.length===0)return s;s.sort(wo(t=>t.original.startLineNumber,aa));const e=[s[0]];for(let t=1;t<s.length;t++){const i=e[e.length-1],n=s[t],o=n.original.startLineNumber-i.original.endLineNumberExclusive,r=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(o>=0&&r>=0&&o+r<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function MGe(s,e){const t=new LR(s);return e=e.filter(i=>{const n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new Xo(new dt(1,1),new dt(1,1)),o=kw(s,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==o}),e}function JJ(s,e,t){let i=t;return i=eee(s,e,i),i=eee(s,e,i),i=AGe(s,e,i),i}function eee(s,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let o=1;o<t.length;o++){const r=i[i.length-1];let a=t[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-r.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(s.getElement(a.seq1Range.start-c)!==s.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new Ts(new Ue(r.seq1Range.start,a.seq1Range.endExclusive-l),new Ue(r.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const n=[];for(let o=0;o<i.length-1;o++){const r=i[o+1];let a=i[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=r.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!s.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[o+1]=new Ts(new Ue(a.seq1Range.start+l,r.seq1Range.endExclusive),new Ue(a.seq2Range.start+l,r.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function AGe(s,e,t){if(!s.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const n=i>0?t[i-1]:void 0,o=t[i],r=i+1<t.length?t[i+1]:void 0,a=new Ue(n?n.seq1Range.endExclusive+1:0,r?r.seq1Range.start-1:s.length),l=new Ue(n?n.seq2Range.endExclusive+1:0,r?r.seq2Range.start-1:e.length);o.seq1Range.isEmpty?t[i]=tee(o,s,e,a,l):o.seq2Range.isEmpty&&(t[i]=tee(o.swap(),e,s,l,a).swap())}return t}function tee(s,e,t,i,n){let r=1;for(;s.seq1Range.start-r>=i.start&&s.seq2Range.start-r>=n.start&&t.isStronglyEqual(s.seq2Range.start-r,s.seq2Range.endExclusive-r)&&r<100;)r++;r--;let a=0;for(;s.seq1Range.start+a<i.endExclusive&&s.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(s.seq2Range.start+a,s.seq2Range.endExclusive+a)&&a<100;)a++;if(r===0&&a===0)return s;let l=0,c=-1;for(let d=-r;d<=a;d++){const h=s.seq2Range.start+d,u=s.seq2Range.endExclusive+d,f=s.seq1Range.start+d,g=e.getBoundaryScore(f)+t.getBoundaryScore(h)+t.getBoundaryScore(u);g>c&&(c=g,l=d)}return s.delta(l)}function PGe(s,e,t){const i=[];for(const n of t){const o=i[i.length-1];if(!o){i.push(n);continue}n.seq1Range.start-o.seq1Range.endExclusive<=2||n.seq2Range.start-o.seq2Range.endExclusive<=2?i[i.length-1]=new Ts(o.seq1Range.join(n.seq1Range),o.seq2Range.join(n.seq2Range)):i.push(n)}return i}function iee(s,e,t,i,n=!1){const o=Ts.invert(t,s.length),r=[];let a=new Bu(0,0);function l(d,h){if(d.offset1<a.offset1||d.offset2<a.offset2)return;const u=i(s,d.offset1),f=i(e,d.offset2);if(!u||!f)return;let g=new Ts(u,f);const m=g.intersect(h);let p=m.seq1Range.length,v=m.seq2Range.length;for(;o.length>0;){const b=o[0];if(!(b.seq1Range.intersects(g.seq1Range)||b.seq2Range.intersects(g.seq2Range)))break;const C=i(s,b.seq1Range.start),y=i(e,b.seq2Range.start),x=new Ts(C,y),S=x.intersect(b);if(p+=S.seq1Range.length,v+=S.seq2Range.length,g=g.join(x),g.seq1Range.endExclusive>=b.seq1Range.endExclusive)o.shift();else break}(n&&p+v<g.seq1Range.length+g.seq2Range.length||p+v<(g.seq1Range.length+g.seq2Range.length)*2/3)&&r.push(g),a=g.getEndExclusives()}for(;o.length>0;){const d=o.shift();d.seq1Range.isEmpty||(l(d.getStarts(),d),l(d.getEndExclusives().delta(-1),d))}return OGe(t,r)}function OGe(s,e){const t=[];for(;s.length>0||e.length>0;){const i=s[0],n=e[0];let o;i&&(!n||i.seq1Range.start<n.seq1Range.start)?o=s.shift():o=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=o.seq1Range.start?t[t.length-1]=t[t.length-1].join(o):t.push(o)}return t}function FGe(s,e,t){let i=t;if(i.length===0)return i;let n=0,o;do{o=!1;const r=[i[0]];for(let a=1;a<i.length;a++){let d=function(u,f){const g=new Ue(c.seq1Range.endExclusive,l.seq1Range.start);return s.getText(g).replace(/\s/g,"").length<=4&&(u.seq1Range.length+u.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};const l=i[a],c=r[r.length-1];d(c,l)?(o=!0,r[r.length-1]=r[r.length-1].join(l)):r.push(l)}i=r}while(n++<10&&o);return i}function BGe(s,e,t){let i=t;if(i.length===0)return i;let n=0,o;do{o=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let h=function(f,g){const m=new Ue(d.seq1Range.endExclusive,c.seq1Range.start);if(s.countLinesIn(m)>5||m.length>500)return!1;const v=s.getText(m).trim();if(v.length>20||v.split(/\r\n|\r|\n/).length>1)return!1;const b=s.countLinesIn(f.seq1Range),w=f.seq1Range.length,C=e.countLinesIn(f.seq2Range),y=f.seq2Range.length,x=s.countLinesIn(g.seq1Range),S=g.seq1Range.length,L=e.countLinesIn(g.seq2Range),E=g.seq2Range.length,M=130;function R(T){return Math.min(T,M)}return Math.pow(Math.pow(R(b*40+w),1.5)+Math.pow(R(C*40+y),1.5),1.5)+Math.pow(Math.pow(R(x*40+S),1.5)+Math.pow(R(L*40+E),1.5),1.5)>(M**1.5)**1.5*1.3};const c=i[l],d=a[a.length-1];h(d,c)?(o=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(n++<10&&o);const r=[];return tTe(i,(a,l,c)=>{let d=l;function h(v){return v.length>0&&v.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const u=s.extendToFullLines(l.seq1Range),f=s.getText(new Ue(u.start,l.seq1Range.start));h(f)&&(d=d.deltaStart(-f.length));const g=s.getText(new Ue(l.seq1Range.endExclusive,u.endExclusive));h(g)&&(d=d.deltaEnd(g.length));const m=Ts.fromOffsetPairs(a?a.getEndExclusives():Bu.zero,c?c.getStarts():Bu.max),p=d.intersect(m);r.length>0&&p.getStarts().equals(r[r.length-1].getEndExclusives())?r[r.length-1]=r[r.length-1].join(p):r.push(p)}),r}class nee{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:see(this.lines[e-1]),i=e===this.lines.length?0:see(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function see(s){let e=0;for(;e<s.length&&(s.charCodeAt(e)===32||s.charCodeAt(e)===9);)e++;return e}class WGe{constructor(){this.dynamicProgrammingDiffing=new xGe,this.myersDiffingAlgorithm=new Zhe}computeDiff(e,t,i){if(e.length<=1&&dn(e,t,(S,L)=>S===L))return new hN([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new hN([new Qa(new dt(1,e.length+1),new dt(1,t.length+1),[new fr(new D(1,1,e.length,e[e.length-1].length+1),new D(1,1,t.length,t[t.length-1].length+1))])],[],!1);const n=i.maxComputationTimeMs===0?rI.instance:new B8e(i.maxComputationTimeMs),o=!i.ignoreTrimWhitespace,r=new Map;function a(S){let L=r.get(S);return L===void 0&&(L=r.size,r.set(S,L)),L}const l=e.map(S=>a(S.trim())),c=t.map(S=>a(S.trim())),d=new nee(l,e),h=new nee(c,t),u=d.length+h.length<1700?this.dynamicProgrammingDiffing.compute(d,h,n,(S,L)=>e[S]===t[L]?t[L].length===0?.1:1+Math.log(1+t[L].length):.99):this.myersDiffingAlgorithm.compute(d,h,n);let f=u.diffs,g=u.hitTimeout;f=JJ(d,h,f),f=FGe(d,h,f);const m=[],p=S=>{if(o)for(let L=0;L<S;L++){const E=v+L,M=b+L;if(e[E]!==t[M]){const R=this.refineDiff(e,t,new Ts(new Ue(E,E+1),new Ue(M,M+1)),n,o,i);for(const T of R.mappings)m.push(T);R.hitTimeout&&(g=!0)}}};let v=0,b=0;for(const S of f){dm(()=>S.seq1Range.start-v===S.seq2Range.start-b);const L=S.seq1Range.start-v;p(L),v=S.seq1Range.endExclusive,b=S.seq2Range.endExclusive;const E=this.refineDiff(e,t,S,n,o,i);E.hitTimeout&&(g=!0);for(const M of E.mappings)m.push(M)}p(e.length-v);const w=new fD(e),C=new fD(t),y=ZR(m,w,C);let x=[];return i.computeMoves&&(x=this.computeMoves(y,e,t,l,c,n,o,i)),dm(()=>{function S(E,M){if(E.lineNumber<1||E.lineNumber>M.length)return!1;const R=M[E.lineNumber-1];return!(E.column<1||E.column>R.length+1)}function L(E,M){return!(E.startLineNumber<1||E.startLineNumber>M.length+1||E.endLineNumberExclusive<1||E.endLineNumberExclusive>M.length+1)}for(const E of y){if(!E.innerChanges)return!1;for(const M of E.innerChanges)if(!(S(M.modifiedRange.getStartPosition(),t)&&S(M.modifiedRange.getEndPosition(),t)&&S(M.originalRange.getStartPosition(),e)&&S(M.originalRange.getEndPosition(),e)))return!1;if(!L(E.modified,t)||!L(E.original,e))return!1}return!0}),new hN(y,x,g)}computeMoves(e,t,i,n,o,r,a,l){return kGe(e,t,i,n,o,r).map(h=>{const u=this.refineDiff(t,i,new Ts(h.original.toOffsetRange(),h.modified.toOffsetRange()),r,a,l),f=ZR(u.mappings,new fD(t),new fD(i),!0);return new Yhe(h,f)})}refineDiff(e,t,i,n,o,r){const l=HGe(i).toRangeMapping2(e,t),c=new aM(e,l.originalRange,o),d=new aM(t,l.modifiedRange,o),h=c.length+d.length<500?this.dynamicProgrammingDiffing.compute(c,d,n):this.myersDiffingAlgorithm.compute(c,d,n);let u=h.diffs;return u=JJ(c,d,u),u=iee(c,d,u,(g,m)=>g.findWordContaining(m)),r.extendToSubwords&&(u=iee(c,d,u,(g,m)=>g.findSubWordContaining(m),!0)),u=PGe(c,d,u),u=BGe(c,d,u),{mappings:u.map(g=>new fr(c.translateRange(g.seq1Range),d.translateRange(g.seq2Range))),hitTimeout:h.hitTimeout}}}function HGe(s){return new Xo(new dt(s.seq1Range.start+1,s.seq1Range.endExclusive+1),new dt(s.seq2Range.start+1,s.seq2Range.endExclusive+1))}const M8={getLegacy:()=>new CGe,getDefault:()=>new WGe};var A8;(function(s){function e(t,i){return!t.isInlineEdit&&!t.uri?vx.create(t,i):A1.create(t,i)}s.create=e})(A8||(A8={}));class Qhe{constructor(e,t,i){this._data=e,this.identity=t,this.hint=i}get source(){return this._data.source}get isFromExplicitRequest(){return this._data.context.triggerKind===Tr.Explicit}get forwardStable(){return this.source.inlineSuggestions.enableForwardStability??!1}get editRange(){return this.getSingleTextEdit().range}get targetRange(){var e,t;return(e=this.hint)!=null&&e.range&&!this.hint.jumpToEdit?(t=this.hint)==null?void 0:t.range:this.editRange}get insertText(){return this.getSingleTextEdit().text}get semanticId(){return this.hash}get action(){return this._sourceInlineCompletion.gutterMenuLinkAction}get command(){return this._sourceInlineCompletion.command}get warning(){return this._sourceInlineCompletion.warning}get showInlineEditMenu(){return!!this._sourceInlineCompletion.showInlineEditMenu}get hash(){return JSON.stringify([this.getSingleTextEdit().text,this.getSingleTextEdit().range.getStartPosition().toString()])}get requestUuid(){return this._data.context.requestUuid}get partialAccepts(){return this._data.partialAccepts}get _sourceInlineCompletion(){return this._data.sourceInlineCompletion}addRef(){this.identity.addRef(),this.source.addRef()}removeRef(){this.identity.removeRef(),this.source.removeRef()}reportInlineEditShown(e,t,i){this._data.reportInlineEditShown(e,this.insertText,t,i)}reportPartialAccept(e,t,i){this._data.reportPartialAccept(e,t,i)}reportEndOfLife(e){this._data.reportEndOfLife(e)}setEndOfLifeReason(e){this._data.setEndOfLifeReason(e)}setIsPreceeded(e){this._data.setIsPreceeded(e.partialAccepts)}setNotShownReasonIfNotSet(e){this._data.setNotShownReason(e)}getSourceCompletion(){return this._sourceInlineCompletion}}const tP=class tP{constructor(){this._onDispose=xl(this),this._jumpedTo=ht(this,!1),this._refCount=1,this.id="InlineCompletionIdentity"+tP.idCounter++}get jumpedTo(){return this._jumpedTo}addRef(){this._refCount++}removeRef(){this._refCount--,this._refCount===0&&this._onDispose.trigger(void 0)}setJumpTo(e){this._jumpedTo.set(!0,e)}};tP.idCounter=0;let lM=tP;class RI{static create(e){return new RI(D.lift(e.range),e.content,e.style,e.jumpToEdit)}constructor(e,t,i,n){this.range=e,this.content=t,this.style=i,this.jumpToEdit=n}withEdit(e,t){const i=new Ue(t.getOffset(this.range.getStartPosition()),t.getOffset(this.range.getEndPosition())),n=yae([i],e)[0];if(!n)return;const o=t.getRange(n);return new RI(o,this.content,this.style,this.jumpToEdit)}}class vx extends Qhe{static create(e,t){const i=new lM,n=TI(t),o=e.insertText.replace(/\r\n|\r|\n/g,t.getEOL()),r=zGe(new to(n.getOffsetRange(e.range),o),t),a=r.removeCommonSuffixAndPrefix(t.getValue()),l=n.getTextReplacement(r),c=e.hint?RI.create(e.hint):void 0;return new vx(r,a,l,l.range,e.snippetInfo,e.additionalTextEdits,e,i,c)}constructor(e,t,i,n,o,r,a,l,c){super(a,l,c),this._edit=e,this._trimmedEdit=t,this._textEdit=i,this._originalRange=n,this.snippetInfo=o,this.additionalTextEdits=r,this.isInlineEdit=!1}get hash(){return JSON.stringify(this._trimmedEdit.toJson())}getSingleTextEdit(){return this._textEdit}withIdentity(e){return new vx(this._edit,this._trimmedEdit,this._textEdit,this._originalRange,this.snippetInfo,this.additionalTextEdits,this._data,e,this.hint)}withEdit(e,t){const i=yae([this._edit.replaceRange],e);if(i.length===0)return;const n=new to(i[0],this._textEdit.text),o=TI(t),r=o.getTextReplacement(n);let a=this.hint;if(a&&(a=a.withEdit(e,o),!a))return;const l=n.removeCommonSuffixAndPrefix(t.getValue());return new vx(n,l,r,this._originalRange,this.snippetInfo,this.additionalTextEdits,this._data,this.identity,a)}canBeReused(e,t){const i=this._textEdit.range;return!!i&&i.containsPosition(t)&&this.isVisible(e,t)&&xs.ofRange(i).isGreaterThanOrEqualTo(xs.ofRange(this._originalRange))}isVisible(e,t){const i=this.getSingleTextEdit();return Jhe(i,this._originalRange,e,t)}}function Jhe(s,e,t,i){const n=Wu(s,t),o=s.range;if(!o||e&&!e.getStartPosition().equals(o.getStartPosition())||i.lineNumber!==n.range.startLineNumber||n.isEmpty)return!1;const r=t.getValueInRange(n.range,1),a=n.text,l=Math.max(0,i.column-n.range.startColumn);let c=a.substring(0,l),d=a.substring(l),h=r.substring(0,l),u=r.substring(l);const f=t.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=f&&(h=h.trimStart(),h.length===0&&(u=u.trimStart()),c=c.trimStart(),c.length===0&&(d=d.trimStart())),c.startsWith(h)&&!!ale(u,d)}class A1 extends Qhe{static create(e,t){const i=VGe(t,e.range,e.insertText),n=new qb(t),o=ra.fromStringEdit(i,n),r=i.isEmpty()?new os(new D(1,1,1,1),""):o.toReplacement(n),a=new lM,l=i.replacements.map(d=>{const h=D.fromPositions(t.getPositionAt(d.replaceRange.start),t.getPositionAt(d.replaceRange.endExclusive)),u=t.getValueInRange(h);return cM.create(d,u)}),c=e.hint?RI.create(e.hint):void 0;return new A1(i,r,e.uri,e,a,l,c,!1,t.getVersionId())}constructor(e,t,i,n,o,r,a,l=!1,c){super(n,o,a),this._edit=e,this._textEdit=t,this.uri=i,this._edits=r,this._lastChangePartOfInlineEdit=l,this._inlineEditModelVersion=c,this.snippetInfo=void 0,this.additionalTextEdits=[],this.isInlineEdit=!0}get updatedEditModelVersion(){return this._inlineEditModelVersion}get updatedEdit(){return this._edit}getSingleTextEdit(){return this._textEdit}withIdentity(e){return new A1(this._edit,this._textEdit,this.uri,this._data,e,this._edits,this.hint,this._lastChangePartOfInlineEdit,this._inlineEditModelVersion)}canBeReused(e,t){return this._lastChangePartOfInlineEdit&&this.updatedEditModelVersion===e.getVersionId()}withEdit(e,t){return this._applyTextModelChanges(e,this._edits,t)}_applyTextModelChanges(e,t,i){if(t=t.map(h=>h.applyTextModelChanges(e)),t.some(h=>h.edit===void 0))return;const n=i.getVersionId();let o=this._inlineEditModelVersion;const r=t.some(h=>h.lastChangeUpdatedEdit);if(r&&(o=n??-1),n===null||o+20<n||(t=t.filter(h=>!h.edit.isEmpty),t.length===0))return;const a=new bf(t.map(h=>h.edit)),l=TI(i),c=l.getTextEdit(a).toReplacement(new qb(i));let d=this.hint;if(!(d&&(d=d.withEdit(e,l),!d)))return new A1(a,c,this.uri,this._data,this.identity,t,d,r,o)}}function VGe(s,e,t){const i=s.getEOL(),n=s.getValueInRange(e),o=t.replace(/\r\n|\r|\n/g,i),l=M8.getDefault().computeDiff(fa(n),fa(o),{ignoreTrimWhitespace:!1,computeMoves:!1,extendToSubwords:!0,maxComputationTimeMs:500}).changes.flatMap(u=>u.innerChanges??[]);function c(u,f){const g=xs.fromPosition(f.getStartPosition());return xs.ofRange(f).createRange(g.addToPosition(u))}const d=new xg(o);return new bf(l.map(u=>{const f=c(e.getStartPosition(),u.originalRange),g=TI(s).getOffsetRange(f),m=d.getValueOfRange(u.modifiedRange),p=new to(g,m),v=s.getValueInRange(f);return UGe(p,v,l.length,s)}))}class cM{static create(e,t){const i=mc(e.newText,t),n=df(e.newText,t),o=e.newText.substring(i,e.newText.length-n);return new cM(e,o,i,n)}get edit(){return this._edit}get lastChangeUpdatedEdit(){return this._lastChangeUpdatedEdit}constructor(e,t,i,n,o=!1){this._edit=e,this._trimmedNewText=t,this._prefixLength=i,this._suffixLength=n,this._lastChangeUpdatedEdit=o}applyTextModelChanges(e){const t=this._clone();return t._applyTextModelChanges(e),t}_clone(){return new cM(this._edit,this._trimmedNewText,this._prefixLength,this._suffixLength,this._lastChangeUpdatedEdit)}_applyTextModelChanges(e){if(this._lastChangeUpdatedEdit=!1,!this._edit)throw new et("UpdatedInnerEdits: No edit to apply changes to");const t=this._applyChanges(this._edit,e);if(!t){this._edit=void 0;return}this._edit=t.edit,this._lastChangeUpdatedEdit=t.editHasChanged}_applyChanges(e,t){let i=e.replaceRange.start,n=e.replaceRange.endExclusive,o=e.newText,r=!1;const a=this._prefixLength>0||this._suffixLength>0;for(let l=t.replacements.length-1;l>=0;l--){const c=t.replacements[l],d=c.newText.length>0&&c.replaceRange.isEmpty;if(d&&!a&&c.replaceRange.start===i&&o.startsWith(c.newText)){i+=c.newText.length,o=o.substring(c.newText.length),n=Math.max(i,n),r=!0;continue}if(d&&a&&c.replaceRange.start===i+this._prefixLength&&this._trimmedNewText.startsWith(c.newText)){n+=c.newText.length,r=!0,this._prefixLength+=c.newText.length,this._trimmedNewText=this._trimmedNewText.substring(c.newText.length);continue}if(c.newText.length===0&&c.replaceRange.length>0&&c.replaceRange.start>=i+this._prefixLength&&c.replaceRange.endExclusive<=n-this._suffixLength){n-=c.replaceRange.length,r=!0;continue}if(c.equals(e)){r=!0,i=c.replaceRange.endExclusive,o="";continue}if(!(c.replaceRange.start>n)){if(c.replaceRange.endExclusive<i){i+=c.newText.length-c.replaceRange.length,n+=c.newText.length-c.replaceRange.length;continue}return}}return this._trimmedNewText.length===0&&i+this._prefixLength===n-this._suffixLength?{edit:new to(new Ue(i+this._prefixLength,i+this._prefixLength),""),editHasChanged:!0}:{edit:new to(new Ue(i,n),o),editHasChanged:r}}}function zGe(s,e){const t=e.getEOL();return s.replaceRange.isEmpty&&s.newText.includes(t)&&(s=eue(s,e)),s}function UGe(s,e,t,i){const n=i.getEOL();if(s.newText.endsWith(n)&&e.endsWith(n)&&(s=new to(s.replaceRange.deltaEnd(-n.length),s.newText.slice(0,-n.length))),t===1&&s.replaceRange.isEmpty&&s.newText.includes(n)){const o=i.getPositionAt(s.replaceRange.start);i.getLineLength(o.lineNumber)!==0&&(s=eue(s,i))}if(t===1){const o=mc(e,s.newText),r=df(e.slice(o),s.newText.slice(o));if(o+r===e.length)return new to(s.replaceRange.deltaStart(o).deltaEnd(-r),s.newText.substring(o,s.newText.length-r));if(o+r===s.newText.length)return new to(s.replaceRange.deltaStart(o).deltaEnd(-r),"")}return s}function eue(s,e){if(!s.replaceRange.isEmpty)throw new et("Unexpected original range");if(s.replaceRange.start===0)return s;const t=e.getEOL(),i=e.getPositionAt(s.replaceRange.start),n=i.column,o=i.lineNumber;return n===1&&o>1&&s.newText.endsWith(t)&&!s.newText.startsWith(t)?new to(s.replaceRange.delta(-1),t+s.newText.slice(0,-t.length)):s}function $Ge(s,e){const t=new Dae,i=new Nae(t,c=>e.getLanguageConfiguration(c)),n=new Tae(new qGe([s]),i),o=jB(n,[],void 0,!0);let r="";const a=s.getLineContent();function l(c,d){if(c.kind===2)if(l(c.openingBracket,d),d=On(d,c.openingBracket.length),c.child&&(l(c.child,d),d=On(d,c.child.length)),c.closingBracket)l(c.closingBracket,d),d=On(d,c.closingBracket.length);else{const u=i.getSingleLanguageBracketTokens(c.openingBracket.languageId).findClosingTokenText(c.openingBracket.bracketIds);r+=u}else if(c.kind!==3){if(c.kind===0||c.kind===1)r+=a.substring(d,On(d,c.length));else if(c.kind===4)for(const h of c.children)l(h,d),d=On(d,h.length)}}return l(o,_r),r}class qGe{constructor(e){this.lines=e,this.tokenization={getLineTokens:t=>this.lines[t-1]}}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}}class wj{constructor(){this._nodes=new Set,this._outgoingEdges=new Map}static from(e,t){const i=new wj;for(const n of e)i._nodes.add(n);for(const n of e){const o=t(n);if(o.length>0){const r=new Set;for(const a of o)r.add(a);i._outgoingEdges.set(n,r)}}return i}removeCycles(){const e=[],t=new Set,i=new Set,n=[],o=r=>{t.add(r),i.add(r);const a=this._outgoingEdges.get(r);if(a)for(const l of a)t.has(l)?i.has(l)&&(e.push(l),n.push({from:r,to:l})):o(l);i.delete(r)};for(const r of this._nodes)t.has(r)||o(r);for(const{from:r,to:a}of n){const l=this._outgoingEdges.get(r);l&&l.delete(a)}return{foundCycles:e}}getOutgoing(e){const t=this._outgoingEdges.get(e);return t?Array.from(t):[]}}var No;(function(s){s.Jump="jump",s.Accept="accept",s.Inactive="inactive"})(No||(No={}));var hi;(function(s){s.GhostText="ghostText",s.Custom="custom",s.SideBySide="sideBySide",s.Deletion="deletion",s.InsertionInline="insertionInline",s.InsertionMultiLine="insertionMultiLine",s.WordReplacements="wordReplacements",s.LineReplacement="lineReplacement",s.Collapsed="collapsed"})(hi||(hi={}));function jGe(s,e,t,i,n,o){const r=$re("icr"),a=new hn;let l;const c={...i,requestUuid:r},d=XGe(e,t),h=U3e(s,v=>v.groupId),u=wj.from(s,v=>{var b;return((b=v.yieldsToGroupIds)==null?void 0:b.flatMap(w=>h.get(w)??[]))??[]}),{foundCycles:f}=u.removeCycles();f.length>0&&as(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${f.map(v=>v.toString?v.toString():""+v).join(" -> ")}`));let g=0;const m=new k9(async v=>{try{if(g++,a.token.isCancellationRequested)return;const b=u.getOutgoing(v);for(const L of b){const E=await m.get(L);if(E)for(const M of E.inlineSuggestions.items){if(M.isInlineEdit||typeof M.insertText!="string"&&M.insertText!==void 0)return;if(M.insertText!==void 0){const R=new os(D.lift(M.range)??d,M.insertText);if(Jhe(R,void 0,t,e))return}}}let w;const C=Date.now();try{w=await v.provideInlineCompletions(t,e,c,a.token)}catch(L){as(L);return}const y=Date.now();if(!w)return;const x=[],S=new YGe(w,x,v);if(S.addRef(),tue(a.token,()=>S.removeRef(l)),a.token.isCancellationRequested)return;for(const L of w.items)x.push(KGe(L,S,d,t,o,c,n,{startTime:C,endTime:y}));return S}finally{g--}}),p=Dl.fromPromisesResolveOrder(s.map(v=>m.get(v))).filter($s);return{contextWithUuid:c,get didAllProvidersReturn(){return g===0},lists:p,cancelAndDispose:v=>{l===void 0&&(l=v,a.dispose(!0))}}}function tue(s,e){if(s.isCancellationRequested)return e(),K.None;{const t=s.onCancellationRequested(()=>{t.dispose(),e()});return{dispose:()=>t.dispose()}}}function KGe(s,e,t,i,n,o,r,a){let l,c,d=s.range?D.lift(s.range):t;if(typeof s.insertText=="string"){if(l=s.insertText,n&&s.completeBracketPairs){l=oee(l,d.getStartPosition(),i,n);const h=l.length-s.insertText.length;h!==0&&(d=new D(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn+h))}c=void 0}else if(s.insertText===void 0)l="",c=void 0,d=new D(1,1,1,1);else if("snippet"in s.insertText){const h=s.insertText.snippet.length;if(n&&s.completeBracketPairs){s.insertText.snippet=oee(s.insertText.snippet,d.getStartPosition(),i,n);const f=s.insertText.snippet.length-h;f!==0&&(d=new D(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn+f))}const u=new Gb().parse(s.insertText.snippet);u.children.length===1&&u.children[0]instanceof pr?(l=u.children[0].value,c=void 0):(l=u.toString(),c={snippet:s.insertText.snippet,range:d})}else nk(s.insertText);return new GGe(d,l,c,Ze.revive(s.uri),s.hint,s.additionalTextEdits||iGe(),s,e,o,s.isInlineEdit??!1,r,a,s.correlationId)}class GGe{constructor(e,t,i,n,o,r,a,l,c,d,h,u,f){this.range=e,this.insertText=t,this.snippetInfo=i,this.uri=n,this.hint=o,this.additionalTextEdits=r,this.sourceInlineCompletion=a,this.source=l,this.context=c,this.isInlineEdit=d,this._requestInfo=h,this._providerRequestInfo=u,this._correlationId=f,this._didShow=!1,this._timeUntilShown=void 0,this._showStartTime=void 0,this._shownDuration=0,this._showUncollapsedStartTime=void 0,this._showUncollapsedDuration=0,this._notShownReason=void 0,this._didReportEndOfLife=!1,this._lastSetEndOfLifeReason=void 0,this._isPreceeded=!1,this._partiallyAcceptedCount=0,this._partiallyAcceptedSinceOriginal={characters:0,ratio:0,count:0},this._viewData={editorType:h.editorType}}get showInlineEditMenu(){return this.sourceInlineCompletion.showInlineEditMenu??!1}get partialAccepts(){return this._partiallyAcceptedSinceOriginal}async reportInlineEditShown(e,t,i,n){var r,a;if(this.updateShownDuration(i),this._didShow)return;this._didShow=!0,this._viewData.viewKind=i,this._viewData.renderData=n,this._timeUntilShown=Date.now()-this._requestInfo.startTime;const o=new QL(n.lineCountModified,n.lineCountOriginal,n.characterCountModified,n.characterCountOriginal);(a=(r=this.source.provider).handleItemDidShow)==null||a.call(r,this.source.inlineSuggestions,this.sourceInlineCompletion,t,o),this.sourceInlineCompletion.shownCommand&&await e.executeCommand(this.sourceInlineCompletion.shownCommand.id,...this.sourceInlineCompletion.shownCommand.arguments||[])}reportPartialAccept(e,t,i){var n,o;this._partiallyAcceptedCount++,this._partiallyAcceptedSinceOriginal.characters+=i.characters,this._partiallyAcceptedSinceOriginal.ratio=Math.min(this._partiallyAcceptedSinceOriginal.ratio+(1-this._partiallyAcceptedSinceOriginal.ratio)*i.ratio,1),this._partiallyAcceptedSinceOriginal.count+=i.count,(o=(n=this.source.provider).handlePartialAccept)==null||o.call(n,this.source.inlineSuggestions,this.sourceInlineCompletion,e,t)}reportEndOfLife(e){if(!this._didReportEndOfLife&&(this._didReportEndOfLife=!0,this.reportInlineEditHidden(),e||(e=this._lastSetEndOfLifeReason??{kind:Fb.Ignored,userTypingDisagreed:!1,supersededBy:void 0}),e.kind===Fb.Rejected&&this.source.provider.handleRejection&&this.source.provider.handleRejection(this.source.inlineSuggestions,this.sourceInlineCompletion),this.source.provider.handleEndOfLifetime)){const t={requestUuid:this.context.requestUuid,correlationId:this._correlationId,selectedSuggestionInfo:!!this.context.selectedSuggestionInfo,partiallyAccepted:this._partiallyAcceptedCount,partiallyAcceptedCountSinceOriginal:this._partiallyAcceptedSinceOriginal.count,partiallyAcceptedRatioSinceOriginal:this._partiallyAcceptedSinceOriginal.ratio,partiallyAcceptedCharactersSinceOriginal:this._partiallyAcceptedSinceOriginal.characters,shown:this._didShow,shownDuration:this._shownDuration,shownDurationUncollapsed:this._showUncollapsedDuration,preceeded:this._isPreceeded,timeUntilShown:this._timeUntilShown,timeUntilProviderRequest:this._providerRequestInfo.startTime-this._requestInfo.startTime,timeUntilProviderResponse:this._providerRequestInfo.endTime-this._requestInfo.startTime,editorType:this._viewData.editorType,languageId:this._requestInfo.languageId,requestReason:this._requestInfo.reason,viewKind:this._viewData.viewKind,notShownReason:this._notShownReason,typingInterval:this._requestInfo.typingInterval,typingIntervalCharacterCount:this._requestInfo.typingIntervalCharacterCount,availableProviders:this._requestInfo.availableProviders.map(i=>i.toString()).join(","),...this._viewData.renderData};this.source.provider.handleEndOfLifetime(this.source.inlineSuggestions,this.sourceInlineCompletion,e,t)}}setIsPreceeded(e){this._isPreceeded=!0,(this._partiallyAcceptedSinceOriginal.characters!==0||this._partiallyAcceptedSinceOriginal.ratio!==0||this._partiallyAcceptedSinceOriginal.count!==0)&&console.warn("Expected partiallyAcceptedCountSinceOriginal to be { characters: 0, rate: 0, partialAcceptances: 0 } before setIsPreceeded."),this._partiallyAcceptedSinceOriginal=e}setNotShownReason(e){this._notShownReason??(this._notShownReason=e)}setEndOfLifeReason(e){this.reportInlineEditHidden(),this._lastSetEndOfLifeReason=e}updateShownDuration(e){const t=Date.now();this._showStartTime||(this._showStartTime=t);const i=e===hi.Collapsed;!i&&this._showUncollapsedStartTime===void 0&&(this._showUncollapsedStartTime=t),i&&this._showUncollapsedStartTime!==void 0&&(this._showUncollapsedDuration+=t-this._showUncollapsedStartTime)}reportInlineEditHidden(){if(this._showStartTime===void 0)return;const e=Date.now();this._shownDuration+=e-this._showStartTime,this._showStartTime=void 0,this._showUncollapsedStartTime!==void 0&&(this._showUncollapsedDuration+=e-this._showUncollapsedStartTime,this._showUncollapsedStartTime=void 0)}}var Cx;(function(s){s.TextEditor="textEditor",s.DiffEditor="diffEditor",s.Notebook="notebook"})(Cx||(Cx={}));class YGe{constructor(e,t,i){this.inlineSuggestions=e,this.inlineSuggestionsData=t,this.provider=i,this.refCount=0}addRef(){this.refCount++}removeRef(e={kind:"other"}){if(this.refCount--,this.refCount===0){for(const t of this.inlineSuggestionsData)t.reportEndOfLife();this.provider.disposeInlineCompletions(this.inlineSuggestions,e)}}}function XGe(s,e){const t=e.getWordAtPosition(s),i=e.getLineMaxColumn(s.lineNumber);return t?new D(s.lineNumber,t.startColumn,s.lineNumber,i):D.fromPositions(s,s.with(void 0,i))}function oee(s,e,t,i){const n=t.getLineContent(e.lineNumber),o=to.replace(new Ue(e.column-1,n.length),s),r=t.tokenization.tokenizeLinesAt(e.lineNumber,[o.replace(n)]),a=r==null?void 0:r[0].sliceZeroCopy(o.getRangeAfterReplace());return a?$Ge(a,i):s}var ZGe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nS=function(s,e){return function(t,i){e(t,i,s)}},P8,Z_;let O8=(Z_=class extends K{constructor(e,t,i,n,o,r,a,l,c){var h;super(),this._textModel=e,this._versionId=t,this._debounceValue=i,this._cursorPosition=n,this._languageConfigurationService=o,this._logService=r,this._configurationService=a,this._instantiationService=l,this._contextKeyService=c,this._updateOperation=this._register(new mi),this._state=fGe(this,{initial:()=>({inlineCompletions:sc.createEmpty(),suggestWidgetInlineCompletions:sc.createEmpty()}),disposeFinal:u=>{u.inlineCompletions.dispose(),u.suggestWidgetInlineCompletions.dispose()},changeTracker:A3e(()=>({versionId:this._versionId})),update:(u,f,g)=>{const m=bf.compose(g.changes.map(p=>p.change?_Ge(p.change.changes):bf.empty).filter($s));if(m.isEmpty())return f;try{return{inlineCompletions:f.inlineCompletions.createStateWithAppliedEdit(m,this._textModel),suggestWidgetInlineCompletions:f.suggestWidgetInlineCompletions.createStateWithAppliedEdit(m,this._textModel)}}finally{f.inlineCompletions.dispose(),f.suggestWidgetInlineCompletions.dispose()}}}),this.inlineCompletions=this._state.map(this,u=>u.inlineCompletions),this.suggestWidgetInlineCompletions=this._state.map(this,u=>u.suggestWidgetInlineCompletions),this._completionsEnabled=void 0,this.clearOperationOnTextModelChange=ae(this,u=>{this._versionId.read(u),this._updateOperation.clear()}),this._loadingCount=ht(this,0),this._loggingEnabled=mZ("editor.inlineSuggest.logFetch",!1,this._configurationService).recomputeInitiallyAndOnChange(this._store),this._sendRequestData=mZ("editor.inlineSuggest.emptyResponseInformation",!0,this._configurationService).recomputeInitiallyAndOnChange(this._store),this._structuredFetchLogger=this._register(this._instantiationService.createInstance(eM.cast(),"editor.inlineSuggest.logFetch.commandId")),this.clearOperationOnTextModelChange.recomputeInitiallyAndOnChange(this._store);const d=((h=$T.defaultChatAgent)==null?void 0:h.completionsEnablementSetting)??void 0;d&&(this._updateCompletionsEnablement(d),this._register(this._configurationService.onDidChangeConfiguration(u=>{u.affectsConfiguration(d)&&this._updateCompletionsEnablement(d)}))),this._state.recomputeInitiallyAndOnChange(this._store)}_updateCompletionsEnablement(e){const t=this._configurationService.getValue(e);ws(t)?this._completionsEnabled=t:this._completionsEnabled=void 0}_log(e){this._loggingEnabled.get()&&this._logService.info(jKe(e)),this._structuredFetchLogger.log(e)}fetch(e,t,i,n,o,r,a){var m,p;const l=this._cursorPosition.get(),c=new QGe(l,i,this._textModel.getVersionId(),new Set(e)),d=i.selectedSuggestionInfo?this.suggestWidgetInlineCompletions.get():this.inlineCompletions.get();if((m=this._updateOperation.value)!=null&&m.request.satisfies(c))return this._updateOperation.value.promise;if((p=d==null?void 0:d.request)!=null&&p.satisfies(c))return Promise.resolve(!0);const h=!!this._updateOperation.value;this._updateOperation.clear();const u=new hn,f=(async()=>{const v=new oe;this._loadingCount.set(this._loadingCount.get()+1,void 0);let b=!1;const w=()=>{b||(b=!0,this._loadingCount.set(this._loadingCount.get()-1,void 0))};v.add(new Ni(()=>w(),10*1e3)).schedule();const y=e.filter(S=>S.providerId),x=new JGe(i,a,y);try{const S=this._debounceValue.get(this._textModel),L=lae(e.map(V=>V.debounceDelayMs),oTe(aa))??S;if((h||o&&i.triggerKind===Tr.Automatic)&&await WJ(L,u.token),u.token.isCancellationRequested||this._store.isDisposed||this._textModel.getVersionId()!==c.versionId)return x.setNoSuggestionReasonIfNotSet("canceled:beforeFetch"),!1;const M=P8._requestId++;(this._loggingEnabled.get()||this._structuredFetchLogger.isEnabled.get())&&this._log({sourceId:"InlineCompletions.fetch",kind:"start",requestId:M,modelUri:this._textModel.uri,modelVersion:this._textModel.getVersionId(),context:{triggerKind:i.triggerKind,suggestInfo:i.selectedSuggestionInfo?!0:void 0},time:Date.now(),provider:t});const R=new Date,T=jGe(e,this._cursorPosition.get(),this._textModel,i,a,this._languageConfigurationService);tue(u.token,()=>T.cancelAndDispose({kind:"tokenCancellation"}));let A=!1,N=!1;const P=[];for await(const V of T.lists)if(V){V.addRef(),v.add(Ve(()=>V.removeRef(V.inlineSuggestionsData.length===0?{kind:"empty"}:{kind:"notTaken"})));for(const U of V.inlineSuggestionsData){if(N=!0,!i.includeInlineEdits&&(U.isInlineEdit||U.showInlineEditMenu)){U.setNotShownReason("notInlineEditRequested");continue}if(!i.includeInlineCompletions&&!(U.isInlineEdit||U.showInlineEditMenu)){U.setNotShownReason("notInlineCompletionRequested");continue}const $=A8.create(U,this._textModel);P.push($),!$.isInlineEdit&&!$.showInlineEditMenu&&i.triggerKind===Tr.Automatic&&$.isVisible(this._textModel,this._cursorPosition.get())&&(A=!0)}if(A)break}if(T.cancelAndDispose({kind:"lostRace"}),this._loggingEnabled.get()||this._structuredFetchLogger.isEnabled.get()){const V=T.didAllProvidersReturn;let U;(u.token.isCancellationRequested||this._store.isDisposed||this._textModel.getVersionId()!==c.versionId)&&(U="canceled");const $=P.map(Y=>{var se;return{range:Y.editRange.toString(),text:Y.insertText,hint:Y.hint,isInlineEdit:Y.isInlineEdit,showInlineEditMenu:Y.showInlineEditMenu,providerId:(se=Y.source.provider.providerId)==null?void 0:se.toString()}});this._log({sourceId:"InlineCompletions.fetch",kind:"end",requestId:M,durationMs:Date.now()-R.getTime(),error:U,result:$,time:Date.now(),didAllProvidersReturn:V})}if(x.setRequestUuid(T.contextWithUuid.requestUuid),N)x.setHasProducedSuggestion(),P.length>0&&u.token.isCancellationRequested&&P.forEach(V=>V.setNotShownReasonIfNotSet("canceled:whileAwaitingOtherProviders"));else if(u.token.isCancellationRequested)x.setNoSuggestionReasonIfNotSet("canceled:whileFetching");else{const V=this._contextKeyService.getContextKeyValue("completionsQuotaExceeded");x.setNoSuggestionReasonIfNotSet(V?"completionsQuotaExceeded":"noSuggestion")}const W=i.earliestShownDateTime-Date.now();if(W>0&&await WJ(W,u.token),u.token.isCancellationRequested||this._store.isDisposed||this._textModel.getVersionId()!==c.versionId||r.get()){const V=u.token.isCancellationRequested?"canceled:afterMinShowDelay":this._store.isDisposed?"canceled:disposed":this._textModel.getVersionId()!==c.versionId?"canceled:documentChanged":r.get()?"canceled:userJumped":"unknown";return P.forEach(U=>U.setNotShownReasonIfNotSet(V)),!1}const H=new Date;this._debounceValue.update(this._textModel,H.getTime()-R.getTime());const G=this._cursorPosition.get();this._updateOperation.clear(),Ki(V=>{const U=this._state.get();i.selectedSuggestionInfo?this._state.set({inlineCompletions:sc.createEmpty(),suggestWidgetInlineCompletions:U.suggestWidgetInlineCompletions.createStateWithAppliedResults(P,c,this._textModel,G,n)},V):this._state.set({inlineCompletions:U.inlineCompletions.createStateWithAppliedResults(P,c,this._textModel,G,n),suggestWidgetInlineCompletions:sc.createEmpty()},V),U.inlineCompletions.dispose(),U.suggestWidgetInlineCompletions.dispose()})}finally{v.dispose(),w(),this.sendInlineCompletionsRequestTelemetry(x)}return!0})(),g=new iYe(c,u,f);return this._updateOperation.value=g,f}clear(e){this._updateOperation.clear();const t=this._state.get();this._state.set({inlineCompletions:sc.createEmpty(),suggestWidgetInlineCompletions:sc.createEmpty()},e),t.inlineCompletions.dispose(),t.suggestWidgetInlineCompletions.dispose()}seedInlineCompletionsWithSuggestWidget(){const e=this.inlineCompletions.get(),t=this.suggestWidgetInlineCompletions.get();t&&Ki(i=>{var n,o;if(!e||(((n=t.request)==null?void 0:n.versionId)??-1)>(((o=e.request)==null?void 0:o.versionId)??-1)){e==null||e.dispose();const r=this._state.get();this._state.set({inlineCompletions:t.clone(),suggestWidgetInlineCompletions:sc.createEmpty()},i),r.inlineCompletions.dispose(),r.suggestWidgetInlineCompletions.dispose()}this.clearSuggestWidgetInlineCompletions(i)})}sendInlineCompletionsRequestTelemetry(e){if(!this._sendRequestData.get()&&!this._contextKeyService.getContextKeyValue("isRunningUnificationExperiment")||e.requestUuid===void 0||e.hasProducedSuggestion||!tYe(this._completionsEnabled,this._textModel.getLanguageId())||!e.providers.some(n=>{var o;return qJ((o=n.providerId)==null?void 0:o.extensionId)}))return;const t={opportunityId:e.requestUuid,noSuggestionReason:e.noSuggestionReason??"unknown",extensionId:"vscode-core",extensionVersion:"0.0.0",groupId:"empty",shown:!1,editorType:e.requestInfo.editorType,requestReason:e.requestInfo.reason,typingInterval:e.requestInfo.typingInterval,typingIntervalCharacterCount:e.requestInfo.typingIntervalCharacterCount,languageId:e.requestInfo.languageId,selectedSuggestionInfo:!!e.context.selectedSuggestionInfo,availableProviders:e.providers.map(n=>{var o;return(o=n.providerId)==null?void 0:o.toString()}).filter($s).join(","),...pGe(e.providers.some(n=>{var o;return qJ((o=n.providerId)==null?void 0:o.extensionId)})),timeUntilProviderRequest:void 0,timeUntilProviderResponse:void 0,viewKind:void 0,preceeded:void 0,superseded:void 0,reason:void 0,correlationId:void 0,shownDuration:void 0,shownDurationUncollapsed:void 0,timeUntilShown:void 0,partiallyAccepted:void 0,partiallyAcceptedCountSinceOriginal:void 0,partiallyAcceptedRatioSinceOriginal:void 0,partiallyAcceptedCharactersSinceOriginal:void 0,cursorColumnDistance:void 0,cursorLineDistance:void 0,lineCountOriginal:void 0,lineCountModified:void 0,characterCountOriginal:void 0,characterCountModified:void 0,disjointReplacements:void 0,sameShapeReplacements:void 0,notShownReason:void 0},i=this._instantiationService.createInstance(D8);bGe(i,t)}clearSuggestWidgetInlineCompletions(e){var t;(t=this._updateOperation.value)!=null&&t.request.context.selectedSuggestionInfo&&this._updateOperation.clear()}cancelUpdate(){this._updateOperation.clear()}},P8=Z_,Z_._requestId=0,Z_);O8=P8=ZGe([nS(4,wn),nS(5,Ji),nS(6,xt),nS(7,$e),nS(8,ut)],O8);class QGe{constructor(e,t,i,n){this.position=e,this.context=t,this.versionId=i,this.providers=n}satisfies(e){return this.position.equals(e.position)&&Up(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,NU())&&(e.context.triggerKind===Tr.Automatic||this.context.triggerKind===Tr.Explicit)&&this.versionId===e.versionId&&eYe(e.providers,this.providers)}}class JGe{constructor(e,t,i){this.context=e,this.requestInfo=t,this.providers=i,this.hasProducedSuggestion=!1}setRequestUuid(e){this.requestUuid=e}setNoSuggestionReasonIfNotSet(e){this.noSuggestionReason??(this.noSuggestionReason=e)}setHasProducedSuggestion(){this.hasProducedSuggestion=!0}}function eYe(s,e){return[...s].every(t=>e.has(t))}function tYe(s,e="*"){return s===void 0?!1:typeof s[e]<"u"?!!s[e]:!!s["*"]}class iYe{constructor(e,t,i){this.request=e,this.cancellationTokenSource=t,this.promise=i}dispose(){this.cancellationTokenSource.cancel()}}class sc extends K{static createEmpty(){return new sc([],void 0)}constructor(e,t){for(const i of e)i.addRef();super(),this.inlineCompletions=e,this.request=t,this._register({dispose:()=>{for(const i of this.inlineCompletions)i.removeRef()}})}_findById(e){return this.inlineCompletions.find(t=>t.identity===e)}_findByHash(e){return this.inlineCompletions.find(t=>t.hash===e)}createStateWithAppliedEdit(e,t){const i=this.inlineCompletions.map(n=>n.withEdit(e,t)).filter($s);return new sc(i,this.request)}createStateWithAppliedResults(e,t,i,n,o){let r;if(o){const c=this._findById(o);if(c&&c.canBeReused(i,t.position)){r=c;const d=e.find(h=>h.hash===c.hash);d?e=sYe(d,e):e=[c,...e]}}const a=r?!r.isInlineEdit:e.some(c=>!c.isInlineEdit&&c.isVisible(i,n));let l=[];for(const c of e){const d=this._findByHash(c.hash);let h;d&&d!==c?(h=c.withIdentity(d.identity),c.setIsPreceeded(d),d.setEndOfLifeReason({kind:Fb.Ignored,userTypingDisagreed:!1,supersededBy:c.getSourceCompletion()})):h=c,a!==h.isInlineEdit&&l.push(h)}return l.sort(wo(c=>c.showInlineEditMenu,ioe)),l=nYe(l,c=>c.semanticId),new sc(l,t)}clone(){return new sc(this.inlineCompletions,this.request)}}function nYe(s,e){const t=new Set;return s.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function sYe(s,e){const t=e.indexOf(s);return t>-1?[s,...e.slice(0,t),...e.slice(t+1)]:e}class oYe{constructor(e,t,i){this.edit=e,this.commands=t,this.inlineCompletion=i}equals(e){return this.edit.equals(e.edit)&&this.inlineCompletion===e.inlineCompletion}}var rYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ree=function(s,e){return function(t,i){e(t,i,s)}};const F4=Mt("IInlineCompletionsService"),iue=new Ne("inlineCompletions.snoozed",!1,_(79,"Whether inline completions are currently snoozed"));let F8=class extends K{get snoozeTimeLeft(){return this._snoozeTimeEnd===void 0?0:Math.max(0,this._snoozeTimeEnd-Date.now())}constructor(e,t){super(),this._contextKeyService=e,this._telemetryService=t,this._onDidChangeIsSnoozing=this._register(new q),this.onDidChangeIsSnoozing=this._onDidChangeIsSnoozing.event,this._snoozeTimeEnd=void 0,this._recentCompletionIds=[],this._timer=this._register(new ha);const i=iue.bindTo(this._contextKeyService);this._register(this.onDidChangeIsSnoozing(()=>i.set(this.isSnoozing())))}setSnoozeDuration(e){if(e<0)throw new et(`Invalid snooze duration: ${e}. Duration must be non-negative.`);if(e===0){this.cancelSnooze();return}const t=this.isSnoozing(),i=this.snoozeTimeLeft;this._snoozeTimeEnd=Date.now()+e,t||this._onDidChangeIsSnoozing.fire(!0),this._timer.cancelAndSet(()=>{if(!this.isSnoozing())this._onDidChangeIsSnoozing.fire(!1);else throw new et("Snooze timer did not fire as expected")},this.snoozeTimeLeft+1),this._reportSnooze(e-i,e)}isSnoozing(){return this.snoozeTimeLeft>0}cancelSnooze(){this.isSnoozing()&&(this._reportSnooze(-this.snoozeTimeLeft,0),this._snoozeTimeEnd=void 0,this._timer.cancel(),this._onDidChangeIsSnoozing.fire(!1))}reportNewCompletion(e){this._lastCompletionId=e,this._recentCompletionIds.unshift(e),this._recentCompletionIds.length>5&&this._recentCompletionIds.pop()}_reportSnooze(e,t){const i=Math.round(e/1e3),n=Math.round(t/1e3);this._telemetryService.publicLog2("inlineCompletions.snooze",{deltaSeconds:i,totalSeconds:n,lastCompletionId:this._lastCompletionId,recentCompletionIds:this._recentCompletionIds})}};F8=rYe([ree(0,ut),ree(1,Wo)],F8);Vt(F4,F8,1);const aYe="editor.action.inlineSuggest.snooze",lYe="editor.action.inlineSuggest.cancelSnooze",aee="inlineCompletions.lastSnoozeDuration",iP=class iP extends Gs{constructor(){super({id:iP.ID,title:ne(81,"Snooze Inline Suggestions"),precondition:de.true(),f1:!0})}async run(e,...t){const i=e.get(Fo),n=e.get(F4),o=e.get(sr);let r;t.length>0&&typeof t[0]=="number"&&(r=t[0]*6e4),r||(r=await this.getDurationFromUser(i,o)),r&&n.setSnoozeDuration(r)}async getDurationFromUser(e,t){const i=t.getNumber(aee,0,3e5),n=[{label:"1 minute",id:"1",value:6e4},{label:"5 minutes",id:"5",value:3e5},{label:"10 minutes",id:"10",value:6e5},{label:"15 minutes",id:"15",value:9e5},{label:"30 minutes",id:"30",value:18e5},{label:"60 minutes",id:"60",value:36e5}],o=await e.pick(n,{placeHolder:_(80,"Select snooze duration for Inline Suggestions"),activeItem:n.find(r=>r.value===i)});if(o)return t.store(aee,o.value,0,0),o.value}};iP.ID=aYe;let B8=iP;const nP=class nP extends Gs{constructor(){super({id:nP.ID,title:ne(82,"Cancel Snooze Inline Suggestions"),precondition:iue,f1:!0})}async run(e){e.get(F4).cancelSnooze()}};nP.ID=lYe;let W8=nP;const cl=class cl extends K{getTypingInterval(){return(this._cacheInvalidated||this._cachedTypingIntervalResult===null)&&(this._cachedTypingIntervalResult=this._calculateTypingInterval(),this._cacheInvalidated=!1),this._cachedTypingIntervalResult}constructor(e){super(),this._textModel=e,this._typingSessions=[],this._currentSession=null,this._lastChangeTime=0,this._cachedTypingIntervalResult=null,this._cacheInvalidated=!0,this._register(this._textModel.onDidChangeContent(t=>this._updateTypingSpeed(t)))}_updateTypingSpeed(e){const t=Date.now();if(!this._isUserTyping(e)){this._finalizeCurrentSession();return}this._currentSession&&t-this._lastChangeTime>cl.MAX_SESSION_GAP_MS&&this._finalizeCurrentSession(),this._currentSession||(this._currentSession={startTime:t,endTime:t,characterCount:0}),this._currentSession.endTime=t,this._currentSession.characterCount+=this._getActualCharacterCount(e),this._lastChangeTime=t,this._cacheInvalidated=!0}_getActualCharacterCount(e){let t=0;for(const i of e.changes)t+=Math.max(i.text.length,i.rangeLength);return t}_isUserTyping(e){if(!e.detailedReasons||e.detailedReasons.length===0)return!1;for(const t of e.detailedReasons)if(this._isUserTypingReason(t))return!0;return!1}_isUserTypingReason(e){if(e.metadata.isUndoing||e.metadata.isRedoing)return!1;switch(e.metadata.source){case"cursor":{const t=e.metadata.kind;return t==="type"||t==="compositionType"||t==="compositionEnd"}default:return!1}}_finalizeCurrentSession(){if(!this._currentSession)return;this._currentSession.endTime-this._currentSession.startTime>=cl.MIN_SESSION_DURATION_MS&&this._currentSession.characterCount>0&&(this._typingSessions.push(this._currentSession),this._typingSessions.length>cl.SESSION_HISTORY_LIMIT&&this._typingSessions.shift()),this._currentSession=null}_calculateTypingInterval(){if(this._currentSession){const e={...this._currentSession};if(e.endTime-e.startTime>=cl.MIN_SESSION_DURATION_MS&&e.characterCount>0){const i=[...this._typingSessions,e];return this._calculateSpeedFromSessions(i)}}return this._calculateSpeedFromSessions(this._typingSessions)}_calculateSpeedFromSessions(e){if(e.length===0)return{averageInterval:0,characterCount:0};const t=[...e].sort((d,h)=>h.endTime-d.endTime),i=Date.now()-cl.TYPING_SPEED_WINDOW_MS,n=t.filter(d=>d.endTime>i),o=t.splice(n.length);let r=XN(n.map(d=>d.characterCount));for(let d=0;d<o.length&&r<cl.MIN_CHARS_FOR_RELIABLE_SPEED;d++)n.push(o[d]),r+=o[d].characterCount;const a=XN(n.map(d=>d.endTime-d.startTime));if(a===0||r<=1)return{averageInterval:0,characterCount:r};const l=Math.max(1,r-1),c=a/l;return{averageInterval:Math.round(c),characterCount:r}}dispose(){this._finalizeCurrentSession(),super.dispose()}};cl.MAX_SESSION_GAP_MS=3e3,cl.MIN_SESSION_DURATION_MS=1e3,cl.SESSION_HISTORY_LIMIT=50,cl.TYPING_SPEED_WINDOW_MS=3e5,cl.MIN_CHARS_FOR_RELIABLE_SPEED=20;let H8=cl;var cYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Gm=function(s,e){return function(t,i){e(t,i,s)}};let V8=class extends K{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,i,n,o,r,a,l,c,d,h,u,f,g){super(),this.textModel=e,this._selectedSuggestItem=t,this._textModelVersionId=i,this._positions=n,this._debounceValue=o,this._enabled=r,this._editor=a,this._instantiationService=l,this._commandService=c,this._languageConfigurationService=d,this._accessibilityService=h,this._languageFeaturesService=u,this._codeEditorService=f,this._inlineCompletionsService=g,this._isActive=ht(this,!1),this._onlyRequestInlineEditsSignal=xl(this),this._forceUpdateExplicitlySignal=xl(this),this._noDelaySignal=xl(this),this._fetchSpecificProviderSignal=xl(this),this._selectedInlineCompletionId=ht(this,void 0),this.primaryPosition=ae(this,C=>this._positions.read(C)[0]??new z(1,1)),this.allPositions=ae(this,C=>this._positions.read(C)),this._isAcceptingPartially=!1,this._appearedInsideViewport=ae(this,C=>{const y=this.state.read(C);return!y||!y.inlineCompletion?!1:hYe(this._editor,y.inlineCompletion)}),this._onDidAccept=new q,this.onDidAccept=this._onDidAccept.event,this._lastShownInlineCompletionInfo=void 0,this._lastAcceptedInlineCompletionInfo=void 0,this._didUndoInlineEdits=ZG({owner:this,changeTracker:{createChangeSummary:()=>({didUndo:!1}),handleChange:(C,y)=>{var x;return y.didUndo=C.didChange(this._textModelVersionId)&&!!((x=C.change)!=null&&x.isUndoing),!0}}},(C,y)=>{const x=this._textModelVersionId.read(C);return x!==null&&this._lastAcceptedInlineCompletionInfo&&this._lastAcceptedInlineCompletionInfo.textModelVersionIdAfter===x-1&&this._lastAcceptedInlineCompletionInfo.inlineCompletion.isInlineEdit&&y.didUndo?(this._lastAcceptedInlineCompletionInfo=void 0,!0):!1}),this._preserveCurrentCompletionReasons=new Set([du.Redo,du.Undo,du.AcceptWord]),this.dontRefetchSignal=xl(this),this._fetchInlineCompletionsPromise=ZG({owner:this,changeTracker:{createChangeSummary:()=>({dontRefetch:!1,preserveCurrentCompletion:!1,inlineCompletionTriggerKind:Tr.Automatic,onlyRequestInlineEdits:!1,shouldDebounce:!0,provider:void 0,textChange:!1,changeReason:""}),handleChange:(C,y)=>{var x;if(C.didChange(this._textModelVersionId)){this._preserveCurrentCompletionReasons.has(this._getReason(C.change))&&(y.preserveCurrentCompletion=!0);const S=((x=C.change)==null?void 0:x.detailedReasons)??[];y.changeReason=S.length>0?S[0].getType():"",y.textChange=!0}else C.didChange(this._forceUpdateExplicitlySignal)?(y.preserveCurrentCompletion=!0,y.inlineCompletionTriggerKind=Tr.Explicit):C.didChange(this.dontRefetchSignal)?y.dontRefetch=!0:C.didChange(this._onlyRequestInlineEditsSignal)?y.onlyRequestInlineEdits=!0:C.didChange(this._fetchSpecificProviderSignal)&&(y.provider=C.change);return!0}}},(C,y)=>{var G,V,U;if(this._source.clearOperationOnTextModelChange.read(C),this._noDelaySignal.read(C),this.dontRefetchSignal.read(C),this._onlyRequestInlineEditsSignal.read(C),this._forceUpdateExplicitlySignal.read(C),this._fetchSpecificProviderSignal.read(C),!((this._enabled.read(C)&&this._selectedSuggestItem.read(C)||this._isActive.read(C))&&(!this._inlineCompletionsService.isSnoozing()||y.inlineCompletionTriggerKind===Tr.Explicit))){this._source.cancelUpdate();return}this._textModelVersionId.read(C);const S=this._source.suggestWidgetInlineCompletions.read(void 0);let L=this._selectedSuggestItem.read(C);if(this._shouldShowOnSuggestConflict.read(void 0)&&(L=void 0),S&&!L&&this._source.seedInlineCompletionsWithSuggestWidget(),y.dontRefetch)return Promise.resolve(!0);if(this._didUndoInlineEdits.read(C)&&y.inlineCompletionTriggerKind!==Tr.Explicit){Ki($=>{this._source.clear($)});return}let E="";y.provider?E+="providerOnDidChange":y.inlineCompletionTriggerKind===Tr.Explicit&&(E+="explicit"),y.changeReason&&(E+=E.length>0?`:${y.changeReason}`:y.changeReason);const M=this._typing.getTypingInterval(),R={editorType:this.editorType,startTime:Date.now(),languageId:this.textModel.getLanguageId(),reason:E,typingInterval:M.averageInterval,typingIntervalCharacterCount:M.characterCount,availableProviders:[]};let T={triggerKind:y.inlineCompletionTriggerKind,selectedSuggestionInfo:L==null?void 0:L.toSelectedSuggestionInfo(),includeInlineCompletions:!y.onlyRequestInlineEdits,includeInlineEdits:this._inlineEditsEnabled.read(C),requestIssuedDateTime:R.startTime,earliestShownDateTime:R.startTime+(y.inlineCompletionTriggerKind===Tr.Explicit||this.inAcceptFlow.read(void 0)?0:this._minShowDelay.read(void 0))};T.triggerKind===Tr.Automatic&&y.textChange&&this.textModel.getAlternativeVersionId()===((G=this._lastShownInlineCompletionInfo)==null?void 0:G.alternateTextModelVersionId)&&(T={...T,includeInlineCompletions:!this._lastShownInlineCompletionInfo.inlineCompletion.isInlineEdit,includeInlineEdits:this._lastShownInlineCompletionInfo.inlineCompletion.isInlineEdit});const A=this.selectedInlineCompletion.read(void 0)??((V=this._inlineCompletionItems.read(void 0))==null?void 0:V.inlineEdit),N=y.preserveCurrentCompletion||A!=null&&A.forwardStable?A:void 0,P=this._jumpedToId.map($=>{var Y,se;return!!$&&$===((se=(Y=this._inlineCompletionItems.read(void 0))==null?void 0:Y.inlineEdit)==null?void 0:se.semanticId)}),W=y.provider?{providers:[y.provider],label:"single:"+((U=y.provider.providerId)==null?void 0:U.toString())}:{providers:this._languageFeaturesService.inlineCompletionsProvider.all(this.textModel),label:void 0},H=this.getAvailableProviders(W.providers);return R.availableProviders=H.map($=>$.providerId).filter($s),this._source.fetch(H,W.label,T,N==null?void 0:N.identity,y.shouldDebounce,P,R)}),this._inlineCompletionItems=_o({owner:this},C=>{const y=this._source.inlineCompletions.read(C);if(!y)return;const x=this.primaryPosition.read(C);let S;const L=[];for(const E of y.inlineCompletions)E.isInlineEdit?S=E:E.isVisible(this.textModel,x)&&L.push(E);return L.length!==0&&(S=void 0),{inlineCompletions:L,inlineEdit:S}}),this._filteredInlineCompletionItems=_o({owner:this,equalsFn:bL()},C=>{const y=this._inlineCompletionItems.read(C);return(y==null?void 0:y.inlineCompletions)??[]}),this.selectedInlineCompletionIndex=ae(this,C=>{const y=this._selectedInlineCompletionId.read(C),x=this._filteredInlineCompletionItems.read(C),S=this._selectedInlineCompletionId===void 0?-1:x.findIndex(L=>L.semanticId===y);return S===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):S}),this.selectedInlineCompletion=ae(this,C=>{const y=this._filteredInlineCompletionItems.read(C),x=this.selectedInlineCompletionIndex.read(C);return y[x]}),this.activeCommands=_o({owner:this,equalsFn:bL()},C=>{var y;return((y=this.selectedInlineCompletion.read(C))==null?void 0:y.source.inlineSuggestions.commands)??[]}),this.inlineCompletionsCount=ae(this,C=>{if(this.lastTriggerKind.read(C)===Tr.Explicit)return this._filteredInlineCompletionItems.read(C).length}),this._hasVisiblePeekWidgets=ae(this,C=>this._editorObs.openedPeekWidgets.read(C)>0),this._shouldShowOnSuggestConflict=ae(this,C=>{const y=this._showOnSuggestConflict.read(C);if(y!=="never"&&!!this.selectedInlineCompletion.read(C)){const S=this._selectedSuggestItem.read(C);return S?y==="whenSuggestListIsIncomplete"?S.listIncomplete:!0:!1}return!1}),this.state=_o({owner:this,equalsFn:(C,y)=>!C||!y?C===y:C.kind==="ghostText"&&y.kind==="ghostText"?HJ(C.ghostTexts,y.ghostTexts)&&C.inlineCompletion===y.inlineCompletion&&C.suggestItem===y.suggestItem:C.kind==="inlineEdit"&&y.kind==="inlineEdit"?C.inlineEdit.equals(y.inlineEdit):!1},C=>{var E,M,R,T,A,N,P;const y=this.textModel;if(this._suppressInSnippetMode.read(C)&&this._isInSnippetMode.read(C))return;const x=this._inlineCompletionItems.read(C),S=x==null?void 0:x.inlineEdit;if(S){if(this._hasVisiblePeekWidgets.read(C))return;let W=S.getSingleTextEdit();W=Wu(W,y);const H=this.primaryPosition.map(se=>dt.fromRangeInclusive(S.targetRange).addMargin(1,1).contains(se.lineNumber)),G=S.source.inlineSuggestions.commands,V=new oYe(W,G??[],S),U=S.updatedEdit,$=U?ra.fromStringEdit(U,new qb(this.textModel)).replacements:[W],Y=(((M=(E=x.inlineEdit)==null?void 0:E.command)==null?void 0:M.id)==="vscode.open"||((T=(R=x.inlineEdit)==null?void 0:R.command)==null?void 0:T.id)==="_workbench.open")&&((N=(A=x.inlineEdit)==null?void 0:A.command.arguments)!=null&&N.length)?Ze.from((P=x.inlineEdit)==null?void 0:P.command.arguments[0]):void 0;return{kind:"inlineEdit",inlineEdit:V,inlineCompletion:S,edits:$,cursorAtInlineEdit:H,nextEditUri:Y}}const L=this._selectedSuggestItem.read(C);if(!this._shouldShowOnSuggestConflict.read(C)&&L){const W=Wu(L.getSingleTextEdit(),y),H=this._computeAugmentation(W,C);if(!this._suggestPreviewEnabled.read(C)&&!H)return;const V=(H==null?void 0:H.edit)??W,U=H?H.edit.text.length-W.text.length:0,$=this._suggestPreviewMode.read(C),Y=this._positions.read(C),j=[V,...a3(this.textModel,Y,V)].map((J,le)=>({edit:J,ghostText:J?VJ(J,y,$,Y[le],U):void 0})).filter(({edit:J,ghostText:le})=>J!==void 0&&le!==void 0),ie=j.map(({edit:J})=>J),te=j.map(({ghostText:J})=>J),pe=te[0]??new NI(V.range.endLineNumber,[]);return{kind:"ghostText",edits:ie,primaryGhostText:pe,ghostTexts:te,inlineCompletion:H==null?void 0:H.completion,suggestItem:L}}else{if(!this._isActive.read(C))return;const W=this.selectedInlineCompletion.read(C);if(!W)return;const H=W.getSingleTextEdit(),G=this._inlineSuggestMode.read(C),V=this._positions.read(C),$=[H,...a3(this.textModel,V,H)].map((j,ie)=>({edit:j,ghostText:j?VJ(j,y,G,V[ie],0):void 0})).filter(({edit:j,ghostText:ie})=>j!==void 0&&ie!==void 0),Y=$.map(({edit:j})=>j),se=$.map(({ghostText:j})=>j);return se[0]?{kind:"ghostText",edits:Y,primaryGhostText:se[0],ghostTexts:se,inlineCompletion:W,suggestItem:void 0}:void 0}}),this.inlineCompletionState=ae(this,C=>{const y=this.state.read(C);if(!(!y||y.kind!=="ghostText")&&!this._editorObs.inComposition.read(C))return y}),this.inlineEditState=ae(this,C=>{const y=this.state.read(C);if(!(!y||y.kind!=="inlineEdit"))return y}),this.inlineEditAvailable=ae(this,C=>!!this.inlineEditState.read(C)),this.warning=ae(this,C=>{var y,x;return(x=(y=this.inlineCompletionState.read(C))==null?void 0:y.inlineCompletion)==null?void 0:x.warning}),this.ghostTexts=_o({owner:this,equalsFn:HJ},C=>{const y=this.inlineCompletionState.read(C);if(y)return y.ghostTexts}),this.primaryGhostText=_o({owner:this,equalsFn:Khe},C=>{const y=this.inlineCompletionState.read(C);if(y)return y==null?void 0:y.primaryGhostText}),this.showCollapsed=ae(this,C=>{const y=this.state.read(C);if(!y||y.kind!=="inlineEdit"||y.inlineCompletion.hint)return!1;const x=y.inlineCompletion.updatedEditModelVersion===this._textModelVersionId.read(C);return(this._inlineEditsShowCollapsedEnabled.read(C)||!x)&&this._jumpedToId.read(C)!==y.inlineCompletion.semanticId&&!this._inAcceptFlow.read(C)}),this._tabShouldIndent=ae(this,C=>{if(this._inAcceptFlow.read(C))return!1;function y(L){return L.startLineNumber!==L.endLineNumber}function x(L,E){const M=L.getLineIndentColumn(E),R=L.getLineLastNonWhitespaceColumn(E),T=Math.max(R,M);return new D(E,M,E,T)}const S=this._editorObs.selections.read(C);return S==null?void 0:S.some(L=>L.isEmpty()?this.textModel.getLineLength(L.startLineNumber)===0:y(L)||L.containsRange(x(this.textModel,L.startLineNumber)))}),this.tabShouldJumpToInlineEdit=ae(this,C=>{var x;if(this._tabShouldIndent.read(C))return!1;const y=this.inlineEditState.read(C);return y?this.showCollapsed.read(C)?!0:this._inAcceptFlow.read(C)&&this._appearedInsideViewport.read(C)&&!((x=y.inlineCompletion.hint)!=null&&x.jumpToEdit)?!1:!y.cursorAtInlineEdit.read(C):!1}),this.tabShouldAcceptInlineEdit=ae(this,C=>{var x;const y=this.inlineEditState.read(C);return!y||this.showCollapsed.read(C)||this._tabShouldIndent.read(C)?!1:this._inAcceptFlow.read(C)&&this._appearedInsideViewport.read(C)&&!((x=y.inlineCompletion.hint)!=null&&x.jumpToEdit)||y.inlineCompletion.targetRange.startLineNumber===this._editorObs.cursorLineNumber.read(C)||this._jumpedToId.read(C)===y.inlineCompletion.semanticId?!0:y.cursorAtInlineEdit.read(C)}),this._jumpedToId=ht(this,void 0),this._inAcceptFlow=ht(this,!1),this.inAcceptFlow=this._inAcceptFlow,this._source=this._register(this._instantiationService.createInstance(O8,this.textModel,this._textModelVersionId,this._debounceValue,this.primaryPosition)),this.lastTriggerKind=this._source.inlineCompletions.map(this,C=>{var y;return(y=C==null?void 0:C.request)==null?void 0:y.context.triggerKind}),this._editorObs=bn(this._editor);const m=this._editorObs.getOption(134);this._suggestPreviewEnabled=m.map(C=>C.preview),this._suggestPreviewMode=m.map(C=>C.previewMode);const p=this._editorObs.getOption(71);this._inlineSuggestMode=p.map(C=>C.mode),this._suppressedInlineCompletionGroupIds=p.map(C=>new Set(C.experimental.suppressInlineSuggestions.split(","))),this._inlineEditsEnabled=p.map(C=>!!C.edits.enabled),this._inlineEditsShowCollapsedEnabled=p.map(C=>C.edits.showCollapsed),this._triggerCommandOnProviderChange=p.map(C=>C.triggerCommandOnProviderChange),this._minShowDelay=p.map(C=>C.minShowDelay),this._showOnSuggestConflict=p.map(C=>C.experimental.showOnSuggestConflict),this._suppressInSnippetMode=p.map(C=>C.suppressInSnippetMode);const v=tr.get(this._editor);this._isInSnippetMode=(v==null?void 0:v.isInSnippetObservable)??Gi(!1),this._typing=this._register(new H8(this.textModel)),this._register(this._inlineCompletionsService.onDidChangeIsSnoozing(C=>{C&&this.stop()}));{const C=this.textModel.uri.scheme==="vscode-notebook-cell",[y]=this._codeEditorService.listDiffEditors().filter(x=>x.getOriginalEditor().getId()===this._editor.getId()||x.getModifiedEditor().getId()===this._editor.getId());this.isInDiffEditor=!!y,this.editorType=C?Cx.Notebook:this.isInDiffEditor?Cx.DiffEditor:Cx.TextEditor}this._register(bw(this.state,C=>{C&&C.inlineCompletion&&this._inlineCompletionsService.reportNewCompletion(C.inlineCompletion.requestUuid)})),this._register(bw(this._fetchInlineCompletionsPromise)),this._register(lt(C=>{this._editorObs.versionId.read(C),this._inAcceptFlow.set(!1,void 0)})),this._register(lt(C=>{this.state.map((x,S)=>!x||x.kind==="inlineEdit"&&!x.cursorAtInlineEdit.read(S)).read(C)&&this._jumpedToId.set(void 0,void 0)}));const b=this.inlineEditState.map(C=>C==null?void 0:C.inlineCompletion.semanticId);this._register(lt(C=>{b.read(C)&&(this._editor.pushUndoStop(),this._lastShownInlineCompletionInfo={alternateTextModelVersionId:this.textModel.getAlternativeVersionId(),inlineCompletion:this.state.get().inlineCompletion})}));const w=fi(this._languageFeaturesService.inlineCompletionsProvider.onDidChange,()=>this._languageFeaturesService.inlineCompletionsProvider.all(e));AU(this,w,(C,y)=>{C.onDidChangeInlineCompletions&&y.add(C.onDidChangeInlineCompletions(()=>{var L;if(!this._enabled.get()||(this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor())!==this._editor)return;if(this._triggerCommandOnProviderChange.get()){this.trigger(void 0,{onlyFetchInlineEdits:!0});return}const S=this.state.get();S&&(S.inlineCompletion||S.edits)&&((L=S.inlineCompletion)==null?void 0:L.source.provider)!==C||Ki(E=>{this._fetchSpecificProviderSignal.trigger(E,C),this.trigger(E)})}))}).recomputeInitiallyAndOnChange(this._store),this._didUndoInlineEdits.recomputeInitiallyAndOnChange(this._store)}getIndentationInfo(e){let t=!1,i=!0;const n=this==null?void 0:this.primaryGhostText.read(e);if(this!=null&&this._selectedSuggestItem&&n&&n.parts.length>0){const{column:o,lines:r}=n.parts[0],a=r[0].line,l=this.textModel.getLineIndentColumn(n.lineNumber);if(o<=l){let d=Jo(a);d===-1&&(d=a.length-1),t=d>0;const h=this.textModel.getOptions().tabSize;i=Ln.visibleColumnFromColumn(a,d+1,h)<h}}return{startsWithIndentation:t,startsWithIndentationLessThanTabSize:i}}_getReason(e){return e!=null&&e.isUndoing?du.Undo:e!=null&&e.isRedoing?du.Redo:this.isAcceptingPartially?du.AcceptWord:du.Other}getAvailableProviders(e){var r;const t=this._suppressedInlineCompletionGroupIds.get(),i=e.filter(a=>!(a.groupId&&t.has(a.groupId))),n=new Set;for(const a of i)(r=a.excludesGroupIds)==null||r.forEach(l=>n.add(l));const o=[];for(const a of i)a.groupId&&n.has(a.groupId)||o.push(a);return o}async trigger(e,t={}){_w(e,i=>{t.onlyFetchInlineEdits&&this._onlyRequestInlineEditsSignal.trigger(i),t.noDelay&&this._noDelaySignal.trigger(i),this._isActive.set(!0,i),t.explicit&&(this._inAcceptFlow.set(!0,i),this._forceUpdateExplicitlySignal.trigger(i)),t.provider&&this._fetchSpecificProviderSignal.trigger(i,t.provider)}),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(e,t=!1){return this.trigger(e,{onlyFetchInlineEdits:t,explicit:!0})}stop(e="automatic",t){_w(t,i=>{var n;if(e==="explicitCancel"){const o=(n=this.state.get())==null?void 0:n.inlineCompletion;o&&o.reportEndOfLife({kind:Fb.Rejected})}this._isActive.set(!1,i),this._source.clear(i)})}_computeAugmentation(e,t){const i=this.textModel,n=this._source.suggestWidgetInlineCompletions.read(t),o=n?n.inlineCompletions.filter(a=>!a.isInlineEdit):[this.selectedInlineCompletion.read(t)].filter($s);return _4e(o,a=>{let l=a.getSingleTextEdit();return l=Wu(l,i,D.fromPositions(l.range.getStartPosition(),e.range.getEndPosition())),Ghe(l,e)?{completion:a,edit:l}:void 0})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}_getMetadata(e,t,i=void 0){return i?ko.inlineCompletionPartialAccept({nes:e.isInlineEdit,requestUuid:e.requestUuid,providerId:e.source.provider.providerId,languageId:t,type:i}):ko.inlineCompletionAccept({nes:e.isInlineEdit,requestUuid:e.requestUuid,providerId:e.source.provider.providerId,languageId:t})}async accept(e=this._editor){var o;if(e.getModel()!==this.textModel)throw new et;let t,i=!1;const n=this.state.get();if((n==null?void 0:n.kind)==="ghostText"){if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;t=n.inlineCompletion}else if((n==null?void 0:n.kind)==="inlineEdit")t=n.inlineCompletion,i=!!n.nextEditUri;else return;t.addRef();try{if(e.pushUndoStop(),!i)if(t.snippetInfo){const r=os.delete(t.editRange),a=t.additionalTextEdits.map(c=>new os(D.lift(c.range),c.text??"")),l=ra.fromParallelReplacementsUnsorted([r,...a]);e.edit(l,this._getMetadata(t,this.textModel.getLanguageId())),e.setPosition(t.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),(o=tr.get(e))==null||o.insert(t.snippetInfo.snippet,{undoStopBefore:!1})}else{const r=n.edits;let a=r;n.kind==="ghostText"&&(a=sGe(r,this.textModel));const l=BJ(a).map(h=>Oe.fromPositions(h)),c=t.additionalTextEdits.map(h=>new os(D.lift(h.range),h.text??"")),d=ra.fromParallelReplacementsUnsorted([...r,...c]);if(e.edit(d,this._getMetadata(t,this.textModel.getLanguageId())),t.hint===void 0&&e.setSelections(n.kind==="inlineEdit"?l.slice(-1):l,"inlineCompletionAccept"),n.kind==="inlineEdit"&&!this._accessibilityService.isMotionReduced()){const h=d.getNewRanges(),u=this._store.add(new dYe(e,h,()=>{this._store.delete(u)}))}}this._onDidAccept.fire(),this.stop(),t.command&&await this._commandService.executeCommand(t.command.id,...t.command.arguments||[]).then(void 0,as),t.reportEndOfLife({kind:Fb.Accepted})}finally{t.removeRef(),this._inAcceptFlow.set(!0,void 0),this._lastAcceptedInlineCompletionInfo={textModelVersionIdAfter:this.textModel.getVersionId(),inlineCompletion:t}}}async acceptNextWord(){await this._acceptNext(this._editor,"word",(e,t)=>{const i=this.textModel.getLanguageIdAtPosition(e.lineNumber,e.column),n=this._languageConfigurationService.getLanguageConfiguration(i),o=new RegExp(n.wordDefinition.source,n.wordDefinition.flags.replace("g","")),r=t.match(o);let a=0;r&&r.index!==void 0?r.index===0?a=r[0].length:a=r.index:a=t.length;const c=/\s+/g.exec(t);return c&&c.index!==void 0&&c.index+c[0].length<a&&(a=c.index+c[0].length),a},0)}async acceptNextLine(){await this._acceptNext(this._editor,"line",(e,t)=>{const i=t.match(/\n/);return i&&i.index!==void 0?i.index+1:t.length},1)}async _acceptNext(e,t,i,n){if(e.getModel()!==this.textModel)throw new et;const o=this.inlineCompletionState.get();if(!o||o.primaryGhostText.isEmpty()||!o.inlineCompletion)return;const r=o.primaryGhostText,a=o.inlineCompletion;if(a.snippetInfo){await this.accept(e);return}const l=r.parts[0],c=new z(r.lineNumber,l.column),d=l.text,h=i(c,d);if(h===d.length&&r.parts.length===1){this.accept(e);return}const u=d.substring(0,h),f=this._positions.get(),g=f[0];a.addRef();try{this._isAcceptingPartially=!0;try{e.pushUndoStop();const b=D.fromPositions(g,c),w=e.getModel().getValueInRange(b)+u,C=new os(b,w),y=[C,...a3(this.textModel,f,C)].filter($s),x=BJ(y).map(S=>Oe.fromPositions(S));e.edit(ra.fromParallelReplacementsUnsorted(y),this._getMetadata(a,t)),e.setSelections(x,"inlineCompletionPartialAccept"),e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1)}finally{this._isAcceptingPartially=!1}const m=D.fromPositions(a.editRange.getStartPosition(),xs.ofText(u).addToPosition(c)),v=e.getModel().getValueInRange(m,1).length;a.reportPartialAccept(v,{kind:n,acceptedLength:v},{characters:h,ratio:h/d.length,count:1})}finally{a.removeRef()}}handleSuggestAccepted(e){const t=Wu(e.getSingleTextEdit(),this.textModel),i=this._computeAugmentation(t,void 0);if(!i)return;const o=this.textModel.getValueInRange(i.completion.editRange,1).length+t.text.length;i.completion.reportPartialAccept(t.text.length,{kind:2,acceptedLength:o},{characters:t.text.length,count:1,ratio:1})}extractReproSample(){var i;const e=this.textModel.getValue(),t=(i=this.state.get())==null?void 0:i.inlineCompletion;return{documentValue:e,inlineCompletion:t==null?void 0:t.getSourceCompletion()}}jump(){const e=this.inlineEditState.get();e&&Ki(t=>{this._jumpedToId.set(e.inlineCompletion.semanticId,t),this.dontRefetchSignal.trigger(t);const i=e.inlineCompletion.targetRange,n=i.getStartPosition();if(this._editor.setPosition(n,"inlineCompletions.jump"),i.isSingleLine()&&(e.inlineCompletion.hint||!e.inlineCompletion.insertText.includes(`
`)))this._editor.revealPosition(n);else{const r=new D(i.startLineNumber-1,1,i.endLineNumber+1,1);this._editor.revealRange(r,1)}e.inlineCompletion.identity.setJumpTo(t),this._editor.focus()})}async handleInlineSuggestionShown(e,t,i){await e.reportInlineEditShown(this._commandService,t,i)}};V8=cYe([Gm(7,$e),Gm(8,en),Gm(9,wn),Gm(10,so),Gm(11,We),Gm(12,ii),Gm(13,F4)],V8);var du;(function(s){s[s.Undo=0]="Undo",s[s.Redo=1]="Redo",s[s.AcceptWord=2]="AcceptWord",s[s.Other=3]="Other"})(du||(du={}));function a3(s,e,t){if(e.length===1)return[];const i=new qb(s),n=i.getTransformer(),o=n.getOffset(e[0]),r=e.slice(1).map(u=>n.getOffset(u));t=t.removeCommonPrefixAndSuffix(i);const a=n.getStringReplacement(t),l=a.replaceRange.start-o,c=a.replaceRange.join(Ue.emptyAt(o)),d=i.getValueOfOffsetRange(c);return r.map(u=>{const f=u+l,g=f+a.replaceRange.length,m=new Ue(f,g),p=m.join(Ue.emptyAt(u));if(i.getValueOfOffsetRange(p)!==d)return;const b=new to(m,a.newText);return n.getTextReplacement(b)}).filter($s)}class dYe extends K{constructor(e,t,i){super(),i&&this._register({dispose:()=>i()}),this._register(bn(e).setDecorations(Gi(t.map(r=>({range:r,options:{description:"animation",className:"edits-fadeout-decoration",zIndex:1}})))));const n=new aGe(1,0,1e3,cGe),o=new dGe(n);this._register(lt(r=>{const a=o.getValue(r);e.getContainerDomNode().style.setProperty("--animation-opacity",a.toString()),n.isFinished()&&this.dispose()}))}}function hYe(s,e){const t=e.targetRange,i=s.getVisibleRanges();return i.length<1?!1:new D(i[0].startLineNumber,i[0].startColumn,i[i.length-1].endLineNumber,i[i.length-1].endColumn).containsRange(t)}var uYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},lee=function(s,e){return function(t,i){e(t,i,s)}},DS;class yj{constructor(e){this.name=e}select(e,t,i){if(i.length===0)return 0;const n=i[0].score[0];for(let o=0;o<i.length;o++){const{score:r,completion:a}=i[o];if(r[0]!==n)break;if(a.preselect)return o}return 0}}class cee extends yj{constructor(){super("first")}memorize(e,t,i){}toJSON(){}fromJSON(){}}class fYe extends yj{constructor(){super("recentlyUsed"),this._cache=new Cc(300,.66),this._seq=0}memorize(e,t,i){const n=`${e.getLanguageId()}/${i.textLabel}`;this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(e,t,i){if(i.length===0)return 0;const n=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(n))return super.select(e,t,i);const o=i[0].score[0];let r=-1,a=-1,l=-1;for(let c=0;c<i.length&&i[c].score[0]===o;c++){const d=`${e.getLanguageId()}/${i[c].textLabel}`,h=this._cache.peek(d);if(h&&h.touch>l&&h.type===i[c].completion.kind&&h.insertText===i[c].completion.insertText&&(l=h.touch,a=c),i[c].completion.preselect&&r===-1)return r=c}return a!==-1?a:r!==-1?r:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();const t=0;for(const[i,n]of e)n.touch=t,n.type=typeof n.type=="number"?n.type:Tw.fromString(n.type),this._cache.set(i,n);this._seq=this._cache.size}}class gYe extends yj{constructor(){super("recentlyUsedByPrefix"),this._trie=T1.forStrings(),this._seq=0}memorize(e,t,i){const{word:n}=e.getWordUntilPosition(t),o=`${e.getLanguageId()}/${n}`;this._trie.set(o,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(e,t,i){const{word:n}=e.getWordUntilPosition(t);if(!n)return super.select(e,t,i);const o=`${e.getLanguageId()}/${n}`;let r=this._trie.get(o);if(r||(r=this._trie.findSubstr(o)),r)for(let a=0;a<i.length;a++){const{kind:l,insertText:c}=i[a].completion;if(l===r.type&&c===r.insertText)return a}return super.select(e,t,i)}toJSON(){const e=[];return this._trie.forEach((t,i)=>e.push([i,t])),e.sort((t,i)=>-(t[1].touch-i[1].touch)).forEach((t,i)=>t[1].touch=i),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,i]of e)i.type=typeof i.type=="number"?i.type:Tw.fromString(i.type),this._trie.set(t,i)}}}var nm;let z8=(nm=class{constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new oe,this._persistSoon=new Ni(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(i=>{i.reason===Vg.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}select(e,t,i){return this._withStrategy(e,t).select(e,t,i)}_withStrategy(e,t){var n;const i=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(((n=this._strategy)==null?void 0:n.name)!==i){this._saveState();const o=DS._strategyCtors.get(i)||cee;this._strategy=new o;try{const a=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,l=this._storageService.get(`${DS._storagePrefix}/${i}`,a);l&&this._strategy.fromJSON(JSON.parse(l))}catch{}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${DS._storagePrefix}/${this._strategy.name}`,i,t,1)}}},DS=nm,nm._strategyCtors=new Map([["recentlyUsedByPrefix",gYe],["recentlyUsed",fYe],["first",cee]]),nm._storagePrefix="suggest/memories",nm);z8=DS=uYe([lee(0,sr),lee(1,xt)],z8);const B4=Mt("ISuggestMemories");Vt(B4,z8,1);var mYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},pYe=function(s,e){return function(t,i){e(t,i,s)}},U8,Q_;let dM=(Q_=class{constructor(e,t){this._editor=e,this._enabled=!1,this._ckAtEnd=U8.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(i=>i.hasChanged(139)&&this._update()),this._update()}dispose(){var e;this._configListener.dispose(),(e=this._selectionListener)==null||e.dispose(),this._ckAtEnd.reset()}_update(){const e=this._editor.getOption(139)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){const t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const i=this._editor.getModel(),n=this._editor.getSelection(),o=i.getWordAtPosition(n.getStartPosition());if(!o){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(o.endColumn===n.getStartPosition().column&&n.getStartPosition().lineNumber===n.getEndPosition().lineNumber)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}},U8=Q_,Q_.AtEnd=new Ne("atEndOfWord",!1,{type:"boolean",description:_(1494,"A context key that is true when at the end of a word. Note that this is only defined when tab-completions are enabled")}),Q_);dM=U8=mYe([pYe(1,ut)],dM);var _Ye=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},bYe=function(s,e){return function(t,i){e(t,i,s)}},TS,J_;let qw=(J_=class{constructor(e,t){this._editor=e,this._index=0,this._ckOtherSuggestions=TS.OtherSuggestions.bindTo(t)}dispose(){this.reset()}reset(){var e;this._ckOtherSuggestions.reset(),(e=this._listener)==null||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},i){if(e.items.length===0){this.reset();return}if(TS._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=i,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,i){let n=i;for(let o=t.items.length;o>0&&(n=(n+t.items.length+(e?1:-1))%t.items.length,!(n===i||!t.items[n].completion.additionalTextEdits));o--);return n}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=TS._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}},TS=J_,J_.OtherSuggestions=new Ne("hasOtherSuggestions",!1),J_);qw=TS=_Ye([bYe(1,ut)],qw);class vYe{constructor(e,t,i,n){this._disposables=new oe,this._disposables.add(i.onDidSuggest(o=>{o.completionModel.items.length===0&&this.reset()})),this._disposables.add(i.onDidCancel(o=>{this.reset()})),this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(o=>{if(this._active&&!t.isFrozen()&&i.state!==0){const r=o.charCodeAt(o.length-1);this._active.acceptCharacters.has(r)&&e.getOption(0)&&n(this._active.item)}}))}_onItem(e){if(!e||!er(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;const t=new nR;for(const i of e.item.completion.commitCharacters)i.length>0&&t.add(i.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}const dl=class dl{async provideSelectionRanges(e,t){const i=[];for(const n of t){const o=[];i.push(o);const r=new Map;await new Promise(a=>dl._bracketsRightYield(a,0,e,n,r)),await new Promise(a=>dl._bracketsLeftYield(a,0,e,n,r,o))}return i}static _bracketsRightYield(e,t,i,n,o){const r=new Map,a=Date.now();for(;;){if(t>=dl._maxRounds){e();break}if(!n){e();break}const l=i.bracketPairs.findNextBracket(n);if(!l){e();break}if(Date.now()-a>dl._maxDuration){setTimeout(()=>dl._bracketsRightYield(e,t+1,i,n,o));break}if(l.bracketInfo.isOpeningBracket){const d=l.bracketInfo.bracketText,h=r.has(d)?r.get(d):0;r.set(d,h+1)}else{const d=l.bracketInfo.getOpeningBrackets()[0].bracketText;let h=r.has(d)?r.get(d):0;if(h-=1,r.set(d,Math.max(0,h)),h<0){let u=o.get(d);u||(u=new Zo,o.set(d,u)),u.push(l.range)}}n=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,i,n,o,r){const a=new Map,l=Date.now();for(;;){if(t>=dl._maxRounds&&o.size===0){e();break}if(!n){e();break}const c=i.bracketPairs.findPrevBracket(n);if(!c){e();break}if(Date.now()-l>dl._maxDuration){setTimeout(()=>dl._bracketsLeftYield(e,t+1,i,n,o,r));break}if(c.bracketInfo.isOpeningBracket){const h=c.bracketInfo.bracketText;let u=a.has(h)?a.get(h):0;if(u-=1,a.set(h,Math.max(0,u)),u<0){const f=o.get(h);if(f){const g=f.shift();f.size===0&&o.delete(h);const m=D.fromPositions(c.range.getEndPosition(),g.getStartPosition()),p=D.fromPositions(c.range.getStartPosition(),g.getEndPosition());r.push({range:m}),r.push({range:p}),dl._addBracketLeading(i,p,r)}}}else{const h=c.bracketInfo.getOpeningBrackets()[0].bracketText,u=a.has(h)?a.get(h):0;a.set(h,u+1)}n=c.range.getStartPosition()}}static _addBracketLeading(e,t,i){if(t.startLineNumber===t.endLineNumber)return;const n=t.startLineNumber,o=e.getLineFirstNonWhitespaceColumn(n);o!==0&&o!==t.startColumn&&(i.push({range:D.fromPositions(new z(n,o),t.getEndPosition())}),i.push({range:D.fromPositions(new z(n,1),t.getEndPosition())}));const r=n-1;if(r>0){const a=e.getLineFirstNonWhitespaceColumn(r);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(r)&&(i.push({range:D.fromPositions(new z(r,a),t.getEndPosition())}),i.push({range:D.fromPositions(new z(r,1),t.getEndPosition())}))}}};dl._maxDuration=30,dl._maxRounds=2;let hM=dl;const $d=class $d{static async create(e,t){if(!t.getOption(134).localityBonus||!t.hasModel())return $d.None;const i=t.getModel(),n=t.getPosition();if(!e.canComputeWordRanges(i.uri))return $d.None;const[o]=await new hM().provideSelectionRanges(i,[n]);if(o.length===0)return $d.None;const r=await e.computeWordRanges(i.uri,o[0].range);if(!r)return $d.None;const a=i.getWordUntilPosition(n);return delete r[a.word],new class extends $d{distance(l,c){if(!n.equals(t.getPosition()))return 0;if(c.kind===17)return 2<<20;const d=typeof c.label=="string"?c.label:c.label.label,h=r[d];if(eoe(h))return 2<<20;const u=KN(h,D.fromPositions(l),D.compareRangesUsingStarts),f=u>=0?h[u]:h[Math.max(0,~u-1)];let g=o.length;for(const m of o){if(!D.containsRange(m.range,f))break;g-=1}return g}}}};$d.None=new class extends $d{distance(){return 0}};let uM=$d,dee=class{constructor(e,t){this.leadingLineContent=e,this.characterCountDelta=t}};class hg{constructor(e,t,i,n,o,r,a=tI.default,l=void 0){this.clipboardText=l,this._snippetCompareFn=hg._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=n,this._options=o,this._refilterKind=1,this._lineContext=i,this._fuzzyScoreOptions=a,r==="top"?this._snippetCompareFn=hg._compareCompletionItemsSnippetsUp:r==="bottom"&&(this._snippetCompareFn=hg._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const e=new Set;for(const[t,i]of this.getItemsByProvider())i.length>0&&i[0].container.incomplete&&e.add(t);return e}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",o="";const r=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||r.length>2e3?Ub:BBe;for(let c=0;c<r.length;c++){const d=r[c];if(d.isInvalid)continue;const h=this._itemsByProvider.get(d.provider);h?h.push(d):this._itemsByProvider.set(d.provider,[d]);const u=d.position.column-d.editStart.column,f=u+i-(d.position.column-this._column);if(n.length!==f&&(n=f===0?"":t.slice(-f),o=n.toLowerCase()),d.word=n,f===0)d.score=fc.Default;else{let g=0;for(;g<u;){const m=n.charCodeAt(g);if(m===32||m===9)g+=1;else break}if(g>=f)d.score=fc.Default;else if(typeof d.completion.filterText=="string"){const m=l(n,o,g,d.completion.filterText,d.filterTextLow,0,this._fuzzyScoreOptions);if(!m)continue;D9(d.completion.filterText,d.textLabel)===0?d.score=m:(d.score=ABe(n,o,g,d.textLabel,d.labelLow,0),d.score[0]=m[0])}else{const m=l(n,o,g,d.textLabel,d.labelLow,0,this._fuzzyScoreOptions);if(!m)continue;d.score=m}}d.idx=c,d.distance=this._wordDistance.distance(d.position,d.completion),a.push(d),e.push(d.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?O9(e.length-.85,e,(c,d)=>c-d):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===28)return 1;if(t.completion.kind===28)return-1}return hg._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===28)return-1;if(t.completion.kind===28)return 1}return hg._compareCompletionItems(e,t)}}var CYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Vf=function(s,e){return function(t,i){e(t,i,s)}},$8;class Ym{static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),i=e.getPosition();t.tokenization.tokenizeIfCheap(i.lineNumber);const n=t.getWordAtPosition(i);return!(!n||n.endColumn!==i.column&&n.startColumn+1!==i.column||!isNaN(Number(n.word)))}constructor(e,t,i){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.triggerOptions=i}}function wYe(s,e,t){if(!e.getContextKeyValue(Fi.inlineSuggestionVisible.key))return!0;const i=e.getContextKeyValue(Fi.suppressSuggestions.key);return i!==void 0?!i:!s.getOption(71).suppressSuggestions}function yYe(s,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;const i=e.getContextKeyValue(Fi.suppressSuggestions.key);return i!==void 0?!i:!s.getOption(71).suppressSuggestions}let fM=$8=class{constructor(e,t,i,n,o,r,a,l,c){this._editor=e,this._editorWorkerService=t,this._clipboardService=i,this._telemetryService=n,this._logService=o,this._contextKeyService=r,this._configurationService=a,this._languageFeaturesService=l,this._envService=c,this._toDispose=new oe,this._triggerCharacterListener=new oe,this._triggerQuickSuggest=new ha,this._triggerState=void 0,this._completionDisposables=new oe,this._onDidCancel=new q,this._onDidTrigger=new q,this._onDidSuggest=new q,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._currentSelection=this._editor.getSelection()||new Oe(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let d=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{d=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{d=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(h=>{d||this._onCursorChange(h)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!d&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}dispose(){yi(this._triggerCharacterListener),yi([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(104)||!this._editor.hasModel()||!this._editor.getOption(137))return;const e=new Map;for(const i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const n of i.triggerCharacters||[]){let o=e.get(n);o||(o=new Set,e.set(n,o)),o.add(i)}const t=i=>{var r;if(!yYe(this._editor,this._contextKeyService,this._configurationService)||Ym.shouldAutoTrigger(this._editor))return;if(!i){const a=this._editor.getPosition();i=this._editor.getModel().getLineContent(a.lineNumber).substr(0,a.column-1)}let n="";hm(i.charCodeAt(i.length-1))?vs(i.charCodeAt(i.length-2))&&(n=i.substr(i.length-2)):n=i.charAt(i.length-1);const o=e.get(n);if(o){const a=new Map;if(this._completionModel)for(const[l,c]of this._completionModel.getItemsByProvider())o.has(l)||a.set(l,c);this.trigger({auto:!0,triggerKind:1,triggerCharacter:n,retrigger:!!this._completionModel,clipboardText:(r=this._completionModel)==null?void 0:r.clipboardText,completionOptions:{providerFilter:o,providerItemsToReuse:a}})}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>t()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(e=!1){var t;this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),(t=this._requestToken)==null||t.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){var e;BC.isAllOff(this._editor.getOption(102))||this._editor.getOption(134).snippetsPreventQuickSuggestions&&((e=tr.get(this._editor))!=null&&e.isInSnippet())||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!Ym.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=this._editor.getOption(102);if(!BC.isAllOff(n)){if(!BC.isAllOn(n)){t.tokenization.tokenizeIfCheap(i.lineNumber);const o=t.tokenization.getLineTokens(i.lineNumber),r=o.getStandardTokenType(o.findTokenIndexAtOffset(Math.max(i.column-1-1,0)));if(BC.valueFor(n,r)!=="on")return}wYe(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(t)&&this.trigger({auto:!0})}},this._editor.getOption(103)))}_refilterCompletionItems(){ti(this._editor.hasModel()),ti(this._triggerState!==void 0);const e=this._editor.getModel(),t=this._editor.getPosition(),i=new Ym(e,t,{...this._triggerState,refilter:!0});this._onNewContext(i)}trigger(e){var u,f,g;if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=new Ym(t,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:e.shy??!1,position:this._editor.getPosition()}),this._context=i;let n={triggerKind:e.triggerKind??0};e.triggerCharacter&&(n={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new hn;const o=this._editor.getOption(128);let r=1;switch(o){case"top":r=0;break;case"bottom":r=2;break}const{itemKind:a,showDeprecated:l}=$8.createSuggestFilter(this._editor),c=new kI(r,((u=e.completionOptions)==null?void 0:u.kindFilter)??a,(f=e.completionOptions)==null?void 0:f.providerFilter,(g=e.completionOptions)==null?void 0:g.providerItemsToReuse,l),d=uM.create(this._editorWorkerService,this._editor),h=bj(this._languageFeaturesService.completionProvider,t,this._editor.getPosition(),c,n,this._requestToken.token);Promise.all([h,d]).then(async([m,p])=>{var y;if((y=this._requestToken)==null||y.dispose(),!this._editor.hasModel()){m.disposable.dispose();return}let v=e==null?void 0:e.clipboardText;if(!v&&m.needsClipboard&&(v=await this._clipboardService.readText()),this._triggerState===void 0){m.disposable.dispose();return}const b=this._editor.getModel(),w=new Ym(b,this._editor.getPosition(),e),C={...tI.default,firstMatchCanBeWeak:!this._editor.getOption(134).matchOnWordStartOnly};if(this._completionModel=new hg(m.items,this._context.column,{leadingLineContent:w.leadingLineContent,characterCountDelta:w.column-this._context.column},p,this._editor.getOption(134),this._editor.getOption(128),C,v),this._completionDisposables.add(m.disposable),this._onNewContext(w),this._reportDurationsTelemetry(m.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(const x of m.items)x.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${x.provider._debugDisplayName}`,x.completion)}).catch(_t)}_reportDurationsTelemetry(e){Math.random()>1e-4||setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static createSuggestFilter(e){const t=new Set;e.getOption(128)==="none"&&t.add(28);const n=e.getOption(134);return n.showMethods||t.add(0),n.showFunctions||t.add(1),n.showConstructors||t.add(2),n.showFields||t.add(3),n.showVariables||t.add(4),n.showClasses||t.add(5),n.showStructs||t.add(6),n.showInterfaces||t.add(7),n.showModules||t.add(8),n.showProperties||t.add(9),n.showEvents||t.add(10),n.showOperators||t.add(11),n.showUnits||t.add(12),n.showValues||t.add(13),n.showConstants||t.add(14),n.showEnums||t.add(15),n.showEnumMembers||t.add(16),n.showKeywords||t.add(17),n.showWords||t.add(18),n.showColors||t.add(19),n.showFiles||t.add(20),n.showReferences||t.add(21),n.showColors||t.add(22),n.showFolders||t.add(23),n.showTypeParameters||t.add(24),n.showSnippets||t.add(28),n.showUsers||t.add(25),n.showIssues||t.add(26),{itemKind:t,showDeprecated:n.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(Ui(e.leadingLineContent)!==Ui(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(Ym.shouldAutoTrigger(this._editor)&&this._context){const i=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:i}})}return}if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&e.leadingWord.word.length!==0){const t=new Map,i=new Set;for(const[n,o]of this._completionModel.getItemsByProvider())o.length>0&&o[0].container.incomplete?i.add(n):t.set(n,o);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:i,providerItemsToReuse:t}})}else{const t=this._completionModel.lineContext;let i=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){const n=Ym.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(n&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=t,i=this._completionModel.items.length>0,i&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:i})}}}}};fM=$8=CYe([Vf(1,jr),Vf(2,pa),Vf(3,Wo),Vf(4,Ji),Vf(5,ut),Vf(6,xt),Vf(7,We),Vf(8,Nq)],fM);const sP=class sP{constructor(e,t){this._disposables=new oe,this._lastOvertyped=[],this._locked=!1,this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;const i=e.getSelections(),n=i.length;let o=!1;for(let a=0;a<n;a++)if(!i[a].isEmpty()){o=!0;break}if(!o){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const r=e.getModel();for(let a=0;a<n;a++){const l=i[a];if(r.getValueLengthInRange(l)>sP._maxSelectionLength)return;this._lastOvertyped[a]={value:r.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(t.onDidTrigger(i=>{this._locked=!0})),this._disposables.add(t.onDidCancel(i=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}};sP._maxSelectionLength=51200;let q8=sP;var SYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},l3=function(s,e){return function(t,i){e(t,i,s)}};let j8=class{constructor(e,t,i,n,o){this._menuId=t,this._menuService=n,this._contextKeyService=o,this._menuDisposables=new oe,this.element=me(e,we(".suggest-status-bar"));const r=(a=>a instanceof Ya?i.createInstance(bq,a,{useComma:!1}):void 0);this._leftActions=new Fr(this.element,{actionViewItemProvider:r}),this._rightActions=new Fr(this.element,{actionViewItemProvider:r}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(this._menuId,this._contextKeyService),t=()=>{const i=[],n=[];for(const[o,r]of e.getActions())o==="left"?i.push(...r):n.push(...r);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};j8=SYe([l3(2,$e),l3(3,Vl),l3(4,ut)],j8);var xYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hee=function(s,e){return function(t,i){e(t,i,s)}};function Sj(s){return!!s&&!!(s.completion.documentation||s.completion.detail&&s.completion.detail!==s.completion.label)}let K8=class{constructor(e,t,i){this._editor=e,this._themeService=t,this._markdownRendererService=i,this._onDidClose=new q,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new q,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new oe,this._renderDisposeable=new oe,this._size=new wi(330,0),this.domNode=we(".suggest-details"),this.domNode.classList.add("no-docs"),this._body=we(".body"),this._scrollbar=new vk(this._body,{alwaysConsumeMouseWheel:!0}),me(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=me(this._body,we(".header")),this._close=me(this._header,we("span"+it.asCSSSelector(ge.close))),this._close.title=_(1490,"Close"),this._close.role="button",this._close.tabIndex=-1,this._type=me(this._header,we("p.type")),this._docs=me(this._body,we("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(59)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(59),i=t.getMassagedFontFamily(),n=e.get(135)||t.fontSize,o=e.get(136)||t.lineHeight,r=t.fontWeight,a=`${n}px`,l=`${o}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${o/n}`,this.domNode.style.fontWeight=r,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){const e=this._editor.getOption(136)||this._editor.getOption(59).lineHeight,t=od(this._themeService.getColorTheme().type)?2:1,i=t*2;return{lineHeight:e,borderWidth:t,borderHeight:i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=_(1491,"Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){var o;this._renderDisposeable.clear();let{detail:i,documentation:n}=e.completion;if(t){let r="";r+=`score: ${e.score[0]}
`,r+=`prefix: ${e.word??"(no prefix)"}
`,r+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,r+=`distance: ${e.distance} (localityBonus-setting)
`,r+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,r+=`commit_chars: ${(o=e.completion.commitCharacters)==null?void 0:o.join("")}
`,n=new To().appendCodeblock("empty",r),i=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!Sj(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),i){const r=i.length>1e5?`${i.substr(0,1e5)}…`:i;this._type.textContent=r,this._type.title=r,ta(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(r))}else io(this._type),this._type.title="",hr(this._type),this.domNode.classList.add("no-type");if(io(this._docs),typeof n=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=n;else if(n){this._docs.classList.add("markdown-docs"),io(this._docs);const r=this._markdownRendererService.render(n,{context:this._editor,asyncRenderCallback:()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}});this._docs.appendChild(r.element),this._renderDisposeable.add(r)}this.domNode.classList.toggle("detail-and-doc",!!i&&!!n),this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=r=>{r.preventDefault(),r.stopPropagation()},this._close.onclick=r=>{r.preventDefault(),r.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(e,t){const i=new wi(e,t);wi.equals(i,this._size)||(this._size=i,ATe(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}focus(){this.domNode.focus()}};K8=xYe([hee(1,Dn),hee(2,Sc)],K8);class LYe{constructor(e,t){this.widget=e,this._editor=t,this.allowEditorOverflow=!0,this._disposables=new oe,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new Aq,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let i,n,o=0,r=0;this._disposables.add(this._resizable.onDidWillResize(()=>{i=this._topLeft,n=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(i&&n){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(r=n.width-a.dimension.width,l=!0),a.north&&(o=n.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:i.top+o,left:i.left+r})}a.done&&(i=void 0,n=void 0,o=0,r=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){const i=e.getBoundingClientRect();this._anchorBox=i,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,t)}_placeAtAnchor(e,t,i){const n=um(this.getDomNode().ownerDocument.body),o=this.widget.getLayoutInfo(),r=new wi(220,2*o.lineHeight),a=e.top,l=(function(){const y=n.width-(e.left+e.width+o.borderWidth+o.horizontalPadding),x=-o.borderWidth+e.left+e.width,S=new wi(y,n.height-e.top-o.borderHeight-o.verticalPadding),L=S.with(void 0,e.top+e.height-o.borderHeight-o.verticalPadding);return{top:a,left:x,fit:y-t.width,maxSizeTop:S,maxSizeBottom:L,minSize:r.with(Math.min(y,r.width))}})(),c=(function(){const y=e.left-o.borderWidth-o.horizontalPadding,x=Math.max(o.horizontalPadding,e.left-t.width-o.borderWidth),S=new wi(y,n.height-e.top-o.borderHeight-o.verticalPadding),L=S.with(void 0,e.top+e.height-o.borderHeight-o.verticalPadding);return{top:a,left:x,fit:y-t.width,maxSizeTop:S,maxSizeBottom:L,minSize:r.with(Math.min(y,r.width))}})(),d=(function(){const y=e.left,x=-o.borderWidth+e.top+e.height,S=new wi(e.width-o.borderHeight,n.height-e.top-e.height-o.verticalPadding);return{top:x,left:y,fit:S.height-t.height,maxSizeBottom:S,maxSizeTop:S,minSize:r.with(S.width)}})(),h=[l,c,d],u=h.find(y=>y.fit>=0)??h.sort((y,x)=>x.fit-y.fit)[0],f=e.top+e.height-o.borderHeight;let g,m=t.height;const p=Math.max(u.maxSizeTop.height,u.maxSizeBottom.height);m>p&&(m=p);let v;i?m<=u.maxSizeTop.height?(g=!0,v=u.maxSizeTop):(g=!1,v=u.maxSizeBottom):m<=u.maxSizeBottom.height?(g=!1,v=u.maxSizeBottom):(g=!0,v=u.maxSizeTop);let{top:b,left:w}=u;!g&&m>e.height&&(b=f-m);const C=this._editor.getDomNode();if(C){const y=C.getBoundingClientRect();b-=y.top,w-=y.left}this._applyTopLeft({left:w,top:b}),this._resizable.enableSashes(!g,u===l,g,u!==l),this._resizable.minSize=u.minSize,this._resizable.maxSize=v,this._resizable.layout(m,Math.min(v.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this._editor.layoutOverlayWidget(this)}}const uee=Mt("fileService");var fh;(function(s){s[s.FILE=0]="FILE",s[s.FOLDER=1]="FOLDER",s[s.ROOT_FOLDER=2]="ROOT_FOLDER"})(fh||(fh={}));const IYe=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function iT(s,e,t,i,n){if(it.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(Ze.isUri(n))return[];const o=i===fh.ROOT_FOLDER?["rootfolder-icon"]:i===fh.FOLDER?["folder-icon"]:["file-icon"];if(t){let r;if(t.scheme===ct.data)r=mm.parseMetaData(t).get(mm.META_DATA_LABEL);else{const a=t.path.match(IYe);a?(r=nT(a[2].toLowerCase()),a[1]&&o.push(`${nT(a[1].toLowerCase())}-name-dir-icon`)):r=nT(t.authority.toLowerCase())}if(i===fh.ROOT_FOLDER)o.push(`${r}-root-name-folder-icon`);else if(i===fh.FOLDER)o.push(`${r}-name-folder-icon`);else{if(r){if(o.push(`${r}-name-file-icon`),o.push("name-file-icon"),r.length<=255){const l=r.split(".");for(let c=1;c<l.length;c++)o.push(`${l.slice(c).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}const a=EYe(s,e,t);a&&o.push(`${nT(a)}-lang-file-icon`)}}return o}function EYe(s,e,t){if(!t)return null;let i=null;if(t.scheme===ct.data){const o=mm.parseMetaData(t).get(mm.META_DATA_MIME);o&&(i=e.getLanguageIdByMimeType(o))}else{const n=s.getModel(t);n&&(i=n.getLanguageId())}return i&&i!==Za?i:e.guessLanguageIdByFilepathOrFirstLine(t)}function nT(s){return s.replace(/[\s]/g,"/")}var kYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},c3=function(s,e){return function(t,i){e(t,i,s)}};const DYe=rn("suggest-more-info",ge.chevronRight,_(1492,"Icon for more information in the suggest widget."));var Kc;const TYe=new(Kc=class{extract(e,t){if(e.textLabel.match(Kc._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(Kc._regexStrict))return t[0]=e.completion.detail,!0;if(e.completion.documentation){const i=typeof e.completion.documentation=="string"?e.completion.documentation:e.completion.documentation.value,n=Kc._regexRelaxed.exec(i);if(n&&(n.index===0||n.index+n[0].length===i.length))return t[0]=n[0],!0}return!1}},Kc._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,Kc._regexStrict=new RegExp(`^${Kc._regexRelaxed.source}$`,"i"),Kc);let G8=class{constructor(e,t,i,n){this._editor=e,this._modelService=t,this._languageService=i,this._themeService=n,this._onDidToggleDetails=new q,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=new oe,i=e;i.classList.add("show-file-icons");const n=me(e,we(".icon")),o=me(n,we("span.colorspan")),r=me(e,we(".contents")),a=me(r,we(".main")),l=me(a,we(".icon-label.codicon")),c=me(a,we("span.left")),d=me(a,we("span.right")),h=new SI(c,{supportHighlights:!0,supportIcons:!0});t.add(h);const u=me(c,we("span.signature-label")),f=me(c,we("span.qualifier-label")),g=me(d,we("span.details-label")),m=me(d,we("span.readMore"+it.asCSSSelector(DYe)));return m.title=_(1493,"Read More"),{root:i,left:c,right:d,icon:n,colorspan:o,iconLabel:h,iconContainer:l,parametersLabel:u,qualifierLabel:f,detailsLabel:g,readMore:m,disposables:t,configureFont:()=>{const v=this._editor.getOptions(),b=v.get(59),w=b.getMassagedFontFamily(),C=b.fontFeatureSettings,y=b.fontVariationSettings,x=v.get(135)||b.fontSize,S=v.get(136)||b.lineHeight,L=b.fontWeight,E=b.letterSpacing,M=`${x}px`,R=`${S}px`,T=`${E}px`;i.style.fontSize=M,i.style.fontWeight=L,i.style.letterSpacing=T,a.style.fontFamily=w,a.style.fontFeatureSettings=C,a.style.fontVariationSettings=y,a.style.lineHeight=R,n.style.height=R,n.style.width=R,m.style.height=R,m.style.width=R}}}renderElement(e,t,i){i.configureFont();const{completion:n}=e;i.colorspan.style.backgroundColor="";const o={labelEscapeNewLines:!0,matches:Sk(e.score)},r=[];if(n.kind===19&&TYe.extract(e,r))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=r[0];else if(n.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";const a=iT(this._modelService,this._languageService,Ze.from({scheme:"fake",path:e.textLabel}),fh.FILE),l=iT(this._modelService,this._languageService,Ze.from({scheme:"fake",path:n.detail}),fh.FILE);o.extraClasses=a.length>l.length?a:l}else n.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",o.extraClasses=[iT(this._modelService,this._languageService,Ze.from({scheme:"fake",path:e.textLabel}),fh.FOLDER),iT(this._modelService,this._languageService,Ze.from({scheme:"fake",path:n.detail}),fh.FOLDER)].flat()):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...it.asClassNameArray(Tw.toIcon(n.kind))));n.tags&&n.tags.indexOf(1)>=0&&(o.extraClasses=(o.extraClasses||[]).concat(["deprecated"]),o.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,o),typeof n.label=="string"?(i.parametersLabel.textContent="",i.detailsLabel.textContent=d3(n.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=d3(n.label.detail||""),i.detailsLabel.textContent=d3(n.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(134).showInlineDetails?ta(i.detailsLabel):hr(i.detailsLabel),Sj(e)?(i.right.classList.add("can-expand-details"),ta(i.readMore),i.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},i.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),hr(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};G8=kYe([c3(1,Cn),c3(2,Wn),c3(3,Dn)],G8);function d3(s){return s.replace(/\r\n|\r|\n/g,"")}var NYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},sT=function(s,e){return function(t,i){e(t,i,s)}},CC;F("editorSuggestWidget.background",ja,_(1473,"Background color of the suggest widget."));F("editorSuggestWidget.border",s$,_(1474,"Border color of the suggest widget."));const RYe=F("editorSuggestWidget.foreground",Ph,_(1475,"Foreground color of the suggest widget."));F("editorSuggestWidget.selectedForeground",PL,_(1476,"Foreground color of the selected entry in the suggest widget."));F("editorSuggestWidget.selectedIconForeground",m$,_(1477,"Icon foreground color of the selected entry in the suggest widget."));const MYe=F("editorSuggestWidget.selectedBackground",OL,_(1478,"Background color of the selected entry in the suggest widget."));F("editorSuggestWidget.highlightForeground",kC,_(1479,"Color of the match highlights in the suggest widget."));F("editorSuggestWidget.focusHighlightForeground",qAe,_(1480,"Color of the match highlights in the suggest widget when an item is focused."));F("editorSuggestWidgetStatus.foreground",Ct(RYe,.5),_(1481,"Foreground color of the suggest widget status."));class AYe{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof Sf}`}restore(){const e=this._service.get(this._key,0)??"";try{const t=JSON.parse(e);if(wi.is(t))return wi.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}var sm;let Y8=(sm=class{constructor(e,t,i,n,o){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._pendingLayout=new mi,this._pendingShowDetails=new mi,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new ha,this._disposables=new oe,this._onDidSelect=new Nb,this._onDidFocus=new Nb,this._onDidHide=new q,this._onDidShow=new q,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new q,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new Aq,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new PYe(this,e),this._persistedSize=new AYe(t,e);class r{constructor(f,g,m=!1,p=!1){this.persistedSize=f,this.currentSize=g,this.persistHeight=m,this.persistWidth=p}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new r(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(u=>{var f,g;if(this._resize(u.dimension.width,u.dimension.height),a&&(a.persistHeight=a.persistHeight||!!u.north||!!u.south,a.persistWidth=a.persistWidth||!!u.east||!!u.west),!!u.done){if(a){const{itemHeight:m,defaultSize:p}=this.getLayoutInfo(),v=Math.round(m/2);let{width:b,height:w}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-w)<=v)&&(w=((f=a.persistedSize)==null?void 0:f.height)??p.height),(!a.persistWidth||Math.abs(a.currentSize.width-b)<=v)&&(b=((g=a.persistedSize)==null?void 0:g.width)??p.width),this._persistedSize.store(new wi(b,w))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=me(this.element.domNode,we(".message")),this._listElement=me(this.element.domNode,we(".tree"));const l=this._disposables.add(o.createInstance(K8,this.editor));l.onDidClose(()=>this.toggleDetails(),this,this._disposables),this._details=new LYe(l,this.editor);const c=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(134).showIcons);c();const d=o.createInstance(G8,this.editor);this._disposables.add(d),this._disposables.add(d.onDidToggleDetails(()=>this.toggleDetails())),this._list=new nl("SuggestWidget",this._listElement,{getHeight:u=>this.getLayoutInfo().itemHeight,getTemplateId:u=>"suggestion"},[d],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>no?"listitem":"option",getWidgetAriaLabel:()=>_(1484,"Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:u=>{let f=u.textLabel;const g=Tw.toLabel(u.completion.kind);if(typeof u.completion.label!="string"){const{detail:b,description:w}=u.completion.label;b&&w?f=_(1485,"{0} {1}, {2}, {3}",f,b,w,g):b?f=_(1486,"{0} {1}, {2}",f,b,g):w&&(f=_(1487,"{0}, {1}, {2}",f,w,g))}else f=_(1488,"{0}, {1}",f,g);if(!u.isResolved||!this._isDetailsVisible())return f;const{documentation:m,detail:p}=u.completion,v=Rb("{0}{1}",p||"",m?typeof m=="string"?m:m.value:"");return _(1489,"{0}, docs: {1}",f,v)}}}),this._list.style(Lv({listInactiveFocusBackground:MYe,listInactiveFocusOutline:fn})),this._status=o.createInstance(j8,this.element.domNode,$g);const h=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(134).showStatusBar);h(),this._disposables.add(this._list.onMouseDown(u=>this._onListMouseDownOrTap(u))),this._disposables.add(this._list.onTap(u=>this._onListMouseDownOrTap(u))),this._disposables.add(this._list.onDidChangeSelection(u=>this._onListSelection(u))),this._disposables.add(this._list.onDidChangeFocus(u=>this._onListFocus(u))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(u=>{u.hasChanged(134)&&(h(),c()),this._completionModel&&(u.hasChanged(59)||u.hasChanged(135)||u.hasChanged(136))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=Pt.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=Pt.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=Pt.MultipleSuggestions.bindTo(i),this._ctxSuggestWidgetHasFocusedSuggestion=Pt.HasFocusedSuggestion.bindTo(i),this._disposables.add(Jn(this._details.widget.domNode,"keydown",u=>{this._onDetailsKeydown.fire(u)})),this._disposables.add(this.editor.onMouseDown(u=>this._onEditorMouseDown(u)))}dispose(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),(e=this._loadingTimeout)==null||e.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}_onListFocus(e){var n;if(this._ignoreFocusEvents)return;if(this._state===5&&this._setState(3),!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const t=e.elements[0],i=e.indexes[0];t!==this._focusedItem&&((n=this._currentSuggestionDetails)==null||n.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=t,this._list.reveal(i),this._currentSuggestionDetails=ys(async o=>{const r=cf(()=>{this._isDetailsVisible()&&this._showDetails(!0,!1)},250),a=o.onCancellationRequested(()=>r.dispose());try{return await t.resolve(o)}finally{r.dispose(),a.dispose()}}),this._currentSuggestionDetails.then(()=>{i>=this._list.length||t!==this._list.element(i)||(this._ignoreFocusEvents=!0,this._list.splice(i,1,[t]),this._list.setFocus([i]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this._showDetails(!1,!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:this._list.getElementID(i)}))}).catch(_t)),this._onDidFocus.fire({item:t,index:i,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:hr(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=CC.LOADING_MESSAGE,hr(this._listElement,this._status.element),ta(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,ld(CC.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=CC.NO_SUGGESTIONS_MESSAGE,hr(this._listElement,this._status.element),ta(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,ld(CC.NO_SUGGESTIONS_MESSAGE);break;case 3:hr(this._messageElement),ta(this._listElement,this._status.element),this._show();break;case 4:hr(this._messageElement),ta(this._listElement,this._status.element),this._show();break;case 5:hr(this._messageElement),ta(this._listElement,this._status.element),this._details.show(),this._show(),this._details.widget.focus();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=cf(()=>this._setState(1),t)))}showSuggestions(e,t,i,n,o){var l,c;if(this._contentWidget.setPosition(this.editor.getPosition()),(l=this._loadingTimeout)==null||l.dispose(),(c=this._currentSuggestionDetails)==null||c.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&this._state!==2&&this._state!==0){this._setState(4);return}const r=this._completionModel.items.length,a=r===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(r>1),a){this._setState(n?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0,t===0?0:this.getLayoutInfo().itemHeight*.33),this._list.setFocus(o?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=ZN(je(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._list.setFocus(this._list.getFocus()),this._setState(3)):this._state===3&&(this._setState(5),this._isDetailsVisible()?this._details.widget.focus():this.toggleDetails(!0))}toggleDetails(e=!1){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(Sj(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this._showDetails(!1,e))}_showDetails(e,t){this._pendingShowDetails.value=ZN(je(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show();let i=!1;e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details"),t&&(this._details.widget.focus(),i=!0)),i||this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this._showDetails(!1,!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var i;this._pendingLayout.clear(),this._pendingShowDetails.clear(),(i=this._loadingTimeout)==null||i.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const e=this._persistedSize.restore(),t=Math.ceil(this.getLayoutInfo().itemHeight*4.3);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(e){var r,a;if(!this.editor.hasModel()||!this.editor.getDomNode())return;const t=um(this.element.domNode.ownerDocument.body),i=this.getLayoutInfo();e||(e=i.defaultSize);let n=e.height,o=e.width;if(this._status.element.style.height=`${i.itemHeight}px`,this._state===2||this._state===1)n=i.itemHeight+i.borderHeight,o=i.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new wi(o,n),this._contentWidget.setPreference(2);else{const l=t.width-i.borderHeight-2*i.horizontalPadding;o>l&&(o=l);const c=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:o,d=i.statusBarHeight+this._list.contentHeight+i.borderHeight,h=i.itemHeight+i.statusBarHeight,u=Fn(this.editor.getDomNode()),f=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),g=u.top+f.top+f.height,m=Math.min(t.height-g-i.verticalPadding,d),p=u.top+f.top-i.verticalPadding,v=Math.min(p,d);let b=Math.min(Math.max(v,m)+i.borderHeight,d);n===((r=this._cappedHeight)==null?void 0:r.capped)&&(n=this._cappedHeight.wanted),n<h&&(n=h),n>b&&(n=b),n>m&&v>m||this._forceRenderingAbove&&p>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),b=v):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),b=m),this.element.preferredSize=new wi(c,i.defaultSize.height),this.element.maxSize=new wi(l,b),this.element.minSize=new wi(220,h),this._cappedHeight=n===d?{wanted:((a=this._cappedHeight)==null?void 0:a.wanted)??e.height,capped:n}:void 0}this._resize(o,n)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),t=Math.min(n,t);const{statusBarHeight:o}=this.getLayoutInfo();this._list.layout(t-o,e),this._listElement.style.height=`${t-o}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){var e;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,((e=this._contentWidget.getPosition())==null?void 0:e.preference[0])===2)}getLayoutInfo(){const e=this.editor.getOption(59),t=dr(this.editor.getOption(136)||e.lineHeight,8,1e3),i=!this.editor.getOption(134).showStatusBar||this._state===2||this._state===1?0:t,n=this._details.widget.getLayoutInfo().borderWidth,o=2*n;return{itemHeight:t,statusBarHeight:i,borderWidth:n,borderHeight:o,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new wi(430,i+12*t)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}},CC=sm,sm.LOADING_MESSAGE=_(1482,"Loading..."),sm.NO_SUGGESTIONS_MESSAGE=_(1483,"No suggestions."),sm);Y8=CC=NYe([sT(1,sr),sT(2,ut),sT(3,Dn),sT(4,$e)],Y8);class PYe{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:i,horizontalPadding:n}=this._widget.getLayoutInfo();return new wi(t+2*i+n,e+2*i)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}var OYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},oC=function(s,e){return function(t,i){e(t,i,s)}},X8;class FYe{constructor(e,t){if(this._model=e,this._position=t,this._decorationOptions=vt.register({description:"suggest-line-suffix",stickiness:1}),e.getLineMaxColumn(t.lineNumber)!==t.column){const n=e.getOffsetAt(t),o=e.getPositionAt(n+1);e.changeDecorations(r=>{this._marker&&r.removeDecoration(this._marker),this._marker=r.addDecoration(D.fromPositions(t,o),this._decorationOptions)})}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(e=>{e.removeDecoration(this._marker),this._marker=void 0})}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}}var eb;let td=(eb=class{static get(e){return e.getContribution(X8.ID)}get onWillInsertSuggestItem(){return this._onWillInsertSuggestItem.event}constructor(e,t,i,n,o,r,a){this._memoryService=t,this._commandService=i,this._contextKeyService=n,this._instantiationService=o,this._logService=r,this._telemetryService=a,this._lineSuffix=new mi,this._toDispose=new oe,this._selectors=new BYe(h=>h.priority),this._onWillInsertSuggestItem=new q,this._wantsForceRenderingAbove=!1,this.editor=e,this.model=o.createInstance(fM,this.editor),this._selectors.register({priority:0,select:(h,u,f)=>this._memoryService.select(h,u,f)});const l=Pt.InsertMode.bindTo(n);l.set(e.getOption(134).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(e.getOption(134).insertMode))),this.widget=this._toDispose.add(new N5(je(e.getDomNode()),()=>{const h=this._instantiationService.createInstance(Y8,this.editor);this._toDispose.add(h),this._toDispose.add(h.onDidSelect(p=>this._insertSuggestion(p,0),this));const u=new vYe(this.editor,h,this.model,p=>this._insertSuggestion(p,2));this._toDispose.add(u);const f=Pt.MakesTextEdit.bindTo(this._contextKeyService),g=Pt.HasInsertAndReplaceRange.bindTo(this._contextKeyService),m=Pt.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(Ve(()=>{f.reset(),g.reset(),m.reset()})),this._toDispose.add(h.onDidFocus(({item:p})=>{const v=this.editor.getPosition(),b=p.editStart.column,w=v.column;let C=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!p.completion.additionalTextEdits&&!(p.completion.insertTextRules&4)&&w-b===p.completion.insertText.length&&(C=this.editor.getModel().getValueInRange({startLineNumber:v.lineNumber,startColumn:b,endLineNumber:v.lineNumber,endColumn:w})!==p.completion.insertText),f.set(C),g.set(!z.equals(p.editInsertEnd,p.editReplaceEnd)),m.set(!!p.provider.resolveCompletionItem||!!p.completion.documentation||p.completion.detail!==p.completion.label)})),this._toDispose.add(h.onDetailsKeyDown(p=>{if(p.toKeyCodeChord().equals(new lf(!0,!1,!1,!1,33))||Bt&&p.toKeyCodeChord().equals(new lf(!1,!1,!1,!0,33))){p.stopPropagation();return}p.toKeyCodeChord().isModifierKey()||this.editor.focus()})),this._wantsForceRenderingAbove&&h.forceRenderingAbove(),h})),this._overtypingCapturer=this._toDispose.add(new N5(je(e.getDomNode()),()=>this._toDispose.add(new q8(this.editor,this.model)))),this._alternatives=this._toDispose.add(new N5(je(e.getDomNode()),()=>this._toDispose.add(new qw(this.editor,this._contextKeyService)))),this._toDispose.add(o.createInstance(dM,e)),this._toDispose.add(this.model.onDidTrigger(h=>{this.widget.value.showTriggered(h.auto,h.shy?250:50),this._lineSuffix.value=new FYe(this.editor.getModel(),h.position)})),this._toDispose.add(this.model.onDidSuggest(h=>{if(h.triggerOptions.shy)return;let u=-1;for(const g of this._selectors.itemsOrderedByPriorityDesc)if(u=g.select(this.editor.getModel(),this.editor.getPosition(),h.completionModel.items),u!==-1)break;if(u===-1&&(u=0),this.model.state===0)return;let f=!1;if(h.triggerOptions.auto){const g=this.editor.getOption(134);g.selectionMode==="never"||g.selectionMode==="always"?f=g.selectionMode==="never":g.selectionMode==="whenTriggerCharacter"?f=h.triggerOptions.triggerKind!==1:g.selectionMode==="whenQuickSuggestion"&&(f=h.triggerOptions.triggerKind===1&&!h.triggerOptions.refilter)}this.widget.value.showSuggestions(h.completionModel,u,h.isFrozen,h.triggerOptions.auto,f)})),this._toDispose.add(this.model.onDidCancel(h=>{h.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));const c=Pt.AcceptSuggestionsOnEnter.bindTo(n),d=()=>{const h=this.editor.getOption(1);c.set(h==="on"||h==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>d())),d()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(e,t){var g;if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const i=tr.get(this.editor);if(!i)return;this._onWillInsertSuggestItem.fire({item:e.item});const n=this.editor.getModel(),o=n.getAlternativeVersionId(),{item:r}=e,a=[],l=new hn;t&1||this.editor.pushUndoStop();const c=this.getOverwriteInfo(r,!!(t&8));this._memoryService.memorize(n,this.editor.getPosition(),r);const d=r.isResolved;let h=-1,u=-1;if(Array.isArray(r.completion.additionalTextEdits)){this.model.cancel();const m=ud.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",r.completion.additionalTextEdits.map(p=>{let v=D.lift(p.range);if(v.startLineNumber===r.position.lineNumber&&v.startColumn>r.position.column){const b=this.editor.getPosition().column-r.position.column,w=b,C=D.spansMultipleLines(v)?0:b;v=new D(v.startLineNumber,v.startColumn+w,v.endLineNumber,v.endColumn+C)}return Pn.replaceMove(v,p.text)})),m.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!d){const m=new Fs;let p;const v=n.onDidChangeContent(y=>{if(y.isFlush){l.cancel(),v.dispose();return}for(const x of y.changes){const S=D.getEndPosition(x.range);(!p||z.isBefore(S,p))&&(p=S)}}),b=t;t|=2;let w=!1;const C=this.editor.onWillType(()=>{C.dispose(),w=!0,b&2||this.editor.pushUndoStop()});a.push(r.resolve(l.token).then(()=>{if(!r.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(p&&r.completion.additionalTextEdits.some(x=>z.isBefore(p,D.getStartPosition(x.range))))return!1;w&&this.editor.pushUndoStop();const y=ud.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",r.completion.additionalTextEdits.map(x=>Pn.replaceMove(D.lift(x.range),x.text))),y.restoreRelativeVerticalPositionOfCursor(this.editor),(w||!(b&2))&&this.editor.pushUndoStop(),!0}).then(y=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",m.elapsed(),y),u=y===!0?1:y===!1?0:-2}).finally(()=>{v.dispose(),C.dispose()}))}let{insertText:f}=r.completion;if(r.completion.insertTextRules&4||(f=Gb.escape(f)),this.model.cancel(),i.insert(f,{overwriteBefore:c.overwriteBefore,overwriteAfter:c.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(r.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value,reason:ko.suggest({providerId:n4.fromExtensionId((g=r.extensionId)==null?void 0:g.value)})}),t&2||this.editor.pushUndoStop(),r.completion.command)if(r.completion.command.id===gM.id)this.model.trigger({auto:!0,retrigger:!0});else{const m=new Fs;a.push(this._commandService.executeCommand(r.completion.command.id,...r.completion.command.arguments?[...r.completion.command.arguments]:[]).catch(p=>{r.completion.extensionId?as(p):_t(p)}).finally(()=>{h=m.elapsed()}))}t&4&&this._alternatives.value.set(e,m=>{for(l.cancel();n.canUndo();){o!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(m,3|(t&8?8:0));break}}),this._alertCompletionItem(r),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(r,n,d,h,u,e.index,e.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(e,t,i,n,o,r,a){var u;if(Math.random()>1e-4)return;const l=new Map;for(let f=0;f<Math.min(30,a.length);f++){const g=a[f].textLabel;l.has(g)?l.get(g).push(f):l.set(g,[f])}const c=l.get(e.textLabel),h=c&&c.length>1?c[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:((u=e.extensionId)==null?void 0:u.value)??"unknown",providerId:e.provider._debugDisplayName??"unknown",kind:e.completion.kind,basenameHash:dk(Fl(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:kNe(t.uri),resolveInfo:e.provider.resolveCompletionItem?i?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:n,additionalEditsAsync:o,index:r,firstIndex:h})}getOverwriteInfo(e,t){ti(this.editor.hasModel());let i=this.editor.getOption(134).insertMode==="replace";t&&(i=!i);const n=e.position.column-e.editStart.column,o=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,r=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:n+r,overwriteAfter:o+a}}_alertCompletionItem(e){if(er(e.completion.additionalTextEdits)){const t=_(1463,"Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);br(t)}}triggerSuggest(e,t,i){this.editor.hasModel()&&(this.model.trigger({auto:t??!1,completionOptions:{providerFilter:e,kindFilter:i?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),i=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},n=o=>{if(o.completion.insertTextRules&4||o.completion.additionalTextEdits)return!0;const r=this.editor.getPosition(),a=o.editStart.column,l=r.column;return l-a!==o.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:r.lineNumber,startColumn:a,endLineNumber:r.lineNumber,endColumn:l})!==o.completion.insertText};Se.once(this.model.onDidTrigger)(o=>{const r=[];Se.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{yi(r),i()},void 0,r),this.model.onDidSuggest(({completionModel:a})=>{if(yi(r),a.items.length===0){i();return}const l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),c=a.items[l];if(!n(c)){i();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:c,model:a},7)},void 0,r)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const i=this.widget.value.getFocusedItem();let n=0;e&&(n|=4),t&&(n|=8),this._insertSuggestion(i,n)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.isInitialized?this.widget.value.forceRenderingAbove():this._wantsForceRenderingAbove=!0}stopForceRenderingAbove(){this.widget.isInitialized?this.widget.value.stopForceRenderingAbove():this._wantsForceRenderingAbove=!1}registerSelector(e){return this._selectors.register(e)}},X8=eb,eb.ID="editor.contrib.suggestController",eb);td=X8=OYe([oC(1,B4),oC(2,en),oC(3,ut),oC(4,$e),oC(5,Ji),oC(6,Wo)],td);class BYe{constructor(e){this.prioritySelector=e,this._items=new Array}register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,i)=>this.prioritySelector(i)-this.prioritySelector(t)),{dispose:()=>{const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}const oP=class oP extends Fe{constructor(){super({id:oP.id,label:ne(1471,"Trigger Suggest"),precondition:de.and(B.writable,B.hasCompletionItemProvider,Pt.Visible.toNegated()),kbOpts:{kbExpr:B.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,i){const n=td.get(t);if(!n)return;let o;i&&typeof i=="object"&&i.auto===!0&&(o=!0),n.triggerSuggest(void 0,o,void 0)}};oP.id="editor.action.triggerSuggest";let gM=oP;Qt(td.ID,td,2);xe(gM);const tl=190,xr=Is.bindToContribution(td.get);Te(new xr({id:"acceptSelectedSuggestion",precondition:de.and(Pt.Visible,Pt.HasFocusedSuggestion),handler(s){s.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:de.and(Pt.Visible,B.textInputFocus),weight:tl},{primary:3,kbExpr:de.and(Pt.Visible,B.textInputFocus,Pt.AcceptSuggestionsOnEnter,Pt.MakesTextEdit),weight:tl}],menuOpts:[{menuId:$g,title:_(1464,"Insert"),group:"left",order:1,when:Pt.HasInsertAndReplaceRange.toNegated()},{menuId:$g,title:_(1465,"Insert"),group:"left",order:1,when:de.and(Pt.HasInsertAndReplaceRange,Pt.InsertMode.isEqualTo("insert"))},{menuId:$g,title:_(1466,"Replace"),group:"left",order:1,when:de.and(Pt.HasInsertAndReplaceRange,Pt.InsertMode.isEqualTo("replace"))}]}));Te(new xr({id:"acceptAlternativeSelectedSuggestion",precondition:de.and(Pt.Visible,B.textInputFocus,Pt.HasFocusedSuggestion),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:1027,secondary:[1026]},handler(s){s.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:$g,group:"left",order:2,when:de.and(Pt.HasInsertAndReplaceRange,Pt.InsertMode.isEqualTo("insert")),title:_(1467,"Replace")},{menuId:$g,group:"left",order:2,when:de.and(Pt.HasInsertAndReplaceRange,Pt.InsertMode.isEqualTo("replace")),title:_(1468,"Insert")}]}));Zt.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");Te(new xr({id:"hideSuggestWidget",precondition:Pt.Visible,handler:s=>s.cancelSuggestWidget(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:9,secondary:[1033]}}));Te(new xr({id:"selectNextSuggestion",precondition:de.and(Pt.Visible,de.or(Pt.MultipleSuggestions,Pt.HasFocusedSuggestion.negate())),handler:s=>s.selectNextSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));Te(new xr({id:"selectNextPageSuggestion",precondition:de.and(Pt.Visible,de.or(Pt.MultipleSuggestions,Pt.HasFocusedSuggestion.negate())),handler:s=>s.selectNextPageSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:12,secondary:[2060]}}));Te(new xr({id:"selectLastSuggestion",precondition:de.and(Pt.Visible,de.or(Pt.MultipleSuggestions,Pt.HasFocusedSuggestion.negate())),handler:s=>s.selectLastSuggestion()}));Te(new xr({id:"selectPrevSuggestion",precondition:de.and(Pt.Visible,de.or(Pt.MultipleSuggestions,Pt.HasFocusedSuggestion.negate())),handler:s=>s.selectPrevSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));Te(new xr({id:"selectPrevPageSuggestion",precondition:de.and(Pt.Visible,de.or(Pt.MultipleSuggestions,Pt.HasFocusedSuggestion.negate())),handler:s=>s.selectPrevPageSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:11,secondary:[2059]}}));Te(new xr({id:"selectFirstSuggestion",precondition:de.and(Pt.Visible,de.or(Pt.MultipleSuggestions,Pt.HasFocusedSuggestion.negate())),handler:s=>s.selectFirstSuggestion()}));Te(new xr({id:"focusSuggestion",precondition:de.and(Pt.Visible,Pt.HasFocusedSuggestion.negate()),handler:s=>s.focusSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));Te(new xr({id:"focusAndAcceptSuggestion",precondition:de.and(Pt.Visible,Pt.HasFocusedSuggestion.negate()),handler:s=>{s.focusSuggestion(),s.acceptSelectedSuggestion(!0,!1)}}));Te(new xr({id:"toggleSuggestionDetails",precondition:de.and(Pt.Visible,Pt.HasFocusedSuggestion),handler:s=>s.toggleSuggestionDetails(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:$g,group:"right",order:1,when:de.and(Pt.DetailsVisible,Pt.CanResolve),title:_(1469,"Show Less")},{menuId:$g,group:"right",order:1,when:de.and(Pt.DetailsVisible.toNegated(),Pt.CanResolve),title:_(1470,"Show More")}]}));Te(new xr({id:"toggleExplainMode",precondition:Pt.Visible,handler:s=>s.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));Te(new xr({id:"toggleSuggestionFocus",precondition:Pt.Visible,handler:s=>s.toggleSuggestionFocus(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:2570,mac:{primary:778}}}));Te(new xr({id:"insertBestCompletion",precondition:de.and(B.textInputFocus,de.equals("config.editor.tabCompletion","on"),dM.AtEnd,Pt.Visible.toNegated(),qw.OtherSuggestions.toNegated(),tr.InSnippetMode.toNegated()),handler:(s,e)=>{s.triggerSuggestAndAcceptBest(ws(e)?{fallback:"tab",...e}:{fallback:"tab"})},kbOpts:{weight:tl,primary:2}}));Te(new xr({id:"insertNextSuggestion",precondition:de.and(B.textInputFocus,de.equals("config.editor.tabCompletion","on"),qw.OtherSuggestions,Pt.Visible.toNegated(),tr.InSnippetMode.toNegated()),handler:s=>s.acceptNextSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:2}}));Te(new xr({id:"insertPrevSuggestion",precondition:de.and(B.textInputFocus,de.equals("config.editor.tabCompletion","on"),qw.OtherSuggestions,Pt.Visible.toNegated(),tr.InSnippetMode.toNegated()),handler:s=>s.acceptPrevSuggestion(),kbOpts:{weight:tl,kbExpr:B.textInputFocus,primary:1026}}));xe(class extends Fe{constructor(){super({id:"editor.action.resetSuggestSize",label:ne(1472,"Reset Suggest Widget Size"),precondition:void 0})}run(s,e){var t;(t=td.get(e))==null||t.resetWidgetSize()}});class WYe extends K{get selectedItem(){return this._currentSuggestItemInfo}constructor(e,t,i){super(),this.editor=e,this.suggestControllerPreselector=t,this.onWillAccept=i,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._onDidSelectedItemChange=this._register(new q),this.onDidSelectedItemChange=this._onDidSelectedItemChange.event,this._register(e.onKeyDown(o=>{o.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(e.onKeyUp(o=>{o.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));const n=td.get(this.editor);if(n){this._register(n.registerSelector({priority:100,select:(a,l,c)=>{const d=this.editor.getModel();if(!d)return-1;const h=this.suggestControllerPreselector(),u=h?Wu(h,d):void 0;if(!u)return-1;const f=z.lift(l),g=c.map((p,v)=>{const b=wx.fromSuggestion(n,d,f,p,this.isShiftKeyPressed),w=Wu(b.getSingleTextEdit(),d),C=Ghe(u,w);return{index:v,valid:C,prefixLength:w.text.length,suggestItem:p}}).filter(p=>p&&p.valid&&p.prefixLength>0),m=C$(g,wo(p=>p.prefixLength,aa));return m?m.index:-1}}));let o=!1;const r=()=>{o||(o=!0,this._register(n.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(n.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.update(!1)})),this._register(n.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(Se.once(n.model.onDidTrigger)(a=>{r()})),this._register(n.onWillInsertSuggestItem(a=>{const l=this.editor.getPosition(),c=this.editor.getModel();if(!l||!c)return;const d=wx.fromSuggestion(n,c,l,a.item,this.isShiftKeyPressed);this.onWillAccept(d)}))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();(this._isActive!==e||!HYe(this._currentSuggestItemInfo,t))&&(this._isActive=e,this._currentSuggestItemInfo=t,this._onDidSelectedItemChange.fire())}getSuggestItemInfo(){const e=td.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),i=this.editor.getPosition(),n=this.editor.getModel();if(!(!t||!i||!n))return wx.fromSuggestion(e,n,i,t.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){const e=td.get(this.editor);e==null||e.stopForceRenderingAbove()}forceRenderingAbove(){const e=td.get(this.editor);e==null||e.forceRenderingAbove()}}class wx{static fromSuggestion(e,t,i,n,o){let{insertText:r}=n.completion,a=!1;if(n.completion.insertTextRules&4){const c=new Gb().parse(r);c.children.length<100&&sM.adjustWhitespace(t,i,!0,c),r=c.toString(),a=!0}const l=e.getOverwriteInfo(n,o);return new wx(D.fromPositions(i.delta(0,-l.overwriteBefore),i.delta(0,Math.max(l.overwriteAfter,0))),r,n.completion.kind,a,n.container.incomplete??!1)}constructor(e,t,i,n,o){this.range=e,this.insertText=t,this.completionItemKind=i,this.isSnippetText=n,this.listIncomplete=o}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new uae(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}getSingleTextEdit(){return new os(this.range,this.insertText)}}function HYe(s,e){return s===e?!0:!s||!e?!1:s.equals(e)}class VYe extends K{constructor(e,t,i){super(),this._editorObs=e,this._handleSuggestAccepted=t,this._suggestControllerPreselector=i,this._suggestWidgetAdaptor=this._register(new WYe(this._editorObs.editor,()=>(this._editorObs.forceUpdate(),this._suggestControllerPreselector()),n=>this._editorObs.forceUpdate(o=>{this._handleSuggestAccepted(n)}))),this.selectedItem=fi(this,n=>this._suggestWidgetAdaptor.onDidSelectedItemChange(()=>{this._editorObs.forceUpdate(o=>n(void 0))}),()=>this._suggestWidgetAdaptor.selectedItem)}stopForceRenderingAbove(){this._suggestWidgetAdaptor.stopForceRenderingAbove()}forceRenderingAbove(){this._suggestWidgetAdaptor.forceRenderingAbove()}}class zYe{constructor(e,t){this.lineNumber=e,this.columnRange=t}}class fee{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new et(`startColumn ${e} cannot be after endColumnExclusive ${t}`)}toRange(e){return new D(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}toZeroBasedOffsetRange(){return new Ue(this.startColumn-1,this.endColumnExclusive-1)}}class i_{static fromLineTokens(e){const t=[];for(let i=0;i<e.getCount();i++)t.push(new gee(e.getTokenText(i),e.getMetadata(i)));return i_.create(t)}static create(e){return new i_(e)}constructor(e){this._tokenInfo=e}toLineTokens(e){return qn.createFromTextAndMetadata(this.map((t,i)=>({text:i.text,metadata:i.metadata})),e)}map(e){const t=[];let i=0;for(const n of this._tokenInfo){const o=new Ue(i,i+n.text.length);t.push(e(o,n)),i+=n.text.length}return t}slice(e){const t=[];let i=0;for(const n of this._tokenInfo){const o=i,r=o+n.text.length;if(r>e.start){if(o>=e.endExclusive)break;const a=Math.max(0,e.start-o),l=Math.max(0,r-e.endExclusive);t.push(new gee(n.text.slice(a,n.text.length-l),n.metadata))}i+=n.text.length}return i_.create(t)}append(e){const t=this._tokenInfo.concat(e._tokenInfo);return i_.create(t)}}class gee{constructor(e,t){this.text=e,this.metadata=t}}var UYe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$Ye=function(s,e){return function(t,i){e(t,i,s)}};const nue="ghost-text";var tb;let MI=(tb=class extends K{constructor(e,t,i,n,o,r){super(),this._editor=e,this._model=t,this._options=i,this._shouldKeepCursorStable=n,this._isClickable=o,this._languageService=r,this._isDisposed=ht(this,!1),this._editorObs=bn(this._editor),this._warningState=ae(a=>{const l=this._model.ghostText.read(a);if(!l)return;const c=this._model.warning.read(a);if(c)return{lineNumber:l.lineNumber,position:new z(l.lineNumber,l.parts[0].column),icon:c.icon}}),this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._useSyntaxHighlighting=this._options.map(a=>a.syntaxHighlightingEnabled),this._extraClassNames=ae(this,a=>{const l=[...this._options.read(a).extraClasses??[]];return this._useSyntaxHighlighting.read(a)&&l.push("syntax-highlighted"),this._warningState.read(a)&&l.push("warning"),l.map(d=>` ${d}`).join("")}),this.uiState=ae(this,a=>{var R,T;if(this._isDisposed.read(a))return;const l=this._editorObs.model.read(a);if(l!==this._model.targetTextModel.read(a))return;const c=this._model.ghostText.read(a);if(!c)return;const d=c instanceof k8?c.columnRange:void 0,h=this._useSyntaxHighlighting.read(a),u=this._extraClassNames.read(a),{inlineTexts:f,additionalLines:g,hiddenRange:m,additionalLinesOriginalSuffix:p}=qYe(c,l,nue+u),v=l.getLineContent(c.lineNumber),b=new bf(f.map(A=>to.insert(A.column-1,A.text))),w=h?l.tokenization.tokenizeLinesAt(c.lineNumber,[b.apply(v),...g.map(A=>A.content)]):void 0,C=b.getNewRanges(),y=f.map((A,N)=>{var P;return{...A,tokens:(P=w==null?void 0:w[0])==null?void 0:P.getTokensInRange(C[N])}}),x=g.map((A,N)=>{let P=(w==null?void 0:w[N+1])??qn.createEmpty(A.content,this._languageService.languageIdCodec);if(N===g.length-1&&p){const H=i_.fromLineTokens(l.tokenization.getLineTokens(p.lineNumber)).slice(p.columnRange.toZeroBasedOffsetRange());P=i_.fromLineTokens(P).append(H).toLineTokens(P.languageIdCodec)}return{content:P,decorations:A.decorations}}),S=(R=this._editor.getSelection())==null?void 0:R.getStartPosition().column,L=y.filter(A=>A.text!==""),E=L.length!==0,M={cursorColumnDistance:(E?L[0].column:1)-S,cursorLineDistance:E?0:g.findIndex(A=>A.content!=="")+1,lineCountOriginal:E?1:0,lineCountModified:g.length+(E?1:0),characterCountOriginal:0,characterCountModified:XN(L.map(A=>A.text.length))+XN(x.map(A=>A.content.getTextLength())),disjointReplacements:L.length+(g.length>0?1:0),sameShapeReplacements:L.length>1&&x.length===0?L.every(A=>A.text===L[0].text):void 0};return(T=this._model.handleInlineCompletionShown.read(a))==null||T(M),{replacedRange:d,inlineTexts:y,additionalLines:x,hiddenRange:m,lineNumber:c.lineNumber,additionalReservedLineCount:this._model.minReservedLineCount.read(a),targetTextModel:l,syntaxHighlightingEnabled:h}}),this.decorations=ae(this,a=>{const l=this.uiState.read(a);if(!l)return[];const c=[],d=this._extraClassNames.read(a);l.replacedRange&&c.push({range:l.replacedRange.toRange(l.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace"+d,description:"GhostTextReplacement"}}),l.hiddenRange&&c.push({range:l.hiddenRange.toRange(l.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const h of l.inlineTexts)c.push({range:D.fromPositions(new z(l.lineNumber,h.column)),options:{description:"ghost-text-decoration",after:{content:h.text,tokens:h.tokens,inlineClassName:(h.preview?"ghost-text-decoration-preview":"ghost-text-decoration")+(this._isClickable?" clickable":"")+d+h.lineDecorations.map(u=>" "+u.className).join(" "),cursorStops:wl.Left,attachedData:new h3(this)},showIfCollapsed:!0}});return c}),this._additionalLinesWidget=this._register(new jYe(this._editor,ae(a=>{const l=this.uiState.read(a);return l?{lineNumber:l.lineNumber,additionalLines:l.additionalLines,minReservedLineCount:l.additionalReservedLineCount,targetTextModel:l.targetTextModel}:void 0}),this._shouldKeepCursorStable,this._isClickable)),this._isInlineTextHovered=this._editorObs.isTargetHovered(a=>{var l;return a.target.type===6&&((l=a.target.detail.injectedText)==null?void 0:l.options.attachedData)instanceof h3&&a.target.detail.injectedText.options.attachedData.owner===this},this._store),this.isHovered=ae(this,a=>this._isDisposed.read(a)?!1:this._isInlineTextHovered.read(a)||this._additionalLinesWidget.isHovered.read(a)),this.height=ae(this,a=>this._editorObs.getOption(75).read(a)+(this._additionalLinesWidget.viewZoneHeight.read(a)??0)),this._register(Ve(()=>{this._isDisposed.set(!0,void 0)})),this._register(this._editorObs.setDecorations(this.decorations)),this._isClickable&&(this._register(this._additionalLinesWidget.onDidClick(a=>this._onDidClick.fire(a))),this._register(this._editor.onMouseUp(a=>{var c;if(a.target.type!==6)return;const l=(c=a.target.detail.injectedText)==null?void 0:c.options.attachedData;l instanceof h3&&l.owner===this&&this._onDidClick.fire(a.event)}))),this._register(Ao((a,l)=>{}))}static getWarningWidgetContext(e){const t=e.ghostTextViewWarningWidgetData;if(t)return t;if(e.parentElement)return this.getWarningWidgetContext(e.parentElement)}ownsViewZone(e){return this._additionalLinesWidget.viewZoneId===e}},tb.hot=a4(tb),tb);MI=UYe([$Ye(5,Wn)],MI);class h3{constructor(e){this.owner=e}}function qYe(s,e,t){const i=[],n=[];function o(h,u){if(n.length>0){const f=n[n.length-1];u&&f.decorations.push(new Qo(f.content.length+1,f.content.length+1+h[0].line.length,u,0)),f.content+=h[0].line,h=h.slice(1)}for(const f of h)n.push({content:f.line,decorations:u?[new Qo(1,f.line.length+1,u,0),...f.lineDecorations]:[...f.lineDecorations]})}const r=e.getLineContent(s.lineNumber);let a,l=0;for(const h of s.parts){let u=h.lines;a===void 0?(i.push({column:h.column,text:u[0].line,preview:h.preview,lineDecorations:u[0].lineDecorations}),u=u.slice(1)):o([{line:r.substring(l,h.column-1),lineDecorations:[]}],void 0),u.length>0&&(o(u,t),a===void 0&&h.column<=r.length&&(a=h.column)),l=h.column-1}let c;a!==void 0&&(c=new zYe(s.lineNumber,new fee(l+1,r.length+1)));const d=a!==void 0?new fee(a,r.length+1):void 0;return{inlineTexts:i,additionalLines:n,hiddenRange:d,additionalLinesOriginalSuffix:c}}class jYe extends K{get viewZoneId(){var e;return(e=this._viewZoneInfo)==null?void 0:e.viewZoneId}get viewZoneHeight(){return this._viewZoneHeight}constructor(e,t,i,n){super(),this._editor=e,this._lines=t,this._shouldKeepCursorStable=i,this._isClickable=n,this._viewZoneHeight=ht("viewZoneHeight",void 0),this.editorOptionsChanged=na("editorOptionChanged",Se.filter(this._editor.onDidChangeConfiguration,o=>o.hasChanged(40)||o.hasChanged(133)||o.hasChanged(113)||o.hasChanged(108)||o.hasChanged(60)||o.hasChanged(59)||o.hasChanged(75))),this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._viewZoneListener=this._register(new mi),this.isHovered=bn(this._editor).isTargetHovered(o=>mee(o.target.element),this._store),this.hasBeenAccepted=!1,this._editor instanceof Vb&&this._shouldKeepCursorStable&&this._register(this._editor.onBeforeExecuteEdit(o=>this.hasBeenAccepted=o.source==="inlineSuggestion.accept")),this._register(lt(o=>{const r=this._lines.read(o);this.editorOptionsChanged.read(o),r?(this.hasBeenAccepted=!1,this.updateLines(r.lineNumber,r.additionalLines,r.minReservedLineCount)):this.clear()}))}dispose(){super.dispose(),this.clear()}clear(){this._viewZoneListener.clear(),this._editor.changeViewZones(e=>{this.removeActiveViewZone(e)})}updateLines(e,t,i){const n=this._editor.getModel();if(!n)return;const{tabSize:o}=n.getOptions();this._editor.changeViewZones(r=>{const a=new oe;this.removeActiveViewZone(r);const l=Math.max(t.length,i);if(l>0){const c=document.createElement("div");KYe(c,o,t,this._editor.getOptions(),this._isClickable),this._isClickable&&(a.add(ee(c,"mousedown",d=>{d.preventDefault()})),a.add(ee(c,"click",d=>{mee(d.target)&&this._onDidClick.fire(new Co(je(d),d))}))),this.addViewZone(r,e,l,c)}this._viewZoneListener.value=a})}addViewZone(e,t,i,n){const o=e.addZone({afterLineNumber:t,heightInLines:i,domNode:n,afterColumnAffinity:1,onComputedHeight:r=>{this._viewZoneHeight.set(r,void 0)}});this.keepCursorStable(t,i),this._viewZoneInfo={viewZoneId:o,heightInLines:i,lineNumber:t}}removeActiveViewZone(e){this._viewZoneInfo&&(e.removeZone(this._viewZoneInfo.viewZoneId),this.hasBeenAccepted||this.keepCursorStable(this._viewZoneInfo.lineNumber,-this._viewZoneInfo.heightInLines),this._viewZoneInfo=void 0,this._viewZoneHeight.set(void 0,void 0))}keepCursorStable(e,t){var n,o;if(!this._shouldKeepCursorStable)return;const i=(o=(n=this._editor.getSelection())==null?void 0:n.getStartPosition())==null?void 0:o.lineNumber;i!==void 0&&e<i&&this._editor.setScrollTop(this._editor.getScrollTop()+t*this._editor.getOption(75))}}function mee(s){return Bn(s)&&s.classList.contains(nue)}function KYe(s,e,t,i,n){const o=i.get(40),r=i.get(133),a="none",l=i.get(108),c=i.get(60),d=i.get(59),h=i.get(75);let u="suggest-preview-text";n&&(u+=" clickable");const f=new Dm(1e4);f.appendString(`<div class="${u}">`);for(let p=0,v=t.length;p<v;p++){const b=t[p],w=b.content;f.appendString('<div class="view-line'),f.appendString('" style="top:'),f.appendString(String(p*h)),f.appendString('px;width:1000000px;">');const C=w.getLineContent(),y=ck(C),x=pw(C);h0(new kf(d.isMonospace&&!o,d.canUseHalfwidthRightwardsArrow,C,!1,y,x,0,w,b.decorations,e,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,r,a,l,c!==gf.OFF,null,null,0),f),f.appendString("</div>")}f.appendString("</div>"),js(s,d);const g=f.build(),m=pee?pee.createHTML(g):g;s.innerHTML=m}const pee=Oh("editorGhostText",{createHTML:s=>s}),rP=class rP{constructor(e){this.replacements=e,uL(sk(e,(t,i)=>t.lineRange.endLineNumberExclusive<=i.lineRange.startLineNumber))}toString(){return this.replacements.map(e=>e.toString()).join(",")}getNewLineRanges(){const e=[];let t=0;for(const i of this.replacements)e.push(dt.ofLength(i.lineRange.startLineNumber+t,i.newLines.length)),t+=i.newLines.length-i.lineRange.length;return e}};rP.empty=new rP([]);let Z8=rP;class mM{static fromSingleTextEdit(e,t){const i=fa(e.text);let n=e.range.startLineNumber;const o=t.getValueOfRange(D.fromPositions(new z(e.range.startLineNumber,1),e.range.getStartPosition()));i[0]=o+i[0];let r=e.range.endLineNumber+1;const a=t.getTransformer().getLineLength(e.range.endLineNumber)+1,l=t.getValueOfRange(D.fromPositions(e.range.getEndPosition(),new z(e.range.endLineNumber,a)));i[i.length-1]=i[i.length-1]+l;const c=e.range.startColumn===t.getTransformer().getLineLength(e.range.startLineNumber)+1,d=e.range.endColumn===1;return c&&i[0].length===o.length&&(n++,i.shift()),i.length>0&&n<r&&d&&i[i.length-1].length===l.length&&(r--,i.pop()),new mM(new dt(n,r),i)}constructor(e,t){this.lineRange=e,this.newLines=t}toString(){return`${this.lineRange}->${JSON.stringify(this.newLines)}`}toLineEdit(){return new Z8([this])}}class sue{get lineEdit(){return this.edit.replacements.length===0?new mM(new dt(1,1),[]):mM.fromSingleTextEdit(this.edit.toReplacement(this.originalText),this.originalText)}get originalLineRange(){return this.lineEdit.lineRange}get modifiedLineRange(){return this.lineEdit.toLineEdit().getNewLineRanges()[0]}get displayRange(){return this.originalText.lineRange.intersect(this.originalLineRange.join(dt.ofLength(this.originalLineRange.startLineNumber,this.lineEdit.newLines.length)))}constructor(e,t,i,n,o,r){this.originalText=e,this.edit=t,this.cursorPosition=i,this.multiCursorPositions=n,this.commands=o,this.inlineCompletion=r}}class oue{constructor(e,t,i){this._model=e,this.inlineEdit=t,this.tabAction=i,this.action=this.inlineEdit.inlineCompletion.action,this.displayName=this.inlineEdit.inlineCompletion.source.provider.displayName??_(1219,"Inline Edit"),this.extensionCommands=this.inlineEdit.inlineCompletion.source.inlineSuggestions.commands??[],this.isInDiffEditor=this._model.isInDiffEditor,this.displayLocation=this.inlineEdit.inlineCompletion.hint,this.showCollapsed=this._model.showCollapsed}accept(){this._model.accept()}jump(){this._model.jump()}handleInlineEditShown(e,t){this._model.handleInlineSuggestionShown(this.inlineEdit.inlineCompletion,e,t)}}class GYe{constructor(e){this._model=e,this.onDidAccept=this._model.onDidAccept,this.inAcceptFlow=this._model.inAcceptFlow}}class YYe{constructor(e,t,i,n){this.lineRange=i;const o=bn(e),r=ae(this,a=>o.isFocused.read(a)&&n.showInlineEditMenu?No.Accept:No.Inactive);this.model=new oue(t,new sue(new xg(""),new ra([n.getSingleTextEdit()]),t.primaryPosition.get(),t.allPositions.get(),n.source.inlineSuggestions.commands??[],n),r)}}class Wi{static fromPoints(e,t){return new Wi(e.x,e.y,t.x,t.y)}static fromPointSize(e,t){return new Wi(e.x,e.y,e.x+t.x,e.y+t.y)}static fromLeftTopRightBottom(e,t,i,n){return new Wi(e,t,i,n)}static fromLeftTopWidthHeight(e,t,i,n){return new Wi(e,t,e+i,t+n)}static fromRanges(e,t){return new Wi(e.start,t.start,e.endExclusive,t.endExclusive)}static hull(e){let t=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER;for(const r of e)t=Math.min(t,r.left),i=Math.min(i,r.top),n=Math.max(n,r.right),o=Math.max(o,r.bottom);return new Wi(t,i,n,o)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}constructor(e,t,i,n){if(this.left=e,this.top=t,this.right=i,this.bottom=n,e>i)throw new et("Invalid arguments: Horizontally offset by "+(e-i));if(t>n)throw new et("Invalid arguments: Vertically offset by "+(t-n))}withMargin(e,t,i,n){let o,r,a,l;return t===void 0&&i===void 0&&n===void 0?o=r=a=l=e:i===void 0&&n===void 0?(o=r=t,a=l=e):(o=n,r=t,a=e,l=i),new Wi(this.left-o,this.top-a,this.right+r,this.bottom+l)}intersectVertical(e){const t=Math.max(this.top,e.start),i=Math.min(this.bottom,e.endExclusive);return new Wi(this.left,t,this.right,Math.max(t,i))}intersectHorizontal(e){const t=Math.max(this.left,e.start),i=Math.min(this.right,e.endExclusive);return new Wi(t,this.top,Math.max(t,i),this.bottom)}toString(){return`Rect{(${this.left},${this.top}), (${this.right},${this.bottom})}`}intersect(e){const t=Math.max(this.left,e.left),i=Math.min(this.right,e.right),n=Math.max(this.top,e.top),o=Math.min(this.bottom,e.bottom);if(!(t>i||n>o))return new Wi(t,n,i,o)}containsRect(e){return this.left<=e.left&&this.top<=e.top&&this.right>=e.right&&this.bottom>=e.bottom}containsPoint(e){return this.left<=e.x&&this.top<=e.y&&this.right>=e.x&&this.bottom>=e.y}moveToBeContainedIn(e){const t=this.width,i=this.height;let n=this.left,o=this.top;return n<e.left?n=e.left:n+t>e.right&&(n=e.right-t),o<e.top?o=e.top:o+i>e.bottom&&(o=e.bottom-i),new Wi(n,o,n+t,o+i)}withWidth(e){return new Wi(this.left,this.top,this.left+e,this.bottom)}withHeight(e){return new Wi(this.left,this.top,this.right,this.top+e)}withTop(e){return new Wi(this.left,e,this.right,this.bottom)}withLeft(e){return new Wi(e,this.top,this.right,this.bottom)}translateX(e){return new Wi(this.left+e,this.top,this.right+e,this.bottom)}translateY(e){return new Wi(this.left,this.top+e,this.right,this.bottom+e)}getLeftBottom(){return new Ms(this.left,this.bottom)}getRightBottom(){return new Ms(this.right,this.bottom)}getRightTop(){return new Ms(this.right,this.top)}toStyles(){return{position:"absolute",left:`${this.left}px`,top:`${this.top}px`,width:`${this.width}px`,height:`${this.height}px`}}}class yx{constructor(e,t,i,n=null){this.startLineNumbers=e,this.endLineNumbers=t,this.lastLineRelativePosition=i,this.showEndForLine=n}equals(e){return!!e&&this.lastLineRelativePosition===e.lastLineRelativePosition&&this.showEndForLine===e.showEndForLine&&dn(this.startLineNumbers,e.startLineNumbers)&&dn(this.endLineNumbers,e.endLineNumbers)}static get Empty(){return new yx([],[],0)}}const _ee=Oh("stickyScrollViewLayer",{createHTML:s=>s}),u3="data-sticky-line-index",bee="data-sticky-is-line",XYe="data-sticky-is-line-number",vee="data-sticky-is-folding-icon";class ZYe extends K{get height(){return this._height}constructor(e){super(),this._foldingIconStore=this._register(new oe),this._rootDomNode=document.createElement("div"),this._lineNumbersDomNode=document.createElement("div"),this._linesDomNodeScrollable=document.createElement("div"),this._linesDomNode=document.createElement("div"),this._renderedStickyLines=[],this._lineNumbers=[],this._lastLineRelativePosition=0,this._minContentWidthInPx=0,this._isOnGlyphMargin=!1,this._height=-1,this._onDidChangeStickyScrollHeight=this._register(new q),this.onDidChangeStickyScrollHeight=this._onDidChangeStickyScrollHeight.event,this._editor=e,this._lineHeight=e.getOption(75),this._lineNumbersDomNode.className="sticky-widget-line-numbers",this._lineNumbersDomNode.setAttribute("role","none"),this._linesDomNode.className="sticky-widget-lines",this._linesDomNode.setAttribute("role","list"),this._linesDomNodeScrollable.className="sticky-widget-lines-scrollable",this._linesDomNodeScrollable.appendChild(this._linesDomNode),this._rootDomNode.className="sticky-widget",this._rootDomNode.classList.toggle("peek",e instanceof Sf),this._rootDomNode.appendChild(this._lineNumbersDomNode),this._rootDomNode.appendChild(this._linesDomNodeScrollable),this._setHeight(0);const t=()=>{this._linesDomNode.style.left=this._editor.getOption(131).scrollWithEditor?`-${this._editor.getScrollLeft()}px`:"0px"};this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(131)&&t(),i.hasChanged(75)&&(this._lineHeight=this._editor.getOption(75))})),this._register(this._editor.onDidScrollChange(i=>{i.scrollLeftChanged&&t(),i.scrollWidthChanged&&this._updateWidgetWidth()})),this._register(this._editor.onDidChangeModel(()=>{t(),this._updateWidgetWidth()})),t(),this._register(this._editor.onDidLayoutChange(i=>{this._updateWidgetWidth()})),this._updateWidgetWidth()}get lineNumbers(){return this._lineNumbers}get lineNumberCount(){return this._lineNumbers.length}getRenderedStickyLine(e){return this._renderedStickyLines.find(t=>t.lineNumber===e)}getCurrentLines(){return this._lineNumbers}setState(e,t,i){const n=!this._state&&!e,o=this._state&&this._state.equals(e);if(i===void 0&&(n||o))return;const r=this._findRenderingData(e),a=this._lineNumbers;this._lineNumbers=r.lineNumbers,this._lastLineRelativePosition=r.lastLineRelativePosition;const l=this._findIndexToRebuildFrom(a,this._lineNumbers,i);this._renderRootNode(this._lineNumbers,this._lastLineRelativePosition,t,l),this._state=e}_findRenderingData(e){if(!e)return{lineNumbers:[],lastLineRelativePosition:0};const t=[...e.startLineNumbers];e.showEndForLine!==null&&(t[e.showEndForLine]=e.endLineNumbers[e.showEndForLine]);let i=0;for(let n=0;n<t.length;n++)i+=this._editor.getLineHeightForPosition(new z(t[n],1));return i===0?{lineNumbers:[],lastLineRelativePosition:0}:{lineNumbers:t,lastLineRelativePosition:e.lastLineRelativePosition}}_findIndexToRebuildFrom(e,t,i){if(t.length===0)return 0;if(i!==void 0)return i;const n=t.findIndex(o=>!e.includes(o));return n===-1?0:n}_updateWidgetWidth(){const e=this._editor.getLayoutInfo(),t=e.contentLeft;this._lineNumbersDomNode.style.width=`${t}px`,this._linesDomNodeScrollable.style.setProperty("--vscode-editorStickyScroll-scrollableWidth",`${this._editor.getScrollWidth()-e.verticalScrollbarWidth}px`),this._rootDomNode.style.width=`${e.width-e.verticalScrollbarWidth}px`}_useFoldingOpacityTransition(e){this._lineNumbersDomNode.style.setProperty("--vscode-editorStickyScroll-foldingOpacityTransition",`opacity ${e?.5:0}s`)}_setFoldingIconsVisibility(e){for(const t of this._renderedStickyLines){const i=t.foldingIcon;i&&i.setVisible(e?!0:i.isCollapsed)}}async _renderRootNode(e,t,i,n){const o=this._editor._getViewModel();if(!o){this._clearWidget();return}if(e.length===0){this._clearWidget();return}const r=[],a=e[e.length-1];let l=0;for(let d=0;d<this._renderedStickyLines.length;d++)if(d<n){const h=this._renderedStickyLines[d];r.push(this._updatePosition(h,l,h.lineNumber===a)),l+=h.height}else{const h=this._renderedStickyLines[d];h.lineNumberDomNode.remove(),h.lineDomNode.remove()}const c=this._editor.getLayoutInfo();for(let d=n;d<e.length;d++){const h=this._renderChildNode(o,d,e[d],l,a===e[d],i,c);l+=h.height,this._linesDomNode.appendChild(h.lineDomNode),this._lineNumbersDomNode.appendChild(h.lineNumberDomNode),r.push(h)}i&&(this._setFoldingHoverListeners(),this._useFoldingOpacityTransition(!this._isOnGlyphMargin)),this._minContentWidthInPx=Math.max(...this._renderedStickyLines.map(d=>d.scrollWidth))+c.verticalScrollbarWidth,this._renderedStickyLines=r,this._setHeight(l+t),this._editor.layoutOverlayWidget(this)}_clearWidget(){for(let e=0;e<this._renderedStickyLines.length;e++){const t=this._renderedStickyLines[e];t.lineNumberDomNode.remove(),t.lineDomNode.remove()}this._setHeight(0)}_setHeight(e){this._height!==e&&(this._height=e,this._height===0?this._rootDomNode.style.display="none":(this._rootDomNode.style.display="block",this._lineNumbersDomNode.style.height=`${this._height}px`,this._linesDomNodeScrollable.style.height=`${this._height}px`,this._rootDomNode.style.height=`${this._height}px`),this._onDidChangeStickyScrollHeight.fire({height:this._height}))}_setFoldingHoverListeners(){this._editor.getOption(126)==="mouseover"&&(this._foldingIconStore.clear(),this._foldingIconStore.add(ee(this._lineNumbersDomNode,ye.MOUSE_ENTER,()=>{this._isOnGlyphMargin=!0,this._setFoldingIconsVisibility(!0)})),this._foldingIconStore.add(ee(this._lineNumbersDomNode,ye.MOUSE_LEAVE,()=>{this._isOnGlyphMargin=!1,this._useFoldingOpacityTransition(!0),this._setFoldingIconsVisibility(!1)})))}_renderChildNode(e,t,i,n,o,r,a){const l=e.coordinatesConverter.convertModelPositionToViewPosition(new z(i,1)).lineNumber,c=e.getViewLineRenderingData(l),d=this._editor.getOption(76),h=this._editor.getOption(117).verticalScrollbarSize;let u;try{u=Qo.filter(c.inlineDecorations,l,c.minColumn,c.maxColumn)}catch{u=[]}const f=this._editor.getLineHeightForPosition(new z(i,1)),g=e.getTextDirection(i),m=new kf(!0,!0,c.content,c.continuesWithWrappedLine,c.isBasicASCII,c.containsRTL,0,c.tokens,u,c.tabSize,c.startVisibleColumn,1,1,1,500,"none",!0,!0,null,g,h),p=new Dm(2e3),v=h0(m,p);let b;_ee?b=_ee.createHTML(p.build()):b=p.build();const w=document.createElement("span");w.setAttribute(u3,String(t)),w.setAttribute(bee,""),w.setAttribute("role","listitem"),w.tabIndex=0,w.className="sticky-line-content",w.classList.add(`stickyLine${i}`),w.style.lineHeight=`${f}px`,w.innerHTML=b;const C=document.createElement("span");C.setAttribute(u3,String(t)),C.setAttribute(XYe,""),C.className="sticky-line-number",C.style.lineHeight=`${f}px`;const y=a.contentLeft;C.style.width=`${y}px`;const x=document.createElement("span");d.renderType===1||d.renderType===3&&i%10===0?x.innerText=i.toString():d.renderType===2&&(x.innerText=Math.abs(i-this._editor.getPosition().lineNumber).toString()),x.className="sticky-line-number-inner",x.style.width=`${a.lineNumbersWidth}px`,x.style.paddingLeft=`${a.lineNumbersLeft}px`,C.appendChild(x);const S=this._renderFoldingIconForLine(r,i);S&&(C.appendChild(S.domNode),S.domNode.style.left=`${a.lineNumbersWidth+a.lineNumbersLeft}px`,S.domNode.style.lineHeight=`${f}px`),this._editor.applyFontInfo(w),this._editor.applyFontInfo(C),C.style.lineHeight=`${f}px`,w.style.lineHeight=`${f}px`,C.style.height=`${f}px`,w.style.height=`${f}px`;const L=new QYe(t,i,w,C,S,v.characterMapping,w.scrollWidth,f);return this._updatePosition(L,n,o)}_updatePosition(e,t,i){var r;const n=e.lineDomNode,o=e.lineNumberDomNode;if(i){n.style.zIndex="0",o.style.zIndex="0";const l=`${t+this._lastLineRelativePosition+((r=e.foldingIcon)!=null&&r.isCollapsed?1:0)}px`;n.style.top=l,o.style.top=l}else n.style.zIndex="1",o.style.zIndex="1",n.style.top=`${t}px`,o.style.top=`${t}px`;return e}_renderFoldingIconForLine(e,t){const i=this._editor.getOption(126);if(!e||i==="never")return;const n=e.regions,o=n.findRange(t),r=n.getStartLineNumber(o);if(!(t===r))return;const l=n.isCollapsed(o),c=new JYe(l,r,n.getEndLineNumber(o),this._lineHeight);return c.setVisible(this._isOnGlyphMargin?!0:l||i==="always"),c.domNode.setAttribute(vee,""),c}getId(){return"editor.contrib.stickyScrollWidget"}getDomNode(){return this._rootDomNode}getPosition(){return{preference:2,stackOridinal:10}}getMinContentWidthInPx(){return this._minContentWidthInPx}focusLineWithIndex(e){0<=e&&e<this._renderedStickyLines.length&&this._renderedStickyLines[e].lineDomNode.focus()}getEditorPositionFromNode(e){if(!e||e.children.length>0)return null;const t=this._getRenderedStickyLineFromChildDomNode(e);if(!t)return null;const i=xw(t.characterMapping,e,0);return new z(t.lineNumber,i)}getLineNumberFromChildDomNode(e){var t;return((t=this._getRenderedStickyLineFromChildDomNode(e))==null?void 0:t.lineNumber)??null}_getRenderedStickyLineFromChildDomNode(e){const t=this.getLineIndexFromChildDomNode(e);return t===null||t<0||t>=this._renderedStickyLines.length?null:this._renderedStickyLines[t]}getLineIndexFromChildDomNode(e){const t=this._getAttributeValue(e,u3);return t?parseInt(t,10):null}isInStickyLine(e){return this._getAttributeValue(e,bee)!==void 0}isInFoldingIconDomNode(e){return this._getAttributeValue(e,vee)!==void 0}_getAttributeValue(e,t){for(;e&&e!==this._rootDomNode;){const i=e.getAttribute(t);if(i!==null)return i;e=e.parentElement}}}class QYe{constructor(e,t,i,n,o,r,a,l){this.index=e,this.lineNumber=t,this.lineDomNode=i,this.lineNumberDomNode=n,this.foldingIcon=o,this.characterMapping=r,this.scrollWidth=a,this.height=l}}class JYe{constructor(e,t,i,n){this.isCollapsed=e,this.foldingStartLine=t,this.foldingEndLine=i,this.dimension=n,this.domNode=document.createElement("div"),this.domNode.style.width="26px",this.domNode.style.height=`${n}px`,this.domNode.style.lineHeight=`${n}px`,this.domNode.className=it.asClassName(e?q2:$2)}setVisible(e){this.domNode.style.cursor=e?"pointer":"default",this.domNode.style.opacity=e?"1":"0"}}class Sx{constructor(e,t){this.startLineNumber=e,this.endLineNumber=t}}class pM{constructor(e,t,i){this.range=e,this.children=t,this.parent=i}}class rue{constructor(e,t,i,n){this.uri=e,this.version=t,this.element=i,this.outlineProviderId=n}}var W4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},AI=function(s,e){return function(t,i){e(t,i,s)}},xx;(function(s){s.OUTLINE_MODEL="outlineModel",s.FOLDING_PROVIDER_MODEL="foldingProviderModel",s.INDENTATION_MODEL="indentationModel"})(xx||(xx={}));var Rg;(function(s){s[s.VALID=0]="VALID",s[s.INVALID=1]="INVALID",s[s.CANCELED=2]="CANCELED"})(Rg||(Rg={}));let Q8=class extends K{constructor(e,t,i,n){switch(super(),this._editor=e,this._modelProviders=[],this._modelPromise=null,this._updateScheduler=this._register(new Pl(300)),this._updateOperation=this._register(new oe),this._editor.getOption(131).defaultModel){case xx.OUTLINE_MODEL:this._modelProviders.push(new J8(this._editor,n));case xx.FOLDING_PROVIDER_MODEL:this._modelProviders.push(new t6(this._editor,t,n));case xx.INDENTATION_MODEL:this._modelProviders.push(new e6(this._editor,i));break}}dispose(){this._modelProviders.forEach(e=>e.dispose()),this._updateOperation.clear(),this._cancelModelPromise(),super.dispose()}_cancelModelPromise(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}async update(e){return this._updateOperation.clear(),this._updateOperation.add({dispose:()=>{this._cancelModelPromise(),this._updateScheduler.cancel()}}),this._cancelModelPromise(),await this._updateScheduler.trigger(async()=>{for(const t of this._modelProviders){const{statusPromise:i,modelPromise:n}=t.computeStickyModel(e);this._modelPromise=n;const o=await i;if(this._modelPromise!==n)return null;switch(o){case Rg.CANCELED:return this._updateOperation.clear(),null;case Rg.VALID:return t.stickyModel}}return null}).catch(t=>(_t(t),null))}};Q8=W4([AI(2,$e),AI(3,We)],Q8);class aue extends K{constructor(e){super(),this._editor=e,this._stickyModel=null}get stickyModel(){return this._stickyModel}_invalid(){return this._stickyModel=null,Rg.INVALID}computeStickyModel(e){if(e.isCancellationRequested||!this.isProviderValid())return{statusPromise:this._invalid(),modelPromise:null};const t=ys(i=>this.createModelFromProvider(i));return{statusPromise:t.then(i=>this.isModelValid(i)?e.isCancellationRequested?Rg.CANCELED:(this._stickyModel=this.createStickyModel(e,i),Rg.VALID):this._invalid()).then(void 0,i=>(_t(i),Rg.CANCELED)),modelPromise:t}}isModelValid(e){return!0}isProviderValid(){return!0}}let J8=class extends aue{constructor(e,t){super(e),this._languageFeaturesService=t}createModelFromProvider(e){return Cu.create(this._languageFeaturesService.documentSymbolProvider,this._editor.getModel(),e)}createStickyModel(e,t){var r;const{stickyOutlineElement:i,providerID:n}=this._stickyModelFromOutlineModel(t,(r=this._stickyModel)==null?void 0:r.outlineProviderId),o=this._editor.getModel();return new rue(o.uri,o.getVersionId(),i,n)}isModelValid(e){return e&&e.children.size>0}_stickyModelFromOutlineModel(e,t){let i;if(Gt.first(e.children.values())instanceof Bhe){const a=Gt.find(e.children.values(),l=>l.id===t);if(a)i=a.children;else{let l="",c=-1,d;for(const[h,u]of e.children.entries()){const f=this._findSumOfRangesOfGroup(u);f>c&&(d=u,c=f,l=u.id)}t=l,i=d.children}}else i=e.children;const n=[],o=Array.from(i.values()).sort((a,l)=>{const c=new Sx(a.symbol.range.startLineNumber,a.symbol.range.endLineNumber),d=new Sx(l.symbol.range.startLineNumber,l.symbol.range.endLineNumber);return this._comparator(c,d)});for(const a of o)n.push(this._stickyModelFromOutlineElement(a,a.symbol.selectionRange.startLineNumber));return{stickyOutlineElement:new pM(void 0,n,void 0),providerID:t}}_stickyModelFromOutlineElement(e,t){const i=[];for(const o of e.children.values())if(o.symbol.selectionRange.startLineNumber!==o.symbol.range.endLineNumber)if(o.symbol.selectionRange.startLineNumber!==t)i.push(this._stickyModelFromOutlineElement(o,o.symbol.selectionRange.startLineNumber));else for(const r of o.children.values())i.push(this._stickyModelFromOutlineElement(r,o.symbol.selectionRange.startLineNumber));i.sort((o,r)=>this._comparator(o.range,r.range));const n=new Sx(e.symbol.selectionRange.startLineNumber,e.symbol.range.endLineNumber);return new pM(n,i,void 0)}_comparator(e,t){return e.startLineNumber!==t.startLineNumber?e.startLineNumber-t.startLineNumber:t.endLineNumber-e.endLineNumber}_findSumOfRangesOfGroup(e){let t=0;for(const i of e.children.values())t+=this._findSumOfRangesOfGroup(i);return e instanceof y8?t+e.symbol.range.endLineNumber-e.symbol.selectionRange.startLineNumber:t}};J8=W4([AI(1,We)],J8);class lue extends aue{constructor(e){super(e),this._foldingLimitReporter=this._register(new Rhe(e))}createStickyModel(e,t){const i=this._fromFoldingRegions(t),n=this._editor.getModel();return new rue(n.uri,n.getVersionId(),i,void 0)}isModelValid(e){return e!==null}_fromFoldingRegions(e){const t=e.length,i=[],n=new pM(void 0,[],void 0);for(let o=0;o<t;o++){const r=e.getParentIndex(o);let a;r!==-1?a=i[r]:a=n;const l=new pM(new Sx(e.getStartLineNumber(o),e.getEndLineNumber(o)+1),[],a);a.children.push(l),i.push(l)}return n}}let e6=class extends lue{constructor(e,t){super(e),this._languageConfigurationService=t,this.provider=this._register(new pj(e.getModel(),this._languageConfigurationService,this._foldingLimitReporter))}async createModelFromProvider(e){return this.provider.compute(e)}};e6=W4([AI(1,wn)],e6);let t6=class extends lue{constructor(e,t,i){super(e),this._languageFeaturesService=i,this.provider=this._register(new mi),this._register(this._languageFeaturesService.foldingRangeProvider.onDidChange(()=>{this._updateProvider(e,t)})),this._updateProvider(e,t)}_updateProvider(e,t){const i=xm.getFoldingRangeProviders(this._languageFeaturesService,e.getModel());i.length!==0&&(this.provider.value=new _j(e.getModel(),i,t,this._foldingLimitReporter,void 0))}isProviderValid(){return this.provider!==void 0}async createModelFromProvider(e){var t;return((t=this.provider.value)==null?void 0:t.compute(e))??null}};t6=W4([AI(2,We)],t6);var eXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Cee=function(s,e){return function(t,i){e(t,i,s)}};class tXe{constructor(e,t,i,n){this.startLineNumber=e,this.endLineNumber=t,this.top=i,this.height=n}}let i6=class extends K{constructor(e,t,i){super(),this._languageFeaturesService=t,this._languageConfigurationService=i,this._onDidChangeStickyScroll=this._register(new q),this.onDidChangeStickyScroll=this._onDidChangeStickyScroll.event,this._model=null,this._cts=null,this._stickyModelProvider=null,this._editor=e,this._sessionStore=this._register(new oe),this._updateSoon=this._register(new Ni(()=>this.update(),50)),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(131)&&this.readConfiguration()})),this.readConfiguration()}readConfiguration(){this._sessionStore.clear(),this._editor.getOption(131).enabled&&(this._sessionStore.add(this._editor.onDidChangeModel(()=>{this._model=null,this.updateStickyModelProvider(),this._onDidChangeStickyScroll.fire(),this.update()})),this._sessionStore.add(this._editor.onDidChangeHiddenAreas(()=>this.update())),this._sessionStore.add(this._editor.onDidChangeModelContent(()=>this._updateSoon.schedule())),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>this.update())),this._sessionStore.add(Ve(()=>{var t;(t=this._stickyModelProvider)==null||t.dispose(),this._stickyModelProvider=null})),this.updateStickyModelProvider(),this.update())}getVersionId(){var e;return(e=this._model)==null?void 0:e.version}updateStickyModelProvider(){var e;(e=this._stickyModelProvider)==null||e.dispose(),this._stickyModelProvider=null,this._editor.hasModel()&&(this._stickyModelProvider=new Q8(this._editor,()=>this._updateSoon.schedule(),this._languageConfigurationService,this._languageFeaturesService))}async update(){var e;(e=this._cts)==null||e.dispose(!0),this._cts=new hn,await this.updateStickyModel(this._cts.token),this._onDidChangeStickyScroll.fire()}async updateStickyModel(e){if(!this._editor.hasModel()||!this._stickyModelProvider||this._editor.getModel().isTooLargeForTokenization()){this._model=null;return}const t=await this._stickyModelProvider.update(e);e.isCancellationRequested||(this._model=t)}getCandidateStickyLinesIntersecting(e){var i;if(!((i=this._model)!=null&&i.element))return[];const t=[];return this.getCandidateStickyLinesIntersectingFromStickyModel(e,this._model.element,t,0,0,-1),this.filterHiddenRanges(t)}getCandidateStickyLinesIntersectingFromStickyModel(e,t,i,n,o,r){const a=this._editor.getModel();if(!a||t.children.length===0)return;let l=r;const c=[];for(let u=0;u<t.children.length;u++){const f=t.children[u];f.range&&c.push(f.range.startLineNumber)}const d=this.updateIndex(KN(c,e.startLineNumber,(u,f)=>u-f)),h=this.updateIndex(KN(c,e.endLineNumber,(u,f)=>u-f));for(let u=d;u<=h;u++){const f=t.children[u];if(!f||!f.range)continue;const{startLineNumber:g,endLineNumber:m}=f.range;if(m>g+1&&e.startLineNumber<=m+1&&g-1<=e.endLineNumber&&g!==l&&a.isValidRange(new D(g,1,m,1))){l=g;const p=this._editor.getLineHeightForPosition(new z(g,1));i.push(new tXe(g,m-1,o,p)),this.getCandidateStickyLinesIntersectingFromStickyModel(e,f,i,n+1,o+p,g)}}}filterHiddenRanges(e){var i;const t=(i=this._editor._getViewModel())==null?void 0:i.getHiddenAreas();return t?e.filter(n=>!t.some(o=>n.startLineNumber>=o.startLineNumber&&n.endLineNumber<=o.endLineNumber+1)):e}updateIndex(e){return e===-1?0:e<0?-e-2:e}};i6=eXe([Cee(1,We),Cee(2,wn)],i6);var iXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rC=function(s,e){return function(t,i){e(t,i,s)}},n6,ib;let bc=(ib=class extends K{constructor(e,t,i,n,o,r,a){super(),this._editor=e,this._contextMenuService=t,this._languageFeaturesService=i,this._instaService=n,this._contextKeyService=a,this._sessionStore=new oe,this._maxStickyLines=Number.MAX_SAFE_INTEGER,this._candidateDefinitionsLength=-1,this._focusedStickyElementIndex=-1,this._enabled=!1,this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1,this._endLineNumbers=[],this._mouseTarget=null,this._onDidChangeStickyScrollHeight=this._register(new q),this.onDidChangeStickyScrollHeight=this._onDidChangeStickyScrollHeight.event,this._stickyScrollWidget=new ZYe(this._editor),this._stickyLineCandidateProvider=new i6(this._editor,i,o),this._register(this._stickyScrollWidget),this._register(this._stickyLineCandidateProvider),this._widgetState=yx.Empty;const l=this._stickyScrollWidget.getDomNode();this._register(this._editor.onDidChangeLineHeight(d=>{d.changes.forEach(h=>{const u=h.lineNumber;this._widgetState.startLineNumbers.includes(u)&&this._renderStickyScroll(u)})})),this._register(this._editor.onDidChangeFont(d=>{d.changes.forEach(h=>{const u=h.lineNumber;this._widgetState.startLineNumbers.includes(u)&&this._renderStickyScroll(u)})})),this._register(this._editor.onDidChangeConfiguration(d=>{this._readConfigurationChange(d)})),this._register(ee(l,ye.CONTEXT_MENU,async d=>{this._onContextMenu(je(l),d)})),this._stickyScrollFocusedContextKey=B.stickyScrollFocused.bindTo(this._contextKeyService),this._stickyScrollVisibleContextKey=B.stickyScrollVisible.bindTo(this._contextKeyService);const c=this._register(Ol(l));this._register(c.onDidBlur(d=>{this._positionRevealed===!1&&l.clientHeight===0?(this._focusedStickyElementIndex=-1,this.focus()):this._disposeFocusStickyScrollStore()})),this._register(c.onDidFocus(d=>{this.focus()})),this._registerMouseListeners(),this._register(ee(l,ye.MOUSE_DOWN,d=>{this._onMouseDown=!0})),this._register(this._stickyScrollWidget.onDidChangeStickyScrollHeight(d=>{this._onDidChangeStickyScrollHeight.fire(d)})),this._onDidResize(),this._readConfiguration()}get stickyScrollWidgetHeight(){return this._stickyScrollWidget.height}static get(e){return e.getContribution(n6.ID)}_disposeFocusStickyScrollStore(){var e;this._stickyScrollFocusedContextKey.set(!1),(e=this._focusDisposableStore)==null||e.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}isFocused(){return this._focused}focus(){if(this._onMouseDown){this._onMouseDown=!1,this._editor.focus();return}this._stickyScrollFocusedContextKey.get()!==!0&&(this._focused=!0,this._focusDisposableStore=new oe,this._stickyScrollFocusedContextKey.set(!0),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}focusNext(){this._focusedStickyElementIndex<this._stickyScrollWidget.lineNumberCount-1&&this._focusNav(!0)}focusPrevious(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}selectEditor(){this._editor.focus()}_focusNav(e){this._focusedStickyElementIndex=e?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)}goToFocused(){const e=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:e[this._focusedStickyElementIndex],column:1})}_revealPosition(e){this._reveaInEditor(e,()=>this._editor.revealPosition(e))}_revealLineInCenterIfOutsideViewport(e){this._reveaInEditor(e,()=>this._editor.revealLineInCenterIfOutsideViewport(e.lineNumber,0))}_reveaInEditor(e,t){this._focused&&this._disposeFocusStickyScrollStore(),this._positionRevealed=!0,t(),this._editor.setSelection(D.fromPositions(e)),this._editor.focus()}_registerMouseListeners(){const e=this._register(new oe),t=this._register(new y4(this._editor,{extractLineNumberFromMouseEvent:o=>{const r=this._stickyScrollWidget.getEditorPositionFromNode(o.target.element);return r?r.lineNumber:0}})),i=o=>{if(!this._editor.hasModel()||o.target.type!==12||o.target.detail!==this._stickyScrollWidget.getId())return null;const r=o.target.element;if(!r||r.innerText!==r.innerHTML)return null;const a=this._stickyScrollWidget.getEditorPositionFromNode(r);return a?{range:new D(a.lineNumber,a.column,a.lineNumber,a.column+r.innerText.length),textElement:r}:null},n=this._stickyScrollWidget.getDomNode();this._register(Jn(n,ye.CLICK,o=>{if(o.ctrlKey||o.altKey||o.metaKey||!o.leftButton)return;if(o.shiftKey){const c=this._stickyScrollWidget.getLineIndexFromChildDomNode(o.target);if(c===null)return;const d=new z(this._endLineNumbers[c],1);this._revealLineInCenterIfOutsideViewport(d);return}if(this._stickyScrollWidget.isInFoldingIconDomNode(o.target)){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(o.target);this._toggleFoldingRegionForLine(c);return}if(!this._stickyScrollWidget.isInStickyLine(o.target))return;let l=this._stickyScrollWidget.getEditorPositionFromNode(o.target);if(!l){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(o.target);if(c===null)return;l=new z(c,1)}this._revealPosition(l)})),this._register(ee(Ti,ye.MOUSE_MOVE,o=>{this._mouseTarget=o.target,this._onMouseMoveOrKeyDown(o)})),this._register(ee(Ti,ye.KEY_DOWN,o=>{this._onMouseMoveOrKeyDown(o)})),this._register(ee(Ti,ye.KEY_UP,()=>{this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(t.onMouseMoveOrRelevantKeyDown(([o,r])=>{const a=i(o);if(!a||!o.hasTriggerModifier||!this._editor.hasModel()){e.clear();return}const{range:l,textElement:c}=a;if(!l.equalsRange(this._stickyRangeProjectedOnEditor))this._stickyRangeProjectedOnEditor=l,e.clear();else if(c.style.textDecoration==="underline")return;const d=new hn;e.add(Ve(()=>d.dispose(!0)));let h;Wk(this._languageFeaturesService.definitionProvider,this._editor.getModel(),new z(l.startLineNumber,l.startColumn+1),!1,d.token).then((u=>{if(!d.token.isCancellationRequested)if(u.length!==0){this._candidateDefinitionsLength=u.length;const f=c;h!==f?(e.clear(),h=f,h.style.textDecoration="underline",e.add(Ve(()=>{h.style.textDecoration="none"}))):h||(h=f,h.style.textDecoration="underline",e.add(Ve(()=>{h.style.textDecoration="none"})))}else e.clear()}))})),this._register(t.onCancel(()=>{e.clear()})),this._register(t.onExecute(async o=>{if(o.target.type!==12||o.target.detail!==this._stickyScrollWidget.getId())return;const r=this._stickyScrollWidget.getEditorPositionFromNode(o.target.element);r&&(!this._editor.hasModel()||!this._stickyRangeProjectedOnEditor||(this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:r.lineNumber,column:1})),this._instaService.invokeFunction(_he,o,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor})))}))}_onContextMenu(e,t){const i=new Co(e,t);this._contextMenuService.showContextMenu({menuId:He.StickyScrollContext,getAnchor:()=>i})}_onMouseMoveOrKeyDown(e){if(!e.shiftKey||!this._mouseTarget||!Bn(this._mouseTarget))return;const t=this._stickyScrollWidget.getLineIndexFromChildDomNode(this._mouseTarget);t===null||this._showEndForLine===t||(this._showEndForLine=t,this._renderStickyScroll())}_toggleFoldingRegionForLine(e){if(!this._foldingModel||e===null)return;const t=this._stickyScrollWidget.getRenderedStickyLine(e),i=t==null?void 0:t.foldingIcon;if(!i)return;fj(this._foldingModel,1,[e]),i.isCollapsed=!i.isCollapsed;const n=(i.isCollapsed?this._editor.getTopForLineNumber(i.foldingEndLine):this._editor.getTopForLineNumber(i.foldingStartLine))-this._editor.getOption(75)*t.index+1;this._editor.setScrollTop(n),this._renderStickyScroll(e)}_readConfiguration(){const e=this._editor.getOption(131);if(e.enabled===!1){this._editor.removeOverlayWidget(this._stickyScrollWidget),this._resetState(),this._sessionStore.clear(),this._enabled=!1;return}else e.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange(i=>{i.scrollTopChanged&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._sessionStore.add(this._editor.onDidLayoutChange(()=>this._onDidResize())),this._sessionStore.add(this._editor.onDidChangeModelTokens(i=>this._onTokensChange(i))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(()=>{this._showEndForLine=void 0,this._renderStickyScroll()})),this._enabled=!0);this._editor.getOption(76).renderType===2&&this._sessionStore.add(this._editor.onDidChangeCursorPosition(()=>{this._showEndForLine=void 0,this._renderStickyScroll(0)}))}_readConfigurationChange(e){(e.hasChanged(131)||e.hasChanged(81)||e.hasChanged(75)||e.hasChanged(126)||e.hasChanged(76))&&this._readConfiguration(),(e.hasChanged(76)||e.hasChanged(52)||e.hasChanged(126))&&this._renderStickyScroll(0)}_needsUpdate(e){const t=this._stickyScrollWidget.getCurrentLines();for(const i of t)for(const n of e.ranges)if(i>=n.fromLineNumber&&i<=n.toLineNumber)return!0;return!1}_onTokensChange(e){this._needsUpdate(e)&&this._renderStickyScroll(0)}_onDidResize(){const t=this._editor.getLayoutInfo().height/this._editor.getOption(75);this._maxStickyLines=Math.round(t*.25),this._renderStickyScroll(0)}async _renderStickyScroll(e){const t=this._editor.getModel();if(!t||t.isTooLargeForTokenization()){this._resetState();return}const i=this._updateAndGetMinRebuildFromLine(e),n=this._stickyLineCandidateProvider.getVersionId();if(n===void 0||n===t.getVersionId())if(!this._focused)await this._updateState(i);else if(this._focusedStickyElementIndex===-1)await this._updateState(i),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1,this._focusedStickyElementIndex!==-1&&this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);else{const r=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];await this._updateState(i),this._stickyScrollWidget.lineNumberCount===0?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(r)||(this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1),this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}}_updateAndGetMinRebuildFromLine(e){if(e!==void 0){const t=this._minRebuildFromLine!==void 0?this._minRebuildFromLine:1/0;this._minRebuildFromLine=Math.min(e,t)}return this._minRebuildFromLine}async _updateState(e){var i;this._minRebuildFromLine=void 0,this._foldingModel=await((i=xm.get(this._editor))==null?void 0:i.getFoldingModel())??void 0,this._widgetState=this.findScrollWidgetState();const t=this._widgetState.startLineNumbers.length>0;this._stickyScrollVisibleContextKey.set(t),this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,e)}async _resetState(){this._minRebuildFromLine=void 0,this._foldingModel=void 0,this._widgetState=yx.Empty,this._stickyScrollVisibleContextKey.set(!1),this._stickyScrollWidget.setState(void 0,void 0)}findScrollWidgetState(){const e=Math.min(this._maxStickyLines,this._editor.getOption(131).maxLineCount),t=this._editor.getScrollTop();let i=0;const n=[],o=[],r=this._editor.getVisibleRanges();if(r.length!==0){const a=new Sx(r[0].startLineNumber,r[r.length-1].endLineNumber),l=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(a);for(const c of l){const d=c.startLineNumber,h=c.endLineNumber,u=c.top,f=u+c.height,g=this._editor.getTopForLineNumber(d)-t,m=this._editor.getBottomForLineNumber(h)-t;if(u>g&&u<=m&&(n.push(d),o.push(h+1),f>m&&(i=m-f)),n.length===e)break}}return this._endLineNumbers=o,new yx(n,o,i,this._showEndForLine)}dispose(){super.dispose(),this._sessionStore.dispose()}},n6=ib,ib.ID="store.contrib.stickyScrollController",ib);bc=n6=iXe([rC(1,sl),rC(2,We),rC(3,$e),rC(4,wn),rC(5,$l),rC(6,ut)],bc);const Lx=F("inlineEdit.originalBackground",Ct(yg,.2),_(1220,"Background color for the original text in inline edits."),!0),cue=F("inlineEdit.modifiedBackground",Ct(Kp,.3),_(1221,"Background color for the modified text in inline edits."),!0);F("inlineEdit.originalChangedLineBackground",Ct(yg,.8),_(1222,"Background color for the changed lines in the original text of inline edits."),!0);const nXe=F("inlineEdit.originalChangedTextBackground",Ct(yg,.8),_(1223,"Overlay color for the changed text in the original text of inline edits."),!0),sXe=F("inlineEdit.modifiedChangedLineBackground",{light:Ct(dD,.7),dark:Ct(dD,.7),hcDark:dD,hcLight:dD},_(1224,"Background color for the changed lines in the modified text of inline edits."),!0),oXe=F("inlineEdit.modifiedChangedTextBackground",Ct(Kp,.7),_(1225,"Overlay color for the changed text in the modified text of inline edits."),!0),rXe=F("inlineEdit.gutterIndicator.primaryForeground",GO,_(1226,"Foreground color for the primary inline edit gutter indicator.")),WC=F("inlineEdit.gutterIndicator.primaryBorder",Gp,_(1227,"Border color for the primary inline edit gutter indicator.")),due=F("inlineEdit.gutterIndicator.primaryBackground",{light:Ct(WC,.5),dark:Ct(WC,.4),hcDark:Ct(WC,.4),hcLight:Ct(WC,.5)},_(1228,"Background color for the primary inline edit gutter indicator.")),aXe=F("inlineEdit.gutterIndicator.secondaryForeground",Lre,_(1229,"Foreground color for the secondary inline edit gutter indicator.")),hue=F("inlineEdit.gutterIndicator.secondaryBorder",bR,_(1230,"Border color for the secondary inline edit gutter indicator.")),uue=F("inlineEdit.gutterIndicator.secondaryBackground",hue,_(1231,"Background color for the secondary inline edit gutter indicator.")),lXe=F("inlineEdit.gutterIndicator.successfulForeground",GO,_(1232,"Foreground color for the successful inline edit gutter indicator.")),fue=F("inlineEdit.gutterIndicator.successfulBorder",Gp,_(1233,"Border color for the successful inline edit gutter indicator.")),gue=F("inlineEdit.gutterIndicator.successfulBackground",fue,_(1234,"Background color for the successful inline edit gutter indicator.")),cXe=F("inlineEdit.gutterIndicator.background",{hcDark:Ct("tab.inactiveBackground",.5),hcLight:Ct("tab.inactiveBackground",.5),dark:Ct("tab.inactiveBackground",.5),light:"#5f5f5f18"},_(1235,"Background color for the inline edit gutter indicator.")),NS=F("inlineEdit.originalBorder",{light:yg,dark:yg,hcDark:yg,hcLight:yg},_(1236,"Border color for the original text in inline edits.")),RS=F("inlineEdit.modifiedBorder",{light:Pr(Kp,.6),dark:Kp,hcDark:Kp,hcLight:Kp},_(1237,"Border color for the modified text in inline edits.")),dXe=F("inlineEdit.tabWillAcceptModifiedBorder",{light:Pr(RS,0),dark:Pr(RS,0),hcDark:Pr(RS,0),hcLight:Pr(RS,0)},_(1238,"Modified border color for the inline edits widget when tab will accept it.")),hXe=F("inlineEdit.tabWillAcceptOriginalBorder",{light:Pr(NS,0),dark:Pr(NS,0),hcDark:Pr(NS,0),hcLight:Pr(NS,0)},_(1239,"Original border color for the inline edits widget over the original text when tab will accept it."));function PI(s){return s.map(e=>e===No.Accept?dXe:RS)}function H4(s){return s.map(e=>e===No.Accept?hXe:NS)}function fl(s,e){let t;typeof s=="string"?t=f3(s,e):t=s.map((n,o)=>f3(n,e).read(o));const i=f3(es,e);return t.map((n,o)=>n.makeOpaque(i.read(o)))}function f3(s,e){return loe({owner:{observeColor:s},equalsFn:(t,i)=>t.equals(i),debugName:()=>`observeColor(${s})`},e.onDidColorThemeChange,()=>{const t=e.getColorTheme().getColor(s);if(!t)throw new et(`Missing color: ${s}`);return t})}function Mg(s,e,t){s.layoutInfo.read(t),s.value.read(t);const i=s.model.read(t);if(!i)return 0;let n=0;s.scrollTop.read(t);for(let r=e.startLineNumber;r<e.endLineNumberExclusive;r++){const a=i.getLineMaxColumn(r);let l=s.editor.getOffsetForColumn(r,a);if(l===-1){const c=s.editor.getOption(59).typicalHalfwidthCharacterWidth;l=a*c}n=Math.max(n,l)}const o=e.mapToLineArray(r=>i.getLineContent(r));return n<5&&o.some(r=>r.length>0)&&i.uri.scheme!=="file"&&console.error("unexpected width"),n}function uXe(s,e,t){return s.layoutInfo.read(t),s.value.read(t),s.model.read(t)?(s.scrollTop.read(t),s.editor.getOffsetForColumn(e.lineNumber,e.column)):0}function xj(s,e,t,i,n=void 0){const o=i.getModel();if(!o)return{prefixTrim:0,prefixLeftOffset:0};const r=s.map(u=>u.isSingleLine()?u.startColumn-1:0),a=e.mapToLineArray(u=>s7(o.getLineContent(u))),l=t.filter(u=>u!=="").map(u=>s7(u)),c=Math.min(...r,...a,...l);let d;if(o.getLineIndentColumn(e.startLineNumber)>=c+1)bn(i).scrollTop.read(n),d=i.getOffsetForColumn(e.startLineNumber,c+1);else if(t.length>0)d=Lj(t[0].slice(0,c),i,o);else return{prefixTrim:0,prefixLeftOffset:0};return{prefixTrim:c,prefixLeftOffset:d}}function Lj(s,e,t){const i=e.getOption(59).typicalHalfwidthCharacterWidth,n=t.getOptions().tabSize*i,o=s.split("	").length-1;return(s.length-o)*i+o*n}function Ij(s){const e=s.layoutInfoContentLeft,t=ae({name:"editor.validOverlay.width"},n=>{const o=s.layoutInfoMinimap.read(n).minimapLeft!==0,r=s.layoutInfoWidth.read(n)-e.read(n);if(o){const a=s.layoutInfoMinimap.read(n).minimapWidth+s.layoutInfoVerticalScrollbarWidth.read(n);return r-a}return r}),i=ae({name:"editor.validOverlay.height"},n=>s.layoutInfoHeight.read(n)+s.contentHeight.read(n));return ae({name:"editor.validOverlay"},n=>Wi.fromLeftTopWidthHeight(e.read(n),0,t.read(n),i.read(n)))}function fXe(s,e){const t=[];for(const i of s){const n=e.mapRange(i.modifiedRange);t.push(new fr(i.originalRange,n))}return t}function g3(...s){return s.filter(e=>typeof e=="string").join(" ")}function gXe(s,e){return new D(e.lineNumber,e.column+s.start,e.lineNumber,e.column+s.endExclusive)}function mXe(s,e){let t=0;e:for(let i=0,n=s.length;i<n;i++)switch(s.charCodeAt(i)){case 9:t+=e;break;case 32:t++;break;default:break e}return t-t%e}function pXe(s,e,t){let i=e-e%t,n=0;for(;n<s.length&&i!==0;n++)switch(s.charCodeAt(n)){case 9:i-=t;break;case 32:i--;break;default:throw new et("Unexpected character found while calculating indent length")}return n}function _Xe(s,e,t){const i=fa(s),n=[],o=cae(e.mapToLineArray(r=>mXe(i[r-1],t)),aa);return e.forEach(r=>{const a=pXe(i[r-1],o,t);n.push(new os(gXe(new Ue(0,a),new z(r,1)),""))}),new ra(n)}class s6{constructor(){this._data=""}moveTo(e){return this._data+=`M ${e.x} ${e.y} `,this}lineTo(e){return this._data+=`L ${e.x} ${e.y} `,this}build(){return this._data}}function Rh(s){const e=Ef(void 0,(t,i)=>s.read(t)||i);return _o({debugName:()=>`${s.debugName}.mapOutFalsy`},t=>{if(e.read(t),!!s.read(t))return e})}function Ll(s,e=Ls.ofCaller()){return{left:ae({name:"editor.validOverlay.left"},t=>s(t).left,e),top:ae({name:"editor.validOverlay.top"},t=>s(t).top,e),width:ae({name:"editor.validOverlay.width"},t=>s(t).right-s(t).left,e),height:ae({name:"editor.validOverlay.height"},t=>s(t).bottom-s(t).top,e)}}var bXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},m3=function(s,e){return function(t,i){e(t,i,s)}};let o6=class{constructor(e,t,i,n,o,r){this._model=e,this._close=t,this._editorObs=i,this._contextKeyService=n,this._keybindingService=o,this._commandService=r,this._inlineEditsShowCollapsed=this._editorObs.getOption(71).map(a=>a.edits.showCollapsed)}toDisposableLiveElement(){return this._createHoverContent().toDisposableLiveElement()}_createHoverContent(){const e=ht("active",void 0),t=u=>({title:u.title,icon:u.icon,keybinding:typeof u.commandId=="string"?this._getKeybinding(u.commandArgs?void 0:u.commandId):ae(this,f=>typeof u.commandId=="string"?void 0:this._getKeybinding(u.commandArgs?void 0:u.commandId.read(f)).read(f)),isActive:e.map(f=>f===u.id),onHoverChange:f=>e.set(f?u.id:void 0,void 0),onAction:()=>(this._close(!0),this._commandService.executeCommand(typeof u.commandId=="string"?u.commandId:u.commandId.get(),...u.commandArgs??[]))}),i=CXe(this._model.displayName),n=Xm(t({id:"gotoAndAccept",title:`${_(1212,"Go To")} / ${_(1213,"Accept")}`,icon:ge.check,commandId:_I})),o=Xm(t({id:"reject",title:_(1214,"Reject"),icon:ge.close,commandId:lde})),r=this._model.extensionCommands.map((u,f)=>Xm(t({id:u.command.id+"_"+f,title:u.command.title,icon:u.icon??ge.symbolEvent,commandId:u.command.id,commandArgs:u.command.arguments}))),a=this._inlineEditsShowCollapsed.map(u=>Xm(t(u?{id:"showExpanded",title:_(1215,"Show Expanded"),icon:ge.expandAll,commandId:CW}:{id:"showCollapsed",title:_(1216,"Show Collapsed"),icon:ge.collapseAll,commandId:CW}))),l=Xm(t({id:"snooze",title:_(1217,"Snooze"),icon:ge.bellSlash,commandId:"editor.action.inlineSuggest.snooze"})),c=Xm(t({id:"settings",title:_(1218,"Settings"),icon:ge.gear,commandId:"workbench.action.openSettings",commandArgs:["@tag:nextEditSuggestions"]})),d=this._model.action?[this._model.action]:[],h=d.length>0?wXe(d.map(u=>({id:u.id,label:u.title+"...",enabled:!0,run:()=>this._commandService.executeCommand(u.id,...u.arguments??[]),class:void 0,tooltip:u.tooltip??u.title})),{hoverDelegate:O6e}):void 0;return vXe([i,n,o,a,r.length?wee():void 0,l,c,...r,h?wee():void 0,h])}_getKeybinding(e){return e?fi(this._contextKeyService.onDidChangeContext,()=>this._keybindingService.lookupKeybinding(e)):Gi(void 0)}};o6=bXe([m3(3,ut),m3(4,ai),m3(5,en)],o6);function vXe(s){return kt.div({class:"content",style:{margin:4,minWidth:180}},s)}function CXe(s){return kt.div({class:"header",style:{color:ve(pre),fontSize:"13px",fontWeight:"600",padding:"0 4px",lineHeight:28}},[s])}function Xm(s){return ae({name:"inlineEdits.option"},e=>{var t;return kt.div({class:["monaco-menu-option",(t=s.isActive)==null?void 0:t.map(i=>i&&"active")],onmouseenter:()=>{var i;return(i=s.onHoverChange)==null?void 0:i.call(s,!0)},onmouseleave:()=>{var i;return(i=s.onHoverChange)==null?void 0:i.call(s,!1)},onclick:s.onAction,onkeydown:i=>{var n;i.key==="Enter"&&((n=s.onAction)==null||n.call(s))},tabIndex:0,style:{borderRadius:3}},[kt.elem("span",{style:{fontSize:16,display:"flex"}},[it.isThemeIcon(s.icon)?fd(s.icon):s.icon.map(i=>fd(i))]),kt.elem("span",{},[s.title]),kt.div({style:{marginLeft:"auto"},ref:i=>{const n=e.store.add(new v0(i,sa,{disableTitle:!0,...ace,keybindingLabelShadow:void 0,keybindingLabelForeground:ve(pre),keybindingLabelBackground:"transparent",keybindingLabelBorder:"transparent",keybindingLabelBottomBorder:void 0}));e.store.add(lt(o=>{n.set(s.keybinding.read(o))}))}})])})}function wXe(s,e){return ae({name:"inlineEdits.actionBar"},t=>kt.div({class:["action-widget-action-bar"],style:{padding:"3px 24px"}},[kt.div({ref:i=>{t.store.add(new Fr(i,e)).push(s,{icon:!1,label:!0})}})]))}function wee(){return kt.div({id:"inline-edit-gutter-indicator-menu-separator",class:"menu-separator",style:{color:ve(JAe),padding:"2px 0"}},kt.div({style:{borderBottom:`1px solid ${ve(r$)}`}}))}var yXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},oT=function(s,e){return function(t,i){e(t,i,s)}};let r6=class extends K{get model(){const e=this._model.get();if(!e)throw new et("Inline Edit Model not available");return e}constructor(e,t,i,n,o,r,a,l,c,d){super(),this._editorObs=e,this._originalRange=t,this._verticalOffset=i,this._model=n,this._isHoveringOverInlineEdit=o,this._focusIsInMenu=r,this._hoverService=a,this._instantiationService=l,this._accessibilityService=c,this._tabAction=ae(this,h=>{const u=this._model.read(h);return u?u.tabAction.read(h):No.Inactive}),this._hoverVisible=ht(this,!1),this.isHoverVisible=this._hoverVisible,this._isHoveredOverIcon=ht(this,!1),this._isHoveredOverIconDebounced=JG(this._isHoveredOverIcon,100),this.isHoveredOverIcon=this._isHoveredOverIconDebounced,this._isHoveredOverInlineEditDebounced=JG(this._isHoveringOverInlineEdit,100),this._gutterIndicatorStyles=this._tabAction.map(this,(h,u)=>{switch(h){case No.Inactive:return{background:fl(uue,d).read(u).toString(),foreground:fl(aXe,d).read(u).toString(),border:fl(hue,d).read(u).toString()};case No.Jump:return{background:fl(due,d).read(u).toString(),foreground:fl(rXe,d).read(u).toString(),border:fl(WC,d).read(u).toString()};case No.Accept:return{background:fl(gue,d).read(u).toString(),foreground:fl(lXe,d).read(u).toString(),border:fl(fue,d).read(u).toString()};default:nk()}}),this._originalRangeObs=Rh(this._originalRange),this._state=ae(this,h=>{const u=this._originalRangeObs.read(h);if(u)return{range:u,lineOffsetRange:this._editorObs.observeLineOffsetRange(u,h.store)}}),this._stickyScrollController=bc.get(this._editorObs.editor),this._stickyScrollHeight=this._stickyScrollController?fi(this._stickyScrollController.onDidChangeStickyScrollHeight,()=>this._stickyScrollController.stickyScrollWidgetHeight):Gi(0),this._lineNumberToRender=ae(this,h=>{var g;if(this._verticalOffset.read(h)!==0)return"";const u=(g=this._originalRange.read(h))==null?void 0:g.startLineNumber,f=this._editorObs.getOption(76).read(h);if(u===void 0||f.renderType===0)return"";if(f.renderType===3){const m=this._editorObs.cursorPosition.read(h);return u%10===0||m&&m.lineNumber===u?u.toString():""}if(f.renderType===2){const m=this._editorObs.cursorPosition.read(h);if(!m)return"";const p=Math.abs(u-m.lineNumber);return p===0?u.toString():p.toString()}return f.renderType===4?f.renderFn?f.renderFn(u):"":u.toString()}),this._availableWidthForIcon=ae(this,h=>{const u=this._editorObs.editor.getModel(),f=this._editorObs.editor,g=this._editorObs.layoutInfo.read(h),m=g.decorationsLeft+g.decorationsWidth-g.glyphMarginLeft;if(!u||m<=0)return()=>0;if(g.lineNumbersLeft===0)return()=>m;const p=this._editorObs.getOption(76).read(h);if(p.renderType===2||p.renderType===0)return()=>m;const v=f.getOption(59).typicalHalfwidthCharacterWidth,b=g.lineNumbersLeft+g.lineNumbersWidth,C=(u.getLineCount()+1).toString().length,y=[];for(let x=1;x<=C;x++){const S=10**(x-1),L=f.getTopForLineNumber(S),E=x*v,M=Math.min(m,Math.max(0,b-E-g.glyphMarginLeft));y.push({firstLineNumberWithDigitCount:S,topOfLineNumber:L,usableWidthLeftOfLineNumber:M})}return x=>{for(let S=y.length-1;S>=0;S--)if(x>=y[S].topOfLineNumber)return y[S].usableWidthLeftOfLineNumber;throw new et("Could not find avilable width for icon")}}),this._layout=ae(this,h=>{const u=this._state.read(h);if(!u)return;const f=this._editorObs.layoutInfo.read(h),g=this._editorObs.observeLineHeightForLine(u.range.map(Y=>Y.startLineNumber)).read(h),m=2,p=f.decorationsLeft+f.decorationsWidth-f.glyphMarginLeft-2*m,v=f.height-2*m,b=Wi.fromLeftTopWidthHeight(m,m,p,v),w=b.withTop(this._stickyScrollHeight.read(h)),C=b.withTop(w.top+m),y=u.lineOffsetRange.read(h),x=Wi.fromRanges(Ue.fromTo(C.left,C.right),y),S=g,L=this._verticalOffset.read(h),E=x.withHeight(S).translateY(L),M=w.containsRect(E),R=this._tabAction.map(Y=>Y===No.Accept?ge.keyboardTab:ge.arrowRight),T=ae(this,Y=>{if(this._isHoveredOverIconDebounced.read(Y)||this._isHoveredOverInlineEditDebounced.read(Y))return ge.check;if(this._tabAction.read(Y)===No.Accept)return ge.keyboardTab;const se=this._editorObs.cursorLineNumber.read(Y)??0,j=u.range.read(Y).startLineNumber;return se<=j?ge.keyboardTabAbove:ge.keyboardTabBelow}),A=22,N=16,P=Y=>{const se=this._availableWidthForIcon.read(void 0)(Y.bottom+this._editorObs.editor.getScrollTop())-m;return Math.max(Math.min(se,A),N)};if(M){const Y=E;let se;f.lineNumbersWidth===0?se=Math.min(Math.max(f.lineNumbersLeft-b.left,0),Y.width-A):se=Math.max(f.lineNumbersLeft+f.lineNumbersWidth-b.left,0);const j=Y.withWidth(se),ie=Math.max(Math.min(f.decorationsWidth,A),N),te=Y.withWidth(ie).translateX(se);return{gutterEditArea:x,icon:T,iconDirection:"right",iconRect:te,pillRect:Y,lineNumberRect:j}}const W=b.intersect(x);if(W&&W.height>=S){const Y=E.moveToBeContainedIn(C).moveToBeContainedIn(W),se=Y.withWidth(P(Y));return{gutterEditArea:x,icon:T,iconDirection:"right",iconRect:se,pillRect:se}}const G=E.moveToBeContainedIn(b),V=G.withWidth(P(G)),U=V,$=V.top<E.top?"top":"bottom";return{gutterEditArea:x,icon:R,iconDirection:$,iconRect:U,pillRect:V}}),this._iconRef=kt.ref(),this.isVisible=this._layout.map(h=>!!h),this._indicator=kt.div({class:"inline-edits-view-gutter-indicator",onclick:()=>{const h=this._layout.get(),u=(h==null?void 0:h.icon.get())===ge.check;this._editorObs.editor.focus(),u?this.model.accept():this.model.jump()},tabIndex:0,style:{position:"absolute",overflow:"visible"}},Rh(this._layout).map(h=>h?[kt.div({style:{position:"absolute",background:ve(cXe),borderRadius:"4px",...Ll(u=>h.read(u).gutterEditArea)}}),kt.div({class:"icon",ref:this._iconRef,onmouseenter:()=>{this._showHover()},style:{cursor:"pointer",zIndex:"20",position:"absolute",backgroundColor:this._gutterIndicatorStyles.map(u=>u.background),"--vscodeIconForeground":this._gutterIndicatorStyles.map(u=>u.foreground),border:this._gutterIndicatorStyles.map(u=>`1px solid ${u.border}`),boxSizing:"border-box",borderRadius:"4px",display:"flex",justifyContent:"flex-end",transition:"background-color 0.2s ease-in-out, width 0.2s ease-in-out",...Ll(u=>h.read(u).pillRect)}},[kt.div({className:"line-number",style:{lineHeight:h.map(u=>u.lineNumberRect?u.lineNumberRect.height:0),display:h.map(u=>u.lineNumberRect?"flex":"none"),alignItems:"center",justifyContent:"flex-end",width:h.map(u=>u.lineNumberRect?u.lineNumberRect.width:0),height:"100%",color:this._gutterIndicatorStyles.map(u=>u.foreground)}},this._lineNumberToRender),kt.div({style:{rotate:h.map(u=>`${SXe(u.iconDirection)}deg`),transition:"rotate 0.2s ease-in-out",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginRight:h.map(u=>{var f;return u.pillRect.width-u.iconRect.width-(((f=u.lineNumberRect)==null?void 0:f.width)??0)}),width:h.map(u=>u.iconRect.width)}},[h.map((u,f)=>fd(u.icon.read(f)))])])]:[])).keepUpdated(this._store),this._register(this._editorObs.createOverlayWidget({domNode:this._indicator.element,position:Gi(null),allowEditorOverflow:!1,minContentWidthInPx:Gi(0)})),this._register(this._editorObs.editor.onMouseMove(h=>{if(this._state.get()===void 0)return;const g=this._iconRef.element.getBoundingClientRect(),m=Wi.fromLeftTopWidthHeight(g.left,g.top,g.width,g.height),p=new Ms(h.event.posx,h.event.posy);this._isHoveredOverIcon.set(m.containsPoint(p),void 0)})),this._register(this._editorObs.editor.onDidScrollChange(()=>{this._isHoveredOverIcon.set(!1,void 0)})),this._register(rd(this._isHoveredOverInlineEditDebounced,h=>{h&&this.triggerAnimation()})),this._register(lt(h=>{this._indicator.readEffect(h),this._indicator.element&&this._editorObs.editor.applyFontInfo(this._indicator.element)}))}triggerAnimation(){return this._accessibilityService.isMotionReduced()?new Animation(null,null).finished:this._iconRef.element.animate([{outline:`2px solid ${this._gutterIndicatorStyles.map(t=>t.border).get()}`,outlineOffset:"-1px",offset:0},{outline:"2px solid transparent",outlineOffset:"10px",offset:1}],{duration:500}).finished}_showHover(){if(this._hoverVisible.get())return;const e=new oe,t=e.add(this._instantiationService.createInstance(o6,this.model,o=>{o&&this._editorObs.editor.focus(),n==null||n.dispose()},this._editorObs).toDisposableLiveElement()),i=e.add(Ol(t.element));e.add(i.onDidBlur(()=>this._focusIsInMenu.set(!1,void 0))),e.add(i.onDidFocus(()=>this._focusIsInMenu.set(!0,void 0))),e.add(Ve(()=>this._focusIsInMenu.set(!1,void 0)));const n=this._hoverService.showInstantHover({target:this._iconRef.element,content:t.element});n?(this._hoverVisible.set(!0,void 0),e.add(this._editorObs.editor.onDidScrollChange(()=>n.dispose())),e.add(n.onDispose(()=>{this._hoverVisible.set(!1,void 0),e.dispose()}))):e.dispose()}};r6=yXe([oT(6,Sr),oT(7,$e),oT(8,so),oT(9,Dn)],r6);function SXe(s){switch(s){case"top":return 90;case"bottom":return-90;case"right":return 0}}var xXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yee=function(s,e){return function(t,i){e(t,i,s)}},Ea;(function(s){s.FirstTime="firstTime",s.SecondTime="secondTime",s.Active="active"})(Ea||(Ea={}));let a6=class extends K{constructor(e,t,i,n,o,r){super(),this._host=e,this._model=t,this._indicator=i,this._collapsedView=n,this._storageService=o,this._configurationService=r,this._disposables=this._register(new mi),this._setupDone=ht({name:"setupDone"},!1),this._activeCompletionId=ae(a=>{const l=this._model.read(a);if(!l||!this._setupDone.read(a))return;const c=this._indicator.read(a);if(!(!c||!c.isVisible.read(a)))return l.inlineEdit.inlineCompletion.identity.id}),this._register(this._initializeDebugSetting()),this._disposables.value=this.setupNewUserExperience(),this._setupDone.set(!0,void 0)}setupNewUserExperience(){if(this.getNewUserType()===Ea.Active)return;const e=new oe;let t=!1,i=!1,n=0,o=0;return e.add(w5e(this._activeCompletionId,async(r,a,l,c)=>{var h,u;if(r===void 0)return;let d=this.getNewUserType();switch(d){case Ea.FirstTime:{(n++>=5||t)&&(d=Ea.SecondTime,this.setNewUserType(d));break}case Ea.SecondTime:{o++>=3&&i&&(d=Ea.Active,this.setNewUserType(d));break}}switch(d){case Ea.FirstTime:{for(let f=0;f<3&&!c.isCancellationRequested;f++)await((h=this._indicator.get())==null?void 0:h.triggerAnimation()),await Sh(500);break}case Ea.SecondTime:{(u=this._indicator.get())==null||u.triggerAnimation();break}}})),e.add(lt(r=>{this._collapsedView.isVisible.read(r)&&this.getNewUserType()!==Ea.Active&&this._collapsedView.triggerAnimation()})),e.add(Ao((r,a)=>{const l=this._indicator.read(r);l&&a.add(rd(l.isHoveredOverIcon,async c=>{c&&(t=!0)}))})),e.add(Ao((r,a)=>{const l=this._host.read(r);l&&a.add(l.onDidAccept(()=>{i=!0}))})),e}getNewUserType(){return this._storageService.get("inlineEditsGutterIndicatorUserKind",-1,Ea.FirstTime)}setNewUserType(e){switch(e){case Ea.FirstTime:throw new et("UserKind should not be set to first time");case Ea.SecondTime:break;case Ea.Active:this._disposables.clear();break}this._storageService.store("inlineEditsGutterIndicatorUserKind",e,-1,0)}_initializeDebugSetting(){const e="editor.inlineSuggest.edits.resetNewUserExperience";return this._configurationService.getValue(e)&&this._storageService.remove("inlineEditsGutterIndicatorUserKind",-1),this._configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(e)&&this._configurationService.getValue(e)&&(this._storageService.remove("inlineEditsGutterIndicatorUserKind",-1),this._disposables.value=this.setupNewUserExperience())})}};a6=xXe([yee(4,sr),yee(5,xt)],a6);var LXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},IXe=function(s,e){return function(t,i){e(t,i,s)}};let l6=class extends K{constructor(e,t,i){super(),this._editor=e,this._edit=t,this._accessibilityService=i,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._iconRef=kt.ref(),this.isHovered=Gi(!1),this._editorObs=bn(this._editor);const o=this._edit.map(c=>(c==null?void 0:c.edit.replacements[0])??null).map(c=>c?Wu(c,this._editor.getModel()).range.getStartPosition():null),r=this._editorObs.observePosition(o,this._store),a=ae(c=>{const d=r.read(c);if(!d)return null;const h=this._editorObs.layoutInfoContentLeft.read(c),u=this._editorObs.scrollLeft.read(c);return new Ms(h+d.x-u,d.y)}),l=kt.div({class:"inline-edits-collapsed-view",style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",display:"block"}},[[this.getCollapsedIndicator(a)]]).keepUpdated(this._store).element;this._register(this._editorObs.createOverlayWidget({domNode:l,position:Gi(null),allowEditorOverflow:!1,minContentWidthInPx:Gi(0)})),this.isVisible=this._edit.map((c,d)=>!!c&&a.read(d)!==null)}triggerAnimation(){return this._accessibilityService.isMotionReduced()?new Animation(null,null).finished:this._iconRef.element.animate([{offset:0,transform:"translateY(-3px)"},{offset:.2,transform:"translateY(1px)"},{offset:.36,transform:"translateY(-1px)"},{offset:.52,transform:"translateY(1px)"},{offset:.68,transform:"translateY(-1px)"},{offset:.84,transform:"translateY(1px)"},{offset:1,transform:"translateY(0px)"}],{duration:2e3}).finished}getCollapsedIndicator(e){const t=this._editorObs.layoutInfoContentLeft,i=e.map((o,r)=>o?o.deltaX(-t.read(r)):null),n=this.createIconPath(i);return kt.svg({class:"collapsedView",ref:this._iconRef,style:{position:"absolute",...Ll(o=>Ij(this._editorObs).read(o)),overflow:"hidden",pointerEvents:"none"}},[kt.svgElem("path",{class:"collapsedViewPath",d:n,fill:ve(WC)})])}createIconPath(e){return e.map(o=>{if(!o)return new s6().build();const r=o.deltaX(-6/2).deltaY(-1),a=r.deltaX(6),l=r.deltaY(1),c=a.deltaY(1),d=l.deltaX(6/2).deltaY(3);return new s6().moveTo(r).lineTo(a).lineTo(c).lineTo(d).lineTo(l).lineTo(r).build()})}};l6=LXe([IXe(2,so)],l6);var EXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},See=function(s,e){return function(t,i){e(t,i,s)}};const rT=14,p3=0,Zh=4,aT=4,xee=2;let c6=class extends K{constructor(e,t,i,n,o){super(),this._editor=e,this._languageService=o,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._isHovered=ht(this,!1),this.isHovered=this._isHovered,this._viewRef=kt.ref(),this._editorObs=bn(this._editor);const r=i.map((d,h)=>{let u;switch(d){case No.Inactive:u=uue;break;case No.Jump:u=due;break;case No.Accept:u=gue;break}return{border:fl(u,n).read(h).toString(),background:ve(es)}}),a=t.map(d=>d?this.getState(d):void 0),l=a.map(d=>d?this.getRendering(d,r):void 0);this.minEditorScrollHeight=ae(this,d=>{const h=a.read(d);return h?h.rect.read(d).bottom+this._editor.getScrollTop():0});const c=kt.div({class:"inline-edits-custom-view",style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",display:"block"}},[l]).keepUpdated(this._store);this._register(this._editorObs.createOverlayWidget({domNode:c.element,position:Gi(null),allowEditorOverflow:!1,minContentWidthInPx:Ef(this,(d,h)=>{const u=a.read(d);if(!u)return h??0;const f=u.rect.map(g=>g.right).read(d)+this._editorObs.layoutInfoVerticalScrollbarWidth.read(d)+Zh-this._editorObs.layoutInfoContentLeft.read(d);return Math.max(h??0,f)}).recomputeInitiallyAndOnChange(this._store)})),this._register(lt(d=>{if(!l.read(d)){this._isHovered.set(!1,void 0);return}this._isHovered.set(c.isHovered.read(d),void 0)}))}fitsInsideViewport(e,t,i){const n=this._editorObs.layoutInfoWidth.read(i),o=this._editorObs.layoutInfoContentLeft.read(i),r=this._editor.getLayoutInfo().verticalScrollbarWidth,a=this._editorObs.layoutInfoMinimap.read(i).minimapLeft!==0?this._editorObs.layoutInfoMinimap.read(i).minimapWidth:0,l=Mg(this._editorObs,e,void 0),c=Lj(t,this._editor,this._editor.getModel()),d=Zh+rT;return l+c+d<n-o-r-a}getState(e){const t=ae(this,a=>{var b;const l=e.range.startLineNumber,c=e.range.endLineNumber,d=e.range.startColumn,h=e.range.endColumn,u=((b=this._editor.getModel())==null?void 0:b.getLineCount())??0,f=Mg(this._editorObs,new dt(l,l+1),a),g=l+1<=u?Mg(this._editorObs,new dt(l+1,l+2),a):void 0,m=l-1>=1?Mg(this._editorObs,new dt(l-1,l),a):void 0,p=this._editor.getOffsetForColumn(l,d),v=this._editor.getOffsetForColumn(c,h);return{lineWidth:f,lineWidthBelow:g,lineWidthAbove:m,startContentLeftOffset:p,endContentLeftOffset:v}}),i=e.range.startLineNumber,n=e.range.endLineNumber,o=this.fitsInsideViewport(new dt(i,n+1),e.content,void 0);return{rect:ae(this,a=>{const l=this._editorObs.getOption(59).read(a).typicalHalfwidthCharacterWidth,{lineWidth:c,lineWidthBelow:d,lineWidthAbove:h,startContentLeftOffset:u,endContentLeftOffset:f}=t.read(a),g=this._editorObs.layoutInfoContentLeft.read(a),m=this._editorObs.observeLineHeightForLine(i).recomputeInitiallyAndOnChange(a.store).read(a),p=this._editorObs.scrollTop.read(a),v=this._editorObs.scrollLeft.read(a);let b;i===n&&f+5*l>=c&&o?b="end":d!==void 0&&d+rT-aT-Zh<u?b="below":h!==void 0&&h+rT-aT-Zh<u?b="above":b="end";let w,C,y=0,x=0;switch(b){case"end":{w=this._editorObs.editor.getTopForLineNumber(i),C=c,y=Zh+rT;break}case"below":{w=this._editorObs.editor.getTopForLineNumber(i+1),C=u,y=Zh+aT,x=p3+xee;break}case"above":{w=this._editorObs.editor.getTopForLineNumber(i-1),C=u,y=Zh+aT,x=-p3+xee;break}}return Wi.fromLeftTopWidthHeight(g+C-v,w-p,l*e.content.length,m).withMargin(p3,Zh).translateX(y).translateY(x)}),label:e.content,kind:e.style}}getRendering(e,t){var l;const i=document.createElement("div"),n=(l=this._editor.getModel().tokenization.tokenizeLinesAt(1,[e.label]))==null?void 0:l[0];let o;n&&e.kind===EB.Code?o=Zu.fromLineTokens(n).toLineTokens(e.label,this._languageService.languageIdCodec):o=qn.createEmpty(e.label,this._languageService.languageIdCodec);const r=Dk(new Tk([o]),nf.fromEditor(this._editor).withSetWidth(!1).withScrollBeyondLastColumn(0),[],i,!0);i.style.width=`${r.minWidthInPx}px`;const a=e.rect.map(c=>c.withMargin(0,Zh));return kt.div({class:"collapsedView",ref:this._viewRef,style:{position:"absolute",...Ll(c=>a.read(c)),overflow:"hidden",boxSizing:"border-box",cursor:"pointer",border:t.map(c=>`1px solid ${c.border}`),borderRadius:"4px",backgroundColor:t.map(c=>c.background),display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap"},onmousedown:c=>{c.preventDefault()},onclick:c=>{this._onDidClick.fire(new Co(je(c),c))}},[i])}};c6=EXe([See(3,Dn),See(4,Wn)],c6);const kXe=0,DXe=0,_3=1,TXe=1,NXe=3,b3=4;class RXe extends K{constructor(e,t,i,n){super(),this._editor=e,this._edit=t,this._uiState=i,this._tabAction=n,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._display=ae(this,a=>this._uiState.read(a)?"block":"none"),this._editorMaxContentWidthInRange=ae(this,a=>{const l=this._originalDisplayRange.read(a);return l?(this._editorObs.versionId.read(a),Ef(this,(c,d)=>{const h=Mg(this._editorObs,l,c);return Math.max(h,d??0)})):Gi(0)}).map((a,l)=>a.read(l)),this._maxPrefixTrim=ae(this,a=>{const l=this._uiState.read(a);return l?xj(l.deletions,l.originalRange,[],this._editor):{prefixTrim:0,prefixLeftOffset:0}}),this._editorLayoutInfo=ae(this,a=>{const l=this._edit.read(a);if(!l||!this._uiState.read(a))return null;const d=this._editorObs.layoutInfo.read(a),h=this._editorObs.scrollLeft.read(a),u=this._editorObs.getOption(59).map(w=>w.typicalHalfwidthCharacterWidth).read(a),f=d.contentLeft+Math.max(this._editorMaxContentWidthInRange.read(a),u)-h,g=l.originalLineRange,m=this._originalVerticalStartPosition.read(a)??this._editor.getTopForLineNumber(g.startLineNumber)-this._editorObs.scrollTop.read(a),p=this._originalVerticalEndPosition.read(a)??this._editor.getTopForLineNumber(g.endLineNumberExclusive)-this._editorObs.scrollTop.read(a),v=d.contentLeft+this._maxPrefixTrim.read(a).prefixLeftOffset-h;return f<=v?null:{codeRect:Wi.fromLeftTopRightBottom(v,m,f,p).withMargin(DXe,kXe),contentLeft:d.contentLeft}}).recomputeInitiallyAndOnChange(this._store),this._originalOverlay=kt.div({style:{pointerEvents:"none"}},ae(this,a=>{const l=Rh(this._editorLayoutInfo).read(a);if(!l)return;const c=l.map(f=>Wi.fromLeftTopRightBottom(f.contentLeft-b3-_3,f.codeRect.top,f.contentLeft,f.codeRect.bottom)),d=ae(this,f=>{const g=l.read(f).codeRect,m=c.read(f);return g.intersectHorizontal(new Ue(m.left,Number.MAX_SAFE_INTEGER))}),h=this._uiState.map(f=>f!=null&&f.inDiffEditor?NXe:TXe).read(a),u=d.map(f=>f.withMargin(h,h));return[kt.div({class:"originalSeparatorDeletion",style:{...u.read(a).toStyles(),borderRadius:`${b3}px`,border:`${_3+h}px solid ${ve(es)}`,boxSizing:"border-box"}}),kt.div({class:"originalOverlayDeletion",style:{...d.read(a).toStyles(),borderRadius:`${b3}px`,border:H4(this._tabAction).map(f=>`${_3}px solid ${ve(f)}`),boxSizing:"border-box",backgroundColor:ve(Lx)}}),kt.div({class:"originalOverlayHiderDeletion",style:{...c.read(a).toStyles(),backgroundColor:ve(es)}})]})).keepUpdated(this._store),this._nonOverflowView=kt.div({class:"inline-edits-view",style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",display:this._display}},[[this._originalOverlay]]).keepUpdated(this._store),this.isHovered=Gi(!1),this._editorObs=bn(this._editor);const o=ae(this,a=>{const l=this._edit.read(a);return l?new z(l.originalLineRange.startLineNumber,1):null}),r=ae(this,a=>{const l=this._edit.read(a);return l?new z(l.originalLineRange.endLineNumberExclusive,1):null});this._originalDisplayRange=this._uiState.map(a=>a==null?void 0:a.originalRange),this._originalVerticalStartPosition=this._editorObs.observePosition(o,this._store).map(a=>a==null?void 0:a.y),this._originalVerticalEndPosition=this._editorObs.observePosition(r,this._store).map(a=>a==null?void 0:a.y),this._register(this._editorObs.createOverlayWidget({domNode:this._nonOverflowView.element,position:Gi(null),allowEditorOverflow:!1,minContentWidthInPx:ae(this,a=>{const l=this._editorLayoutInfo.read(a);return l===null?0:l.codeRect.width})}))}}var MXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Lee=function(s,e){return function(t,i){e(t,i,s)}};const sS=1,AXe=1,PXe=3,v3=4;let d6=class extends K{constructor(e,t,i,n,o){super(),this._editor=e,this._input=t,this._tabAction=i,this._languageService=o,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._state=ae(this,r=>{const a=this._input.read(r);if(!a)return;const l=this._editor.getModel(),c=l.getEOL();if(a.startColumn===1&&a.lineNumber>1&&l.getLineLength(a.lineNumber)!==0&&a.text.endsWith(c)&&!a.text.startsWith(c)){const d=l.getLineLength(a.lineNumber-1)+1;return{lineNumber:a.lineNumber-1,column:d,text:c+a.text.slice(0,-c.length)}}return{lineNumber:a.lineNumber,column:a.startColumn,text:a.text}}),this._trimVertically=ae(this,r=>{const a=this._state.read(r),l=a==null?void 0:a.text;if(!l||l.trim()==="")return{topOffset:0,bottomOffset:0,linesTop:0,linesBottom:0};const c=this._editor.getLineHeightForPosition(new z(a.lineNumber,1)),d=this._editor.getModel().getEOL();let h=0,u=0,f=0;for(;f<l.length&&l.startsWith(d,f);f+=d.length)h+=1;for(let g=l.length;g>f&&l.endsWith(d,g);g-=d.length)u+=1;return{topOffset:h*c,bottomOffset:u*c,linesTop:h,linesBottom:u}}),this._maxPrefixTrim=ae(this,r=>{const a=this._state.read(r);if(!a)return{prefixLeftOffset:0,prefixTrim:0};const l=this._editor.getModel(),c=l.getEOL(),d=this._trimVertically.read(r),h=a.text.split(c),u=h.slice(d.linesTop,h.length-d.linesBottom);d.linesTop===0&&(u[0]=l.getLineContent(a.lineNumber)+u[0]);const f=new dt(a.lineNumber,a.lineNumber+(d.linesTop>0?0:1));return xj([],f,u,this._editor)}),this._ghostText=ae(r=>{const a=this._state.read(r),l=this._maxPrefixTrim.read(r);if(!a)return;const d=this._editor.getModel().getEOL(),u=a.text.split(d).map((f,g)=>new __(new D(g+1,g===0?1:l.prefixTrim+1,g+1,f.length+1),"modified-background",0));return new NI(a.lineNumber,[new rM(a.column,a.text,!1,u)])}),this._display=ae(this,r=>this._state.read(r)?"block":"none"),this._editorMaxContentWidthInRange=ae(this,r=>{const a=this._state.read(r);if(!a)return 0;this._editorObs.versionId.read(r);const l=this._editor.getModel(),c=l.getEOL(),d=a.text.startsWith(c)?"":l.getValueInRange(new D(a.lineNumber,1,a.lineNumber,a.column)),h=l.getValueInRange(new D(a.lineNumber,a.column,a.lineNumber,l.getLineLength(a.lineNumber)+1)),f=(d+a.text+h).split(c),g=nf.fromEditor(this._editor).withSetWidth(!1).withScrollBeyondLastColumn(0),m=f.map(p=>{var w;const v=(w=l.tokenization.tokenizeLinesAt(a.lineNumber,[p]))==null?void 0:w[0];let b;return v?b=Zu.fromLineTokens(v).toLineTokens(p,this._languageService.languageIdCodec):b=qn.createEmpty(p,this._languageService.languageIdCodec),Dk(new Tk([b]),g,[],we("div"),!0).minWidthInPx});return Math.max(...m)}),this.startLineOffset=this._trimVertically.map(r=>r.topOffset),this.originalLines=this._state.map(r=>r?new dt(r.lineNumber,Math.min(r.lineNumber+2,this._editor.getModel().getLineCount()+1)):void 0),this._overlayLayout=ae(this,r=>{this._ghostText.read(r);const a=this._state.read(r);if(!a)return null;this._editorObs.observePosition(ht(this,new z(a.lineNumber,a.column)),r.store).read(r);const l=this._editorObs.layoutInfo.read(r),c=this._editorObs.scrollLeft.read(r),d=this._editorObs.layoutInfoVerticalScrollbarWidth.read(r),h=l.contentLeft+this._editorMaxContentWidthInRange.read(r)-c,u=this._maxPrefixTrim.read(r).prefixLeftOffset??0,f=l.contentLeft+u-c;if(h<=f)return null;const{topOffset:g,bottomOffset:m}=this._trimVertically.read(r),p=this._editorObs.scrollTop.read(r),v=this._ghostTextView.height.read(r)-g-m,b=this._editor.getTopForLineNumber(a.lineNumber)-p+g,w=b+v,C=new Wi(f,b,h,w);return{overlay:C,startsAtContentLeft:u===0,contentLeft:l.contentLeft,minContentWidthRequired:u+C.width+d}}).recomputeInitiallyAndOnChange(this._store),this._modifiedOverlay=kt.div({style:{pointerEvents:"none"}},ae(this,r=>{const a=Rh(this._overlayLayout).read(r);if(!a)return;const l=a.map(u=>Wi.fromLeftTopRightBottom(u.contentLeft-v3-sS,u.overlay.top,u.contentLeft,u.overlay.bottom)).read(r),c=this._input.map(u=>u!=null&&u.inDiffEditor?PXe:AXe).read(r),d=a.map(u=>u.overlay.withMargin(0,sS,0,u.startsAtContentLeft?0:sS).intersectHorizontal(new Ue(l.left,Number.MAX_SAFE_INTEGER))),h=d.map(u=>u.withMargin(c,c));return[kt.div({class:"originalUnderlayInsertion",style:{...h.read(r).toStyles(),borderRadius:v3,border:`${sS+c}px solid ${ve(es)}`,boxSizing:"border-box"}}),kt.div({class:"originalOverlayInsertion",style:{...d.read(r).toStyles(),borderRadius:v3,border:PI(this._tabAction).map(u=>`${sS}px solid ${ve(u)}`),boxSizing:"border-box",backgroundColor:ve(cue)}}),kt.div({class:"originalOverlayHiderInsertion",style:{...l.toStyles(),backgroundColor:ve(es)}})]})).keepUpdated(this._store),this._view=kt.div({class:"inline-edits-view",style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",display:this._display}},[[this._modifiedOverlay]]).keepUpdated(this._store),this._editorObs=bn(this._editor),this._ghostTextView=this._register(n.createInstance(MI,this._editor,{ghostText:this._ghostText,minReservedLineCount:Gi(0),targetTextModel:this._editorObs.model.map(r=>r??void 0),warning:Gi(void 0),handleInlineCompletionShown:Gi(()=>{})},ht(this,{syntaxHighlightingEnabled:!0,extraClasses:["inline-edit"]}),!0,!0)),this.isHovered=this._ghostTextView.isHovered,this._register(this._ghostTextView.onDidClick(r=>{this._onDidClick.fire(r)})),this._register(this._editorObs.createOverlayWidget({domNode:this._view.element,position:Gi(null),allowEditorOverflow:!1,minContentWidthInPx:ae(this,r=>{const a=this._overlayLayout.read(r);return a===null?0:a.minContentWidthRequired})}))}};d6=MXe([Lee(3,$e),Lee(4,Wn)],d6);var OXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Iee=function(s,e){return function(t,i){e(t,i,s)}};let h6=class extends K{constructor(e,t,i,n,o,r){super(),this._editor=e,this._edit=t,this._isInDiffEditor=i,this._tabAction=n,this._languageService=o,this._themeService=r,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._maxPrefixTrim=this._edit.map((a,l)=>a?xj(a.replacements.flatMap(c=>[c.originalRange,c.modifiedRange]),a.originalRange,a.modifiedLines,this._editor.editor,l):void 0),this._modifiedLineElements=ae(this,a=>{var p;const l=[];let c=0;const d=this._maxPrefixTrim.read(a),h=this._edit.read(a);if(!h||!d)return;const u=d.prefixTrim,f=FXe(h.replacements.map(v=>v.modifiedRange)).map(v=>new D(v.startLineNumber,v.startColumn-u,v.endLineNumber,v.endColumn-u)),g=this._editor.model.get(),m=h.modifiedRange.startLineNumber;for(let v=0;v<h.modifiedRange.length;v++){const b=document.createElement("div"),w=m+v,C=h.modifiedLines[v].slice(u),y=(p=g.tokenization.tokenizeLinesAt(w,[C]))==null?void 0:p[0];let x;y?x=Zu.fromLineTokens(y).toLineTokens(C,this._languageService.languageIdCodec):x=qn.createEmpty(C,this._languageService.languageIdCodec);const S=[];for(const E of f.filter(M=>M.startLineNumber===w)){const M=Math.min(E.endColumn,C.length+1);S.push(new __(new D(1,E.startColumn,1,M),"inlineCompletions-modified-bubble",0))}const L=Dk(new Tk([x]),nf.fromEditor(this._editor.editor).withSetWidth(!1).withScrollBeyondLastColumn(0),S,b,!0);this._editor.getOption(59).read(a),c=Math.max(c,L.minWidthInPx),l.push(b)}return{lines:l,requiredWidth:c}}),this._layout=ae(this,a=>{const l=this._modifiedLineElements.read(a),c=this._maxPrefixTrim.read(a),d=this._edit.read(a);if(!l||!c||!d)return;const{prefixLeftOffset:h}=c,{requiredWidth:u}=l,f=this._editor.observeLineHeightsForLineRange(d.originalRange).read(a),g=(()=>{const W=f.slice(0,d.modifiedRange.length);for(;W.length<d.modifiedRange.length;)W.push(f[f.length-1]);return W})(),m=this._editor.layoutInfoContentLeft.read(a),p=this._editor.layoutInfoVerticalScrollbarWidth.read(a),v=this._editor.scrollLeft.read(a),b=this._editor.scrollTop.read(a),w=m-v,C=this._editor.editor.getModel(),y=d.originalRange.mapToLineArray(W=>this._editor.editor.getOffsetForColumn(W,C.getLineMaxColumn(W))-h),x=Math.max(...y,u),S=d.originalRange.startLineNumber,L=d.originalRange.endLineNumberExclusive-1,E=this._editor.editor.getTopForLineNumber(S)-b,M=this._editor.editor.getBottomForLineNumber(L)-b,R=Wi.fromLeftTopWidthHeight(w+h,E,x,M-E),T=Wi.fromLeftTopWidthHeight(R.left,R.bottom,R.width,g.reduce((W,H)=>W+H,0)),A=Wi.hull([R,T]),N=A.intersectVertical(new Ue(R.bottom,Number.MAX_SAFE_INTEGER)),P=new Wi(N.left,N.top,N.right,N.bottom);return{originalLinesOverlay:R,modifiedLinesOverlay:T,background:A,lowerBackground:N,lowerText:P,modifiedLineHeights:g,minContentWidthRequired:h+x+p}}),this._viewZoneInfo=ae(a=>{if(!this._editor.getOption(71).map(f=>f.edits.allowCodeShifting==="always").read(a))return;const c=this._layout.read(a),d=this._edit.read(a);if(!c||!d)return;const h=c.lowerBackground.height,u=d.originalRange.endLineNumberExclusive;return{height:h,lineNumber:u}}),this.minEditorScrollHeight=ae(this,a=>{const l=Rh(this._layout).read(a);return!l||this._viewZoneInfo.read(a)!==void 0?0:l.read(a).lowerText.bottom+this._editor.editor.getScrollTop()}),this._div=kt.div({class:"line-replacement"},[ae(this,a=>{const l=Rh(this._layout).read(a),c=this._modifiedLineElements.read(a);if(!l||!c)return[];const d=l.read(a),h=this._editor.layoutInfoContentLeft.read(a),u=this._isInDiffEditor.read(a)?3:1;c.lines.forEach((m,p)=>{m.style.width=`${d.lowerText.width}px`,m.style.height=`${d.modifiedLineHeights[p]}px`,m.style.position="relative"});const f=PI(this._tabAction).read(a),g=H4(this._tabAction).read(a);return[kt.div({style:{position:"absolute",...Ll(m=>Ij(this._editor).read(m)),overflow:"hidden",pointerEvents:"none"}},[kt.div({class:"borderAroundLineReplacement",style:{position:"absolute",...Ll(m=>l.read(m).background.translateX(-h).withMargin(u)),borderRadius:"4px",border:`${u+1}px solid ${ve(es)}`,boxSizing:"border-box",pointerEvents:"none"}}),kt.div({class:"originalOverlayLineReplacement",style:{position:"absolute",...Ll(m=>l.read(m).background.translateX(-h)),borderRadius:"4px",border:fl(g,this._themeService).map(m=>`1px solid ${m.toString()}`),pointerEvents:"none",boxSizing:"border-box",background:ve(Lx)}}),kt.div({class:"modifiedOverlayLineReplacement",style:{position:"absolute",...Ll(m=>l.read(m).lowerBackground.translateX(-h)),borderRadius:"0 0 4px 4px",background:ve(es),boxShadow:`${ve(UO)} 0 6px 6px -6px`,border:`1px solid ${ve(f)}`,boxSizing:"border-box",overflow:"hidden",cursor:"pointer",pointerEvents:"auto"},onmousedown:m=>{m.preventDefault()},onclick:m=>this._onDidClick.fire(new Co(je(m),m))},[kt.div({style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:ve(sXe)}})]),kt.div({class:"modifiedLinesLineReplacement",style:{position:"absolute",boxSizing:"border-box",...Ll(m=>l.read(m).lowerText.translateX(-h)),fontFamily:this._editor.getOption(58),fontSize:this._editor.getOption(61),fontWeight:this._editor.getOption(62),pointerEvents:"none",whiteSpace:"nowrap",borderRadius:"0 0 4px 4px",overflow:"hidden"}},[...c.lines])])]})]).keepUpdated(this._store),this.isHovered=this._editor.isTargetHovered(a=>this._isMouseOverWidget(a),this._store),this._previousViewZoneInfo=void 0,this._register(Ve(()=>this._editor.editor.changeViewZones(a=>this.removePreviousViewZone(a)))),this._register(_Te(this._viewZoneInfo,({lastValue:a,newValue:l})=>{a===l||(a==null?void 0:a.height)===(l==null?void 0:l.height)&&(a==null?void 0:a.lineNumber)===(l==null?void 0:l.lineNumber)||this._editor.editor.changeViewZones(c=>{this.removePreviousViewZone(c),l&&this.addViewZone(l,c)})})),this._register(this._editor.createOverlayWidget({domNode:this._div.element,minContentWidthInPx:ae(this,a=>{var l;return((l=this._layout.read(a))==null?void 0:l.minContentWidthRequired)??0}),position:Gi({preference:{top:0,left:0}}),allowEditorOverflow:!1}))}_isMouseOverWidget(e){const t=this._layout.get();return!t||!(e.event instanceof pf)?!1:t.lowerBackground.containsPoint(new Ms(e.event.relativePos.x,e.event.relativePos.y))}removePreviousViewZone(e){if(!this._previousViewZoneInfo)return;e.removeZone(this._previousViewZoneInfo.id);const t=this._editor.cursorLineNumber.get();t!==null&&t>=this._previousViewZoneInfo.lineNumber&&this._editor.editor.setScrollTop(this._editor.scrollTop.get()-this._previousViewZoneInfo.height),this._previousViewZoneInfo=void 0}addViewZone(e,t){const i=t.addZone({afterLineNumber:e.lineNumber-1,heightInPx:e.height,domNode:we("div")});this._previousViewZoneInfo={height:e.height,lineNumber:e.lineNumber,id:i};const n=this._editor.cursorLineNumber.get();n!==null&&n>=e.lineNumber&&this._editor.editor.setScrollTop(this._editor.scrollTop.get()+e.height)}};h6=OXe([Iee(4,Wn),Iee(5,Dn)],h6);function FXe(s){const e=[];for(;s.length;){let t=s.shift();t.startLineNumber!==t.endLineNumber&&(s.push(new D(t.startLineNumber+1,1,t.endLineNumber,t.endColumn)),t=new D(t.startLineNumber,t.startColumn,t.startLineNumber,Number.MAX_SAFE_INTEGER)),e.push(t)}return e}var BXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Eee=function(s,e){return function(t,i){e(t,i,s)}};const aC=0,oS=0,Ic=1,WXe=1,HXe=3,Qh=4,C3=20,kee=12;let _M=class extends K{static fitsInsideViewport(e,t,i,n){const o=bn(e),r=o.layoutInfoWidth.read(n),a=o.layoutInfoContentLeft.read(n),l=e.getLayoutInfo().verticalScrollbarWidth,c=o.layoutInfoMinimap.read(n).minimapLeft!==0?o.layoutInfoMinimap.read(n).minimapWidth:0,d=Mg(o,i.displayRange,void 0),h=i.lineEdit.newLines.reduce((g,m)=>Math.max(g,Lj(m,e,t)),0),u=C3,f=kee+2*Ic;return d+h+u+f<r-a-l-c}constructor(e,t,i,n,o,r,a){super(),this._editor=e,this._edit=t,this._previewTextModel=i,this._uiState=n,this._tabAction=o,this._instantiationService=r,this._themeService=a,this._editorObs=bn(this._editor),this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._display=ae(this,c=>this._uiState.read(c)?"block":"none"),this.previewRef=kt.ref();const l=this._uiState.map(c=>c!=null&&c.isInDiffEditor?HXe:WXe);this._editorContainer=kt.div({class:["editorContainer"],style:{position:"absolute",overflow:"hidden",cursor:"pointer"},onmousedown:c=>{c.preventDefault()},onclick:c=>{this._onDidClick.fire(new Co(je(c),c))}},[kt.div({class:"preview",style:{pointerEvents:"none"},ref:this.previewRef})]).keepUpdated(this._store),this.isHovered=this._editorContainer.didMouseMoveDuringHover,this.previewEditor=this._register(this._instantiationService.createInstance(Sf,this.previewRef.element,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},rulers:[],padding:{top:0,bottom:0},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,revealHorizontalRightPadding:0,bracketPairColorization:{enabled:!0,independentColorPoolPerBracketType:!1},scrollBeyondLastLine:!1,scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1},readOnly:!0,wordWrap:"off",wordWrapOverride1:"off",wordWrapOverride2:"off"},{contextKeyValues:{[Fi.inInlineEditsPreviewEditor.key]:!0},contributions:[]},this._editor)),this._previewEditorObs=bn(this.previewEditor),this._activeViewZones=[],this._updatePreviewEditor=ae(this,c=>{this._editorContainer.readEffect(c),this._previewEditorObs.model.read(c),this._display.read(c),this._nonOverflowView&&(this._nonOverflowView.element.style.display=this._display.read(c));const d=this._uiState.read(c),h=this._edit.read(c);if(!d||!h)return;const u=h.originalLineRange,f=[];u.startLineNumber>1&&f.push(new D(1,1,u.startLineNumber-1,1)),u.startLineNumber+d.newTextLineCount<this._previewTextModel.getLineCount()+1&&f.push(new D(u.startLineNumber+d.newTextLineCount,1,this._previewTextModel.getLineCount()+1,1)),this.previewEditor.setHiddenAreas(f,void 0,!0);const g=[...this._activeViewZones];this._activeViewZones=[];const m=u.endLineNumberExclusive-u.startLineNumber-d.newTextLineCount;this.previewEditor.changeViewZones(p=>{g.forEach(v=>p.removeZone(v)),m>0&&this._activeViewZones.push(p.addZone({afterLineNumber:u.startLineNumber+d.newTextLineCount-1,heightInLines:m,showInHiddenAreas:!0,domNode:we("div.diagonal-fill.inline-edits-view-zone")}))})}),this._previewEditorWidth=ae(this,c=>{const d=this._edit.read(c);return d?(this._updatePreviewEditor.read(c),Mg(this._previewEditorObs,d.modifiedLineRange,c)):0}),this._cursorPosIfTouchesEdit=ae(this,c=>{const d=this._editorObs.cursorPosition.read(c),h=this._edit.read(c);if(!(!h||!d))return h.modifiedLineRange.contains(d.lineNumber)?d:void 0}),this._originalStartPosition=ae(this,c=>{const d=this._edit.read(c);return d?new z(d.originalLineRange.startLineNumber,1):null}),this._originalEndPosition=ae(this,c=>{const d=this._edit.read(c);return d?new z(d.originalLineRange.endLineNumberExclusive,1):null}),this._originalVerticalStartPosition=this._editorObs.observePosition(this._originalStartPosition,this._store).map(c=>c==null?void 0:c.y),this._originalVerticalEndPosition=this._editorObs.observePosition(this._originalEndPosition,this._store).map(c=>c==null?void 0:c.y),this._originalDisplayRange=this._edit.map(c=>c==null?void 0:c.displayRange),this._editorMaxContentWidthInRange=ae(this,c=>{const d=this._originalDisplayRange.read(c);return d?(this._editorObs.versionId.read(c),Ef(this,(h,u)=>{const f=Mg(this._editorObs,d,h);return Math.max(f,u??0)})):Gi(0)}).map((c,d)=>c.read(d)),this._previewEditorLayoutInfo=ae(this,c=>{const d=this._edit.read(c);if(!d||!this._uiState.read(c))return null;const u=d.originalLineRange,f=this._editorObs.scrollLeft.read(c),g=this._editorMaxContentWidthInRange.read(c),m=this._editorObs.layoutInfo.read(c),p=this._previewEditorWidth.read(c),v=m.contentWidth-m.verticalScrollbarWidth,b=this._editor.getContainerDomNode().getBoundingClientRect(),w=m.contentLeft+m.contentWidth+b.left,C=je(this._editor.getContainerDomNode()).innerWidth-w,y=je(this._editor.getContainerDomNode()).innerWidth-b.right,x=Math.min(m.contentWidth*.3,p,100),S=0,L=S+C,E=this._cursorPosIfTouchesEdit.read(c),M=Math.max(v+f-S-Math.max(0,x-L),Math.min(E?uXe(this._editorObs,E,c)+50:0,v+f)),R=Math.min(g+C3,M),T=g+C3+p+70,A=M-R;let N,P;R>f?(N=0,P=m.contentLeft+R-f):(N=f-R,P=m.contentLeft);const W=this._originalVerticalStartPosition.read(c)??this._editor.getTopForLineNumber(u.startLineNumber)-this._editorObs.scrollTop.read(c),H=this._originalVerticalEndPosition.read(c)??this._editor.getBottomForLineNumber(u.endLineNumberExclusive-1)-this._editorObs.scrollTop.read(c),G=m.contentLeft-f;let V=Wi.fromLeftTopRightBottom(G,W,P,H);const U=V.height===0;U||(V=V.withMargin(oS,aC));const Y=this._previewEditorObs.observeLineHeightsForLineRange(d.modifiedLineRange).read(c).reduce((le,be)=>le+be,0),se=H-W,j=Math.max(se,Y),ie=A===0,te=0,pe=Math.min(p+kee,y+m.width-m.contentLeft-te);let J=Wi.fromLeftTopWidthHeight(V.right+te,W,pe,j);return U?J=J.withMargin(oS,aC).translateY(oS):J=J.withMargin(oS,aC).translateX(aC+Ic),{codeRect:V,editRect:J,codeScrollLeft:f,contentLeft:m.contentLeft,isInsertion:U,maxContentWidth:T,shouldShowShadow:ie,desiredPreviewEditorScrollLeft:N,previewEditorWidth:pe}}),this._stickyScrollController=bc.get(this._editorObs.editor),this._stickyScrollHeight=this._stickyScrollController?fi(this._stickyScrollController.onDidChangeStickyScrollHeight,()=>this._stickyScrollController.stickyScrollWidgetHeight):Gi(0),this._shouldOverflow=ae(this,c=>!1),this._originalBackgroundColor=fi(this,this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme().getColor(Lx)??re.transparent),this._backgroundSvg=kt.svg({transform:"translate(-0.5 -0.5)",style:{overflow:"visible",pointerEvents:"none",position:"absolute"}},[kt.svgElem("path",{class:"rightOfModifiedBackgroundCoverUp",d:ae(this,c=>{const d=this._previewEditorLayoutInfo.read(c);if(!(!d||this._originalBackgroundColor.read(c).isTransparent()))return new s6().moveTo(d.codeRect.getRightTop()).lineTo(d.codeRect.getRightTop().deltaX(1e3)).lineTo(d.codeRect.getRightBottom().deltaX(1e3)).lineTo(d.codeRect.getRightBottom()).build()}),style:{fill:ure(es,"transparent")}})]).keepUpdated(this._store),this._originalOverlay=kt.div({style:{pointerEvents:"none",display:this._previewEditorLayoutInfo.map(c=>c!=null&&c.isInsertion?"none":"block")}},ae(this,c=>{const d=Rh(this._previewEditorLayoutInfo).read(c);if(!d)return;const h=l.read(c),u=H4(this._tabAction).map(x=>`${Ic}px solid ${ve(x)}`),f=`${Ic+h}px solid ${ve(es)}`,g=d.read(c).codeScrollLeft!==0,m=d.map(x=>x.codeRect.bottom<x.editRect.bottom),p=Qh*2+Ic*2,v=d.map(x=>Wi.fromLeftTopRightBottom(x.contentLeft-Qh-Ic,x.codeRect.top,x.contentLeft,x.codeRect.bottom+p)).read(c),b=new Ue(v.left,Number.MAX_SAFE_INTEGER),w=d.map(x=>x.codeRect.intersectHorizontal(b)),C=w.map(x=>x.withMargin(h,0,h,h).intersectHorizontal(b)),y=w.map(x=>Wi.fromLeftTopWidthHeight(x.right-p+Ic,x.bottom-Ic,p,p).intersectHorizontal(b));return[kt.div({class:"originalSeparatorSideBySide",style:{...C.read(c).toStyles(),boxSizing:"border-box",borderRadius:`${Qh}px 0 0 ${Qh}px`,borderTop:f,borderBottom:f,borderLeft:g?"none":f}}),kt.div({class:"originalOverlaySideBySide",style:{...w.read(c).toStyles(),boxSizing:"border-box",borderRadius:`${Qh}px 0 0 ${Qh}px`,borderTop:u,borderBottom:u,borderLeft:g?"none":u,backgroundColor:ve(Lx)}}),kt.div({class:"originalCornerCutoutSideBySide",style:{pointerEvents:"none",display:m.map(x=>x?"block":"none"),...y.read(c).toStyles()}},[kt.div({class:"originalCornerCutoutBackground",style:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",backgroundColor:fl(Lx,this._themeService).map(x=>x.toString())}}),kt.div({class:"originalCornerCutoutBorder",style:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",boxSizing:"border-box",borderTop:u,borderRight:u,borderRadius:"0 100% 0 0",backgroundColor:ve(es)}})]),kt.div({class:"originalOverlaySideBySideHider",style:{...v.toStyles(),backgroundColor:ve(es)}})]})).keepUpdated(this._store),this._modifiedOverlay=kt.div({style:{pointerEvents:"none"}},ae(this,c=>{const d=Rh(this._previewEditorLayoutInfo).read(c);if(!d)return;const h=d.map(w=>w.codeRect.bottom<w.editRect.bottom),u=l.read(c),f=h.map(w=>`0 ${Qh}px ${Qh}px ${w?Qh:0}px`),g=fl(PI(this._tabAction),this._themeService).map(w=>`1px solid ${w.toString()}`),m=`${Ic+u}px solid ${ve(es)}`,p=d.map(w=>w.editRect.withMargin(0,Ic)),v=p.map(w=>w.withMargin(u,u,u,0)),b=ae(this,w=>{const C=p.read(w),y=d.read(w);return!y.isInsertion||y.contentLeft>=C.left?Wi.fromLeftTopWidthHeight(C.left,C.top,0,0):new Wi(y.contentLeft,C.top,C.left,C.top+Ic*2)});return[kt.div({class:"modifiedInsertionSideBySide",style:{...b.read(c).toStyles(),backgroundColor:PI(this._tabAction).map(w=>ve(w))}}),kt.div({class:"modifiedSeparatorSideBySide",style:{...v.read(c).toStyles(),borderRadius:f,borderTop:m,borderBottom:m,borderRight:m,boxSizing:"border-box"}}),kt.div({class:"modifiedOverlaySideBySide",style:{...p.read(c).toStyles(),borderRadius:f,border:g,boxSizing:"border-box",backgroundColor:ve(cue)}})]})).keepUpdated(this._store),this._nonOverflowView=kt.div({class:"inline-edits-view",style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",display:this._display}},[this._backgroundSvg,ae(this,c=>this._shouldOverflow.read(c)?[]:[this._editorContainer,this._originalOverlay,this._modifiedOverlay])]).keepUpdated(this._store),this._register(this._editorObs.createOverlayWidget({domNode:this._nonOverflowView.element,position:Gi(null),allowEditorOverflow:!1,minContentWidthInPx:ae(this,c=>{var h;const d=(h=this._previewEditorLayoutInfo.read(c))==null?void 0:h.maxContentWidth;return d===void 0?0:d})})),this.previewEditor.setModel(this._previewTextModel),this._register(lt(c=>{const d=this._previewEditorLayoutInfo.read(c);if(!d)return;const h=d.editRect.withMargin(-oS,-aC);this.previewEditor.layout({height:h.height,width:d.previewEditorWidth+15}),this._editorContainer.element.style.top=`${h.top}px`,this._editorContainer.element.style.left=`${h.left}px`,this._editorContainer.element.style.width=`${d.previewEditorWidth+aC}px`})),this._register(lt(c=>{const d=this._previewEditorLayoutInfo.read(c);d&&this._previewEditorObs.editor.setScrollLeft(d.desiredPreviewEditorScrollLeft)})),this._updatePreviewEditor.recomputeInitiallyAndOnChange(this._store)}};_M=BXe([Eee(5,$e),Eee(6,Dn)],_M);var VXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},zXe=function(s,e){return function(t,i){e(t,i,s)}};const Jh=1;var Y1;let HC=(Y1=class extends K{constructor(e,t,i,n){super(),this._editor=e,this._edit=t,this._tabAction=i,this._languageService=n,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this._start=this._editor.observePosition(Gi(this._edit.range.getStartPosition()),this._store),this._end=this._editor.observePosition(Gi(this._edit.range.getEndPosition()),this._store),this._line=document.createElement("div"),this._hoverableElement=ht(this,null),this.isHovered=this._hoverableElement.map((r,a)=>(r==null?void 0:r.didMouseMoveDuringHover.read(a))??!1),this._renderTextEffect=ae(this,r=>{var g;const a=this._editor.model.get(),l=a.getLineContent(this._edit.range.startLineNumber),c=to.replace(new Ue(this._edit.range.startColumn-1,this._edit.range.endColumn-1),this._edit.text),d=c.replace(l),h=(g=a.tokenization.tokenizeLinesAt(this._edit.range.startLineNumber,[d]))==null?void 0:g[0];let u;h?u=Zu.fromLineTokens(h).slice(c.getRangeAfterReplace()).toLineTokens(this._edit.text,this._languageService.languageIdCodec):u=qn.createEmpty(this._edit.text,this._languageService.languageIdCodec);const f=Dk(new Tk([u]),nf.fromEditor(this._editor.editor).withSetWidth(!1).withScrollBeyondLastColumn(0),[],this._line,!0);this._line.style.width=`${f.minWidthInPx}px`});const o=this._editor.observeLineHeightForPosition(this._edit.range.getStartPosition());this._layout=ae(this,r=>{this._renderTextEffect.read(r);const a=this._start.read(r),l=this._end.read(r);if(!a||!l||a.x>l.x||a.y>l.y)return;const c=o.read(r),d=this._editor.scrollLeft.read(r),h=this._editor.getOption(59).read(r).typicalHalfwidthCharacterWidth,u=3*h,f=4,g=new Ms(u,f),m=Wi.fromPoints(a,l).withHeight(c).translateX(-d),p=Wi.fromPointSize(m.getLeftBottom().add(g),new Ms(this._edit.text.length*h,m.height)),v=p.withLeft(m.left);return{originalLine:m,modifiedLine:p,lowerBackground:v,lineHeight:c}}),this.minEditorScrollHeight=ae(this,r=>{const a=Rh(this._layout).read(r);return a?a.read(r).modifiedLine.bottom+Jh+this._editor.editor.getScrollTop():0}),this._root=kt.div({class:"word-replacement"},[ae(this,r=>{const a=Rh(this._layout).read(r);if(!a)return[];const l=H4(this._tabAction).map(d=>ve(d)).read(r),c=PI(this._tabAction).map(d=>ve(d)).read(r);return[kt.div({style:{position:"absolute",...Ll(d=>Ij(this._editor).read(d)),overflow:"hidden",pointerEvents:"none"}},[kt.div({style:{position:"absolute",...Ll(d=>a.read(d).lowerBackground.withMargin(Jh,2*Jh,Jh,0)),background:ve(es),cursor:"pointer",pointerEvents:"auto"},onmousedown:d=>{d.preventDefault()},onmouseup:d=>this._onDidClick.fire(new Co(je(d),d)),obsRef:d=>{this._hoverableElement.set(d,void 0)}}),kt.div({style:{position:"absolute",...Ll(d=>a.read(d).modifiedLine.withMargin(Jh,2*Jh)),fontFamily:this._editor.getOption(58),fontSize:this._editor.getOption(61),fontWeight:this._editor.getOption(62),pointerEvents:"none",boxSizing:"border-box",borderRadius:"4px",border:`${Jh}px solid ${c}`,background:ve(oXe),display:"flex",justifyContent:"center",alignItems:"center",outline:`2px solid ${ve(es)}`}},[this._line]),kt.div({style:{position:"absolute",...Ll(d=>a.read(d).originalLine.withMargin(Jh)),boxSizing:"border-box",borderRadius:"4px",border:`${Jh}px solid ${l}`,background:ve(nXe),pointerEvents:"none"}},[]),kt.svg({width:11,height:14,viewBox:"0 0 11 14",fill:"none",style:{position:"absolute",left:a.map(d=>d.modifiedLine.left-16),top:a.map(d=>d.modifiedLine.top+Math.round((d.lineHeight-14-5)/2))}},[kt.svgElem("path",{d:"M1 0C1 2.98966 1 5.92087 1 8.49952C1 9.60409 1.89543 10.5 3 10.5H10.5",stroke:ve(VY)}),kt.svgElem("path",{d:"M6 7.5L9.99999 10.49998L6 13.5",stroke:ve(VY)})])])]})]).keepUpdated(this._store),this._register(this._editor.createOverlayWidget({domNode:this._root.element,minContentWidthInPx:Gi(0),position:Gi({preference:{top:0,left:0}}),allowEditorOverflow:!1}))}},Y1.MAX_LENGTH=100,Y1);HC=VXe([zXe(3,Wn)],HC);class UXe extends K{constructor(e,t,i){super(),this._originalEditor=e,this._state=t,this._modifiedTextModel=i,this._onDidClick=this._register(new q),this.onDidClick=this._onDidClick.event,this.isHovered=bn(this._originalEditor).isTargetHovered(o=>{var r;return o.target.type===6&&((r=o.target.detail.injectedText)==null?void 0:r.options.attachedData)instanceof w3&&o.target.detail.injectedText.options.attachedData.owner===this},this._store),this._tokenizationFinished=jXe(this._modifiedTextModel),this._decorations=ae(this,o=>{var x,S;const r=this._state.read(o);if(!r)return;const a=r.modifiedText,l=r.mode==="insertionInline",c=r.diff.length===1&&((x=r.diff[0].innerChanges)==null?void 0:x.length)===1,d=!0,h=[],u=[],f=vt.register({className:"inlineCompletions-line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),g=vt.register({className:"inlineCompletions-line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),m=vt.register({className:"inlineCompletions-char-delete",description:"char-delete",isWholeLine:!1,zIndex:1}),p=vt.register({className:"inlineCompletions-char-insert",description:"char-insert",isWholeLine:!0}),v=vt.register({className:"inlineCompletions-char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),b=vt.register({className:"inlineCompletions-char-insert diff-range-empty",description:"char-insert diff-range-empty"}),w=vt.register({className:"inlineCompletions-original-lines",description:"inlineCompletions-original-lines",isWholeLine:!1,shouldFillLineOnLineBreak:!0}),C=r.mode!=="sideBySide"&&r.mode!=="deletion"&&r.mode!=="insertionInline"&&r.mode!=="lineReplacement",y=r.mode==="lineReplacement";for(const L of r.diff)if(C&&(L.original.isEmpty||h.push({range:L.original.toInclusiveRange(),options:g}),L.modified.isEmpty||u.push({range:L.modified.toInclusiveRange(),options:f})),L.modified.isEmpty||L.original.isEmpty)L.original.isEmpty||h.push({range:L.original.toInclusiveRange(),options:m}),L.modified.isEmpty||u.push({range:L.modified.toInclusiveRange(),options:p});else{const E=l&&$Xe(L);for(const M of L.innerChanges||[]){if(L.original.contains(M.originalRange.startLineNumber)&&!(y&&M.originalRange.isEmpty())){const R=(S=this._originalEditor.getModel())==null?void 0:S.getValueInRange(M.originalRange,1);h.push({range:M.originalRange,options:{description:"char-delete",shouldFillLineOnLineBreak:!1,className:g3("inlineCompletions-char-delete",M.originalRange.isSingleLine()&&r.mode==="insertionInline"&&"single-line-inline",M.originalRange.isEmpty()&&"empty",(M.originalRange.isEmpty()&&c||r.mode==="deletion"&&R===`
`)&&d&&!E&&"diff-range-empty"),inlineClassName:E?g3("strike-through","inlineCompletions"):null,zIndex:1}})}if(L.modified.contains(M.modifiedRange.startLineNumber)&&u.push({range:M.modifiedRange,options:M.modifiedRange.isEmpty()&&d&&!E&&c?b:v}),E){const R=a.getValueOfRange(M.modifiedRange),T=R.length>3?[{text:R.slice(0,1),extraClasses:["start"],offsetRange:new Ue(M.modifiedRange.startColumn-1,M.modifiedRange.startColumn)},{text:R.slice(1,-1),extraClasses:[],offsetRange:new Ue(M.modifiedRange.startColumn,M.modifiedRange.endColumn-2)},{text:R.slice(-1),extraClasses:["end"],offsetRange:new Ue(M.modifiedRange.endColumn-2,M.modifiedRange.endColumn-1)}]:[{text:R,extraClasses:["start","end"],offsetRange:new Ue(M.modifiedRange.startColumn-1,M.modifiedRange.endColumn)}];this._tokenizationFinished.read(o);const A=this._modifiedTextModel.tokenization.getLineTokens(M.modifiedRange.startLineNumber);for(const{text:N,extraClasses:P,offsetRange:W}of T)h.push({range:D.fromPositions(M.originalRange.getEndPosition()),options:{description:"inserted-text",before:{tokens:A.getTokensInRange(W),content:N,inlineClassName:g3("inlineCompletions-char-insert",M.modifiedRange.isSingleLine()&&r.mode==="insertionInline"&&"single-line-inline",...P),cursorStops:wl.None,attachedData:new w3(this)},zIndex:2,showIfCollapsed:!0}})}}}if(r.isInDiffEditor)for(const L of r.diff)L.original.isEmpty||h.push({range:L.original.toExclusiveRange(),options:w});return{originalDecorations:h,modifiedDecorations:u}}),this._register(bn(this._originalEditor).setDecorations(this._decorations.map(o=>(o==null?void 0:o.originalDecorations)??[])));const n=this._state.map(o=>o==null?void 0:o.modifiedCodeEditor);this._register(Ao((o,r)=>{const a=n.read(o);a&&r.add(bn(a).setDecorations(this._decorations.map(l=>(l==null?void 0:l.modifiedDecorations)??[])))})),this._register(this._originalEditor.onMouseUp(o=>{var a;if(o.target.type!==6)return;const r=(a=o.target.detail.injectedText)==null?void 0:a.options.attachedData;r instanceof w3&&r.owner===this&&this._onDidClick.fire(o.event)}))}}class w3{constructor(e){this.owner=e}}function $Xe(s){return s.innerChanges?s.innerChanges.every(e=>JR(e.modifiedRange)&&JR(e.originalRange)):!1}let qXe=0;function jXe(s){return fi(s.onDidChangeTokens,()=>qXe++)}var KXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},GXe=function(s,e){return function(t,i){e(t,i,s)}};let u6=class extends K{constructor(e,t,i,n,o,r){super(),this._editor=e,this._host=t,this._model=i,this._ghostTextIndicator=n,this._focusIsInMenu=o,this._instantiationService=r,this._editorObs=bn(this._editor),this._tabAction=ae(d=>{var h;return((h=this._model.read(d))==null?void 0:h.tabAction.read(d))??No.Inactive}),this._constructorDone=ht(this,!1),this._uiState=ae(this,d=>{var b,w;const h=this._model.read(d);if(!h||!this._constructorDone.read(d))return;const u=h.inlineEdit;let f=fr.fromEdit(u.edit),g=u.edit.apply(u.originalText),m=ZR(f,u.originalText,new xg(g)),p=this.determineRenderState(h,d,m,new xg(g));if(!p){_t(new Error(`unable to determine view: tried to render ${(b=this._previousView)==null?void 0:b.view}`));return}if(p.kind===hi.SideBySide){const C=_Xe(g,u.modifiedLineRange,l.getOptions().tabSize);g=C.applyToString(g),f=fXe(f,C),m=ZR(f,u.originalText,new xg(g))}return this._previewTextModel.setLanguage(this._editor.getModel().getLanguageId()),this._previewTextModel.getValue()!==g&&this._previewTextModel.setValue(g),h.showCollapsed.read(d)&&!((w=this._indicator.read(d))!=null&&w.isHoverVisible.read(d))&&(p={kind:hi.Collapsed,viewData:p.viewData}),h.handleInlineEditShown(p.kind,p.viewData),{state:p,diff:m,edit:u,newText:g,newTextLineCount:u.modifiedLineRange.length,isInDiffEditor:h.isInDiffEditor}}),this._previewTextModel=this._register(this._instantiationService.createInstance(Hb,"",this._editor.getModel().getLanguageId(),{...Hb.DEFAULT_CREATION_OPTIONS,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},null)),this._indicatorCyclicDependencyCircuitBreaker=ht(this,!1),this._indicator=ae(this,d=>{if(!this._indicatorCyclicDependencyCircuitBreaker.read(d))return;const h=_o({owner:this,equalsFn:Up(NU())},f=>{var p,v,b;const g=this._ghostTextIndicator.read(f);if(g)return g.lineRange;const m=this._uiState.read(f);if(m){if(((p=m.state)==null?void 0:p.kind)==="custom"){const w=(v=m.state.displayLocation)==null?void 0:v.range;if(!w)throw new et("custom view should have a range");return new dt(w.startLineNumber,w.endLineNumber)}return((b=m.state)==null?void 0:b.kind)==="insertionMultiLine"?this._insertion.originalLines.read(f):m.edit.displayRange}}),u=ae(this,f=>{const g=this._model.read(f);if(g)return g;const m=this._ghostTextIndicator.read(f);return m?m.model:g});return d.store.add(this._instantiationService.createInstance(r6,this._editorObs,h,this._gutterIndicatorOffset,u,this._inlineEditsIsHovered,this._focusIsInMenu))}),this._inlineEditsIsHovered=ae(this,d=>this._sideBySide.isHovered.read(d)||this._wordReplacementViews.read(d).some(h=>h.isHovered.read(d))||this._deletion.isHovered.read(d)||this._inlineDiffView.isHovered.read(d)||this._lineReplacementView.isHovered.read(d)||this._insertion.isHovered.read(d)||this._customView.isHovered.read(d)),this._gutterIndicatorOffset=ae(this,d=>{var u,f;if(((f=(u=this._uiState.read(d))==null?void 0:u.state)==null?void 0:f.kind)==="insertionMultiLine")return this._insertion.startLineOffset.read(d);const h=this._ghostTextIndicator.read(d);return h?ZXe(h,this._editor):0}),this._sideBySide=this._register(this._instantiationService.createInstance(_M,this._editor,this._model.map(d=>d==null?void 0:d.inlineEdit),this._previewTextModel,this._uiState.map(d=>{var h;return d&&((h=d.state)==null?void 0:h.kind)===hi.SideBySide?{newTextLineCount:d.newTextLineCount,isInDiffEditor:d.isInDiffEditor}:void 0}),this._tabAction)),this._deletion=this._register(this._instantiationService.createInstance(RXe,this._editor,this._model.map(d=>d==null?void 0:d.inlineEdit),this._uiState.map(d=>{var h;return d&&((h=d.state)==null?void 0:h.kind)===hi.Deletion?{originalRange:d.state.originalRange,deletions:d.state.deletions,inDiffEditor:d.isInDiffEditor}:void 0}),this._tabAction)),this._insertion=this._register(this._instantiationService.createInstance(d6,this._editor,this._uiState.map(d=>{var h;return d&&((h=d.state)==null?void 0:h.kind)===hi.InsertionMultiLine?{lineNumber:d.state.lineNumber,startColumn:d.state.column,text:d.state.text,inDiffEditor:d.isInDiffEditor}:void 0}),this._tabAction)),this._inlineDiffViewState=ae(this,d=>{const h=this._uiState.read(d);if(!(!h||!h.state)&&!(h.state.kind==="wordReplacements"||h.state.kind==="insertionMultiLine"||h.state.kind==="collapsed"||h.state.kind==="custom"))return{modifiedText:new xg(h.newText),diff:h.diff,mode:h.state.kind,modifiedCodeEditor:this._sideBySide.previewEditor,isInDiffEditor:h.isInDiffEditor}}),this._inlineCollapsedView=this._register(this._instantiationService.createInstance(l6,this._editor,this._model.map((d,h)=>{var u,f;return((f=(u=this._uiState.read(h))==null?void 0:u.state)==null?void 0:f.kind)==="collapsed"?d==null?void 0:d.inlineEdit:void 0}))),this._customView=this._register(this._instantiationService.createInstance(c6,this._editor,this._model.map((d,h)=>{var u,f;return((f=(u=this._uiState.read(h))==null?void 0:u.state)==null?void 0:f.kind)==="custom"?d==null?void 0:d.displayLocation:void 0}),this._tabAction)),this._inlineDiffView=this._register(new UXe(this._editor,this._inlineDiffViewState,this._previewTextModel)),this._wordReplacementViews=AU(this,this._uiState.map(d=>{var h;return((h=d==null?void 0:d.state)==null?void 0:h.kind)==="wordReplacements"?d.state.replacements:[]}),(d,h)=>h.add(this._instantiationService.createInstance(HC,this._editorObs,d,this._tabAction))),this._lineReplacementView=this._register(this._instantiationService.createInstance(h6,this._editorObs,this._uiState.map(d=>{var h;return((h=d==null?void 0:d.state)==null?void 0:h.kind)===hi.LineReplacement?{originalRange:d.state.originalRange,modifiedRange:d.state.modifiedRange,modifiedLines:d.state.modifiedLines,replacements:d.state.replacements}:void 0}),this._uiState.map(d=>(d==null?void 0:d.isInDiffEditor)??!1),this._tabAction)),this._useCodeShifting=this._editorObs.getOption(71).map(d=>d.edits.allowCodeShifting),this._renderSideBySide=this._editorObs.getOption(71).map(d=>d.edits.renderSideBySide),this._register(Ao((d,h)=>{const u=this._model.read(d);u&&h.add(Se.any(this._sideBySide.onDidClick,this._deletion.onDidClick,this._lineReplacementView.onDidClick,this._insertion.onDidClick,...this._wordReplacementViews.read(d).map(f=>f.onDidClick),this._inlineDiffView.onDidClick,this._customView.onDidClick)(f=>{this._viewHasBeenShownLongerThan(350)&&(f.preventDefault(),u.accept())}))})),this._indicator.recomputeInitiallyAndOnChange(this._store),this._wordReplacementViews.recomputeInitiallyAndOnChange(this._store),this._indicatorCyclicDependencyCircuitBreaker.set(!0,void 0),this._register(this._instantiationService.createInstance(a6,this._host,this._model,this._indicator,this._inlineCollapsedView));const a=ae(this,d=>Math.max(...this._wordReplacementViews.read(d).map(h=>h.minEditorScrollHeight.read(d)),this._lineReplacementView.minEditorScrollHeight.read(d),this._customView.minEditorScrollHeight.read(d))).recomputeInitiallyAndOnChange(this._store),l=this._editor.getModel();let c;this._register(lt(d=>{const h=a.read(d);this._editor.changeViewZones(u=>{const f=this._editor.getScrollHeight(),g=h-f+1;g!==0&&c&&(u.removeZone(c),c=void 0),!(g<=0)&&(c=u.addZone({afterLineNumber:l.getLineCount(),heightInPx:g,domNode:we("div.minScrollHeightViewZone")}))})})),this._constructorDone.set(!0,void 0)}getCacheId(e){return e.inlineEdit.inlineCompletion.identity.id}determineView(e,t,i,n){var u,f,g,m,p;const o=e.inlineEdit,r=((u=this._previousView)==null?void 0:u.id)===this.getCacheId(e)&&!((f=e.displayLocation)!=null&&f.jumpToEdit),a=((g=this._previousView)==null?void 0:g.editorWidth)!==this._editorObs.layoutInfoWidth.read(t)&&(((m=this._previousView)==null?void 0:m.view)===hi.SideBySide||((p=this._previousView)==null?void 0:p.view)===hi.LineReplacement);if(r&&!a)return this._previousView.view;if(e.inlineEdit.inlineCompletion instanceof A1&&e.inlineEdit.inlineCompletion.uri||e.displayLocation&&!e.inlineEdit.inlineCompletion.identity.jumpedTo.read(t))return hi.Custom;const l=o.originalLineRange.length,c=o.modifiedLineRange.length,d=i.flatMap(v=>v.innerChanges??[]),h=d.length===1;if(!e.isInDiffEditor){if(h&&this._useCodeShifting.read(t)!=="never"&&mue(i))return YXe(i,o.cursorPosition)?hi.InsertionInline:hi.LineReplacement;if(Tee(d,o,n))return hi.Deletion;if(Dee(i)&&this._useCodeShifting.read(t)==="always")return hi.InsertionMultiLine;if(d.every(b=>xs.ofRange(b.originalRange).columnCount<HC.MAX_LENGTH&&xs.ofRange(b.modifiedRange).columnCount<HC.MAX_LENGTH)&&h&&l===1&&c===1){const b=d.map(C=>n.getValueOfRange(C.modifiedRange)),w=d.map(C=>e.inlineEdit.originalText.getValueOfRange(C.originalRange));if(!b.some(C=>C.includes("	"))&&!w.some(C=>C.includes("	"))&&(!d.some(C=>C.originalRange.isEmpty())||!Nee(d.map(C=>new os(C.originalRange,"")),o.originalText).some(C=>C.range.isEmpty()&&xs.ofRange(C.range).columnCount<HC.MAX_LENGTH)))return hi.WordReplacements}}if(l>0&&c>0)return l===1&&c===1&&!e.isInDiffEditor?hi.LineReplacement:this._renderSideBySide.read(t)!=="never"&&_M.fitsInsideViewport(this._editor,this._previewTextModel,o,t)?hi.SideBySide:hi.LineReplacement;if(e.isInDiffEditor){if(Tee(d,o,n))return hi.Deletion;if(Dee(i)&&this._useCodeShifting.read(t)==="always")return hi.InsertionMultiLine}return hi.SideBySide}determineRenderState(e,t,i,n){const o=e.inlineEdit;let r=this.determineView(e,t,i,n);if(this._willRenderAboveCursor(t,o,r))switch(r){case hi.LineReplacement:case hi.WordReplacements:r=hi.SideBySide;break}this._previousView={id:this.getCacheId(e),view:r,editorWidth:this._editor.getLayoutInfo().width,timestamp:Date.now()};const a=i.flatMap(g=>g.innerChanges??[]),l=this._editor.getModel(),c=a.map(g=>({originalRange:g.originalRange,modifiedRange:g.modifiedRange,original:l.getValueInRange(g.originalRange),modified:n.getValueOfRange(g.modifiedRange)})),d=o.cursorPosition,h=c.length===0?!1:c[0].modified.startsWith(l.getEOL()),u={cursorColumnDistance:o.edit.replacements.length===0?0:o.edit.replacements[0].range.getStartPosition().column-d.column,cursorLineDistance:o.lineEdit.lineRange.startLineNumber-d.lineNumber+(h&&o.lineEdit.lineRange.startLineNumber>=d.lineNumber?1:0),lineCountOriginal:o.lineEdit.lineRange.length,lineCountModified:o.lineEdit.newLines.length,characterCountOriginal:c.reduce((g,m)=>g+m.original.length,0),characterCountModified:c.reduce((g,m)=>g+m.modified.length,0),disjointReplacements:c.length,sameShapeReplacements:c.every(g=>g.original===c[0].original&&g.modified===c[0].modified)};switch(r){case hi.InsertionInline:return{kind:hi.InsertionInline,viewData:u};case hi.SideBySide:return{kind:hi.SideBySide,viewData:u};case hi.Collapsed:return{kind:hi.Collapsed,viewData:u};case hi.Custom:return{kind:hi.Custom,displayLocation:e.displayLocation,viewData:u}}if(r===hi.Deletion)return{kind:hi.Deletion,originalRange:o.originalLineRange,deletions:a.map(g=>g.originalRange),viewData:u};if(r===hi.InsertionMultiLine){const g=a[0];return{kind:hi.InsertionMultiLine,lineNumber:g.originalRange.startLineNumber,column:g.originalRange.startColumn,text:n.getValueOfRange(g.modifiedRange),viewData:u}}const f=c.map(g=>new os(g.originalRange,g.modified));if(f.length!==0){if(r===hi.WordReplacements){let g=XXe(f,o.originalText);return g.some(m=>m.range.isEmpty())&&(g=Nee(f,o.originalText)),{kind:hi.WordReplacements,replacements:g,viewData:u}}if(r===hi.LineReplacement)return{kind:hi.LineReplacement,originalRange:o.originalLineRange,modifiedRange:o.modifiedLineRange,modifiedLines:o.modifiedLineRange.mapToLineArray(g=>n.getLineAt(g)),replacements:a.map(g=>({originalRange:g.originalRange,modifiedRange:g.modifiedRange})),viewData:u}}}_willRenderAboveCursor(e,t,i){if(this._useCodeShifting.read(e)==="always")return!1;for(const o of t.multiCursorPositions)if(i===hi.WordReplacements&&o.lineNumber===t.originalLineRange.startLineNumber+1||i===hi.LineReplacement&&o.lineNumber>=t.originalLineRange.endLineNumberExclusive&&o.lineNumber<t.modifiedLineRange.endLineNumberExclusive+t.modifiedLineRange.length)return!0;return!1}_viewHasBeenShownLongerThan(e){var n;const t=(n=this._previousView)==null?void 0:n.timestamp;if(!t)throw new et("viewHasBeenShownLongThan called before a view has been shown");return Date.now()-t>=e}};u6=KXe([GXe(5,$e)],u6);function mue(s){return s.every(t=>t.innerChanges.every(i=>e(i)));function e(t){return!(!t.originalRange.isEmpty()||!(t.modifiedRange.startLineNumber===t.modifiedRange.endLineNumber))}}function YXe(s,e){if(!e||!mue(s))return!1;const t=e;return s.every(n=>n.innerChanges.every(o=>i(o)));function i(n){const o=n.originalRange.getStartPosition();return!!(t.isBeforeOrEqual(o)||o.lineNumber<t.lineNumber)}}function Dee(s){const e=s.flatMap(i=>i.innerChanges??[]);if(e.length!==1)return!1;const t=e[0];return!(!t.originalRange.isEmpty()||t.modifiedRange.startLineNumber===t.modifiedRange.endLineNumber)}function Tee(s,e,t){return s.map(n=>({original:e.originalText.getValueOfRange(n.originalRange),modified:t.getValueOfRange(n.modifiedRange)})).every(({original:n,modified:o})=>o.trim()===""&&n.length>0&&(n.length>o.length||n.trim()!==""))}function XXe(s,e){return pue(s,e,t=>/^[a-zA-Z]$/.test(t))}function Nee(s,e){return pue(s,e,t=>!/^\s$/.test(t))}function pue(s,e,t){const i=[];s.sort((o,r)=>D.compareRangesUsingStarts(o.range,r.range));for(const o of s){let r=o.range.startColumn-1,a=o.range.endColumn-2,l="",c="";const d=e.getLineAt(o.range.startLineNumber),h=e.getLineAt(o.range.endLineNumber);if(n(d[r]))for(;n(d[r-1]);)l=d[r-1]+l,r--;if(n(h[a])||a<r)for(;n(h[a+1]);)c+=h[a+1],a++;let u=new os(new D(o.range.startLineNumber,r+1,o.range.endLineNumber,a+2),l+o.text+c);i.length>0&&D.areIntersectingOrTouching(i[i.length-1].range,u.range)&&(u=os.joinReplacements([i.pop(),u],e)),i.push(u)}function n(o){return o===void 0?!1:t(o)}return i}function ZXe(s,e){const t=s.model.inlineEdit.edit.replacements;if(t.length!==1)return 0;const i=e.getModel();if(!i)return 0;const n=i.getEOL(),o=t[0];if(o.range.isEmpty()&&o.text.startsWith(n)){const r=e.getLineHeightForPosition(o.range.getStartPosition());return QXe(o.text,n)*r}return 0}function QXe(s,e){if(!e.length)return 0;let t=0,i=0;for(;s.startsWith(e,i);)t++,i+=e.length;return t}var JXe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},eZe=function(s,e){return function(t,i){e(t,i,s)}},nb;let f6=(nb=class extends K{constructor(e,t,i,n,o){super(),this._editor=e,this._edit=t,this._model=i,this._focusIsInMenu=n,this._inlineEdit=ae(this,r=>{var g;const a=this._model.read(r);if(!a)return;const l=this._edit.read(r);if(!l)return;const c=this._editor.getModel();if(!c)return;const d=(g=a.inlineEditState.read(void 0))==null?void 0:g.inlineCompletion.updatedEdit;if(!d)return;const h=d.replacements.map(m=>{const p=D.fromPositions(c.getPositionAt(m.replaceRange.start),c.getPositionAt(m.replaceRange.endExclusive));return new os(p,m.newText)}),u=new ra(h),f=new qb(c);return new sue(f,u,a.primaryPosition.read(void 0),a.allPositions.read(void 0),l.commands,l.inlineCompletion)}),this._inlineEditModel=ae(this,r=>{const a=this._model.read(r);if(!a)return;const l=this._inlineEdit.read(r);if(!l)return;const c=ae(this,d=>{if(this._editorObs.isFocused.read(d)){if(a.tabShouldJumpToInlineEdit.read(d))return No.Jump;if(a.tabShouldAcceptInlineEdit.read(d))return No.Accept}return No.Inactive});return new oue(a,l,c)}),this._inlineEditHost=ae(this,r=>{const a=this._model.read(r);if(a)return new GYe(a)}),this._ghostTextIndicator=ae(this,r=>{const a=this._model.read(r);if(!a)return;const l=a.inlineCompletionState.read(r);if(!l)return;const c=l.inlineCompletion;if(!c||!c.showInlineEditMenu)return;const d=dt.ofLength(l.primaryGhostText.lineNumber,1);return new YYe(this._editor,a,d,c)}),this._editorObs=bn(this._editor),this._register(o.createInstance(u6,this._editor,this._inlineEditHost,this._inlineEditModel,this._ghostTextIndicator,this._focusIsInMenu))}},nb.hot=a4(nb),nb);f6=JXe([eZe(4,$e)],f6);var tZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},iZe=function(s,e){return function(t,i){e(t,i,s)}};let g6=class extends K{constructor(e,t,i,n){super(),this._editor=e,this._model=t,this._focusIsInMenu=i,this._instantiationService=n,this._ghostTexts=ae(this,o=>{const r=this._model.read(o);return(r==null?void 0:r.ghostTexts.read(o))??[]}),this._stablizedGhostTexts=oGe(this._ghostTexts,this._store),this._editorObs=bn(this._editor),this._ghostTextWidgets=AU(this,this._stablizedGhostTexts,(o,r)=>gl(a=>this._instantiationService.createInstance(MI.hot.read(a),this._editor,{ghostText:o,warning:this._model.map((l,c)=>{var h;const d=(h=l==null?void 0:l.warning)==null?void 0:h.read(c);return d?{icon:d.icon}:void 0}),minReservedLineCount:Gi(0),targetTextModel:this._model.map(l=>l==null?void 0:l.textModel),handleInlineCompletionShown:this._model.map((l,c)=>{var h;const d=(h=l==null?void 0:l.inlineCompletionState.read(c))==null?void 0:h.inlineCompletion;return d?u=>l.handleInlineSuggestionShown(d,hi.GhostText,u):()=>{}})},this._editorObs.getOption(71).map(l=>({syntaxHighlightingEnabled:l.syntaxHighlightingEnabled})),!1,!1)).recomputeInitiallyAndOnChange(r)).recomputeInitiallyAndOnChange(this._store),this._inlineEdit=ae(this,o=>{var r,a;return(a=(r=this._model.read(o))==null?void 0:r.inlineEditState.read(o))==null?void 0:a.inlineEdit}),this._everHadInlineEdit=Ef(this,(o,r)=>{var a,l,c;return r||!!this._inlineEdit.read(o)||!!((c=(l=(a=this._model.read(o))==null?void 0:a.inlineCompletionState.read(o))==null?void 0:l.inlineCompletion)!=null&&c.showInlineEditMenu)}),this._inlineEditWidget=gl(o=>{if(this._everHadInlineEdit.read(o))return this._instantiationService.createInstance(f6.hot.read(o),this._editor,this._inlineEdit,this._model,this._focusIsInMenu)}).recomputeInitiallyAndOnChange(this._store),this._fontFamily=this._editorObs.getOption(71).map(o=>o.fontFamily),this._register(LMe(ae(o=>`
.monaco-editor .ghost-text-decoration,
.monaco-editor .ghost-text-decoration-preview,
.monaco-editor .ghost-text {
	font-family: ${this._fontFamily.read(o)};
}`))),this._register(new wW(this._editor,this._model,this._instantiationService))}shouldShowHoverAtViewZone(e){var t;return((t=this._ghostTextWidgets.get()[0])==null?void 0:t.get().ownsViewZone(e))??!1}};g6=tZe([iZe(3,$e)],g6);var nZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},eu=function(s,e){return function(t,i){e(t,i,s)}},Pd,ah;let ba=(ah=class extends K{static getInFocusedEditorOrParent(e){const t=Bde(e);return t?Pd.get(t):null}static get(e){return nKe(e.getContribution(Pd.ID))}constructor(e,t,i,n,o,r,a,l,c,d){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._configurationService=n,this._commandService=o,this._debounceService=r,this._languageFeaturesService=a,this._accessibilitySignalService=l,this._keybindingService=c,this._accessibilityService=d,this._editorObs=bn(this.editor),this._positions=ae(this,m=>{var p;return((p=this._editorObs.selections.read(m))==null?void 0:p.map(v=>v.getEndPosition()))??[new z(1,1)]}),this._suggestWidgetAdapter=this._register(new VYe(this._editorObs,m=>{var p;return(p=this.model.get())==null?void 0:p.handleSuggestAccepted(m)},()=>{var m,p;return(p=(m=this.model.get())==null?void 0:m.selectedInlineCompletion.get())==null?void 0:p.getSingleTextEdit()})),this._enabledInConfig=fi(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(71).enabled),this._isScreenReaderEnabled=fi(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this._editorDictationInProgress=fi(this,this._contextKeyService.onDidChangeContext,()=>this._contextKeyService.getContext(this.editor.getDomNode()).getValue("editorDictation.inProgress")===!0),this._enabled=ae(this,m=>this._enabledInConfig.read(m)&&(!this._isScreenReaderEnabled.read(m)||!this._editorDictationInProgress.read(m))),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._focusIsInMenu=ht(this,!1),this._focusIsInEditorOrMenu=ae(this,m=>{const p=this._editorObs.isFocused.read(m),v=this._focusIsInMenu.read(m);return p||v}),this._cursorIsInIndentation=ae(this,m=>{const p=this._editorObs.cursorPosition.read(m);if(p===null)return!1;const v=this._editorObs.model.read(m);if(!v)return!1;this._editorObs.versionId.read(m);const b=v.getLineIndentColumn(p.lineNumber);return p.column<=b}),this.model=gl(this,m=>{if(this._editorObs.isReadonly.read(m))return;const p=this._editorObs.model.read(m);return p?this._instantiationService.createInstance(V8,p,this._suggestWidgetAdapter.selectedItem,this._editorObs.versionId,this._positions,this._debounceValue,this._enabled,this.editor):void 0}).recomputeInitiallyAndOnChange(this._store),this._playAccessibilitySignal=xl(this),this._hideInlineEditOnSelectionChange=this._editorObs.getOption(71).map(m=>!0),this._view=this._register(this._instantiationService.createInstance(g6,this.editor,this.model,this._focusIsInMenu)),Pd._instances.add(this),this._register(Ve(()=>Pd._instances.delete(this))),this._register(lt(m=>{var w,C;const p=this.model.read(m);if(!p)return;const v=p.state.read(m);if(!v||!this._focusIsInEditorOrMenu.read(void 0))return;const b=v.kind==="inlineEdit"?v.nextEditUri:void 0;for(const y of Pd._instances)y!==this&&(b&&gm(b,(w=y.editor.getModel())==null?void 0:w.uri)?(C=y.model.read(void 0))==null||C.trigger():y.reject())})),this._register(lt(m=>{var b;const p=this.model.read(m),v=(b=this.editor.getModel())==null?void 0:b.uri;!p||!v||m.store.add(p.onDidAccept(()=>{var w,C;for(const y of Pd._instances){if(y===this)continue;const x=(w=y.model.read(void 0))==null?void 0:w.state.read(void 0);(x==null?void 0:x.kind)==="inlineEdit"&&gm(x.nextEditUri,v)&&((C=y.model.read(void 0))==null||C.stop("automatic"))}}))})),this._register(rd(this._editorObs.onDidType,(m,p)=>{var v;this._enabled.get()&&((v=this.model.get())==null||v.trigger())})),this._register(rd(this._editorObs.onDidPaste,(m,p)=>{var v;this._enabled.get()&&((v=this.model.get())==null||v.trigger())}));const h=new Set([_1.Tab.id,_1.DeleteLeft.id,_1.DeleteRight.id,_I,"acceptSelectedSuggestion",X2.ID,Y2.ID,Zi.NextMatchFindAction,...eR.getRegisteredCommands()]);this._register(this._commandService.onDidExecuteCommand(m=>{if(h.has(m.commandId)&&e.hasTextFocus()&&this._enabled.get()){let p=!1;m.commandId===_I&&(p=!0),this._editorObs.forceUpdate(v=>{var b;(b=this.model.get())==null||b.trigger(v,{noDelay:p})})}})),this._register(rd(this._editorObs.selections,(m,p,v)=>{var b,w,C,y;if(v.some(x=>x.reason===3||x.source==="api")){if(!this._hideInlineEditOnSelectionChange.get()&&((w=(b=this.model.get())==null?void 0:b.state.get())==null?void 0:w.kind)==="inlineEdit")return;const x=this.model.get();if(!x)return;((C=x.state.get())==null?void 0:C.kind)==="ghostText"&&((y=this.model.get())==null||y.stop())}})),this._register(lt(m=>{var b,w;const p=this._focusIsInEditorOrMenu.read(m),v=this.model.read(void 0);if(p){const C=v==null?void 0:v.state.read(void 0);(!C||C.kind!=="inlineEdit"||!C.nextEditUri)&&Ki(y=>{var x;for(const S of Pd._instances)S!==this&&((x=S.model.read(void 0))==null||x.stop("automatic",y))});return}this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(71).keepOnBlur||Bw.dropDownVisible||v&&((w=(b=v.state.read(void 0))==null?void 0:b.inlineCompletion)!=null&&w.isFromExplicitRequest&&v.inlineEditAvailable.read(void 0)||Ki(C=>{v.stop("automatic",C)}))})),this._register(lt(m=>{var v;const p=(v=this.model.read(m))==null?void 0:v.inlineCompletionState.read(m);p!=null&&p.suggestItem?p.primaryGhostText.lineCount>=2&&this._suggestWidgetAdapter.forceRenderingAbove():this._suggestWidgetAdapter.stopForceRenderingAbove()})),this._register(Ve(()=>{this._suggestWidgetAdapter.stopForceRenderingAbove()}));const u=Ef(this,(m,p)=>{var w;const v=this.model.read(m),b=v==null?void 0:v.state.read(m);return this._suggestWidgetAdapter.selectedItem.get()?p:(w=b==null?void 0:b.inlineCompletion)==null?void 0:w.semanticId});this._register(_ae(ae(m=>(this._playAccessibilitySignal.read(m),u.read(m),{})),async(m,p,v,b)=>{let w=this.model.get(),C=w==null?void 0:w.state.get();if(!C||!w||(await Sh(50,I9(b)),await sce(this._suggestWidgetAdapter.selectedItem,Mo,()=>!1,I9(b)),w=this.model.get(),C=w==null?void 0:w.state.get(),!C||!w))return;const y=C.kind==="ghostText"?w.textModel.getLineContent(C.primaryGhostText.lineNumber):"";this._accessibilitySignalService.playSignal(C.kind==="ghostText"?ur.inlineSuggestion:ur.nextEditSuggestion),this.editor.getOption(12)&&(C.kind==="ghostText"?this._provideScreenReaderUpdate(C.primaryGhostText.renderForScreenReader(y)):this._provideScreenReaderUpdate(""))})),this._register(this._configurationService.onDidChangeConfiguration(m=>{m.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})})),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")});const f=new rGe(this._contextKeyService);this._register(f.bind(Fi.cursorInIndentation,this._cursorIsInIndentation)),this._register(f.bind(Fi.hasSelection,m=>{var p;return!((p=this._editorObs.cursorSelection.read(m))!=null&&p.isEmpty())})),this._register(f.bind(Fi.cursorAtInlineEdit,this.model.map((m,p)=>{var v,b;return(b=(v=m==null?void 0:m.inlineEditState)==null?void 0:v.read(p))==null?void 0:b.cursorAtInlineEdit.read(p)}))),this._register(f.bind(Fi.tabShouldAcceptInlineEdit,this.model.map((m,p)=>!!(m!=null&&m.tabShouldAcceptInlineEdit.read(p))))),this._register(f.bind(Fi.tabShouldJumpToInlineEdit,this.model.map((m,p)=>!!(m!=null&&m.tabShouldJumpToInlineEdit.read(p))))),this._register(f.bind(Fi.inlineEditVisible,m=>{var p;return((p=this.model.read(m))==null?void 0:p.inlineEditState.read(m))!==void 0})),this._register(f.bind(Fi.inlineSuggestionHasIndentation,m=>{var p,v;return(v=(p=this.model.read(m))==null?void 0:p.getIndentationInfo(m))==null?void 0:v.startsWithIndentation})),this._register(f.bind(Fi.inlineSuggestionHasIndentationLessThanTabSize,m=>{var p,v;return(v=(p=this.model.read(m))==null?void 0:p.getIndentationInfo(m))==null?void 0:v.startsWithIndentationLessThanTabSize})),this._register(f.bind(Fi.suppressSuggestions,m=>{const p=this.model.read(m),v=p==null?void 0:p.inlineCompletionState.read(m);return v!=null&&v.primaryGhostText&&(v!=null&&v.inlineCompletion)?v.inlineCompletion.source.inlineSuggestions.suppressSuggestions:void 0})),this._register(f.bind(Fi.inlineSuggestionVisible,m=>{const p=this.model.read(m),v=p==null?void 0:p.inlineCompletionState.read(m);return!!(v!=null&&v.inlineCompletion)&&(v==null?void 0:v.primaryGhostText)!==void 0&&!(v!=null&&v.primaryGhostText.isEmpty())}));const g=ae(this,m=>{const p=this.model.read(m),v=p==null?void 0:p.inlineCompletionState.read(m),b=v==null?void 0:v.primaryGhostText;return!b||b.isEmpty()?void 0:new z(b.lineNumber,b.parts[0].column)});this._register(f.bind(Fi.cursorBeforeGhostText,m=>{const p=g.read(m);if(!p)return!1;const v=this._editorObs.cursorPosition.read(m);return v?p.equals(v):!1})),this._register(this._instantiationService.createInstance(E8,this.editor))}playAccessibilitySignal(e){this._playAccessibilitySignal.trigger(e)}_provideScreenReaderUpdate(e){const t=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let n;!t&&i&&this.editor.getOption(169)&&(n=_(1204,"Inspect this in the accessible view ({0})",i.getAriaLabel())),br(n?e+", "+n:e)}shouldShowHoverAt(e){var i;const t=(i=this.model.get())==null?void 0:i.primaryGhostText.get();return t?t.parts.some(n=>e.containsPosition(new z(t.lineNumber,n.column))):!1}shouldShowHoverAtViewZone(e){return this._view.shouldShowHoverAtViewZone(e)}reject(){Ki(e=>{var i;const t=this.model.get();if(t&&(t.stop("explicitCancel",e),this._focusIsInEditorOrMenu.get()))for(const n of Pd._instances)n!==this&&((i=n.model.get())==null||i.stop("automatic",e))})}jump(){const e=this.model.get();e&&e.jump()}},Pd=ah,ah._instances=new Set,ah.hot=a4(ah),ah.ID="editor.contrib.inlineCompletionsController",ah);ba=Pd=nZe([eu(1,$e),eu(2,ut),eu(3,xt),eu(4,en),eu(5,$l),eu(6,We),eu(7,Df),eu(8,ai),eu(9,so)],ba);const aP=class aP extends Fe{constructor(){super({id:aP.ID,label:ne(1183,"Show Next Inline Suggestion"),precondition:de.and(B.writable,Fi.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}async run(e,t){var n;const i=ba.get(t);(n=i==null?void 0:i.model.get())==null||n.next()}};aP.ID=ade;let m6=aP;const lP=class lP extends Fe{constructor(){super({id:lP.ID,label:ne(1184,"Show Previous Inline Suggestion"),precondition:de.and(B.writable,Fi.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}async run(e,t){var n;const i=ba.get(t);(n=i==null?void 0:i.model.get())==null||n.previous()}};lP.ID=rde;let p6=lP;const sZe="vscode://schemas/inlineCompletionProviderIdArgs";function oZe(s){const e=[];return s.providerId&&(e.push(s.providerId.toStringWithoutVersion()),e.push(s.providerId.extensionId+":*")),e}const Ree=uKe(dKe({showNoResultNotification:r3(IJ()),providerId:r3(gKe(sZe,rKe())),explicit:r3(IJ())}),lKe());class rZe extends Fe{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:ne(1185,"Trigger Inline Suggestion"),precondition:B.writable,metadata:{description:_(1172,"Triggers an inline suggestion in the editor."),args:[{name:"args",description:_(1173,"Options for triggering inline suggestions."),isOptional:!0,schema:Ree.getJSONSchema()}]}})}async run(e,t,i){var c;const n=e.get(Hn),o=e.get(We),r=ba.get(t),a=Ree.validateOrThrow(i),l=a!=null&&a.providerId?o.inlineCompletionsProvider.all(t.getModel()).find(d=>oZe(d).some(h=>h===a.providerId)):void 0;await bTe(async d=>{var h;await((h=r==null?void 0:r.model.get())==null?void 0:h.trigger(d,{provider:l,explicit:(a==null?void 0:a.explicit)??!0})),r==null||r.playAccessibilitySignal(d)}),a!=null&&a.showNoResultNotification&&((c=r==null?void 0:r.model.get())!=null&&c.state.get()||n.notify({severity:f0.Info,message:_(1174,"No inline suggestion is available.")}))}}class aZe extends Fe{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:ne(1186,"Accept Next Word Of Inline Suggestion"),precondition:de.and(B.writable,Fi.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:de.and(B.writable,Fi.inlineSuggestionVisible,Fi.cursorBeforeGhostText,a0.negate())},menuOpts:[{menuId:He.InlineSuggestionToolbar,title:_(1175,"Accept Word"),group:"primary",order:2}]})}async run(e,t){var n;const i=ba.get(t);await((n=i==null?void 0:i.model.get())==null?void 0:n.acceptNextWord())}}class lZe extends Fe{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:ne(1187,"Accept Next Line Of Inline Suggestion"),precondition:de.and(B.writable,Fi.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:He.InlineSuggestionToolbar,title:_(1176,"Accept Line"),group:"secondary",order:2}]})}async run(e,t){var n;const i=ba.get(t);await((n=i==null?void 0:i.model.get())==null?void 0:n.acceptNextLine())}}class cZe extends Fe{constructor(){super({id:_I,label:ne(1188,"Accept Inline Suggestion"),precondition:de.or(Fi.inlineSuggestionVisible,Fi.inlineEditVisible),menuOpts:[{menuId:He.InlineSuggestionToolbar,title:_(1177,"Accept"),group:"primary",order:2},{menuId:He.InlineEditsActions,title:_(1178,"Accept"),group:"primary",order:2}],kbOpts:[{primary:2,weight:200,kbExpr:de.or(de.and(Fi.inlineSuggestionVisible,B.tabMovesFocus.toNegated(),Pt.Visible.toNegated(),B.hoverFocused.toNegated(),Fi.hasSelection.toNegated(),Fi.inlineSuggestionHasIndentationLessThanTabSize),de.and(Fi.inlineEditVisible,B.tabMovesFocus.toNegated(),Pt.Visible.toNegated(),B.hoverFocused.toNegated(),Fi.tabShouldAcceptInlineEdit))}]})}async run(e,t){var n;const i=ba.getInFocusedEditorOrParent(e);i&&((n=i.model.get())==null||n.accept(i.editor),i.editor.focus())}}Ks.registerKeybindingRule({id:_I,weight:202,primary:2,when:de.and(Fi.inInlineEditsPreviewEditor)});class dZe extends Fe{constructor(){super({id:tze,label:ne(1189,"Jump to next inline edit"),precondition:Fi.inlineEditVisible,menuOpts:[{menuId:He.InlineEditsActions,title:_(1179,"Jump"),group:"primary",order:1,when:Fi.cursorAtInlineEdit.toNegated()}],kbOpts:{primary:2,weight:201,kbExpr:de.and(Fi.inlineEditVisible,B.tabMovesFocus.toNegated(),Pt.Visible.toNegated(),B.hoverFocused.toNegated(),Fi.tabShouldJumpToInlineEdit)}})}async run(e,t){const i=ba.get(t);i&&i.jump()}}const cP=class cP extends Fe{constructor(){super({id:cP.ID,label:ne(1190,"Hide Inline Suggestion"),precondition:de.or(Fi.inlineSuggestionVisible,Fi.inlineEditVisible),kbOpts:{weight:190,primary:9},menuOpts:[{menuId:He.InlineEditsActions,title:_(1180,"Reject"),group:"primary",order:3}]})}async run(e,t){const i=ba.getInFocusedEditorOrParent(e);Ki(n=>{var o;(o=i==null?void 0:i.model.get())==null||o.stop("explicitCancel",n)}),i==null||i.editor.focus()}};cP.ID=lde;let bM=cP;const dP=class dP extends Fe{constructor(){super({id:dP.ID,label:ne(1191,"Toggle Inline Suggestions Show Collapsed"),precondition:de.true()})}async run(e,t){const i=e.get(xt),n=i.getValue("editor.inlineSuggest.edits.showCollapsed");i.updateValue("editor.inlineSuggest.edits.showCollapsed",!n)}};dP.ID=CW;let _6=dP;Ks.registerKeybindingRule({id:bM.ID,weight:-1,primary:9,secondary:[1033],when:de.and(Fi.inInlineEditsPreviewEditor)});const hP=class hP extends Gs{constructor(){super({id:hP.ID,title:_(1181,"Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:He.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:de.equals("config.editor.inlineSuggest.showToolbar","always")})}async run(e){const t=e.get(xt),n=t.getValue("editor.inlineSuggest.showToolbar")==="always"?"onHover":"always";t.updateValue("editor.inlineSuggest.showToolbar",n)}};hP.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";let b6=hP;class hZe extends Fe{constructor(){super({id:"editor.action.inlineSuggest.dev.extractRepro",label:_(1182,"Developer: Extract Inline Suggest State"),alias:"Developer: Inline Suggest Extract Repro",precondition:de.or(Fi.inlineEditVisible,Fi.inlineSuggestionVisible)})}async run(e,t){const i=e.get(pa),n=ba.get(t),o=n==null?void 0:n.model.get();if(!o)return;const r=o.extractReproSample(),l=fa(JSON.stringify({inlineCompletion:r.inlineCompletion},null,4)).map(d=>"// "+d).join(`
`),c=`${r.documentValue}

// <json>
${l}
// </json>
`;return await i.writeText(c),{reproCase:c}}}var uZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},lT=function(s,e){return function(t,i){e(t,i,s)}};class fZe{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let v6=class{constructor(e,t,i,n,o){this._editor=e,this.accessibilityService=t,this._instantiationService=i,this._telemetryService=n,this._markdownRendererService=o,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=ba.get(this._editor);if(!t)return null;const i=e.target;if(i.type===8){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new IS(1e3,this,D.fromPositions(this._editor.getModel().validatePosition(n.positionBefore||n.position)),e.event.posx,e.event.posy,!1)}if(i.type===7&&t.shouldShowHoverAt(i.range))return new IS(1e3,this,i.range,e.event.posx,e.event.posy,!1);if(i.type===6&&i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range))return new IS(1e3,this,i.range,e.event.posx,e.event.posy,!1);if(i.type===9&&i.element){const n=MI.getWarningWidgetContext(i.element);if(n&&t.shouldShowHoverAt(n.range))return new IS(1e3,this,n.range,e.event.posx,e.event.posy,!1)}return null}computeSync(e,t){if(this._editor.getOption(71).showToolbar!=="onHover")return[];const i=ba.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new fZe(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new oe,n=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(12)&&i.add(this.renderScreenReaderText(e,n));const o=n.controller.model.get(),r=document.createElement("div");e.fragment.appendChild(r),i.add(Ao((l,c)=>{const d=c.add(this._instantiationService.createInstance(Bw.hot.read(l),this._editor,!1,Gi(null),o.selectedInlineCompletionIndex,o.inlineCompletionsCount,o.activeCommands,o.warning,()=>{e.onContentsChanged()}));r.replaceChildren(d.getDomNode())})),o.triggerExplicitly();const a={hoverPart:n,hoverElement:r,dispose(){i.dispose()}};return new Jb([a])}getAccessibleContent(e){return _(1205,"There are inline completions here")}renderScreenReaderText(e,t){const i=new oe,n=we,o=n("div.hover-row.markdown-hover"),r=me(o,n("div.hover-contents",{"aria-live":"assertive"})),a=l=>{const c=_(1206,"Suggestion:"),d=i.add(this._markdownRendererService.render(new To().appendText(c).appendCodeblock("text",l),{context:this._editor,asyncRenderCallback:()=>{r.className="hover-contents code-hover-contents",e.onContentsChanged()}}));r.replaceChildren(d.element)};return i.add(lt(l=>{var d;const c=(d=t.controller.model.read(l))==null?void 0:d.primaryGhostText.read(l);if(c){const h=this._editor.getModel().getLineContent(c.lineNumber);a(c.renderForScreenReader(h))}else Os(r)})),e.fragment.appendChild(o),i}};v6=uZe([lT(1,so),lT(2,$e),lT(3,Wo),lT(4,Sc)],v6);class gZe{}Qt(ba.ID,sKe(ba.hot),3);xe(rZe);xe(m6);xe(p6);xe(aZe);xe(lZe);xe(cZe);xe(_6);xe(bM);xe(dZe);Ei(b6);xe(hZe);Ei(B8);Ei(W8);kv.register(v6);M4.register(new gZe);var mZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},y3=function(s,e){return function(t,i){e(t,i,s)}},MS,om;let OI=(om=class{constructor(e,t,i,n){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=n,this.toUnhook=new oe,this.toUnhookForKeyboard=new oe,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const o=new y4(e);this.toUnhook.add(o),this.toUnhook.add(o.onMouseMoveOrRelevantKeyDown(([r,a])=>{this.startFindDefinitionFromMouse(r,a??void 0)})),this.toUnhook.add(o.onExecute(r=>{this.isEnabled(r)&&this.gotoDefinition(r.target.position,r.hasSideBySideModifier).catch(a=>{_t(a)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(o.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(MS.ID)}async startFindDefinitionFromCursor(e){await this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}async startFindDefinition(e){var r;this.toUnhookForKeyboard.clear();const t=e?(r=this.editor.getModel())==null?void 0:r.getWordAtPosition(e):null;if(!t){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===t.startColumn&&this.currentWordAtPosition.endColumn===t.endColumn&&this.currentWordAtPosition.word===t.word)return;this.currentWordAtPosition=t;const i=new kce(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=ys(a=>this.findDefinition(e,a));let n;try{n=await this.previousPromise}catch(a){_t(a);return}if(!n||!n.length||!i.validate(this.editor)){this.removeLinkDecorations();return}const o=n[0].originSelectionRange?D.lift(n[0].originSelectionRange):new D(e.lineNumber,t.startColumn,e.lineNumber,t.endColumn);if(n.length>1){let a=o;for(const{originSelectionRange:l}of n)l&&(a=D.plusRange(a,l));this.addDecoration(a,new To().appendText(_(1077,"Click to show {0} definitions.",n.length)))}else{const a=n[0];return a.uri?this.textModelResolverService.createModelReference(a.uri).then(l=>{if(!l.object||!l.object.textEditorModel){l.dispose();return}const{object:{textEditorModel:c}}=l,{startLineNumber:d}=a.range;if(d<1||d>c.getLineCount()){l.dispose();return}const h=this.getPreviewValue(c,d,a),u=this.languageService.guessLanguageIdByFilepathOrFirstLine(c.uri);this.addDecoration(o,h?new To().appendCodeblock(u||"",h):void 0),l.dispose()}):void 0}}getPreviewValue(e,t,i){let n=i.range;return n.endLineNumber-n.startLineNumber>=MS.MAX_SOURCE_PREVIEW_LINES&&(n=this.getPreviewRangeBasedOnIndentation(e,t)),n=e.validateRange(n),this.stripIndentationFromPreviewRange(e,t,n)}stripIndentationFromPreviewRange(e,t,i){let o=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);o=Math.min(o,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${o-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),n=Math.min(e.getLineCount(),t+MS.MAX_SOURCE_PREVIEW_LINES);let o=t+1;for(;o<n;o++){const r=e.getLineFirstNonWhitespaceColumn(o);if(i===r)break}return new D(t,1,o+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){var i;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&e.target.type===6&&!(((i=e.target.detail.injectedText)==null?void 0:i.options)instanceof Cm)&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?Wk(this.languageFeaturesService.definitionProvider,i,e,!1,t):Promise.resolve(null)}async gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const n=!t&&this.editor.getOption(101)&&!this.isInPeekEditor(i);return new Vk({openToSide:t,openInPeek:n,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(i)})}isInPeekEditor(e){const t=e.get(ut);return Ur.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}},MS=om,om.ID="editor.contrib.gotodefinitionatposition",om.MAX_SOURCE_PREVIEW_LINES=8,om);OI=MS=mZe([y3(1,nr),y3(2,Wn),y3(3,We)],OI);Qt(OI.ID,OI,2);class pZe extends Fe{constructor(){super({id:"editor.action.debugEditorGpuRenderer",label:ne(1101,"Developer: Debug Editor GPU Renderer"),precondition:de.true()})}async run(e,t){const i=e.get($e),o=await e.get(Fo).pick([{label:_(1098,"Log Texture Atlas Stats"),id:"logTextureAtlasStats"},{label:_(1099,"Save Texture Atlas"),id:"saveTextureAtlas"},{label:_(1100,"Draw Glyph"),id:"drawGlyph"}],{canPickMany:!1});if(o)switch(o.id){case"logTextureAtlasStats":i.invokeFunction(r=>{const a=r.get(Ji),l=Yo.atlas;if(!Yo.atlas){a.error("No texture atlas found");return}const c=l.getStats();a.info(["Texture atlas stats",...c].join(`

`))});break;case"saveTextureAtlas":i.invokeFunction(async r=>{const a=r.get(wf),l=r.get(uee),c=a.getWorkspace().folders;if(c.length>0){const d=Yo.atlas,h=[];for(const[u,f]of d.pages.entries())h.push(l.writeFile(Ze.joinPath(c[0].uri,`textureAtlasPage${u}_actual.png`),Og.wrap(new Uint8Array(await(await f.source.convertToBlob()).arrayBuffer()))),l.writeFile(Ze.joinPath(c[0].uri,`textureAtlasPage${u}_usage.png`),Og.wrap(new Uint8Array(await(await f.getUsagePreview()).arrayBuffer()))));await Promise.all(h)}});break;case"drawGlyph":i.invokeFunction(async r=>{var M,R,T;const a=r.get(xt),l=r.get(uee),c=r.get(Fo),h=r.get(wf).getWorkspace().folders;if(h.length===0)return;const u=Yo.atlas,f=a.getValue("editor.fontFamily"),g=a.getValue("editor.fontSize"),m=new jL(g,f,xi().devicePixelRatio,Yo.decorationStyleCache);let p=await c.input({prompt:"Enter a character to draw (prefix with 0x for code point))"});if(!p)return;const v=(R=(M=p.match(/0x(?<codePoint>[0-9a-f]+)/i))==null?void 0:M.groups)==null?void 0:R.codePoint;v!==void 0&&(p=String.fromCodePoint(parseInt(v,16)));const b=0,C=u.getGlyph(m,p,b,0,0);if(!C)return;const y=(T=u.pages[C.pageIndex].source.getContext("2d"))==null?void 0:T.getImageData(C.x,C.y,C.w,C.h);if(!y)return;const x=new OffscreenCanvas(y.width,y.height);Bb(x.getContext("2d")).putImageData(y,0,0);const L=await x.convertToBlob({type:"image/png"}),E=Ze.joinPath(h[0].uri,`glyph_${p}_${b}_${g}px_${f.replaceAll(/[,\\\/\.'\s]/g,"_")}.png`);await l.writeFile(E,Og.wrap(new Uint8Array(await L.arrayBuffer())))});break}}}xe(pZe);var Rc;(function(s){s.NoAutoFocus="noAutoFocus",s.FocusIfVisible="focusIfVisible",s.AutoFocusImmediately="autoFocusImmediately"})(Rc||(Rc={}));class _Ze extends Fe{constructor(){super({id:ode,label:ne(1107,"Show or Focus Hover"),metadata:{description:ne(1108,"Show or focus the editor hover which shows documentation, references, and other content for a symbol at the current cursor position."),args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if and when the hover should take focus upon being triggered by this action.",enum:[Rc.NoAutoFocus,Rc.FocusIfVisible,Rc.AutoFocusImmediately],enumDescriptions:[_(1104,"The hover will not automatically take focus."),_(1105,"The hover will take focus only if it is already visible."),_(1106,"The hover will automatically take focus when it appears.")],default:Rc.FocusIfVisible}}}}]},precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:ls(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const n=Bo.get(t);if(!n)return;const o=i==null?void 0:i.focus;let r=Rc.FocusIfVisible;Object.values(Rc).includes(o)?r=o:typeof o=="boolean"&&o&&(r=Rc.AutoFocusImmediately);const a=c=>{const d=t.getPosition(),h=new D(d.lineNumber,d.column,d.lineNumber,d.column);n.showContentHover(h,1,2,c)},l=t.getOption(2)===2;n.isHoverVisible?r!==Rc.NoAutoFocus?n.focus():a(l):a(l||r===Rc.AutoFocusImmediately)}}class bZe extends Fe{constructor(){super({id:UVe,label:ne(1109,"Show Definition Preview Hover"),precondition:void 0,metadata:{description:ne(1110,"Show the definition preview hover in the editor.")}})}run(e,t){const i=Bo.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const o=new D(n.lineNumber,n.column,n.lineNumber,n.column),r=OI.get(t);if(!r)return;r.startFindDefinitionFromCursor(n).then(()=>{i.showContentHover(o,1,2,!0)})}}class vZe extends Fe{constructor(){super({id:$Ve,label:ne(1111,"Hide Hover"),alias:"Hide Content Hover",precondition:void 0})}run(e,t){var i;(i=Bo.get(t))==null||i.hideContentHover()}}class CZe extends Fe{constructor(){super({id:qVe,label:ne(1112,"Scroll Up Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:16,weight:100},metadata:{description:ne(1113,"Scroll up the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.scrollUp()}}class wZe extends Fe{constructor(){super({id:jVe,label:ne(1114,"Scroll Down Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:18,weight:100},metadata:{description:ne(1115,"Scroll down the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.scrollDown()}}class yZe extends Fe{constructor(){super({id:KVe,label:ne(1116,"Scroll Left Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:15,weight:100},metadata:{description:ne(1117,"Scroll left the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.scrollLeft()}}class SZe extends Fe{constructor(){super({id:GVe,label:ne(1118,"Scroll Right Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:17,weight:100},metadata:{description:ne(1119,"Scroll right the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.scrollRight()}}class xZe extends Fe{constructor(){super({id:YVe,label:ne(1120,"Page Up Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:11,secondary:[528],weight:100},metadata:{description:ne(1121,"Page up the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.pageUp()}}class LZe extends Fe{constructor(){super({id:XVe,label:ne(1122,"Page Down Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:12,secondary:[530],weight:100},metadata:{description:ne(1123,"Page down the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.pageDown()}}class IZe extends Fe{constructor(){super({id:ZVe,label:ne(1124,"Go To Top Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:14,secondary:[2064],weight:100},metadata:{description:ne(1125,"Go to the top of the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.goToTop()}}class EZe extends Fe{constructor(){super({id:QVe,label:ne(1126,"Go To Bottom Hover"),precondition:B.hoverFocused,kbOpts:{kbExpr:B.hoverFocused,primary:13,secondary:[2066],weight:100},metadata:{description:ne(1127,"Go to the bottom of the editor hover.")}})}run(e,t){const i=Bo.get(t);i&&i.goToBottom()}}class kZe extends Fe{constructor(){super({id:_4,label:JVe,alias:"Increase Hover Verbosity Level",precondition:B.hoverVisible})}run(e,t,i){const n=Bo.get(t);if(!n)return;const o=(i==null?void 0:i.index)!==void 0?i.index:n.focusedHoverPartIndex();n.updateHoverVerbosityLevel(ea.Increase,o,i==null?void 0:i.focus)}}class DZe extends Fe{constructor(){super({id:b4,label:eze,alias:"Decrease Hover Verbosity Level",precondition:B.hoverVisible})}run(e,t,i){var r;const n=Bo.get(t);if(!n)return;const o=(i==null?void 0:i.index)!==void 0?i.index:n.focusedHoverPartIndex();(r=Bo.get(t))==null||r.updateHoverVerbosityLevel(ea.Decrease,o,i==null?void 0:i.focus)}}class TZe{constructor(e){this._editor=e}computeSync(e){var r;const t=a=>({value:a}),i=this._editor.getLineDecorations(e.lineNumber),n=[],o=e.laneOrLine==="lineNo";if(!i)return n;for(const a of i){const l=((r=a.options.glyphMargin)==null?void 0:r.position)??cd.Center;if(!o&&l!==e.laneOrLine)continue;const c=o?a.options.lineNumberHoverMessage:a.options.glyphMarginHoverMessage;!c||Mw(c)||n.push(...DU(c).map(t))}return n}}var NZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},RZe=function(s,e){return function(t,i){e(t,i,s)}},C6;const Mee=we;var sb;let w6=(sb=class extends K{constructor(e,t){super(),this._markdownRendererService=t,this.allowEditorOverflow=!0,this._renderDisposeables=this._register(new oe),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new Pq(!0)),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._hoverOperation=this._register(new cde(this._editor,new TZe(this._editor))),this._register(this._hoverOperation.onResult(i=>this._withResult(i))),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(59)&&this._updateFont()})),this._register(Jn(this._hover.containerDomNode,"mouseleave",i=>{this._onMouseLeave(i)})),this._editor.addOverlayWidget(this)}dispose(){this._hoverComputerOptions=void 0,this._editor.removeOverlayWidget(this),super.dispose()}getId(){return C6.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_onModelDecorationsChanged(){this._isVisible&&this._hoverComputerOptions&&(this._hoverOperation.cancel(),this._hoverOperation.start(0,this._hoverComputerOptions))}showsOrWillShow(e){const t=e.target;return t.type===2&&t.detail.glyphMarginLane?(this._startShowingAt(t.position.lineNumber,t.detail.glyphMarginLane),!0):t.type===3?(this._startShowingAt(t.position.lineNumber,"lineNo"),!0):!1}_startShowingAt(e,t){this._hoverComputerOptions&&this._hoverComputerOptions.lineNumber===e&&this._hoverComputerOptions.laneOrLine===t||(this._hoverOperation.cancel(),this.hide(),this._hoverComputerOptions={lineNumber:e,laneOrLine:t},this._hoverOperation.start(0,this._hoverComputerOptions))}hide(){this._hoverComputerOptions=void 0,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e.value,this._messages.length>0?this._renderMessages(e.options.lineNumber,e.options.laneOrLine,this._messages):this.hide()}_renderMessages(e,t,i){this._renderDisposeables.clear();const n=document.createDocumentFragment();for(const o of i){const r=Mee("div.hover-row.markdown-hover"),a=me(r,Mee("div.hover-contents")),l=this._renderDisposeables.add(this._markdownRendererService.render(o.value,{context:this._editor}));a.appendChild(l.element),n.appendChild(r)}this._updateContents(n),this._showAt(e,t)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e,t){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const i=this._editor.getLayoutInfo(),n=this._editor.getTopForLineNumber(e),o=this._editor.getScrollTop(),r=this._editor.getOption(75),a=this._hover.containerDomNode.clientHeight,l=n-o-(a-r)/2,c=i.glyphMarginLeft+i.glyphMarginWidth+(t==="lineNo"?i.lineNumbersWidth:0),h=i.height-a,u=Math.max(0,Math.min(Math.round(l),h));if(this._editor.getOption(51)){const g=this._editor.getDomNode();if(g){const m=Fn(g);this._hover.containerDomNode.style.position="fixed",this._hover.containerDomNode.style.left=`${m.left+c}px`,this._hover.containerDomNode.style.top=`${m.top+u}px`}}else this._hover.containerDomNode.style.position="absolute",this._hover.containerDomNode.style.left=`${c}px`,this._hover.containerDomNode.style.top=`${u}px`;this._hover.containerDomNode.style.zIndex="11"}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!v4(t,e.x,e.y))&&this.hide()}},C6=sb,sb.ID="editor.contrib.modesGlyphHoverWidget",sb);w6=C6=NZe([RZe(1,Sc)],w6);var MZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},AZe=function(s,e){return function(t,i){e(t,i,s)}},X1;let vM=(X1=class extends K{constructor(e,t){super(),this._editor=e,this._instantiationService=t,this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new oe,this._hoverState={mouseDown:!1},this._reactToEditorMouseMoveRunner=this._register(new Ni(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(69)&&(this._unhookListeners(),this._hookListeners())}))}_hookListeners(){const e=this._editor.getOption(69);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this.hideGlyphHover()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this.hideGlyphHover()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._isMouseOnGlyphHoverWidget(e)&&this.hideGlyphHover()}_isMouseOnGlyphHoverWidget(e){var i;const t=(i=this._glyphWidget)==null?void 0:i.getDomNode();return t?v4(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._isMouseOnGlyphHoverWidget(e))||this.hideGlyphHover()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=this._isMouseOnGlyphHoverWidget(e);return t&&i}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave)return;if(this._mouseMoveEvent=e,this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){!e||this._tryShowHoverWidget(e)||this.hideGlyphHover()}_tryShowHoverWidget(e){return this._getOrCreateGlyphWidget().showsOrWillShow(e)}_onKeyDown(e){this._editor.hasModel()&&(e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||this.hideGlyphHover())}hideGlyphHover(){var e;(e=this._glyphWidget)==null||e.hide()}_getOrCreateGlyphWidget(){return this._glyphWidget||(this._glyphWidget=this._instantiationService.createInstance(w6,this._editor)),this._glyphWidget}dispose(){var e;super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),(e=this._glyphWidget)==null||e.dispose()}},X1.ID="editor.contrib.marginHover",X1);vM=MZe([AZe(1,$e)],vM);class PZe{}class OZe{}class FZe{}Qt(Bo.ID,Bo,2);Qt(vM.ID,vM,2);xe(_Ze);xe(bZe);xe(vZe);xe(CZe);xe(wZe);xe(yZe);xe(SZe);xe(xZe);xe(LZe);xe(IZe);xe(EZe);xe(kZe);xe(DZe);kv.register(vI);kv.register(n8);Ul((s,e)=>{const t=s.getColor(r$);t&&(e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${t.transparent(.5)}; }`))});M4.register(new PZe);M4.register(new OZe);M4.register(new FZe);function _ue(s,e,t,i){if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return[];const n=e.getLanguageConfiguration(s.getLanguageId()).indentRulesSupport;if(!n)return[];const o=new YU(s,n,e);for(i=Math.min(i,s.getLineCount());t<=i&&o.shouldIgnore(t);)t++;if(t>i-1)return[];const{tabSize:r,indentSize:a,insertSpaces:l}=s.getOptions(),c=(m,p)=>(p=p||1,Wl.shiftIndent(m,m.length+p,r,a,l)),d=(m,p)=>(p=p||1,Wl.unshiftIndent(m,m.length+p,r,a,l)),h=[],u=s.getLineContent(t);let f=Ui(u),g=f;o.shouldIncrease(t)?(g=c(g),f=c(f)):o.shouldIndentNextLine(t)&&(g=c(g)),t++;for(let m=t;m<=i;m++){if(BZe(s,m))continue;const p=s.getLineContent(m),v=Ui(p),b=g;o.shouldDecrease(m,b)&&(g=d(g),f=d(f)),v!==g&&h.push(Pn.replaceMove(new Oe(m,1,m,v.length+1),zU(g,a,l))),!o.shouldIgnore(m)&&(o.shouldIncrease(m,b)?(f=c(f),g=f):o.shouldIndentNextLine(m,b)?g=c(g):g=f)}return h}function BZe(s,e){return s.tokenization.isCheapToTokenize(e)?s.tokenization.getLineTokens(e).getStandardTokenType(0)===2:!1}var WZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},HZe=function(s,e){return function(t,i){e(t,i,s)}};const uP=class uP extends Fe{constructor(){super({id:uP.ID,label:ne(1148,"Convert Indentation to Spaces"),precondition:B.writable,metadata:{description:ne(1149,"Convert the tab indentation to spaces.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new qZe(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}};uP.ID="editor.action.indentationToSpaces";let y6=uP;const fP=class fP extends Fe{constructor(){super({id:fP.ID,label:ne(1150,"Convert Indentation to Tabs"),precondition:B.writable,metadata:{description:ne(1151,"Convert the spaces indentation to tabs.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new jZe(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}};fP.ID="editor.action.indentationToTabs";let S6=fP;class Ej extends Fe{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(Fo),n=e.get(Cn),o=t.getModel();if(!o)return;const r=n.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget),a=o.getOptions(),l=[1,2,3,4,5,6,7,8].map(d=>({id:d.toString(),label:d.toString(),description:d===r.tabSize&&d===a.tabSize?_(1144,"Configured Tab Size"):d===r.tabSize?_(1145,"Default Tab Size"):d===a.tabSize?_(1146,"Current Tab Size"):void 0})),c=Math.min(o.getOptions().tabSize-1,7);setTimeout(()=>{i.pick(l,{placeHolder:_(1147,"Select Tab Size for Current File"),activeItem:l[c]}).then(d=>{if(d&&o&&!o.isDisposed()){const h=parseInt(d.label,10);this.displaySizeOnly?o.updateOptions({tabSize:h}):o.updateOptions({tabSize:h,indentSize:h,insertSpaces:this.insertSpaces})}})},50)}}const gP=class gP extends Ej{constructor(){super(!1,!1,{id:gP.ID,label:ne(1152,"Indent Using Tabs"),precondition:void 0,metadata:{description:ne(1153,"Use indentation with tabs.")}})}};gP.ID="editor.action.indentUsingTabs";let x6=gP;const mP=class mP extends Ej{constructor(){super(!0,!1,{id:mP.ID,label:ne(1154,"Indent Using Spaces"),precondition:void 0,metadata:{description:ne(1155,"Use indentation with spaces.")}})}};mP.ID="editor.action.indentUsingSpaces";let L6=mP;const pP=class pP extends Ej{constructor(){super(!0,!0,{id:pP.ID,label:ne(1156,"Change Tab Display Size"),precondition:void 0,metadata:{description:ne(1157,"Change the space size equivalent of the tab.")}})}};pP.ID="editor.action.changeTabDisplaySize";let I6=pP;const _P=class _P extends Fe{constructor(){super({id:_P.ID,label:ne(1158,"Detect Indentation from Content"),precondition:void 0,metadata:{description:ne(1159,"Detect the indentation from content.")}})}run(e,t){const i=e.get(Cn),n=t.getModel();if(!n)return;const o=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(o.insertSpaces,o.tabSize)}};_P.ID="editor.action.detectIndentation";let E6=_P;class VZe extends Fe{constructor(){super({id:"editor.action.reindentlines",label:ne(1160,"Reindent Lines"),precondition:B.writable,metadata:{description:ne(1161,"Reindent the lines of the editor.")},canTriggerInlineEdits:!0})}run(e,t){const i=e.get(wn),n=t.getModel();if(!n)return;const o=_ue(n,i,1,n.getLineCount());o.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop())}}class zZe extends Fe{constructor(){super({id:"editor.action.reindentselectedlines",label:ne(1162,"Reindent Selected Lines"),precondition:B.writable,metadata:{description:ne(1163,"Reindent the selected lines of the editor.")},canTriggerInlineEdits:!0})}run(e,t){const i=e.get(wn),n=t.getModel();if(!n)return;const o=t.getSelections();if(o===null)return;const r=[];for(const a of o){let l=a.startLineNumber,c=a.endLineNumber;if(l!==c&&a.endColumn===1&&c--,l===1){if(l===c)continue}else l--;const d=_ue(n,i,l,c);r.push(...d)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class UZe{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&typeof i.text=="string"&&this._edits.push(i)}getEditOperations(e,t){for(const n of this._edits)t.addEditOperation(D.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}var Z1;let CM=(Z1=class{constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new oe,this.callOnModel=new oe,this.callOnDispose.add(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.add(e.onDidChangeModel(()=>this.update())),this.callOnDispose.add(e.onDidChangeModelLanguage(()=>this.update()))}update(){this.callOnModel.clear(),!(!this.editor.getOption(17)||this.editor.getOption(16)<4)&&this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste(({range:e})=>{this.trigger(e)}))}trigger(e){const t=this.editor.getSelections();if(t===null||t.length>1)return;const i=this.editor.getModel();if(!i||this.rangeContainsOnlyWhitespaceCharacters(i,e)||!this.editor.getOption(18)&&$Ze(i,e)||!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const o=this.editor.getOption(16),{tabSize:r,indentSize:a,insertSpaces:l}=i.getOptions(),c=[],d={shiftIndent:g=>Wl.shiftIndent(g,g.length+1,r,a,l),unshiftIndent:g=>Wl.unshiftIndent(g,g.length+1,r,a,l)};let h=e.startLineNumber,u=i.getLineContent(h);if(!/\S/.test(u.substring(0,e.startColumn-1))){const g=$S(o,i,i.getLanguageId(),h,d,this._languageConfigurationService);if(g!==null){const m=Ui(u),p=Zr(g,r),v=Zr(m,r);if(p!==v){const b=mx(p,r,l);c.push({range:new D(h,1,h,m.length+1),text:b}),u=b+u.substring(m.length)}else{const b=ire(i,h,this._languageConfigurationService);if(b===0||b===8)return}}}const f=h;for(;h<e.endLineNumber;){if(!/\S/.test(i.getLineContent(h+1))){h++;continue}break}if(h!==e.endLineNumber){const m=$S(o,{tokenization:{getLineTokens:p=>i.tokenization.getLineTokens(p),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(p,v)=>i.getLanguageIdAtPosition(p,v)},getLineContent:p=>p===f?u:i.getLineContent(p)},i.getLanguageId(),h+1,d,this._languageConfigurationService);if(m!==null){const p=Zr(m,r),v=Zr(Ui(i.getLineContent(h+1)),r);if(p!==v){const b=p-v;for(let w=h+1;w<=e.endLineNumber;w++){const C=i.getLineContent(w),y=Ui(C),S=Zr(y,r)+b,L=mx(S,r,l);L!==y&&c.push({range:new D(w,1,w,y.length+1),text:L})}}}}if(c.length>0){this.editor.pushUndoStop();const g=new UZe(c,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",g),this.editor.pushUndoStop()}}rangeContainsOnlyWhitespaceCharacters(e,t){const i=o=>o.trim().length===0;let n=!0;if(t.startLineNumber===t.endLineNumber){const r=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);n=i(r)}else for(let o=t.startLineNumber;o<=t.endLineNumber;o++){const r=e.getLineContent(o);if(o===t.startLineNumber){const a=r.substring(t.startColumn-1);n=i(a)}else if(o===t.endLineNumber){const a=r.substring(0,t.endColumn-1);n=i(a)}else n=e.getLineFirstNonWhitespaceColumn(o)===0;if(!n)break}return n}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}},Z1.ID="editor.contrib.autoIndentOnPaste",Z1);CM=WZe([HZe(1,wn)],CM);function $Ze(s,e){const t=i=>FRe(s,i)===2;return t(e.getStartPosition())||t(e.getEndPosition())}function bue(s,e,t,i){if(s.getLineCount()===1&&s.getLineMaxColumn(1)===1)return;let n="";for(let r=0;r<t;r++)n+=" ";const o=new RegExp(n,"gi");for(let r=1,a=s.getLineCount();r<=a;r++){let l=s.getLineFirstNonWhitespaceColumn(r);if(l===0&&(l=s.getLineMaxColumn(r)),l===1)continue;const c=new D(r,1,r,l),d=s.getValueInRange(c),h=i?d.replace(/\t/ig,n):d.replace(o,"	");e.addEditOperation(c,h)}}class qZe{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),bue(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class jZe{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),bue(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}Qt(CM.ID,CM,2);xe(y6);xe(S6);xe(x6);xe(L6);xe(I6);xe(E6);xe(VZe);xe(zZe);Qt(xI.ID,xI,1);kv.register(W2);class KZe{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new Oe(n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn),n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn)):new Oe(n.endLineNumber,n.endColumn-this._text.length,n.endLineNumber,n.endColumn)}}var GZe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},YZe=function(s,e){return function(t,i){e(t,i,s)}},uN,rm;let jw=(rm=class{static get(e){return e.getContribution(uN.ID)}constructor(e,t){this.editor=e,this.editorWorkerService=t,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(e,t){var l;(l=this.currentRequest)==null||l.cancel();const i=this.editor.getSelection(),n=this.editor.getModel();if(!n||!i)return;let o=i;if(o.startLineNumber!==o.endLineNumber)return;const r=new kce(this.editor,5),a=n.uri;return this.editorWorkerService.canNavigateValueSet(a)?(this.currentRequest=ys(c=>this.editorWorkerService.navigateValueSet(a,o,t)),this.currentRequest.then(c=>{var g;if(!c||!c.range||!c.value||!r.validate(this.editor))return;const d=D.lift(c.range);let h=c.range;const u=c.value.length-(o.endColumn-o.startColumn);h={startLineNumber:h.startLineNumber,startColumn:h.startColumn,endLineNumber:h.endLineNumber,endColumn:h.startColumn+c.value.length},u>1&&(o=new Oe(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn+u-1));const f=new KZe(d,o,c.value);this.editor.pushUndoStop(),this.editor.executeCommand(e,f),this.editor.pushUndoStop(),this.decorations.set([{range:h,options:uN.DECORATION}]),(g=this.decorationRemover)==null||g.cancel(),this.decorationRemover=Sh(350),this.decorationRemover.then(()=>this.decorations.clear()).catch(_t)}).catch(_t)):Promise.resolve(void 0)}},uN=rm,rm.ID="editor.contrib.inPlaceReplaceController",rm.DECORATION=vt.register({description:"in-place-replace",className:"valueSetReplacement"}),rm);jw=uN=GZe([YZe(1,jr)],jw);class XZe extends Fe{constructor(){super({id:"editor.action.inPlaceReplace.up",label:ne(1240,"Replace with Previous Value"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:3159,weight:100}})}run(e,t){const i=jw.get(t);return i?i.run(this.id,!1):Promise.resolve(void 0)}}class ZZe extends Fe{constructor(){super({id:"editor.action.inPlaceReplace.down",label:ne(1241,"Replace with Next Value"),precondition:B.writable,kbOpts:{kbExpr:B.editorTextFocus,primary:3161,weight:100}})}run(e,t){const i=jw.get(t);return i?i.run(this.id,!0):Promise.resolve(void 0)}}Qt(jw.ID,jw,4);xe(XZe);xe(ZZe);class QZe{constructor(e){this._selection=e,this._selectionId=null}getEditOperations(e,t){const i=JZe(e);i&&t.addEditOperation(i.range,i.text),this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function JZe(s){const e=s.getLineCount(),t=s.getLineContent(e),i=uc(t)===-1;if(!(!e||i))return Pn.insert(new z(e,s.getLineMaxColumn(e)),s.getEOL())}const bP=class bP extends Fe{constructor(){super({id:bP.ID,label:ne(1242,"Insert Final New Line"),precondition:B.writable})}run(e,t,i){const n=t.getSelection();if(n===null)return;const o=new QZe(n);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop()}};bP.ID="editor.action.insertFinalNewLine";let k6=bP;xe(k6);class eQe extends Fe{constructor(){super({id:"expandLineSelection",label:ne(1243,"Expand Line Selection"),precondition:void 0,kbOpts:{weight:0,kbExpr:B.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,Qs.expandLineSelection(n,n.getCursorStates())),n.revealAllCursors(i.source,!0)}}xe(eQe);var tQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},cT=function(s,e){return function(t,i){e(t,i,s)}},fN;const vue=new Ne("LinkedEditingInputVisible",!1),iQe="linked-editing-decoration";var am;let Kw=(am=class extends K{static get(e){return e.getContribution(fN.ID)}constructor(e,t,i,n,o){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new oe),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=vue.bindTo(t),this._debounceInformation=o.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new oe),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequestCts=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel(()=>this.reinitialize(!0))),this._register(this._editor.onDidChangeConfiguration(r=>{(r.hasChanged(78)||r.hasChanged(106))&&this.reinitialize(!1)})),this._register(this._providers.onDidChange(()=>this.reinitialize(!1))),this._register(this._editor.onDidChangeModelLanguage(()=>this.reinitialize(!0))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),i=t!==null&&(this._editor.getOption(78)||this._editor.getOption(106))&&this._providers.has(t);if(i===this._enabled&&!e||(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||t===null))return;this._localToDispose.add(Se.runAndSubscribe(t.onDidChangeLanguageConfiguration,()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()}));const n=new Pl(this._debounceInformation.get(t)),o=()=>{this._rangeUpdateTriggerPromise=n.trigger(()=>this.updateRanges(),this._debounceDuration??this._debounceInformation.get(t))},r=new Pl(0),a=l=>{this._rangeSyncTriggerPromise=r.trigger(()=>this._syncRanges(l))};this._localToDispose.add(this._editor.onDidChangeCursorPosition(()=>{o()})),this._localToDispose.add(this._editor.onDidChangeModelContent(l=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const c=this._currentDecorations.getRange(0);if(c&&l.changes.every(d=>c.intersectRanges(d.range))){a(this._syncRangesToken);return}}o()})),this._localToDispose.add({dispose:()=>{n.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||this._currentDecorations.length===0)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const r=n.match(this._currentWordPattern);if((r?r[0].length:0)!==n.length)return this.clearRanges()}const o=[];for(let r=1,a=this._currentDecorations.length;r<a;r++){const l=this._currentDecorations.getRange(r);if(l)if(l.startLineNumber!==l.endLineNumber)o.push({range:l,text:n});else{let c=t.getValueInRange(l),d=n,h=l.startColumn,u=l.endColumn;const f=mc(c,d);h+=f,c=c.substr(f),d=d.substr(f);const g=df(c,d);u-=g,c=c.substr(0,c.length-g),d=d.substr(0,d.length-g),(h!==u||d.length!==0)&&o.push({range:new D(l.startLineNumber,h,l.endLineNumber,u),text:d})}}if(o.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const r=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",o),this._editor._getViewModel().setPrevEditOperationType(r)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequestCts&&(this._currentRequestCts.cancel(),this._currentRequestCts=null,this._currentRequestPosition=null)}async updateRanges(e=!1){var r;if(!this._editor.hasModel()){this.clearRanges();return}const t=this._editor.getPosition();if(!this._enabled&&!e||this._editor.getSelections().length>1){this.clearRanges();return}const i=this._editor.getModel(),n=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===n){if(t.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const a=this._currentDecorations.getRange(0);if(a&&a.containsPosition(t))return}}if(!((r=this._currentRequestPosition)!=null&&r.equals(t))){const a=this._currentDecorations.getRange(0);a!=null&&a.containsPosition(t)||this.clearRanges()}this._currentRequestPosition=t,this._currentRequestModelVersion=n;const o=this._currentRequestCts=new hn;try{const a=new Fs(!1),l=await Cue(this._providers,i,t,o.token);if(this._debounceInformation.update(i,a.elapsed()),o!==this._currentRequestCts||(this._currentRequestCts=null,n!==i.getVersionId()))return;let c=[];l!=null&&l.ranges&&(c=l.ranges),this._currentWordPattern=(l==null?void 0:l.wordPattern)||this._languageWordPattern;let d=!1;for(let u=0,f=c.length;u<f;u++)if(D.containsPosition(c[u],t)){if(d=!0,u!==0){const g=c[u];c.splice(u,1),c.unshift(g)}break}if(!d){this.clearRanges();return}const h=c.map(u=>({range:u,options:fN.DECORATION}));this._visibleContextKey.set(!0),this._currentDecorations.set(h),this._syncRangesToken++}catch(a){il(a)||_t(a),(this._currentRequestCts===o||!this._currentRequestCts)&&this.clearRanges()}}},fN=am,am.ID="editor.contrib.linkedEditing",am.DECORATION=vt.register({description:"linked-editing",stickiness:0,className:iQe}),am);Kw=fN=tQe([cT(1,ut),cT(2,We),cT(3,wn),cT(4,$l)],Kw);class nQe extends Fe{constructor(){super({id:"editor.action.linkedEditing",label:ne(1276,"Start Linked Editing"),precondition:de.and(B.writable,B.hasRenameProvider),kbOpts:{kbExpr:B.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(ii),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return Ze.isUri(n)&&z.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(r=>{r&&(r.setPosition(o),r.invokeWithinContext(a=>(this.reportTelemetry(a,r),this.run(a,r))))},_t):super.runCommand(e,t)}run(e,t){const i=Kw.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const sQe=Is.bindToContribution(Kw.get);Te(new sQe({id:"cancelLinkedEditingInput",precondition:vue,handler:s=>s.clearRanges(),kbOpts:{kbExpr:B.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));function Cue(s,e,t,i){const n=s.ordered(e);return pU(n.map(o=>async()=>{try{return await o.provideLinkedEditingRanges(e,t,i)}catch(r){as(r);return}}),o=>!!o&&er(o==null?void 0:o.ranges))}F("editor.linkedEditingBackground",{dark:re.fromHex("#f00").transparent(.3),light:re.fromHex("#f00").transparent(.3),hcDark:re.fromHex("#f00").transparent(.3),hcLight:re.white},_(1275,"Background color when the editor auto renames on type."));qr("_executeLinkedEditingProvider",(s,e,t)=>{const{linkedEditingRangeProvider:i}=s.get(We);return Cue(i,e,t,Ft.None)});Qt(Kw.ID,Kw,1);xe(nQe);let oQe=class{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}async resolve(e){return this._link.url?this._link.url:typeof this._provider.resolveLink=="function"?Promise.resolve(this._provider.resolveLink(this._link,e)).then(t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing")))):Promise.reject(new Error("missing"))}};const Yx=class Yx{constructor(e){this._disposables=new oe;let t=[];for(const[i,n]of e){const o=i.links.map(r=>new oQe(r,n));t=Yx._union(t,o),fv(i)&&(this._disposables??(this._disposables=new oe),this._disposables.add(i))}this.links=t}dispose(){var e;(e=this._disposables)==null||e.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,o,r,a;for(n=0,r=0,o=e.length,a=t.length;n<o&&r<a;){const l=e[n],c=t[r];if(D.areIntersectingOrTouching(l.range,c.range)){n++;continue}D.compareRangesUsingStarts(l.range,c.range)<0?(i.push(l),n++):(i.push(c),r++)}for(;n<o;n++)i.push(e[n]);for(;r<a;r++)i.push(t[r]);return i}};Yx.Empty=new Yx([]);let wM=Yx;async function wue(s,e,t){const i=[],n=s.ordered(e).reverse().map(async(r,a)=>{try{const l=await r.provideLinks(e,t);l&&(i[a]=[l,r])}catch(l){as(l)}});await Promise.all(n);let o=new wM(bd(i));return t.isCancellationRequested&&(o.dispose(),o=wM.Empty),o}Zt.registerCommand("_executeLinkProvider",async(s,...e)=>{let[t,i]=e;ti(t instanceof Ze),typeof i!="number"&&(i=0);const{linkProvider:n}=s.get(We),o=s.get(Cn).getModel(t);if(!o)return[];const r=await wue(n,o,Ft.None);if(!r)return[];for(let l=0;l<Math.min(i,r.links.length);l++)await r.links[l].resolve(Ft.None);const a=r.links.slice(0);return r.dispose(),a});var rQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},dT=function(s,e){return function(t,i){e(t,i,s)}},D6,ob;let FI=(ob=class extends K{static get(e){return e.getContribution(D6.ID)}constructor(e,t,i,n,o){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=n,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=o.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new Ni(()=>this.computeLinksNow(),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new y4(e));this._register(r.onMouseMoveOrRelevantKeyDown(([a,l])=>{this._onEditorMouseMove(a,l)})),this._register(r.onExecute(a=>{this.onEditorMouseUp(a)})),this._register(r.onCancel(a=>{this.cleanUpActiveLinkDecoration()})),this._register(e.onDidChangeConfiguration(a=>{a.hasChanged(79)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))})),this._register(e.onDidChangeModelContent(a=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))})),this._register(e.onDidChangeModel(a=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)})),this._register(e.onDidChangeModelLanguage(a=>{this.stop(),this.computeLinks.schedule(0)})),this._register(this.providers.onDidChange(a=>{this.stop(),this.computeLinks.schedule(0)})),this.computeLinks.schedule(0)}async computeLinksNow(){if(!this.editor.hasModel()||!this.editor.getOption(79))return;const e=this.editor.getModel();if(!e.isTooLargeForSyncing()&&this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=ys(t=>wue(this.providers,e,t));try{const t=new Fs(!1);if(this.activeLinksList=await this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){_t(t)}finally{this.computePromise=null}}}updateDecorations(e){const t=this.editor.getOption(86)==="altKey",i=[],n=Object.keys(this.currentOccurrences);for(const r of n){const a=this.currentOccurrences[r];i.push(a.decorationId)}const o=[];if(e)for(const r of e)o.push(P1.decoration(r,t));this.editor.changeDecorations(r=>{const a=r.deltaDecorations(i,o);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let l=0,c=a.length;l<c;l++){const d=new P1(e[l],a[l]);this.currentOccurrences[d.decorationId]=d}})}_onEditorMouseMove(e,t){const i=this.editor.getOption(86)==="altKey";if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const n=this.getLinkOccurrence(e.target.position);n&&this.editor.changeDecorations(o=>{n.activate(o,i),this.activeLinkDecorationId=n.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e=this.editor.getOption(86)==="altKey";if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations(i=>{t.deactivate(i,e)}),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,i=!1){if(!this.openerService)return;const{link:n}=e;n.resolve(Ft.None).then(o=>{if(typeof o=="string"&&this.editor.hasModel()){const r=this.editor.getModel().uri;if(r.scheme===ct.file&&o.startsWith(`${ct.file}:`)){const a=Ze.parse(o);if(a.scheme===ct.file){const l=Nd(a);let c=null;l.startsWith("/./")||l.startsWith("\\.\\")?c=`.${l.substr(1)}`:(l.startsWith("//./")||l.startsWith("\\\\.\\"))&&(c=`.${l.substr(2)}`),c&&(o=Toe(r,c))}}}return this.openerService.open(o,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})},o=>{const r=o instanceof Error?o.message:o;r==="invalid"?this.notificationService.warn(_(1277,"Failed to open this link because it is not well-formed: {0}",n.url.toString())):r==="missing"?this.notificationService.warn(_(1278,"Failed to open this link because its target is missing.")):_t(o)})}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const n=this.currentOccurrences[i.id];if(n)return n}return null}isEnabled(e,t){return!!(e.target.type===6&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey||e.isMiddleClick&&e.mouseMiddleClickAction==="openLink"))}stop(){var e;this.computeLinks.cancel(),this.activeLinksList&&((e=this.activeLinksList)==null||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}},D6=ob,ob.ID="editor.linkDetector",ob);FI=D6=rQe([dT(1,Rf),dT(2,Hn),dT(3,We),dT(4,$l)],FI);const Aee={general:vt.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:vt.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class P1{static decoration(e,t){return{range:e.range,options:P1._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n={...i?Aee.active:Aee.general};return n.hoverMessage=aQe(e,t),n}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,P1._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,P1._getOptions(this.link,t,!1))}}function aQe(s,e){const t=s.url&&/^command:/i.test(s.url.toString()),i=s.tooltip?s.tooltip:t?_(1279,"Execute command"):_(1280,"Follow link"),n=e?Bt?_(1281,"cmd + click"):_(1282,"ctrl + click"):Bt?_(1283,"option + click"):_(1284,"alt + click");if(s.url){let o="";if(/^command:/i.test(s.url.toString())){const a=s.url.toString().match(/^command:([^?#]+)/);if(a){const l=a[1];o=_(1285,"Execute command {0}",l)}}return new To("",!0).appendLink(s.url.toString(!0).replace(/ /g,"%20"),i,o).appendMarkdown(` (${n})`)}else return new To().appendText(`${i} (${n})`)}class lQe extends Fe{constructor(){super({id:"editor.action.openLink",label:ne(1286,"Open Link"),precondition:void 0})}run(e,t){const i=FI.get(t);if(!i||!t.hasModel())return;const n=t.getSelections();for(const o of n){const r=i.getLinkOccurrence(o.getEndPosition());r&&i.openLinkOccurrence(r,!1)}}}Qt(FI.ID,FI,1);xe(lQe);const yK=class yK extends K{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown(t=>{const i=this._editor.getOption(133);i>=0&&t.target.type===6&&t.target.position.column>=i&&this._editor.updateOptions({stopRenderingLineAfter:-1})}))}};yK.ID="editor.contrib.longLinesHelper";let yM=yK;Qt(yM.ID,yM,2);const SK=class SK extends K{constructor(e){super(),this._editor=e;const t=bn(this._editor),i=t.getOption(171);this._register(lt(n=>{if(!i.read(n))return;const o=t.domNode.read(n);if(!o)return;const r=n.store.add(OU("scrollingSession",void 0));n.store.add(this._editor.onMouseDown(l=>{if(r.read(void 0)){r.set(void 0,void 0);return}if(!l.event.middleButton)return;l.event.stopPropagation(),l.event.preventDefault();const d=new oe,h=new Ms(l.event.posx,l.event.posy),f=cQe(je(o),h,d).map(p=>p.subtract(h).withThreshold(5)),g=o.getBoundingClientRect(),m=new Ms(h.x-g.left,h.y-g.top);r.set({mouseDeltaAfterThreshold:f,initialMousePosInEditor:m,didScroll:!1,dispose:()=>d.dispose()},void 0),d.add(this._editor.onMouseUp(p=>{const v=r.read(void 0);v&&v.didScroll&&r.set(void 0,void 0)})),d.add(this._editor.onKeyDown(p=>{r.set(void 0,void 0)}))})),n.store.add(lt(l=>{const c=r.read(l);if(!c)return;let d=Date.now();l.store.add(lt(u=>{oM.instance.invalidateOnNextAnimationFrame(u);const f=Date.now(),g=f-d;d=f;const m=c.mouseDeltaAfterThreshold.read(void 0),p=g/32,v=m.scale(p),b=new Ms(this._editor.getScrollLeft(),this._editor.getScrollTop());this._editor.setScrollPosition(dQe(b.add(v))),v.isZero()||(c.didScroll=!0)}));const h=ae(u=>{const f=c.mouseDeltaAfterThreshold.read(u);let g="";return g+=f.y<0?"n":f.y>0?"s":"",g+=f.x<0?"w":f.x>0?"e":"",g});l.store.add(lt(u=>{o.setAttribute("data-scroll-direction",h.read(u))}))}));const a=n.store.add(kt.div({class:["scroll-editor-on-middle-click-dot",r.map(l=>l?"":"hidden")],style:{left:r.map(l=>l?l.initialMousePosInEditor.x:0),top:r.map(l=>l?l.initialMousePosInEditor.y:0)}}).toDisposableLiveElement());n.store.add(AC(o,a.element)),n.store.add(lt(l=>{const c=r.read(l);o.classList.toggle("scroll-editor-on-middle-click-editor",!!c)}))}))}};SK.ID="editor.contrib.middleScroll";let SM=SK;function cQe(s,e,t){const i=ht("pos",e);return t.add(ee(s,"mousemove",n=>{i.set(new Ms(n.pageX,n.pageY),void 0)})),i}function dQe(s){return{scrollLeft:s.x,scrollTop:s.y}}Qt(SM.ID,SM,2);const hQe=F("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},_(1563,"Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},_(1564,"Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);F("editor.wordHighlightTextBackground",hQe,_(1565,"Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const uQe=F("editor.wordHighlightBorder",{light:null,dark:null,hcDark:fn,hcLight:fn},_(1566,"Border color of a symbol during read-access, like reading a variable."));F("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:fn,hcLight:fn},_(1567,"Border color of a symbol during write-access, like writing to a variable."));F("editor.wordHighlightTextBorder",uQe,_(1568,"Border color of a textual occurrence for a symbol."));const fQe=F("editorOverviewRuler.wordHighlightForeground","#A0A0A0CC",_(1569,"Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),gQe=F("editorOverviewRuler.wordHighlightStrongForeground","#C0A0C0CC",_(1570,"Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),mQe=F("editorOverviewRuler.wordHighlightTextForeground",yre,_(1571,"Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),pQe=vt.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:Mn(gQe),position:Xa.Center},minimap:{color:Mn(jO),position:1}}),_Qe=vt.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:Mn(mQe),position:Xa.Center},minimap:{color:Mn(jO),position:1}}),bQe=vt.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:Mn(yre),position:Xa.Center},minimap:{color:Mn(jO),position:1}}),vQe=vt.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),CQe=vt.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:Mn(fQe),position:Xa.Center},minimap:{color:Mn(jO),position:1}});function wQe(s){return s===Nw.Write?pQe:s===Nw.Text?_Qe:CQe}function yQe(s){return s?vQe:bQe}Ul((s,e)=>{const t=s.getColor(o$);t&&e.addRule(`.monaco-editor .selectionHighlight { background-color: ${t.transparent(.5)}; }`)});var SQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},xQe=function(s,e){return function(t,i){e(t,i,s)}},T6;function Pm(s,e){const t=e.filter(i=>!s.find(n=>n.equals(i)));if(t.length>=1){const i=t.map(o=>`line ${o.viewState.position.lineNumber} column ${o.viewState.position.column}`).join(", "),n=t.length===1?_(1288,"Cursor added: {0}",i):_(1289,"Cursors added: {0}",i);ld(n)}}class LQe extends Fe{constructor(){super({id:"editor.action.insertCursorAbove",label:ne(1298,"Add Cursor Above"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"3_multi",title:_(1290,"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,Qs.addCursorUp(o,r,n)),o.revealTopMostCursor(i.source),Pm(r,o.getCursorStates())}}class IQe extends Fe{constructor(){super({id:"editor.action.insertCursorBelow",label:ne(1299,"Add Cursor Below"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"3_multi",title:_(1291,"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,Qs.addCursorDown(o,r,n)),o.revealBottomMostCursor(i.source),Pm(r,o.getCursorStates())}}class EQe extends Fe{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:ne(1300,"Add Cursors to Line Ends"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"3_multi",title:_(1292,"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let n=e.startLineNumber;n<e.endLineNumber;n++){const o=t.getLineMaxColumn(n);i.push(new Oe(n,o,n,o))}e.endColumn>1&&i.push(new Oe(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=t.getSelections(),o=t._getViewModel(),r=o.getCursorStates(),a=[];n.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),Pm(r,o.getCursorStates())}}class kQe extends Fe{constructor(){super({id:"editor.action.addCursorsToBottom",label:ne(1301,"Add Cursors to Bottom"),precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=t.getModel().getLineCount(),o=[];for(let l=i[0].startLineNumber;l<=n;l++)o.push(new Oe(l,i[0].startColumn,l,i[0].endColumn));const r=t._getViewModel(),a=r.getCursorStates();o.length>0&&t.setSelections(o),Pm(a,r.getCursorStates())}}class DQe extends Fe{constructor(){super({id:"editor.action.addCursorsToTop",label:ne(1302,"Add Cursors to Top"),precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=[];for(let a=i[0].startLineNumber;a>=1;a--)n.push(new Oe(a,i[0].startColumn,a,i[0].endColumn));const o=t._getViewModel(),r=o.getCursorStates();n.length>0&&t.setSelections(n),Pm(r,o.getCursorStates())}}class hT{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class BI{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new BI(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let n=!1,o,r;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(n=!0,o=!0,r=!0):(o=i.wholeWord,r=i.matchCase);const l=e.getSelection();let c,d=null;if(l.isEmpty()){const h=e.getConfiguredWordAtPosition(l.getStartPosition());if(!h)return null;c=h.word,d=new Oe(l.startLineNumber,h.startColumn,l.startLineNumber,h.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new BI(e,t,n,c,o,r,d)}constructor(e,t,i,n,o,r,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=n,this.wholeWord=o,this.matchCase=r,this.currentMatch=a}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new hT(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new hT(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(148):null,!1);return i?new Oe(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new hT(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new hT(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(148):null,!1);return i?new Oe(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(148):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(148):null,!1,1073741824)}}const vP=class vP extends K{static get(e){return e.getContribution(vP.ID)}constructor(e){super(),this._sessionDispose=this._register(new oe),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=BI.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(n=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(n=>{(n.matchCase||n.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new Oe(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const n=e.getState().matchCase;if(!yue(this._editor.getModel(),t,n)){const r=this._editor.getModel(),a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(r,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const n=this._editor.getModel();i.searchScope?t=n.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(148):null,!1,1073741824):t=n.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(148):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const n=this._editor.getSelection();for(let o=0,r=t.length;o<r;o++){const a=t[o];if(a.range.intersectRanges(n)){t[o]=t[0],t[0]=a;break}}this._setSelections(t.map(o=>new Oe(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn)))}}};vP.ID="editor.contrib.multiCursorController";let Gw=vP;class y0 extends Fe{run(e,t){const i=Gw.get(t);if(!i)return;const n=t._getViewModel();if(n){const o=n.getCursorStates(),r=$r.get(t);if(r)this._run(i,r);else{const a=e.get($e).createInstance($r,t);this._run(i,a),a.dispose()}Pm(o,n.getCursorStates())}}}class TQe extends y0{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:ne(1303,"Add Selection to Next Find Match"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:2082,weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"3_multi",title:_(1293,"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class NQe extends y0{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:ne(1304,"Add Selection to Previous Find Match"),precondition:void 0,menuOpts:{menuId:He.MenubarSelectionMenu,group:"3_multi",title:_(1294,"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class RQe extends y0{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:ne(1305,"Move Last Selection to Next Find Match"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:ls(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class MQe extends y0{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:ne(1306,"Move Last Selection to Previous Find Match"),precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class AQe extends y0{constructor(){super({id:"editor.action.selectHighlights",label:ne(1307,"Select All Occurrences of Find Match"),precondition:void 0,kbOpts:{kbExpr:B.focus,primary:3114,weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"3_multi",title:_(1295,"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class PQe extends y0{constructor(){super({id:"editor.action.changeAll",label:ne(1308,"Change All Occurrences"),precondition:de.and(B.writable,B.editorTextFocus),kbOpts:{kbExpr:B.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class OQe{constructor(e,t,i,n,o){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=n,this._cachedFindMatches=null,this._modelVersionId=this._model.getVersionId(),o&&this._model===o._model&&this._searchText===o._searchText&&this._matchCase===o._matchCase&&this._wordSeparators===o._wordSeparators&&this._modelVersionId===o._modelVersionId&&(this._cachedFindMatches=o._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(e=>e.range),this._cachedFindMatches.sort(D.compareRangesUsingStarts)),this._cachedFindMatches}}var rb;let xM=(rb=class extends K{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(122),this._isEnabledMultiline=e.getOption(124),this._maxLength=e.getOption(123),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new Ni(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(n=>{this._isEnabled=e.getOption(122),this._isEnabledMultiline=e.getOption(124),this._maxLength=e.getOption(123)})),this._register(e.onDidChangeCursorSelection(n=>{this._isEnabled&&(n.selection.isEmpty()?n.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(n=>{this._setState(null)})),this._register(e.onDidChangeModelContent(n=>{this._isEnabled&&this.updateSoon.schedule()}));const i=$r.get(e);i&&this._register(i.getState().onFindReplaceStateChange(n=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(T6._createState(this.state,this._isEnabled,this._isEnabledMultiline,this._maxLength,this.editor))}static _createState(e,t,i,n,o){if(!t||!o.hasModel())return null;if(!i){const h=o.getSelection();if(h.startLineNumber!==h.endLineNumber)return null}const r=Gw.get(o);if(!r)return null;const a=$r.get(o);if(!a)return null;let l=r.getSession(a);if(!l){const h=o.getSelections();if(h.length>1){const f=a.getState().matchCase;if(!yue(o.getModel(),h,f))return null}l=BI.create(o,a)}if(!l||l.currentMatch||/^[ \t]+$/.test(l.searchText)||n>0&&l.searchText.length>n)return null;const c=a.getState(),d=c.matchCase;if(c.isRevealed){let h=c.searchString;d||(h=h.toLowerCase());let u=l.searchText;if(d||(u=u.toLowerCase()),h===u&&l.matchCase===c.matchCase&&l.wholeWord===c.wholeWord&&!c.isRegex)return null}return new OQe(o.getModel(),l.searchText,l.matchCase,l.wholeWord?o.getOption(148):null,e)}_setState(e){if(this.state=e,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),n=this.editor.getSelections();n.sort(D.compareRangesUsingStarts);const o=[];for(let c=0,d=0,h=i.length,u=n.length;c<h;){const f=i[c];if(d>=u)o.push(f),c++;else{const g=D.compareRangesUsingStarts(f,n[d]);g<0?((n[d].isEmpty()||!D.areIntersecting(f,n[d]))&&o.push(f),c++):(g>0||c++,d++)}}const r=this.editor.getOption(90)!=="off",a=this._languageFeaturesService.documentHighlightProvider.has(t)&&r,l=o.map(c=>({range:c,options:yQe(a)}));this._decorations.set(l)}dispose(){this._setState(null),super.dispose()}},T6=rb,rb.ID="editor.contrib.selectionHighlighter",rb);xM=T6=SQe([xQe(1,We)],xM);function yue(s,e,t){const i=Pee(s,e[0],!t);for(let n=1,o=e.length;n<o;n++){const r=e[n];if(r.isEmpty())return!1;const a=Pee(s,r,!t);if(i!==a)return!1}return!0}function Pee(s,e,t){const i=s.getValueInRange(e);return t?i.toLowerCase():i}class FQe extends Fe{constructor(){super({id:"editor.action.focusNextCursor",label:ne(1309,"Focus Next Cursor"),metadata:{description:_(1296,"Focuses the next cursor"),args:[]},precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const o=Array.from(n.getCursorStates()),r=o.shift();r&&(o.push(r),n.setCursorStates(i.source,3,o),n.revealPrimaryCursor(i.source,!0),Pm(o,n.getCursorStates()))}}class BQe extends Fe{constructor(){super({id:"editor.action.focusPreviousCursor",label:ne(1310,"Focus Previous Cursor"),metadata:{description:_(1297,"Focuses the previous cursor"),args:[]},precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const o=Array.from(n.getCursorStates()),r=o.pop();r&&(o.unshift(r),n.setCursorStates(i.source,3,o),n.revealPrimaryCursor(i.source,!0),Pm(o,n.getCursorStates()))}}Qt(Gw.ID,Gw,4);Qt(xM.ID,xM,1);xe(LQe);xe(IQe);xe(EQe);xe(TQe);xe(NQe);xe(RQe);xe(MQe);xe(AQe);xe(PQe);xe(kQe);xe(DQe);xe(FQe);xe(BQe);const av={Visible:new Ne("parameterHintsVisible",!1),MultipleSignatures:new Ne("parameterHintsMultipleSignatures",!1)};async function Sue(s,e,t,i,n){const o=s.ordered(e);for(const r of o)try{const a=await r.provideSignatureHelp(e,t,n,i);if(a)return a}catch(a){as(a)}}Zt.registerCommand("_executeSignatureHelpProvider",async(s,...e)=>{const[t,i,n]=e;ti(Ze.isUri(t)),ti(z.isIPosition(i)),ti(typeof n=="string"||!n);const o=s.get(We),r=await s.get(nr).createModelReference(t);try{const a=await Sue(o.signatureHelpProvider,r.object.textEditorModel,z.lift(i),{triggerKind:ph.Invoke,isRetrigger:!1,triggerCharacter:n},Ft.None);return a?(setTimeout(()=>a.dispose(),0),a.value):void 0}finally{r.dispose()}});var Zf;(function(s){s.Default={type:0};class e{constructor(n,o){this.request=n,this.previouslyActiveHints=o,this.type=2}}s.Pending=e;class t{constructor(n){this.hints=n,this.type=1}}s.Active=t})(Zf||(Zf={}));const CP=class CP extends K{constructor(e,t,i=CP.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new q),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=Zf.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new mi),this.triggerChars=new nR,this.retriggerChars=new nR,this.triggerId=0,this.editor=e,this.providers=t,this.throttledDelayer=new Pl(i),this._register(this.editor.onDidBlurEditorWidget(()=>this.cancel())),this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(n=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(n=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(n=>this.onCursorChange(n))),this._register(this.editor.onDidChangeModelContent(n=>this.onModelContentChange())),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType(n=>this.onDidType(n))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){this._state.type===2&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=Zf.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){const i=this.editor.getModel();if(!i||!this.providers.has(i))return;const n=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger(()=>this.doTrigger(n),t).catch(_t)}next(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t%e===e-1,n=this.editor.getOption(98).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?0:t+1)}previous(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t===0,n=this.editor.getOption(98).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?e-1:t-1)}updateActiveSignature(e){this.state.type===1&&(this.state=new Zf.Active({...this.state.hints,activeSignature:e}),this._onChangedHints.fire(this.state.hints))}async doTrigger(e){const t=this.state.type===1||this.state.type===2,i=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;const n=this._pendingTriggers.reduce(WQe);this._pendingTriggers=[];const o={triggerKind:n.triggerKind,triggerCharacter:n.triggerCharacter,isRetrigger:t,activeSignatureHelp:i};if(!this.editor.hasModel())return!1;const r=this.editor.getModel(),a=this.editor.getPosition();this.state=new Zf.Pending(ys(l=>Sue(this.providers,r,a,o,l)),i);try{const l=await this.state.request;return e!==this.triggerId?(l==null||l.dispose(),!1):!l||!l.value.signatures||l.value.signatures.length===0?(l==null||l.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1):(this.state=new Zf.Active(l.value),this._lastSignatureHelpResult.value=l,this._onChangedHints.fire(this.state.hints),!0)}catch(l){return e===this.triggerId&&(this.state=Zf.Default),_t(l),!1}}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars.clear(),this.retriggerChars.clear();const e=this.editor.getModel();if(e)for(const t of this.providers.ordered(e)){for(const i of t.signatureHelpTriggerCharacters||[])if(i.length){const n=i.charCodeAt(0);this.triggerChars.add(n),this.retriggerChars.add(n)}for(const i of t.signatureHelpRetriggerCharacters||[])i.length&&this.retriggerChars.add(i.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;const t=e.length-1,i=e.charCodeAt(t);(this.triggerChars.has(i)||this.isTriggered&&this.retriggerChars.has(i))&&this.trigger({triggerKind:ph.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){e.source==="mouse"?this.cancel():this.isTriggered&&this.trigger({triggerKind:ph.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:ph.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(98).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}};CP.DEFAULT_DELAY=120;let N6=CP;function WQe(s,e){switch(e.triggerKind){case ph.Invoke:return e;case ph.ContentChange:return s;case ph.TriggerCharacter:default:return e}}var HQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Oee=function(s,e){return function(t,i){e(t,i,s)}},R6;const Sa=we,VQe=rn("parameter-hints-next",ge.chevronDown,_(1312,"Icon for show next parameter hint.")),zQe=rn("parameter-hints-previous",ge.chevronUp,_(1313,"Icon for show previous parameter hint."));var ab;let M6=(ab=class extends K{constructor(e,t,i,n){super(),this.editor=e,this.model=t,this.markdownRendererService=n,this.renderDisposeables=this._register(new oe),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.keyVisible=av.Visible.bindTo(i),this.keyMultipleSignatures=av.MultipleSignatures.bindTo(i)}createParameterHintDOMNodes(){const e=Sa(".editor-widget.parameter-hints-widget"),t=me(e,Sa(".phwrapper"));t.tabIndex=-1;const i=me(t,Sa(".controls")),n=me(i,Sa(".button"+it.asCSSSelector(zQe))),o=me(i,Sa(".overloads")),r=me(i,Sa(".button"+it.asCSSSelector(VQe)));this._register(ee(n,"click",u=>{ri.stop(u),this.previous()})),this._register(ee(r,"click",u=>{ri.stop(u),this.next()}));const a=Sa(".body"),l=new vk(a,{alwaysConsumeMouseWheel:!0});this._register(l),t.appendChild(l.getDomNode());const c=me(a,Sa(".signature")),d=me(a,Sa(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:c,overloads:o,docs:d,scrollbar:l},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection(u=>{this.visible&&this.editor.layoutContentWidget(this)}));const h=()=>{if(!this.domNodes)return;const u=this.editor.getOption(59),f=this.domNodes.element;f.style.fontSize=`${u.fontSize}px`,f.style.lineHeight=`${u.lineHeight/u.fontSize}`,f.style.setProperty("--vscode-parameterHintsWidget-editorFontFamily",u.fontFamily),f.style.setProperty("--vscode-parameterHintsWidget-editorFontFamilyDefault",Or.fontFamily)};h(),this._register(Se.chain(this.editor.onDidChangeConfiguration.bind(this.editor),u=>u.filter(f=>f.hasChanged(59)))(h)),this._register(this.editor.onDidLayoutChange(u=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout(()=>{var e;(e=this.domNodes)==null||e.element.classList.add("visible")},100),this.editor.layoutContentWidget(this))}hide(){var e;this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,(e=this.domNodes)==null||e.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){if(this.renderDisposeables.clear(),!this.domNodes)return;const t=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",t),this.keyMultipleSignatures.set(t),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const i=e.signatures[e.activeSignature];if(!i)return;const n=me(this.domNodes.signature,Sa(".code")),o=i.parameters.length>0,r=i.activeParameter??e.activeParameter;if(o)this.renderParameters(n,i,r);else{const c=me(n,Sa("span"));c.textContent=i.label}const a=i.parameters[r];if(a!=null&&a.documentation){const c=Sa("span.documentation");if(typeof a.documentation=="string")c.textContent=a.documentation;else{const d=this.renderMarkdownDocs(a.documentation);c.appendChild(d.element)}me(this.domNodes.docs,Sa("p",{},c))}if(i.documentation!==void 0)if(typeof i.documentation=="string")me(this.domNodes.docs,Sa("p",{},i.documentation));else{const c=this.renderMarkdownDocs(i.documentation);me(this.domNodes.docs,c.element)}const l=this.hasDocs(i,a);if(this.domNodes.signature.classList.toggle("has-docs",l),this.domNodes.docs.classList.toggle("empty",!l),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,a){let c="";const d=i.parameters[r];Array.isArray(d.label)?c=i.label.substring(d.label[0],d.label[1]):c=d.label,d.documentation&&(c+=typeof d.documentation=="string"?`, ${d.documentation}`:`, ${d.documentation.value}`),i.documentation&&(c+=typeof i.documentation=="string"?`, ${i.documentation}`:`, ${i.documentation.value}`),this.announcedLabel!==c&&(br(_(1314,"{0}, hint",c)),this.announcedLabel=c)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=this.renderDisposeables.add(this.markdownRendererService.render(e,{context:this.editor,asyncRenderCallback:()=>{var i;(i=this.domNodes)==null||i.scrollbar.scanDomNode()}}));return t.element.classList.add("markdown-docs"),t}hasDocs(e,t){return!!(t&&typeof t.documentation=="string"&&_g(t.documentation).length>0||t&&typeof t.documentation=="object"&&_g(t.documentation).value.length>0||e.documentation&&typeof e.documentation=="string"&&_g(e.documentation).length>0||e.documentation&&typeof e.documentation=="object"&&_g(e.documentation.value).length>0)}renderParameters(e,t,i){const[n,o]=this.getParameterLabelOffsets(t,i),r=document.createElement("span");r.textContent=t.label.substring(0,n);const a=document.createElement("span");a.textContent=t.label.substring(n,o),a.className="parameter active";const l=document.createElement("span");l.textContent=t.label.substring(o),me(e,r,a,l)}getParameterLabelOffsets(e,t){const i=e.parameters[t];if(i){if(Array.isArray(i.label))return i.label;if(i.label.length){const n=new RegExp(`(\\W|^)${ua(i.label)}(?=\\W|$)`,"g");n.test(e.label);const o=n.lastIndex-i.label.length;return o>=0?[o,n.lastIndex]:[0,0]}else return[0,0]}else return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return R6.ID}updateMaxHeight(){if(!this.domNodes)return;const t=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=t;const i=this.domNodes.element.getElementsByClassName("phwrapper");i.length&&(i[0].style.maxHeight=t)}},R6=ab,ab.ID="editor.widget.parameterHintsWidget",ab);M6=R6=HQe([Oee(2,ut),Oee(3,Sc)],M6);F("editorHoverWidget.highlightForeground",kC,_(1315,"Foreground color of the active item in the parameter hint."));var UQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Fee=function(s,e){return function(t,i){e(t,i,s)}},A6,lb;let Yw=(lb=class extends K{static get(e){return e.getContribution(A6.ID)}constructor(e,t,i){super(),this.editor=e,this.model=this._register(new N6(e,i.signatureHelpProvider)),this._register(this.model.onChangedHints(n=>{var o;n?(this.widget.value.show(),this.widget.value.render(n)):(o=this.widget.rawValue)==null||o.hide()})),this.widget=new bo(()=>this._register(t.createInstance(M6,this.editor,this.model)))}cancel(){this.model.cancel()}previous(){var e;(e=this.widget.rawValue)==null||e.previous()}next(){var e;(e=this.widget.rawValue)==null||e.next()}trigger(e){this.model.trigger(e,0)}},A6=lb,lb.ID="editor.controller.parameterHints",lb);Yw=A6=UQe([Fee(1,$e),Fee(2,We)],Yw);class $Qe extends Fe{constructor(){super({id:"editor.action.triggerParameterHints",label:ne(1311,"Trigger Parameter Hints"),precondition:B.hasSignatureHelpProvider,kbOpts:{kbExpr:B.editorTextFocus,primary:3082,weight:100}})}run(e,t){const i=Yw.get(t);i==null||i.trigger({triggerKind:ph.Invoke})}}Qt(Yw.ID,Yw,2);xe($Qe);const kj=175,Dj=Is.bindToContribution(Yw.get);Te(new Dj({id:"closeParameterHints",precondition:av.Visible,handler:s=>s.cancel(),kbOpts:{weight:kj,kbExpr:B.focus,primary:9,secondary:[1033]}}));Te(new Dj({id:"showPrevParameterHint",precondition:de.and(av.Visible,av.MultipleSignatures),handler:s=>s.previous(),kbOpts:{weight:kj,kbExpr:B.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}}));Te(new Dj({id:"showNextParameterHint",precondition:de.and(av.Visible,av.MultipleSignatures),handler:s=>s.next(),kbOpts:{weight:kj,kbExpr:B.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));const xK=class xK extends K{constructor(e){super(),this._editor=e,this._editorObs=bn(this._editor),this._placeholderText=this._editorObs.getOption(100),this._state=_o({owner:this,equalsFn:B9},t=>{const i=this._placeholderText.read(t);if(i&&this._editorObs.valueIsEmpty.read(t))return{placeholder:i}}),this._shouldViewBeAlive=qQe(this,t=>{var i;return((i=this._state.read(t))==null?void 0:i.placeholder)!==void 0}),this._view=ae(t=>{if(!this._shouldViewBeAlive.read(t))return;const i=ei("div.editorPlaceholder");t.store.add(lt(n=>{const o=this._state.read(n),r=(o==null?void 0:o.placeholder)!==void 0;i.root.style.display=r?"block":"none",i.root.innerText=(o==null?void 0:o.placeholder)??""})),t.store.add(lt(n=>{const o=this._editorObs.layoutInfo.read(n);i.root.style.left=`${o.contentLeft}px`,i.root.style.width=o.contentWidth-o.verticalScrollbarWidth+"px",i.root.style.top=`${this._editor.getTopForLineNumber(0)}px`})),t.store.add(lt(n=>{i.root.style.fontFamily=this._editorObs.getOption(58).read(n),i.root.style.fontSize=this._editorObs.getOption(61).read(n)+"px",i.root.style.lineHeight=this._editorObs.getOption(75).read(n)+"px"})),t.store.add(this._editorObs.createOverlayWidget({allowEditorOverflow:!1,minContentWidthInPx:Gi(0),position:Gi(null),domNode:i.root}))}),this._view.recomputeInitiallyAndOnChange(this._store)}};xK.ID="editor.contrib.placeholderText";let LM=xK;function qQe(s,e){return Ef(s,(t,i)=>i===!0?!0:e(t))}var jQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},KQe=function(s,e){return function(t,i){e(t,i,s)}};class GQe{constructor(e){this.instantiationService=e}init(...e){}}function YQe(s){return s()}let Bee=class extends GQe{constructor(e,t){super(t),this.init(e)}};Bee=jQe([KQe(1,$e)],Bee);Qt(LM.ID,YQe(()=>LM),0);F("editor.placeholder.foreground",HOe,_(1334,"Foreground color of the placeholder text in the editor."));const V4=Mt("textResourceConfigurationService"),xue=Mt("textResourcePropertiesService");var XQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},uT=function(s,e){return function(t,i){e(t,i,s)}};const S0=new Ne("renameInputVisible",!1,_(1391,"Whether the rename input widget is visible"));new Ne("renameInputFocused",!1,_(1392,"Whether the rename input widget is focused"));let P6=class{constructor(e,t,i,n,o,r){this._editor=e,this._acceptKeybindings=t,this._themeService=i,this._keybindingService=n,this._logService=r,this.allowEditorOverflow=!0,this._disposables=new oe,this._visibleContextKey=S0.bindTo(o),this._isEditingRenameCandidate=!1,this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,this._candidates=new Set,this._beforeFirstInputFieldEditSW=new Fs,this._inputWithButton=new ZQe,this._disposables.add(this._inputWithButton),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{a.hasChanged(59)&&this._updateFont()})),this._disposables.add(i.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._domNode.appendChild(this._inputWithButton.domNode),this._renameCandidateListView=this._disposables.add(new Tj(this._domNode,{fontInfo:this._editor.getOption(59),onFocusChange:e=>{this._inputWithButton.input.value=e,this._isEditingRenameCandidate=!1},onSelectionChange:()=>{this._isEditingRenameCandidate=!1,this.acceptInput(!1)}})),this._disposables.add(this._inputWithButton.onDidInputChange(()=>{var e,t,i;((e=this._renameCandidateListView)==null?void 0:e.focusedCandidate)!==void 0&&(this._isEditingRenameCandidate=!0),this._timeBeforeFirstInputFieldEdit??(this._timeBeforeFirstInputFieldEdit=this._beforeFirstInputFieldEditSW.elapsed()),((t=this._renameCandidateProvidersCts)==null?void 0:t.token.isCancellationRequested)===!1&&this._renameCandidateProvidersCts.cancel(),(i=this._renameCandidateListView)==null||i.clearFocus()})),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())),this._domNode}_updateStyles(e){if(!this._domNode)return;const t=e.getColor(c0),i=e.getColor(c$);this._domNode.style.backgroundColor=String(e.getColor(ja)??""),this._domNode.style.boxShadow=t?` 0 0 8px 2px ${t}`:"",this._domNode.style.border=i?`1px solid ${i}`:"",this._domNode.style.color=String(e.getColor(Sre)??"");const n=e.getColor(xre);this._inputWithButton.domNode.style.backgroundColor=String(e.getColor(_B)??""),this._inputWithButton.input.style.backgroundColor=String(e.getColor(_B)??""),this._inputWithButton.domNode.style.borderWidth=n?"1px":"0px",this._inputWithButton.domNode.style.borderStyle=n?"solid":"none",this._inputWithButton.domNode.style.borderColor=(n==null?void 0:n.toString())??"none"}_updateFont(){if(this._domNode===void 0)return;ti(this._label!==void 0,"RenameWidget#_updateFont: _label must not be undefined given _domNode is defined"),this._editor.applyFontInfo(this._inputWithButton.input);const e=this._editor.getOption(59);this._label.style.fontSize=`${this._computeLabelFontSize(e.fontSize)}px`}_computeLabelFontSize(e){return e*.8}getPosition(){if(!this._visible||!this._editor.hasModel()||!this._editor.getDomNode())return null;const e=um(this.getDomNode().ownerDocument.body),t=Fn(this._editor.getDomNode()),i=this._getTopForPosition();this._nPxAvailableAbove=i+t.top,this._nPxAvailableBelow=e.height-this._nPxAvailableAbove;const n=this._editor.getOption(75),{totalHeight:o}=WI.getLayoutInfo({lineHeight:n}),r=this._nPxAvailableBelow>o*6?[2,1]:[1,2];return{position:this._position,preference:r}}beforeRender(){var i,n;const[e,t]=this._acceptKeybindings;return this._label.innerText=_(1393,"{0} to Rename, {1} to Preview",(i=this._keybindingService.lookupKeybinding(e))==null?void 0:i.getLabel(),(n=this._keybindingService.lookupKeybinding(t))==null?void 0:n.getLabel()),this._domNode.style.minWidth="200px",null}afterRender(e){if(e===null){this.cancelInput(!0,"afterRender (because position is null)");return}if(!this._editor.hasModel()||!this._editor.getDomNode())return;ti(this._renameCandidateListView),ti(this._nPxAvailableAbove!==void 0),ti(this._nPxAvailableBelow!==void 0);const t=Mu(this._inputWithButton.domNode),i=Mu(this._label);let n;e===2?n=this._nPxAvailableBelow:n=this._nPxAvailableAbove,this._renameCandidateListView.layout({height:n-i-t,width:Jr(this._inputWithButton.domNode)})}acceptInput(e){var t;this._trace("invoking acceptInput"),(t=this._currentAcceptInput)==null||t.call(this,e)}cancelInput(e,t){var i;(i=this._currentCancelInput)==null||i.call(this,e)}focusNextRenameSuggestion(){var e;(e=this._renameCandidateListView)!=null&&e.focusNext()||(this._inputWithButton.input.value=this._currentName)}focusPreviousRenameSuggestion(){var e;(e=this._renameCandidateListView)!=null&&e.focusPrevious()||(this._inputWithButton.input.value=this._currentName)}getInput(e,t,i,n,o){const{start:r,end:a}=this._getSelection(e,t);this._renameCts=o;const l=new oe;this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,n===void 0?this._inputWithButton.button.style.display="none":(this._inputWithButton.button.style.display="flex",this._requestRenameCandidatesOnce=n,this._requestRenameCandidates(t,!1),l.add(ee(this._inputWithButton.button,"click",()=>this._requestRenameCandidates(t,!0))),l.add(ee(this._inputWithButton.button,ye.KEY_DOWN,d=>{const h=new Bi(d);(h.equals(3)||h.equals(10))&&(h.stopPropagation(),h.preventDefault(),this._requestRenameCandidates(t,!0))}))),this._isEditingRenameCandidate=!1,this._domNode.classList.toggle("preview",i),this._position=new z(e.startLineNumber,e.startColumn),this._currentName=t,this._inputWithButton.input.value=t,this._inputWithButton.input.setAttribute("selectionStart",r.toString()),this._inputWithButton.input.setAttribute("selectionEnd",a.toString()),this._inputWithButton.input.size=Math.max((e.endColumn-e.startColumn)*1.1,20),this._beforeFirstInputFieldEditSW.reset(),l.add(Ve(()=>{this._renameCts=void 0,o.dispose(!0)})),l.add(Ve(()=>{this._renameCandidateProvidersCts!==void 0&&(this._renameCandidateProvidersCts.dispose(!0),this._renameCandidateProvidersCts=void 0)})),l.add(Ve(()=>this._candidates.clear()));const c=new gv;return c.p.finally(()=>{l.dispose(),this._hide()}),this._currentCancelInput=d=>{var h;return this._trace("invoking _currentCancelInput"),this._currentAcceptInput=void 0,this._currentCancelInput=void 0,(h=this._renameCandidateListView)==null||h.clearCandidates(),c.complete(d),!0},this._currentAcceptInput=d=>{this._trace("invoking _currentAcceptInput"),ti(this._renameCandidateListView!==void 0);const h=this._renameCandidateListView.nCandidates;let u,f;const g=this._renameCandidateListView.focusedCandidate;if(g!==void 0?(this._trace("using new name from renameSuggestion"),u=g,f={k:"renameSuggestion"}):(this._trace("using new name from inputField"),u=this._inputWithButton.input.value,f=this._isEditingRenameCandidate?{k:"userEditedRenameSuggestion"}:{k:"inputField"}),u===t||u.trim().length===0){this.cancelInput(!0,"_currentAcceptInput (because newName === value || newName.trim().length === 0)");return}this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView.clearCandidates(),c.complete({newName:u,wantsPreview:i&&d,stats:{source:f,nRenameSuggestions:h,timeBeforeFirstInputFieldEdit:this._timeBeforeFirstInputFieldEdit,nRenameSuggestionsInvocations:this._nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:this._hadAutomaticRenameSuggestionsInvocation}})},l.add(o.token.onCancellationRequested(()=>this.cancelInput(!0,"cts.token.onCancellationRequested"))),l.add(this._editor.onDidBlurEditorWidget(()=>{var d;return this.cancelInput(!((d=this._domNode)!=null&&d.ownerDocument.hasFocus()),"editor.onDidBlurEditorWidget")})),this._show(),c.p}_requestRenameCandidates(e,t){if(this._requestRenameCandidatesOnce!==void 0&&(this._renameCandidateProvidersCts!==void 0&&this._renameCandidateProvidersCts.dispose(!0),ti(this._renameCts),this._inputWithButton.buttonState!=="stop")){this._renameCandidateProvidersCts=new hn;const i=t?zL.Invoke:zL.Automatic,n=this._requestRenameCandidatesOnce(i,this._renameCandidateProvidersCts.token);if(n.length===0){this._inputWithButton.setSparkleButton();return}t||(this._hadAutomaticRenameSuggestionsInvocation=!0),this._nRenameSuggestionsInvocations+=1,this._inputWithButton.setStopButton(),this._updateRenameCandidates(n,e,this._renameCts.token)}}_getSelection(e,t){ti(this._editor.hasModel());const i=this._editor.getSelection();let n=0,o=t.length;return!D.isEmpty(i)&&!D.spansMultipleLines(i)&&D.containsRange(e,i)&&(n=Math.max(0,i.startColumn-e.startColumn),o=Math.min(e.endColumn,i.endColumn)-e.startColumn),{start:n,end:o}}_show(){this._trace("invoking _show"),this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout(()=>{this._inputWithButton.input.focus(),this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute("selectionStart")),parseInt(this._inputWithButton.input.getAttribute("selectionEnd")))},100)}async _updateRenameCandidates(e,t,i){const n=(...c)=>this._trace("_updateRenameCandidates",...c);n("start");const o=await mw(Promise.allSettled(e),i);if(this._inputWithButton.setSparkleButton(),o===void 0){n("returning early - received updateRenameCandidates results - undefined");return}const r=o.flatMap(c=>c.status==="fulfilled"&&$s(c.value)?c.value:[]);n(`received updateRenameCandidates results - total (unfiltered) ${r.length} candidates.`);const a=uf(r,c=>c.newSymbolName);n(`distinct candidates - ${a.length} candidates.`);const l=a.filter(({newSymbolName:c})=>c.trim().length>0&&c!==this._inputWithButton.input.value&&c!==t&&!this._candidates.has(c));if(n(`valid distinct candidates - ${r.length} candidates.`),l.forEach(c=>this._candidates.add(c.newSymbolName)),l.length<1){n("returning early - no valid distinct candidates");return}n("setting candidates"),this._renameCandidateListView.setCandidates(l),n("asking editor to re-layout"),this._editor.layoutContentWidget(this)}_hide(){this._trace("invoked _hide"),this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}_getTopForPosition(){const e=this._editor.getVisibleRanges();let t;return e.length>0?t=e[0].startLineNumber:(this._logService.warn("RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty"),t=Math.max(1,this._position.lineNumber-5)),this._editor.getTopForLineNumber(this._position.lineNumber)-this._editor.getTopForLineNumber(t)}_trace(...e){this._logService.trace("RenameWidget",...e)}};P6=XQe([uT(2,Dn),uT(3,ai),uT(4,ut),uT(5,Ji)],P6);class Tj{constructor(e,t){this._disposables=new oe,this._availableHeight=0,this._minimumWidth=0,this._lineHeight=t.fontInfo.lineHeight,this._typicalHalfwidthCharacterWidth=t.fontInfo.typicalHalfwidthCharacterWidth,this._listContainer=document.createElement("div"),this._listContainer.className="rename-box rename-candidate-list-container",e.appendChild(this._listContainer),this._listWidget=Tj._createListWidget(this._listContainer,this._candidateViewHeight,t.fontInfo),this._disposables.add(this._listWidget.onDidChangeFocus(i=>{i.elements.length===1&&t.onFocusChange(i.elements[0].newSymbolName)},this._disposables)),this._disposables.add(this._listWidget.onDidChangeSelection(i=>{i.elements.length===1&&t.onSelectionChange()},this._disposables)),this._disposables.add(this._listWidget.onDidBlur(i=>{this._listWidget.setFocus([])})),this._listWidget.style(Lv({listInactiveFocusForeground:PL,listInactiveFocusBackground:OL}))}dispose(){this._listWidget.dispose(),this._disposables.dispose()}layout({height:e,width:t}){this._availableHeight=e,this._minimumWidth=t}setCandidates(e){this._listWidget.splice(0,0,e);const t=this._pickListHeight(this._listWidget.length),i=this._pickListWidth(e);this._listWidget.layout(t,i),this._listContainer.style.height=`${t}px`,this._listContainer.style.width=`${i}px`,ld(_(1394,"Received {0} rename suggestions",e.length))}clearCandidates(){this._listContainer.style.height="0px",this._listContainer.style.width="0px",this._listWidget.splice(0,this._listWidget.length,[])}get nCandidates(){return this._listWidget.length}get focusedCandidate(){if(this._listWidget.length===0)return;const e=this._listWidget.getSelectedElements()[0];if(e!==void 0)return e.newSymbolName;const t=this._listWidget.getFocusedElements()[0];if(t!==void 0)return t.newSymbolName}focusNext(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0)return this._listWidget.focusFirst(),this._listWidget.reveal(0),!0;if(e[0]===this._listWidget.length-1)return this._listWidget.setFocus([]),this._listWidget.reveal(0),!1;{this._listWidget.focusNext();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}focusPrevious(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0){this._listWidget.focusLast();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}else{if(e[0]===0)return this._listWidget.setFocus([]),!1;{this._listWidget.focusPrevious();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}}clearFocus(){this._listWidget.setFocus([])}get _candidateViewHeight(){const{totalHeight:e}=WI.getLayoutInfo({lineHeight:this._lineHeight});return e}_pickListHeight(e){const t=this._candidateViewHeight*e;return Math.min(t,this._availableHeight,this._candidateViewHeight*7)}_pickListWidth(e){const t=Math.ceil(Math.max(...e.map(n=>n.newSymbolName.length))*this._typicalHalfwidthCharacterWidth);return Math.max(this._minimumWidth,25+t+10)}static _createListWidget(e,t,i){const n=new class{getTemplateId(r){return"candidate"}getHeight(r){return t}},o=new class{constructor(){this.templateId="candidate"}renderTemplate(r){return new WI(r,i)}renderElement(r,a,l){l.populate(r)}disposeTemplate(r){r.dispose()}};return new nl("NewSymbolNameCandidates",e,n,[o],{keyboardSupport:!1,mouseSupport:!0,multipleSelectionSupport:!1})}}class ZQe{constructor(){this._buttonHoverContent="",this._onDidInputChange=new q,this.onDidInputChange=this._onDidInputChange.event,this._disposables=new oe}get domNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="rename-input-with-button",this._domNode.style.display="flex",this._domNode.style.flexDirection="row",this._domNode.style.alignItems="center",this._inputNode=document.createElement("input"),this._inputNode.className="rename-input",this._inputNode.type="text",this._inputNode.style.border="none",this._inputNode.setAttribute("aria-label",_(1395,"Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._inputNode),this._buttonNode=document.createElement("div"),this._buttonNode.className="rename-suggestions-button",this._buttonNode.setAttribute("tabindex","0"),this._buttonGenHoverText=_(1396,"Generate New Name Suggestions"),this._buttonCancelHoverText=_(1397,"Cancel"),this._buttonHoverContent=this._buttonGenHoverText,this._disposables.add(yc().setupDelayedHover(this._buttonNode,()=>({content:this._buttonHoverContent,style:1}))),this._domNode.appendChild(this._buttonNode),this._disposables.add(ee(this.input,ye.INPUT,()=>this._onDidInputChange.fire())),this._disposables.add(ee(this.input,ye.KEY_DOWN,e=>{const t=new Bi(e);(t.keyCode===15||t.keyCode===17)&&this._onDidInputChange.fire()})),this._disposables.add(ee(this.input,ye.CLICK,()=>this._onDidInputChange.fire())),this._disposables.add(ee(this.input,ye.FOCUS,()=>{this.domNode.style.outlineWidth="1px",this.domNode.style.outlineStyle="solid",this.domNode.style.outlineOffset="-1px",this.domNode.style.outlineColor="var(--vscode-focusBorder)"})),this._disposables.add(ee(this.input,ye.BLUR,()=>{this.domNode.style.outline="none"}))),this._domNode}get input(){return ti(this._inputNode),this._inputNode}get button(){return ti(this._buttonNode),this._buttonNode}get buttonState(){return this._buttonState}setSparkleButton(){this._buttonState="sparkle",this._sparkleIcon??(this._sparkleIcon=fd(ge.sparkle)),io(this.button),this.button.appendChild(this._sparkleIcon),this.button.setAttribute("aria-label","Generating new name suggestions"),this._buttonHoverContent=this._buttonGenHoverText,this.input.focus()}setStopButton(){this._buttonState="stop",this._stopIcon??(this._stopIcon=fd(ge.stopCircle)),io(this.button),this.button.appendChild(this._stopIcon),this.button.setAttribute("aria-label","Cancel generating new name suggestions"),this._buttonHoverContent=this._buttonCancelHoverText,this.input.focus()}dispose(){this._disposables.dispose()}}const Xx=class Xx{constructor(e,t){this._domNode=document.createElement("div"),this._domNode.className="rename-box rename-candidate",this._domNode.style.display="flex",this._domNode.style.columnGap="5px",this._domNode.style.alignItems="center",this._domNode.style.height=`${t.lineHeight}px`,this._domNode.style.padding=`${Xx._PADDING}px`;const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.width=i.style.height=`${t.lineHeight*.8}px`,this._domNode.appendChild(i),this._icon=fd(ge.sparkle),this._icon.style.display="none",i.appendChild(this._icon),this._label=document.createElement("div"),js(this._label,t),this._domNode.appendChild(this._label),e.appendChild(this._domNode)}populate(e){this._updateIcon(e),this._updateLabel(e)}_updateIcon(e){var i;const t=!!((i=e.tags)!=null&&i.includes(kB.AIGenerated));this._icon.style.display=t?"inherit":"none"}_updateLabel(e){this._label.innerText=e.newSymbolName}static getLayoutInfo({lineHeight:e}){return{totalHeight:e+Xx._PADDING*2}}dispose(){}};Xx._PADDING=2;let WI=Xx;var QQe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Zm=function(s,e){return function(t,i){e(t,i,s)}},O6;class Nj{constructor(e,t,i){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=i.ordered(e)}hasProvider(){return this._providers.length>0}async resolveRenameLocation(e){const t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const n=this._providers[this._providerRenameIdx];if(!n.resolveRenameLocation)break;const o=await n.resolveRenameLocation(this.model,this.position,e);if(o){if(o.rejectReason){t.push(o.rejectReason);continue}return o}}this._providerRenameIdx=0;const i=this.model.getWordAtPosition(this.position);return i?{range:new D(this.position.lineNumber,i.startColumn,this.position.lineNumber,i.endColumn),text:i.word,rejectReason:t.length>0?t.join(`
`):void 0}:{range:D.fromPositions(this.position),text:"",rejectReason:t.length>0?t.join(`
`):void 0}}async provideRenameEdits(e,t){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)}async _provideRenameEdits(e,t,i,n){const o=this._providers[t];if(!o)return{edits:[],rejectReason:i.join(`
`)};const r=await o.provideRenameEdits(this.model,this.position,e,n);if(r){if(r.rejectReason)return this._provideRenameEdits(e,t+1,i.concat(r.rejectReason),n)}else return this._provideRenameEdits(e,t+1,i.concat(_(1380,"No result.")),n);return r}}async function JQe(s,e,t,i){const n=new Nj(e,t,s),o=await n.resolveRenameLocation(Ft.None);return o!=null&&o.rejectReason?{edits:[],rejectReason:o.rejectReason}:n.provideRenameEdits(i,Ft.None)}var cb;let Lm=(cb=class{static get(e){return e.getContribution(O6.ID)}constructor(e,t,i,n,o,r,a,l){this.editor=e,this._instaService=t,this._notificationService=i,this._bulkEditService=n,this._progressService=o,this._logService=r,this._configService=a,this._languageFeaturesService=l,this._disposableStore=new oe,this._cts=new hn,this._renameWidget=this._disposableStore.add(this._instaService.createInstance(P6,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"]))}dispose(){this._disposableStore.dispose(),this._cts.dispose(!0)}async run(){var g,m;const e=this._logService.trace.bind(this._logService,"[rename]");if(this._cts.dispose(!0),this._cts=new hn,!this.editor.hasModel()){e("editor has no model");return}const t=this.editor.getPosition(),i=new Nj(this.editor.getModel(),t,this._languageFeaturesService.renameProvider);if(!i.hasProvider()){e("skeleton has no provider");return}const n=new Cf(this.editor,5,void 0,this._cts.token);let o;try{e("resolving rename location");const p=i.resolveRenameLocation(n.token);this._progressService.showWhile(p,250),o=await p,e("resolved rename location")}catch(p){p instanceof Ml?e("resolve rename location cancelled",JSON.stringify(p,null,"	")):(e("resolve rename location failed",p instanceof Error?p:JSON.stringify(p,null,"	")),(typeof p=="string"||ef(p))&&((g=ca.get(this.editor))==null||g.showMessage(p||_(1381,"An unknown error occurred while resolving rename location"),t)));return}finally{n.dispose()}if(!o){e("returning early - no loc");return}if(o.rejectReason){e(`returning early - rejected with reason: ${o.rejectReason}`,o.rejectReason),(m=ca.get(this.editor))==null||m.showMessage(o.rejectReason,t);return}if(n.token.isCancellationRequested){e("returning early - cts1 cancelled");return}const r=new Cf(this.editor,5,o.range,this._cts.token),a=this.editor.getModel(),l=this._languageFeaturesService.newSymbolNamesProvider.all(a),c=await Promise.all(l.map(async p=>[p,await p.supportsAutomaticNewSymbolNamesTriggerKind??!1])),d=(p,v)=>{let b=c.slice();return p===zL.Automatic&&(b=b.filter(([w,C])=>C)),b.map(([w])=>w.provideNewSymbolNames(a,o.range,p,v))};e("creating rename input field and awaiting its result");const h=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),u=await this._renameWidget.getInput(o.range,o.text,h,l.length>0?d:void 0,r);if(e("received response from rename input field"),typeof u=="boolean"){e(`returning early - rename input field response - ${u}`),u&&this.editor.focus(),r.dispose();return}this.editor.focus(),e("requesting rename edits");const f=mw(i.provideRenameEdits(u.newName,r.token),r.token).then(async p=>{if(!p){e("returning early - no rename edits result");return}if(!this.editor.hasModel()){e("returning early - no model after rename edits are provided");return}if(p.rejectReason){e(`returning early - rejected with reason: ${p.rejectReason}`),this._notificationService.info(p.rejectReason);return}this.editor.setSelection(D.fromPositions(this.editor.getSelection().getPosition())),e("applying edits"),this._bulkEditService.apply(p,{editor:this.editor,showPreview:u.wantsPreview,label:_(1382,"Renaming '{0}' to '{1}'",o==null?void 0:o.text,u.newName),code:"undoredo.rename",quotableLabel:_(1383,"Renaming {0} to {1}",o==null?void 0:o.text,u.newName),respectAutoSaveConfig:!0,reason:ko.rename()}).then(v=>{e("edits applied"),v.ariaSummary&&br(_(1384,"Successfully renamed '{0}' to '{1}'. Summary: {2}",o.text,u.newName,v.ariaSummary))}).catch(v=>{e(`error when applying edits ${JSON.stringify(v,null,"	")}`),this._notificationService.error(_(1385,"Rename failed to apply edits")),this._logService.error(v)})},p=>{e("error when providing rename edits",JSON.stringify(p,null,"	")),this._notificationService.error(_(1386,"Rename failed to compute edits")),this._logService.error(p)}).finally(()=>{r.dispose()});return e("returning rename operation"),this._progressService.showWhile(f,250),f}acceptRenameInput(e){this._renameWidget.acceptInput(e)}cancelRenameInput(){this._renameWidget.cancelInput(!0,"cancelRenameInput command")}focusNextRenameSuggestion(){this._renameWidget.focusNextRenameSuggestion()}focusPreviousRenameSuggestion(){this._renameWidget.focusPreviousRenameSuggestion()}},O6=cb,cb.ID="editor.contrib.renameController",cb);Lm=O6=QQe([Zm(1,$e),Zm(2,Hn),Zm(3,Rk),Zm(4,vf),Zm(5,Ji),Zm(6,V4),Zm(7,We)],Lm);class eJe extends Fe{constructor(){super({id:"editor.action.rename",label:ne(1388,"Rename Symbol"),precondition:de.and(B.writable,B.hasRenameProvider),kbOpts:{kbExpr:B.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1},canTriggerInlineEdits:!0})}runCommand(e,t){const i=e.get(ii),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return Ze.isUri(n)&&z.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(r=>{r&&(r.setPosition(o),r.invokeWithinContext(a=>(this.reportTelemetry(a,r),this.run(a,r))))},_t):super.runCommand(e,t)}run(e,t){const i=e.get(Ji),n=Lm.get(t);return n?(i.trace("[RenameAction] got controller, running..."),n.run()):(i.trace("[RenameAction] returning early - controller missing"),Promise.resolve())}}Qt(Lm.ID,Lm,4);xe(eJe);const Rj=Is.bindToContribution(Lm.get);Te(new Rj({id:"acceptRenameInput",precondition:S0,handler:s=>s.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:de.and(B.focus,de.not("isComposing")),primary:3}}));Te(new Rj({id:"acceptRenameInputWithPreview",precondition:de.and(S0,de.has("config.editor.rename.enablePreview")),handler:s=>s.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:de.and(B.focus,de.not("isComposing")),primary:2051}}));Te(new Rj({id:"cancelRenameInput",precondition:S0,handler:s=>s.cancelRenameInput(),kbOpts:{weight:199,kbExpr:B.focus,primary:9,secondary:[1033]}}));Ei(class extends Gs{constructor(){super({id:"focusNextRenameSuggestion",title:{...ne(1389,"Focus Next Rename Suggestion")},precondition:S0,keybinding:[{primary:18,weight:199}]})}run(e){const t=e.get(ii).getFocusedCodeEditor();if(!t)return;const i=Lm.get(t);i&&i.focusNextRenameSuggestion()}});Ei(class extends Gs{constructor(){super({id:"focusPreviousRenameSuggestion",title:{...ne(1390,"Focus Previous Rename Suggestion")},precondition:S0,keybinding:[{primary:16,weight:199}]})}run(e){const t=e.get(ii).getFocusedCodeEditor();if(!t)return;const i=Lm.get(t);i&&i.focusPreviousRenameSuggestion()}});qr("_executeDocumentRenameProvider",function(s,e,t,...i){const[n]=i;ti(typeof n=="string");const{renameProvider:o}=s.get(We);return JQe(o,e,t,n)});qr("_executePrepareRename",async function(s,e,t){const{renameProvider:i}=s.get(We),o=await new Nj(e,t,i).resolveRenameLocation(Ft.None);if(o!=null&&o.rejectReason)throw new Error(o.rejectReason);return o});kn.as(vd.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:6,description:_(1387,"Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});var tJe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Wee=function(s,e){return function(t,i){e(t,i,s)}},Q1;let IM=(Q1=class extends K{constructor(e,t,i){super(),this.editor=e,this.languageConfigurationService=t,this.editorWorkerService=i,this.decorations=this.editor.createDecorationsCollection(),this.options=this.createOptions(e.getOption(81)),this.computePromise=null,this.currentOccurrences={},this._register(e.onDidChangeModel(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(81)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(e.onDidChangeModelLanguage(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(81)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(t.onDidChange(n=>{var r;const o=(r=this.editor.getModel())==null?void 0:r.getLanguageId();o&&n.affects(o)&&(this.currentOccurrences={},this.options=this.createOptions(e.getOption(81)),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(e.onDidChangeConfiguration(n=>{this.options&&!n.hasChanged(81)||(this.options=this.createOptions(e.getOption(81)),this.updateDecorations([]),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(this.editor.onDidChangeModelContent(n=>{this.computeSectionHeaders.schedule()})),this._register(e.onDidChangeModelTokens(n=>{this.computeSectionHeaders.isScheduled()||this.computeSectionHeaders.schedule(1e3)})),this.computeSectionHeaders=this._register(new Ni(()=>{this.findSectionHeaders()},250)),this.computeSectionHeaders.schedule(0)}createOptions(e){if(!e||!this.editor.hasModel())return;const t=this.editor.getModel().getLanguageId();if(!t)return;const i=this.languageConfigurationService.getLanguageConfiguration(t).comments,n=this.languageConfigurationService.getLanguageConfiguration(t).foldingRules;if(!(!i&&!(n!=null&&n.markers)))return{foldingRules:n,markSectionHeaderRegex:e.markSectionHeaderRegex,findMarkSectionHeaders:e.showMarkSectionHeaders,findRegionSectionHeaders:e.showRegionSectionHeaders}}findSectionHeaders(){var i,n;if(!this.editor.hasModel()||!((i=this.options)!=null&&i.findMarkSectionHeaders)&&!((n=this.options)!=null&&n.findRegionSectionHeaders))return;const e=this.editor.getModel();if(e.isDisposed()||e.isTooLargeForSyncing())return;const t=e.getVersionId();this.editorWorkerService.findSectionHeaders(e.uri,this.options).then(o=>{e.isDisposed()||e.getVersionId()!==t||this.updateDecorations(o)})}updateDecorations(e){const t=this.editor.getModel();t&&(e=e.filter(o=>{if(!o.shouldBeInComments)return!0;const r=t.validateRange(o.range),a=t.tokenization.getLineTokens(r.startLineNumber),l=a.findTokenIndexAtOffset(r.startColumn-1),c=a.getStandardTokenType(l);return a.getLanguageId(l)===t.getLanguageId()&&c===1}));const i=Object.values(this.currentOccurrences).map(o=>o.decorationId),n=e.map(o=>iJe(o));this.editor.changeDecorations(o=>{const r=o.deltaDecorations(i,n);this.currentOccurrences={};for(let a=0,l=r.length;a<l;a++){const c={sectionHeader:e[a],decorationId:r[a]};this.currentOccurrences[c.decorationId]=c}})}stop(){this.computeSectionHeaders.cancel(),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop(),this.decorations.clear()}},Q1.ID="editor.sectionHeaderDetector",Q1);IM=tJe([Wee(1,wn),Wee(2,jr)],IM);function iJe(s){return{range:s.range,options:vt.createDynamic({description:"section-header",stickiness:3,collapseOnReplaceEdit:!0,minimap:{color:void 0,position:1,sectionHeaderStyle:s.hasSeparatorLine?2:1,sectionHeaderText:s.text}})}}Qt(IM.ID,IM,1);class nJe{constructor(e=5){this.timesPerSecond=e,this._lastRun=0,this._minimumTimeBetweenRuns=1e3/e}runIfNotLimited(e){const t=Date.now();t-this._lastRun>=this._minimumTimeBetweenRuns&&(this._lastRun=t,e())}}class Ix{static create(e,t){return new Ix(e,new F6(t))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}constructor(e,t){this._startLineNumber=e,this._tokens=t,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(e){return this._startLineNumber<=e&&e<=this._endLineNumber?this._tokens.getLineTokens(e-this._startLineNumber):null}getRange(){const e=this._tokens.getRange();return e&&new D(this._startLineNumber+e.startLineNumber,e.startColumn,this._startLineNumber+e.endLineNumber,e.endColumn)}removeTokens(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(t,e.startColumn-1,i,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber,[n,o,r]=this._tokens.split(t,e.startColumn-1,i,e.endColumn-1);return[new Ix(this._startLineNumber,n),new Ix(this._startLineNumber+r,o)]}applyEdit(e,t){const[i,n,o]=bm(t);this.acceptEdit(e,i,n,o,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,i,n,o){this._acceptDeleteRange(e),this._acceptInsertText(new z(e.startLineNumber,e.startColumn),t,i,n,o),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;if(i<0){const o=i-t;this._startLineNumber-=o;return}const n=this._tokens.getMaxDeltaLine();if(!(t>=n+1)){if(t<0&&i>=n+1){this._startLineNumber=0,this._tokens.clear();return}if(t<0){const o=-t;this._startLineNumber-=o,this._tokens.acceptDeleteRange(e.startColumn-1,0,0,i,e.endColumn-1)}else this._tokens.acceptDeleteRange(0,t,e.startColumn-1,i,e.endColumn-1)}}_acceptInsertText(e,t,i,n,o){if(t===0&&i===0)return;const r=e.lineNumber-this._startLineNumber;if(r<0){this._startLineNumber+=t;return}const a=this._tokens.getMaxDeltaLine();r>=a+1||this._tokens.acceptInsertText(r,e.column-1,t,i,n,o)}reportIfInvalid(e){this._tokens.reportIfInvalid(e,this._startLineNumber)}}const og=class og{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){const t=[];for(let i=0;i<this._tokenCount;i++)t.push(`(${this._getDeltaLine(i)+e},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return e===0?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(e===0)return null;const t=this._getStartCharacter(0),i=this._getDeltaLine(e-1),n=this._getEndCharacter(e-1);return new D(0,t+1,i,n+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(e){let t=0,i=this._getTokenCount()-1;for(;t<i;){const n=t+Math.floor((i-t)/2),o=this._getDeltaLine(n);if(o<e)t=n+1;else if(o>e)i=n-1;else{let r=n;for(;r>t&&this._getDeltaLine(r-1)===e;)r--;let a=n;for(;a<i&&this._getDeltaLine(a+1)===e;)a++;return new Hee(this._tokens.subarray(4*r,4*a+4))}}return this._getDeltaLine(t)===e?new Hee(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,i,n){const o=this._tokens,r=this._tokenCount;let a=0,l=!1,c=0;for(let d=0;d<r;d++){const h=4*d,u=o[h],f=o[h+1],g=o[h+2],m=o[h+3];if((u>e||u===e&&g>=t)&&(u<i||u===i&&f<=n))l=!0;else{if(a===0&&(c=u),l){const p=4*a;o[p]=u-c,o[p+1]=f,o[p+2]=g,o[p+3]=m}else c!==0&&(o[h]=u-c);a++}}return this._tokenCount=a,c}split(e,t,i,n){const o=this._tokens,r=this._tokenCount,a=[],l=[];let c=a,d=0,h=0;for(let u=0;u<r;u++){const f=4*u,g=o[f],m=o[f+1],p=o[f+2],v=o[f+3];if(g>e||g===e&&p>=t){if(g<i||g===i&&m<=n)continue;c!==l&&(c=l,d=0,h=g)}c[d++]=g-h,c[d++]=m,c[d++]=p,c[d++]=v}return[new og(new Uint32Array(a)),new og(new Uint32Array(l)),h]}acceptDeleteRange(e,t,i,n,o){const r=this._tokens,a=this._tokenCount,l=n-t;let c=0,d=!1;for(let h=0;h<a;h++){const u=4*h;let f=r[u],g=r[u+1],m=r[u+2];const p=r[u+3];if(f<t||f===t&&m<=i){c++;continue}else if(f===t&&g<i)f===n&&m>o?m-=o-i:m=i;else if(f===t&&g===i)if(f===n&&m>o)m-=o-i;else{d=!0;continue}else if(f<n||f===n&&g<o)if(f===n&&m>o)f=t,g=i,m=g+(m-o);else{d=!0;continue}else if(f>n){if(l===0&&!d){c=a;break}f-=l}else if(f===n&&g>=o)e&&f===0&&(g+=e,m+=e),f-=l,g-=o-i,m-=o-i;else throw new Error("Not possible!");const v=4*c;r[v]=f,r[v+1]=g,r[v+2]=m,r[v+3]=p,c++}this._tokenCount=c}acceptInsertText(e,t,i,n,o,r){const a=i===0&&n===1&&(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122),l=this._tokens,c=this._tokenCount;for(let d=0;d<c;d++){const h=4*d;let u=l[h],f=l[h+1],g=l[h+2];if(!(u<e||u===e&&g<t)){if(u===e&&g===t)if(a)g+=1;else continue;else if(u===e&&f<t&&t<g)i===0?g+=n:g=t;else{if(u===e&&f===t&&a)continue;if(u===e)if(u+=i,i===0)f+=n,g+=n;else{const m=g-f;f=o+(f-t),g=f+m}else u+=i}l[h]=u,l[h+1]=f,l[h+2]=g}}}reportIfInvalid(e,t){for(let i=0;i<this._tokenCount;i++){const n=this._getDeltaLine(i)+t;n<1?og._rateLimiter.runIfNotLimited(()=>{console.error("Invalid Semantic Tokens Data From Extension: lineNumber < 1")}):n>e.getLineCount()?og._rateLimiter.runIfNotLimited(()=>{console.error("Invalid Semantic Tokens Data From Extension: lineNumber > model.getLineCount()")}):this._getEndCharacter(i)>e.getLineLength(n)&&og._rateLimiter.runIfNotLimited(()=>{console.error("Invalid Semantic Tokens Data From Extension: end character > model.getLineLength(lineNumber)")})}}};og._rateLimiter=new nJe(10/60);let F6=og;class Hee{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}var sJe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},S3=function(s,e){return function(t,i){e(t,i,s)}};let B6=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new W6}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),o=this._hashTable.get(e,t,n);let r;if(o)r=o.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let h=0;c>0&&h<this._legend.tokenModifiers.length;h++)c&1&&l.push(this._legend.tokenModifiers[h]),c=c>>1;const d=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof d>"u")r=2147483647;else{if(r=0,typeof d.italic<"u"){const h=(d.italic?1:0)<<11;r|=h|1}if(typeof d.bold<"u"){const h=(d.bold?2:0)<<11;r|=h|2}if(typeof d.underline<"u"){const h=(d.underline?4:0)<<11;r|=h|4}if(typeof d.strikethrough<"u"){const h=(d.strikethrough?8:0)<<11;r|=h|8}if(d.foreground){const h=d.foreground<<15;r|=h|16}r===0&&(r=2147483647)}}else r=2147483647,a="not-in-legend";this._hashTable.add(e,t,n,r)}return r}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,n,o){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${n} is outside the previous data (length ${o}).`))}};B6=sJe([S3(1,Dn),S3(2,Wn),S3(3,Ji)],B6);function Lue(s,e,t){const i=s.data,n=s.data.length/5|0,o=Math.max(Math.ceil(n/1024),400),r=[];let a=0,l=1,c=0;for(;a<n;){const d=a;let h=Math.min(d+o,n);if(h<n){let b=h;for(;b-1>d&&i[5*b]===0;)b--;if(b-1===d){let w=h;for(;w+1<n&&i[5*w]===0;)w++;h=w}else h=b}let u=new Uint32Array((h-d)*4),f=0,g=0,m=0,p=0;for(;a<h;){const b=5*a,w=i[b],C=i[b+1],y=l+w|0,x=w===0?c+C|0:C,S=i[b+2],L=x+S|0,E=i[b+3],M=i[b+4];if(L<=x)e.warnInvalidLengthSemanticTokens(y,x+1);else if(m===y&&p>x)e.warnOverlappingSemanticTokens(y,x+1);else{const R=e.getMetadata(E,M,t);R!==2147483647&&(g===0&&(g=y),u[f]=y-g,u[f+1]=x,u[f+2]=L,u[f+3]=R,f+=4,m=y,p=L)}l=y,c=x,a++}f!==u.length&&(u=u.subarray(0,f));const v=Ix.create(g,u);r.push(v)}return r}class oJe{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}const mu=class mu{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=mu._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<mu._SIZES.length?2/3*this._currentLength:0),this._elements=[],mu._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let o=this._elements[n];for(;o;){if(o.tokenTypeIndex===e&&o.tokenModifierSet===t&&o.languageId===i)return o;o=o.next}return null}add(e,t,i,n){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const o=this._elements;this._currentLengthIndex++,this._currentLength=mu._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<mu._SIZES.length?2/3*this._currentLength:0),this._elements=[],mu._nullOutEntries(this._elements,this._currentLength);for(const r of o){let a=r;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new oJe(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}};mu._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];let W6=mu;const z4=Mt("semanticTokensStylingService");function rJe(s){for(let e=0,t=s.length;e<t;e+=4){const i=s[e+0],n=s[e+1],o=s[e+2],r=s[e+3];s[e+0]=r,s[e+1]=o,s[e+2]=n,s[e+3]=i}}function aJe(s){const e=new Uint8Array(s.buffer,s.byteOffset,s.length*4);return Ise()||rJe(e),Og.wrap(e)}function Iue(s){const e=new Uint32Array(lJe(s));let t=0;if(e[t++]=s.id,s.type==="full")e[t++]=1,e[t++]=s.data.length,e.set(s.data,t),t+=s.data.length;else{e[t++]=2,e[t++]=s.deltas.length;for(const i of s.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return aJe(e)}function lJe(s){let e=0;if(e+=2,s.type==="full")e+=1+s.data.length;else{e+=1,e+=3*s.deltas.length;for(const t of s.deltas)t.data&&(e+=t.data.length)}return e}function U4(s){return s&&!!s.data}function Eue(s){return s&&Array.isArray(s.edits)}class cJe{constructor(e,t,i){this.provider=e,this.tokens=t,this.error=i}}function kue(s,e){return s.has(e)}function dJe(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:[]}async function Due(s,e,t,i,n){const o=dJe(s,e),r=await Promise.all(o.map(async a=>{let l,c=null;try{l=await a.provideDocumentSemanticTokens(e,a===t?i:null,n)}catch(d){c=d,l=null}return(!l||!U4(l)&&!Eue(l))&&(l=null),new cJe(a,l,c)}));for(const a of r){if(a.error)throw a.error;if(a.tokens)return a}return r.length>0?r[0]:null}function hJe(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:null}class uJe{constructor(e,t){this.provider=e,this.tokens=t}}function fJe(s,e){return s.has(e)}function Tue(s,e){const t=s.orderedGroups(e);return t.length>0?t[0]:[]}async function Mj(s,e,t,i){const n=Tue(s,e),o=await Promise.all(n.map(async r=>{let a;try{a=await r.provideDocumentRangeSemanticTokens(e,t,i)}catch(l){as(l),a=null}return(!a||!U4(a))&&(a=null),new uJe(r,a)}));for(const r of o)if(r.tokens)return r;return o.length>0?o[0]:null}Zt.registerCommand("_provideDocumentSemanticTokensLegend",async(s,...e)=>{const[t]=e;ti(t instanceof Ze);const i=s.get(Cn).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=s.get(We),o=hJe(n,i);return o?o[0].getLegend():s.get(en).executeCommand("_provideDocumentRangeSemanticTokensLegend",t)});Zt.registerCommand("_provideDocumentSemanticTokens",async(s,...e)=>{const[t]=e;ti(t instanceof Ze);const i=s.get(Cn).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=s.get(We);if(!kue(n,i))return s.get(en).executeCommand("_provideDocumentRangeSemanticTokens",t,i.getFullModelRange());const o=await Due(n,i,null,null,Ft.None);if(!o)return;const{provider:r,tokens:a}=o;if(!a||!U4(a))return;const l=Iue({id:0,type:"full",data:a.data});return a.resultId&&r.releaseDocumentSemanticTokens(a.resultId),l});Zt.registerCommand("_provideDocumentRangeSemanticTokensLegend",async(s,...e)=>{const[t,i]=e;ti(t instanceof Ze);const n=s.get(Cn).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:o}=s.get(We),r=Tue(o,n);if(r.length===0)return;if(r.length===1)return r[0].getLegend();if(!i||!D.isIRange(i))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),r[0].getLegend();const a=await Mj(o,n,D.lift(i),Ft.None);if(a)return a.provider.getLegend()});Zt.registerCommand("_provideDocumentRangeSemanticTokens",async(s,...e)=>{const[t,i]=e;ti(t instanceof Ze),ti(D.isIRange(i));const n=s.get(Cn).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:o}=s.get(We),r=await Mj(o,n,D.lift(i),Ft.None);if(!(!r||!r.tokens))return Iue({id:0,type:"full",data:r.tokens.data})});const Aj="editor.semanticHighlighting";function gN(s,e,t){var n;const i=(n=t.getValue(Aj,{overrideIdentifier:s.getLanguageId(),resource:s.uri}))==null?void 0:n.enabled;return typeof i=="boolean"?i:e.getColorTheme().semanticHighlighting}var Nue=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Jd=function(s,e){return function(t,i){e(t,i,s)}},Gf;let H6=class extends K{constructor(e,t,i,n,o,r){super(),this._watchers=new ts;const a=d=>{var h;(h=this._watchers.get(d.uri))==null||h.dispose(),this._watchers.set(d.uri,new V6(d,e,i,o,r))},l=(d,h)=>{h.dispose(),this._watchers.delete(d.uri)},c=()=>{for(const d of t.getModels()){const h=this._watchers.get(d.uri);gN(d,i,n)?h||a(d):h&&l(d,h)}};t.getModels().forEach(d=>{gN(d,i,n)&&a(d)}),this._register(t.onModelAdded(d=>{gN(d,i,n)&&a(d)})),this._register(t.onModelRemoved(d=>{const h=this._watchers.get(d.uri);h&&l(d,h)})),this._register(n.onDidChangeConfiguration(d=>{d.affectsConfiguration(Aj)&&c()})),this._register(i.onDidColorThemeChange(c))}dispose(){yi(this._watchers.values()),this._watchers.clear(),super.dispose()}};H6=Nue([Jd(0,z4),Jd(1,Cn),Jd(2,Dn),Jd(3,xt),Jd(4,$l),Jd(5,We)],H6);var lm;let V6=(lm=class extends K{constructor(e,t,i,n,o){super(),this._semanticTokensStylingService=t,this._isDisposed=!1,this._model=e,this._provider=o.documentSemanticTokensProvider,this._debounceInformation=n.for(this._provider,"DocumentSemanticTokens",{min:Gf.REQUEST_MIN_DELAY,max:Gf.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new Ni(()=>this._fetchDocumentSemanticTokensNow(),Gf.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._providersChangedDuringRequest=!1,this._register(this._model.onDidChangeContent(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeAttached(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeLanguage(()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)}));const r=()=>{yi(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const a of this._provider.all(e))typeof a.onDidChange=="function"&&this._documentProvidersChangeListeners.push(a.onDidChange(()=>{if(this._currentDocumentRequestCancellationTokenSource){this._providersChangedDuringRequest=!0;return}this._fetchDocumentSemanticTokens.schedule(0)}))};r(),this._register(this._provider.onDidChange(()=>{r(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(i.onDidColorThemeChange(a=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),yi(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[],this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!kue(this._provider,this._model)){this._currentDocumentResponse&&this._model.tokenization.setSemanticTokens(null,!1);return}if(!this._model.isAttachedToEditor())return;const e=new hn,t=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,i=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,n=Due(this._provider,this._model,t,i,e.token);this._currentDocumentRequestCancellationTokenSource=e,this._providersChangedDuringRequest=!1;const o=[],r=this._model.onDidChangeContent(l=>{o.push(l)}),a=new Fs(!1);n.then(l=>{if(this._debounceInformation.update(this._model,a.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),!l)this._setDocumentSemanticTokens(null,null,null,o);else{const{provider:c,tokens:d}=l,h=this._semanticTokensStylingService.getStyling(c);this._setDocumentSemanticTokens(c,d||null,h,o)}},l=>{l&&(il(l)||typeof l.message=="string"&&l.message.indexOf("busy")!==-1)||_t(l),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),(o.length>0||this._providersChangedDuringRequest)&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))})}static _copy(e,t,i,n,o){o=Math.min(o,i.length-n,e.length-t);for(let r=0;r<o;r++)i[n+r]=e[t+r]}_setDocumentSemanticTokens(e,t,i,n){const o=this._currentDocumentResponse,r=()=>{(n.length>0||this._providersChangedDuringRequest)&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed){e&&t&&e.releaseDocumentSemanticTokens(t.resultId);return}if(!e||!i){this._model.tokenization.setSemanticTokens(null,!1);return}if(!t){this._model.tokenization.setSemanticTokens(null,!0),r();return}if(Eue(t)){if(!o){this._model.tokenization.setSemanticTokens(null,!0);return}if(t.edits.length===0)t={resultId:t.resultId,data:o.data};else{let a=0;for(const u of t.edits)a+=(u.data?u.data.length:0)-u.deleteCount;const l=o.data,c=new Uint32Array(l.length+a);let d=l.length,h=c.length;for(let u=t.edits.length-1;u>=0;u--){const f=t.edits[u];if(f.start>l.length){i.warnInvalidEditStart(o.resultId,t.resultId,u,f.start,l.length),this._model.tokenization.setSemanticTokens(null,!0);return}const g=d-(f.start+f.deleteCount);g>0&&(Gf._copy(l,d-g,c,h-g,g),h-=g),f.data&&(Gf._copy(f.data,0,c,h-f.data.length,f.data.length),h-=f.data.length),d=f.start}d>0&&Gf._copy(l,0,c,0,d),t={resultId:t.resultId,data:c}}}if(U4(t)){this._currentDocumentResponse=new gJe(e,t.resultId,t.data);const a=Lue(t,i,this._model.getLanguageId());if(n.length>0)for(const l of n)for(const c of a)for(const d of l.changes)c.applyEdit(d.range,d.text);this._model.tokenization.setSemanticTokens(a,!0)}else this._model.tokenization.setSemanticTokens(null,!0);r()}},Gf=lm,lm.REQUEST_MIN_DELAY=300,lm.REQUEST_MAX_DELAY=2e3,lm);V6=Gf=Nue([Jd(1,z4),Jd(2,Dn),Jd(3,$l),Jd(4,We)],V6);class gJe{constructor(e,t,i){this.provider=e,this.resultId=t,this.data=i}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}C0(H6);var mJe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rS=function(s,e){return function(t,i){e(t,i,s)}},J1;let EM=(J1=class extends K{constructor(e,t,i,n,o,r){super(),this._semanticTokensStylingService=t,this._themeService=i,this._configurationService=n,this._editor=e,this._provider=r.documentRangeSemanticTokensProvider,this._debounceInformation=o.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new Ni(()=>this._tokenizeViewportNow(),100)),this._outstandingRequests=[],this._rangeProvidersChangeListeners=[];const a=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))},l=()=>{var c;if(this._cleanupProviderListeners(),this._editor.hasModel()){const d=this._editor.getModel();for(const h of this._provider.all(d)){const u=(c=h.onDidChange)==null?void 0:c.call(h,()=>{this._cancelAll(),a()});u&&this._rangeProvidersChangeListeners.push(u)}}};this._register(this._editor.onDidScrollChange(()=>{a()})),this._register(this._editor.onDidChangeModel(()=>{l(),this._cancelAll(),a()})),this._register(this._editor.onDidChangeModelLanguage(()=>{l(),this._cancelAll(),a()})),this._register(this._editor.onDidChangeModelContent(c=>{this._cancelAll(),a()})),l(),this._register(this._provider.onDidChange(()=>{l(),this._cancelAll(),a()})),this._register(this._configurationService.onDidChangeConfiguration(c=>{c.affectsConfiguration(Aj)&&(this._cancelAll(),a())})),this._register(this._themeService.onDidColorThemeChange(()=>{this._cancelAll(),a()})),a()}dispose(){this._cleanupProviderListeners(),super.dispose()}_cleanupProviderListeners(){yi(this._rangeProvidersChangeListeners),this._rangeProvidersChangeListeners=[]}_cancelAll(){for(const e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,i=this._outstandingRequests.length;t<i;t++)if(this._outstandingRequests[t]===e){this._outstandingRequests.splice(t,1);return}}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const e=this._editor.getModel();if(e.tokenization.hasCompleteSemanticTokens())return;if(!gN(e,this._themeService,this._configurationService)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}if(!fJe(this._provider,e)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}const t=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(t.map(i=>this._requestRange(e,i)))}_requestRange(e,t){const i=e.getVersionId(),n=ys(r=>Promise.resolve(Mj(this._provider,e,t,r))),o=new Fs(!1);return n.then(r=>{if(this._debounceInformation.update(e,o.elapsed()),!r||!r.tokens||e.isDisposed()||e.getVersionId()!==i)return;const{provider:a,tokens:l}=r,c=this._semanticTokensStylingService.getStyling(a);e.tokenization.setPartialSemanticTokens(t,Lue(l,c,e.getLanguageId()))}).then(()=>this._removeOutstandingRequest(n),()=>this._removeOutstandingRequest(n)),n}},J1.ID="editor.contrib.viewportSemanticTokens",J1);EM=mJe([rS(1,z4),rS(2,Dn),rS(3,xt),rS(4,$l),rS(5,We)],EM);Qt(EM.ID,EM,1);class pJe{constructor(e=!0){this.selectSubwords=e}provideSelectionRanges(e,t){const i=[];for(const n of t){const o=[];i.push(o),this.selectSubwords&&this._addInWordRanges(o,e,n),this._addWordRanges(o,e,n),this._addWhitespaceLine(o,e,n),o.push({range:e.getFullModelRange()})}return i}_addInWordRanges(e,t,i){const n=t.getWordAtPosition(i);if(!n)return;const{word:o,startColumn:r}=n,a=i.column-r;let l=a,c=a,d=0;for(;l>=0;l--){const h=o.charCodeAt(l);if(l!==a&&(h===95||h===45))break;if(bg(h)&&Yd(d))break;d=h}for(l+=1;c<o.length;c++){const h=o.charCodeAt(c);if(Yd(h)&&bg(d))break;if(h===95||h===45)break;d=h}l<c&&e.push({range:new D(i.lineNumber,r+l,i.lineNumber,r+c)})}_addWordRanges(e,t,i){const n=t.getWordAtPosition(i);n&&e.push({range:new D(i.lineNumber,n.startColumn,i.lineNumber,n.endColumn)})}_addWhitespaceLine(e,t,i){t.getLineLength(i.lineNumber)>0&&t.getLineFirstNonWhitespaceColumn(i.lineNumber)===0&&t.getLineLastNonWhitespaceColumn(i.lineNumber)===0&&e.push({range:new D(i.lineNumber,1,i.lineNumber,t.getLineMaxColumn(i.lineNumber))})}}var _Je=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},bJe=function(s,e){return function(t,i){e(t,i,s)}},z6;class Pj{constructor(e,t){this.index=e,this.ranges=t}mov(e){const t=this.index+(e?1:-1);if(t<0||t>=this.ranges.length)return this;const i=new Pj(t,this.ranges);return i.ranges[t].equalsRange(this.ranges[this.index])?i.mov(e):i}}var db;let HI=(db=class{static get(e){return e.getContribution(z6.ID)}constructor(e,t){this._editor=e,this._languageFeaturesService=t,this._ignoreSelection=!1}dispose(){var e;(e=this._selectionListener)==null||e.dispose()}async run(e){if(!this._editor.hasModel())return;const t=this._editor.getSelections(),i=this._editor.getModel();if(this._state||await Mue(this._languageFeaturesService.selectionRangeProvider,i,t.map(o=>o.getPosition()),this._editor.getOption(129),Ft.None).then(o=>{var r;if(!(!er(o)||o.length!==t.length)&&!(!this._editor.hasModel()||!dn(this._editor.getSelections(),t,(a,l)=>a.equalsSelection(l)))){for(let a=0;a<o.length;a++)o[a]=o[a].filter(l=>l.containsPosition(t[a].getStartPosition())&&l.containsPosition(t[a].getEndPosition())),o[a].unshift(t[a]);this._state=o.map(a=>new Pj(0,a)),(r=this._selectionListener)==null||r.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition(()=>{var a;this._ignoreSelection||((a=this._selectionListener)==null||a.dispose(),this._state=void 0)})}}),!this._state)return;this._state=this._state.map(o=>o.mov(e));const n=this._state.map(o=>Oe.fromPositions(o.ranges[o.index].getStartPosition(),o.ranges[o.index].getEndPosition()));this._ignoreSelection=!0;try{this._editor.setSelections(n)}finally{this._ignoreSelection=!1}}},z6=db,db.ID="editor.contrib.smartSelectController",db);HI=z6=_Je([bJe(1,We)],HI);class Rue extends Fe{constructor(e,t){super(t),this._forward=e}async run(e,t){const i=HI.get(t);i&&await i.run(this._forward)}}class vJe extends Rue{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:ne(1400,"Expand Selection"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"1_basic",title:_(1398,"&&Expand Selection"),order:2}})}}Zt.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");class CJe extends Rue{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:ne(1401,"Shrink Selection"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:He.MenubarSelectionMenu,group:"1_basic",title:_(1399,"&&Shrink Selection"),order:3}})}}Qt(HI.ID,HI,4);xe(vJe);xe(CJe);async function Mue(s,e,t,i,n){const o=s.all(e).concat(new pJe(i.selectSubwords));o.length===1&&o.unshift(new hM);const r=[],a=[];for(const l of o)r.push(Promise.resolve(l.provideSelectionRanges(e,t,n)).then(c=>{if(er(c)&&c.length===t.length)for(let d=0;d<t.length;d++){a[d]||(a[d]=[]);for(const h of c[d])D.isIRange(h.range)&&D.containsPosition(h.range,t[d])&&a[d].push(D.lift(h.range))}},as));return await Promise.all(r),a.map(l=>{if(l.length===0)return[];l.sort((u,f)=>z.isBefore(u.getStartPosition(),f.getStartPosition())?1:z.isBefore(f.getStartPosition(),u.getStartPosition())||z.isBefore(u.getEndPosition(),f.getEndPosition())?-1:z.isBefore(f.getEndPosition(),u.getEndPosition())?1:0);const c=[];let d;for(const u of l)(!d||D.containsRange(u,d)&&!D.equalsRange(u,d))&&(c.push(u),d=u);if(!i.selectLeadingAndTrailingWhitespace)return c;const h=[c[0]];for(let u=1;u<c.length;u++){const f=c[u-1],g=c[u];if(g.startLineNumber!==f.startLineNumber||g.endLineNumber!==f.endLineNumber){const m=new D(f.startLineNumber,e.getLineFirstNonWhitespaceColumn(f.startLineNumber),f.endLineNumber,e.getLineLastNonWhitespaceColumn(f.endLineNumber));m.containsRange(f)&&!m.equalsRange(f)&&g.containsRange(m)&&!g.equalsRange(m)&&h.push(m);const p=new D(f.startLineNumber,1,f.endLineNumber,e.getLineMaxColumn(f.endLineNumber));p.containsRange(f)&&!p.equalsRange(m)&&g.containsRange(p)&&!g.equalsRange(p)&&h.push(p)}h.push(g)}return h})}Zt.registerCommand("_executeSelectionRangeProvider",async function(s,...e){const[t,i]=e;ti(Ze.isUri(t)),ti(_ke(i,r=>z.isIPosition(r)));const n=s.get(We).selectionRangeProvider,o=await s.get(nr).createModelReference(t);try{return Mue(n,o.object.textEditorModel,i.map(z.lift),{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},Ft.None)}finally{o.dispose()}});const U6=Object.freeze({View:ne(1638,"View"),Help:ne(1639,"Help"),Test:ne(1640,"Test"),File:ne(1641,"File"),Preferences:ne(1642,"Preferences"),Developer:ne(1643,"Developer")});class wJe extends wc{constructor(){super({id:"editor.action.toggleStickyScroll",title:{...ne(1448,"Toggle Editor Sticky Scroll"),mnemonicTitle:_(1444,"&&Toggle Editor Sticky Scroll")},metadata:{description:ne(1449,"Toggle/enable the editor sticky scroll which shows the nested scopes at the top of the viewport")},category:U6.View,toggled:{condition:de.equals("config.editor.stickyScroll.enabled",!0),title:_(1445,"Sticky Scroll"),mnemonicTitle:_(1446,"&&Sticky Scroll")},menu:[{id:He.CommandPalette},{id:He.MenubarAppearanceMenu,group:"4_editor",order:3},{id:He.StickyScrollContext}]})}async runEditorCommand(e,t){var r;const i=e.get(xt),n=!i.getValue("editor.stickyScroll.enabled"),o=(r=bc.get(t))==null?void 0:r.isFocused();i.updateValue("editor.stickyScroll.enabled",n),o&&t.focus()}}const $4=100;class yJe extends wc{constructor(){super({id:"editor.action.focusStickyScroll",title:{...ne(1450,"Focus Editor Sticky Scroll"),mnemonicTitle:_(1447,"&&Focus Editor Sticky Scroll")},precondition:de.and(de.has("config.editor.stickyScroll.enabled"),B.stickyScrollVisible),menu:[{id:He.CommandPalette}]})}runEditorCommand(e,t){var i;(i=bc.get(t))==null||i.focus()}}class SJe extends wc{constructor(){super({id:"editor.action.selectNextStickyScrollLine",title:ne(1451,"Select the next editor sticky scroll line"),precondition:B.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:$4,primary:18}})}runEditorCommand(e,t){var i;(i=bc.get(t))==null||i.focusNext()}}class xJe extends wc{constructor(){super({id:"editor.action.selectPreviousStickyScrollLine",title:ne(1452,"Select the previous sticky scroll line"),precondition:B.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:$4,primary:16}})}runEditorCommand(e,t){var i;(i=bc.get(t))==null||i.focusPrevious()}}class LJe extends wc{constructor(){super({id:"editor.action.goToFocusedStickyScrollLine",title:ne(1453,"Go to the focused sticky scroll line"),precondition:B.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:$4,primary:3}})}runEditorCommand(e,t){var i;(i=bc.get(t))==null||i.goToFocused()}}class IJe extends wc{constructor(){super({id:"editor.action.selectEditor",title:ne(1454,"Select Editor"),precondition:B.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:$4,primary:9}})}runEditorCommand(e,t){var i;(i=bc.get(t))==null||i.selectEditor()}}Qt(bc.ID,bc,1);Ei(wJe);Ei(yJe);Ei(xJe);Ei(SJe);Ei(LJe);Ei(IJe);var Aue=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},AS=function(s,e){return function(t,i){e(t,i,s)}};class EJe{constructor(e,t,i,n,o,r,a){this.range=e,this.insertText=t,this.filterText=i,this.additionalTextEdits=n,this.command=o,this.gutterMenuLinkAction=r,this.completion=a}}let $6=class extends Uke{constructor(e,t,i,n,o,r){super(o.disposable),this.model=e,this.line=t,this.word=i,this.completionModel=n,this._suggestMemoryService=r}canBeReused(e,t,i){return this.model===e&&this.line===t&&this.word.word.length>0&&this.word.startColumn===i.startColumn&&this.word.endColumn<i.endColumn&&this.completionModel.getIncompleteProvider().size===0}get items(){const e=[],{items:t}=this.completionModel,i=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},t),n=Gt.slice(t,i),o=Gt.slice(t,0,i);let r=5;for(const a of Gt.concat(n,o)){if(a.score===fc.Default)continue;const l=new D(a.editStart.lineNumber,a.editStart.column,a.editInsertEnd.lineNumber,a.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),c=a.completion.insertTextRules&&a.completion.insertTextRules&4?{snippet:a.completion.insertText}:a.completion.insertText;e.push(new EJe(l,c,a.filterTextLow??a.labelLow,a.completion.additionalTextEdits,a.completion.command,a.completion.action,a)),r-->=0&&a.resolve(Ft.None)}return e}};$6=Aue([AS(5,B4)],$6);let q6=class extends K{constructor(e,t,i,n){super(),this._languageFeatureService=e,this._clipboardService=t,this._suggestMemoryService=i,this._editorService=n,this._store.add(e.inlineCompletionsProvider.register("*",this))}async provideInlineCompletions(e,t,i,n){var f;if(i.selectedSuggestionInfo)return;let o;for(const g of this._editorService.listCodeEditors())if(g.getModel()===e){o=g;break}if(!o)return;const r=o.getOption(102);if(BC.isAllOff(r))return;e.tokenization.tokenizeIfCheap(t.lineNumber);const a=e.tokenization.getLineTokens(t.lineNumber),l=a.getStandardTokenType(a.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(BC.valueFor(r,l)!=="inline")return;let c=e.getWordAtPosition(t),d;if(c!=null&&c.word||(d=this._getTriggerCharacterInfo(e,t)),!(c!=null&&c.word)&&!d||(c||(c=e.getWordUntilPosition(t)),c.endColumn!==t.column))return;let h;const u=e.getValueInRange(new D(t.lineNumber,1,t.lineNumber,t.column));if(!d&&((f=this._lastResult)!=null&&f.canBeReused(e,t.lineNumber,c))){const g=new dee(u,t.column-this._lastResult.word.endColumn);this._lastResult.completionModel.lineContext=g,this._lastResult.acquire(),h=this._lastResult}else{const g=await bj(this._languageFeatureService.completionProvider,e,t,new kI(void 0,fM.createSuggestFilter(o).itemKind,d==null?void 0:d.providers),d&&{triggerKind:1,triggerCharacter:d.ch},n);let m;g.needsClipboard&&(m=await this._clipboardService.readText());const p=new hg(g.items,t.column,new dee(u,0),uM.None,o.getOption(134),o.getOption(128),{boostFullMatch:!1,firstMatchCanBeWeak:!1},m);h=new $6(e,t.lineNumber,c,p,g,this._suggestMemoryService)}return this._lastResult=h,h}handleItemDidShow(e,t){t.completion.resolve(Ft.None)}disposeInlineCompletions(e){e.release()}_getTriggerCharacterInfo(e,t){var o;const i=e.getValueInRange(D.fromPositions({lineNumber:t.lineNumber,column:t.column-1},t)),n=new Set;for(const r of this._languageFeatureService.completionProvider.all(e))(o=r.triggerCharacters)!=null&&o.includes(i)&&n.add(r);if(n.size!==0)return{providers:n,ch:i}}};q6=Aue([AS(0,We),AS(1,pa),AS(2,B4),AS(3,ii)],q6);C0(q6);class kJe extends Fe{constructor(){super({id:"editor.action.forceRetokenize",label:ne(1532,"Developer: Force Retokenize"),precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getModel();i.tokenization.resetTokenization();const n=new Fs;i.tokenization.forceTokenization(i.getLineCount()),n.stop(),console.log(`tokenization took ${n.elapsed()}`)}}xe(kJe);const wP=class wP extends Gs{constructor(){super({id:wP.ID,title:ne(1530,"Toggle Tab Key Moves Focus"),precondition:void 0,keybinding:{primary:2091,mac:{primary:1323},weight:100},metadata:{description:ne(1531,"Determines whether the tab key moves focus around the workbench or inserts the tab character in the current editor. This is also called tab trapping, tab navigation, or tab focus mode.")},f1:!0})}run(){const t=!ww.getTabFocusMode();ww.setTabFocusMode(t),br(t?_(1528,"Pressing Tab will now move focus to the next focusable element"):_(1529,"Pressing Tab will now insert the tab character"))}};wP.ID="editor.action.toggleTabFocusMode";let j6=wP;Ei(j6);class Oj{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,o=i?i.endLineNumber:e.getLineCount(),r=new Vee(t),a=r.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${DJe(Array.from(a))}`,"g");const c=new RC(null,l),d=[];let h=!1,u,f=0,g=0,m=0;e:for(let p=n,v=o;p<=v;p++){const b=e.getLineContent(p),w=b.length;c.reset(0);do if(u=c.next(b),u){let C=u.index,y=u.index+u[0].length;if(C>0){const E=b.charCodeAt(C-1);vs(E)&&C--}if(y+1<w){const E=b.charCodeAt(y-1);vs(E)&&y++}const x=b.substring(C,y);let S=EL(C+1,$U,b,0);S&&S.endColumn<=C+1&&(S=null);const L=r.shouldHighlightNonBasicASCII(x,S?S.word:null);if(L!==0){if(L===3?f++:L===2?g++:L===1?m++:nk(),d.length>=1e3){h=!0;break e}d.push(new D(p,C+1,p,y+1))}}while(u)}return{ranges:d,hasMore:h,ambiguousCharacterCount:f,invisibleCharacterCount:g,nonBasicAsciiCharacterCount:m}}static computeUnicodeHighlightReason(e,t){const i=new Vee(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const o=e.codePointAt(0),r=i.ambiguousCharacters.getPrimaryConfusable(o),a=_L.getLocales().filter(l=>!_L.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(o));return{kind:0,confusableWith:String.fromCodePoint(r),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function DJe(s,e){return`[${ua(s.map(i=>String.fromCodePoint(i)).join(""))}]`}class Vee{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=_L.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of r_.codePoints)zee(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,o=!1;if(t)for(const r of t){const a=r.codePointAt(0),l=ck(r);n=n||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!r_.isInvisibleCharacter(a)&&(o=!0)}return!n&&o?0:this.options.invisibleCharacters&&!zee(e)&&r_.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function zee(s){return s===" "||s===`
`||s==="	"}var TJe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Uee=function(s,e){return function(t,i){e(t,i,s)}};let K6=class extends K{get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}constructor(e,t,i={},n,o){super(),this._link=t,this._hoverService=n,this._enabled=!0,this.el=me(e,we("a.monaco-link",{tabIndex:t.tabIndex??0,href:t.href},t.label)),this.hoverDelegate=i.hoverDelegate??Fh("mouse"),this.setTooltip(t.title),this.el.setAttribute("role","button");const r=this._register(new Si(this.el,"click")),a=this._register(new Si(this.el,"keypress")),l=Se.chain(a.event,h=>h.map(u=>new Bi(u)).filter(u=>u.keyCode===3)),c=this._register(new Si(this.el,Qi.Tap)).event;this._register(Oo.addTarget(this.el));const d=Se.any(r.event,l,c);this._register(d(h=>{this.enabled&&(ri.stop(h,!0),i!=null&&i.opener?i.opener(this._link.href):o.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}setTooltip(e){!this.hover&&e?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,e)):this.hover&&this.hover.update(e)}};K6=TJe([Uee(3,Sr),Uee(4,Rf)],K6);var Pue=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},G6=function(s,e){return function(t,i){e(t,i,s)}};const NJe=26;let Y6=class extends K{constructor(e,t){super(),this._editor=e,this.instantiationService=t,this.banner=this._register(this.instantiationService.createInstance(X6))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(e){this.banner.show({...e,onClose:()=>{var t;this.hide(),(t=e.onClose)==null||t.call(e)}}),this._editor.setBanner(this.banner.element,NJe)}};Y6=Pue([G6(1,$e)],Y6);let X6=class extends K{constructor(e,t){super(),this.instantiationService=e,this.markdownRendererService=t,this.element=we("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(e){if(e.ariaLabel)return e.ariaLabel;if(typeof e.message=="string")return e.message}getBannerMessage(e){if(typeof e=="string"){const t=we("span");return t.innerText=e,t}return this.markdownRendererService.render(e).element}clear(){io(this.element)}show(e){io(this.element);const t=this.getAriaLabel(e);t&&this.element.setAttribute("aria-label",t);const i=me(this.element,we("div.icon-container"));i.setAttribute("aria-hidden","true"),e.icon&&i.appendChild(we(`div${it.asCSSSelector(e.icon)}`));const n=me(this.element,we("div.message-container"));if(n.setAttribute("aria-hidden","true"),n.appendChild(this.getBannerMessage(e.message)),this.messageActionsContainer=me(this.element,we("div.message-actions-container")),e.actions)for(const r of e.actions)this._register(this.instantiationService.createInstance(K6,this.messageActionsContainer,{...r,tabIndex:-1},{}));const o=me(this.element,we("div.action-container"));this.actionBar=this._register(new Fr(o)),this.actionBar.push(this._register(new Ga("banner.close",_(1533,"Close Banner"),it.asClassName(ece),!0,()=>{typeof e.onClose=="function"&&e.onClose()})),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};X6=Pue([G6(0,$e),G6(1,Sc)],X6);const Oue=Mt("workspaceTrustManagementService");var Fj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ex=function(s,e){return function(t,i){e(t,i,s)}};const RJe=rn("extensions-warning-message",ge.warning,_(1534,"Icon shown with a warning message in the extensions editor."));var ew;let VI=(ew=class extends K{constructor(e,t,i,n){super(),this._editor=e,this._editorWorkerService=t,this._workspaceTrustService=i,this._highlighter=null,this._bannerClosed=!1,this._updateState=o=>{if(o&&o.hasMore){if(this._bannerClosed)return;const r=Math.max(o.ambiguousCharacterCount,o.nonBasicAsciiCharacterCount,o.invisibleCharacterCount);let a;if(o.nonBasicAsciiCharacterCount>=r)a={message:_(1535,"This document contains many non-basic ASCII unicode characters"),command:new UI};else if(o.ambiguousCharacterCount>=r)a={message:_(1536,"This document contains many ambiguous unicode characters"),command:new lv};else if(o.invisibleCharacterCount>=r)a={message:_(1537,"This document contains many invisible unicode characters"),command:new zI};else throw new Error("Unreachable");this._bannerController.show({id:"unicodeHighlightBanner",message:a.message,icon:RJe,actions:[{label:a.command.shortLabel,href:`command:${a.command.desc.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(n.createInstance(Y6,e)),this._register(this._editor.onDidChangeModel(()=>{this._bannerClosed=!1,this._updateHighlighter()})),this._options=e.getOption(142),this._register(i.onDidChangeTrust(o=>{this._updateHighlighter()})),this._register(e.onDidChangeConfiguration(o=>{o.hasChanged(142)&&(this._options=e.getOption(142),this._updateHighlighter())})),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const e=MJe(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([e.nonBasicASCII,e.ambiguousCharacters,e.invisibleCharacters].every(i=>i===!1))return;const t={nonBasicASCII:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments,includeStrings:e.includeStrings,allowedCodePoints:Object.keys(e.allowedCharacters).map(i=>i.codePointAt(0)),allowedLocales:Object.keys(e.allowedLocales).map(i=>i==="_os"?bv.NumberFormat().value.resolvedOptions().locale:i==="_vscode"?Ike:i)};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new Z6(this._editor,t,this._updateState,this._editorWorkerService):this._highlighter=new AJe(this._editor,t,this._updateState)}getDecorationInfo(e){return this._highlighter?this._highlighter.getDecorationInfo(e):null}},ew.ID="editor.contrib.unicodeHighlighter",ew);VI=Fj([Ex(1,jr),Ex(2,Oue),Ex(3,$e)],VI);function MJe(s,e){return{nonBasicASCII:e.nonBasicASCII===Na?!s:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments===Na?!s:e.includeComments,includeStrings:e.includeStrings===Na?!s:e.includeStrings,allowedCharacters:e.allowedCharacters,allowedLocales:e.allowedLocales}}let Z6=class extends K{constructor(e,t,i,n){super(),this._editor=e,this._options=t,this._updateState=i,this._editorWorkerService=n,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new Ni(()=>this._update(),250)),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then(t=>{if(this._model.isDisposed()||this._model.getVersionId()!==e)return;this._updateState(t);const i=[];if(!t.hasMore)for(const n of t.ranges)i.push({range:n,options:kM.instance.getDecorationFromOptions(this._options)});this._decorations.set(i)})}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel();if(!y$(t,e))return null;const i=t.getValueInRange(e.range);return{reason:Bue(i,this._options),inComment:S$(t,e),inString:x$(t,e)}}};Z6=Fj([Ex(3,jr)],Z6);class AJe extends K{constructor(e,t,i){super(),this._editor=e,this._options=t,this._updateState=i,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new Ni(()=>this._update(),250)),this._register(this._editor.onDidLayoutChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidScrollChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeHiddenAreas(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._editor.getVisibleRanges(),t=[],i={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const n of e){const o=Oj.computeUnicodeHighlights(this._model,this._options,n);for(const r of o.ranges)i.ranges.push(r);i.ambiguousCharacterCount+=i.ambiguousCharacterCount,i.invisibleCharacterCount+=i.invisibleCharacterCount,i.nonBasicAsciiCharacterCount+=i.nonBasicAsciiCharacterCount,i.hasMore=i.hasMore||o.hasMore}if(!i.hasMore)for(const n of i.ranges)t.push({range:n,options:kM.instance.getDecorationFromOptions(this._options)});this._updateState(i),this._decorations.set(t)}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel(),i=t.getValueInRange(e.range);return y$(t,e)?{reason:Bue(i,this._options),inComment:S$(t,e),inString:x$(t,e)}:null}}const Fue=_(1538,"Configure Unicode Highlight Options");let Q6=class{constructor(e,t){this._editor=e,this._markdownRendererService=t,this.hoverOrdinal=5}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=this._editor.getContribution(VI.ID);if(!n)return[];const o=[],r=new Set;let a=300;for(const l of t){const c=n.getDecorationInfo(l);if(!c)continue;const h=i.getValueInRange(l.range).codePointAt(0),u=x3(h);let f;switch(c.reason.kind){case 0:{ck(c.reason.confusableWith)?f=_(1539,"The character {0} could be confused with the ASCII character {1}, which is more common in source code.",u,x3(c.reason.confusableWith.codePointAt(0))):f=_(1540,"The character {0} could be confused with the character {1}, which is more common in source code.",u,x3(c.reason.confusableWith.codePointAt(0)));break}case 1:f=_(1541,"The character {0} is invisible.",u);break;case 2:f=_(1542,"The character {0} is not a basic ASCII character.",u);break}if(r.has(f))continue;r.add(f);const g={codePoint:h,reason:c.reason,inComment:c.inComment,inString:c.inString},m=_(1543,"Adjust settings"),p=_le(DM.ID,g),v=new To("",!0).appendMarkdown(f).appendText(" ").appendLink(p,m,Fue);o.push(new cc(this,l.range,[v],!1,a++))}return o}renderHoverParts(e,t){return dUe(e,t,this._editor,this._markdownRendererService)}getAccessibleContent(e){return e.contents.map(t=>t.value).join(`
`)}};Q6=Fj([Ex(1,Sc)],Q6);function J6(s){return`U+${s.toString(16).padStart(4,"0")}`}function x3(s){let e=`\`${J6(s)}\``;return r_.isInvisibleCharacter(s)||(e+=` "${`${PJe(s)}`}"`),e}function PJe(s){return s===96?"`` ` ``":"`"+String.fromCodePoint(s)+"`"}function Bue(s,e){return Oj.computeUnicodeHighlightReason(s,e)}const yP=class yP{constructor(){this.map=new Map}getDecorationFromOptions(e){return this.getDecoration(!e.includeComments,!e.includeStrings)}getDecoration(e,t){const i=`${e}${t}`;let n=this.map.get(i);return n||(n=vt.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:e,hideInStringTokens:t}),this.map.set(i,n)),n}};yP.instance=new yP;let kM=yP;class OJe extends Fe{constructor(){super({id:lv.ID,label:ne(1552,"Disable highlighting of characters in comments"),precondition:void 0}),this.shortLabel=_(1544,"Disable Highlight In Comments")}async run(e,t,i){const n=e.get(xt);n&&this.runAction(n)}async runAction(e){await e.updateValue(Rr.includeComments,!1,2)}}class FJe extends Fe{constructor(){super({id:lv.ID,label:ne(1553,"Disable highlighting of characters in strings"),precondition:void 0}),this.shortLabel=_(1545,"Disable Highlight In Strings")}async run(e,t,i){const n=e.get(xt);n&&this.runAction(n)}async runAction(e){await e.updateValue(Rr.includeStrings,!1,2)}}const SP=class SP extends Gs{constructor(){super({id:SP.ID,title:ne(1554,"Disable highlighting of ambiguous characters"),precondition:void 0,f1:!1}),this.shortLabel=_(1546,"Disable Ambiguous Highlight")}async run(e,t,i){const n=e.get(xt);n&&this.runAction(n)}async runAction(e){await e.updateValue(Rr.ambiguousCharacters,!1,2)}};SP.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";let lv=SP;const xP=class xP extends Gs{constructor(){super({id:xP.ID,title:ne(1555,"Disable highlighting of invisible characters"),precondition:void 0,f1:!1}),this.shortLabel=_(1547,"Disable Invisible Highlight")}async run(e,t,i){const n=e.get(xt);n&&this.runAction(n)}async runAction(e){await e.updateValue(Rr.invisibleCharacters,!1,2)}};xP.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";let zI=xP;const LP=class LP extends Gs{constructor(){super({id:LP.ID,title:ne(1556,"Disable highlighting of non basic ASCII characters"),precondition:void 0,f1:!1}),this.shortLabel=_(1548,"Disable Non ASCII Highlight")}async run(e,t,i){const n=e.get(xt);n&&this.runAction(n)}async runAction(e){await e.updateValue(Rr.nonBasicASCII,!1,2)}};LP.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";let UI=LP;const IP=class IP extends Gs{constructor(){super({id:IP.ID,title:ne(1557,"Show Exclude Options"),precondition:void 0,f1:!1})}async run(e,t){const{codePoint:i,reason:n,inString:o,inComment:r}=t,a=String.fromCodePoint(i),l=e.get(Fo),c=e.get(xt);function d(g){return r_.isInvisibleCharacter(g)?_(1549,"Exclude {0} (invisible character) from being highlighted",J6(g)):_(1550,"Exclude {0} from being highlighted",`${J6(g)} "${a}"`)}const h=[];if(n.kind===0)for(const g of n.notAmbiguousInLocales)h.push({label:_(1551,'Allow unicode characters that are more common in the language "{0}".',g),run:async()=>{WJe(c,[g])}});if(h.push({label:d(i),run:()=>BJe(c,[i])}),r){const g=new OJe;h.push({label:g.label,run:async()=>g.runAction(c)})}else if(o){const g=new FJe;h.push({label:g.label,run:async()=>g.runAction(c)})}function u(g){return typeof g.desc.title=="string"?g.desc.title:g.desc.title.value}if(n.kind===0){const g=new lv;h.push({label:u(g),run:async()=>g.runAction(c)})}else if(n.kind===1){const g=new zI;h.push({label:u(g),run:async()=>g.runAction(c)})}else if(n.kind===2){const g=new UI;h.push({label:u(g),run:async()=>g.runAction(c)})}else HJe(n);const f=await l.pick(h,{title:Fue});f&&await f.run()}};IP.ID="editor.action.unicodeHighlight.showExcludeOptions";let DM=IP;async function BJe(s,e){const t=s.getValue(Rr.allowedCharacters);let i;typeof t=="object"&&t?i=t:i={};for(const n of e)i[String.fromCodePoint(n)]=!0;await s.updateValue(Rr.allowedCharacters,i,2)}async function WJe(s,e){var n;const t=(n=s.inspect(Rr.allowedLocales).user)==null?void 0:n.value;let i;typeof t=="object"&&t?i=Object.assign({},t):i={};for(const o of e)i[o]=!0;await s.updateValue(Rr.allowedLocales,i,2)}function HJe(s){throw new Error(`Unexpected value: ${s}`)}Ei(lv);Ei(zI);Ei(UI);Ei(DM);Qt(VI.ID,VI,1);kv.register(Q6);const $k=Mt("dialogService");var VJe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},$ee=function(s,e){return function(t,i){e(t,i,s)}};const Wue="ignoreUnusualLineTerminators";function zJe(s,e,t){s.setModelProperty(e.uri,Wue,t)}function UJe(s,e){return s.getModelProperty(e.uri,Wue)}var tw;let TM=(tw=class extends K{constructor(e,t,i){super(),this._editor=e,this._dialogService=t,this._codeEditorService=i,this._isPresentingDialog=!1,this._config=this._editor.getOption(143),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(143)&&(this._config=this._editor.getOption(143),this._checkForUnusualLineTerminators())})),this._register(this._editor.onDidChangeModel(()=>{this._checkForUnusualLineTerminators()})),this._register(this._editor.onDidChangeModelContent(n=>{n.isUndoing||this._checkForUnusualLineTerminators()})),this._checkForUnusualLineTerminators()}async _checkForUnusualLineTerminators(){if(this._config==="off"||!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators()||UJe(this._codeEditorService,e)===!0||this._editor.getOption(104))return;if(this._config==="auto"){e.removeUnusualLineTerminators(this._editor.getSelections());return}if(this._isPresentingDialog)return;let i;try{this._isPresentingDialog=!0,i=await this._dialogService.confirm({title:_(1558,"Unusual Line Terminators"),message:_(1559,"Detected unusual line terminators"),detail:_(1560,"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",Fl(e.uri)),primaryButton:_(1561,"&&Remove Unusual Line Terminators"),cancelButton:_(1562,"Ignore")})}finally{this._isPresentingDialog=!1}if(!i.confirmed){zJe(this._codeEditorService,e,!0);return}e.removeUnusualLineTerminators(this._editor.getSelections())}},tw.ID="editor.contrib.unusualLineTerminatorsDetector",tw);TM=VJe([$ee(1,$k),$ee(2,ii)],TM);Qt(TM.ID,TM,1);const fT="**",qee="/",mN="[/\\\\]",pN="[^/\\\\]",$Je=/\//g;function jee(s,e){switch(s){case 0:return"";case 1:return`${pN}*?`;default:return`(?:${mN}|${pN}+${mN}${e?`|${mN}${pN}+`:""})*?`}}function Kee(s,e){if(!s)return[];const t=[];let i=!1,n=!1,o="";for(const r of s){switch(r){case e:if(!i&&!n){t.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}o+=r}return o&&t.push(o),t}function Hue(s){if(!s)return"";let e="";const t=Kee(s,qee);if(t.every(i=>i===fT))e=".*";else{let i=!1;t.forEach((n,o)=>{if(n===fT){if(i)return;e+=jee(2,o===t.length-1)}else{let r=!1,a="",l=!1,c="";for(const d of n){if(d!=="}"&&r){a+=d;continue}if(l&&(d!=="]"||!c)){let h;d==="-"?h=d:(d==="^"||d==="!")&&!c?h="^":d===qee?h="":h=ua(d),c+=h;continue}switch(d){case"{":r=!0;continue;case"[":l=!0;continue;case"}":{const u=`(?:${Kee(a,",").map(f=>Hue(f)).join("|")})`;e+=u,r=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=pN;continue;case"*":e+=jee(1);continue;default:e+=ua(d)}}o<t.length-1&&(t[o+1]!==fT||o+2<t.length)&&(e+=mN)}i=n===fT})}return e}const qJe=/^\*\*\/\*\.[\w\.-]+$/,jJe=/^\*\*\/([\w\.-]+)\/?$/,KJe=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,GJe=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,YJe=/^\*\*((\/[\w\.-]+)+)\/?$/,XJe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Gee=new Cc(1e4),Yee=function(){return!1},vh=function(){return null};function Bj(s,e){if(!s)return vh;let t;typeof s!="string"?t=s.pattern:t=s,t=t.trim();const i=e.ignoreCase??!1,n={...e,equals:i?zp:(l,c)=>l===c,endsWith:i?fDe:(l,c)=>l.endsWith(c),isEqualOrParent:(l,c)=>Y9(l,c,!Hr||i)},o=`${i?t.toLowerCase():t}_${!!e.trimForExclusions}_${i}`;let r=Gee.get(o);if(r)return Xee(r,s,n);let a;return qJe.test(t)?r=ZJe(t.substring(4),t,n):(a=jJe.exec(L3(t,n)))?r=QJe(a[1],t,n):(e.trimForExclusions?GJe:KJe).test(t)?r=JJe(t,n):(a=YJe.exec(L3(t,n)))?r=Zee(a[1].substring(1),t,!0,n):(a=XJe.exec(L3(t,n)))?r=Zee(a[1],t,!1,n):r=eet(t,n),Gee.set(o,r),Xee(r,s,n)}function Xee(s,e,t){if(typeof e=="string")return s;const i=function(n,o){return t.isEqualOrParent(n,e.base)?s(lk(n.substring(e.base.length),id),o):null};return i.allBasenames=s.allBasenames,i.allPaths=s.allPaths,i.basenames=s.basenames,i.patterns=s.patterns,i}function L3(s,e){return e.trimForExclusions&&s.endsWith("/**")?s.substring(0,s.length-2):s}function ZJe(s,e,t){return function(i,n){return typeof i=="string"&&t.endsWith(i,s)?e:null}}function QJe(s,e,t){const i=`/${s}`,n=`\\${s}`,o=function(a,l){return typeof a!="string"?null:l?t.equals(l,s)?e:null:t.equals(a,s)||t.endsWith(a,i)||t.endsWith(a,n)?e:null},r=[s];return o.basenames=r,o.patterns=[e],o.allBasenames=r,o}function JJe(s,e){const t=zue(s.slice(1,-1).split(",").map(a=>Bj(a,e)).filter(a=>a!==vh),s),i=t.length;if(!i)return vh;if(i===1)return t[0];const n=function(a,l){for(let c=0,d=t.length;c<d;c++)if(t[c](a,l))return s;return null},o=t.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(n.allPaths=r),n}function Zee(s,e,t,i){const n=id===hs.sep,o=n?s:s.replace($Je,id),r=id+o,a=hs.sep+s;let l;return t?l=function(c,d){return typeof c=="string"&&(i.equals(c,o)||i.endsWith(c,r)||!n&&(i.equals(c,s)||i.endsWith(c,a)))?e:null}:l=function(c,d){return typeof c=="string"&&(i.equals(c,o)||!n&&i.equals(c,s))?e:null},l.allPaths=[(t?"*/":"./")+s],l}function eet(s,e){try{const t=new RegExp(`^${Hue(s)}$`,e.ignoreCase?"i":void 0);return function(i){return t.lastIndex=0,typeof i=="string"&&t.test(i)?s:null}}catch{return vh}}function tet(s,e,t){return!s||typeof e!="string"?!1:Vue(s,t)(e)}function Vue(s,e={}){if(!s)return Yee;if(typeof s=="string"||iet(s)){const t=Bj(s,e);if(t===vh)return Yee;const i=function(n,o){return!!t(n,o)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return net(s,e)}function iet(s){const e=s;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function net(s,e){const t=zue(Object.getOwnPropertyNames(s).map(a=>set(a,s[a],e)).filter(a=>a!==vh)),i=t.length;if(!i)return vh;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(d,h){let u;for(let f=0,g=t.length;f<g;f++){const m=t[f](d,h);if(typeof m=="string")return m;E9(m)&&(u||(u=[]),u.push(m))}return u?(async()=>{for(const f of u){const g=await f;if(typeof g=="string")return g}return null})():null},l=t.find(d=>!!d.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((d,h)=>h.allPaths?d.concat(h.allPaths):d,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let d,h;for(let u=0,f=t.length;u<f;u++){const g=t[u];g.requiresSiblings&&c&&(l||(l=Xu(a)),d||(d=l.substring(0,l.length-PDe(a).length)));const m=g(a,l,d,c);if(typeof m=="string")return m;E9(m)&&(h||(h=[]),h.push(m))}return h?(async()=>{for(const u of h){const f=await u;if(typeof f=="string")return f}return null})():null},o=t.find(a=>!!a.allBasenames);o&&(n.allBasenames=o.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(n.allPaths=r),n}function set(s,e,t){if(e===!1)return vh;const i=Bj(s,t);if(i===vh)return vh;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const o=(r,a,l,c)=>{if(!c||!i(r,a))return null;const d=n.replace("$(basename)",()=>l),h=c(d);return E9(h)?h.then(u=>u?s:null):h?s:null};return o.requiresSiblings=!0,o}}return i}function zue(s,e){const t=s.filter(a=>!!a.basenames);if(t.length<2)return s;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const o=function(a,l){if(typeof a!="string")return null;if(!l){let d;for(d=a.length;d>0;d--){const h=a.charCodeAt(d-1);if(h===47||h===92)break}l=a.substring(d)}const c=i.indexOf(l);return c!==-1?n[c]:null};o.basenames=i,o.patterns=n,o.allBasenames=i;const r=s.filter(a=>!a.basenames);return r.push(o),r}function Wj(s,e,t,i,n,o){if(Array.isArray(s)){let r=0;for(const a of s){const l=Wj(a,e,t,i,n,o);if(l===10)return l;l>r&&(r=l)}return r}else{if(typeof s=="string")return i?s==="*"?5:s===t?10:0:0;if(s){const{language:r,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:d}=s;if(!i&&!c)return 0;d&&n&&(e=n);let h=0;if(l)if(l===e.scheme)h=10;else if(l==="*")h=5;else return 0;if(r)if(r===t)h=10;else if(r==="*")h=Math.max(h,5);else return 0;if(d)if(d===o)h=10;else if(d==="*"&&o!==void 0)h=Math.max(h,5);else return 0;if(a){let u;if(typeof a=="string"?u=a:u={...a,base:Kse(a.base)},u===e.fsPath||tet(u,e.fsPath))h=10;else return 0}return h}else return 0}}var oet=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ret=function(s,e){return function(t,i){e(t,i,s)}};class Qee{constructor(){this.selector={language:"*"}}provideDocumentHighlights(e,t,i){const n=[],o=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});return o?e.isDisposed()?void 0:e.findMatches(o.word,!0,!1,!0,oR,!1).map(a=>({range:a.range,kind:Nw.Text})):Promise.resolve(n)}provideMultiDocumentHighlights(e,t,i,n){const o=new ts,r=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});if(!r)return Promise.resolve(o);for(const a of[e,...i]){if(a.isDisposed())continue;const c=a.findMatches(r.word,!0,!1,!0,oR,!1).map(d=>({range:d.range,kind:Nw.Text}));c&&o.set(a.uri,c)}return o}}let eH=class extends K{constructor(e){super(),this._register(e.documentHighlightProvider.register("*",new Qee)),this._register(e.multiDocumentHighlightProvider.register("*",new Qee))}};eH=oet([ret(0,We)],eH);var Uue=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},eh=function(s,e){return function(t,i){e(t,i,s)}},Nn,tH;const Hj=new Ne("hasWordHighlights",!1);function $ue(s,e,t,i){const n=s.ordered(e);return pU(n.map(o=>()=>Promise.resolve(o.provideDocumentHighlights(e,t,i)).then(void 0,as)),o=>o!=null).then(o=>{if(o){const r=new ts;return r.set(e.uri,o),r}return new ts})}function aet(s,e,t,i,n){const o=s.ordered(e);return pU(o.map(r=>()=>{const a=n.filter(l=>zoe(l)).filter(l=>Wj(r.selector,l.uri,l.getLanguageId(),!0,void 0,void 0)>0);return Promise.resolve(r.provideMultiDocumentHighlights(e,t,a,i)).then(void 0,as)}),r=>r!=null)}class que{constructor(e,t,i){this._model=e,this._selection=t,this._wordSeparators=i,this._wordRange=this._getCurrentWordRange(e,t),this._result=null}get result(){return this._result||(this._result=ys(e=>this._compute(this._model,this._selection,this._wordSeparators,e))),this._result}_getCurrentWordRange(e,t){const i=e.getWordAtPosition(t.getPosition());return i?new D(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):null}cancel(){this.result.cancel()}}class cet extends que{constructor(e,t,i,n){super(e,t,i),this._providers=n}_compute(e,t,i,n){return $ue(this._providers,e,t.getPosition(),n).then(o=>o||new ts)}}class det extends que{constructor(e,t,i,n,o){super(e,t,i),this._providers=n,this._otherModels=o}_compute(e,t,i,n){return aet(this._providers,e,t.getPosition(),n,this._otherModels).then(o=>o||new ts)}}function het(s,e,t,i){return new cet(e,t,i,s)}function uet(s,e,t,i,n){return new det(e,t,i,s,n)}qr("_executeDocumentHighlights",async(s,e,t)=>{const i=s.get(We),n=await $ue(i.documentHighlightProvider,e,t,Ft.None);return n==null?void 0:n.get(e.uri)});var cm;let iH=(cm=class{constructor(e,t,i,n,o,r,a,l){this.toUnhook=new oe,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=new ts,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=void 0,this.runDelayer=this.toUnhook.add(new Pl(50)),this.editor=e,this.providers=t,this.multiDocumentProviders=i,this.codeEditorService=r,this.textModelService=o,this.configurationService=a,this.logService=l,this._hasWordHighlights=Hj.bindTo(n),this._ignorePositionChangeEvent=!1,this.occurrencesHighlightEnablement=this.editor.getOption(90),this.occurrencesHighlightDelay=this.configurationService.getValue("editor.occurrencesHighlightDelay"),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition(c=>{this._ignorePositionChangeEvent||this.occurrencesHighlightEnablement!=="off"&&this.runDelayer.trigger(()=>{this._onPositionChanged(c)})})),this.toUnhook.add(e.onDidFocusEditorText(c=>{this.occurrencesHighlightEnablement!=="off"&&(this.workerRequest||this.runDelayer.trigger(()=>{this._run()}))})),this.toUnhook.add(e.onDidChangeModelContent(c=>{mO(this.model.uri,"output")||this._stopAll()})),this.toUnhook.add(e.onDidChangeModel(c=>{!c.newModelUrl&&c.oldModelUrl?this._stopSingular():Nn.query&&this._run()})),this.toUnhook.add(e.onDidChangeConfiguration(c=>{var h,u;const d=this.editor.getOption(90);if(this.occurrencesHighlightEnablement!==d)switch(this.occurrencesHighlightEnablement=d,d){case"off":this._stopAll();break;case"singleFile":this._stopAll((u=(h=Nn.query)==null?void 0:h.modelInfo)==null?void 0:u.modelURI);break;case"multiFile":Nn.query&&this._run(!0);break;default:console.warn("Unknown occurrencesHighlight setting value:",d);break}})),this.toUnhook.add(this.configurationService.onDidChangeConfiguration(c=>{if(c.affectsConfiguration("editor.occurrencesHighlightDelay")){const d=a.getValue("editor.occurrencesHighlightDelay");this.occurrencesHighlightDelay!==d&&(this.occurrencesHighlightDelay=d)}})),this.toUnhook.add(e.onDidBlurEditorWidget(()=>{var d,h;const c=this.codeEditorService.getFocusedCodeEditor();c?((d=c.getModel())==null?void 0:d.uri.scheme)===ct.vscodeNotebookCell&&((h=this.editor.getModel())==null?void 0:h.uri.scheme)!==ct.vscodeNotebookCell&&this._stopAll():this._stopAll()})),this.decorations=this.editor.createDecorationsCollection(),this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=void 0,Nn.query&&this._run()}hasDecorations(){return this.decorations.length>0}restore(e){this.occurrencesHighlightEnablement!=="off"&&(this.runDelayer.cancel(),this.runDelayer.trigger(()=>{this._run(!1,e)}))}stop(){this.occurrencesHighlightEnablement!=="off"&&this._stopAll()}_getSortedHighlights(){return this.decorations.getRanges().sort(D.compareRangesUsingStarts)}moveNext(){const e=this._getSortedHighlights(),i=(e.findIndex(o=>o.containsPosition(this.editor.getPosition()))+1)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const o=this._getWord();if(o){const r=this.editor.getModel().getLineContent(n.startLineNumber);br(`${r}, ${i+1} of ${e.length} for '${o.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){const e=this._getSortedHighlights(),i=(e.findIndex(o=>o.containsPosition(this.editor.getPosition()))-1+e.length)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const o=this._getWord();if(o){const r=this.editor.getModel().getLineContent(n.startLineNumber);br(`${r}, ${i+1} of ${e.length} for '${o.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeSingleDecorations(){if(!this.editor.hasModel())return;const e=Nn.storedDecorationIDs.get(this.editor.getModel().uri);e&&(this.editor.removeDecorations(e),Nn.storedDecorationIDs.delete(this.editor.getModel().uri),this.decorations.length>0&&(this.decorations.clear(),this._hasWordHighlights.set(!1)))}_removeAllDecorations(e){const t=this.codeEditorService.listCodeEditors(),i=[];for(const n of t){if(!n.hasModel()||gm(n.getModel().uri,e))continue;const o=Nn.storedDecorationIDs.get(n.getModel().uri);if(!o)continue;n.removeDecorations(o),i.push(n.getModel().uri);const r=Im.get(n);r!=null&&r.wordHighlighter&&r.wordHighlighter.decorations.length>0&&(r.wordHighlighter.decorations.clear(),r.wordHighlighter.workerRequest=null,r.wordHighlighter._hasWordHighlights.set(!1))}for(const n of i)Nn.storedDecorationIDs.delete(n)}_stopSingular(){var e,t,i,n;this._removeSingleDecorations(),this.editor.hasTextFocus()&&(((e=this.editor.getModel())==null?void 0:e.uri.scheme)!==ct.vscodeNotebookCell&&((i=(t=Nn.query)==null?void 0:t.modelInfo)==null?void 0:i.modelURI.scheme)!==ct.vscodeNotebookCell?(Nn.query=null,this._run()):(n=Nn.query)!=null&&n.modelInfo&&(Nn.query.modelInfo=null)),this.renderDecorationsTimer!==void 0&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=void 0),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_stopAll(e){this._removeAllDecorations(e),this.renderDecorationsTimer!==void 0&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=void 0),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){if(this.occurrencesHighlightEnablement==="off"){this._stopAll();return}if(e.source!=="api"&&e.reason!==3){this._stopAll();return}this._run()}_getWord(){const e=this.editor.getSelection(),t=e.startLineNumber,i=e.startColumn;return this.model.isDisposed()?null:this.model.getWordAtPosition({lineNumber:t,column:i})}getOtherModelsToHighlight(e){if(!e)return[];if(e.uri.scheme===ct.vscodeNotebookCell){const o=[],r=this.codeEditorService.listCodeEditors();for(const a of r){const l=a.getModel();l&&l!==e&&l.uri.scheme===ct.vscodeNotebookCell&&o.push(l)}return o}const i=[],n=this.codeEditorService.listCodeEditors();for(const o of n){if(!Vq(o))continue;const r=o.getModel();r&&e===r.modified&&i.push(r.modified)}if(i.length)return i;if(this.occurrencesHighlightEnablement==="singleFile")return[];for(const o of n){const r=o.getModel();r&&r!==e&&i.push(r)}return i}async _run(e,t){var n,o,r;if(this.editor.hasTextFocus()){const a=this.editor.getSelection();if(!a||a.startLineNumber!==a.endLineNumber){Nn.query=null,this._stopAll();return}const l=a.startColumn,c=a.endColumn,d=this._getWord();if(!d||d.startColumn>l||d.endColumn<c){Nn.query=null,this._stopAll();return}Nn.query={modelInfo:{modelURI:this.model.uri,selection:a}}}else if(!Nn.query){this._stopAll();return}if(this.lastCursorPositionChangeTime=new Date().getTime(),gm(this.editor.getModel().uri,(n=Nn.query.modelInfo)==null?void 0:n.modelURI)){if(!e){const d=this.decorations.getRanges();for(const h of d)if(h.containsPosition(this.editor.getPosition()))return}this._stopAll(e?this.model.uri:void 0);const a=++this.workerRequestTokenId;this.workerRequestCompleted=!1;const l=this.getOtherModelsToHighlight(this.editor.getModel());if(!Nn.query||!Nn.query.modelInfo)return;const c=await this.textModelService.createModelReference(Nn.query.modelInfo.modelURI);try{this.workerRequest=this.computeWithModel(c.object.textEditorModel,Nn.query.modelInfo.selection,l),(o=this.workerRequest)==null||o.result.then(d=>{a===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=d||[],this._beginRenderDecorations(t??this.occurrencesHighlightDelay))},_t)}catch(d){this.logService.error("Unexpected error during occurrence request. Log: ",d)}finally{c.dispose()}}else if(this.model.uri.scheme===ct.vscodeNotebookCell){const a=++this.workerRequestTokenId;if(this.workerRequestCompleted=!1,!Nn.query||!Nn.query.modelInfo)return;const l=await this.textModelService.createModelReference(Nn.query.modelInfo.modelURI);try{this.workerRequest=this.computeWithModel(l.object.textEditorModel,Nn.query.modelInfo.selection,[this.model]),(r=this.workerRequest)==null||r.result.then(c=>{a===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=c||[],this._beginRenderDecorations(t??this.occurrencesHighlightDelay))},_t)}catch(c){this.logService.error("Unexpected error during occurrence request. Log: ",c)}finally{l.dispose()}}}computeWithModel(e,t,i){return i.length?uet(this.multiDocumentProviders,e,t,this.editor.getOption(148),i):het(this.providers,e,t,this.editor.getOption(148))}_beginRenderDecorations(e){const t=new Date().getTime(),i=this.lastCursorPositionChangeTime+e;t>=i?(this.renderDecorationsTimer=void 0,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},i-t)}renderDecorations(){var t,i,n;this.renderDecorationsTimer=void 0;const e=this.codeEditorService.listCodeEditors();for(const o of e){const r=Im.get(o);if(!r)continue;const a=[],l=(t=o.getModel())==null?void 0:t.uri;if(l&&this.workerRequestValue.has(l)){const c=Nn.storedDecorationIDs.get(l),d=this.workerRequestValue.get(l);if(d)for(const u of d)u.range&&a.push({range:u.range,options:wQe(u.kind)});let h=[];o.changeDecorations(u=>{h=u.deltaDecorations(c??[],a)}),Nn.storedDecorationIDs=Nn.storedDecorationIDs.set(l,h),a.length>0&&((i=r.wordHighlighter)==null||i.decorations.set(a),(n=r.wordHighlighter)==null||n._hasWordHighlights.set(!0))}}this.workerRequest=null}dispose(){this._stopSingular(),this.toUnhook.dispose()}},Nn=cm,cm.storedDecorationIDs=new ts,cm.query=null,cm);iH=Nn=Uue([eh(4,nr),eh(5,ii),eh(6,xt),eh(7,Ji)],iH);var hb;let Im=(hb=class extends K{static get(e){return e.getContribution(tH.ID)}constructor(e,t,i,n,o,r,a){super(),this._wordHighlighter=null;const l=()=>{e.hasModel()&&!e.getModel().isTooLargeForTokenization()&&e.getModel().uri.scheme!==ct.accessibleView&&(this._wordHighlighter=new iH(e,i.documentHighlightProvider,i.multiDocumentHighlightProvider,t,o,n,r,a))};this._register(e.onDidChangeModel(c=>{var d,h;this._wordHighlighter&&(!c.newModelUrl&&((d=c.oldModelUrl)==null?void 0:d.scheme)!==ct.vscodeNotebookCell&&((h=this.wordHighlighter)==null||h.stop()),this._wordHighlighter.dispose(),this._wordHighlighter=null),l()})),l()}get wordHighlighter(){return this._wordHighlighter}saveViewState(){return!!(this._wordHighlighter&&this._wordHighlighter.hasDecorations())}moveNext(){var e;(e=this._wordHighlighter)==null||e.moveNext()}moveBack(){var e;(e=this._wordHighlighter)==null||e.moveBack()}restoreViewState(e){this._wordHighlighter&&e&&this._wordHighlighter.restore(250)}dispose(){this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),super.dispose()}},tH=hb,hb.ID="editor.contrib.wordHighlighter",hb);Im=tH=Uue([eh(1,ut),eh(2,We),eh(3,ii),eh(4,nr),eh(5,xt),eh(6,Ji)],Im);class jue extends Fe{constructor(e,t){super(t),this._isNext=e}run(e,t){const i=Im.get(t);i&&(this._isNext?i.moveNext():i.moveBack())}}class fet extends jue{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:ne(1572,"Go to Next Symbol Highlight"),precondition:Hj,kbOpts:{kbExpr:B.editorTextFocus,primary:65,weight:100}})}}class get extends jue{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:ne(1573,"Go to Previous Symbol Highlight"),precondition:Hj,kbOpts:{kbExpr:B.editorTextFocus,primary:1089,weight:100}})}}class met extends Fe{constructor(){super({id:"editor.action.wordHighlight.trigger",label:ne(1574,"Trigger Symbol Highlight"),precondition:void 0,kbOpts:{kbExpr:B.editorTextFocus,primary:0,weight:100}})}run(e,t,i){const n=Im.get(t);n&&n.restoreViewState(!0)}}Qt(Im.ID,Im,0);xe(fet);xe(get);xe(met);C0(eH);class q4 extends Is{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){if(!t.hasModel())return;const n=Bl(t.getOption(148),t.getOption(147)),o=t.getModel(),r=t.getSelections(),a=r.length>1,l=r.map(c=>{const d=new z(c.positionLineNumber,c.positionColumn),h=this._move(n,o,d,this._wordNavigationType,a);return this._moveTo(c,h,this._inSelectionMode)});if(o.pushStackElement(),t._getViewModel().setCursorStates("moveWordCommand",3,l.map(c=>si.fromModelSelection(c))),l.length===1){const c=new z(l[0].positionLineNumber,l[0].positionColumn);t.revealPosition(c,0)}}_moveTo(e,t,i){return i?new Oe(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new Oe(t.lineNumber,t.column,t.lineNumber,t.column)}}class Om extends q4{_move(e,t,i,n,o){return vi.moveWordLeft(e,t,i,n,o)}}class Fm extends q4{_move(e,t,i,n,o){return vi.moveWordRight(e,t,i,n)}}class pet extends Om{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}class _et extends Om{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}class bet extends Om{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:de.and(B.textInputFocus,(e=de.and(a0,S4))==null?void 0:e.negate()),primary:2063,mac:{primary:527},weight:100}})}}class vet extends Om{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}class Cet extends Om{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}class wet extends Om{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:de.and(B.textInputFocus,(e=de.and(a0,S4))==null?void 0:e.negate()),primary:3087,mac:{primary:1551},weight:100}})}}class yet extends Om{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,t,i,n,o){return super._move(Bl(Go.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class xet extends Om{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,t,i,n,o){return super._move(Bl(Go.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class Let extends Fm{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}class Iet extends Fm{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:de.and(B.textInputFocus,(e=de.and(a0,S4))==null?void 0:e.negate()),primary:2065,mac:{primary:529},weight:100}})}}class Eet extends Fm{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}class ket extends Fm{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}class Det extends Fm{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:de.and(B.textInputFocus,(e=de.and(a0,S4))==null?void 0:e.negate()),primary:3089,mac:{primary:1553},weight:100}})}}class Tet extends Fm{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}class Net extends Fm{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,t,i,n,o){return super._move(Bl(Go.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class Ret extends Fm{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,t,i,n,o){return super._move(Bl(Go.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,o)}}class j4 extends Is{constructor(e){super({canTriggerInlineEdits:!0,...e}),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){const n=e==null?void 0:e.get(wn);if(!t.hasModel()||!n)return;const o=Bl(t.getOption(148),t.getOption(147)),r=t.getModel(),a=t.getSelections(),l=t.getOption(10),c=t.getOption(15),d=n.getLanguageConfiguration(r.getLanguageId()).getAutoClosingPairs(),h=t._getViewModel(),u=a.map(f=>{const g=this._delete({wordSeparators:o,model:r,selection:f,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(13),autoClosingBrackets:l,autoClosingQuotes:c,autoClosingPairs:d,autoClosedCharacters:h.getCursorAutoClosedCharacters()},this._wordNavigationType);return new vo(g,"")});t.pushUndoStop(),t.executeCommands(this.id,u),t.pushUndoStop()}}class Vj extends j4{_delete(e,t){const i=vi.deleteWordLeft(e,t);return i||new D(1,1,1,1)}}class zj extends j4{_delete(e,t){const i=vi.deleteWordRight(e,t);if(i)return i;const n=e.model.getLineCount(),o=e.model.getLineMaxColumn(n);return new D(n,o,n,o)}}class Met extends Vj{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:B.writable})}}class Aet extends Vj{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:B.writable})}}class Pet extends Vj{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}class Oet extends zj{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:B.writable})}}class Fet extends zj{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:B.writable})}}class Bet extends zj{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}class Wet extends Fe{constructor(){super({id:"deleteInsideWord",precondition:B.writable,label:ne(1575,"Delete Word")})}run(e,t,i){if(!t.hasModel())return;const n=Bl(t.getOption(148),t.getOption(147)),o=t.getModel(),a=t.getSelections().map(l=>{const c=vi.deleteInsideWord(n,o,l);return new vo(c,"")});t.pushUndoStop(),t.executeCommands(this.id,a),t.pushUndoStop()}}Te(new pet);Te(new _et);Te(new bet);Te(new vet);Te(new Cet);Te(new wet);Te(new Let);Te(new Iet);Te(new Eet);Te(new ket);Te(new Det);Te(new Tet);Te(new yet);Te(new xet);Te(new Net);Te(new Ret);Te(new Met);Te(new Aet);Te(new Pet);Te(new Oet);Te(new Fet);Te(new Bet);xe(Wet);class Het extends j4{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){const i=PO.deleteWordPartLeft(e);return i||new D(1,1,1,1)}}class Vet extends j4{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:B.writable,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){const i=PO.deleteWordPartRight(e);if(i)return i;const n=e.model.getLineCount(),o=e.model.getLineMaxColumn(n);return new D(n,o,n,o)}}class Kue extends q4{_move(e,t,i,n,o){return PO.moveWordPartLeft(e,t,i,o)}}class zet extends Kue{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}Zt.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class Uet extends Kue{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}Zt.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class Gue extends q4{_move(e,t,i,n,o){return PO.moveWordPartRight(e,t,i)}}class $et extends Gue{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}class qet extends Gue{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:B.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}Te(new Het);Te(new Vet);Te(new zet);Te(new Uet);Te(new $et);Te(new qet);const LK=class LK extends K{constructor(e){super(),this.editor=e,this._register(this.editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit()))}_onDidAttemptReadOnlyEdit(){const e=ca.get(this.editor);if(e&&this.editor.hasModel()){let t=this.editor.getOptions().get(105);t||(this.editor.isSimpleWidget?t=new To(_(1378,"Cannot edit in read-only input")):t=new To(_(1379,"Cannot edit in read-only editor"))),e.showMessage(t,this.editor.getPosition())}}};LK.ID="editor.contrib.readOnlyMessageController";let NM=LK;Qt(NM.ID,NM,2);var jet=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Jee=function(s,e){return function(t,i){e(t,i,s)}};let nH=class extends K{constructor(e,t,i){super(),this._textModel=e,this._languageFeaturesService=t,this._outlineModelService=i,this._currentModel=ht(this,void 0);const n=na("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),o=na("_textModel.onDidChangeContent",Se.debounce(r=>this._textModel.onDidChangeContent(r),()=>{},100));this._register(Ao(async(r,a)=>{n.read(r),o.read(r);const l=a.add(new f8e),c=await this._outlineModelService.getOrCreate(this._textModel,l.token);a.isDisposed||this._currentModel.set(c,void 0)}))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const n=i.asListOfDocumentSymbols().filter(o=>e.contains(o.range.startLineNumber)&&!e.contains(o.range.endLineNumber));return n.sort(noe(wo(o=>o.range.endLineNumber-o.range.startLineNumber,aa))),n.map(o=>({name:o.name,kind:o.kind,startLineNumber:o.range.startLineNumber}))}};nH=jet([Jee(1,We),Jee(2,zk)],nH);a2.setBreadcrumbsSourceFactory((s,e)=>e.createInstance(nH,s));var Ket=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},I3=function(s,e){return function(t,i){e(t,i,s)}},iw;let RM=(iw=class extends K{constructor(e,t,i,n){super();const o=this._register(bn(e)),r=this._register(n.createMenu(He.EditorContent,e.contextKeyService)),a=fi(this,r.onDidChange,()=>r.getActions().length===0);this._register(lt(l=>{if(a.read(l))return;const d=ei("div.floating-menu-overlay-widget");d.root.style.height="28px";const h=t.createInstance(cI,d.root,He.EditorContent,{actionViewItemProvider:(u,f)=>{if(!(u instanceof Ya))return;const g=i.lookupKeybinding(u.id);if(g)return t.createInstance(class extends ym{updateLabel(){this.options.label&&this.label&&(this.label.textContent=`${this._commandAction.label} (${g.getLabel()})`)}},u,{...f,keybindingNotRenderedWithLabel:!0})},hiddenItemStrategy:0,menuOptions:{shouldForwardArgs:!0},telemetrySource:"editor.overlayToolbar",toolbarOptions:{primaryGroup:()=>!0,useSeparatorsInPrimaryActions:!0}});l.store.add(h),l.store.add(lt(u=>{const f=o.model.read(u);h.context=f==null?void 0:f.uri})),l.store.add(o.createOverlayWidget({allowEditorOverflow:!1,domNode:d.root,minContentWidthInPx:Gi(0),position:Gi({preference:1})}))}))}},iw.ID="editor.contrib.floatingToolbar",iw);RM=Ket([I3(1,$e),I3(2,ai),I3(3,Vl)],RM);Qt(RM.ID,RM,1);var sH;(function(s){s.inspectTokensAction=_(786,"Developer: Inspect Tokens")})(sH||(sH={}));var MM;(function(s){s.gotoLineActionLabel=_(787,"Go to Line/Column...")})(MM||(MM={}));var oH;(function(s){s.helpQuickAccessActionLabel=_(788,"Show all Quick Access Providers")})(oH||(oH={}));var AM;(function(s){s.quickCommandActionLabel=_(789,"Command Palette"),s.quickCommandHelp=_(790,"Show And Run Commands")})(AM||(AM={}));var $I;(function(s){s.quickOutlineActionLabel=_(791,"Go to Symbol..."),s.quickOutlineByCategoryActionLabel=_(792,"Go to Symbol by Category...")})($I||($I={}));var rH;(function(s){s.editorViewAccessibleLabel=_(793,"Editor content")})(rH||(rH={}));var aH;(function(s){s.toggleHighContrast=_(794,"Toggle High Contrast Theme")})(aH||(aH={}));var lH;(function(s){s.bulkEditServiceSummary=_(795,"Made {0} edits in {1} files")})(lH||(lH={}));const IK=class IK extends K{constructor(e){super(),this.editor=e,this.widget=null,Al&&(this._register(e.onDidChangeConfiguration(()=>this.update())),this.update())}update(){const e=!this.editor.getOption(104);!this.widget&&e?this.widget=new cH(this.editor):this.widget&&!e&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}};IK.ID="editor.contrib.iPadShowKeyboard";let PM=IK;const EP=class EP extends K{constructor(e){super(),this.editor=e,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(ee(this._domNode,"touchstart",t=>{this.editor.focus()})),this._register(ee(this._domNode,"focus",t=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return EP.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}};EP.ID="editor.contrib.ShowKeyboardWidget";let cH=EP;Qt(PM.ID,PM,3);const ol=Mt("themeService");var Get=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ete=function(s,e){return function(t,i){e(t,i,s)}},dH,ub;let qI=(ub=class extends K{static get(e){return e.getContribution(dH.ID)}constructor(e,t,i){super(),this._editor=e,this._languageService=i,this._widget=null,this._register(this._editor.onDidChangeModel(n=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(n=>this.stop())),this._register(An.onDidChange(n=>this.stop())),this._register(this._editor.onKeyUp(n=>n.keyCode===9&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new hH(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}},dH=ub,ub.ID="editor.contrib.inspectTokens",ub);qI=dH=Get([ete(1,ol),ete(2,Wn)],qI);class Yet extends Fe{constructor(){super({id:"editor.action.inspectTokens",label:sH.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(e,t){const i=qI.get(t);i==null||i.launch()}}function Xet(s){let e="";for(let t=0,i=s.length;t<i;t++){const n=s.charCodeAt(t);switch(n){case 9:e+="→";break;case 32:e+="·";break;default:e+=String.fromCharCode(n)}}return e}function Zet(s,e){const t=An.get(e);if(t)return t;const i=s.encodeLanguageId(e);return{getInitialState:()=>Rw,tokenize:(n,o,r)=>W$(e,r),tokenizeEncoded:(n,o,r)=>o4(i,r)}}const kP=class kP extends K{constructor(e,t){super(),this.allowEditorOverflow=!0,this._editor=e,this._languageService=t,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=Zet(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(i=>this._compute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return kP._ID}_compute(e){const t=this._getTokensAtLine(e.lineNumber);let i=0;for(let l=t.tokens1.length-1;l>=0;l--){const c=t.tokens1[l];if(e.column-1>=c.offset){i=l;break}}let n=0;for(let l=t.tokens2.length>>>1;l>=0;l--)if(e.column-1>=t.tokens2[l<<1]){n=l;break}const o=this._model.getLineContent(e.lineNumber);let r="";if(i<t.tokens1.length){const l=t.tokens1[i].offset,c=i+1<t.tokens1.length?t.tokens1[i+1].offset:o.length;r=o.substring(l,c)}Os(this._domNode,we("h2.tm-token",void 0,Xet(r),we("span.tm-token-length",void 0,`${r.length} ${r.length===1?"char":"chars"}`))),me(this._domNode,we("hr.tokens-inspect-separator",{style:"clear:both"}));const a=(n<<1)+1<t.tokens2.length?this._decodeMetadata(t.tokens2[(n<<1)+1]):null;me(this._domNode,we("table.tm-metadata-table",void 0,we("tbody",void 0,we("tr",void 0,we("td.tm-metadata-key",void 0,"language"),we("td.tm-metadata-value",void 0,`${a?a.languageId:"-?-"}`)),we("tr",void 0,we("td.tm-metadata-key",void 0,"token type"),we("td.tm-metadata-value",void 0,`${a?this._tokenTypeToString(a.tokenType):"-?-"}`)),we("tr",void 0,we("td.tm-metadata-key",void 0,"font style"),we("td.tm-metadata-value",void 0,`${a?this._fontStyleToString(a.fontStyle):"-?-"}`)),we("tr",void 0,we("td.tm-metadata-key",void 0,"foreground"),we("td.tm-metadata-value",void 0,`${a?re.Format.CSS.formatHex(a.foreground):"-?-"}`)),we("tr",void 0,we("td.tm-metadata-key",void 0,"background"),we("td.tm-metadata-value",void 0,`${a?re.Format.CSS.formatHex(a.background):"-?-"}`))))),me(this._domNode,we("hr.tokens-inspect-separator")),i<t.tokens1.length&&me(this._domNode,we("span.tm-token-type",void 0,t.tokens1[i].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(e){const t=An.getColorMap(),i=Do.getLanguageId(e),n=Do.getTokenType(e),o=Do.getFontStyle(e),r=Do.getForeground(e),a=Do.getBackground(e);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(i),tokenType:n,fontStyle:o,foreground:t[r],background:t[a]}}_tokenTypeToString(e){switch(e){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(e){let t="";return e&1&&(t+="italic "),e&2&&(t+="bold "),e&4&&(t+="underline "),e&8&&(t+="strikethrough "),t.length===0&&(t="---"),t}_getTokensAtLine(e){const t=this._getStateBeforeLine(e),i=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,t),n=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(e),!0,t);return{startState:t,tokens1:i.tokens,tokens2:n.tokens,endState:i.endState}}_getStateBeforeLine(e){let t=this._tokenizationSupport.getInitialState();for(let i=1;i<e;i++)t=this._tokenizationSupport.tokenize(this._model.getLineContent(i),!0,t).endState;return t}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}};kP._ID="editor.contrib.inspectTokensWidget";let hH=kP;Qt(qI.ID,qI,4);xe(Yet);var uH;(function(s){s[s.PRESERVE=0]="PRESERVE",s[s.LAST=1]="LAST"})(uH||(uH={}));const Mv={Quickaccess:"workbench.contributions.quickaccess"};class Qet{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),Ve(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return bd([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}kn.add(Mv.Quickaccess,new Qet);var Jet=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},tte=function(s,e){return function(t,i){e(t,i,s)}},PS,fb;let fH=(fb=class{constructor(e,t){this.quickInputService=e,this.keybindingService=t,this.registry=kn.as(Mv.Quickaccess)}provide(e){const t=new oe;return t.add(e.onDidAccept(()=>{const[i]=e.selectedItems;i&&this.quickInputService.quickAccess.show(i.prefix,{preserveValue:!0})})),t.add(e.onDidChangeValue(i=>{const n=this.registry.getQuickAccessProvider(i.substr(PS.PREFIX.length));n&&n.prefix&&n.prefix!==PS.PREFIX&&this.quickInputService.quickAccess.show(n.prefix,{preserveValue:!0})})),e.items=this.getQuickAccessProviders().filter(i=>i.prefix!==PS.PREFIX),t}getQuickAccessProviders(){return this.registry.getQuickAccessProviders().sort((t,i)=>t.prefix.localeCompare(i.prefix)).flatMap(t=>this.createPicks(t))}createPicks(e){return e.helpEntries.map(t=>{const i=t.prefix||e.prefix,n=i||"…";return{prefix:i,label:n,keybinding:t.commandId?this.keybindingService.lookupKeybinding(t.commandId):void 0,ariaLabel:_(1747,"{0}, {1}",n,t.description),description:t.description}})}},PS=fb,fb.PREFIX="?",fb);fH=PS=Jet([tte(0,Fo),tte(1,ai)],fH);kn.as(Mv.Quickaccess).registerQuickAccessProvider({ctor:fH,prefix:"",helpEntries:[{description:oH.helpQuickAccessActionLabel}]});class Yue{constructor(e){this.options=e,this.rangeHighlightDecorationId=void 0}provide(e,t,i){var r;const n=new oe;e.canAcceptInBackground=!!((r=this.options)!=null&&r.canAcceptInBackground),e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;const o=n.add(new mi);return o.value=this.doProvide(e,t,i),n.add(this.onDidActiveTextEditorControlChange(()=>{o.value=void 0,o.value=this.doProvide(e,t)})),n}doProvide(e,t,i){const n=new oe,o=this.activeTextEditorControl;if(o&&this.canProvideWithTextEditor(o)){const r={editor:o},a=Fde(o);if(a){let l=o.saveViewState()??void 0;n.add(a.onDidChangeCursorPosition(()=>{l=o.saveViewState()??void 0})),r.restoreViewState=()=>{l&&o===this.activeTextEditorControl&&o.restoreViewState(l)},n.add(Tb(t.onCancellationRequested)(()=>{var c;return(c=r.restoreViewState)==null?void 0:c.call(r)}))}n.add(Ve(()=>this.clearDecorations(o))),n.add(this.provideWithTextEditor(r,e,t,i))}else n.add(this.provideWithoutTextEditor(e,t));return n}canProvideWithTextEditor(e){return!0}gotoLocation({editor:e},t){e.setSelection(t.range,"code.jump"),e.revealRangeInCenter(t.range,0),t.preserveFocus||e.focus();const i=e.getModel();i&&"getLineContent"in i&&ld(`${i.getLineContent(t.range.startLineNumber)}`)}getModel(e){var t;return Vq(e)?(t=e.getModel())==null?void 0:t.modified:e.getModel()}addDecorations(e,t){e.changeDecorations(i=>{const n=[];this.rangeHighlightDecorationId&&(n.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),n.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const o=[{range:t,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:Mn(Jre),position:Xa.Full}}}],[r,a]=i.deltaDecorations(n,o);this.rangeHighlightDecorationId={rangeHighlightId:r,overviewRulerDecorationId:a}})}clearDecorations(e){const t=this.rangeHighlightDecorationId;t&&(e.changeDecorations(i=>{i.deltaDecorations([t.overviewRulerDecorationId,t.rangeHighlightId],[])}),this.rangeHighlightDecorationId=void 0)}}const Bp=class Bp extends Yue{constructor(){super({canAcceptInBackground:!0})}get useZeroBasedOffset(){return this.storageService.getBoolean(Bp.ZERO_BASED_OFFSET_STORAGE_KEY,-1,!1)}set useZeroBasedOffset(e){this.storageService.store(Bp.ZERO_BASED_OFFSET_STORAGE_KEY,e,-1,0)}provideWithoutTextEditor(e){const t=_(1335,"Open a text editor first to go to a line.");return e.items=[{label:t}],e.ariaLabel=t,K.None}provideWithTextEditor(e,t,i){const n=e.editor,o=new oe;o.add(t.onDidAccept(c=>{const[d]=t.selectedItems;if(d){if(!d.lineNumber)return;this.gotoLocation(e,{range:this.toRange(d.lineNumber,d.column),keyMods:t.keyMods,preserveFocus:c.inBackground}),c.inBackground||t.hide()}}));const r=()=>{const c=t.value.trim().substring(Bp.PREFIX.length),{inOffsetMode:d,lineNumber:h,column:u,label:f}=this.parsePosition(n,c);if(a.visible=!!d,t.items=[{lineNumber:h,column:u,label:f}],t.ariaLabel=f,!h){this.clearDecorations(n);return}const g=this.toRange(h,u);n.revealRangeInCenter(g,0),this.addDecorations(n,g)},a=new Mf({title:_(1336,"Use Zero-Based Offset"),icon:ge.indexZero,isChecked:this.useZeroBasedOffset,inputActiveOptionBorder:ve(mk),inputActiveOptionForeground:ve(pk),inputActiveOptionBackground:ve(d0)});o.add(a.onChange(()=>{this.useZeroBasedOffset=!this.useZeroBasedOffset,r()})),t.toggles=[a],r(),o.add(t.onDidChangeValue(()=>r()));const l=Fde(n);return l&&l.getOptions().get(76).renderType===2&&(l.updateOptions({lineNumbers:"on"}),o.add(Ve(()=>l.updateOptions({lineNumbers:"relative"})))),o}toRange(e=1,t=1){return{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}}parsePosition(e,t){var n,o;const i=this.getModel(e);if(!i)return{label:_(1337,"Open a text editor first to go to a line.")};if(t.startsWith(":")){let r=parseInt(t.substring(1),10);const a=i.getValueLength();if(isNaN(r))return{inOffsetMode:!0,label:this.useZeroBasedOffset?_(1338,"Type a character position to go to (from 0 to {0}).",a-1):_(1339,"Type a character position to go to (from 1 to {0}).",a)};{const l=r<0;this.useZeroBasedOffset||(r-=Math.sign(r)),l&&(r+=a);const c=i.getPositionAt(r);return{...c,inOffsetMode:!0,label:_(1340,"Press 'Enter' to go to line {0} at column {1}.",c.lineNumber,c.column)}}}else{const r=t.split(/,|:|#/),a=i.getLineCount();let l=parseInt((n=r[0])==null?void 0:n.trim(),10);if(r.length<1||isNaN(l))return{label:_(1341,"Type a line number to go to (from 1 to {0}).",a)};l=l>=0?l:a+1+l,l=Math.min(Math.max(1,l),a);const c=i.getLineMaxColumn(l);let d=parseInt((o=r[1])==null?void 0:o.trim(),10);return r.length<2||isNaN(d)?{lineNumber:l,column:1,label:r.length<2?_(1342,"Press 'Enter' to go to line {0} or enter : to add a column number.",l):_(1343,"Press 'Enter' to go to line {0} or enter a column number (from 1 to {1}).",l,c)}:(d=d>=0?d:c+d,d=Math.min(Math.max(1,d),c),{lineNumber:l,column:d,label:_(1344,"Press 'Enter' to go to line {0} at column {1}.",l,d)})}}};Bp.PREFIX=":",Bp.ZERO_BASED_OFFSET_STORAGE_KEY="gotoLine.useZeroBasedOffset";let gH=Bp;var ett=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ite=function(s,e){return function(t,i){e(t,i,s)}};let jI=class extends gH{constructor(e,t){super(),this.editorService=e,this.storageService=t,this.onDidActiveTextEditorControlChange=Se.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};jI=ett([ite(0,ii),ite(1,sr)],jI);var gb;let Xue=(gb=class extends Fe{constructor(){super({id:gb.ID,label:MM.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:B.focus,primary:2085,mac:{primary:293},weight:100}})}run(e){e.get(Fo).quickAccess.show(jI.PREFIX)}},gb.ID="editor.action.gotoLine",gb);xe(Xue);kn.as(Mv.Quickaccess).registerQuickAccessProvider({ctor:jI,prefix:jI.PREFIX,helpEntries:[{description:MM.gotoLineActionLabel,commandId:Xue.ID}]});const Zue=[void 0,[]];function E3(s,e,t=0,i=0){const n=e;return n.values&&n.values.length>1?ttt(s,n.values,t,i):Que(s,e,t,i)}function ttt(s,e,t,i){let n=0;const o=[];for(const r of e){const[a,l]=Que(s,r,t,i);if(typeof a!="number")return Zue;n+=a,o.push(...l)}return[n,itt(o)]}function Que(s,e,t,i){const n=Ub(e.original,e.originalLowercase,t,s,s.toLowerCase(),i,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return n?[n[0],Sk(n)]:Zue}function itt(s){const e=s.sort((n,o)=>n.start-o.start),t=[];let i;for(const n of e)!i||!ntt(i,n)?(i=n,t.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return t}function ntt(s,e){return!(s.end<e.start||e.end<s.start)}function nte(s){return s.startsWith('"')&&s.endsWith('"')}const Jue=" ";function mH(s){typeof s!="string"&&(s="");const e=s.toLowerCase(),{pathNormalized:t,normalized:i,normalizedLowercase:n}=ste(s),o=t.indexOf(id)>=0,r=nte(s);let a;const l=s.split(Jue);if(l.length>1)for(const c of l){const d=nte(c),{pathNormalized:h,normalized:u,normalizedLowercase:f}=ste(c);u&&(a||(a=[]),a.push({original:c,originalLowercase:c.toLowerCase(),pathNormalized:h,normalized:u,normalizedLowercase:f,expectContiguousMatch:d}))}return{original:s,originalLowercase:e,pathNormalized:t,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:o,expectContiguousMatch:r}}function ste(s){let e;no?e=s.replace(/\//g,id):e=s.replace(/\\/g,id);const t=e.replace(/[\*\u2026\s"]/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}function ote(s){return Array.isArray(s)?mH(s.map(e=>e.original).join(Jue)):mH(s.original)}var stt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rte=function(s,e){return function(t,i){e(t,i,s)}},_N,Gc;let v_=(Gc=class extends Yue{constructor(e,t,i=Object.create(null)){super(i),this._languageFeaturesService=e,this._outlineModelService=t,this.options=i,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,_(1345,"To go to a symbol, first open a text editor with symbol information.")),K.None}provideWithTextEditor(e,t,i,n){const o=e.editor,r=this.getModel(o);return r?this._languageFeaturesService.documentSymbolProvider.has(r)?this.doProvideWithEditorSymbols(e,r,t,i,n):this.doProvideWithoutEditorSymbols(e,r,t,i):K.None}doProvideWithoutEditorSymbols(e,t,i,n){const o=new oe;return this.provideLabelPick(i,_(1346,"The active text editor does not provide symbol information.")),(async()=>!await this.waitForLanguageSymbolRegistry(t,o)||n.isCancellationRequested||o.add(this.doProvideWithEditorSymbols(e,t,i,n)))(),o}provideLabelPick(e,t){e.items=[{label:t,index:0,kind:14}],e.ariaLabel=t}async waitForLanguageSymbolRegistry(e,t){if(this._languageFeaturesService.documentSymbolProvider.has(e))return!0;const i=new gv,n=t.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>{this._languageFeaturesService.documentSymbolProvider.has(e)&&(n.dispose(),i.complete(!0))}));return t.add(Ve(()=>i.complete(!1))),i.p}doProvideWithEditorSymbols(e,t,i,n,o){var h;const r=e.editor,a=new oe;a.add(i.onDidAccept(u=>{var g;const[f]=i.selectedItems;f&&f.range&&(this.gotoLocation(e,{range:f.range.selection,keyMods:i.keyMods,preserveFocus:u.inBackground}),(g=o==null?void 0:o.handleAccept)==null||g.call(o,f,u.inBackground),u.inBackground||i.hide())})),a.add(i.onDidTriggerItemButton(({item:u})=>{u&&u.range&&(this.gotoLocation(e,{range:u.range.selection,keyMods:i.keyMods,forceSideBySide:!0}),i.hide())}));const l=this.getDocumentSymbols(t,n),c=a.add(new mi),d=async u=>{var f;(f=c==null?void 0:c.value)==null||f.cancel(),i.busy=!1,c.value=new hn,i.busy=!0;try{const g=mH(i.value.substr(_N.PREFIX.length).trim()),m=await this.doGetSymbolPicks(l,g,void 0,c.value.token,t);if(n.isCancellationRequested)return;if(m.length>0){if(i.items=m,u&&g.original.length===0){const p=BL(m,v=>!!(v.type!=="separator"&&v.range&&D.containsPosition(v.range.decoration,u)));p&&(i.activeItems=[p])}}else g.original.length>0?this.provideLabelPick(i,_(1347,"No matching editor symbols")):this.provideLabelPick(i,_(1348,"No editor symbols"))}finally{n.isCancellationRequested||(i.busy=!1)}};return a.add(i.onDidChangeValue(()=>d(void 0))),d((h=r.getSelection())==null?void 0:h.getPosition()),a.add(i.onDidChangeActive(()=>{const[u]=i.activeItems;u&&u.range&&(r.revealRangeInCenter(u.range.selection,0),this.addDecorations(r,u.range.decoration))})),a}async doGetSymbolPicks(e,t,i,n,o){var p,v;const r=await e;if(n.isCancellationRequested)return[];const a=t.original.indexOf(_N.SCOPE_PREFIX)===0,l=a?1:0;let c,d;t.values&&t.values.length>1?(c=ote(t.values[0]),d=ote(t.values.slice(1))):c=t;let h;const u=(v=(p=this.options)==null?void 0:p.openSideBySideDirection)==null?void 0:v.call(p);u&&(h=[{iconClass:u==="right"?it.asClassName(ge.splitHorizontal):it.asClassName(ge.splitVertical),tooltip:u==="right"?_(1349,"Open to the Side"):_(1350,"Open to the Bottom")}]);const f=[];for(let b=0;b<r.length;b++){const w=r[b],C=hDe(w.name),y=`$(${DR.toIcon(w.kind).id}) ${C}`,x=y.length-C.length;let S=w.containerName;i!=null&&i.extraContainerLabel&&(S?S=`${i.extraContainerLabel} • ${S}`:S=i.extraContainerLabel);let L,E,M,R;if(t.original.length>l){let A=!1;if(c!==t&&([L,E]=E3(y,{...t,values:void 0},l,x),typeof L=="number"&&(A=!0)),typeof L!="number"&&([L,E]=E3(y,c,l,x),typeof L!="number"))continue;if(!A&&d){if(S&&d.original.length>0&&([M,R]=E3(S,d)),typeof M!="number")continue;typeof L=="number"&&(L+=M)}}const T=w.tags&&w.tags.indexOf(1)>=0;f.push({index:b,kind:w.kind,score:L,label:y,ariaLabel:D4e(w.name,w.kind),description:S,highlights:T?void 0:{label:E,description:R},range:{selection:D.collapseToStart(w.selectionRange),decoration:w.range},uri:o.uri,symbolName:C,strikethrough:T,buttons:h})}const g=f.sort((b,w)=>a?this.compareByKindAndScore(b,w):this.compareByScore(b,w));let m=[];if(a){let y=function(){w&&typeof b=="number"&&C>0&&(w.label=Rb(D3[b]||k3,C))},b,w,C=0;for(const x of g)b!==x.kind?(y(),b=x.kind,C=1,w={type:"separator"},m.push(w)):C++,m.push(x);y()}else g.length>0&&(m=[{label:_(1351,"symbols ({0})",f.length),type:"separator"},...g]);return m}compareByScore(e,t){if(typeof e.score!="number"&&typeof t.score=="number")return 1;if(typeof e.score=="number"&&typeof t.score!="number")return-1;if(typeof e.score=="number"&&typeof t.score=="number"){if(e.score>t.score)return-1;if(e.score<t.score)return 1}return e.index<t.index?-1:e.index>t.index?1:0}compareByKindAndScore(e,t){const i=D3[e.kind]||k3,n=D3[t.kind]||k3,o=i.localeCompare(n);return o===0?this.compareByScore(e,t):o}async getDocumentSymbols(e,t){const i=await this._outlineModelService.getOrCreate(e,t);return t.isCancellationRequested?[]:i.asListOfDocumentSymbols()}},_N=Gc,Gc.PREFIX="@",Gc.SCOPE_PREFIX=":",Gc.PREFIX_BY_CATEGORY=`${Gc.PREFIX}${Gc.SCOPE_PREFIX}`,Gc);v_=_N=stt([rte(0,We),rte(1,zk)],v_);const k3=_(1352,"properties ({0})"),D3={5:_(1353,"methods ({0})"),11:_(1354,"functions ({0})"),8:_(1355,"constructors ({0})"),12:_(1356,"variables ({0})"),4:_(1357,"classes ({0})"),22:_(1358,"structs ({0})"),23:_(1359,"events ({0})"),24:_(1360,"operators ({0})"),10:_(1361,"interfaces ({0})"),2:_(1362,"namespaces ({0})"),3:_(1363,"packages ({0})"),25:_(1364,"type parameters ({0})"),1:_(1365,"modules ({0})"),6:_(1366,"properties ({0})"),9:_(1367,"enumerations ({0})"),21:_(1368,"enumeration members ({0})"),14:_(1369,"strings ({0})"),0:_(1370,"files ({0})"),17:_(1371,"arrays ({0})"),15:_(1372,"numbers ({0})"),16:_(1373,"booleans ({0})"),18:_(1374,"objects ({0})"),19:_(1375,"keys ({0})"),7:_(1376,"fields ({0})"),13:_(1377,"constants ({0})")};var ott=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},T3=function(s,e){return function(t,i){e(t,i,s)}};let pH=class extends v_{constructor(e,t,i){super(t,i),this.editorService=e,this.onDidActiveTextEditorControlChange=Se.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};pH=ott([T3(0,ii),T3(1,We),T3(2,zk)],pH);const DP=class DP extends Fe{constructor(){super({id:DP.ID,label:$I.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:B.hasDocumentSymbolProvider,kbOpts:{kbExpr:B.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(e){e.get(Fo).quickAccess.show(v_.PREFIX,{itemActivation:Hc.NONE})}};DP.ID="editor.action.quickOutline";let OM=DP;xe(OM);kn.as(Mv.Quickaccess).registerQuickAccessProvider({ctor:pH,prefix:v_.PREFIX,helpEntries:[{description:$I.quickOutlineActionLabel,prefix:v_.PREFIX,commandId:OM.ID},{description:$I.quickOutlineByCategoryActionLabel,prefix:v_.PREFIX_BY_CATEGORY}]});function rtt(s){const e=new Map;for(const t of s)e.set(t,(e.get(t)??0)+1);return e}class kx{constructor(){this.chunkCount=0,this.chunkOccurrences=new Map,this.documents=new Map}calculateScores(e,t){const i=this.computeEmbedding(e),n=new Map,o=[];for(const[r,a]of this.documents){if(t.isCancellationRequested)return[];for(const l of a.chunks){const c=this.computeSimilarityScore(l,i,n);c>0&&o.push({key:r,score:c})}}return o}static termFrequencies(e){return rtt(kx.splitTerms(e))}static*splitTerms(e){const t=i=>i.toLowerCase();for(const[i]of e.matchAll(new RegExp("\\b\\p{Letter}[\\p{Letter}\\d]{2,}\\b","gu"))){yield t(i);const n=i.replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/g);if(n.length>1)for(const o of n)o.length>2&&new RegExp("\\p{Letter}{3,}","gu").test(o)&&(yield t(o))}}updateDocuments(e){for(const{key:t}of e)this.deleteDocument(t);for(const t of e){const i=[];for(const n of t.textChunks){const o=kx.termFrequencies(n);for(const r of o.keys())this.chunkOccurrences.set(r,(this.chunkOccurrences.get(r)??0)+1);i.push({text:n,tf:o})}this.chunkCount+=i.length,this.documents.set(t.key,{chunks:i})}return this}deleteDocument(e){const t=this.documents.get(e);if(t){this.documents.delete(e),this.chunkCount-=t.chunks.length;for(const i of t.chunks)for(const n of i.tf.keys()){const o=this.chunkOccurrences.get(n);if(typeof o=="number"){const r=o-1;r<=0?this.chunkOccurrences.delete(n):this.chunkOccurrences.set(n,r)}}}}computeSimilarityScore(e,t,i){let n=0;for(const[o,r]of Object.entries(t)){const a=e.tf.get(o);if(!a)continue;let l=i.get(o);typeof l!="number"&&(l=this.computeIdf(o),i.set(o,l));const c=a*l;n+=c*r}return n}computeEmbedding(e){const t=kx.termFrequencies(e);return this.computeTfidf(t)}computeIdf(e){const t=this.chunkOccurrences.get(e)??0;return t>0?Math.log((this.chunkCount+1)/t):0}computeTfidf(e){const t=Object.create(null);for(const[i,n]of e){const o=this.computeIdf(i);o>0&&(t[i]=n*o)}return t}}function att(s){var i;const e=s.slice(0);e.sort((n,o)=>o.score-n.score);const t=((i=e[0])==null?void 0:i.score)??0;if(t>0)for(const n of e)n.score/=t;return e}var VC;(function(s){s[s.NO_ACTION=0]="NO_ACTION",s[s.CLOSE_PICKER=1]="CLOSE_PICKER",s[s.REFRESH_PICKER=2]="REFRESH_PICKER",s[s.REMOVE_ITEM=3]="REMOVE_ITEM"})(VC||(VC={}));function N3(s){return Array.isArray(s.items)}function ate(s){const e=s;return!!e.picks&&e.additionalPicks instanceof Promise}class ltt extends K{constructor(e,t){super(),this.prefix=e,this.options=t}provide(e,t,i){var c;const n=new oe;e.canAcceptInBackground=!!((c=this.options)!=null&&c.canAcceptInBackground),e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let o;const r=n.add(new mi),a=async()=>{var p;o==null||o.dispose(!0),e.busy=!1;const d=r.value=new oe;o=d.add(new hn(t));const h=o.token;let u=e.value.substring(this.prefix.length);(p=this.options)!=null&&p.shouldSkipTrimPickFilter||(u=u.trim());const f=this._getPicks(u,d,h,i),g=(v,b)=>{var y;let w,C;if(N3(v)?(w=v.items,C=v.active):w=v,w.length===0){if(b)return!1;(u.length>0||e.hideInput)&&((y=this.options)!=null&&y.noResultsPick)&&(kb(this.options.noResultsPick)?w=[this.options.noResultsPick(u)]:w=[this.options.noResultsPick])}return e.items=w,C&&(e.activeItems=[C]),!0},m=async v=>{let b=!1,w=!1;await Promise.all([(async()=>{typeof v.mergeDelay=="number"&&(await Sh(v.mergeDelay),h.isCancellationRequested)||w||(b=g(v.picks,!0))})(),(async()=>{e.busy=!0;try{const C=await v.additionalPicks;if(h.isCancellationRequested)return;let y,x;N3(v.picks)?(y=v.picks.items,x=v.picks.active):y=v.picks;let S,L;if(N3(C)?(S=C.items,L=C.active):S=C,S.length>0||!b){let E;if(!x&&!L){const M=e.activeItems[0];M&&y.indexOf(M)!==-1&&(E=M)}g({items:[...y,...S],active:x||L||E})}}finally{h.isCancellationRequested||(e.busy=!1),w=!0}})()])};if(f!==null)if(ate(f))await m(f);else if(!(f instanceof Promise))g(f);else{e.busy=!0;try{const v=await f;if(h.isCancellationRequested)return;ate(v)?await m(v):g(v)}finally{h.isCancellationRequested||(e.busy=!1)}}};n.add(e.onDidChangeValue(()=>a())),a(),n.add(e.onDidAccept(d=>{var u;if(i!=null&&i.handleAccept){d.inBackground||e.hide(),(u=i.handleAccept)==null||u.call(i,e.activeItems[0],d.inBackground);return}const[h]=e.selectedItems;typeof(h==null?void 0:h.accept)=="function"&&(d.inBackground||e.hide(),h.accept(e.keyMods,d))}));const l=async(d,h)=>{var f;if(typeof h.trigger!="function")return;const u=((f=h.buttons)==null?void 0:f.indexOf(d))??-1;if(u>=0){const g=h.trigger(u,e.keyMods),m=typeof g=="number"?g:await g;if(t.isCancellationRequested)return;switch(m){case VC.NO_ACTION:break;case VC.CLOSE_PICKER:e.hide();break;case VC.REFRESH_PICKER:a();break;case VC.REMOVE_ITEM:{const p=e.items.indexOf(h);if(p!==-1){const v=e.items.slice(),b=v.splice(p,1),w=e.activeItems.filter(y=>y!==b[0]),C=e.keepScrollPosition;e.keepScrollPosition=!0,e.items=v,w&&(e.activeItems=w),e.keepScrollPosition=C}break}}}};return n.add(e.onDidTriggerItemButton(({button:d,item:h})=>l(d,h))),n.add(e.onDidTriggerSeparatorButton(({button:d,separator:h})=>l(d,h))),n}}new Cc(1e4);const ctt=new Cc(1e4);function dtt(s){return utt(s,"NFD",ctt)}const htt=/[^\u0000-\u0080]/;function utt(s,e,t){if(!s)return s;const i=t.get(s);if(i)return i;let n;return htt.test(s)?n=s.normalize(e):n=s,t.set(s,n),n}const ftt=(function(){const s=/[\u0300-\u036f]/g;return function(e){return dtt(e).replace(s,"")}})();var efe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ug=function(s,e){return function(t,i){e(t,i,s)}},dp,ms,lh;let _H=(lh=class extends ltt{constructor(e,t,i,n,o,r){super(dp.PREFIX,e),this.keybindingService=i,this.commandService=n,this.telemetryService=o,this.dialogService=r,this.commandsHistory=this._register(t.createInstance(bH)),this.options=e}async _getPicks(e,t,i,n){var g,m;const o=await this.getCommandPicks(i);if(i.isCancellationRequested)return[];const r=Tb(()=>{const p=new kx;p.updateDocuments(o.map(b=>({key:b.commandId,textChunks:[this.getTfIdfChunk(b)]})));const v=p.calculateScores(e,i);return att(v).filter(b=>b.score>dp.TFIDF_THRESHOLD).slice(0,dp.TFIDF_MAX_RESULTS)}),a=this.normalizeForFiltering(e),l=[];for(const p of o){p.labelNoAccents??(p.labelNoAccents=this.normalizeForFiltering(p.label));const v=dp.WORD_FILTER(a,p.labelNoAccents)??void 0;let b;if(p.commandAlias&&(p.aliasNoAccents??(p.aliasNoAccents=this.normalizeForFiltering(p.commandAlias)),b=dp.WORD_FILTER(a,p.aliasNoAccents)??void 0),v||b)p.highlights={label:v,detail:this.options.showAlias?b:void 0},l.push(p);else if(e===p.commandId)l.push(p);else if(e.length>=3){const w=r();if(i.isCancellationRequested)return[];const C=w.find(y=>y.key===p.commandId);C&&(p.tfIdfScore=C.score,l.push(p))}}const c=new Map;for(const p of l){const v=c.get(p.label);v?(p.description=p.commandId,v.description=v.commandId):c.set(p.label,p)}l.sort((p,v)=>{if(p.tfIdfScore&&v.tfIdfScore)return p.tfIdfScore===v.tfIdfScore?p.label.localeCompare(v.label):v.tfIdfScore-p.tfIdfScore;if(p.tfIdfScore)return 1;if(v.tfIdfScore)return-1;const b=this.commandsHistory.peek(p.commandId),w=this.commandsHistory.peek(v.commandId);if(b&&w)return b>w?-1:1;if(b)return-1;if(w)return 1;if(this.options.suggestedCommandIds){const x=this.options.suggestedCommandIds.has(p.commandId),S=this.options.suggestedCommandIds.has(v.commandId);if(x&&S)return 0;if(x)return-1;if(S)return 1}const C=p.commandCategory===U6.Developer.value,y=v.commandCategory===U6.Developer.value;return C&&!y?1:!C&&y?-1:p.label.localeCompare(v.label)});const d=[];let h=!1,u=!0,f=!!this.options.suggestedCommandIds;for(let p=0;p<l.length;p++){const v=l[p];p===0&&this.commandsHistory.peek(v.commandId)&&(d.push({type:"separator",label:_(1740,"recently used")}),h=!0),u&&v.tfIdfScore!==void 0&&(d.push({type:"separator",label:_(1741,"similar commands")}),u=!1),f&&v.tfIdfScore===void 0&&!this.commandsHistory.peek(v.commandId)&&((g=this.options.suggestedCommandIds)!=null&&g.has(v.commandId))&&(d.push({type:"separator",label:_(1742,"commonly used")}),h=!0,f=!1),h&&v.tfIdfScore===void 0&&!this.commandsHistory.peek(v.commandId)&&!((m=this.options.suggestedCommandIds)!=null&&m.has(v.commandId))&&(d.push({type:"separator",label:_(1743,"other commands")}),h=!1),d.push(this.toCommandPick(v,n))}return this.hasAdditionalCommandPicks(e,i)?{picks:d,additionalPicks:(async()=>{var b;const p=await this.getAdditionalCommandPicks(o,l,e,i);if(i.isCancellationRequested)return[];const v=p.map(w=>this.toCommandPick(w,n));return u&&((b=v[0])==null?void 0:b.type)!=="separator"&&v.unshift({type:"separator",label:_(1744,"similar commands")}),v})()}:d}toCommandPick(e,t){if(e.type==="separator")return e;const i=this.keybindingService.lookupKeybinding(e.commandId),n=i?_(1745,"{0}, {1}",e.label,i.getAriaLabel()):e.label;return{...e,ariaLabel:n,detail:this.options.showAlias&&e.commandAlias!==e.label?e.commandAlias:void 0,keybinding:i,accept:async()=>{var o;this.commandsHistory.push(e.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.commandId,from:(t==null?void 0:t.from)??"quick open"});try{(o=e.args)!=null&&o.length?await this.commandService.executeCommand(e.commandId,...e.args):await this.commandService.executeCommand(e.commandId)}catch(r){il(r)||this.dialogService.error(_(1746,"Command '{0}' resulted in an error",e.label),m2(r))}}}}getTfIdfChunk({label:e,commandAlias:t,commandDescription:i}){let n=e;return t&&t!==e&&(n+=` - ${t}`),i&&i.value!==e&&(n+=` - ${i.value===i.original?i.value:`${i.value} (${i.original})`}`),n}normalizeForFiltering(e){const t=ftt(e);return t.length!==e.length?(this.telemetryService.publicLog2("QuickAccess:FilterLengthMismatch",{originalLength:e.length,normalizedLength:t.length}),e):t}},dp=lh,lh.PREFIX=">",lh.TFIDF_THRESHOLD=.5,lh.TFIDF_MAX_RESULTS=5,lh.WORD_FILTER=K$(eI,TBe,rle),lh);_H=dp=efe([ug(1,$e),ug(2,ai),ug(3,en),ug(4,Wo),ug(5,$k)],_H);var Yc;let bH=(Yc=class extends K{constructor(e,t,i){super(),this.storageService=e,this.configurationService=t,this.logService=i,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.updateConfiguration(e))),this._register(this.storageService.onWillSaveState(e=>{e.reason===Vg.SHUTDOWN&&this.saveState()}))}updateConfiguration(e){e&&!e.affectsConfiguration("workbench.commandPalette.history")||(this.configuredCommandsHistoryLength=ms.getConfiguredCommandHistoryLength(this.configurationService),ms.cache&&ms.cache.limit!==this.configuredCommandsHistoryLength&&(ms.cache.limit=this.configuredCommandsHistoryLength,ms.hasChanges=!0))}load(){const e=this.storageService.get(ms.PREF_KEY_CACHE,0);let t;if(e)try{t=JSON.parse(e)}catch(n){this.logService.error(`[CommandsHistory] invalid data: ${n}`)}const i=ms.cache=new Cc(this.configuredCommandsHistoryLength,1);if(t){let n;t.usesLRU?n=t.entries:n=t.entries.sort((o,r)=>o.value-r.value),n.forEach(o=>i.set(o.key,o.value))}ms.counter=this.storageService.getNumber(ms.PREF_KEY_COUNTER,0,ms.counter)}push(e){ms.cache&&(ms.cache.set(e,ms.counter++),ms.hasChanges=!0)}peek(e){var t;return(t=ms.cache)==null?void 0:t.peek(e)}saveState(){if(!ms.cache||!ms.hasChanges)return;const e={usesLRU:!0,entries:[]};ms.cache.forEach((t,i)=>e.entries.push({key:i,value:t})),this.storageService.store(ms.PREF_KEY_CACHE,JSON.stringify(e),0,0),this.storageService.store(ms.PREF_KEY_COUNTER,ms.counter,0,0),ms.hasChanges=!1}static getConfiguredCommandHistoryLength(e){var n,o;const i=(o=(n=e.getValue().workbench)==null?void 0:n.commandPalette)==null?void 0:o.history;return typeof i=="number"?i:ms.DEFAULT_COMMANDS_HISTORY_LENGTH}},ms=Yc,Yc.DEFAULT_COMMANDS_HISTORY_LENGTH=50,Yc.PREF_KEY_CACHE="commandPalette.mru.cache",Yc.PREF_KEY_COUNTER="commandPalette.mru.counter",Yc.counter=1,Yc.hasChanges=!1,Yc);bH=ms=efe([ug(0,sr),ug(1,xt),ug(2,Ji)],bH);class gtt extends _H{constructor(e,t,i,n,o,r){super(e,t,i,n,o,r)}getCodeEditorCommandPicks(){var i;const e=this.activeTextEditorControl;if(!e)return[];const t=[];for(const n of e.getSupportedActions()){let o;(i=n.metadata)!=null&&i.description&&(_6e(n.metadata.description)?o=n.metadata.description:o={original:n.metadata.description,value:n.metadata.description}),t.push({commandId:n.id,commandAlias:n.alias,commandDescription:o,label:J$(n.label)||n.id})}return t}}var mtt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},lC=function(s,e){return function(t,i){e(t,i,s)}};let KI=class extends gtt{get activeTextEditorControl(){return this.codeEditorService.getFocusedCodeEditor()??void 0}constructor(e,t,i,n,o,r){super({showAlias:!1},e,i,n,o,r),this.codeEditorService=t}async getCommandPicks(){return this.getCodeEditorCommandPicks()}hasAdditionalCommandPicks(){return!1}async getAdditionalCommandPicks(){return[]}};KI=mtt([lC(0,$e),lC(1,ii),lC(2,ai),lC(3,en),lC(4,Wo),lC(5,$k)],KI);const TP=class TP extends Fe{constructor(){super({id:TP.ID,label:AM.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:B.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(e){e.get(Fo).quickAccess.show(KI.PREFIX)}};TP.ID="editor.action.quickCommand";let FM=TP;xe(FM);kn.as(Mv.Quickaccess).registerQuickAccessProvider({ctor:KI,prefix:KI.PREFIX,helpEntries:[{description:AM.quickCommandHelp,commandId:FM.ID}]});var ptt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},cC=function(s,e){return function(t,i){e(t,i,s)}};let vH=class extends sv{constructor(e,t,i,n,o,r,a){super(!0,e,t,i,n,o,r,a)}};vH=ptt([cC(1,ut),cC(2,ii),cC(3,Hn),cC(4,$e),cC(5,sr),cC(6,xt)],vH);Qt(sv.ID,vH,4);class _tt{constructor(e,t,i,n,o){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=o}}function btt(s){if(!s||!Array.isArray(s))return[];const e=[];let t=0;for(let i=0,n=s.length;i<n;i++){const o=s[i];let r=-1;if(typeof o.fontStyle=="string"){r=0;const c=o.fontStyle.split(" ");for(let d=0,h=c.length;d<h;d++)switch(c[d]){case"italic":r=r|1;break;case"bold":r=r|2;break;case"underline":r=r|4;break;case"strikethrough":r=r|8;break}}let a=null;typeof o.foreground=="string"&&(a=o.foreground);let l=null;typeof o.background=="string"&&(l=o.background),e[t++]=new _tt(o.token||"",i,r,a,l)}return e}function vtt(s,e){s.sort((d,h)=>{const u=xtt(d.token,h.token);return u!==0?u:d.index-h.index});let t=0,i="000000",n="ffffff";for(;s.length>=1&&s[0].token==="";){const d=s.shift();d.fontStyle!==-1&&(t=d.fontStyle),d.foreground!==null&&(i=d.foreground),d.background!==null&&(n=d.background)}const o=new wtt;for(const d of e)o.getId(d);const r=o.getId(i),a=o.getId(n),l=new Uj(t,r,a),c=new $j(l);for(let d=0,h=s.length;d<h;d++){const u=s[d];c.insert(u.token,u.fontStyle,o.getId(u.foreground),o.getId(u.background))}return new tfe(o,c)}const Ctt=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class wtt{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(Ctt);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=re.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class tfe{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(btt(e),t)}static createFromParsedTokenTheme(e,t){return vtt(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),o=Stt(t);i=(n.metadata|o<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const ytt=/\b(comment|string|regex|regexp)\b/;function Stt(s){const e=s.match(ytt);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function xtt(s,e){return s<e?-1:s>e?1:0}class Uj{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new Uj(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class $j{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const o=this._children.get(i);return typeof o<"u"?o.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const o=e.indexOf(".");let r,a;o===-1?(r=e,a=""):(r=e.substring(0,o),a=e.substring(o+1));let l=this._children.get(r);typeof l>"u"&&(l=new $j(this._mainRule.clone()),this._children.set(r,l)),l.insert(a,t,i,n)}}function Ltt(s){const e=[];for(let t=1,i=s.length;t<i;t++){const n=s[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const Itt={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[es]:"#FFFFFE",[Ph]:"#000000",[Cre]:"#E5EBF1",[Ck]:"#D3D3D3",[wk]:"#939393",[o$]:"#ADD6FF4D"}},Ett={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[es]:"#1E1E1E",[Ph]:"#D4D4D4",[Cre]:"#3A3D41",[Ck]:"#404040",[wk]:"#707070",[o$]:"#ADD6FF26"}},ktt={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[es]:"#000000",[Ph]:"#FFFFFF",[Ck]:"#FFFFFF",[wk]:"#FFFFFF"}},Dtt={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[es]:"#FFFFFF",[Ph]:"#292929",[Ck]:"#292929",[wk]:"#292929"}};function Ttt(s){const e=new oe,t=e.add(new q),i=Zle();return e.add(i.onDidChange(()=>t.fire())),s&&e.add(s.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const n=s?s.getProductIconTheme():new ife,o={},r=new pF,a=new pF;for(const l of i.getIcons()){const c=n.getIcon(l);if(!c)continue;const d=c.font,h=Yr`--vscode-icon-${ED(l.id)}-font-family`,u=Yr`--vscode-icon-${ED(l.id)}-content`;d?(o[d.id]=d.definition,a.push(Yr`${h}: ${Hf(d.id)};`,Yr`${u}: ${Hf(c.fontCharacter)};`),r.push(Yr`.codicon-${ED(l.id)}:before { content: ${Hf(c.fontCharacter)}; font-family: ${Hf(d.id)}; }`)):(a.push(Yr`${u}: ${Hf(c.fontCharacter)}; ${h}: 'codicon';`),r.push(Yr`.codicon-${ED(l.id)}:before { content: ${Hf(c.fontCharacter)}; }`))}for(const l in o){const c=o[l],d=c.weight?Yr`font-weight: ${pZ(c.weight)};`:Yr``,h=c.style?Yr`font-style: ${pZ(c.style)};`:Yr``,u=new pF;for(const f of c.src)u.push(Yr`${Eh(f.location)} format(${Hf(f.format)})`);r.push(Yr`@font-face { src: ${u.join(", ")}; font-family: ${Hf(l)};${d}${h} font-display: block; }`)}return r.push(Yr`:root { ${a.join(" ")} }`),r.join(`
`)}}}class ife{getIcon(e){const t=Zle();let i=e.defaults;for(;it.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const Eu="vs",O1="vs-dark",C_="hc-black",w_="hc-light",nfe=kn.as(fre.ColorContribution),Ntt=kn.as(Gre.ThemingContribution);class sfe{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(bN(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,re.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=CH(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,re.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=nfe.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case Eu:return Il.LIGHT;case C_:return Il.HIGH_CONTRAST_DARK;case w_:return Il.HIGH_CONTRAST_LIGHT;default:return Il.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const o=CH(this.themeData.base);e=o.rules,o.encodedTokensColors&&(t=o.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const o={token:""};i&&(o.foreground=i),n&&(o.background=n),e.push(o)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=tfe.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const o=this.tokenTheme._match([e].concat(t).join(".")).metadata,r=Do.getForeground(o),a=Do.getFontStyle(o);return{foreground:r,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}get tokenColorMap(){return[]}}function bN(s){return s===Eu||s===O1||s===C_||s===w_}function CH(s){switch(s){case Eu:return Itt;case O1:return Ett;case C_:return ktt;case w_:return Dtt}}function gT(s){const e=CH(s);return new sfe(s,e)}class Rtt extends K{constructor(){super(),this._onColorThemeChange=this._register(new q),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new q),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new ife,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Eu,gT(Eu)),this._knownThemes.set(O1,gT(O1)),this._knownThemes.set(C_,gT(C_)),this._knownThemes.set(w_,gT(w_));const e=this._register(Ttt(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Eu),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),wse(Ti,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return QN(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Hl(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),K.None}_registerShadowDomContainer(e){const t=Hl(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!bN(t.base)&&!bN(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new sfe(e,t)),bN(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Eu),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=Ti.matchMedia("(forced-colors: active)").matches;if(e!==od(this._theme.type)){let t;_f(this._theme.type)?t=e?C_:O1:t=e?w_:Eu,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:r=>{t[r]||(e.push(r),t[r]=!0)}};Ntt.getThemingParticipants().forEach(r=>r(this._theme,i,this._environment));const n=[];for(const r of nfe.getColors()){const a=this._theme.getColor(r.id,!0);a&&n.push(`${n$(r.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${n.join(`
`)} }`);const o=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(Ltt(o)),i.addRule(".monaco-editor, .monaco-diff-editor, .monaco-component { forced-color-adjust: none; }"),this._themeCSS=e.join(`
`),this._updateCSS(),An.setColorMap(o),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}class Mtt extends Fe{constructor(){super({id:"editor.action.toggleHighContrast",label:aH.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(e,t){const i=e.get(ol),n=i.getColorTheme();od(n.type)?(i.setTheme(this._originalThemeName||(_f(n.type)?O1:Eu)),this._originalThemeName=null):(i.setTheme(_f(n.type)?C_:w_),this._originalThemeName=n.themeName)}}xe(Mtt);var wH;(function(s){s[s.Unknown=0]="Unknown",s[s.Disabled=1]="Disabled",s[s.Enabled=2]="Enabled"})(wH||(wH={}));var yH;(function(s){s[s.Invoke=1]="Invoke",s[s.Auto=2]="Auto"})(yH||(yH={}));var SH;(function(s){s[s.None=0]="None",s[s.KeepWhitespace=1]="KeepWhitespace",s[s.InsertAsSnippet=4]="InsertAsSnippet"})(SH||(SH={}));var xH;(function(s){s[s.Method=0]="Method",s[s.Function=1]="Function",s[s.Constructor=2]="Constructor",s[s.Field=3]="Field",s[s.Variable=4]="Variable",s[s.Class=5]="Class",s[s.Struct=6]="Struct",s[s.Interface=7]="Interface",s[s.Module=8]="Module",s[s.Property=9]="Property",s[s.Event=10]="Event",s[s.Operator=11]="Operator",s[s.Unit=12]="Unit",s[s.Value=13]="Value",s[s.Constant=14]="Constant",s[s.Enum=15]="Enum",s[s.EnumMember=16]="EnumMember",s[s.Keyword=17]="Keyword",s[s.Text=18]="Text",s[s.Color=19]="Color",s[s.File=20]="File",s[s.Reference=21]="Reference",s[s.Customcolor=22]="Customcolor",s[s.Folder=23]="Folder",s[s.TypeParameter=24]="TypeParameter",s[s.User=25]="User",s[s.Issue=26]="Issue",s[s.Tool=27]="Tool",s[s.Snippet=28]="Snippet"})(xH||(xH={}));var LH;(function(s){s[s.Deprecated=1]="Deprecated"})(LH||(LH={}));var IH;(function(s){s[s.Invoke=0]="Invoke",s[s.TriggerCharacter=1]="TriggerCharacter",s[s.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(IH||(IH={}));var EH;(function(s){s[s.EXACT=0]="EXACT",s[s.ABOVE=1]="ABOVE",s[s.BELOW=2]="BELOW"})(EH||(EH={}));var kH;(function(s){s[s.NotSet=0]="NotSet",s[s.ContentFlush=1]="ContentFlush",s[s.RecoverFromMarkers=2]="RecoverFromMarkers",s[s.Explicit=3]="Explicit",s[s.Paste=4]="Paste",s[s.Undo=5]="Undo",s[s.Redo=6]="Redo"})(kH||(kH={}));var DH;(function(s){s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(DH||(DH={}));var TH;(function(s){s[s.Text=0]="Text",s[s.Read=1]="Read",s[s.Write=2]="Write"})(TH||(TH={}));var NH;(function(s){s[s.None=0]="None",s[s.Keep=1]="Keep",s[s.Brackets=2]="Brackets",s[s.Advanced=3]="Advanced",s[s.Full=4]="Full"})(NH||(NH={}));var RH;(function(s){s[s.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",s[s.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",s[s.accessibilitySupport=2]="accessibilitySupport",s[s.accessibilityPageSize=3]="accessibilityPageSize",s[s.allowOverflow=4]="allowOverflow",s[s.allowVariableLineHeights=5]="allowVariableLineHeights",s[s.allowVariableFonts=6]="allowVariableFonts",s[s.allowVariableFontsInAccessibilityMode=7]="allowVariableFontsInAccessibilityMode",s[s.ariaLabel=8]="ariaLabel",s[s.ariaRequired=9]="ariaRequired",s[s.autoClosingBrackets=10]="autoClosingBrackets",s[s.autoClosingComments=11]="autoClosingComments",s[s.screenReaderAnnounceInlineSuggestion=12]="screenReaderAnnounceInlineSuggestion",s[s.autoClosingDelete=13]="autoClosingDelete",s[s.autoClosingOvertype=14]="autoClosingOvertype",s[s.autoClosingQuotes=15]="autoClosingQuotes",s[s.autoIndent=16]="autoIndent",s[s.autoIndentOnPaste=17]="autoIndentOnPaste",s[s.autoIndentOnPasteWithinString=18]="autoIndentOnPasteWithinString",s[s.automaticLayout=19]="automaticLayout",s[s.autoSurround=20]="autoSurround",s[s.bracketPairColorization=21]="bracketPairColorization",s[s.guides=22]="guides",s[s.codeLens=23]="codeLens",s[s.codeLensFontFamily=24]="codeLensFontFamily",s[s.codeLensFontSize=25]="codeLensFontSize",s[s.colorDecorators=26]="colorDecorators",s[s.colorDecoratorsLimit=27]="colorDecoratorsLimit",s[s.columnSelection=28]="columnSelection",s[s.comments=29]="comments",s[s.contextmenu=30]="contextmenu",s[s.copyWithSyntaxHighlighting=31]="copyWithSyntaxHighlighting",s[s.cursorBlinking=32]="cursorBlinking",s[s.cursorSmoothCaretAnimation=33]="cursorSmoothCaretAnimation",s[s.cursorStyle=34]="cursorStyle",s[s.cursorSurroundingLines=35]="cursorSurroundingLines",s[s.cursorSurroundingLinesStyle=36]="cursorSurroundingLinesStyle",s[s.cursorWidth=37]="cursorWidth",s[s.cursorHeight=38]="cursorHeight",s[s.disableLayerHinting=39]="disableLayerHinting",s[s.disableMonospaceOptimizations=40]="disableMonospaceOptimizations",s[s.domReadOnly=41]="domReadOnly",s[s.dragAndDrop=42]="dragAndDrop",s[s.dropIntoEditor=43]="dropIntoEditor",s[s.editContext=44]="editContext",s[s.emptySelectionClipboard=45]="emptySelectionClipboard",s[s.experimentalGpuAcceleration=46]="experimentalGpuAcceleration",s[s.experimentalWhitespaceRendering=47]="experimentalWhitespaceRendering",s[s.extraEditorClassName=48]="extraEditorClassName",s[s.fastScrollSensitivity=49]="fastScrollSensitivity",s[s.find=50]="find",s[s.fixedOverflowWidgets=51]="fixedOverflowWidgets",s[s.folding=52]="folding",s[s.foldingStrategy=53]="foldingStrategy",s[s.foldingHighlight=54]="foldingHighlight",s[s.foldingImportsByDefault=55]="foldingImportsByDefault",s[s.foldingMaximumRegions=56]="foldingMaximumRegions",s[s.unfoldOnClickAfterEndOfLine=57]="unfoldOnClickAfterEndOfLine",s[s.fontFamily=58]="fontFamily",s[s.fontInfo=59]="fontInfo",s[s.fontLigatures=60]="fontLigatures",s[s.fontSize=61]="fontSize",s[s.fontWeight=62]="fontWeight",s[s.fontVariations=63]="fontVariations",s[s.formatOnPaste=64]="formatOnPaste",s[s.formatOnType=65]="formatOnType",s[s.glyphMargin=66]="glyphMargin",s[s.gotoLocation=67]="gotoLocation",s[s.hideCursorInOverviewRuler=68]="hideCursorInOverviewRuler",s[s.hover=69]="hover",s[s.inDiffEditor=70]="inDiffEditor",s[s.inlineSuggest=71]="inlineSuggest",s[s.letterSpacing=72]="letterSpacing",s[s.lightbulb=73]="lightbulb",s[s.lineDecorationsWidth=74]="lineDecorationsWidth",s[s.lineHeight=75]="lineHeight",s[s.lineNumbers=76]="lineNumbers",s[s.lineNumbersMinChars=77]="lineNumbersMinChars",s[s.linkedEditing=78]="linkedEditing",s[s.links=79]="links",s[s.matchBrackets=80]="matchBrackets",s[s.minimap=81]="minimap",s[s.mouseStyle=82]="mouseStyle",s[s.mouseWheelScrollSensitivity=83]="mouseWheelScrollSensitivity",s[s.mouseWheelZoom=84]="mouseWheelZoom",s[s.multiCursorMergeOverlapping=85]="multiCursorMergeOverlapping",s[s.multiCursorModifier=86]="multiCursorModifier",s[s.mouseMiddleClickAction=87]="mouseMiddleClickAction",s[s.multiCursorPaste=88]="multiCursorPaste",s[s.multiCursorLimit=89]="multiCursorLimit",s[s.occurrencesHighlight=90]="occurrencesHighlight",s[s.occurrencesHighlightDelay=91]="occurrencesHighlightDelay",s[s.overtypeCursorStyle=92]="overtypeCursorStyle",s[s.overtypeOnPaste=93]="overtypeOnPaste",s[s.overviewRulerBorder=94]="overviewRulerBorder",s[s.overviewRulerLanes=95]="overviewRulerLanes",s[s.padding=96]="padding",s[s.pasteAs=97]="pasteAs",s[s.parameterHints=98]="parameterHints",s[s.peekWidgetDefaultFocus=99]="peekWidgetDefaultFocus",s[s.placeholder=100]="placeholder",s[s.definitionLinkOpensInPeek=101]="definitionLinkOpensInPeek",s[s.quickSuggestions=102]="quickSuggestions",s[s.quickSuggestionsDelay=103]="quickSuggestionsDelay",s[s.readOnly=104]="readOnly",s[s.readOnlyMessage=105]="readOnlyMessage",s[s.renameOnType=106]="renameOnType",s[s.renderRichScreenReaderContent=107]="renderRichScreenReaderContent",s[s.renderControlCharacters=108]="renderControlCharacters",s[s.renderFinalNewline=109]="renderFinalNewline",s[s.renderLineHighlight=110]="renderLineHighlight",s[s.renderLineHighlightOnlyWhenFocus=111]="renderLineHighlightOnlyWhenFocus",s[s.renderValidationDecorations=112]="renderValidationDecorations",s[s.renderWhitespace=113]="renderWhitespace",s[s.revealHorizontalRightPadding=114]="revealHorizontalRightPadding",s[s.roundedSelection=115]="roundedSelection",s[s.rulers=116]="rulers",s[s.scrollbar=117]="scrollbar",s[s.scrollBeyondLastColumn=118]="scrollBeyondLastColumn",s[s.scrollBeyondLastLine=119]="scrollBeyondLastLine",s[s.scrollPredominantAxis=120]="scrollPredominantAxis",s[s.selectionClipboard=121]="selectionClipboard",s[s.selectionHighlight=122]="selectionHighlight",s[s.selectionHighlightMaxLength=123]="selectionHighlightMaxLength",s[s.selectionHighlightMultiline=124]="selectionHighlightMultiline",s[s.selectOnLineNumbers=125]="selectOnLineNumbers",s[s.showFoldingControls=126]="showFoldingControls",s[s.showUnused=127]="showUnused",s[s.snippetSuggestions=128]="snippetSuggestions",s[s.smartSelect=129]="smartSelect",s[s.smoothScrolling=130]="smoothScrolling",s[s.stickyScroll=131]="stickyScroll",s[s.stickyTabStops=132]="stickyTabStops",s[s.stopRenderingLineAfter=133]="stopRenderingLineAfter",s[s.suggest=134]="suggest",s[s.suggestFontSize=135]="suggestFontSize",s[s.suggestLineHeight=136]="suggestLineHeight",s[s.suggestOnTriggerCharacters=137]="suggestOnTriggerCharacters",s[s.suggestSelection=138]="suggestSelection",s[s.tabCompletion=139]="tabCompletion",s[s.tabIndex=140]="tabIndex",s[s.trimWhitespaceOnDelete=141]="trimWhitespaceOnDelete",s[s.unicodeHighlighting=142]="unicodeHighlighting",s[s.unusualLineTerminators=143]="unusualLineTerminators",s[s.useShadowDOM=144]="useShadowDOM",s[s.useTabStops=145]="useTabStops",s[s.wordBreak=146]="wordBreak",s[s.wordSegmenterLocales=147]="wordSegmenterLocales",s[s.wordSeparators=148]="wordSeparators",s[s.wordWrap=149]="wordWrap",s[s.wordWrapBreakAfterCharacters=150]="wordWrapBreakAfterCharacters",s[s.wordWrapBreakBeforeCharacters=151]="wordWrapBreakBeforeCharacters",s[s.wordWrapColumn=152]="wordWrapColumn",s[s.wordWrapOverride1=153]="wordWrapOverride1",s[s.wordWrapOverride2=154]="wordWrapOverride2",s[s.wrappingIndent=155]="wrappingIndent",s[s.wrappingStrategy=156]="wrappingStrategy",s[s.showDeprecated=157]="showDeprecated",s[s.inertialScroll=158]="inertialScroll",s[s.inlayHints=159]="inlayHints",s[s.wrapOnEscapedLineFeeds=160]="wrapOnEscapedLineFeeds",s[s.effectiveCursorStyle=161]="effectiveCursorStyle",s[s.editorClassName=162]="editorClassName",s[s.pixelRatio=163]="pixelRatio",s[s.tabFocusMode=164]="tabFocusMode",s[s.layoutInfo=165]="layoutInfo",s[s.wrappingInfo=166]="wrappingInfo",s[s.defaultColorDecorators=167]="defaultColorDecorators",s[s.colorDecoratorsActivatedOn=168]="colorDecoratorsActivatedOn",s[s.inlineCompletionsAccessibilityVerbose=169]="inlineCompletionsAccessibilityVerbose",s[s.effectiveEditContext=170]="effectiveEditContext",s[s.scrollOnMiddleClick=171]="scrollOnMiddleClick",s[s.effectiveAllowVariableFonts=172]="effectiveAllowVariableFonts"})(RH||(RH={}));var MH;(function(s){s[s.TextDefined=0]="TextDefined",s[s.LF=1]="LF",s[s.CRLF=2]="CRLF"})(MH||(MH={}));var AH;(function(s){s[s.LF=0]="LF",s[s.CRLF=1]="CRLF"})(AH||(AH={}));var PH;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=3]="Right"})(PH||(PH={}));var OH;(function(s){s[s.Increase=0]="Increase",s[s.Decrease=1]="Decrease"})(OH||(OH={}));var FH;(function(s){s[s.None=0]="None",s[s.Indent=1]="Indent",s[s.IndentOutdent=2]="IndentOutdent",s[s.Outdent=3]="Outdent"})(FH||(FH={}));var BH;(function(s){s[s.Both=0]="Both",s[s.Right=1]="Right",s[s.Left=2]="Left",s[s.None=3]="None"})(BH||(BH={}));var WH;(function(s){s[s.Type=1]="Type",s[s.Parameter=2]="Parameter"})(WH||(WH={}));var HH;(function(s){s[s.Accepted=0]="Accepted",s[s.Rejected=1]="Rejected",s[s.Ignored=2]="Ignored"})(HH||(HH={}));var VH;(function(s){s[s.Code=1]="Code",s[s.Label=2]="Label"})(VH||(VH={}));var zH;(function(s){s[s.Automatic=0]="Automatic",s[s.Explicit=1]="Explicit"})(zH||(zH={}));var UH;(function(s){s[s.DependsOnKbLayout=-1]="DependsOnKbLayout",s[s.Unknown=0]="Unknown",s[s.Backspace=1]="Backspace",s[s.Tab=2]="Tab",s[s.Enter=3]="Enter",s[s.Shift=4]="Shift",s[s.Ctrl=5]="Ctrl",s[s.Alt=6]="Alt",s[s.PauseBreak=7]="PauseBreak",s[s.CapsLock=8]="CapsLock",s[s.Escape=9]="Escape",s[s.Space=10]="Space",s[s.PageUp=11]="PageUp",s[s.PageDown=12]="PageDown",s[s.End=13]="End",s[s.Home=14]="Home",s[s.LeftArrow=15]="LeftArrow",s[s.UpArrow=16]="UpArrow",s[s.RightArrow=17]="RightArrow",s[s.DownArrow=18]="DownArrow",s[s.Insert=19]="Insert",s[s.Delete=20]="Delete",s[s.Digit0=21]="Digit0",s[s.Digit1=22]="Digit1",s[s.Digit2=23]="Digit2",s[s.Digit3=24]="Digit3",s[s.Digit4=25]="Digit4",s[s.Digit5=26]="Digit5",s[s.Digit6=27]="Digit6",s[s.Digit7=28]="Digit7",s[s.Digit8=29]="Digit8",s[s.Digit9=30]="Digit9",s[s.KeyA=31]="KeyA",s[s.KeyB=32]="KeyB",s[s.KeyC=33]="KeyC",s[s.KeyD=34]="KeyD",s[s.KeyE=35]="KeyE",s[s.KeyF=36]="KeyF",s[s.KeyG=37]="KeyG",s[s.KeyH=38]="KeyH",s[s.KeyI=39]="KeyI",s[s.KeyJ=40]="KeyJ",s[s.KeyK=41]="KeyK",s[s.KeyL=42]="KeyL",s[s.KeyM=43]="KeyM",s[s.KeyN=44]="KeyN",s[s.KeyO=45]="KeyO",s[s.KeyP=46]="KeyP",s[s.KeyQ=47]="KeyQ",s[s.KeyR=48]="KeyR",s[s.KeyS=49]="KeyS",s[s.KeyT=50]="KeyT",s[s.KeyU=51]="KeyU",s[s.KeyV=52]="KeyV",s[s.KeyW=53]="KeyW",s[s.KeyX=54]="KeyX",s[s.KeyY=55]="KeyY",s[s.KeyZ=56]="KeyZ",s[s.Meta=57]="Meta",s[s.ContextMenu=58]="ContextMenu",s[s.F1=59]="F1",s[s.F2=60]="F2",s[s.F3=61]="F3",s[s.F4=62]="F4",s[s.F5=63]="F5",s[s.F6=64]="F6",s[s.F7=65]="F7",s[s.F8=66]="F8",s[s.F9=67]="F9",s[s.F10=68]="F10",s[s.F11=69]="F11",s[s.F12=70]="F12",s[s.F13=71]="F13",s[s.F14=72]="F14",s[s.F15=73]="F15",s[s.F16=74]="F16",s[s.F17=75]="F17",s[s.F18=76]="F18",s[s.F19=77]="F19",s[s.F20=78]="F20",s[s.F21=79]="F21",s[s.F22=80]="F22",s[s.F23=81]="F23",s[s.F24=82]="F24",s[s.NumLock=83]="NumLock",s[s.ScrollLock=84]="ScrollLock",s[s.Semicolon=85]="Semicolon",s[s.Equal=86]="Equal",s[s.Comma=87]="Comma",s[s.Minus=88]="Minus",s[s.Period=89]="Period",s[s.Slash=90]="Slash",s[s.Backquote=91]="Backquote",s[s.BracketLeft=92]="BracketLeft",s[s.Backslash=93]="Backslash",s[s.BracketRight=94]="BracketRight",s[s.Quote=95]="Quote",s[s.OEM_8=96]="OEM_8",s[s.IntlBackslash=97]="IntlBackslash",s[s.Numpad0=98]="Numpad0",s[s.Numpad1=99]="Numpad1",s[s.Numpad2=100]="Numpad2",s[s.Numpad3=101]="Numpad3",s[s.Numpad4=102]="Numpad4",s[s.Numpad5=103]="Numpad5",s[s.Numpad6=104]="Numpad6",s[s.Numpad7=105]="Numpad7",s[s.Numpad8=106]="Numpad8",s[s.Numpad9=107]="Numpad9",s[s.NumpadMultiply=108]="NumpadMultiply",s[s.NumpadAdd=109]="NumpadAdd",s[s.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",s[s.NumpadSubtract=111]="NumpadSubtract",s[s.NumpadDecimal=112]="NumpadDecimal",s[s.NumpadDivide=113]="NumpadDivide",s[s.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",s[s.ABNT_C1=115]="ABNT_C1",s[s.ABNT_C2=116]="ABNT_C2",s[s.AudioVolumeMute=117]="AudioVolumeMute",s[s.AudioVolumeUp=118]="AudioVolumeUp",s[s.AudioVolumeDown=119]="AudioVolumeDown",s[s.BrowserSearch=120]="BrowserSearch",s[s.BrowserHome=121]="BrowserHome",s[s.BrowserBack=122]="BrowserBack",s[s.BrowserForward=123]="BrowserForward",s[s.MediaTrackNext=124]="MediaTrackNext",s[s.MediaTrackPrevious=125]="MediaTrackPrevious",s[s.MediaStop=126]="MediaStop",s[s.MediaPlayPause=127]="MediaPlayPause",s[s.LaunchMediaPlayer=128]="LaunchMediaPlayer",s[s.LaunchMail=129]="LaunchMail",s[s.LaunchApp2=130]="LaunchApp2",s[s.Clear=131]="Clear",s[s.MAX_VALUE=132]="MAX_VALUE"})(UH||(UH={}));var $H;(function(s){s[s.Hint=1]="Hint",s[s.Info=2]="Info",s[s.Warning=4]="Warning",s[s.Error=8]="Error"})($H||($H={}));var qH;(function(s){s[s.Unnecessary=1]="Unnecessary",s[s.Deprecated=2]="Deprecated"})(qH||(qH={}));var jH;(function(s){s[s.Inline=1]="Inline",s[s.Gutter=2]="Gutter"})(jH||(jH={}));var KH;(function(s){s[s.Normal=1]="Normal",s[s.Underlined=2]="Underlined"})(KH||(KH={}));var GH;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.TEXTAREA=1]="TEXTAREA",s[s.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",s[s.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",s[s.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",s[s.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",s[s.CONTENT_TEXT=6]="CONTENT_TEXT",s[s.CONTENT_EMPTY=7]="CONTENT_EMPTY",s[s.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",s[s.CONTENT_WIDGET=9]="CONTENT_WIDGET",s[s.OVERVIEW_RULER=10]="OVERVIEW_RULER",s[s.SCROLLBAR=11]="SCROLLBAR",s[s.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",s[s.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(GH||(GH={}));var YH;(function(s){s[s.AIGenerated=1]="AIGenerated"})(YH||(YH={}));var XH;(function(s){s[s.Invoke=0]="Invoke",s[s.Automatic=1]="Automatic"})(XH||(XH={}));var ZH;(function(s){s[s.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",s[s.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",s[s.TOP_CENTER=2]="TOP_CENTER"})(ZH||(ZH={}));var QH;(function(s){s[s.Left=1]="Left",s[s.Center=2]="Center",s[s.Right=4]="Right",s[s.Full=7]="Full"})(QH||(QH={}));var JH;(function(s){s[s.Word=0]="Word",s[s.Line=1]="Line",s[s.Suggest=2]="Suggest"})(JH||(JH={}));var eV;(function(s){s[s.Left=0]="Left",s[s.Right=1]="Right",s[s.None=2]="None",s[s.LeftOfInjectedText=3]="LeftOfInjectedText",s[s.RightOfInjectedText=4]="RightOfInjectedText"})(eV||(eV={}));var tV;(function(s){s[s.Off=0]="Off",s[s.On=1]="On",s[s.Relative=2]="Relative",s[s.Interval=3]="Interval",s[s.Custom=4]="Custom"})(tV||(tV={}));var iV;(function(s){s[s.None=0]="None",s[s.Text=1]="Text",s[s.Blocks=2]="Blocks"})(iV||(iV={}));var nV;(function(s){s[s.Smooth=0]="Smooth",s[s.Immediate=1]="Immediate"})(nV||(nV={}));var sV;(function(s){s[s.Auto=1]="Auto",s[s.Hidden=2]="Hidden",s[s.Visible=3]="Visible"})(sV||(sV={}));var oV;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(oV||(oV={}));var rV;(function(s){s.Off="off",s.OnCode="onCode",s.On="on"})(rV||(rV={}));var aV;(function(s){s[s.Invoke=1]="Invoke",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange"})(aV||(aV={}));var lV;(function(s){s[s.File=0]="File",s[s.Module=1]="Module",s[s.Namespace=2]="Namespace",s[s.Package=3]="Package",s[s.Class=4]="Class",s[s.Method=5]="Method",s[s.Property=6]="Property",s[s.Field=7]="Field",s[s.Constructor=8]="Constructor",s[s.Enum=9]="Enum",s[s.Interface=10]="Interface",s[s.Function=11]="Function",s[s.Variable=12]="Variable",s[s.Constant=13]="Constant",s[s.String=14]="String",s[s.Number=15]="Number",s[s.Boolean=16]="Boolean",s[s.Array=17]="Array",s[s.Object=18]="Object",s[s.Key=19]="Key",s[s.Null=20]="Null",s[s.EnumMember=21]="EnumMember",s[s.Struct=22]="Struct",s[s.Event=23]="Event",s[s.Operator=24]="Operator",s[s.TypeParameter=25]="TypeParameter"})(lV||(lV={}));var cV;(function(s){s[s.Deprecated=1]="Deprecated"})(cV||(cV={}));var dV;(function(s){s[s.LTR=0]="LTR",s[s.RTL=1]="RTL"})(dV||(dV={}));var hV;(function(s){s[s.Hidden=0]="Hidden",s[s.Blink=1]="Blink",s[s.Smooth=2]="Smooth",s[s.Phase=3]="Phase",s[s.Expand=4]="Expand",s[s.Solid=5]="Solid"})(hV||(hV={}));var uV;(function(s){s[s.Line=1]="Line",s[s.Block=2]="Block",s[s.Underline=3]="Underline",s[s.LineThin=4]="LineThin",s[s.BlockOutline=5]="BlockOutline",s[s.UnderlineThin=6]="UnderlineThin"})(uV||(uV={}));var fV;(function(s){s[s.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",s[s.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",s[s.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",s[s.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(fV||(fV={}));var gV;(function(s){s[s.None=0]="None",s[s.Same=1]="Same",s[s.Indent=2]="Indent",s[s.DeepIndent=3]="DeepIndent"})(gV||(gV={}));var Ku;let Att=(Ku=class{static chord(e,t){return ls(e,t)}},Ku.CtrlCmd=2048,Ku.Shift=1024,Ku.Alt=512,Ku.WinCtrl=256,Ku);function ofe(){return{editor:void 0,languages:void 0,CancellationTokenSource:hn,Emitter:q,KeyCode:UH,KeyMod:Att,Position:z,Range:D,Selection:Oe,SelectionDirection:oV,MarkerSeverity:$H,MarkerTag:qH,Uri:Ze,Token:HL}}const lte="default",Ptt="$initialize";let cte=!1;function mV(s){Ah&&(cte||(cte=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(s.message))}class Ott{constructor(e,t,i,n,o){this.vsWorker=e,this.req=t,this.channel=i,this.method=n,this.args=o,this.type=0}}class dte{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class Ftt{constructor(e,t,i,n,o){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=n,this.arg=o,this.type=2}}class Btt{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class Wtt{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class Htt{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}async sendMessage(e,t,i){const n=String(++this._lastSentReq);return new Promise((o,r)=>{this._pendingReplies[n]={resolve:o,reject:r},this._send(new Ott(this._workerId,n,e,t,i))})}listen(e,t,i){let n=null;const o=new q({onWillAddFirstListener:()=>{n=String(++this._lastSentReq),this._pendingEmitters.set(n,o),this._send(new Ftt(this._workerId,n,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(n),this._send(new Wtt(this._workerId,n)),n=null}});return o.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(n,o)=>(typeof o=="string"&&!n[o]&&(afe(o)?n[o]=r=>this.listen(e,o,r):rfe(o)?n[o]=this.listen(e,o,void 0):o.charCodeAt(0)===36&&(n[o]=async(...r)=>(await(t==null?void 0:t()),this.sendMessage(e,o,r)))),n[o])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;if(e.err.$isError){const n=new Error;n.name=e.err.name,n.message=e.err.message,n.stack=e.err.stack,i=n}t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(n=>{this._send(new dte(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=b9(n.detail)),this._send(new dte(this._workerId,t,void 0,b9(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(n=>{this._send(new Btt(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++){const n=e.args[i];n instanceof ArrayBuffer&&t.push(n)}else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class Vtt extends K{constructor(e){super(),this._localChannels=new Map,this._worker=this._register(e),this._register(this._worker.onMessage(t=>{this._protocol.handleMessage(t)})),this._register(this._worker.onError(t=>{mV(t),_t(t)})),this._protocol=new Htt({sendMessage:(t,i)=>{this._worker.postMessage(t,i)},handleMessage:(t,i,n)=>this._handleMessage(t,i,n),handleEvent:(t,i,n)=>this._handleEvent(t,i,n)}),this._protocol.setWorkerId(this._worker.getId()),this._onModuleLoaded=this._protocol.sendMessage(lte,Ptt,[this._worker.getId()]).then(()=>{}),this.proxy=this._protocol.createProxyToRemoteChannel(lte,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(t=>{this._onError("Worker failed to load ",t)})}_handleMessage(e,t,i){const n=this._localChannels.get(e);if(!n)return Promise.reject(new Error(`Missing channel ${e} on main thread`));const o=n[t];if(typeof o!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(o.apply(n,i))}catch(r){return Promise.reject(r)}}_handleEvent(e,t,i){const n=this._localChannels.get(e);if(!n)throw new Error(`Missing channel ${e} on main thread`);if(afe(t)){const o=n[t];if(typeof o!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);const r=o.call(n,i);if(typeof r!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return r}if(rfe(t)){const o=n[t];if(typeof o!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return o}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function rfe(s){return s[0]==="o"&&s[1]==="n"&&Yd(s.charCodeAt(2))}function afe(s){return/^onDynamic/.test(s)&&Yd(s.charCodeAt(9))}let zC;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?zC=globalThis.workerttPolicy:zC=Oh("defaultWorkerFactory",{createScriptURL:s=>s});function ztt(s,e){const t=s.label||"anonymous"+e,i=lU();if(i){if(typeof i.getWorker=="function")return i.getWorker("workerMain.js",t);if(typeof i.getWorkerUrl=="function"){const o=i.getWorkerUrl("workerMain.js",t);return new Worker(zC?zC.createScriptURL(o):o,{name:t,type:"module"})}}const n=s.esmModuleLocation;if(n){const o=Utt(t,n.toString(!0)),r=new Worker(zC?zC.createScriptURL(o):o,{name:t,type:"module"});return $tt(r)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function Utt(s,e){if(!(/^((http:)|(https:)|(file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const i=e.lastIndexOf("?"),n=e.lastIndexOf("#",i),o=i>0?new URLSearchParams(e.substring(i+1,~n?n:void 0)):new URLSearchParams;A9.addSearchParam(o,!0,!0),o.toString()?e=`${e}?${o.toString()}#${s}`:e=`${e}#${s}`}const t=new Blob([bd([`/*${s}*/`,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(vse())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(aU())};`,`globalThis._VSCODE_FILE_ROOT = ${JSON.stringify(globalThis._VSCODE_FILE_ROOT)};`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL(${JSON.stringify(e)}) ?? ${JSON.stringify(e)});`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${s}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(t)}function $tt(s){return new Promise((e,t)=>{s.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(s.onmessage=null,e(s))},s.onerror=t})}function qtt(s){return!!s&&typeof s.then=="function"}const NP=class NP extends K{constructor(e){super(),this._onMessage=this._register(new q),this.onMessage=this._onMessage.event,this._onError=this._register(new q),this.onError=this._onError.event,this.id=++NP.LAST_WORKER_ID;const t=e instanceof Worker||"then"in e?e:ztt(e,this.id);qtt(t)?this.worker=t:this.worker=Promise.resolve(t),this.postMessage("-please-ignore-",[]);const i=n=>{this._onError.fire(n)};this.worker.then(n=>{n.onmessage=o=>{this._onMessage.fire(o.data)},n.onmessageerror=o=>{this._onError.fire(o)},typeof n.addEventListener=="function"&&n.addEventListener("error",i)}),this._register(Ve(()=>{var n;(n=this.worker)==null||n.then(o=>{o.onmessage=null,o.onmessageerror=null,o.removeEventListener("error",i),o.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)==null||i.then(n=>{try{n.postMessage(e,t)}catch(o){_t(o),_t(new Error("FAILED to post message to worker",{cause:o}))}})}};NP.LAST_WORKER_ID=0;let pV=NP;class jtt{constructor(e,t){this.esmModuleLocation=e,this.label=t}}function Ktt(s,e){const t=Ze.isUri(s)?new jtt(s,e):s;return new Vtt(new pV(t))}class Gtt{constructor(e,t,i){const n=new Uint8Array(e*t);for(let o=0,r=e*t;o<r;o++)n[o]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Ytt{constructor(e){let t=0,i=0;for(let o=0,r=e.length;o<r;o++){const[a,l,c]=e[o];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new Gtt(i,t,0);for(let o=0,r=e.length;o<r;o++){const[a,l,c]=e[o];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let R3=null;function Xtt(){return R3===null&&(R3=new Ytt([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),R3}let aS=null;function Ztt(){if(aS===null){aS=new s0(0);const s=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…|`;for(let t=0;t<s.length;t++)aS.set(s.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)aS.set(e.charCodeAt(t),2)}return aS}class BM{static _createLink(e,t,i,n,o){let r=o-1;do{const a=t.charCodeAt(r);if(e.get(a)!==2)break;r--}while(r>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(r);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&r--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:r+2},url:t.substring(n,r+1)}}static computeLinks(e,t=Xtt()){const i=Ztt(),n=[];for(let o=1,r=e.getLineCount();o<=r;o++){const a=e.getLineContent(o),l=a.length;let c=0,d=0,h=0,u=1,f=!1,g=!1,m=!1,p=!1;for(;c<l;){let v=!1;const b=a.charCodeAt(c);if(u===13){let w;switch(b){case 40:f=!0,w=0;break;case 41:w=f?0:1;break;case 91:m=!0,g=!0,w=0;break;case 93:m=!1,w=g?0:1;break;case 123:p=!0,w=0;break;case 125:w=p?0:1;break;case 39:case 34:case 96:h===b?w=1:h===39||h===34||h===96?w=0:w=1;break;case 42:w=h===42?1:0;break;case 32:w=m?0:1;break;default:w=i.get(b)}w===1&&(n.push(BM._createLink(i,a,o,d,c)),v=!0)}else if(u===12){let w;b===91?(g=!0,w=0):w=i.get(b),w===1?v=!0:u=13}else u=t.nextState(u,b),u===0&&(v=!0);v&&(u=1,f=!1,g=!1,p=!1,d=c+1,h=b),c++}u===13&&n.push(BM._createLink(i,a,o,d,l))}return n}}function Qtt(s){return!s||typeof s.getLineCount!="function"||typeof s.getLineContent!="function"?[]:BM.computeLinks(s)}const RP=class RP{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,o){if(e&&t){const r=this.doNavigateValueSet(t,o);if(r)return{range:e,value:r}}if(i&&n){const r=this.doNavigateValueSet(n,o);if(r)return{range:i,value:r}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const o=parseFloat(e);return!isNaN(n)&&!isNaN(o)&&n===o?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let o=0,r=e.length;n===null&&o<r;o++)n=this.valueSetReplace(e[o],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}};RP.INSTANCE=new RP;let _V=RP;function lfe(s){const e=[];for(const t of s){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function qj(s,e,t,i){return{red:s/255,blue:t/255,green:e/255,alpha:i}}function lS(s,e){const t=e.index,i=e[0].length;if(t===void 0)return;const n=s.positionAt(t);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+i}}function Jtt(s,e){if(!s)return;const t=re.Format.CSS.parseHex(e);if(t)return{range:s,color:qj(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function hte(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),o=lfe(n);return{range:s,color:qj(o[0],o[1],o[2],t?o[3]:1)}}function ute(s,e,t){if(!s||e.length!==1)return;const n=e[0].values(),o=lfe(n),r=new re(new rc(o[0],o[1]/100,o[2]/100,t?o[3]:1));return{range:s,color:qj(r.rgba.r,r.rgba.g,r.rgba.b,r.rgba.a)}}function cS(s,e){return typeof s=="string"?[...s.matchAll(e)]:s.findMatches(e)}function eit(s){const e=[],t=new RegExp(`\\b(rgb|rgba|hsl|hsla)(\\([0-9\\s,.\\%]*\\))|^(#)([A-Fa-f0-9]{3})\\b|^(#)([A-Fa-f0-9]{4})\\b|^(#)([A-Fa-f0-9]{6})\\b|^(#)([A-Fa-f0-9]{8})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{3})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{4})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{6})\\b|(?<=['"\\s])(#)([A-Fa-f0-9]{8})\\b`,"gm"),i=cS(s,t);if(i.length>0)for(const n of i){const o=n.filter(c=>c!==void 0),r=o[1],a=o[2];if(!a)continue;let l;if(r==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=hte(lS(s,n),cS(a,c),!1)}else if(r==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=hte(lS(s,n),cS(a,c),!0)}else if(r==="hsl"){const c=/^\(\s*((?:360(?:\.0+)?|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])(?:\.\d+)?))\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=ute(lS(s,n),cS(a,c),!1)}else if(r==="hsla"){const c=/^\(\s*((?:360(?:\.0+)?|(?:36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])(?:\.\d+)?))\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*[\s,]\s*(0[.][0-9]+|[.][0-9]+|[01][.]0*|[01])\s*\)$/gm;l=ute(lS(s,n),cS(a,c),!0)}else r==="#"&&(l=Jtt(lS(s,n),r+a));l&&e.push(l)}return e}function tit(s){return!s||typeof s.getValue!="function"||typeof s.positionAt!="function"?[]:eit(s)}const iit=/^-+|-+$/g,fte=100,nit=5;function sit(s,e){var i;let t=[];if(e.findRegionSectionHeaders&&((i=e.foldingRules)!=null&&i.markers)){const n=oit(s,e);t=t.concat(n)}if(e.findMarkSectionHeaders){const n=rit(s,e);t=t.concat(n)}return t}function oit(s,e){const t=[],i=s.getLineCount();for(let n=1;n<=i;n++){const o=s.getLineContent(n),r=o.match(e.foldingRules.markers.start);if(r){const a={startLineNumber:n,startColumn:r[0].length+1,endLineNumber:n,endColumn:o.length+1};if(a.endColumn>a.startColumn){const l={range:a,...ait(o.substring(r[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function rit(s,e){const t=[],i=s.getLineCount();if(!e.markSectionHeaderRegex||e.markSectionHeaderRegex.trim()==="")return t;const n=$ae(e.markSectionHeaderRegex),o=new RegExp(e.markSectionHeaderRegex,`gdm${n?"s":""}`);if(Wse(o))return t;for(let r=1;r<=i;r+=fte-nit){const a=Math.min(r+fte-1,i),l=[];for(let h=r;h<=a;h++)l.push(s.getLineContent(h));const c=l.join(`
`);o.lastIndex=0;let d;for(;(d=o.exec(c))!==null;){const h=c.substring(0,d.index),u=(h.match(/\n/g)||[]).length,f=r+u,g=d[0].split(`
`),m=g.length,p=f+m-1,v=h.lastIndexOf(`
`)+1,b=d.index-v+1,w=g[g.length-1],C=m===1?b+d[0].length:w.length+1,y={startLineNumber:f,startColumn:b,endLineNumber:p,endColumn:C},x=(d.groups??{}).label??"",S=((d.groups??{}).separator??"")!=="",L={range:y,text:x,hasSeparatorLine:S,shouldBeInComments:!0};(L.text||L.hasSeparatorLine)&&(t.length===0||t[t.length-1].range.endLineNumber<L.range.startLineNumber)&&t.push(L),o.lastIndex=d.index+d[0].length}}return t}function ait(s){s=s.trim();const e=s.startsWith("-");return s=s.replace(iit,""),{text:s,hasSeparatorLine:e}}class lit{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new z(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Y9e(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=fa(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let o=1;o<i.length;o++)this._lines.splice(e.lineNumber+o-1,0,i[o]),n[o-1]=i[o].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const gte=60*1e3;class cit extends K{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new _U;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(gte/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)yi(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>gte&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const o=new oe;o.add(i.onDidChangeContent(r=>{this._proxy.$acceptModelChanged(n.toString(),r)})),o.add(i.onWillDispose(()=>{this._stopModelSync(n)})),o.add(Ve(()=>{this._proxy.$acceptRemovedModel(n)})),this._syncedModels[n]=o}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],yi(t)}}class dit{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new hit(Ze.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class hit extends lit{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const n=this._lines[i],o=this.offsetAt(new z(i+1,1)),r=n.matchAll(e);for(const a of r)(a.index||a.index===0)&&(a.index=a.index+o),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=EL(e.column,qU(t),this._lines[e.lineNumber-1],0);return i?new D(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,o="",r=0,a=[];return{*[Symbol.iterator](){for(;;)if(r<a.length){const l=o.substring(a[r].start,a[r].end);r+=1,yield l}else if(n<t.length)o=t[n],a=i(o,e),r=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),o=[];for(const r of n)o.push({word:i.substring(r.start,r.end),startColumn:r.start+1,endColumn:r.end+1});return o}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,o=[];o.push(this._lines[i].substring(e.startColumn-1));for(let r=i+1;r<n;r++)o.push(this._lines[r]);return o.push(this._lines[n].substring(0,e.endColumn-1)),o.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!z.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const o=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>o&&(i=o,n=!0)}return n?{lineNumber:t,column:i}:e}}const Wp=class Wp{constructor(e=null){this._foreignModule=e,this._requestHandlerBrand=void 0,this._workerTextModelSyncServer=new dit}dispose(){}async $ping(){return"pong"}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const n=this._getModel(e);return n?Oj.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?sit(i,t):[]}async $computeDiff(e,t,i,n){const o=this._getModel(e),r=this._getModel(t);return!o||!r?null:Wp.computeDiff(o,r,i,n)}static computeDiff(e,t,i,n){const o=n==="advanced"?M8.getDefault():M8.getLegacy(),r=e.getLinesContent(),a=t.getLinesContent(),l=o.computeDiff(r,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function d(h){return h.map(u=>{var f;return[u.original.startLineNumber,u.original.endLineNumberExclusive,u.modified.startLineNumber,u.modified.endLineNumberExclusive,(f=u.innerChanges)==null?void 0:f.map(g=>[g.originalRange.startLineNumber,g.originalRange.startColumn,g.originalRange.endLineNumber,g.originalRange.endColumn,g.modifiedRange.startLineNumber,g.modifiedRange.startColumn,g.modifiedRange.endLineNumber,g.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:d(l.changes),moves:l.moves.map(h=>[h.lineRangeMapping.original.startLineNumber,h.lineRangeMapping.original.endLineNumberExclusive,h.lineRangeMapping.modified.startLineNumber,h.lineRangeMapping.modified.endLineNumberExclusive,d(h.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let o=1;o<=i;o++){const r=e.getLineContent(o),a=t.getLineContent(o);if(r!==a)return!1}return!0}async $computeMoreMinimalEdits(e,t,i){const n=this._getModel(e);if(!n)return t;const o=[];let r;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return D.compareRangesUsingStarts(l.range,c.range);const d=l.range?0:1,h=c.range?0:1;return d-h});let a=0;for(let l=1;l<t.length;l++)D.getEndPosition(t[a].range).equals(D.getStartPosition(t[l].range))?(t[a].range=D.fromPositions(D.getStartPosition(t[a].range),D.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:d}of t){if(typeof d=="number"&&(r=d),D.isEmpty(l)&&!c)continue;const h=n.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,n.eol),h===c)continue;if(Math.max(c.length,h.length)>Wp._diffLimit){o.push({range:l,text:c});continue}const u=jUe(h,c,i),f=n.offsetAt(D.lift(l).getStartPosition());for(const g of u){const m=n.positionAt(f+g.originalStart),p=n.positionAt(f+g.originalStart+g.originalLength),v={text:c.substr(g.modifiedStart,g.modifiedLength),range:{startLineNumber:m.lineNumber,startColumn:m.column,endLineNumber:p.lineNumber,endColumn:p.column}};n.getValueInRange(v.range)!==v.text&&o.push(v)}}return typeof r=="number"&&o.push({eol:r,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),o}async $computeLinks(e){const t=this._getModel(e);return t?Qtt(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?tit(t):null}async $textualSuggest(e,t,i,n){const o=new Fs,r=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const d of c.words(r))if(!(d===t||!isNaN(Number(d)))&&(a.add(d),a.size>Wp._suggestionsLimit))break e}}return{words:Array.from(a),duration:o.elapsed()}}async $computeWordRanges(e,t,i,n){const o=this._getModel(e);if(!o)return Object.create(null);const r=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=o.getLineWords(l,r);for(const d of c){if(!isNaN(Number(d.word)))continue;let h=a[d.word];h||(h=[],a[d.word]=h),h.push({startLineNumber:l,startColumn:d.startColumn,endLineNumber:l,endColumn:d.endColumn})}}return a}async $navigateValueSet(e,t,i,n,o){const r=this._getModel(e);if(!r)return null;const a=new RegExp(n,o);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=r.getValueInRange(t),c=r.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const d=r.getValueInRange(c);return _V.INSTANCE.navigateValueSet(t,l,c,d,i)}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}};Wp._diffLimit=1e5,Wp._suggestionsLimit=1e4;let bV=Wp;typeof importScripts=="function"&&(globalThis.monaco=ofe());const Zx=class Zx{static getChannel(e){return e.getChannel(Zx.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(Zx.CHANNEL_NAME,t)}};Zx.CHANNEL_NAME="editorWorkerHost";let vV=Zx;var jj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},xp=function(s,e){return function(t,i){e(t,i,s)}};const mte=300*1e3;function Lp(s,e){const t=s.getModel(e);return!(!t||t.isTooLargeForSyncing())}let CV=class extends K{constructor(e,t,i,n,o,r){super(),this._languageConfigurationService=o,this._modelService=t,this._workerManager=this._register(new wV(e,this._modelService)),this._logService=n,this._register(r.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!Lp(this._modelService,a.uri))return Promise.resolve({links:[]});const d=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return d&&{links:d}}})),this._register(r.completionProvider.register("*",new uit(this._workerManager,i,this._modelService,this._languageConfigurationService,this._logService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return Lp(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,n){const r=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,n);if(!r)return null;return{identical:r.identical,quitEarly:r.quitEarly,changes:l(r.changes),moves:r.moves.map(c=>new Yhe(new Xo(new dt(c[0],c[1]),new dt(c[2],c[3])),l(c[4])))};function l(c){return c.map(d=>{var h;return new Qa(new dt(d[0],d[1]),new dt(d[2],d[3]),(h=d[4])==null?void 0:h.map(u=>new fr(new D(u[0],u[1],u[2],u[3]),new D(u[4],u[5],u[6],u[7]))))})}}async computeMoreMinimalEdits(e,t,i=!1){if(er(t)){if(!Lp(this._modelService,e))return Promise.resolve(t);const n=Fs.create(),o=this._workerWithResources([e]).then(r=>r.$computeMoreMinimalEdits(e.toString(),t,i));return o.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed())),Promise.race([o,Sh(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return Lp(this._modelService,e)}async navigateValueSet(e,t,i){const n=this._modelService.getModel(e);if(!n)return null;const o=this._languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),r=o.source,a=o.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,r,a)}canComputeWordRanges(e){return Lp(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const n=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),o=n.source,r=n.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,o,r)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};CV=jj([xp(1,Cn),xp(2,V4),xp(3,Ji),xp(4,wn),xp(5,We)],CV);class uit{constructor(e,t,i,n,o){this.languageConfigurationService=n,this.logService=o,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const n=[];if(i.wordBasedSuggestions==="currentDocument")Lp(this._modelService,e.uri)&&n.push(e.uri);else for(const h of this._modelService.getModels())Lp(this._modelService,h.uri)&&(h===e?n.unshift(h.uri):(i.wordBasedSuggestions==="allDocuments"||h.getLanguageId()===e.getLanguageId())&&n.push(h.uri));if(n.length===0)return;const o=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),r=e.getWordAtPosition(t),a=r?new D(t.lineNumber,r.startColumn,t.lineNumber,r.endColumn):D.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column);this.logService.trace("[WordBasedCompletionItemProvider]",`word: "${(r==null?void 0:r.word)||""}", wordDef: "${o}", replace: [${a.toString()}], insert: [${l.toString()}]`);const d=await(await this._workerManager.withWorker()).textualSuggest(n,r==null?void 0:r.word,o);if(d)return{duration:d.duration,suggestions:d.words.map(h=>({kind:18,label:h,insertText:h,range:{insert:l,replace:a}}))}}}let wV=class extends K{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new FU).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(mte/2),Ti),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>mte&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new WM(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};wV=jj([xp(1,Cn)],wV);class fit{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let WM=class extends K{constructor(e,t,i){super(),this._workerDescriptorOrWorker=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(Ktt(this._workerDescriptorOrWorker)),vV.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){mV(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return mV(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new fit(new bV(null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new cit(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject(mke());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const n=await this.workerWithSyncedResources(e),o=i.source,r=i.flags;return n.$textualSuggest(e.map(a=>a.toString()),t,o,r)}dispose(){super.dispose(),this._disposed=!0}};WM=jj([xp(2,Cn)],WM);function git(s,e){return new mit(s,e)}class mit extends WM{constructor(e,t){super(t.worker,t.keepIdleModels||!1,e),this._foreignModuleHost=t.host||null,this._foreignProxy=this._getProxy().then(i=>new Proxy({},{get(n,o,r){if(o!=="then"){if(typeof o!="string")throw new Error("Not supported");return(...a)=>i.$fmr(o,a)}}}))}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}getProxy(){return this._foreignProxy}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}function pit(s){return Array.isArray(s)}function _it(s){return!pit(s)}function cfe(s){return typeof s=="string"}function pte(s){return!cfe(s)}function Ip(s){return!s}function of(s,e){return s.ignoreCase&&e?e.toLowerCase():e}function _te(s){return s.replace(/[&<>'"_]/g,"-")}function bit(s,e){console.log(`${s.languageId}: ${e}`)}function ln(s,e){return new Error(`${s.languageId}: ${e}`)}function fg(s,e,t,i,n){const o=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let r=null;return e.replace(o,function(a,l,c,d,h,u,f,g,m){return Ip(c)?Ip(d)?!Ip(h)&&h<i.length?of(s,i[h]):!Ip(f)&&s&&typeof s[f]=="string"?s[f]:(r===null&&(r=n.split("."),r.unshift(n)),!Ip(u)&&u<r.length?of(s,r[u]):""):of(s,t):"$"})}function vit(s,e,t){const i=/\$[sS](\d\d?)/g;let n=null;return e.replace(i,function(o,r){return n===null&&(n=t.split("."),n.unshift(t)),!Ip(r)&&r<n.length?ua(of(s,n[r])):""})}function mT(s,e){let t=e;for(;t&&t.length>0;){const i=s.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function Cit(s,e){let t=e;for(;t&&t.length>0;){if(s.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var wit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},yit=function(s,e){return function(t,i){e(t,i,s)}},yV;const dfe=5,MP=class MP{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new F1(e,t);let i=F1.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new F1(e,t),this._entries[i]=n,n)}};MP._INSTANCE=new MP(dfe);let GI=MP;class F1{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return F1._equals(this,e)}push(e){return GI.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return GI.create(this.parent,e)}}class UC{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new UC(this.languageId,this.state)}}const AP=class AP{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new Dx(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new Dx(e,t);const i=F1.getStackElementId(e);let n=this._entries[i];return n||(n=new Dx(e,null),this._entries[i]=n,n)}};AP._INSTANCE=new AP(dfe);let gg=AP;class Dx{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:gg.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof Dx)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class Sit{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new HL(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const o=i.languageId,r=i.state,a=An.get(o);if(!a)return this.enterLanguage(o),this.emit(n,""),r;const l=a.tokenize(e,t,r);if(n!==0)for(const c of l.tokens)this._tokens.push(new HL(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new w$(this._tokens,e)}}class HM{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,o=t.length,r=i!==null?i.length:0;if(n===0&&o===0&&r===0)return new Uint32Array(0);if(n===0&&o===0)return i;if(o===0&&r===0)return e;const a=new Uint32Array(n+o+r);e!==null&&a.set(e);for(let l=0;l<o;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+o),a}nestedLanguageTokenize(e,t,i,n){const o=i.languageId,r=i.state,a=An.get(o);if(!a)return this.enterLanguage(o),this.emit(n,""),r;const l=a.tokenizeEncoded(e,t,r);if(n!==0)for(let c=0,d=l.tokens.length;c<d;c+=2)l.tokens[c]+=n;return this._prependTokens=HM._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new i4(HM._merge(this._prependTokens,this._tokens,null),e)}}let YI=yV=class extends K{constructor(e,t,i,n,o){super(),this._configurationService=o,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let r=!1;this._register(An.onDidChange(a=>{if(r)return;let l=!1;for(let c=0,d=a.changedLanguages.length;c<d;c++){const h=a.changedLanguages[c];if(this._embeddedLanguages[h]){l=!0;break}}l&&(r=!0,An.handleChange([this._languageId]),r=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=An.get(t);if(i){if(i instanceof yV){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}An.isResolved(t)||e.push(An.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=GI.create(null,this._lexer.start);return gg.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return W$(this._languageId,i);const n=new Sit,o=this._tokenize(e,t,i,n);return n.finalize(o)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return o4(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new HM(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),o=this._tokenize(e,t,i,n);return n.finalize(o)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=mT(this._lexer,t.stack.state),!i))throw ln(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,o=!1;for(const r of i){if(!pte(r.action)||!(r.action.nextEmbedded==="@pop"||r.action.hasEmbeddedEndInCases))continue;o=!0;let a=r.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const d=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),d)}const c=e.search(a);c===-1||c!==0&&r.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!o)throw ln(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,o){const r=this._findLeavingNestedLanguageOffset(e,i);if(r===-1){const c=o.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return gg.create(i.stack,new UC(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,r);a.length>0&&o.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(r);return this._myTokenize(l,t,i,n+r,o)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,o){o.enterLanguage(this._languageId);const r=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,d=i.stack,h=0,u=null,f=!0;for(;f||h<l;){const g=h,m=d.depth,p=u?u.groups.length:0,v=d.state;let b=null,w=null,C=null,y=null,x=null;if(u){b=u.matches;const E=u.groups.shift();w=E.matched,C=E.action,y=u.rule,u.groups.length===0&&(u=null)}else{if(!f&&h>=l)break;f=!1;let E=this._lexer.tokenizer[v];if(!E&&(E=mT(this._lexer,v),!E))throw ln(this._lexer,"tokenizer state is not defined: "+v);const M=a.substr(h);for(const R of E)if((h===0||!R.matchOnlyAtLineStart)&&(b=M.match(R.resolveRegex(v)),b)){w=b[0],C=R.action;break}}if(b||(b=[""],w=""),C||(h<l&&(b=[a.charAt(h)],w=b[0]),C=this._lexer.defaultToken),w===null)break;for(h+=w.length;_it(C)&&pte(C)&&C.test;)C=C.test(w,b,v,h===l);let S=null;if(typeof C=="string"||Array.isArray(C))S=C;else if(C.group)S=C.group;else if(C.token!==null&&C.token!==void 0){if(C.tokenSubst?S=fg(this._lexer,C.token,w,b,v):S=C.token,C.nextEmbedded)if(C.nextEmbedded==="@pop"){if(!c)throw ln(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw ln(this._lexer,"cannot enter embedded language from within an embedded language");x=fg(this._lexer,C.nextEmbedded,w,b,v)}if(C.goBack&&(h=Math.max(0,h-C.goBack)),C.switchTo&&typeof C.switchTo=="string"){let E=fg(this._lexer,C.switchTo,w,b,v);if(E[0]==="@"&&(E=E.substr(1)),mT(this._lexer,E))d=d.switchTo(E);else throw ln(this._lexer,"trying to switch to a state '"+E+"' that is undefined in rule: "+this._safeRuleName(y))}else{if(C.transform&&typeof C.transform=="function")throw ln(this._lexer,"action.transform not supported");if(C.next)if(C.next==="@push"){if(d.depth>=this._lexer.maxStack)throw ln(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(v)}else if(C.next==="@pop"){if(d.depth<=1)throw ln(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(y));d=d.pop()}else if(C.next==="@popall")d=d.popall();else{let E=fg(this._lexer,C.next,w,b,v);if(E[0]==="@"&&(E=E.substr(1)),mT(this._lexer,E))d=d.push(E);else throw ln(this._lexer,"trying to set a next state '"+E+"' that is undefined in rule: "+this._safeRuleName(y))}}C.log&&typeof C.log=="string"&&bit(this._lexer,this._lexer.languageId+": "+fg(this._lexer,C.log,w,b,v))}if(S===null)throw ln(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(y));const L=E=>{const M=this._languageService.getLanguageIdByLanguageName(E)||this._languageService.getLanguageIdByMimeType(E)||E,R=this._getNestedEmbeddedLanguageData(M);if(h<l){const T=e.substr(h);return this._nestedTokenize(T,t,gg.create(d,R),n+h,o)}else return gg.create(d,R)};if(Array.isArray(S)){if(u&&u.groups.length>0)throw ln(this._lexer,"groups cannot be nested: "+this._safeRuleName(y));if(b.length!==S.length+1)throw ln(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(y));let E=0;for(let M=1;M<b.length;M++)E+=b[M].length;if(E!==w.length)throw ln(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(y));u={rule:y,matches:b,groups:[]};for(let M=0;M<S.length;M++)u.groups[M]={action:S[M],matched:b[M+1]};h-=w.length;continue}else{if(S==="@rematch"&&(h-=w.length,w="",b=null,S="",x!==null))return L(x);if(w.length===0){if(l===0||m!==d.depth||v!==d.state||(u?u.groups.length:0)!==p)continue;throw ln(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(y))}let E=null;if(cfe(S)&&S.indexOf("@brackets")===0){const M=S.substr(9),R=xit(this._lexer,w);if(!R)throw ln(this._lexer,"@brackets token returned but no bracket defined as: "+w);E=_te(R.token+M)}else{const M=S===""?"":S+this._lexer.tokenPostfix;E=_te(M)}g<r&&o.emit(g+n,E)}if(x!==null)return L(x)}return gg.create(d,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new UC(e,Rw);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),An.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=An.get(e);return t?new UC(e,t.getInitialState()):new UC(e,Rw)}};YI=yV=wit([yit(4,xt)],YI);function xit(s,e){if(!e)return null;e=of(s,e);const t=s.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const M3=Oh("standaloneColorizer",{createHTML:s=>s});class Kj{static colorizeElement(e,t,i,n){n=n||{};const o=n.theme||"vs",r=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!r)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(r)||r;e.setTheme(o);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+o;const c=d=>{const h=(M3==null?void 0:M3.createHTML(d))??d;i.innerHTML=h};return this.colorize(t,l||"",a,n).then(c,d=>console.error(d))}static async colorize(e,t,i,n){const o=e.languageIdCodec;let r=4;n&&typeof n.tabSize=="number"&&(r=n.tabSize),LU(t)&&(t=t.substr(1));const a=fa(t);if(!e.isRegisteredLanguageId(i))return bte(a,r,o);const l=await An.getOrCreate(i);return l?Lit(a,r,l,o):bte(a,r,o)}static colorizeLine(e,t,i,n,o=4){const r=el.isBasicASCII(e,t),a=el.containsRTL(e,r,i);return ZO(new kf(!1,!0,e,!1,r,a,0,n,[],o,0,0,0,0,-1,"none",!1,!1,null,null,0)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const r=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),r,i)}}function Lit(s,e,t,i){return new Promise((n,o)=>{const r=()=>{const a=Iit(s,e,t,i);if(t instanceof YI){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(r,o);return}}n(a)};r()})}function bte(s,e,t){let i=[];const o=new Uint32Array(2);o[0]=0,o[1]=33587200;for(let r=0,a=s.length;r<a;r++){const l=s[r];o[0]=l.length;const c=new qn(o,l,t),d=el.isBasicASCII(l,!0),h=el.containsRTL(l,d,!0),u=ZO(new kf(!1,!0,l,!1,d,h,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null,null,0));i=i.concat(u.html),i.push("<br/>")}return i.join("")}function Iit(s,e,t,i){let n=[],o=t.getInitialState();for(let r=0,a=s.length;r<a;r++){const l=s[r],c=t.tokenizeEncoded(l,!0,o);qn.convertToEndOffset(c.tokens,l.length);const d=new qn(c.tokens,l,i),h=el.isBasicASCII(l,!0),u=el.containsRTL(l,h,!0),f=ZO(new kf(!1,!0,l,!1,h,u,0,d.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null,null,0));n=n.concat(f.html),n.push("<br/>"),o=c.endState}return n.join("")}var Eit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},kit=function(s,e){return function(t,i){e(t,i,s)}};let SV=class extends K{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new q),this._onCodeEditorAdd=this._register(new q),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new q),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new q),this._onDiffEditorAdd=this._register(new q),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new q),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new Zo,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let o;this._modelProperties.has(n)?o=this._modelProperties.get(n):(o=new Map,this._modelProperties.set(n,o)),o.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const n of this._codeEditorOpenHandlers){const o=await n(e,t,i);if(o!==null)return o}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return Ve(t)}};SV=Eit([kit(0,Dn)],SV);var Dit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vte=function(s,e){return function(t,i){e(t,i,s)}};let VM=class extends SV{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,n,o)=>n?this.doOpenEditor(n,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const o=t.resource.scheme;if(o===ct.http||o===ct.https)return Coe(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const o={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(o),e.revealPositionInCenter(o,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};VM=Dit([vte(0,ut),vte(1,Dn)],VM);Vt(ii,VM,0);var hfe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ufe=function(s,e){return function(t,i){e(t,i,s)}};let zM=class{get mainContainer(){var e;return((e=this._codeEditorService.listCodeEditors().at(0))==null?void 0:e.getContainerDomNode())??Ti.document.body}get activeContainer(){const e=this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor();return(e==null?void 0:e.getContainerDomNode())??this.mainContainer}get mainContainerDimension(){return um(this.mainContainer)}get activeContainerDimension(){return um(this.activeContainer)}get containers(){return bd(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())==null||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=Se.None,this.onDidLayoutActiveContainer=Se.None,this.onDidLayoutContainer=Se.None,this.onDidChangeActiveContainer=Se.None,this.onDidAddContainer=Se.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};zM=hfe([ufe(0,ii)],zM);let xV=class extends zM{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};xV=hfe([ufe(1,ii)],xV);Vt(Bh,zM,1);var Tit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Cte=function(s,e){return function(t,i){e(t,i,s)}};function pT(s){return s.scheme===ct.file?s.fsPath:s.path}let ffe=0;class _T{constructor(e,t,i,n,o,r,a){this.id=++ffe,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=o,this.sourceId=r,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class wte{constructor(e,t){this.resourceLabel=e,this.reason=t}}class yte{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(_(2030,"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(_(2031,"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class Nit{constructor(e,t,i,n,o,r,a){this.id=++ffe,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=o,this.sourceId=r,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new yte),this.removedResources.has(t)||this.removedResources.set(t,new wte(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new yte),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new wte(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class gfe{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new Zae(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,o=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,o=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let r=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,r=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}o!==-1&&(this._past=this._past.slice(0,o)),r!==-1&&(this._future=this._future.slice(r+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class A3{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const mfe=new gfe("","");mfe.locked=!0;let LV=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=n7.None,i=wp.None){if(e.type===0){const n=pT(e.resource),o=this.getUriComparisonKey(e.resource);this._pushElement(new _T(e,n,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,o=[],r=[];for(const a of e.resources){const l=pT(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),o.push(l),r.push(c))}o.length===1?this._pushElement(new _T(e,o[0],r[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new Nit(e,o,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],o=e.strResources[t];let r;this._editStacks.has(o)?r=this._editStacks.get(o):(r=new gfe(n,o),this._editStacks.set(o,r)),r.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const o of i){const r=pT(o.resource),a=this.getUriComparisonKey(o.resource),l=new _T(o,r,a,0,0,0,0);n.set(l.strResource,l)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const o of i){const r=pT(o.resource),a=this.getUriComparisonKey(o.resource),l=new _T(o,r,a,0,0,0,0);n.set(l.strResource,l)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new Zae(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestPastElement();r&&r.sourceId===e&&(!t||r.sourceOrder>t.sourceOrder)&&(t=r,i=n)}return[t,i]}canUndo(e){if(e instanceof wp){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){_t(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,o){const r=this._acquireLocks(i);let a;try{a=t()}catch(l){return r(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(r(),n.dispose(),o()),l=>(r(),n.dispose(),this._onError(l,e))):(r(),n.dispose(),o())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return K.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?K.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(K.None);const i=e.actual.prepareUndoRedo();return i?fv(i)?t(i):i.then(n=>t(n)):t(K.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||mfe);return new A3(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new bT(this._undo(e,0,!0));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(n),new bT}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,_(2032,"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,_(2033,"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&o.push(a.resourceLabel);if(o.length>0)return this._tryToSplitAndUndo(e,t,null,_(2034,"Could not undo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndUndo(e,t,null,_(2035,"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,_(2036,"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),o=this._checkWorkspaceUndo(e,t,n,!1);return o?o.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,n){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(d){d[d.All=0]="All",d[d.This=1]="This",d[d.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:xn.Info,message:_(2037,"Would you like to undo '{0}' across all files?",t.label),buttons:[{label:_(2038,"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:_(2039,"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;n=!0}let o;try{o=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const r=this._checkWorkspaceUndo(e,t,i,!0);if(r)return o.dispose(),r.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,o,()=>this._continueUndoInGroup(t.groupId,n))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=_(2040,"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new A3([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestPastElement();r&&r.groupId===e&&(!t||r.groupOrder>t.groupOrder)&&(t=r,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof wp){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),o=n.getClosestPastElement();if(!o)return;if(o.groupId){const[a,l]=this._findClosestUndoElementInGroup(o.groupId);if(o!==a&&l)return this._undo(l,t,i)}if((o.sourceId!==t||o.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,o);try{return o.type===1?this._workspaceUndo(e,o,i):this._resourceUndo(n,o,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:_(2041,"Would you like to undo '{0}'?",i.label),primaryButton:_(2042,"&&Yes"),cancelButton:_(2043,"No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestFutureElement();r&&r.sourceId===e&&(!t||r.sourceOrder<t.sourceOrder)&&(t=r,i=n)}return[t,i]}canRedo(e){if(e instanceof wp){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new bT(this._redo(e));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(n),new bT}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,_(2044,"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,_(2045,"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&o.push(a.resourceLabel);if(o.length>0)return this._tryToSplitAndRedo(e,t,null,_(2046,"Could not redo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndRedo(e,t,null,_(2047,"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,_(2048,"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let n;try{n=await this._invokeWorkspacePrepare(t)}catch(r){return this._onError(r,t)}const o=this._checkWorkspaceRedo(e,t,i,!0);if(o)return n.dispose(),o.returnValue;for(const r of i.editStacks)r.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=_(2049,"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new A3([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestFutureElement();r&&r.groupId===e&&(!t||r.groupOrder<t.groupOrder)&&(t=r,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof wp){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,o]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&o)return this._redo(o)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};LV=Tit([Cte(0,$k),Cte(1,Hn)],LV);class bT{constructor(e){this.returnValue=e}}Vt(z$,LV,1);var Rit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},P3=function(s,e){return function(t,i){e(t,i,s)}};let IV=class extends K{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new B6(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};IV=Rit([P3(0,Dn),P3(1,Ji),P3(2,Wn)],IV);Vt(z4,IV,1);function pfe(s){return typeof s=="string"?!1:Array.isArray(s)?s.every(pfe):!!s.exclusive}class Ste{constructor(e,t,i,n,o){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n,this.recursive=o}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)==null?void 0:t.toString())===((i=e.notebookUri)==null?void 0:i.toString())&&this.recursive===e.recursive}}class Sn{get onDidChange(){return this._onDidChange.event}constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new q}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Ve(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,n=>i.push(n.provider)),i}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,!1,o=>{i&&n===o._score?i.push(o.provider):(n=o._score,i=[o.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const n of this._entries)n._score>0&&i(n)}_updateScores(e,t){var o,r;const i=(o=this._notebookInfoResolver)==null?void 0:o.call(this,e.uri),n=i?new Ste(e.uri,e.getLanguageId(),i.uri,i.type,t):new Ste(e.uri,e.getLanguageId(),void 0,void 0,t);if(!((r=this._lastCandidate)!=null&&r.equals(n))){this._lastCandidate=n;for(const a of this._entries)if(a._score=Wj(a.selector,n.uri,n.languageId,zoe(e),n.notebookUri,n.notebookType),pfe(a.selector)&&a._score>0)if(t)a._score=0;else{for(const l of this._entries)l._score=0;a._score=1e3;break}this._entries.sort(Sn._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:OS(e.selector)&&!OS(t.selector)?1:!OS(e.selector)&&OS(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function OS(s){return typeof s=="string"?!1:Array.isArray(s)?s.some(OS):!!s.isBuiltin}class Mit{constructor(){this.referenceProvider=new Sn(this._score.bind(this)),this.renameProvider=new Sn(this._score.bind(this)),this.newSymbolNamesProvider=new Sn(this._score.bind(this)),this.codeActionProvider=new Sn(this._score.bind(this)),this.definitionProvider=new Sn(this._score.bind(this)),this.typeDefinitionProvider=new Sn(this._score.bind(this)),this.declarationProvider=new Sn(this._score.bind(this)),this.implementationProvider=new Sn(this._score.bind(this)),this.documentSymbolProvider=new Sn(this._score.bind(this)),this.inlayHintsProvider=new Sn(this._score.bind(this)),this.colorProvider=new Sn(this._score.bind(this)),this.codeLensProvider=new Sn(this._score.bind(this)),this.documentFormattingEditProvider=new Sn(this._score.bind(this)),this.documentRangeFormattingEditProvider=new Sn(this._score.bind(this)),this.onTypeFormattingEditProvider=new Sn(this._score.bind(this)),this.signatureHelpProvider=new Sn(this._score.bind(this)),this.hoverProvider=new Sn(this._score.bind(this)),this.documentHighlightProvider=new Sn(this._score.bind(this)),this.multiDocumentHighlightProvider=new Sn(this._score.bind(this)),this.selectionRangeProvider=new Sn(this._score.bind(this)),this.foldingRangeProvider=new Sn(this._score.bind(this)),this.linkProvider=new Sn(this._score.bind(this)),this.inlineCompletionsProvider=new Sn(this._score.bind(this)),this.completionProvider=new Sn(this._score.bind(this)),this.linkedEditingRangeProvider=new Sn(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new Sn(this._score.bind(this)),this.documentSemanticTokensProvider=new Sn(this._score.bind(this)),this.documentDropEditProvider=new Sn(this._score.bind(this)),this.documentPasteEditProvider=new Sn(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)==null?void 0:t.call(this,e)}}Vt(We,Mit,1);var Ait=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},vT=function(s,e){return function(t,i){e(t,i,s)}};const Td=we;let EV=class extends va{get _targetWindow(){return je(this._target.targetElements[0])}get _targetDocumentElement(){return je(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,n,o){var u,f,g,m,p,v,b,w,C,y,x;if(super(),this._keybindingService=t,this._configurationService=i,this._markdownRenderer=n,this._accessibilityService=o,this._messageListeners=new oe,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._maxHeightRatioRelativeToWindow=.5,this._onDispose=this._register(new q),this._onRequestLayout=this._register(new q),this._linkHandler=e.linkHandler,this._target="targetElements"in e.target?e.target:new Pit(e.target),e.style)switch(e.style){case 1:{e.appearance??(e.appearance={}),(u=e.appearance).compact??(u.compact=!0),(f=e.appearance).showPointer??(f.showPointer=!0);break}case 2:{e.appearance??(e.appearance={}),(g=e.appearance).compact??(g.compact=!0);break}}this._hoverPointer=(m=e.appearance)!=null&&m.showPointer?Td("div.workbench-hover-pointer"):void 0,this._hover=this._register(new Pq(!((p=e.appearance)!=null&&p.skipFadeInAnimation))),this._hover.containerDomNode.classList.add("workbench-hover"),(v=e.appearance)!=null&&v.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),(b=e.position)!=null&&b.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0);const r=(w=e.appearance)==null?void 0:w.maxHeightRatio;r!==void 0&&r>0&&r<=1&&(this._maxHeightRatioRelativeToWindow=r),this._hoverPosition=((C=e.position)==null?void 0:C.hoverPosition)===void 0?3:af(e.position.hoverPosition)?e.position.hoverPosition:2,this.onmousedown(this._hover.containerDomNode,S=>S.stopPropagation()),this.onkeydown(this._hover.containerDomNode,S=>{S.equals(9)&&this.dispose()}),this._register(ee(this._targetWindow,"blur",()=>this.dispose()));const a=Td("div.hover-row.markdown-hover"),l=Td("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(Bn(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const S=e.content,{element:L}=this._register(this._markdownRenderer.render(S,{actionHandler:this._linkHandler,asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}}));l.appendChild(L)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const S=Td("div.hover-row.status-bar"),L=Td("div.actions");e.actions.forEach(E=>{const M=this._keybindingService.lookupKeybinding(E.commandId),R=M?M.getLabel():null;this._register(C4.render(L,{label:E.label,commandId:E.commandId,run:T=>{E.run(T),this.dispose()},iconClass:E.iconClass},R))}),S.appendChild(L),this._hover.containerDomNode.appendChild(S)}this._hoverContainer=Td("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:((y=e.persistence)==null?void 0:y.hideOnHover)===void 0?c=typeof e.content=="string"||ef(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,(x=e.appearance)!=null&&x.showHoverHint){const S=Td("div.hover-row.status-bar"),L=Td("div.info");L.textContent=_(1699,"Hold {0} key to mouse over",Bt?"Option":"Alt"),S.appendChild(L),this._hover.containerDomNode.appendChild(S)}const d=[...this._target.targetElements];c||d.push(this._hoverContainer);const h=this._register(new xte(d));if(this._register(h.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const S=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new xte(S)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=h}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=wO(this._hoverContainer,Td("div")),n=me(this._hoverContainer,Td("div"));i.tabIndex=0,n.tabIndex=0,this._register(ee(n,"focus",o=>{e.focus(),o.preventDefault()})),this._register(ee(i,"focus",o=>{t.focus(),o.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const o=i;if(typeof o.tabIndex=="number"&&o.tabIndex>=0)return o}const n=this.findLastFocusableChild(i);if(n)return n}}render(e){var n;e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&dde(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(n=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))==null?void 0:n.getAriaLabel());i&&ld(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=d=>{const h=moe(d),u=d.getBoundingClientRect();return{top:u.top*h,bottom:u.bottom*h,right:u.right*h,left:u.left*h}},t=this._target.targetElements.map(d=>e(d)),{top:i,right:n,bottom:o,left:r}=t[0],a=n-r,l=o-i,c={top:i,right:n,bottom:o,left:r,width:a,height:l,center:{x:r+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.offsetHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight*this._maxHeightRatioRelativeToWindow;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const n=this._x+i;(n<e.left||n>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){var e,t;this._isDisposed||(this._onDispose.fire(),(t=(e=this._target).dispose)==null||t.call(e),this._hoverContainer.remove(),this._messageListeners.dispose(),super.dispose()),this._isDisposed=!0}};EV=Ait([vT(1,ai),vT(2,xt),vT(3,Sc),vT(4,so)],EV);class xte extends va{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e,t=200){super(),this._elements=e,this._eventDebounceDelay=t,this._isMouseIn=!0,this._mouseTimer=this._register(new mi),this._onMouseOut=this._register(new q);for(const i of this._elements)this.onmouseover(i,()=>this._onTargetMouseOver()),this.onmouseleave(i,()=>this._onTargetMouseLeave())}_onTargetMouseOver(){this._isMouseIn=!0,this._mouseTimer.clear()}_onTargetMouseLeave(){this._isMouseIn=!1,this._mouseTimer.value=new ha(()=>this._fireIfMouseOutside(),this._eventDebounceDelay)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class Pit{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}function Oit(s){const e=s;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var Ag;(function(s){s[s.AVOID=0]="AVOID",s[s.ALIGN=1]="ALIGN"})(Ag||(Ag={}));function $C(s,e,t){const i=t.mode===Ag.ALIGN?t.offset:t.offset+t.size,n=t.mode===Ag.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=s-i?i:e<=n?n-e:Math.max(s-e,0):e<=n?n-e:e<=s-i?i:0}const a1=class a1 extends K{constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=K.None,this.toDisposeOnSetContainer=K.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=we(".context-view"),hr(this.view),this.setContainer(e,t),this._register(Ve(()=>this.setContainer(null,1)))}setContainer(e,t){var n;this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,(n=this.shadowRootHostElement)==null||n.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=we(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const r=document.createElement("style");r.textContent=Fit,this.shadowRoot.appendChild(r),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(we("slot"))}else this.container.appendChild(this.view);const o=new oe;a1.BUBBLE_UP_EVENTS.forEach(r=>{o.add(Jn(this.container,r,a=>{this.onDOMEvent(a,!1)}))}),a1.BUBBLE_DOWN_EVENTS.forEach(r=>{o.add(Jn(this.container,r,a=>{this.onDOMEvent(a,!0)},!0))}),this.toDisposeOnSetContainer=o}}show(e){var t,i;this.isVisible()&&this.hide(),io(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",ta(this.view),this.toDisposeOnClean=e.render(this.view)||K.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)==null||i.call(t)}getViewElement(){return this.view}layout(){var e,t;if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Al&&rk.pointerEvents)){this.hide();return}(t=(e=this.delegate)==null?void 0:e.layout)==null||t.call(e),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(Bn(e)){const g=Fn(e),m=moe(e);t={top:g.top*m,left:g.left*m,width:g.width*m,height:g.height*m}}else Oit(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=Jr(this.view),n=Mu(this.view),o=this.delegate.anchorPosition??0,r=this.delegate.anchorAlignment??0,a=this.delegate.anchorAxisAlignment??0;let l,c;const d=xi();if(a===0){const g={offset:t.top-d.pageYOffset,size:t.height,position:o===0?0:1},m={offset:t.left,size:t.width,position:r===0?0:1,mode:Ag.ALIGN};l=$C(d.innerHeight,n,g)+d.pageYOffset,Io.intersects({start:l,end:l+n},{start:g.offset,end:g.offset+g.size})&&(m.mode=Ag.AVOID),c=$C(d.innerWidth,i,m)}else{const g={offset:t.left,size:t.width,position:r===0?0:1},m={offset:t.top,size:t.height,position:o===0?0:1,mode:Ag.ALIGN};c=$C(d.innerWidth,i,g),Io.intersects({start:c,end:c+i},{start:g.offset,end:g.offset+g.size})&&(m.mode=Ag.AVOID),l=$C(d.innerHeight,n,m)+d.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(o===0?"bottom":"top"),this.view.classList.add(r===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const h=Fn(this.container),u=this.container.scrollTop||0,f=this.container.scrollLeft||0;this.view.style.top=`${l-(this.useFixedPosition?Fn(this.view).top:h.top)+u}px`,this.view.style.left=`${c-(this.useFixedPosition?Fn(this.view).left:h.left)+f}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),hr(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,je(e).document.activeElement):t&&!Ps(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}};a1.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],a1.BUBBLE_DOWN_EVENTS=["click"];let kV=a1;const Fit=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Nanum Gothic", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var Bit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Wit=function(s,e){return function(t,i){e(t,i,s)}};let UM=class extends K{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new kV(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let n;t?t===this.layoutService.getContainer(je(t))?n=1:i?n=3:n=2:n=1,this.contextView.setContainer(t??this.layoutService.activeContainer,n),this.contextView.show(e);const o={close:()=>{this.openContextView===o&&this.hideContextView()}};return this.openContextView=o,o}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};UM=Bit([Wit(0,Bh)],UM);class Hit extends UM{getContextViewElement(){return this.contextView.getViewElement()}}function _fe(s){const e=s;return typeof e=="object"&&"markdown"in e&&"markdownNotSupportedFallback"in e}class Vit{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(As(e)||Bn(e)||e===void 0)n=e;else{this._cancellationTokenSource=new hn;const o=this._cancellationTokenSource.token;let r;if(_fe(e)?kb(e.markdown)?r=e.markdown(o).then(a=>a??e.markdownNotSupportedFallback):r=e.markdown??e.markdownNotSupportedFallback:r=e.element(o),r instanceof Promise?(this._hoverWidget||this.show(_(1700,"Loading..."),t,i),n=await r):n=r,this.isDisposed||o.isCancellationRequested)return}this.show(n,t,i)}show(e,t,i){var o;const n=this._hoverWidget;if(this.hasContent(e)){const r={content:e,target:this.target,actions:i==null?void 0:i.actions,linkHandler:i==null?void 0:i.linkHandler,trapFocus:i==null?void 0:i.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!n,showHoverHint:(o=i==null?void 0:i.appearance)==null?void 0:o.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(r,t)}n==null||n.dispose()}hasContent(e){return e?ef(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)==null?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)==null||e.dispose(),(t=this._cancellationTokenSource)==null||t.dispose(!0),this._cancellationTokenSource=void 0}}var zit=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},dC=function(s,e){return function(t,i){e(t,i,s)}};let DV=class extends K{constructor(e,t,i,n,o,r){super(),this._instantiationService=e,this._configurationService=t,this._keybindingService=n,this._layoutService=o,this._accessibilityService=r,this._currentDelayedHoverWasShown=!1,this._delayedHovers=new Map,this._managedHovers=new Map,this._register(i.onDidShowContextMenu(()=>this.hideHover())),this._contextViewHandler=this._register(new UM(this._layoutService)),this._register(Ks.registerCommandAndKeybindingRule({id:"workbench.action.showHover",weight:0,primary:ls(2089,2087),handler:()=>{this._showAndFocusHoverForActiveElement()}}))}showInstantHover(e,t,i,n){const o=this._createHover(e,i);if(o)return this._showHover(o,e,t),o}showDelayedHover(e,t){var n;if(e.id===void 0&&(e.id=Lte(e.content)),!this._currentDelayedHover||this._currentDelayedHoverWasShown){if((n=this._currentHover)!=null&&n.isLocked)return;if(zf(this._currentHoverOptions)===zf(e))return this._currentHover;if(this._currentHover&&!this._currentHover.isDisposed&&this._currentDelayedHoverGroupId!==void 0&&this._currentDelayedHoverGroupId===(t==null?void 0:t.groupId))return this.showInstantHover({...e,appearance:{...e.appearance,skipFadeInAnimation:!0}})}else if(this._currentDelayedHover&&zf(this._currentHoverOptions)===zf(e))return this._currentDelayedHover;const i=this._createHover(e,void 0);if(!i){this._currentDelayedHover=void 0,this._currentDelayedHoverWasShown=!1,this._currentDelayedHoverGroupId=void 0;return}return this._currentDelayedHover=i,this._currentDelayedHoverWasShown=!1,this._currentDelayedHoverGroupId=t==null?void 0:t.groupId,Sh(this._configurationService.getValue("workbench.hover.delay")).then(()=>{i&&!i.isDisposed&&(this._currentDelayedHoverWasShown=!0,this._showHover(i,e))}),i}setupDelayedHover(e,t,i){const n=()=>({...typeof t=="function"?t():t,target:e});return this._setupDelayedHover(e,n,i)}setupDelayedHoverAtMouse(e,t,i){const n=o=>({...typeof t=="function"?t():t,target:{targetElements:[e],x:o!==void 0?o.x+10:void 0}});return this._setupDelayedHover(e,n,i)}_setupDelayedHover(e,t,i){const n=new oe;return n.add(ee(e,ye.MOUSE_OVER,o=>{this.showDelayedHover(t(o),{groupId:i==null?void 0:i.groupId})})),i!=null&&i.setupKeyboardEvents&&n.add(ee(e,ye.KEY_DOWN,o=>{const r=new Bi(o);(r.equals(10)||r.equals(3))&&this.showInstantHover(t(),!0)})),this._delayedHovers.set(e,{show:o=>{this.showInstantHover(t(),o)}}),n.add(Ve(()=>this._delayedHovers.delete(e))),n}_createHover(e,t){var a,l,c,d;if(this._currentDelayedHover=void 0,e.content===""||(a=this._currentHover)!=null&&a.isLocked||(e.id===void 0&&(e.id=Lte(e.content)),zf(this._currentHoverOptions)===zf(e)))return;this._currentHoverOptions=e,this._lastHoverOptions=e;const i=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),n=Ss();t||(i&&n?n.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=n):this._lastFocusedElementBeforeOpen=void 0);const o=new oe,r=this._instantiationService.createInstance(EV,e);if((l=e.persistence)!=null&&l.sticky&&(r.isLocked=!0),(c=e.position)!=null&&c.hoverPosition&&!af(e.position.hoverPosition)&&(e.target={targetElements:Bn(e.target)?[e.target]:e.target.targetElements,x:e.position.hoverPosition.x+10}),r.onDispose(()=>{var u,f;((u=this._currentHover)==null?void 0:u.domNode)&&_oe(this._currentHover.domNode)&&((f=this._lastFocusedElementBeforeOpen)==null||f.focus()),zf(this._currentHoverOptions)===zf(e)&&this.doHideHover(),o.dispose()},void 0,o),!e.container){const h=Bn(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(je(h))}if(r.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,o),(d=e.persistence)!=null&&d.sticky)o.add(ee(je(e.container).document,ye.MOUSE_DOWN,h=>{Ps(h.target,r.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const u of e.target.targetElements)o.add(ee(u,ye.CLICK,()=>this.hideHover()));else o.add(ee(e.target,ye.CLICK,()=>this.hideHover()));const h=Ss();if(h){const u=je(h).document;o.add(ee(h,ye.KEY_DOWN,f=>{var g;return this._keyDown(f,r,!!((g=e.persistence)!=null&&g.hideOnKeyDown))})),o.add(ee(u,ye.KEY_DOWN,f=>{var g;return this._keyDown(f,r,!!((g=e.persistence)!=null&&g.hideOnKeyDown))})),o.add(ee(h,ye.KEY_UP,f=>this._keyUp(f,r))),o.add(ee(u,ye.KEY_UP,f=>this._keyUp(f,r)))}}if("IntersectionObserver"in Ti){const h=new IntersectionObserver(f=>this._intersectionChange(f,r),{threshold:0}),u="targetElements"in e.target?e.target.targetElements[0]:e.target;h.observe(u),o.add(Ve(()=>h.disconnect()))}return this._currentHover=r,r}_showHover(e,t,i){this._contextViewHandler.showContextView(new $it(e,i),t.container)}hideHover(e){var t;!e&&((t=this._currentHover)!=null&&t.isLocked)||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showInstantHover(this._lastHoverOptions,!0,!0)}_showAndFocusHoverForActiveElement(){let e=Ss();for(;e;){const t=this._delayedHovers.get(e)??this._managedHovers.get(e);if(t){t.show(!0);return}e=e.parentElement}}_keyDown(e,t,i){var r,a;if(e.key==="Alt"){t.isLocked=!0;return}const n=new Bi(e);this._keybindingService.resolveKeyboardEvent(n).getSingleModifierDispatchChords().some(l=>!!l)||this._keybindingService.softDispatch(n,n.target).kind!==0||i&&(!((r=this._currentHoverOptions)!=null&&r.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(a=this._lastFocusedElementBeforeOpen)==null||a.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}setupManagedHover(e,t,i,n){if(e.showNativeHover)return Uit(t,i);t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let o,r;const a=(f,g)=>{var p;const m=r!==void 0;f&&(r==null||r.dispose(),r=void 0),g&&(o==null||o.dispose(),o=void 0),m&&((p=e.onDidHideHover)==null||p.call(e),r=void 0)},l=(f,g,m,p)=>new ha(async()=>{(!r||r.isDisposed)&&(r=new Vit(e,m||t,f>0),await r.update(typeof i=="function"?i():i,g,{...n,trapFocus:p}))},f),c=new oe;let d=!1;c.add(ee(t,ye.MOUSE_DOWN,()=>{d=!0,a(!0,!0)},!0)),c.add(ee(t,ye.MOUSE_UP,()=>{d=!1},!0)),c.add(ee(t,ye.MOUSE_LEAVE,f=>{d=!1,a(!1,f.fromElement===t)},!0)),c.add(ee(t,ye.MOUSE_OVER,f=>{if(o)return;const g=new oe,m={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const p=v=>{m.x=v.x+10,O3(v,t)||a(!0,!0)};g.add(ee(t,ye.MOUSE_MOVE,p,!0))}o=g,O3(f,t)&&g.add(l(typeof e.delay=="function"?e.delay(i):e.delay,!1,m))},!0));const h=f=>{if(d||o||!O3(f,t))return;const g={targetElements:[t],dispose:()=>{}},m=new oe,p=()=>a(!0,!0);m.add(ee(t,ye.BLUR,p,!0)),m.add(l(typeof e.delay=="function"?e.delay(i):e.delay,!1,g)),o=m};nd(t)||c.add(ee(t,ye.FOCUS,h,!0));const u={show:f=>{a(!1,!0),l(0,f,void 0,f)},hide:()=>{a(!0,!0)},update:async(f,g)=>{i=f,await(r==null?void 0:r.update(i,void 0,g))},dispose:()=>{this._managedHovers.delete(t),c.dispose(),a(!0,!0)}};return this._managedHovers.set(t,u),u}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};DV=zit([dC(0,$e),dC(1,xt),dC(2,sl),dC(3,ai),dC(4,Bh),dC(5,so)],DV);function zf(s){if(s!==void 0)return(s==null?void 0:s.id)??s}function Lte(s){if(!Bn(s))return typeof s=="string"?s.toString():s.value}function Ite(s){const e=typeof s=="function"?s():s;if(As(e))return J$(e);if(_fe(e))return e.markdownNotSupportedFallback}function Uit(s,e){function t(i){i?s.setAttribute("title",i):s.removeAttribute("title")}return t(Ite(e)),{update:i=>t(Ite(i)),show:()=>{},hide:()=>{},dispose:()=>t(void 0)}}class $it{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function O3(s,e){return Bn(s.target)&&qit(s.target,e)===e}function qit(s,e){for(e=e??je(s).document.body;!s.hasAttribute("custom-hover")&&s!==e;)s=s.parentElement;return s}Vt(Sr,DV,1);Ul((s,e)=>{const t=s.getColor(r$);t&&(e.addRule(`.monaco-hover.workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-hover.workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});function CT(s){return Object.isFrozen(s)?s:ZNe(s)}class eo{static createEmptyModel(e){return new eo({},[],[],void 0,e)}constructor(e,t,i,n,o){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=o,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw){const e=(Array.isArray(this.raw)?this.raw:[this.raw]).map(t=>{if(t instanceof eo)return t;const i=new jit("",this.logService);return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?yY(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return CT(i.rawConfiguration.getValue(e))},get override(){return t?CT(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return CT(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:o,identifiers:r,keys:a}of i.rawConfiguration.overrides){const l=new eo(o,a,[],void 0,i.logService).getValue(e);l!==void 0&&n.push({identifiers:r,value:l})}return n.length?CT(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?yY(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=Xd(this.contents),i=Xd(this.overrides),n=[...this.keys],o=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(const r of e)if(o.push(...r.raw?Array.isArray(r.raw)?r.raw:[r.raw]:[r]),!r.isEmpty()){this.mergeContents(t,r.contents);for(const a of r.overrides){const[l]=i.filter(c=>dn(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=uf(l.keys)):i.push(Xd(a))}for(const a of r.keys)n.indexOf(a)===-1&&n.push(a)}return new eo(t,n,i,!o.length||o.every(r=>r instanceof eo)?void 0:o,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of uf([...Object.keys(this.contents),...Object.keys(t)])){let o=this.contents[n];const r=t[n];r&&(typeof o=="object"&&typeof r=="object"?(o=Xd(o),this.mergeContents(o,r)):o=r),i[n]=o}return new eo(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&ws(e[i])&&ws(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=Xd(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=o=>{o&&(i?this.mergeContents(i,o):i=Xd(o))};for(const o of this.overrides)o.identifiers.length===1&&o.identifiers[0]===e?t=o.contents:o.identifiers.includes(e)&&n(o.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),pRe(this.contents,e),_m.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>dn(i.identifiers,aR(e))),1))}updateValue(e,t,i){if(Goe(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),_m.test(e)){const n=aR(e),o={identifiers:n,keys:Object.keys(this.contents[e]),contents:eB(this.contents[e],a=>this.logService.error(a))},r=this.overrides.findIndex(a=>dn(a.identifiers,n));r!==-1?this.overrides[r]=o:this.overrides.push(o)}}}class jit{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||eo.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:o,restricted:r,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new eo(i,n,o,a?[e]:void 0,this.logService),this._restrictedConfigurations=r||[]}doParseRaw(e,t){const i=kn.as(vd.Configuration),n=i.getConfigurationProperties(),o=i.getExcludedConfigurationProperties(),r=this.filter(e,n,o,!0,t);e=r.raw;const a=eB(e,d=>this.logService.error(`Conflict in settings file ${this._name}: ${d}`)),l=Object.keys(e),c=this.toOverrides(e,d=>this.logService.error(`Conflict in settings file ${this._name}: ${d}`));return{contents:a,keys:l,overrides:c,restricted:r.restricted,hasExcludedProperties:r.hasExcludedProperties}}filter(e,t,i,n,o){var c;let r=!1;if(!(o!=null&&o.scopes)&&!(o!=null&&o.skipRestricted)&&!(o!=null&&o.skipUnregistered)&&!((c=o==null?void 0:o.exclude)!=null&&c.length))return{raw:e,restricted:[],hasExcludedProperties:r};const a={},l=[];for(const d in e)if(_m.test(d)&&n){const h=this.filter(e[d],t,i,!1,o);a[d]=h.raw,r=r||h.hasExcludedProperties,l.push(...h.restricted)}else{const h=t[d];h!=null&&h.restricted&&l.push(d),this.shouldInclude(d,h,i,o)?a[d]=e[d]:r=!0}return{raw:a,restricted:l,hasExcludedProperties:r}}shouldInclude(e,t,i,n){var a,l;if((a=n.exclude)!=null&&a.includes(e))return!1;if((l=n.include)!=null&&l.includes(e))return!0;if(n.skipRestricted&&(t!=null&&t.restricted)||n.skipUnregistered&&!t)return!1;const o=t??i[e],r=o?typeof o.scope<"u"?o.scope:4:void 0;return r===void 0||n.scopes===void 0?!0:n.scopes.includes(r)}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(_m.test(n)){const o={};for(const r in e[n])o[r]=e[n][r];i.push({identifiers:aR(n),keys:Object.keys(o),contents:eB(o,t)})}return i}}class Kit{constructor(e,t,i,n,o,r,a,l,c,d,h,u,f){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=o,this.policyConfiguration=r,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=d,this.workspaceConfiguration=h,this.folderConfigurationModel=u,this.memoryConfigurationModel=f}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class K4{constructor(e,t,i,n,o,r,a,l,c,d){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=o,this._workspaceConfiguration=r,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=d,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new ts,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=eo.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),o=this.getFolderConfigurationModelForResource(t.resource,i),r=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(e,c)!==void 0&&a.add(c);return new Kit(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,o||void 0,r)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration)if(this._remoteUserConfiguration.isEmpty())this._userConfiguration=this._localUserConfiguration;else{const e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new eo(e.contents,e.keys,e.overrides,void 0,this.logService)}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);if(t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){n=n.merge();for(const o of this._policyConfiguration.keys)n.setValue(o,this._policyConfiguration.getValue(o))}return n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const o=this._memoryConfigurationByResource.get(e);o&&(i=i.merge(o))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:o}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:o}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),o=this.parseConfigurationModel(e.application,t),r=this.parseConfigurationModel(e.userLocal,t),a=this.parseConfigurationModel(e.userRemote,t),l=this.parseConfigurationModel(e.workspace,t),c=e.folders.reduce((d,h)=>(d.set(Ze.revive(h[0]),this.parseConfigurationModel(h[1],t)),d),new ts);return new K4(i,n,o,r,a,l,c,eo.createEmptyModel(t),new ts,t)}static parseConfigurationModel(e,t){return new eo(e.contents,e.keys,e.overrides,e.raw,t)}}class Git{constructor(e,t,i,n,o){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=o,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const r of e.keys)this.affectedKeys.add(r);for(const[,r]of e.overrides)for(const a of r)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const r of this.affectedKeys)this._affectsConfigStr+=r+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=K4.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const o=n+i.length;if(o>=this._affectsConfigStr.length)return!1;const r=this._affectsConfigStr.charCodeAt(o);if(r!==this._markerCode1&&r!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!la(l,c)}return!0}}const $M={kind:0},Yit={kind:1};function Xit(s,e,t){return{kind:2,commandId:s,commandArgs:e,isBubble:t}}class Tx{constructor(e,t,i){var n;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const o of e){const r=o.command;r&&r.charAt(0)!=="-"&&this._defaultBoundCommands.set(r,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Tx.handleRemovals([].concat(e).concat(t));for(let o=0,r=this._keybindings.length;o<r;o++){const a=this._keybindings[o];if(a.chords.length===0)continue;const l=(n=a.when)==null?void 0:n.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let n=0;n<t.length;n++)if(t[n]!==e.chords[n])return!1}return!(i&&i.type!==1&&(!e.when||!uNe(i,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,o=e.length;n<o;n++){const r=e[n];if(r.command&&r.command.charAt(0)==="-"){const a=r.command.substring(1);t.has(a)?t.get(a).push(r):t.set(a,[r])}}if(t.size===0)return e;const i=[];for(let n=0,o=e.length;n<o;n++){const r=e[n];if(!r.command||r.command.length===0){i.push(r);continue}if(r.command.charAt(0)==="-")continue;const a=t.get(r.command);if(!a||!r.isDefault){i.push(r);continue}let l=!1;for(const c of a){const d=c.when;if(this._isTargetedForRemoval(r,c.chords,d)){l=!0;break}}if(!l){i.push(r);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const o=i[n];if(o.command===t.command)continue;let r=!0;for(let a=1;a<o.chords.length&&a<t.chords.length;a++)if(o.chords[a]!==t.chords[a]){r=!1;break}r&&Tx.whenIsEntirelyIncluded(o.when,t.when)&&this._removeFromLookupMap(o)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:G9(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t,i=!1){const n=this._lookupMap.get(e);if(typeof n>"u"||n.length===0)return null;if(n.length===1&&!i)return n[0];for(let o=n.length-1;o>=0;o--){const r=n[o];if(t.contextMatchesRules(r.when))return r}return i?null:n[n.length-1]}resolve(e,t,i){const n=[...t,i];this._log(`| Resolving ${n}`);const o=this._map.get(n[0]);if(o===void 0)return this._log("\\ No keybinding entries."),$M;let r=null;if(n.length<2)r=o;else{r=[];for(let l=0,c=o.length;l<c;l++){const d=o[l];if(n.length>d.chords.length)continue;let h=!0;for(let u=1;u<n.length;u++)if(d.chords[u]!==n[u]){h=!1;break}h&&r.push(d)}}const a=this._findCommand(e,r);return a?n.length<a.chords.length?(this._log(`\\ From ${r.length} keybinding entries, awaiting ${a.chords.length-n.length} more chord(s), when: ${Ete(a.when)}, source: ${kte(a)}.`),Yit):(this._log(`\\ From ${r.length} keybinding entries, matched ${a.command}, when: ${Ete(a.when)}, source: ${kte(a)}.`),Xit(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${r.length} keybinding entries, no when clauses matched the context.`),$M)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(Tx._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function Ete(s){return s?`${s.serialize()}`:"no when condition"}function kte(s){return s.extensionId?s.isBuiltinExtension?`built-in extension ${s.extensionId}`:`user extension ${s.extensionId}`:s.isDefault?"built-in":"user"}const Zit=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class Qit extends K{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Se.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,n,o){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=o,this._onDidUpdateKeybindings=this._register(new q),this._currentChords=[],this._currentChordChecker=new _U,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=qC.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new ha,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t,i=!1){const n=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService,i);if(n)return n.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),$M;const[n]=i.getDispatchChords();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),$M;const o=this._contextKeyService.getContext(t),r=this._currentChords.map((({keypress:a})=>a));return this._getResolver().resolve(o,r,n)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw WN("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(_(1701,"({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:n})=>n).join(", ");this._currentChordStatusMessage=this._notificationService.status(_(1702,"({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),_h.enabled&&_h.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.close(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],_h.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchChords();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=qC.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=qC.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[o]=i.getChords();return this._ignoreSingleModifiers=new qC(o),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let o=null,r=null;if(i){const[d]=e.getSingleModifierDispatchChords();o=d,r=d?[d]:[]}else[o]=e.getDispatchChords(),r=this._currentChords.map(({keypress:d})=>d);if(o===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,r,o);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(_(1703,"The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}return n}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(o,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(_(1704,"The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,d=>this._notificationService.warn(d)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,d=>this._notificationService.warn(d))}finally{this._currentlyDispatchingCommandId=null}Zit.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return n}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}const PP=class PP{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}};PP.EMPTY=new PP(null);let qC=PP;class Dte{constructor(e,t,i,n,o,r,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?TV(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=TV(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=o,this.extensionId=r,this.isBuiltinExtension=a}}function TV(s){const e=[];for(let t=0,i=s.length;t<i;t++){const n=s[t];if(!n)return[];e.push(n)}return e}class Jit extends Ake{constructor(e,t){if(super(),t.length===0)throw kl("chords");this._os=e,this._chords=t}getLabel(){return pq.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return f6e.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:g6e.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return m6e.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new Mke(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class XI extends Jit{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return Su.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":Su.toString(e.keyCode)}_getElectronAccelerator(e){return Su.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=Su.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return XI.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Su.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=gU[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof lf)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new lf(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=TV(e.chords.map(n=>this._toKeyCodeChord(n)));return i.length>0?[new XI(i,t)]:[]}}let Xw=[],Gj=[],bfe=[];function wT(s,e=!1){ent(s,!1,e)}function ent(s,e,t){const i=tnt(s,e);Xw.push(i),i.userConfigured?bfe.push(i):Gj.push(i),t&&!i.userConfigured&&Xw.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function tnt(s,e){return{id:s.id,mime:s.mime,filename:s.filename,extension:s.extension,filepattern:s.filepattern,firstline:s.firstline,userConfigured:e,filenameLowercase:s.filename?s.filename.toLowerCase():void 0,extensionLowercase:s.extension?s.extension.toLowerCase():void 0,filepatternLowercase:s.filepattern?Vue(s.filepattern.toLowerCase()):void 0,filepatternOnPath:s.filepattern?s.filepattern.indexOf(hs.sep)>=0:!1}}function int(){Xw=Xw.filter(s=>s.userConfigured),Gj=[]}function nnt(s,e){return snt(s,e).map(t=>t.id)}function snt(s,e){let t;if(s)switch(s.scheme){case ct.file:t=s.fsPath;break;case ct.data:{t=mm.parseMetaData(s).get(mm.META_DATA_LABEL);break}case ct.vscodeNotebookCell:t=void 0;break;default:t=s.path}if(!t)return[{id:"unknown",mime:Un.unknown}];t=t.toLowerCase();const i=Xu(t),n=Tte(t,i,bfe);if(n)return[n,{id:Za,mime:Un.text}];const o=Tte(t,i,Gj);if(o)return[o,{id:Za,mime:Un.text}];if(e){const r=ont(e);if(r)return[r,{id:Za,mime:Un.text}]}return[{id:"unknown",mime:Un.unknown}]}function Tte(s,e,t){var r;let i,n,o;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){i=l;break}if(l.filepattern&&(!n||l.filepattern.length>n.filepattern.length)){const c=l.filepatternOnPath?s:e;(r=l.filepatternLowercase)!=null&&r.call(l,c)&&(n=l)}l.extension&&(!o||l.extension.length>o.extension.length)&&e.endsWith(l.extensionLowercase)&&(o=l)}if(i)return i;if(n)return n;if(o)return o}function ont(s){if(LU(s)&&(s=s.substr(1)),s.length>0)for(let e=Xw.length-1;e>=0;e--){const t=Xw[e];if(!t.firstline)continue;const i=s.match(t.firstline);if(i&&i.length>0)return t}}const yT=Object.prototype.hasOwnProperty,Nte="vs.editor.nullLanguage";class rnt{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(Nte,0),this._register(Za,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||Nte}}const Qx=class Qx extends K{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new q),this.onDidChange=this._onDidChange.event,Qx.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new rnt,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(Cw.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){Qx.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},int();const e=[].concat(Cw.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),kn.as(vd.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;yT.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)wT({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)wT({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)wT({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);Wse(l)||wT({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let o=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?o=[null]:o=t.aliases),o!==null)for(const a of o)!a||a.length===0||e.aliases.push(a);const r=o!==null&&o.length>0;if(!(r&&o[0]===null)){const a=(r?o[0]:null)||i;(r||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?yT.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return yT.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&yT.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:nnt(e,t)}};Qx.instanceCount=0;let NV=Qx;const Jx=class Jx extends K{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new q),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new q),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new q({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,Jx.instanceCount++,this._registry=this._register(new NV(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){Jx.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){return this._registry.guessLanguageIdByFilepathOrFirstLine(e,t).at(0)??null}createById(e){return new Rte(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new Rte(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=Za),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),An.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}};Jx.instanceCount=0;let RV=Jx;class Rte{constructor(e,t){this._value=fi(this,e,()=>t()),this.onDidChange=Se.fromObservable(this._value)}get languageId(){return this._value.get()}}const MV=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,F3=/(&amp;)?(&amp;)([^\s&])/g;var qM;(function(s){s[s.Right=0]="Right",s[s.Left=1]="Left"})(qM||(qM={}));var AV;(function(s){s[s.Above=0]="Above",s[s.Below=1]="Below"})(AV||(AV={}));class B1 extends Fr{constructor(e,t,i,n){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const o=document.createElement("div");o.classList.add("monaco-menu"),o.setAttribute("role","presentation"),super(o,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,r),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...Bt||Hr?[10]:[]],keyDown:!0}}),this.menuStyles=n,this.menuElement=o,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,n),this._register(Oo.addTarget(o)),this._register(ee(o,ye.KEY_DOWN,c=>{new Bi(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(ee(o,ye.KEY_DOWN,c=>{const d=c.key.toLocaleLowerCase();if(this.mnemonics.has(d)){ri.stop(c,!0);const h=this.mnemonics.get(d);if(h.length===1&&(h[0]instanceof Mte&&h[0].container&&this.focusItemByElement(h[0].container),h[0].onClick(c)),h.length>1){const u=h.shift();u&&u.container&&(this.focusItemByElement(u.container),h.push(u)),this.mnemonics.set(d,h)}}})),Hr&&this._register(ee(o,ye.KEY_DOWN,c=>{const d=new Bi(c);d.equals(14)||d.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),ri.stop(c,!0)):(d.equals(13)||d.equals(12))&&(this.focusedItem=0,this.focusPrevious(),ri.stop(c,!0))})),this._register(ee(this.domNode,ye.MOUSE_OUT,c=>{const d=c.relatedTarget;Ps(d,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(ee(this.actionsList,ye.MOUSE_OVER,c=>{let d=c.target;if(!(!d||!Ps(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}})),this._register(Oo.addTarget(this.actionsList)),this._register(ee(this.actionsList,Qi.Tap,c=>{let d=c.initialTarget;if(!(!d||!Ps(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}}));const r={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new vk(o,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,n),this._register(ee(o,Qi.Change,c=>{ri.stop(c,!0);const d=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:d-c.translationY})})),this._register(ee(a,ye.MOUSE_UP,c=>{c.preventDefault()}));const l=je(e);o.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,d)=>{var h;return(h=i.submenuIds)!=null&&h.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof _s&&(d===t.length-1||d===0||t[d-1]instanceof _s))}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof Ate)).forEach((c,d,h)=>{c.updatePositionInSet(d+1,h.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(QN(e)?this.styleSheet=Hl(e):(B1.globalStyleSheet||(B1.globalStyleSheet=Hl()),this.styleSheet=B1.globalStyleSheet)),this.styleSheet.textContent=lnt(t,QN(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",n=t.backgroundColor??"",o=t.borderColor?`1px solid ${t.borderColor}`:"",r="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=o,e.style.borderRadius=r,e.style.color=i,e.style.backgroundColor=n,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){var n,o;if(e instanceof _s)return new Ate(t.context,e,{icon:!0},this.menuStyles);if(e instanceof vw){const r=new Mte(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const a=r.getMnemonic();if(a&&r.isEnabled()){let l=[];this.mnemonics.has(a)&&(l=this.mnemonics.get(a)),l.push(r),this.mnemonics.set(a,l)}}return r}else{const r=(o=(n=t.getKeyBinding)==null?void 0:n.call(t,e))==null?void 0:o.getLabel(),a={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext,keybinding:r},l=new vfe(t.context,e,a,this.menuStyles);if(t.enableMnemonics){const c=l.getMnemonic();if(c&&l.isEnabled()){let d=[];this.mnemonics.has(c)&&(d=this.mnemonics.get(c)),d.push(l),this.mnemonics.set(c,d)}}return l}}}class vfe extends qc{constructor(e,t,i,n){if(i={...i,isMenu:!0,icon:i.icon!==void 0?i.icon:!1,label:i.label!==void 0?i.label:!0},super(t,t,i),this.menuStyle=n,this.options=i,this.cssClass="",this.options.label&&i.enableMnemonics){const o=this.action.label;if(o){const r=MV.exec(o);r&&(this.mnemonic=(r[1]?r[1]:r[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Ni(()=>{this.element&&(this._register(ee(this.element,ye.MOUSE_UP,o=>{if(ri.stop(o,!0),Wr){if(new Co(je(this.element),o).rightButton)return;this.onClick(o)}else setTimeout(()=>{this.onClick(o)},0)})),this._register(ee(this.element,ye.CONTEXT_MENU,o=>{ri.stop(o,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=me(this.element,we("a.action-menu-item")),this._action.id===_s.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=me(this.item,we("span.menu-item-check"+it.asCSSSelector(ge.menuSelection))),this.check.setAttribute("role","none"),this.label=me(this.item,we("span.action-label")),this.options.label&&this.options.keybinding&&(me(this.item,we("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)==null||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){io(this.label);let t=J$(this.action.label);if(t){const i=ant(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const n=MV.exec(t);if(n){t=hc(t),F3.lastIndex=0;let o=F3.exec(t);for(;o&&o[1];)o=F3.exec(t);const r=a=>a.replace(/&amp;&amp;/g,"&amp;");o?this.label.append(lk(r(t.substr(0,o.index))," "),we("u",{"aria-hidden":"true"},o[3]),Fse(r(t.substr(o.index+o[0].length))," ")):this.label.textContent=r(t).trim(),(e=this.item)==null||e.setAttribute("aria-keyshortcuts",(n[1]?n[1]:n[3]).toLocaleLowerCase())}else this.label.textContent=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",o=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=n,this.item.style.outlineOffset=o),this.check&&(this.check.style.color=t??"")}}class Mte extends vfe{constructor(e,t,i,n,o){super(e,e,n,o),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new oe),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:{horizontal:qM.Right,vertical:AV.Below},this.showScheduler=new Ni(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Ni(()=>{this.element&&!Ps(Ss(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=me(this.item,we("span.submenu-indicator"+it.asCSSSelector(ge.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(ee(this.element,ye.KEY_UP,t=>{const i=new Bi(t);(i.equals(17)||i.equals(3))&&(ri.stop(t,!0),this.createSubmenu(!0))})),this._register(ee(this.element,ye.KEY_DOWN,t=>{const i=new Bi(t);Ss()===this.item&&(i.equals(17)||i.equals(3))&&ri.stop(t,!0)})),this._register(ee(this.element,ye.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(ee(this.element,ye.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(ee(this.element,ye.FOCUS_OUT,t=>{this.element&&!Ps(Ss(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){ri.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const o={top:0,left:0};return o.left=$C(e.width,t.width,{position:n.horizontal===qM.Right?0:1,offset:i.left,size:i.width}),o.left>=i.left&&o.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(o.left=i.left+10),i.top+=10,i.height=0),o.top=$C(e.height,t.height,{position:0,offset:i.top,size:0}),o.top+t.height===i.top&&o.top+i.height+t.height<=e.height&&(o.top+=i.height),o}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=me(this.element,we("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=je(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.submenuContainer.style.zIndex="1",this.parentData.submenu=new B1(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new q9],this.submenuOptions,this.menuStyle);const n=this.element.getBoundingClientRect(),o={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},r=this.submenuContainer.getBoundingClientRect(),a=je(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new wi(a.innerWidth,a.innerHeight),wi.lift(r),o,this.expandDirection);this.submenuContainer.style.left=`${c-r.left}px`,this.submenuContainer.style.top=`${l-r.top}px`,this.submenuDisposables.add(ee(this.submenuContainer,ye.KEY_UP,d=>{new Bi(d).equals(15)&&(ri.stop(d,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(ee(this.submenuContainer,ye.KEY_DOWN,d=>{new Bi(d).equals(15)&&ri.stop(d,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)==null||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class Ate extends Aw{constructor(e,t,i,n){super(e,t,i),this.menuStyles=n}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function ant(s){const e=MV,t=e.exec(s);if(!t)return s;const i=!t[1];return s.replace(e,i?"$2$3":"").trim()}function Pte(s){const e=xoe()[s.id];return`.codicon-${s.id}:before { content: '\\${e.toString(16)}'; }`}function lnt(s,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${Pte(ge.menuSelection)}
${Pte(ge.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
	opacity: 0.7;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
			/* Fix for https://github.com/microsoft/vscode/issues/103170 */
			.monaco-menu .action-item .monaco-submenu {
				z-index: 1;
			}
		`;const i=s.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=s.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const o=s.scrollbarSliderHoverBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${o};
				}
			`);const r=s.scrollbarSliderActiveBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${r};
				}
			`)}return t}class cnt{constructor(e,t,i,n){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=Ss();let i;const n=Bn(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,layer:e.layer,render:o=>{var d;this.lastContainer=o;const r=e.getMenuClassName?e.getMenuClassName():"";r&&(o.className+=" "+r),this.options.blockMouse&&(this.block=o.appendChild(we(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(d=this.blockDisposable)==null||d.dispose(),this.blockDisposable=ee(this.block,ye.MOUSE_DOWN,h=>h.stopPropagation()));const a=new oe,l=e.actionRunner||a.add(new Mb);l.onWillRun(h=>this.onActionRun(h,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new B1(o,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:h=>this.keybindingService.lookupKeybinding(h.id)},I6e),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=je(o);return a.add(ee(c,ye.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(ee(c,ye.MOUSE_DOWN,h=>{if(h.defaultPrevented)return;const u=new Co(c,h);let f=u.target;if(!u.rightButton){for(;f;){if(f===o)return;f=f.parentElement}this.contextViewService.hideContextView(!0)}})),dc(a,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:o=>{var r,a,l;(r=e.onHide)==null||r.call(e,!!o),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)==null||a.dispose(),this.blockDisposable=null,this.lastContainer&&(Ss()===this.lastContainer||Ps(Ss(),this.lastContainer))&&((l=this.focusToReturn)==null||l.focus()),this.lastContainer=null}},n,!!n)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!il(e.error)&&this.notificationService.error(e.error)}}var dnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hC=function(s,e){return function(t,i){e(t,i,s)}};let PV=class extends K{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new cnt(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,n,o,r){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=n,this.menuService=o,this.contextKeyService=r,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new q),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new q),this.onDidHideContextMenu=this._onDidHideContextMenu.event}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=OV.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{var i;(i=e.onHide)==null||i.call(e,t),this._onDidHideContextMenu.fire()}}),Au.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};PV=dnt([hC(0,Wo),hC(1,Hn),hC(2,Nf),hC(3,ai),hC(4,Vl),hC(5,ut)],PV);var OV;(function(s){function e(i){return i&&i.menuId instanceof He}function t(i,n,o){if(!e(i))return i;const{menuId:r,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{let c=[];if(r){const d=n.getMenuActions(r,l??o,a);c=T6e(d)}return i.getActions?_s.join(i.getActions(),c):c}}}s.transform=t})(OV||(OV={}));var jM;(function(s){s[s.API=0]="API",s[s.USER=1]="USER"})(jM||(jM={}));var Yj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},KM=function(s,e){return function(t,i){e(t,i,s)}};let FV=class{constructor(e){this._commandService=e}async open(e,t){if(!mO(e,ct.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=Ze.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=p7(decodeURIComponent(e.query))}catch{try{i=p7(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};FV=Yj([KM(0,en)],FV);let BV=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=Ze.parse(e));const{selection:i,uri:n}=SHe(e);return e=n,e.scheme===ct.file&&(e=DNe(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t!=null&&t.fromUserGesture?jM.USER:jM.API,...t==null?void 0:t.editorOptions}},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0}};BV=Yj([KM(0,ii)],BV);let WV=class{constructor(e,t){this._openers=new Zo,this._validators=new Zo,this._resolvers=new Zo,this._resolvedUriTargets=new ts(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new Zo,this._defaultExternalOpener={openExternal:async i=>(R9(i,ct.http,ct.https)?Coe(i):Ti.location.href=i,!0)},this._openers.push({open:async(i,n)=>n!=null&&n.openExternal||R9(i,ct.mailto,ct.http,ct.https,ct.vsls)?(await this._doOpenExternal(i,n),!0):!1}),this._openers.push(new FV(t)),this._openers.push(new BV(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){if(!(t!=null&&t.skipValidation)){const i=typeof e=="string"?Ze.parse(e):e,n=this._resolvedUriTargets.get(i)??e;for(const o of this._validators)if(!await o.shouldOpen(n,t))return!1}for(const i of this._openers)if(await i.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const n=await i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?Ze.parse(e):e;let n;try{n=(await this.resolveExternalUri(i,t)).resolved}catch{n=i}let o;if(typeof e=="string"&&i.toString()===n.toString()?o=e:o=encodeURI(n.toString(!0)),t!=null&&t.allowContributedOpeners){const r=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(o,{sourceUri:i,preferredOpenerId:r},Ft.None))return!0}return this._defaultExternalOpener.openExternal(o,{sourceUri:i},Ft.None)}dispose(){this._validators.clear()}};WV=Yj([KM(0,ii),KM(1,en)],WV);var hnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ote=function(s,e){return function(t,i){e(t,i,s)}};let HV=class extends K{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new q),this._suppressedRanges=new ts,this._markerDecorations=new ts,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new unt(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var i;const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===ct.inMemory||e.uri.scheme===ct.internal||e.uri.scheme===ct.vscode)&&((i=this._markerService)==null||i.read({resource:e.uri}).map(n=>n.owner).forEach(n=>this._markerService.remove(n,[e.uri])))}_updateDecorations(e){let t=this._markerService.read({resource:e.model.uri,take:500});const i=this._suppressedRanges.get(e.model.uri);i&&(t=t.filter(n=>!Gt.some(i,o=>D.areIntersectingOrTouching(o,n)))),e.update(t)&&this._onDidChangeMarker.fire(e.model)}};HV=hnt([Ote(0,Cn),Ote(1,Wh)],HV);class unt extends K{constructor(e){super(),this.model=e,this._map=new SNe,this._register(Ve(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=$3e(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const n=i.map(a=>this._map.get(a)),o=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),r=this.model.deltaDecorations(n,o);for(const a of i)this._map.delete(a);for(let a=0;a<r.length;a++)this._map.set(t[a],r[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=D.lift(t);if(t.severity===In.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const o=e.getWordAtPosition(i.getStartPosition());o&&(i=new D(i.startLineNumber,o.startColumn,i.endLineNumber,o.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new D(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,o,r;switch(e.severity){case In.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case In.Info:t="squiggly-info",i=Mn($Oe),n=10,r={color:Mn(tAe),position:1};break;case In.Warning:t="squiggly-warning",i=Mn(UOe),n=20,r={color:Mn(iAe),position:1};break;case In.Error:default:t="squiggly-error",i=Mn(zOe),n=30,r={color:Mn(nAe),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(o="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(o="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:Xa.Right},minimap:r,zIndex:n,inlineClassName:o}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}var fnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ST=function(s,e){return function(t,i){e(t,i,s)}},wC;function Qm(s){return s.toString()}class gnt{constructor(e,t,i){this.model=e,this._modelEventListeners=new oe,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(n=>i(e,n)))}dispose(){this._modelEventListeners.dispose()}}const mnt=Hr||Bt?1:2;class pnt{constructor(e,t,i,n,o,r,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=o,this.sha1=r,this.versionId=a,this.alternativeVersionId=l}}var mb;let VV=(mb=class extends K{constructor(e,t,i,n){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=n,this._onModelAdded=this._register(new q),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new q),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new q),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(o=>this._updateModelOptions(o))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var u;let i=po.tabSize;e.editor&&typeof e.editor.tabSize<"u"&&(i=_u(e.editor.tabSize,po.tabSize,1,100));let n="tabSize";e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"&&(n=_u(e.editor.indentSize,"tabSize",1,100));let o=po.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(o=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let r=mnt;const a=e.eol;a===`\r
`?r=2:a===`
`&&(r=1);let l=po.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=po.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let d=po.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(d=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let h=po.bracketPairColorizationOptions;if((u=e.editor)!=null&&u.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"){const f=e.editor.bracketPairColorization;h={enabled:!!f.enabled,independentColorPoolPerBracketType:!!f.independentColorPoolPerBracketType}}return{isForSimpleWidget:t,tabSize:i,indentSize:n,insertSpaces:o,detectIndentation:c,defaultEOL:r,trimAutoWhitespace:l,largeFileOptimizations:d,bracketPairColorizationOptions:h}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:sa===3||sa===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const n=typeof e=="string"?e:e.languageId;let o=this._modelCreationOptionsByLanguageAndResource[n+t];if(!o){const r=this._configurationService.getValue("editor",{overrideIdentifier:n,resource:t}),a=this._getEOL(t,n);o=wC._readModelOptions({editor:r,eol:a},i),this._modelCreationOptionsByLanguageAndResource[n+t]=o}return o}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,o=i.length;n<o;n++){const r=i[n],a=this._models[r],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const d=t[l+c],h=this.getCreationOptions(l,c,a.model.isForSimpleWidget);wC._setModelOptionsForModel(a.model,h,d)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&la(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(Qm(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(Qm(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(Qm(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,n)=>i.time-n.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const o=this.getCreationOptions(t,i,n),r=this._instantiationService.createInstance(Hb,e,t,o,i);if(i&&this._disposedModels.has(Qm(i))){const c=this._removeDisposedModel(i),d=this._undoRedoService.getElements(i),h=this._getSHA1Computer(),u=h.canComputeSHA1(r)?h.computeSHA1(r)===c.sha1:!1;if(u||c.sharesUndoRedoStack){for(const f of d.past)vu(f)&&f.matchesResource(i)&&f.setModel(r);for(const f of d.future)vu(f)&&f.matchesResource(i)&&f.setModel(r);this._undoRedoService.setElementsValidFlag(i,!0,f=>vu(f)&&f.matchesResource(i)),u&&(r._overwriteVersionId(c.versionId),r._overwriteAlternativeVersionId(c.alternativeVersionId),r._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=Qm(r.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new gnt(r,c=>this._onWillDispose(c),(c,d)=>this._onDidChangeLanguage(c,d));return this._models[a]=l,l}createModel(e,t,i,n=!1){let o;return t?o=this._createModelData(e,t,i,n):o=this._createModelData(e,Za,i,n),this._onModelAdded.fire(o.model),o.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const o=t[i];e.push(this._models[o].model)}return e}getModel(e){const t=Qm(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===ct.file||e.scheme===ct.vscodeRemote||e.scheme===ct.vscodeUserData||e.scheme===ct.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=Qm(e.uri),i=this._models[t],n=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let o=!1,r=0;if(n||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const d of c.past)vu(d)&&d.matchesResource(e.uri)&&(o=!0,r+=d.heapSize(e.uri),d.setModel(e.uri));for(const d of c.future)vu(d)&&d.matchesResource(e.uri)&&(o=!0,r+=d.heapSize(e.uri),d.setModel(e.uri))}}const a=wC.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(o)if(!n&&(r>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-r),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>vu(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new pnt(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),n,r,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!n){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,n=e.getLanguageId(),o=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),r=this.getCreationOptions(n,e.uri,e.isForSimpleWidget);wC._setModelOptionsForModel(e,r,o),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new zV}},wC=mb,mb.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024,mb);VV=wC=fnt([ST(0,xt),ST(1,xue),ST(2,z$),ST(3,$e)],VV);const OP=class OP{canComputeSHA1(e){return e.getValueLength()<=OP.MAX_MODEL_SIZE}computeSHA1(e){const t=new P9,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}};OP.MAX_MODEL_SIZE=10*1024*1024;let zV=OP;var _nt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Fte=function(s,e){return function(t,i){e(t,i,s)}};let UV=class extends K{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=kn.as(Mv.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0,this._register(Ve(()=>{var i;for(const n of this.mapProviderToDescriptor.values())fv(n)&&n.dispose();(i=this.visibleQuickAccess)==null||i.picker.dispose()}))}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var g,m;const[n,o]=this.getOrInstantiateProvider(e,i==null?void 0:i.enabledProviderPrefixes),r=this.visibleQuickAccess,a=r==null?void 0:r.descriptor;if(r&&o&&a===o){e!==o.prefix&&!(i!=null&&i.preserveValue)&&(r.picker.value=e),this.adjustValueSelection(r.picker,o,i);return}if(o&&!(i!=null&&i.preserveValue)){let p;if(r&&a&&a!==o){const v=r.value.substr(a.prefix.length);v&&(p=`${o.prefix}${v}`)}if(!p){const v=n==null?void 0:n.defaultFilterValue;v===uH.LAST?p=this.lastAcceptedPickerValues.get(o):typeof v=="string"&&(p=`${o.prefix}${v}`)}typeof p=="string"&&(e=p)}const l=(g=r==null?void 0:r.picker)==null?void 0:g.valueSelection,c=(m=r==null?void 0:r.picker)==null?void 0:m.value,d=new oe,h=d.add(this.quickInputService.createQuickPick({useSeparators:!0}));h.value=e,this.adjustValueSelection(h,o,i),h.placeholder=(i==null?void 0:i.placeholder)??(o==null?void 0:o.placeholder),h.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,h.hideInput=!!h.quickNavigate&&!r,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(h.itemActivation=(i==null?void 0:i.itemActivation)??Hc.SECOND),h.contextKey=o==null?void 0:o.contextKey,h.filterValue=p=>p.substring(o?o.prefix.length:0);let u;t&&(u=new gv,d.add(Se.once(h.onWillAccept)(p=>{p.veto(),h.hide()}))),d.add(this.registerPickerListeners(h,n,o,e,i));const f=d.add(new hn);if(n&&d.add(n.provide(h,f.token,i==null?void 0:i.providerOptions)),Se.once(h.onDidHide)(()=>{h.selectedItems.length===0&&f.cancel(),d.dispose(),u==null||u.complete(h.selectedItems.slice(0))}),h.show(),l&&c===e&&(h.valueSelection=l),t)return u==null?void 0:u.p}adjustValueSelection(e,t,i){let n;i!=null&&i.preserveValue?n=[e.value.length,e.value.length]:n=[(t==null?void 0:t.prefix.length)??0,e.value.length],e.valueSelection=n}registerPickerListeners(e,t,i,n,o){const r=new oe,a=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return r.add(Ve(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),r.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,o==null?void 0:o.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:o==null?void 0:o.enabledProviderPrefixes,preserveValue:!0,providerOptions:o==null?void 0:o.providerOptions}):a.value=l})),i&&r.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),r}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!(t!=null&&t.includes(i.prefix)))return[void 0,void 0];let n=this.mapProviderToDescriptor.get(i);return n||(n=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,n)),[n,i]}};UV=_nt([Fte(0,Fo),Fte(1,$e)],UV);var bnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o};class Cfe{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}bnt([Kn],Cfe.prototype,"toString",null);const vnt=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function Cnt(s){const e=[];let t=0,i;for(;i=vnt.exec(s);){i.index-t>0&&e.push(s.substring(t,i.index));const[,n,o,,r]=i;r?e.push({label:n,href:o,title:r}):e.push({label:n,href:o}),t=i.index+i[0].length}return t<s.length&&e.push(s.substring(t)),new Cfe(e)}const B3={},wnt=new eq("quick-input-button-icon-");function ynt(s){if(!s)return;let e;const t=s.dark.toString();return B3[t]?e=B3[t]:(e=wnt.nextId(),mR(`.${e}, .hc-light .${e}`,`background-image: ${Eh(s.light||s.dark)}`),mR(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${Eh(s.dark)}`),B3[t]=e),e}function W1(s,e,t){let i=s.iconClass||ynt(s.iconPath);return s.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:s.tooltip||"",class:i,enabled:!0,run:t}}function Snt(s,e,t){Os(e);const i=Cnt(s);let n=0;for(const o of i.nodes)if(typeof o=="string")e.append(...Hg(o));else{let r=o.title;!r&&o.href.startsWith("command:")?r=_(1771,"Click to execute command '{0}'",o.href.substring(8)):r||(r=o.href);const a=we("a",{href:o.href,title:r,tabIndex:n++},o.label);a.style.textDecoration="underline";const l=f=>{BTe(f)&&ri.stop(f,!0),t.callback(o.href)},c=t.disposables.add(new Si(a,ye.CLICK)).event,d=t.disposables.add(new Si(a,ye.KEY_DOWN)).event,h=Se.chain(d,f=>f.filter(g=>{const m=new Bi(g);return m.equals(10)||m.equals(3)}));t.disposables.add(Oo.addTarget(a));const u=t.disposables.add(new Si(a,Qi.Tap)).event;Se.any(c,u,h)(l,null,t.disposables),e.appendChild(a)}}var xnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Bte=function(s,e){return function(t,i){e(t,i,s)}};const wfe="inQuickInput",Lnt=new Ne(wfe,!1,_(1748,"Whether keyboard focus is inside the quick input control")),G4=de.has(wfe),Int="quickInputAlignment",Ent=new Ne(Int,"top",_(1749,"The alignment of the quick input")),ZI="quickInputType",knt=new Ne(ZI,void 0,_(1750,"The type of the currently visible quick input")),yfe="cursorAtEndOfQuickInputBox",Dnt=new Ne(yfe,!1,_(1751,"Whether the cursor in the quick input is at the end of the input box")),Tnt=de.has(yfe),$V={iconClass:it.asClassName(ge.quickInputBack),tooltip:_(1752,"Back")},FP=class FP extends K{constructor(e){super(),this.ui=e,this._visible=ht("visible",!1),this._widgetUpdated=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=FP.noPromptMessage,this._severity=xn.Ignore,this.onDidTriggerButtonEmitter=this._register(new q),this.onDidHideEmitter=this._register(new q),this.onWillHideEmitter=this._register(new q),this.onDisposeEmitter=this._register(new q),this.visibleDisposables=this._register(new oe),this.onDidHide=this.onDidHideEmitter.event}get visible(){return this._visible.get()}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Al;this._ignoreFocusOut=e&&!Al,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===$V),this._rightButtons=e.filter(t=>t!==$V&&t.location!==h2.Inline),this._inlineButtons=e.filter(t=>t.location===h2.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this._visible.set(!0,void 0),this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=hI.Other){this._visible.set(!1,void 0),this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=hI.Other){this.onWillHideEmitter.fire({reason:e})}update(){var n;if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?Os(this.ui.widget,this._widget):Os(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new ha,this.busyDelay.setIfNotSet(()=>{this.visible&&(this.ui.progressBar.infinite(),this.ui.progressBar.getContainer().removeAttribute("aria-hidden"))},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.ui.progressBar.getContainer().setAttribute("aria-hidden","true"),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const o=this._leftButtons.map((l,c)=>W1(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.leftActionBar.push(o,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const r=this._rightButtons.map((l,c)=>W1(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.rightActionBar.push(r,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const a=this._inlineButtons.map((l,c)=>W1(l,`id-${c}`,async()=>this.onDidTriggerButtonEmitter.fire(l)));this.ui.inlineActionBar.push(a,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const o=((n=this.toggles)==null?void 0:n.filter(a=>a instanceof Mf))??[];this.ui.inputBox.toggles=o;const r=o.length*22;this.ui.countContainer.style.right=r>0?`${4+r}px`:"4px",this.ui.visibleCountContainer.style.right=r>0?`${4+r}px`:"4px"}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,Os(this.ui.message),i&&Snt(i,this.ui.message,{callback:o=>{this.ui.linkOpenerDelegate(o)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?_(1754,"{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==xn.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}};FP.noPromptMessage=_(1753,"Press 'Enter' to confirm your input or 'Escape' to cancel");let QI=FP;const BP=class BP extends QI{constructor(e){super(e),this._value="",this.onDidChangeValueEmitter=this._register(new q),this.onWillAcceptEmitter=this._register(new q),this.onDidAcceptEmitter=this._register(new q),this.onDidCustomEmitter=this._register(new q),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=Hc.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new q),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new q),this.onDidTriggerItemButtonEmitter=this._register(new q),this.onDidTriggerSeparatorButtonEmitter=this._register(new q),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new ak,this.type="quickPick",this.filterValue=t=>t,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event,this.noValidationMessage=void 0}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get prompt(){return this.noValidationMessage}set prompt(e){this.noValidationMessage=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?fHe:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get okLabel(){return this._okLabel??_(1756,"OK")}set okLabel(e){this._okLabel=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(tn.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&dn(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany&&!e.some(i=>i.pickable===!1)){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&dn(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(BU(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&dn(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return ee(this.ui.container,ye.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new Bi(e),i=t.keyCode;this._quickNavigate.keybindings.some(r=>{const a=r.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage||!!this.prompt,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;!n&&i.inputBox&&(n=this.placeholder,this.title&&(n=n?`${n} - ${this.title}`:this.title),n||(n=BP.DEFAULT_ARIA_LABEL)),this.ui.list.ariaLabel!==n&&(this.ui.list.ariaLabel=n??null),this.ui.inputBox.ariaLabel!==n&&(this.ui.inputBox.ariaLabel=n??"input"),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case Hc.NONE:this._itemActivation=Hc.FIRST;break;case Hc.SECOND:this.ui.list.focus(tn.Second),this._itemActivation=Hc.FIRST;break;case Hc.LAST:this.ui.list.focus(tn.Last),this._itemActivation=Hc.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.ok.label=this.okLabel||"",this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(tn.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||(this.activeItems[0]&&!this._canSelectMany&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(e??!1))}};BP.DEFAULT_ARIA_LABEL=_(1755,"Type to narrow down results.");let Nx=BP;class Nnt extends QI{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new q),this.onDidAcceptEmitter=this._register(new q),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}get prompt(){return this._prompt}set prompt(e){this._prompt=e,this.noValidationMessage=e?_(1757,"{0} (Press 'Enter' to confirm or 'Escape' to cancel)",e):QI.noPromptMessage,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}accept(){this.onDidAcceptEmitter.fire()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password);let t=this.ariaLabel;!t&&e.inputBox&&(t=this.placeholder?this.title?`${this.placeholder} - ${this.title}`:this.placeholder:this.title?this.title:"input"),this.ui.inputBox.ariaLabel!==t&&(this.ui.inputBox.ariaLabel=t||"input")}}let qV=class extends Pw{constructor(e,t){super("mouse",void 0,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(Bn(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};qV=xnt([Bte(0,xt),Bte(1,Sr)],qV);const Wte="done",Hte="active",W3="infinite",H3="infinite-long-running",Vte="discrete",WP=class WP extends K{constructor(e,t){super(),this.progressSignal=this._register(new mi),this.workedVal=0,this.showDelayedScheduler=this._register(new Ni(()=>ta(this.element),0)),this.longRunningScheduler=this._register(new Ni(()=>this.infiniteLongRunning(),WP.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(Hte,W3,H3,Vte),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(Wte),this.element.classList.contains(W3)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Vte,Wte,H3),this.element.classList.add(Hte,W3),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(H3)}getContainer(){return this.element}};WP.LONG_RUNNING_INFINITE_THRESHOLD=1e4;let jV=WP;const Rnt=we;class Mnt extends K{constructor(e,t,i){super(),this.parent=e,this.onDidChange=o=>this.findInput.onDidChange(o),this.container=me(this.parent,Rnt(".quick-input-box")),this.findInput=this._register(new Sde(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const n=this.findInput.inputBox.inputElement;n.role="textbox",n.ariaHasPopup="menu",n.ariaAutoComplete="list"}get onKeyDown(){return this.findInput.onKeyDown}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}get ariaLabel(){return this.findInput.inputBox.inputElement.getAttribute("aria-label")||""}set ariaLabel(e){this.findInput.inputBox.inputElement.setAttribute("aria-label",e)}hasFocus(){return this.findInput.inputBox.hasFocus()}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.findInput.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===xn.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===xn.Info?1:e===xn.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===xn.Info?1:e===xn.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}const zte=new bo(()=>{const s=bv.Collator(void 0,{numeric:!0,sensitivity:"base"}).value;return{collator:s,collatorIsNumeric:s.resolvedOptions().numeric}});new bo(()=>({collator:bv.Collator(void 0,{numeric:!0}).value}));new bo(()=>({collator:bv.Collator(void 0,{numeric:!0,sensitivity:"accent"}).value}));function Ant(s,e,t=!1){const i=s||"",n=e||"",o=zte.value.collator.compare(i,n);return zte.value.collatorIsNumeric&&o===0&&i!==n?i<n?-1:1:o}function Pnt(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),o=Ont(s,e,t);if(o)return o;const r=i.endsWith(t),a=n.endsWith(t);if(r!==a)return r?-1:1;const l=Ant(i,n);return l!==0?l:i.localeCompare(n)}function Ont(s,e,t){const i=s.toLowerCase(),n=e.toLowerCase(),o=i.startsWith(t),r=n.startsWith(t);if(o!==r)return o?-1:1;if(o&&r){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var Y4=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},KV=function(s,e){return function(t,i){e(t,i,s)}},GV;const Od=we;class Sfe{constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new bo(()=>{const n=i.label??"",o=Xp(n).text.trim(),r=i.ariaLabel||[n,this.saneDescription,this.saneDetail].map(a=>ple(a)).filter(a=>!!a).join(", ");return{saneLabel:n,saneSortLabel:o,saneAriaLabel:r}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class co extends Sfe{constructor(e,t,i,n,o,r,a){var l,c,d;super(e,i,r),this.childIndex=t,this.fireButtonTriggered=n,this._onChecked=o,this.item=r,this._separator=a,this._checked=!1,this.onChecked=i?Se.map(Se.filter(this._onChecked.event,h=>h.element===this),h=>h.checked):Se.None,this._saneDetail=r.detail,this._labelHighlights=(l=r.highlights)==null?void 0:l.label,this._descriptionHighlights=(c=r.highlights)==null?void 0:c.description,this._detailHighlights=(d=r.highlights)==null?void 0:d.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var jd;(function(s){s[s.NONE=0]="NONE",s[s.MOUSE_HOVER=1]="MOUSE_HOVER",s[s.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(jd||(jd={}));class hp extends Sfe{constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=jd.NONE}}class Fnt{getHeight(e){return e instanceof hp?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof co?GM.ID:YM.ID}}class Bnt{getWidgetAriaLabel(){return _(1770,"Quick Input")}getAriaLabel(e){var t;return(t=e.separator)!=null&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof co)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class xfe{constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new oe,t.toDisposeTemplate=new oe,t.entry=me(e,Od(".quick-input-list-entry"));const i=me(t.entry,Od("label.quick-input-list-label"));t.outerLabel=i,t.checkbox=t.toDisposeTemplate.add(new mi),t.toDisposeTemplate.add(Jn(i,ye.CLICK,c=>{if(t.checkbox.value&&!c.defaultPrevented&&t.checkbox.value.enabled){const d=!t.checkbox.value.checked;t.checkbox.value.checked=d,t.element.checked=d}}));const n=me(i,Od(".quick-input-list-rows")),o=me(n,Od(".quick-input-list-row")),r=me(n,Od(".quick-input-list-row"));t.label=new SI(o,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=wO(t.label.element,Od(".quick-input-list-icon"));const a=me(o,Od(".quick-input-list-entry-keybinding"));t.keybinding=new v0(a,sa),t.toDisposeTemplate.add(t.keybinding);const l=me(r,Od(".quick-input-list-label-meta"));return t.detail=new SI(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=me(t.entry,Od(".quick-input-list-separator")),t.actionBar=new Fr(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}var pb;let GM=(pb=class extends xfe{constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return GV.ID}ensureCheckbox(e,t){var n;if(!e.hasCheckbox){(n=t.checkbox.value)==null||n.domNode.remove(),t.checkbox.clear();return}let i=t.checkbox.value;i?i.setTitle(e.saneLabel):(i=new mde(e.saneLabel,e.checked,{..._q,size:15}),t.checkbox.value=i,t.outerLabel.prepend(i.domNode)),e.checkboxDisabled?i.disable():i.enable(),i.checked=e.checked,t.toDisposeElement.add(e.onChecked(o=>i.checked=o)),t.toDisposeElement.add(i.onChange(()=>e.checked=i.checked))}renderElement(e,t,i){var u;const n=e.element;i.element=n,n.element=i.entry??void 0;const o=n.item;n.element.classList.toggle("not-pickable",n.item.pickable===!1),this.ensureCheckbox(n,i);const{labelHighlights:r,descriptionHighlights:a,detailHighlights:l}=n;if(o.iconPath){const f=_f(this.themeService.getColorTheme().type)?o.iconPath.dark:o.iconPath.light??o.iconPath.dark,g=Ze.revive(f);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=Eh(g)}else i.icon.style.backgroundImage="",i.icon.className=o.iconClass?`quick-input-list-icon ${o.iconClass}`:"";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:hc(n.saneDescription),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:r||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(d.extraClasses=o.iconClasses,d.italic=o.italic,d.strikethrough=o.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),i.keybinding.set(o.keybinding),n.saneDetail){let f;n.saneTooltip||(f={markdown:{value:hc(n.saneDetail),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:f,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";(u=n.separator)!=null&&u.label?(i.separator.textContent=n.separator.label,i.separator.style.display="",this.addItemWithSeparator(n)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!n.separator&&n.childIndex!==0);const h=o.buttons;h&&h.length?(i.actionBar.push(h.map((f,g)=>W1(f,`id-${g}`,()=>n.fireButtonTriggered({button:f,item:n.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}},GV=pb,pb.ID="quickpickitem",pb);GM=GV=Y4([KV(1,Dn)],GM);const HP=class HP extends xfe{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return HP.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const o=n.separator,{labelHighlights:r,descriptionHighlights:a}=n;i.icon.style.backgroundImage="",i.icon.className="";let l;!n.saneTooltip&&n.saneDescription&&(l={markdown:{value:hc(n.saneDescription),supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const c={matches:r||[],descriptionTitle:l,descriptionMatches:a||[],labelEscapeNewLines:!0};i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,c),i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const d=o.buttons;d&&d.length?(i.actionBar.push(d.map((h,u)=>W1(h,`id-${u}`,()=>n.fireSeparatorButtonTriggered({button:h,separator:n.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(e,t,i){var n;this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||(n=e.element.element)==null||n.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}};HP.ID="quickpickseparator";let YM=HP,JI=class extends K{constructor(e,t,i,n,o,r){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=r,this._onKeyDown=new q,this._onLeave=new q,this.onLeave=this._onLeave.event,this._visibleCountObservable=ht("VisibleCount",0),this.onChangedVisibleCount=Se.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=ht("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=Se.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=ht("CheckedCount",0),this.onChangedCheckedCount=Se.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=tx({equalsFn:dn},new Array),this.onChangedCheckedElements=Se.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new q,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new q,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new q,this._elementCheckedEventBufferer=new ak,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new oe),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=me(this.parent,Od(".quick-input-list")),this._separatorRenderer=new YM(t),this._itemRenderer=o.createInstance(GM,t),this._tree=this._register(o.createInstance(P2,"QuickInput",this._container,new Fnt,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof hp?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return Hnt(a,l,c)}},accessibilityProvider:new Bnt,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:tv.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=n,this._registerListeners()}get onDidChangeFocus(){return Se.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof co).map(t=>t.item),this._store)}get onDidChangeSelection(){return Se.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof co).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new Bi(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(ee(this._container,ye.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(ee(this._container,ye.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new Mse(typeof this.hoverDelegate.delay=="function"?this.hoverDelegate.delay():this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{var i;if(nY(t.browserEvent.target)){e.cancel();return}if(!(!nY(t.browserEvent.relatedTarget)&&Ps(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)))try{await e.trigger(async()=>{t.element instanceof co&&this.showHover(t.element)})}catch(n){if(!il(n))throw n}})),this._register(this._tree.onMouseOut(t=>{var i;Ps(t.browserEvent.relatedTarget,(i=t.element)==null?void 0:i.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const n=i===t;!!(i.focusInsideSeparator&jd.ACTIVE_ITEM)!==n&&(n?i.focusInsideSeparator|=jd.ACTIVE_ITEM:i.focusInsideSeparator&=~jd.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&jd.MOUSE_HOVER)||(i.focusInsideSeparator|=jd.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&jd.MOUSE_HOVER)&&(i.focusInsideSeparator&=~jd.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof co);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof hp&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&t.item.pickable!==!1&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,n,o)=>{let r;if(n.type==="separator"){if(!n.buttons)return i;t=new hp(o,a=>this._onSeparatorButtonTriggered.fire(a),n),r=t}else{const a=o>0?e[o-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(l=a);const c=new co(o,t!=null&&t.children?t.children.length:o,this._hasCheckboxes&&n.pickable!==!1,d=>this._onButtonTriggered.fire(d),this._elementChecked,n,l);if(this._itemElements.push(c),t)return t.children.push(c),i;r=c}return i.push(r),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),n=i==null?void 0:i.parentNode;if(i&&n){const o=i.nextSibling;i.remove(),n.insertBefore(i,o)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){var t;if(this._itemElements.length)switch(e===tn.Second&&this._itemElements.length<2&&(e=tn.First),e){case tn.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,i=>i.element instanceof co);break;case tn.Second:{this._tree.scrollTop=0;let i=!1;this._tree.focusFirst(void 0,n=>n.element instanceof co?i?!0:(i=!i,!1):!1);break}case tn.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,i=>i.element instanceof co);break;case tn.Next:{const i=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,o=>o.element instanceof co?(this._tree.reveal(o.element),!0):!1);const n=this._tree.getFocus();i.length&&i[0]===n[0]&&this._onLeave.fire();break}case tn.Previous:{const i=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,o=>{if(!(o.element instanceof co))return!1;const r=this._tree.getParentElement(o.element);return r===null||r.children[0]!==o.element?this._tree.reveal(o.element):this._tree.reveal(r),!0});const n=this._tree.getFocus();i.length&&i[0]===n[0]&&this._onLeave.fire();break}case tn.NextPage:this._tree.focusNextPage(void 0,i=>i.element instanceof co?(this._tree.reveal(i.element),!0):!1);break;case tn.PreviousPage:this._tree.focusPreviousPage(void 0,i=>{if(!(i.element instanceof co))return!1;const n=this._tree.getParentElement(i.element);return n===null||n.children[0]!==i.element?this._tree.reveal(i.element):this._tree.reveal(n),!0});break;case tn.NextSeparator:{let i=!1;const n=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,r=>{if(i)return!0;if(r.element instanceof hp)i=!0,this._separatorRenderer.isSeparatorVisible(r.element)?this._tree.reveal(r.element.children[0]):this._tree.reveal(r.element,0);else if(r.element instanceof co){if(r.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(r.element)?this._tree.reveal(r.element):this._tree.reveal(r.element,0),!0;if(r.element===this._elementTree[0])return this._tree.reveal(r.element,0),!0}return!1});const o=this._tree.getFocus()[0];n===o&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,r=>r.element instanceof co));break}case tn.PreviousSeparator:{let i,n=!!((t=this._tree.getFocus()[0])!=null&&t.separator);this._tree.focusPrevious(void 0,!0,void 0,o=>{if(o.element instanceof hp)n?i||(this._separatorRenderer.isSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),i=o.element.children[0]):n=!0;else if(o.element instanceof co&&!i){if(o.element.separator)this._itemRenderer.isItemWithSeparatorVisible(o.element)?this._tree.reveal(o.element):this._tree.reveal(o.element,0),i=o.element;else if(o.element===this._elementTree[0])return this._tree.reveal(o.element,0),!0}return!1}),i&&this._tree.setFocus([i]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const n=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=n&&n.type==="separator"&&!n.buttons?n:void 0)});else{let i;this._itemElements.forEach(n=>{let o;this.matchOnLabelMode==="fuzzy"?o=this.matchOnLabel?rx(e,Xp(n.saneLabel))??void 0:void 0:o=this.matchOnLabel?Wnt(t,Xp(n.saneLabel))??void 0:void 0;const r=this.matchOnDescription?rx(e,Xp(n.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?rx(e,Xp(n.saneDetail||""))??void 0:void 0;if(o||r||a?(n.labelHighlights=o,n.descriptionHighlights=r,n.detailHighlights=a,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=n.item?!n.item.alwaysShow:!0),n.item?n.separator=void 0:n.separator&&(n.hidden=!0),!this.sortByLabel){const l=n.index&&this._inputElements[n.index-1]||void 0;(l==null?void 0:l.type)==="separator"&&!l.buttons&&(i=l),i&&!n.hidden&&(n.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof co),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!(e!=null&&e.saneTooltip)||!(e instanceof co))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new oe;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof co&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof hp?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(n=>({element:n,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const o=e[i];if(!o.hidden&&o.item.pickable!==!1)if(o.checked)t=!0;else return!1}return t}_updateCheckedObservables(){Ki(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){var t,i,n;this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.hoverDelegate).onDidHideHover)==null||i.call(t),(n=this._lastHover)==null||n.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:o=>{this.linkOpenerDelegate(o)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};Y4([Kn],JI.prototype,"onDidChangeFocus",null);Y4([Kn],JI.prototype,"onDidChangeSelection",null);JI=Y4([KV(4,$e),KV(5,so)],JI);function Wnt(s,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return Ute(s,t);const n=lk(t," "),o=t.length-n.length,r=Ute(s,n);if(r)for(const a of r){const l=i[a.start+o]+o;a.start+=l,a.end+=l}return r}function Ute(s,e){const t=e.toLowerCase().indexOf(s.toLowerCase());return t!==-1?[{start:t,end:t+s.length}]:null}function Hnt(s,e,t){const i=s.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:Pnt(s.saneSortLabel,e.saneSortLabel,t)}function Vnt(s,e={}){Ks.registerCommandAndKeybindingRule({weight:200,when:G4,metadata:{description:_(1758,"Used while in the context of any kind of quick input. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},...s,secondary:Xj(s.primary,s.secondary??[],e)})}function Nr(s,e={}){Ks.registerCommandAndKeybindingRule({weight:200,when:de.and(de.or(de.equals(ZI,"quickPick"),de.equals(ZI,"quickTree")),G4),metadata:{description:_(1759,"Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},...s,secondary:Xj(s.primary,s.secondary??[],e)})}const eE=Bt?256:2048;function Xj(s,e,t={}){return t.withAltMod&&e.push(512+s),t.withCtrlMod&&(e.push(eE+s),t.withAltMod&&e.push(512+eE+s)),t.withCmdMod&&Bt&&(e.push(2048+s),t.withCtrlMod&&e.push(2304+s),t.withAltMod&&(e.push(2560+s),t.withCtrlMod&&e.push(2816+s))),e}function Ba(s,e){return t=>{const i=t.get(Fo).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(s)}}Nr({id:"quickInput.pageNext",primary:12,handler:Ba(tn.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Nr({id:"quickInput.pagePrevious",primary:11,handler:Ba(tn.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Nr({id:"quickInput.first",primary:eE+14,handler:Ba(tn.First)},{withAltMod:!0,withCmdMod:!0});Nr({id:"quickInput.last",primary:eE+13,handler:Ba(tn.Last)},{withAltMod:!0,withCmdMod:!0});Nr({id:"quickInput.next",primary:18,handler:Ba(tn.Next)},{withCtrlMod:!0});Nr({id:"quickInput.previous",primary:16,handler:Ba(tn.Previous)},{withCtrlMod:!0});const $te=_(1760,"If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),qte=_(1761,"If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");Bt?(Nr({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:Ba(tn.NextSeparator,tn.Next),metadata:{description:$te}}),Nr({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:Ba(tn.NextSeparator)},{withCtrlMod:!0}),Nr({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:Ba(tn.PreviousSeparator,tn.Previous),metadata:{description:qte}}),Nr({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:Ba(tn.PreviousSeparator)},{withCtrlMod:!0})):(Nr({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:Ba(tn.NextSeparator,tn.Next),metadata:{description:$te}}),Nr({id:"quickInput.nextSeparator",primary:2578,handler:Ba(tn.NextSeparator)}),Nr({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:Ba(tn.PreviousSeparator,tn.Previous),metadata:{description:qte}}),Nr({id:"quickInput.previousSeparator",primary:2576,handler:Ba(tn.PreviousSeparator)}));Ks.registerCommandAndKeybindingRule({id:"quickInput.accept",primary:3,weight:200,when:de.and(de.notEquals(ZI,"quickWidget"),G4,de.not("isComposing")),metadata:{description:_(1762,"Used while in the context of some quick input. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")},handler:s=>{const e=s.get(Fo).currentQuickInput;e==null||e.accept()},secondary:Xj(3,[],{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0})});Nr({id:"quickInput.acceptInBackground",when:de.and(G4,de.equals(ZI,"quickPick"),de.or(Xq.negate(),Tnt)),primary:17,weight:250,handler:s=>{const e=s.get(Fo).currentQuickInput;e==null||e.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Vnt({id:"quickInput.hide",primary:9,handler:s=>{const e=s.get(Fo).currentQuickInput;e==null||e.hide()}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});Nr({id:"quickInput.toggleHover",primary:eE|10,handler:s=>{s.get(Fo).toggleHover()}});var znt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Unt=function(s,e){return function(t,i){e(t,i,s)}},YV;const dS=we;var _b;let XM=(_b=class extends K{constructor(e,t,i,n){super(),this._hoverDelegate=e,this._buttonTriggeredEmitter=t,this.onCheckedEvent=i,this._themeService=n,this.templateId=YV.ID}renderTemplate(e){const t=new oe,i=me(e,dS(".quick-input-tree-entry")),n=t.add(new pde("",!1,{..._q,size:15}));i.appendChild(n.domNode);const o=me(i,dS("label.quick-input-tree-label")),r=me(o,dS(".quick-input-tree-rows")),a=me(r,dS(".quick-input-tree-row")),l=wO(a,dS(".quick-input-tree-icon")),c=t.add(new SI(a,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this._hoverDelegate})),d=t.add(new Fr(i,this._hoverDelegate?{hoverDelegate:this._hoverDelegate}:void 0));return d.domNode.classList.add("quick-input-tree-entry-action-bar"),{toDisposeTemplate:t,entry:i,checkbox:n,icon:l,label:c,actionBar:d,toDisposeElement:new oe}}renderElement(e,t,i,n){const o=i.toDisposeElement,r=e.element;if(r.pickable===!1?i.checkbox.domNode.style.display="none":(i.checkbox.domNode.style.display="",i.checkbox.checked=r.checked??!1,o.add(Se.filter(this.onCheckedEvent,h=>h.item===r)(h=>i.checkbox.checked=h.checked)),r.disabled&&i.checkbox.disable()),r.iconPath){const h=_f(this._themeService.getColorTheme().type)?r.iconPath.dark:r.iconPath.light??r.iconPath.dark,u=Ze.revive(h);i.icon.className="quick-input-tree-icon",i.icon.style.backgroundImage=Eh(u)}else i.icon.style.backgroundImage="",i.icon.className=r.iconClass?`quick-input-tree-icon ${r.iconClass}`:"";const{labelHighlights:a,descriptionHighlights:l}=e.filterData||{};let c;r.description&&(c={markdown:{value:hc(r.description),supportThemeIcons:!0},markdownNotSupportedFallback:r.description}),i.label.setLabel(r.label,r.description,{matches:a,descriptionMatches:l,extraClasses:r.iconClasses,italic:r.italic,strikethrough:r.strikethrough,labelEscapeNewLines:!0,descriptionTitle:c});const d=r.buttons;d&&d.length?(i.actionBar.push(d.map((h,u)=>W1(h,`tree-${u}`,()=>this._buttonTriggeredEmitter.fire({item:r,button:h}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i,n){i.toDisposeElement.clear(),i.actionBar.clear()}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}},YV=_b,_b.ID="quickInputTreeElement",_b);XM=YV=znt([Unt(3,Dn)],XM);class $nt{getHeight(e){return 22}getTemplateId(e){return XM.ID}}function qnt(s){var o;let e=!1,t=!1,i=!1;for(const r of s){switch((o=r.element)==null?void 0:o.checked){case"mixed":i=!0;break;case!0:e=!0;break;default:t=!0;break}if(e&&t&&i)break}return t?i||e?"mixed":!1:i?"mixed":e}class jnt{constructor(e){this.onCheckedEvent=e}getWidgetAriaLabel(){return _(1772,"Quick Tree")}getAriaLabel(e){return e.ariaLabel||[e.label,e.description].map(t=>ple(t)).filter(t=>!!t).join(", ")}getWidgetRole(){return"tree"}getRole(e){return"checkbox"}isChecked(e){return{get value(){return e.checked==="mixed"?"mixed":!!e.checked},onDidChange:t=>Se.filter(this.onCheckedEvent,i=>i.item===e)(i=>t())}}}class Knt{constructor(){this.filterValue="",this.matchOnLabel=!0,this.matchOnDescription=!1}filter(e,t){if(!this.filterValue||!(this.matchOnLabel||this.matchOnDescription))return e.children?{visibility:2,data:{}}:{visibility:1,data:{}};const i=this.matchOnLabel?rx(this.filterValue,Xp(e.label))??void 0:void 0,n=this.matchOnDescription?rx(this.filterValue,Xp(e.description||""))??void 0:void 0;return{visibility:t===1||i||n?1:e.children?2:0,data:{labelHighlights:i,descriptionHighlights:n}}}}class Gnt extends K{constructor(){super(...arguments),this._sortByLabel=!0}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}compare(e,t){if(!this._sortByLabel)return 0;if(e.label<t.label)return-1;if(e.label>t.label)return 1;if(e.description&&t.description){if(e.description<t.description)return-1;if(e.description>t.description)return 1}else{if(e.description)return-1;if(t.description)return 1}return 0}}var Ynt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Xnt=function(s,e){return function(t,i){e(t,i,s)}};const Znt=we;let XV=class extends K{constructor(e,t,i){super(),this.instantiationService=i,this._onDidTriggerButton=this._register(new q),this._onDidChangeCheckboxState=this._register(new q),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidCheckedLeafItemsChange=this._register(new q),this._onLeave=new q,this.onLeave=this._onLeave.event,this._onDidAccept=this._register(new q),this.onDidAccept=this._onDidAccept.event,this._container=me(e,Znt(".quick-input-tree")),this._renderer=this._register(this.instantiationService.createInstance(XM,t,this._onDidTriggerButton,this.onDidChangeCheckboxState)),this._filter=this.instantiationService.createInstance(Knt),this._sorter=this._register(new Gnt),this._tree=this._register(this.instantiationService.createInstance(P2,"QuickInputTree",this._container,new $nt,[this._renderer],{accessibilityProvider:new jnt(this.onDidChangeCheckboxState),horizontalScrolling:!1,multipleSelectionSupport:!1,findWidgetEnabled:!1,alwaysConsumeMouseWheel:!0,hideTwistiesOfChildlessElements:!0,renderIndentGuides:tv.None,expandOnDoubleClick:!0,expandOnlyOnTwistieClick:!0,disableExpandOnSpacebar:!0,sorter:this._sorter,filter:this._filter})),this.registerOnOpenListener()}get tree(){return this._tree}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get sortByLabel(){return this._sorter.sortByLabel}set sortByLabel(e){this._sorter.sortByLabel=e,this._tree.resort(null,!0)}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}updateFilterOptions(e){e.matchOnLabel!==void 0&&(this._filter.matchOnLabel=e.matchOnLabel),e.matchOnDescription!==void 0&&(this._filter.matchOnDescription=e.matchOnDescription),this._tree.refilter()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}registerOnOpenListener(){this._register(this._tree.onDidOpen(e=>{const t=e.element;if(!t||t.disabled)return;if(t.pickable===!1){this._tree.setFocus([t]),this._onDidAccept.fire();return}const i=t.checked!==!0;if((t.checked??!1)===i)return;t.checked=i,this._tree.rerender(t);const n=new Set,o=[...this._tree.getNode(t).children];for(;o.length;){const a=o.shift();a!=null&&a.element&&!n.has(a.element)&&(n.add(a.element),(a.element.checked??!1)!==t.checked&&(a.element.checked=t.checked,this._tree.rerender(a.element)),o.push(...a.children))}let r=this._tree.getParentElement(t);for(;r;){const a=[...this._tree.getNode(r).children],l=qnt(a);(r.checked??!1)!==l&&(r.checked=l,this._tree.rerender(r)),r=this._tree.getParentElement(r)}this._onDidChangeCheckboxState.fire({item:t,checked:t.checked??!1}),this._onDidCheckedLeafItemsChange.fire(this.getCheckedLeafItems())}))}getCheckedLeafItems(){const e=new Set,t=[...this._tree.getNode().children],i=new Array;for(;t.length;){const n=t.shift();!(n!=null&&n.element)||e.has(n.element)||n.element.checked&&(e.add(n.element),t.push(...n.children),n.element.children||i.push(n.element))}return i}};XV=Ynt([Xnt(2,$e)],XV);var Lfe=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},n_=function(s,e){return function(t,i){e(t,i,s)}},ZV;const xa=we,V3="workbench.quickInput.viewState";var bb;let QV=(bb=class extends K{get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,n,o){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.storageService=o,this.enabled=!0,this.onDidAcceptEmitter=this._register(new q),this.onDidCustomEmitter=this._register(new q),this.onDidTriggerButtonEmitter=this._register(new q),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new q),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new q),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=Lnt.bindTo(n),this.quickInputTypeContext=knt.bindTo(n),this.endOfQuickInputBoxContext=Dnt.bindTo(n),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(Se.runAndSubscribe(hk,({window:r,disposables:a})=>this.registerKeyModsListeners(r,a),{window:Ti,disposables:this._store})),this._register(kTe(r=>{this.ui&&je(this.ui.container)===r&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))})),this.viewState=this.loadViewState()}registerKeyModsListeners(e,t){const i=n=>{this.keyMods.ctrlCmd=n.ctrlKey||n.metaKey,this.keyMods.alt=n.altKey};for(const n of[ye.KEY_DOWN,ye.KEY_UP,ye.MOUSE_DOWN])t.add(ee(e,n,i,!0))}getUI(e){if(this.ui)return e&&je(this._container)!==je(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=me(this._container,xa(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=Hl(t),n=me(t,xa(".quick-input-titlebar")),o=this._register(new Fr(n,{hoverDelegate:this.options.hoverDelegate}));o.domNode.classList.add("quick-input-left-action-bar");const r=me(n,xa(".quick-input-title")),a=this._register(new Fr(n,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=me(t,xa(".quick-input-header")),c=this._register(new pde(_(1763,"Toggle all checkboxes"),!1,{..._q,size:15}));me(l,c.domNode),this._register(c.onChange(()=>{const P=c.checked;T.setAllVisibleChecked(P===!0)})),this._register(ee(c.domNode,ye.CLICK,P=>{(P.x||P.y)&&f.setFocus()}));const d=me(l,xa(".quick-input-description")),h=me(l,xa(".quick-input-and-message")),u=me(h,xa(".quick-input-filter")),f=this._register(new Mnt(u,this.styles.inputBox,this.styles.toggle));f.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=me(u,xa(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const m=this._register(new BW(g,{countFormat:_(1764,"{0} Results")},this.styles.countBadge)),p=me(u,xa(".quick-input-count"));p.setAttribute("aria-live","polite");const v=this._register(new BW(p,{countFormat:_(1765,"{0} Selected")},this.styles.countBadge)),b=this._register(new Fr(l,{hoverDelegate:this.options.hoverDelegate}));b.domNode.classList.add("quick-input-inline-action-bar");const w=me(l,xa(".quick-input-action")),C=this._register(new g2(w,this.styles.button));C.label=_(1766,"OK"),this._register(C.onDidClick(P=>{this.onDidAcceptEmitter.fire()}));const y=me(l,xa(".quick-input-action")),x=this._register(new g2(y,{...this.styles.button,supportIcons:!0}));x.label=_(1767,"Custom"),this._register(x.onDidClick(P=>{this.onDidCustomEmitter.fire()}));const S=me(h,xa(`#${this.idPrefix}message.quick-input-message`)),L=this._register(new jV(t,this.styles.progressBar));L.getContainer().classList.add("quick-input-progress");const E=me(t,xa(".quick-input-html-widget"));E.tabIndex=-1;const M=me(t,xa(".quick-input-description")),R=this.idPrefix+"list",T=this._register(this.instantiationService.createInstance(JI,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,R));f.setAttribute("aria-controls",R),this._register(T.onDidChangeFocus(()=>{f.hasFocus()&&f.setAttribute("aria-activedescendant",T.getActiveDescendant()??"")})),this._register(T.onChangedAllVisibleChecked(P=>{c.checked=P})),this._register(T.onChangedVisibleCount(P=>{m.setCount(P)})),this._register(T.onChangedCheckedCount(P=>{ok(()=>v.setCount(P))})),this._register(T.onLeave(()=>{setTimeout(()=>{this.controller&&(f.setFocus(),this.controller instanceof Nx&&this.controller.canSelectMany&&T.clearFocus())},0)}));const A=this._register(this.instantiationService.createInstance(XV,t,this.options.hoverDelegate));this._register(A.tree.onDidChangeFocus(()=>{f.hasFocus()&&f.setAttribute("aria-activedescendant",A.getActiveDescendant()??"")})),this._register(A.onLeave(()=>{setTimeout(()=>{this.controller&&(f.setFocus(),A.tree.setFocus([]))},0)})),this._register(A.onDidAccept(()=>{this.onDidAcceptEmitter.fire()})),this._register(A.tree.onDidChangeContentHeight(()=>this.updateLayout()));const N=Ol(t);return this._register(N),this._register(ee(t,ye.FOCUS,P=>{const W=this.getUI();if(Ps(P.relatedTarget,W.inputContainer)){const H=W.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==H&&this.endOfQuickInputBoxContext.set(H)}Ps(P.relatedTarget,W.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=Bn(P.relatedTarget)?P.relatedTarget:void 0)},!0)),this._register(N.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(hI.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(f.onKeyDown(P=>{const W=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==W&&this.endOfQuickInputBoxContext.set(W),f.removeAttribute("aria-activedescendant")})),this._register(ee(t,ye.FOCUS,P=>{f.setFocus()})),this.dndController=this._register(this.instantiationService.createInstance(JV,this._container,t,[{node:n,includeChildren:!0},{node:l,includeChildren:!1}],this.viewState)),this._register(lt(P=>{var H;const W=(H=this.dndController)==null?void 0:H.dndViewState.read(P);W&&(W.top!==void 0&&W.left!==void 0?this.viewState={...this.viewState,top:W.top,left:W.left}:this.viewState=void 0,this.updateLayout(),W.done&&this.saveViewState(this.viewState))})),this.ui={container:t,styleSheet:i,leftActionBar:o,titleBar:n,title:r,description1:M,description2:d,widget:E,rightActionBar:a,inlineActionBar:b,checkAll:c,inputContainer:h,filterContainer:u,inputBox:f,visibleCountContainer:g,visibleCount:m,countContainer:p,count:v,okContainer:w,ok:C,message:S,customButtonContainer:y,customButton:x,list:T,tree:A,progressBar:L,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:P=>this.show(P),hide:()=>this.hide(),setVisibilities:P=>this.setVisibilities(P),setEnabled:P=>this.setEnabled(P),setContextKey:P=>this.options.setContextKey(P),linkOpenerDelegate:P=>this.options.linkOpenerDelegate(P)},this.updateStyles(),this.ui}reparentUI(e){var t;this.ui&&(this._container=e,me(this._container,this.ui.container),(t=this.dndController)==null||t.reparentUI(this._container))}pick(e,t={},i=Ft.None){return new Promise((n,o)=>{let r=d=>{var h;r=n,(h=t.onKeyMods)==null||h.call(t,a.keyMods),n(d)};if(i.isCancellationRequested){r(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)r(a.selectedItems.slice()),a.hide();else{const d=a.activeItems[0];d&&(r(d),a.hide())}}),a.onDidChangeActive(d=>{const h=d[0];h&&t.onDidFocus&&t.onDidFocus(h)}),a.onDidChangeSelection(d=>{if(!a.canSelectMany){const h=d[0];h&&(r(h),a.hide())}}),a.onDidTriggerItemButton(d=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...d,removeItem:()=>{const h=a.items.indexOf(d.item);if(h!==-1){const u=a.items.slice(),f=u.splice(h,1),g=a.activeItems.filter(p=>p!==f[0]),m=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=u,g&&(a.activeItems=g),a.keepScrollPosition=m}}})),a.onDidTriggerSeparatorButton(d=>{var h;return(h=t.onDidTriggerSeparatorButton)==null?void 0:h.call(t,d)}),a.onDidChangeValue(d=>{l&&!d&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{yi(c),r(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.prompt=t.prompt,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,t.sortByLabel!==void 0&&(a.sortByLabel=t.sortByLabel),a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([d,h])=>{l=h,a.busy=!1,a.items=d,a.canSelectMany&&(a.selectedItems=d.filter(u=>u.type!=="separator"&&u.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,d=>{o(d),a.hide()})})}setValidationOnInput(e,t){t&&As(t)?(e.severity=xn.Error,e.validationMessage=t):t&&!As(t)?(e.severity=t.severity,e.validationMessage=t.content):(e.severity=xn.Ignore,e.validationMessage=void 0)}input(e={},t=Ft.None){return new Promise(i=>{if(t.isCancellationRequested){i(void 0);return}const n=this.createInputBox(),o=e.validateInput||(()=>Promise.resolve(void 0)),r=Se.debounce(n.onDidChangeValue,(d,h)=>h,100);let a=e.value||"",l=Promise.resolve(o(a));const c=[n,r(d=>{d!==a&&(l=Promise.resolve(o(d)),a=d),l.then(h=>{d===a&&this.setValidationOnInput(n,h)})}),n.onDidAccept(()=>{const d=n.value;d!==a&&(l=Promise.resolve(o(d)),a=d),l.then(h=>{!h||!As(h)&&h.severity!==xn.Error?(i(d),n.hide()):d===a&&this.setValidationOnInput(n,h)})}),t.onCancellationRequested(()=>{n.hide()}),n.onDidHide(()=>{yi(c),i(void 0)})];n.title=e.title,n.value=e.value||"",n.valueSelection=e.valueSelection,n.prompt=e.prompt,n.placeholder=e.placeHolder,n.password=!!e.password,n.ignoreFocusOut=!!e.ignoreFocusLost,n.show()})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new Nx(t)}createInputBox(){const e=this.getUI(!0);return new Nnt(e)}show(e){var o;const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",Os(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(xn.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),Os(t.message),t.progressBar.stop(),t.progressBar.getContainer().setAttribute("aria-hidden","true"),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.tree.updateFilterOptions({matchOnDescription:!1,matchOnLabel:!0}),t.tree.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const n=this.options.backKeybindingLabel();$V.tooltip=n?_(1768,"Back ({0})",n):_(1769,"Back"),t.container.style.display="",this.updateLayout(),(o=this.dndController)==null||o.layoutContainer(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.domNode.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.tree.displayed=!!e.tree,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;const t=this.getUI();for(const i of t.leftActionBar.viewItems)i.action.enabled=e;for(const i of t.rightActionBar.viewItems)i.action.enabled=e;e?t.checkAll.enable():t.checkAll.disable(),t.inputBox.enabled=e,t.ok.enabled=e,t.list.enabled=e}}hide(e){var o;const t=this.controller;if(!t)return;t.willHide(e);const i=(o=this.ui)==null?void 0:o.container,n=i&&!_oe(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!n){let r=this.previousFocusElement;for(;r&&!r.offsetParent;)r=r.parentElement??void 0;r!=null&&r.offsetParent?(r.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}toggleHover(){this.isVisible()&&this.controller instanceof Nx&&this.getUI().list.toggleHover()}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){var e,t;if(this.ui&&this.isVisible()){const i=this.ui.container.style,n=Math.min(this.dimension.width*.62,ZV.MAX_WIDTH);i.width=n+"px",i.top=`${(e=this.viewState)!=null&&e.top?Math.round(this.dimension.height*this.viewState.top):this.titleBarOffset}px`,i.left=`${Math.round(this.dimension.width*(((t=this.viewState)==null?void 0:t.left)??.5)-n/2)}px`,this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4),this.ui.tree.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:n,widgetShadow:o}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=o?`0 0 8px 2px ${o}`:"",this.ui.list.style(this.styles.list),this.ui.tree.tree.style(this.styles.list);const r=[];this.styles.pickerGroup.pickerGroupBorder&&r.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(r.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&r.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&r.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&r.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&r.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&r.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),r.push("}"));const a=r.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}loadViewState(){try{const e=JSON.parse(this.storageService.get(V3,-1,"{}"));if(e.top!==void 0||e.left!==void 0)return e}catch{}}saveViewState(e){this.layoutService.activeContainer===this.layoutService.mainContainer&&(e!==void 0?this.storageService.store(V3,JSON.stringify(e),-1,1):this.storageService.remove(V3,-1))}},ZV=bb,bb.MAX_WIDTH=600,bb);QV=ZV=Lfe([n_(1,Bh),n_(2,$e),n_(3,ut),n_(4,sr)],QV);let JV=class extends K{constructor(e,t,i,n,o,r,a){super(),this._container=e,this._quickInputContainer=t,this._quickInputDragAreas=i,this._layoutService=o,this.configurationService=a,this.dndViewState=ht(this,void 0),this._snapThreshold=20,this._snapLineHorizontalRatio=.25,this._quickInputAlignmentContext=Ent.bindTo(r);const l=D6e(this.configurationService)==="custom";this._controlsOnLeft=l&&S5===1,this._controlsOnRight=l&&(S5===3||S5===2),this._registerLayoutListener(),this.registerMouseListeners(),this.dndViewState.set({...n,done:!0},void 0)}reparentUI(e){this._container=e}layoutContainer(e=this._layoutService.activeContainerDimension){const t=this.dndViewState.get(),i=this._quickInputContainer.getBoundingClientRect();if(t!=null&&t.top&&(t!=null&&t.left)){const n=Math.round(t.left*100)/100,o=e.width,r=i.width,a=n*o-r/2;this._layout(t.top*e.height,a)}}_registerLayoutListener(){this._register(Se.filter(this._layoutService.onDidLayoutContainer,e=>e.container===this._container)(e=>this.layoutContainer(e.dimension)))}registerMouseListeners(){const e=this._quickInputContainer;this._register(iY(e,t=>{const i=new Co(je(e),t);i.detail===2&&this._quickInputDragAreas.some(({node:n,includeChildren:o})=>o?Ps(i.target,n):i.target===n)&&this.dndViewState.set({top:void 0,left:void 0,done:!0},void 0)})),this._register(foe(e,t=>{const i=je(this._layoutService.activeContainer),n=new Co(i,t);if(!this._quickInputDragAreas.some(({node:h,includeChildren:u})=>u?Ps(n.target,h):n.target===h))return;const o=this._quickInputContainer.getBoundingClientRect(),r=n.browserEvent.clientX-o.left,a=n.browserEvent.clientY-o.top;let l=!1;const c=MTe(i,h=>{new Co(i,h).preventDefault(),l||(l=!0),this._layout(h.clientY-a,h.clientX-r)}),d=iY(i,h=>{if(l){const u=this.dndViewState.get();this.dndViewState.set({top:u==null?void 0:u.top,left:u==null?void 0:u.left,done:!0},void 0)}c.dispose(),d.dispose()})}))}_layout(e,t){const i=this._getTopSnapValue(),n=this._getCenterYSnapValue(),o=this._getCenterXSnapValue();e=Math.max(0,Math.min(e,this._container.clientHeight-this._quickInputContainer.clientHeight)),e<this._layoutService.activeContainerOffset.top&&(this._controlsOnLeft?t=Math.max(t,80/_9(xi())):this._controlsOnRight&&(t=Math.min(t,this._container.clientWidth-this._quickInputContainer.clientWidth-140/_9(xi()))));const r=Math.abs(e-i)<this._snapThreshold;e=r?i:e;const a=Math.abs(e-n)<this._snapThreshold;e=a?n:e;const l=e/this._container.clientHeight;t=Math.max(0,Math.min(t,this._container.clientWidth-this._quickInputContainer.clientWidth));const c=Math.abs(t-o)<this._snapThreshold;t=c?o:t;const d=this._container.clientWidth,h=this._quickInputContainer.clientWidth,f=(t+h/2)/d;if(this.dndViewState.set({top:l,left:f,done:!1},void 0),c){if(r){this._quickInputAlignmentContext.set("top");return}else if(a){this._quickInputAlignmentContext.set("center");return}}this._quickInputAlignmentContext.set(void 0)}_getTopSnapValue(){return this._layoutService.activeContainerOffset.quickPickTop}_getCenterYSnapValue(){return Math.round(this._container.clientHeight*this._snapLineHorizontalRatio)}_getCenterXSnapValue(){return Math.round(this._container.clientWidth/2)-Math.round(this._quickInputContainer.clientWidth/2)}};JV=Lfe([n_(4,Bh),n_(5,ut),n_(6,xt)],JV);var Qnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},hS=function(s,e){return function(t,i){e(t,i,s)}};let ez=class extends bOe{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(UV))),this._quickAccess}constructor(e,t,i,n,o){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=n,this.configurationService=o,this._onShow=this._register(new q),this._onHide=this._register(new q),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:o=>this.setContextKey(o),linkOpenerDelegate:o=>{this.instantiationService.invokeFunction(r=>{r.get(Rf).open(o,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(qV))},n=this._register(this.instantiationService.createInstance(QV,{...i,...t}));return n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(o=>{je(e.activeContainer)===je(n.container)&&n.layout(o,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{n.isVisible()||n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(n.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(n.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Ne(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=Ft.None){return this.controller.pick(e,t,i)}input(e={},t=Ft.None){return this.controller.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}toggleHover(){this.hasController&&this.controller.toggleHover()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:ve(G5),quickInputForeground:ve(aPe),quickInputTitleBackground:ve(lPe),widgetBorder:ve(c$),widgetShadow:ve(c0)},inputBox:s2,toggle:n2,countBadge:lce,button:y6e,progressBar:S6e,keybindingLabel:ace,list:Lv({listBackground:G5,listFocusBackground:OL,listFocusForeground:PL,listInactiveFocusForeground:PL,listInactiveSelectionIconForeground:m$,listInactiveFocusBackground:OL,listFocusOutline:fn,listInactiveFocusOutline:fn,treeStickyScrollBackground:G5}),pickerGroup:{pickerGroupBorder:ve(cPe),pickerGroupForeground:ve(Tre)}}}};ez=Qnt([hS(0,$e),hS(1,ut),hS(2,Dn),hS(3,Bh),hS(4,xt)],ez);var Ife=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Ep=function(s,e){return function(t,i){e(t,i,s)}};let tz=class extends ez{constructor(e,t,i,n,o,r){super(t,i,n,new xV(e.getContainerDomNode(),o),r),this.host=void 0;const a=tE.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return Se.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return Se.None},get onDidAddContainer(){return Se.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};tz=Ife([Ep(1,$e),Ep(2,ut),Ep(3,Dn),Ep(4,ii),Ep(5,xt)],tz);let iz=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(tz,e);this.mapEditorToService.set(e,t),Tb(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=Ft.None){return this.activeService.pick(e,t,i)}input(e,t){return this.activeService.input(e,t)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}toggleHover(){return this.activeService.toggleHover()}};iz=Ife([Ep(0,$e),Ep(1,ii)],iz);const VP=class VP{static get(e){return e.getContribution(VP.ID)}constructor(e){this.editor=e,this.widget=new nz(this.editor)}dispose(){this.widget.dispose()}};VP.ID="editor.controller.quickInput";let tE=VP;const zP=class zP{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return zP.ID}getDomNode(){return this.domNode}getPosition(){return{preference:{top:0,left:0}}}dispose(){this.codeEditor.removeOverlayWidget(this)}};zP.ID="editor.contrib.quickInputWidget";let nz=zP;Qt(tE.ID,tE,4);var Jnt=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},z3=function(s,e){return function(t,i){e(t,i,s)}};let sz=class extends K{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new q,this._onDidChangeReducedMotion=new q,this._onDidChangeLinkUnderline=new q,this._accessibilityModeEnabledContext=a0.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),r.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const o=Ti.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=o.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(o),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(ee(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("monaco-reduce-motion",i),this._layoutService.mainContainer.classList.toggle("monaco-enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};sz=Jnt([z3(0,ut),z3(1,Bh),z3(2,xt)],sz);var est=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},jte=function(s,e){return function(t,i){e(t,i,s)}},oz;const Kte="application/vnd.code.resources";var vb;let rz=(vb=class extends K{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(Eb||yse)&&this.installWebKitWriteTextWorkaround(),this._register(Se.runAndSubscribe(hk,({window:i,disposables:n})=>{n.add(ee(i.document,"copy",()=>this.clearResourcesState()))},{window:Ti,disposables:this._store}))}triggerPaste(){this.logService.trace("BrowserClipboardService#triggerPaste")}installWebKitWriteTextWorkaround(){const e=()=>{const t=new gv;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,xi().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(Se.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(ee(t,"click",e)),i.add(ee(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.logService.trace("BrowserClipboardService#writeText called with type:",t," text.length:",e.length),this.clearResourcesState(),t){this.mapTextToType.set(t,e),this.logService.trace("BrowserClipboardService#writeText");return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return this.logService.trace("before navigator.clipboard.writeText"),await xi().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){this.logService.trace("BrowserClipboardService#fallbackWriteText");const t=uk(),i=t.activeElement,n=t.body.appendChild(we("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),t.execCommand("copy"),Bn(i)&&i.focus(),n.remove()}async readText(e){if(this.logService.trace("BrowserClipboardService#readText called with type:",e),e){const t=this.mapTextToType.get(e)||"";return this.logService.trace("BrowserClipboardService#readText text.length:",t.length),t}try{const t=await xi().navigator.clipboard.readText();return this.logService.trace("BrowserClipboardService#readText text.length:",t.length),t}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}async readResources(){try{const t=await xi().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${Kte}`)){const n=await i.getType(`web ${Kte}`);return JSON.parse(await n.text()).map(r=>Ze.from(r))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return dk(e.substring(0,oz.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}},oz=vb,vb.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,vb);rz=oz=est([jte(0,Bh),jte(1,Ji)],rz);var tst=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ist=function(s,e){return function(t,i){e(t,i,s)}};const Rx="data-keybinding-context";let Zj=class{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}};const UP=class UP extends Zj{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}};UP.INSTANCE=new UP;let Zw=UP;const eL=class eL extends Zj{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=T1.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const o=Array.from(this._values,([r])=>r);this._values.clear(),i.fire(new Yte(o))}else{const o=[];for(const r of n.affectedKeys){const a=`config.${r}`,l=this._values.findSuperstr(a);l!==void 0&&(o.push(...Gt.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(o.push(a),this._values.delete(a))}i.fire(new Yte(o))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(eL._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(eL._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}};eL._keyPrefix="config.";let az=eL;class nst{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class Gte{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class Yte{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class sst{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function ost(s,e){return s.allKeysContainedIn(new Set(Object.keys(e)))}class Efe extends K{get onDidChangeContext(){return this._onDidChangeContext.event}constructor(e){super(),this._onDidChangeContext=this._register(new Nb({merge:t=>new sst(t)})),this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new nst(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new rst(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new Gte(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new Gte(e))}getContext(e){return this._isDisposed?Zw.INSTANCE:this.getContextValuesContainer(ast(e))}dispose(){super.dispose(),this._isDisposed=!0}}let lz=class extends Efe{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0,this.inputFocusedContext=Xq.bindTo(this);const t=this._register(new az(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t),this._register(Se.runAndSubscribe(hk,({window:i,disposables:n})=>{const o=n.add(new mi);n.add(ee(i,ye.FOCUS_IN,()=>{o.value=new oe,this.updateInputContextKeys(i.document,o.value)},!0))},{window:Ti,disposables:this._store}))}updateInputContextKeys(e,t){function i(){return!!e.activeElement&&nd(e.activeElement)}const n=i();if(this.inputFocusedContext.set(n),n){const o=t.add(Ol(e.activeElement));Se.once(o.onDidBlur)(()=>{xi().document===e&&this.inputFocusedContext.set(i()),o.dispose()},void 0,t)}}getContextValuesContainer(e){return this._isDisposed?Zw.INSTANCE:this._contexts.get(e)||Zw.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new Zj(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};lz=tst([ist(0,xt)],lz);class rst extends Efe{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new mi),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(Rx)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(Rx,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;ost(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(Rx),super.dispose())}getContextValuesContainer(e){return this._isDisposed?Zw.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function ast(s){for(;s;){if(s.hasAttribute(Rx)){const e=s.getAttribute(Rx);return e?parseInt(e,10):NaN}s=s.parentElement}return 0}function lst(s,e,t){s.get(ut).createKey(String(e),cst(t))}function cst(s){return Voe(s,e=>{if(typeof e=="object"&&e.$mid===1)return Ze.revive(e).toString();if(e instanceof Ze)return e.toString()})}Zt.registerCommand("_setContext",lst);Zt.registerCommand({id:"getContextKeyInfo",handler(){return[...Ne.all()].sort((s,e)=>s.key.localeCompare(e.key))},metadata:{description:_(1674,"A command that returns information about context keys"),args:[]}});Zt.registerCommand("_generateContextKeyInfo",function(){const s=[],e=new Set;for(const t of Ne.all())e.has(t.key)||(e.add(t.key),s.push(t));s.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(s,void 0,2))});let dst=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class Xte{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new dst(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const o=this._findCycle(n,t);if(o)return o;t.delete(i)}}}const hst=!1;class Zte extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class ZM{constructor(e=new g0,t=!1,i,n=hst){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set($e,this),this._globalGraph=n?(i==null?void 0:i._globalGraph)??new Xte(o=>o):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,yi(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)fv(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,n=new class extends ZM{dispose(){i._children.delete(n),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(n),t==null||t.add(n),n}invokeFunction(e,...t){this._throwIfDisposed();const i=Mx.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:r=>{if(n)throw WN("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(r,i);if(!a)throw new Error(`[invokeFunction] unknown service '${r}'`);return a},getIfExists:r=>{if(n)throw WN("service accessor is only valid during the invocation of its target method");return this._getOrCreateServiceInstance(r,i)}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof Zd?(i=Mx.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Mx.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=Jc.getServiceDependencies(e).sort((a,l)=>a.index-l.index),o=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),o.push(l)}const r=n.length>0?n[0].index:t.length;if(t.length!==r){console.trace(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);const a=r-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,r)}return Reflect.construct(e,t.concat(o))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof Zd)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Zd?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var l;const n=new Xte(c=>c.id.toString());let o=0;const r=[{id:e,desc:t,_trace:i}],a=new Set;for(;r.length;){const c=r.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),n.lookupOrInsertNode(c),o++>1e3)throw new Zte(n);for(const d of Jc.getServiceDependencies(c.desc.ctor)){const h=this._getServiceInstanceOrDescriptor(d.id);if(h||this._throwIfStrict(`[createInstance] ${e} depends on ${d.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(d.id)),h instanceof Zd){const u={id:d.id,desc:h,_trace:c._trace.branch(d.id,!0)};n.insertEdge(c,u),r.push(u)}}}}for(;;){const c=n.roots();if(c.length===0){if(!n.isEmpty())throw new Zte(n);break}for(const{data:d}of c){if(this._getServiceInstanceOrDescriptor(d.id)instanceof Zd){const u=this._createServiceInstanceWithOwner(d.id,d.desc.ctor,d.desc.staticArguments,d.desc.supportsDelayedInstantiation,d._trace);this._setCreatedServiceInstance(d.id,u)}n.removeNode(d)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,o){if(this._services.get(e)instanceof Zd)return this._createServiceInstance(e,t,i,n,o,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,o);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,o,r){if(n){const a=new ZM(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new sDe(()=>{const d=a._createInstance(t,i,o);for(const[h,u]of l){const f=d[h];if(typeof f=="function")for(const g of u)g.disposable=f.apply(d,g.listener)}return l.clear(),r.add(d),d});return new Proxy(Object.create(null),{get(d,h){if(!c.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let g=l.get(h);return g||(g=new Zo,l.set(h,g)),(p,v,b)=>{if(c.isInitialized)return c.value[h](p,v,b);{const w={listener:[p,v,b],disposable:void 0},C=g.push(w);return Ve(()=>{var x;C(),(x=w.disposable)==null||x.dispose()})}}}if(h in d)return d[h];const u=c.value;let f=u[h];return typeof f!="function"||(f=f.bind(u),d[h]=f),f},set(d,h,u){return c.value[h]=u,!0},getPrototypeOf(d){return t.prototype}})}else{const a=this._createInstance(t,i,o);return r.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const Ta=class Ta{static traceInvocation(e,t){return e?new Ta(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Ta._None}static traceCreation(e,t){return e?new Ta(1,t.name):Ta._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new Ta(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;Ta._totals+=e;let t=!1;function i(o,r){const a=[],l=new Array(o+1).join("	");for(const[c,d,h]of r._dep)if(d&&h){t=!0,a.push(`${l}CREATES -> ${c}`);const u=i(o+1,h);u&&a.push(u)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${Ta._totals.toFixed(2)}ms)`];(e>2||t)&&Ta.all.add(n.join(`
`))}};Ta.all=new Set,Ta._None=new class extends Ta{constructor(){super(0,null)}stop(){}branch(){return this}},Ta._totals=0;let Mx=Ta;const ust=new Set([ct.inMemory,ct.vscodeSourceControl,ct.walkThrough,ct.walkThroughSnippet,ct.vscodeChatCodeBlock,ct.vscodeTerminal]);class fst{constructor(){this._byResource=new ts,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let o=this._byOwner.get(t);o||(o=new ts,this._byOwner.set(t,o)),o.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,n=!1;const o=this._byResource.get(e);o&&(i=o.delete(t));const r=this._byOwner.get(t);if(r&&(n=r.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){var t,i;return typeof e=="string"?((t=this._byOwner.get(e))==null?void 0:t.values())??Gt.empty():Ze.isUri(e)?((i=this._byResource.get(e))==null?void 0:i.values())??Gt.empty():Gt.map(Gt.concat(...this._byOwner.values()),n=>n[1])}}class gst{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new ts,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(ust.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===In.Error?t.errors+=1:i===In.Warning?t.warnings+=1:i===In.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class kp{constructor(){this._onMarkerChanged=new Tse({delay:0,merge:kp._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new fst,this._stats=new gst(this),this._filteredResources=new ts}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(eoe(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const o of i){const r=kp._toMarker(e,t,o);r&&n.push(r)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:o,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:f,origin:g}=i;if(r)return l=l>0?l:1,c=c>0?c:1,d=d>=l?d:l,h=h>0?h:c,{resource:t,owner:e,code:n,severity:o,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:f,origin:g}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const o of n){const r=Gt.first(o);r&&(i.push(r.resource),this._data.delete(r.resource,e))}if(er(t)){const o=new ts;for(const{resource:r,marker:a}of t){const l=kp._toMarker(e,r,a);if(!l)continue;const c=o.get(r);c?c.push(l):(o.set(r,[l]),i.push(r))}for(const[r,a]of o)this._data.set(r,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}_createFilteredMarker(e,t){const i=t.length===1?_(1738,'Problems are paused because: "{0}"',t[0]):_(1739,'Problems are paused because: "{0}" and {1} more',t[0],t.length-1);return{owner:"markersFilter",resource:e,severity:In.Info,message:i,startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1}}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:o}=e;if((!o||o<0)&&(o=-1),t&&i){const r=e.ignoreResourceFilters?void 0:this._filteredResources.get(i);if(r!=null&&r.length)return[this._createFilteredMarker(i,r)];const a=this._data.get(i,t);if(!a)return[];const l=[];for(const c of a){if(o>0&&l.length===o)break;const d=e.ignoreResourceFilters?void 0:this._filteredResources.get(i);d!=null&&d.length?l.push(this._createFilteredMarker(i,d)):kp._accept(c,n)&&l.push(c)}return l}else{const r=!t&&!i?this._data.values():this._data.values(i??t),a=[],l=new CNe;for(const c of r)for(const d of c){if(l.has(d.resource))continue;if(o>0&&a.length===o)break;const h=e.ignoreResourceFilters?void 0:this._filteredResources.get(d.resource);h!=null&&h.length?(a.push(this._createFilteredMarker(d.resource,h)),l.add(d.resource)):kp._accept(d,n)&&a.push(d)}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new ts;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}class mst extends K{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=eo.createEmptyModel(e)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=eo.createEmptyModel(this.logService);const e=kn.as(vd.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const n of e){const o=i[n],r=t[n];o!==void 0?this._configurationModel.setValue(n,o):r?this._configurationModel.setValue(n,Xd(r.default)):this._configurationModel.removeValue(n)}}}class pst extends K{constructor(e,t=[]){super(),this.logger=new RNe([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}class _st{getParserClass(){throw new Error("not implemented in StandaloneTreeSitterLibraryService")}supportsLanguage(e,t){return!1}getLanguage(e,t,i){}getInjectionQueries(e,t){return null}getHighlightingQueries(e,t){return null}}var Vh=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},rs=function(s,e){return function(t,i){e(t,i,s)}};class bst{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new q}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let cz=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new $ke(new bst(t))):Promise.reject(new Error("Model not found"))}};cz=Vh([rs(0,Cn)],cz);const $P=class $P{show(){return $P.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}};$P.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};let dz=$P;class vst{withProgress(e,t,i){return t({report:()=>{}})}}class Cst{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class wst{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),Ti.confirm(i)}async prompt(e){var n;let t;if(this.doConfirm(e.message,e.detail)){const o=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&o.push(e.cancelButton),t=await((n=o[0])==null?void 0:n.run({checkboxChecked:!1}))}return{result:t}}async error(e,t){await this.prompt({type:xn.Error,message:e,detail:t})}}const tL=class tL{info(e){return this.notify({severity:xn.Info,message:e})}warn(e){return this.notify({severity:xn.Warning,message:e})}error(e){return this.notify({severity:xn.Error,message:e})}notify(e){switch(e.severity){case xn.Error:console.error(e.message);break;case xn.Warning:console.warn(e.message);break;default:console.log(e.message);break}return tL.NO_OP}prompt(e,t,i,n){return tL.NO_OP}status(e,t){return{close:()=>{}}}};tL.NO_OP=new u5e;let hz=tL,uz=class{constructor(e){this._onWillExecuteCommand=new q,this._onDidExecuteCommand=new q,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=Zt.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};uz=Vh([rs(0,$e)],uz);let Qw=class extends Qit{constructor(e,t,i,n,o,r){super(e,t,i,n,o),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=f=>{const g=new oe;g.add(ee(f,ye.KEY_DOWN,m=>{const p=new Bi(m);this._dispatch(p,p.target)&&(p.preventDefault(),p.stopPropagation())})),g.add(ee(f,ye.KEY_UP,m=>{const p=new Bi(m);this._singleModifierDispatch(p,p.target)&&p.preventDefault()})),this._domNodeListeners.push(new yst(f,g))},l=f=>{for(let g=0;g<this._domNodeListeners.length;g++){const m=this._domNodeListeners[g];m.domNode===f&&(this._domNodeListeners.splice(g,1),m.dispose())}},c=f=>{f.getOption(70)||a(f.getContainerDomNode())},d=f=>{f.getOption(70)||l(f.getContainerDomNode())};this._register(r.onCodeEditorAdd(c)),this._register(r.onCodeEditorRemove(d)),r.listCodeEditors().forEach(c);const h=f=>{a(f.getContainerDomNode())},u=f=>{l(f.getContainerDomNode())};this._register(r.onDiffEditorAdd(h)),this._register(r.onDiffEditorRemove(u)),r.listDiffEditors().forEach(h)}addDynamicKeybinding(e,t,i,n){return dc(Zt.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:S9(i.keybinding,sa),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),Ve(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Ks.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new Tx(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return Ti.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const o of e){const r=o.when||void 0,a=o.keybinding;if(!a)i[n++]=new Dte(void 0,o.command,o.commandArgs,r,t,null,!1);else{const l=XI.resolveKeybinding(a,sa);for(const c of l)i[n++]=new Dte(c,o.command,o.commandArgs,r,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new lf(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new XI([t],sa)}};Qw=Vh([rs(0,ut),rs(1,en),rs(2,Wo),rs(3,Hn),rs(4,Ji),rs(5,ii)],Qw);class yst extends K{constructor(e,t){super(),this.domNode=e,this._register(t)}}function Qte(s){return!!s&&typeof s=="object"&&(!s.overrideIdentifier||typeof s.overrideIdentifier=="string")&&(!s.resource||s.resource instanceof Ze)}let QM=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new q,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new mst(e);this._configuration=new K4(t.reload(),eo.createEmptyModel(e),eo.createEmptyModel(e),eo.createEmptyModel(e),eo.createEmptyModel(e),eo.createEmptyModel(e),new ts,eo.createEmptyModel(e),new ts,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,n=Qte(e)?e:Qte(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[o,r]=n;this.getValue(o)!==r&&(this._configuration.updateValue(o,r),i.push(o))}if(i.length>0){const n=new Git({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);n.source=8,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};QM=Vh([rs(0,Ji)],QM);let fz=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new q,this.configurationService.onDidChangeConfiguration(n=>{this._onDidChangeConfiguration.fire({affectedKeys:n.affectedKeys,affectsConfiguration:(o,r)=>n.affectsConfiguration(r)})})}getValue(e,t,i){const n=z.isIPosition(t)?t:null,o=n?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,r=e?this.getLanguage(e,n):void 0;return typeof o>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:r}):this.configurationService.getValue(o,{resource:e,overrideIdentifier:r})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};fz=Vh([rs(0,xt),rs(1,Cn),rs(2,Wn)],fz);let gz=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:Hr||Bt?`
`:`\r
`}};gz=Vh([rs(0,xt)],gz);class Sst{publicLog2(){}}const iL=class iL{constructor(){const e=Ze.from({scheme:iL.SCHEME,authority:"model",path:"/"});this.workspace={id:Tce,folders:[new FHe({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===iL.SCHEME?this.workspace.folders[0]:null}};iL.SCHEME="inmemory";let mz=iL;function JM(s,e,t){if(!e||!(s instanceof QM))return;const i=[];Object.keys(e).forEach(n=>{tVe(n)&&i.push([`editor.${n}`,e[n]]),t&&iVe(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&s.updateValues(i)}let pz=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:wq.convert(e),n=new Map;for(const a of i){if(!(a instanceof zg))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=n.get(l);c||(c=[],n.set(l,c)),c.push(Pn.replaceMove(D.lift(a.textEdit.range),a.textEdit.text))}let o=0,r=0;for(const[a,l]of n)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),r+=1,o+=l.length;return{ariaSummary:Rb(lH.bulkEditServiceSummary,o,r),isApplied:o>0}}};pz=Vh([rs(0,Cn)],pz);class xst{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return Fl(e)}}let _z=class extends Hit{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};_z=Vh([rs(0,Bh),rs(1,ii)],_z);class Lst{constructor(){this._neverEmitter=new q,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class Ist extends RV{constructor(){super()}}class Est extends pst{constructor(){super(new NNe)}}let bz=class extends PV{constructor(e,t,i,n,o,r){super(e,t,i,n,o,r),this.configure({blockMouse:!1})}};bz=Vh([rs(0,Wo),rs(1,Hn),rs(2,Nf),rs(3,ai),rs(4,Vl),rs(5,ut)],bz);const kst={esmModuleLocation:void 0,label:"editorWorkerService"};let vz=class extends CV{constructor(e,t,i,n,o){super(kst,e,t,i,n,o)}};vz=Vh([rs(0,Cn),rs(1,V4),rs(2,Ji),rs(3,wn),rs(4,We)],vz);class Dst{async playSignal(e,t){}}Vt(Ji,Est,0);Vt(xt,QM,0);Vt(V4,fz,0);Vt(xue,gz,0);Vt(wf,mz,0);Vt(nv,xst,0);Vt(Wo,Sst,0);Vt($k,wst,0);Vt(Nq,Cst,0);Vt(Hn,hz,0);Vt(Wh,kp,0);Vt(Wn,Ist,0);Vt(ol,Rtt,0);Vt(Cn,VV,0);Vt(t$,HV,0);Vt(ut,lz,0);Vt(nle,vst,0);Vt(vf,dz,0);Vt(sr,C6e,0);Vt(jr,vz,0);Vt(Rk,pz,0);Vt(Oue,Lst,0);Vt(nr,cz,0);Vt(so,sz,0);Vt(ql,k$e,0);Vt(en,uz,0);Vt(ai,Qw,0);Vt(Fo,iz,0);Vt(Nf,_z,0);Vt(Rf,WV,0);Vt(pa,rz,0);Vt(sl,bz,0);Vt(Vl,z7,0);Vt(Df,Dst,0);Vt(H$,_st,0);Vt(Noe,PNe,0);Vt(Cj,$Ke,0);var bt;(function(s){const e=new g0;for(const[l,c]of SY())e.set(l,c);const t=new ZM(e,!0);e.set($e,t);function i(l){n||r({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof Zd?t.invokeFunction(d=>d.get(l)):c}s.get=i;let n=!1;const o=new q;function r(l){if(n)return t;n=!0;for(const[d,h]of SY())e.get(d)||e.set(d,h);for(const d in l)if(l.hasOwnProperty(d)){const h=Mt(d);e.get(h)instanceof Zd&&e.set(h,l[d])}const c=FVe();for(const d of c)try{t.createInstance(d)}catch(h){_t(h)}return o.fire(),t}s.initialize=r;function a(l){if(n)return l();const c=new oe,d=c.add(o.event(()=>{d.dispose(),c.add(l())}));return c}s.withServices=a})(bt||(bt={}));var Tst=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Jte=function(s,e){return function(t,i){e(t,i,s)}},vN,Cb;let Cz=(Cb=class{constructor(e,t){this._configurationService=e,this._languageService=t}async renderCodeBlock(e,t,i){var d;const n=gd(i.context)?i.context:void 0;let o;e?o=this._languageService.getLanguageIdByLanguageName(e):n&&(o=(d=n.getModel())==null?void 0:d.getLanguageId()),o||(o=Za);const r=await O9e(this._languageService,t,o),a=vN._ttpTokenizer?vN._ttpTokenizer.createHTML(r)??r:r,l=document.createElement("span");l.innerHTML=a;const c=l.querySelector(".monaco-tokenized-source");return Bn(c)?(js(c,this.getFontInfo(n)),l):document.createElement("span")}getFontInfo(e){return e?e.getOption(59):gMe({fontFamily:this._configurationService.getValue("editor").fontFamily},1)}},vN=Cb,Cb._ttpTokenizer=Oh("tokenizeToString",{createHTML(e){return e}}),Cb);Cz=vN=Tst([Jte(0,xt),Jte(1,Wn)],Cz);var Qj=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},ji=function(s,e){return function(t,i){e(t,i,s)}};let Nst=0,eie=!1;function Rst(s){if(!s){if(eie)return;eie=!0}XTe(s||Ti.document.body)}let eA=class extends Vb{constructor(e,t,i,n,o,r,a,l,c,d,h,u,f,g){const m={...t};m.ariaLabel=m.ariaLabel||rH.editorViewAccessibleLabel,super(e,m,{},i,n,o,r,c,d,h,u,f),l instanceof Qw?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,Rst(m.ariaContainerElement),yBe((p,v)=>i.createInstance(Pw,p,{instantHover:v},{})),RWe(a),g.setDefaultCodeBlockRenderer(i.createInstance(Cz))}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++Nst,o=de.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,o),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),K.None;const t=e.id,i=e.label,n=de.and(de.equals("editorId",this.getId()),de.deserialize(e.precondition)),o=e.keybindings,r=de.and(n,de.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(f,...g)=>Promise.resolve(e.run(this,...g)),d=new oe,h=this.getId()+":"+t;if(d.add(Zt.registerCommand(h,c)),a){const f={command:{id:h,title:i},when:n,group:a,order:l};d.add(qs.appendMenuItem(He.EditorContext,f))}if(Array.isArray(o))for(const f of o)d.add(this._standaloneKeybindingService.addDynamicKeybinding(h,f,c,r));const u=new Eae(h,i,i,void 0,n,(...f)=>Promise.resolve(e.run(this,...f)),this._contextKeyService);return this._actions.set(t,u),d.add(Ve(()=>{this._actions.delete(t)})),d}_triggerCommand(e,t){if(this._codeEditorService instanceof VM)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};eA=Qj([ji(2,$e),ji(3,ii),ji(4,en),ji(5,ut),ji(6,Sr),ji(7,ai),ji(8,Dn),ji(9,Hn),ji(10,so),ji(11,wn),ji(12,We),ji(13,Sc)],eA);let wz=class extends eA{constructor(e,t,i,n,o,r,a,l,c,d,h,u,f,g,m,p,v){const b={...t};JM(h,b,!1);const w=c.registerEditorContainer(e);typeof b.theme=="string"&&c.setTheme(b.theme),typeof b.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!b.autoDetectHighContrast);const C=b.model;delete b.model,super(e,b,i,n,o,r,a,l,c,d,u,m,p,v),this._configurationService=h,this._standaloneThemeService=c,this._register(w);let y;if(typeof C>"u"){const x=g.getLanguageIdByMimeType(b.language)||b.language||Za;y=kfe(f,g,b.value||"",x,void 0),this._ownsModel=!0}else y=C,this._ownsModel=!1;if(this._attachModel(y),y){const x={oldModelUrl:null,newModelUrl:y.uri};this._onDidChangeModel.fire(x)}}dispose(){super.dispose()}updateOptions(e){JM(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};wz=Qj([ji(2,$e),ji(3,ii),ji(4,en),ji(5,ut),ji(6,Sr),ji(7,ai),ji(8,ol),ji(9,Hn),ji(10,xt),ji(11,so),ji(12,Cn),ji(13,Wn),ji(14,wn),ji(15,We),ji(16,Sc)],wz);let yz=class extends kh{constructor(e,t,i,n,o,r,a,l,c,d,h,u){const f={...t};JM(l,f,!0);const g=r.registerEditorContainer(e);typeof f.theme=="string"&&r.setTheme(f.theme),typeof f.autoDetectHighContrast<"u"&&r.setAutoDetectHighContrast(!!f.autoDetectHighContrast),super(e,f,{},n,i,o,u,d),this._configurationService=l,this._standaloneThemeService=r,this._register(g)}dispose(){super.dispose()}updateOptions(e){JM(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(eA,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};yz=Qj([ji(2,$e),ji(3,ut),ji(4,ii),ji(5,ol),ji(6,Hn),ji(7,xt),ji(8,sl),ji(9,vf),ji(10,pa),ji(11,Df)],yz);function kfe(s,e,t,i,n){if(t=t||"",!i){const o=t.indexOf(`
`);let r=t;return o!==-1&&(r=t.substring(0,o)),tie(s,t,e.createByFilepathOrFirstLine(n||null,r),n)}return tie(s,t,e.createById(i),n)}function tie(s,e,t,i){return s.createModel(e,t,i)}F("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},_(142,"The background color of the diff editor's header"));F("multiDiffEditor.background",es,_(143,"The background color of the multi file diff editor"));F("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},_(144,"The border color of the multi file diff editor"));var Mst=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},iie=function(s,e){return function(t,i){e(t,i,s)}};class Ast{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let Sz=class extends K{constructor(e,t,i,n,o){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=ht(this,void 0),this._collapsed=ae(this,l=>{var c;return(c=this._viewModel.read(l))==null?void 0:c.collapsed.read(l)}),this._editorContentHeight=ht(this,500),this.contentHeight=ae(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=ht(this,0),this._modifiedWidth=ht(this,0),this._originalContentWidth=ht(this,0),this._originalWidth=ht(this,0),this.maxScroll=ae(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),d=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>d?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:d,width:this._originalWidth.read(l)}}),this._elements=ei("div.multiDiffEntry",[ei("div.header@header",[ei("div.header-content",[ei("div.collapse-button@collapseButton"),ei("div.file-path",[ei("div.title.modified.show-file-icons@primaryPath",[]),ei("div.status.deleted@status",["R"]),ei("div.title.original.show-file-icons@secondaryPath",[])]),ei("div.actions@actions")])]),ei("div.editorParent",[ei("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(kh,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode,fixedOverflowWidgets:!0},{})),this.isModifedFocused=bn(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=bn(this.editor.getOriginalEditor()).isFocused,this.isFocused=ae(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new oe),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const r=new g2(this._elements.collapseButton,{});this._register(lt(l=>{r.element.className="",r.icon=this._collapsed.read(l)?ge.chevronRight:ge.chevronDown})),this._register(r.onDidClick(()=>{var l;(l=this._viewModel.get())==null||l.collapsed.set(!this._collapsed.get(),void 0)})),this._register(lt(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{bS(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register(lt(l=>{var d;const c=(d=this._viewModel.read(l))==null?void 0:d.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(o.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new g0([ut,this._contextKeyService])));this._register(a.createInstance(cI,this._elements.actions,He.MultiDiffEditorFileToolbar,{actionRunner:this._register(new pce(()=>{var l,c;return((l=this._viewModel.get())==null?void 0:l.modifiedUri)??((c=this._viewModel.get())==null?void 0:c.originalUri)})),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>vq(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(n){return{...n,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){bS(n=>{this._viewModel.set(void 0,n),this.editor.setDiffModel(null,n),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(bS(n=>{var c,d;(c=this._resourceLabel)==null||c.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let o=!1,r=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",o=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",r=!0),this._elements.status.classList.toggle("renamed",o),this._elements.status.classList.toggle("deleted",r),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,(d=this._resourceLabel2)==null||d.setUri(o?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,n),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,n=>{n||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[n,o]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(n,o)}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const o=e.length-this._headerHeight,r=Math.max(0,Math.min(n.start-e.start,o));this._elements.header.style.transform=`translateY(${r}px)`,bS(a=>{this.editor.layout({width:t-16-2,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",r>0||i>0),this._elements.header.classList.toggle("collapsed",r===o)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};Sz=Mst([iie(3,$e),iie(4,ut)],Sz);class Pst{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(n=>this._itemData.get(n).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var Ost=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},nie=function(s,e){return function(t,i){e(t,i,s)}};let xz=class extends K{constructor(e,t,i,n,o,r){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=o,this._parentInstantiationService=r,this._scrollableElements=ei("div.scrollContent",[ei("div@content",{style:{overflow:"hidden"}}),ei("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new u0({forceIntegerValues:!1,scheduleAtNextAnimationFrame:c=>Vr(je(this._element),c),smoothScrollDuration:100})),this._scrollableElement=this._register(new QO(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=ei("div.monaco-component.multiDiffEditor",{},[ei("div",{},[this._scrollableElement.getDomNode()]),ei("div.placeholder@placeholder",{},[ei("div")])]),this._sizeObserver=this._register(new Xle(this._element,void 0)),this._objectPool=this._register(new Pst(c=>{const d=this._instantiationService.createInstance(Sz,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return d.setData(c),d})),this.scrollTop=fi(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=fi(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=ae(this,c=>{const d=this._viewModel.read(c);if(!d)return{items:[],getItem:g=>{throw new et}};const h=d.items.read(c),u=new Map;return{items:h.map(g=>{var v;const m=c.store.add(new Bst(g,this._objectPool,this.scrollLeft,b=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+b})})),p=(v=this._lastDocStates)==null?void 0:v[m.getKey()];return p&&Ki(b=>{m.setViewState(p,b)}),u.set(g,m),m}),getItem:g=>u.get(g)}}),this._viewItems=this._viewItemsInfo.map(this,c=>c.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(c,d)=>c.reduce((h,u)=>h+u.contentHeight.read(d)+this._spaceBetweenPx,0)),this.activeControl=ae(this,c=>{var u,f;const d=(u=this._viewModel.read(c))==null?void 0:u.activeDiffItem.read(c);return d?(f=this._viewItemsInfo.read(c).getItem(d).template.read(c))==null?void 0:f.editor:void 0}),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new g0([ut,this._contextKeyService]))),this._contextKeyService.createKey(B.inMultiDiffEditor.key,!0),this._lastDocStates={},this._register(Ao((c,d)=>{const h=this._viewModel.read(c);if(h&&h.contextKeys)for(const[u,f]of Object.entries(h.contextKeys)){const g=this._contextKeyService.createKey(u,void 0);g.set(f),d.add(Ve(()=>g.reset()))}}));const a=this._parentContextKeyService.createKey(B.multiDiffEditorAllCollapsed.key,!1);this._register(lt(c=>{const d=this._viewModel.read(c);if(d){const h=d.items.read(c).every(u=>u.collapsed.read(c));a.set(h)}})),this._register(lt(c=>{const d=this._dimension.read(c);this._sizeObserver.observe(d)}));const l=ae(c=>{if(this._viewItems.read(c).length>0)return;const h=this._viewModel.read(c);return!h||h.isLoading.read(c)?_(145,"Loading..."):_(146,"No Changed Files")});this._register(lt(c=>{const d=l.read(c);this._elements.placeholder.innerText=d??"",this._elements.placeholder.classList.toggle("visible",!!d)})),this._scrollableElements.content.style.position="relative",this._register(lt(c=>{const d=this._sizeObserver.height.read(c);this._scrollableElements.root.style.height=`${d}px`;const h=this._totalHeight.read(c);this._scrollableElements.content.style.height=`${h}px`;const u=this._sizeObserver.width.read(c);let f=u;const g=this._viewItems.read(c),m=C$(g,wo(p=>p.maxScroll.read(c).maxScroll,aa));if(m){const p=m.maxScroll.read(c);f=u+p.maxScroll}this._scrollableElement.setScrollDimensions({width:u,height:d,scrollHeight:h,scrollWidth:f})})),e.replaceChildren(this._elements.root),this._register(Ve(()=>{e.replaceChildren()})),this._register(lt(c=>{const d=this._viewModel.read(c);if(d&&!d.isLoading.read(c)){if(d.items.read(c).length===0||d.activeDiffItem.read(c))return;this.goToNextChange()}})),this._register(this._register(lt(c=>{bS(d=>{this.render(c)})})))}reveal(e,t){var c;const i=this._viewItems.get(),n=i.findIndex(d=>{var h,u,f,g;return((h=d.viewModel.originalUri)==null?void 0:h.toString())===((u=e.original)==null?void 0:u.toString())&&((f=d.viewModel.modifiedUri)==null?void 0:f.toString())===((g=e.modified)==null?void 0:g.toString())});if(n===-1)throw new et("Resource not found in diff editor");const o=i[n];this._viewModel.get().activeDiffItem.setCache(o.viewModel,void 0);let r=0;for(let d=0;d<n;d++)r+=i[d].contentHeight.get()+this._spaceBetweenPx;this._scrollableElement.setScrollPosition({scrollTop:r});const a=(c=o.template.get())==null?void 0:c.editor,l="original"in e?a==null?void 0:a.getOriginalEditor():a==null?void 0:a.getModifiedEditor();l&&(t!=null&&t.range)&&(l.revealRangeInCenter(t.range),Fst(l,t.range))}goToNextChange(){this._navigateToChange("next")}_navigateToChange(e){var l,c,d,h,u;const t=this._viewItems.get();if(t.length===0)return;const i=(l=this._viewModel.get())==null?void 0:l.activeDiffItem.get(),n=i?t.findIndex(f=>f.viewModel===i):-1;if(n===-1){this._goToFile(0,"first");return}const o=t[n];o.viewModel.collapsed.get()&&o.viewModel.collapsed.set(!1,void 0);const r=(c=o.template.get())==null?void 0:c.editor;if((h=(d=r==null?void 0:r.getDiffComputationResult())==null?void 0:d.changes2)!=null&&h.length){const f=((u=r.getModifiedEditor().getPosition())==null?void 0:u.lineNumber)||1,g=r.getDiffComputationResult().changes2;if(e==="next"?g.some(p=>p.modified.startLineNumber>f):g.some(p=>p.modified.endLineNumberExclusive<=f)){r.goToDiff(e);return}}const a=(n+(e==="next"?1:-1)+t.length)%t.length;this._goToFile(a,e==="next"?"first":"last")}_goToFile(e,t){var o,r,a;const i=this._viewItems.get()[e];i.viewModel.collapsed.get()&&i.viewModel.collapsed.set(!1,void 0),this.reveal({original:i.viewModel.originalUri,modified:i.viewModel.modifiedUri});const n=(o=i.template.get())==null?void 0:o.editor;if((a=(r=n==null?void 0:n.getDiffComputationResult())==null?void 0:r.changes2)!=null&&a.length)if(t==="first")n.revealFirstDiff();else{const l=n.getDiffComputationResult().changes2.at(-1),c=n.getModifiedEditor();c.setPosition({lineNumber:l.modified.startLineNumber,column:1}),c.revealLineInCenter(l.modified.startLineNumber)}n==null||n.focus()}render(e){const t=this.scrollTop.read(e);let i=0,n=0,o=0;const r=this._sizeObserver.height.read(e),a=Ue.ofStartAndLength(t,r),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const d=c.contentHeight.read(e),h=Math.min(d,r),u=Ue.ofStartAndLength(n,h),f=Ue.ofStartAndLength(o,d);if(f.isBefore(a))i-=d-h,c.hide();else if(f.isAfter(a))c.hide();else{const g=Math.max(0,Math.min(a.start-f.start,d-h));i-=g;const m=Ue.ofStartAndLength(t+i,r);c.render(u,g,l,m)}n+=h+this._spaceBetweenPx,o+=d+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};xz=Ost([nie(4,ut),nie(5,$e)],xz);function Fst(s,e){const t=s.getModel(),i=s.createDecorationsCollection([{range:e,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{s.getModel()===t&&i.clear()},350)}class Bst extends K{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register(OU(this,void 0)),this.contentHeight=ae(this,o=>{var r,a;return((a=(r=this._templateRef.read(o))==null?void 0:r.object.contentHeight)==null?void 0:a.read(o))??this.viewModel.lastTemplateData.read(o).contentHeight}),this.maxScroll=ae(this,o=>{var r;return((r=this._templateRef.read(o))==null?void 0:r.object.maxScroll.read(o))??{maxScroll:0,scrollWidth:0}}),this.template=ae(this,o=>{var r;return(r=this._templateRef.read(o))==null?void 0:r.object}),this._isHidden=ht(this,!1),this._isFocused=ae(this,o=>{var r;return((r=this.template.read(o))==null?void 0:r.isFocused.read(o))??!1}),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(lt(o=>{var a;const r=this._scrollLeft.read(o);(a=this._templateRef.read(o))==null||a.object.setScrollLeft(r)})),this._register(lt(o=>{const r=this._templateRef.read(o);!r||!this._isHidden.read(o)||r.object.isFocused.read(o)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){var e;return`VirtualViewItem(${(e=this.viewModel.documentDiffItem.modified)==null?void 0:e.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){var r;this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=(r=e.selections)==null?void 0:r.map(Oe.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const o=this._templateRef.get();o&&n&&o.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&Ki(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let o=this._templateRef.get();if(!o){o=this._objectPool.getUnusedObj(new Ast(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(o,void 0);const r=this.viewModel.lastTemplateData.get().selections;r&&o.object.editor.setSelections(r)}o.object.render(e,i,t,n)}}var Wst=function(s,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,i);else for(var a=s.length-1;a>=0;a--)(r=s[a])&&(o=(n<3?r(o):n>3?r(e,t,o):r(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o},Hst=function(s,e){return function(t,i){e(t,i,s)}};let Lz=class extends K{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=ht(this,void 0),this._viewModel=ht(this,void 0),this._widgetImpl=ae(this,n=>n.store.add(this._instantiationService.createInstance(iu(xz),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory))),this._register(bw(this._widgetImpl))}};Lz=Wst([Hst(2,$e)],Lz);function Vst(s,e,t){return bt.initialize(t||{}).createInstance(wz,s,e)}function zst(s){return bt.get(ii).onCodeEditorAdd(t=>{s(t)})}function Ust(s){return bt.get(ii).onDiffEditorAdd(t=>{s(t)})}function $st(){return bt.get(ii).listCodeEditors()}function qst(){return bt.get(ii).listDiffEditors()}function jst(s,e,t){return bt.initialize(t||{}).createInstance(yz,s,e)}function Kst(s,e){const t=bt.initialize(e||{});return new Lz(s,{},t)}function Gst(s){if(typeof s.id!="string"||typeof s.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return Zt.registerCommand(s.id,s.run)}function Yst(s){if(typeof s.id!="string"||typeof s.label!="string"||typeof s.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=de.deserialize(s.precondition),t=(n,...o)=>Is.runEditorCommand(n,o,e,(r,a,l)=>Promise.resolve(s.run(a,...l))),i=new oe;if(i.add(Zt.registerCommand(s.id,t)),s.contextMenuGroupId){const n={command:{id:s.id,title:s.label},when:e,group:s.contextMenuGroupId,order:s.contextMenuOrder||0};i.add(qs.appendMenuItem(He.EditorContext,n))}if(Array.isArray(s.keybindings)){const n=bt.get(ai);if(!(n instanceof Qw))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const o=de.and(e,de.deserialize(s.keybindingContext));i.add(n.addDynamicKeybindings(s.keybindings.map(r=>({keybinding:r,command:s.id,when:o}))))}}return i}function Xst(s){return Dfe([s])}function Dfe(s){const e=bt.get(ai);return e instanceof Qw?e.addDynamicKeybindings(s.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:de.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),K.None)}function Zst(s,e,t){const i=bt.get(Wn),n=i.getLanguageIdByMimeType(e)||e;return kfe(bt.get(Cn),i,s,n,t)}function Qst(s,e){const t=bt.get(Wn),i=t.getLanguageIdByMimeType(e)||e||Za;s.setLanguage(t.createById(i))}function Jst(s,e,t){s&&bt.get(Wh).changeOne(e,s.uri,t)}function eot(s){bt.get(Wh).changeAll(s,[])}function tot(s){return bt.get(Wh).read(s)}function iot(s){return bt.get(Wh).onMarkerChanged(s)}function not(s){return bt.get(Cn).getModel(s)}function sot(){return bt.get(Cn).getModels()}function oot(s){return bt.get(Cn).onModelAdded(s)}function rot(s){return bt.get(Cn).onModelRemoved(s)}function aot(s){return bt.get(Cn).onModelLanguageChanged(t=>{s({model:t.model,oldLanguage:t.oldLanguageId})})}function lot(s){return git(bt.get(Cn),s)}function cot(s,e){const t=bt.get(Wn),i=bt.get(ol);return Kj.colorizeElement(i,t,s,e).then(()=>{i.registerEditorContainer(s)})}function dot(s,e,t){const i=bt.get(Wn);return bt.get(ol).registerEditorContainer(Ti.document.body),Kj.colorize(i,s,e,t)}function hot(s,e,t=4){return bt.get(ol).registerEditorContainer(Ti.document.body),Kj.colorizeModelLine(s,e,t)}function uot(s){const e=An.get(s);return e||{getInitialState:()=>Rw,tokenize:(t,i,n)=>W$(s,n)}}function fot(s,e){An.getOrCreate(e);const t=uot(e),i=fa(s),n=[];let o=t.getInitialState();for(let r=0,a=i.length;r<a;r++){const l=i[r],c=t.tokenize(l,!0,o);n[r]=c.tokens,o=c.endState}return n}function got(s,e){bt.get(ol).defineTheme(s,e)}function mot(s){bt.get(ol).setTheme(s)}function pot(){lB.clearAllFontInfos()}function _ot(s,e){return Zt.registerCommand({id:s,handler:e})}function bot(s){return bt.get(Rf).registerOpener({async open(t){return typeof t=="string"&&(t=Ze.parse(t)),s.open(t)}})}function vot(s){return bt.get(ii).registerCodeEditorOpenHandler(async(t,i,n)=>{var a;if(!i)return null;const o=(a=t.options)==null?void 0:a.selection;let r;return o&&typeof o.endLineNumber=="number"&&typeof o.endColumn=="number"?r=o:o&&(r={lineNumber:o.startLineNumber,column:o.startColumn}),await s.openCodeEditor(i,t.resource,r)?i:null})}function Cot(){return{create:Vst,getEditors:$st,getDiffEditors:qst,onDidCreateEditor:zst,onDidCreateDiffEditor:Ust,createDiffEditor:jst,addCommand:Gst,addEditorAction:Yst,addKeybindingRule:Xst,addKeybindingRules:Dfe,createModel:Zst,setModelLanguage:Qst,setModelMarkers:Jst,getModelMarkers:tot,removeAllMarkers:eot,onDidChangeMarkers:iot,getModels:sot,getModel:not,onDidCreateModel:oot,onWillDisposeModel:rot,onDidChangeModelLanguage:aot,createWebWorker:lot,colorizeElement:cot,colorize:dot,colorizeModelLine:hot,tokenize:fot,defineTheme:got,setTheme:mot,remeasureFonts:pot,registerCommand:_ot,registerLinkOpener:bot,registerEditorOpener:vot,AccessibilitySupport:wH,ContentWidgetPositionPreference:EH,CursorChangeReason:kH,DefaultEndOfLine:DH,EditorAutoIndentStrategy:NH,EditorOption:RH,EndOfLinePreference:MH,EndOfLineSequence:AH,MinimapPosition:jH,MinimapSectionHeaderStyle:KH,MouseTargetType:GH,OverlayWidgetPositionPreference:ZH,OverviewRulerLane:QH,GlyphMarginLane:PH,RenderLineNumbersType:tV,RenderMinimap:iV,ScrollbarVisibility:sV,ScrollType:nV,TextEditorCursorBlinkingStyle:hV,TextEditorCursorStyle:uV,TrackedRangeStickiness:fV,WrappingIndent:gV,InjectedTextCursorStops:BH,PositionAffinity:eV,ShowLightbulbIconMode:rV,TextDirection:dV,ConfigurationChangedEvent:lre,BareFontInfo:Pb,FontInfo:hR,TextModelResolvedOptions:UT,FindMatch:IL,ApplyUpdateResult:qS,EditorZoom:yl,createMultiFileDiffEditor:Kst,EditorType:yk,EditorOptions:Go}}function wot(s,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!s(t))return!1;return!0}function xT(s,e){return typeof s=="boolean"?s:e}function sie(s,e){return typeof s=="string"?s:e}function yot(s){const e={};for(const t of s)e[t]=!0;return e}function oie(s,e=!1){e&&(s=s.map(function(i){return i.toLowerCase()}));const t=yot(s);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function Iz(s,e,t){e=e.replace(/@@/g,"");let i=0,n;do n=!1,e=e.replace(/@(\w+)/g,function(r,a){n=!0;let l="";if(typeof s[a]=="string")l=s[a];else if(s[a]&&s[a]instanceof RegExp)l=s[a].source;else throw s[a]===void 0?ln(s,"language definition does not contain attribute '"+a+"', used at: "+e):ln(s,"attribute reference '"+a+"' must be a string, used at: "+e);return Ip(l)?"":"(?:"+l+")"}),i++;while(n&&i<5);e=e.replace(/\x01/g,"@");const o=(s.ignoreCase?"i":"")+(s.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(vit(s,e,c),o)),l)}return new RegExp(e,o)}function Sot(s,e,t,i){if(i<0)return s;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function xot(s,e,t,i){let n=-1,o=t,r=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);r&&(r[3]&&(n=parseInt(r[3]),r[2]&&(n=n+100)),o=r[4]);let a="~",l=o;!o||o.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(r=o.match(/^(@|!@|~|!~|==|!=)(.*)$/),r&&(a=r[1],l=r[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const d=oie(l.split("|"),s.ignoreCase);c=function(h){return a==="~"?d(h):!d(h)}}else if(a==="@"||a==="!@"){const d=s[l];if(!d)throw ln(s,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!wot(function(u){return typeof u=="string"},d))throw ln(s,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const h=oie(d,s.ignoreCase);c=function(u){return a==="@"?h(u):!h(u)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const d=Iz(s,"^"+l+"$",!1);c=function(h){return a==="~"?d.test(h):!d.test(h)}}else c=function(d,h,u,f){return Iz(s,"^"+fg(s,l,h,u,f)+"$",!1).test(d)};else if(l.indexOf("$")<0){const d=of(s,l);c=function(h){return a==="=="?h===d:h!==d}}else{const d=of(s,l);c=function(h,u,f,g,m){const p=fg(s,d,u,f,g);return a==="=="?h===p:h!==p}}return n===-1?{name:t,value:i,test:function(d,h,u,f){return c(d,d,h,u,f)}}:{name:t,value:i,test:function(d,h,u,f){const g=Sot(d,h,u,n);return c(g||"",d,h,u,f)}}}function Ez(s,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw ln(s,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw ln(s,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw ln(s,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!Cit(s,fg(s,n,"",[],""))))throw ln(s,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,s.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,o=t.length;n<o;n++)i[n]=Ez(s,e,t[n]);return{group:i}}else if(t.cases){const i=[];let n=!1;for(const r in t.cases)if(t.cases.hasOwnProperty(r)){const a=Ez(s,e,t.cases[r]);r==="@default"||r==="@"||r===""?i.push({test:void 0,value:a,name:r}):r==="@eos"?i.push({test:function(l,c,d,h){return h},value:a,name:r}):i.push(xot(s,e,r,a)),n||(n=!As(a)&&(a.hasEmbeddedEndInCases||["@pop","@popall"].includes(a.nextEmbedded||"")))}const o=s.defaultToken;return{hasEmbeddedEndInCases:n,test:function(r,a,l,c){for(const d of i)if(!d.test||d.test(r,a,l,c))return d.value;return o}}}else throw ln(s,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class Lot{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw ln(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=Iz(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=Ez(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function Tfe(s,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:s,includeLF:xT(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:xT(e.ignoreCase,!1),unicode:xT(e.unicode,!1),tokenPostfix:sie(e.tokenPostfix,"."+s),defaultToken:sie(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=s,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(r,a,l){for(const c of l){let d=c.include;if(d){if(typeof d!="string")throw ln(t,"an 'include' attribute must be a string at: "+r);if(d[0]==="@"&&(d=d.substr(1)),!e.tokenizer[d])throw ln(t,"include target '"+d+"' is not defined at: "+r);n(r+"."+d,a,e.tokenizer[d])}else{const h=new Lot(r);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(h.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")h.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const u=c[1];u.next=c[2],h.setAction(i,u)}else throw ln(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+r);else h.setAction(i,c[1]);else{if(!c.regex)throw ln(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+r);c.name&&typeof c.name=="string"&&(h.name=c.name),c.matchOnlyAtStart&&(h.matchOnlyAtLineStart=xT(c.matchOnlyAtLineStart,!1)),h.setRegex(i,c.regex),h.setAction(i,c.action)}a.push(h)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw ln(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const r in e.tokenizer)if(e.tokenizer.hasOwnProperty(r)){t.start||(t.start=r);const a=e.tokenizer[r];t.tokenizer[r]=new Array,n("tokenizer."+r,t.tokenizer[r],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw ln(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const o=[];for(const r of e.brackets){let a=r;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw ln(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")o.push({token:a.token+t.tokenPostfix,open:of(t,a.open),close:of(t,a.close)});else throw ln(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=o,t.noThrow=!0,t}function Iot(s){Cw.registerLanguage(s)}function Eot(){let s=[];return s=s.concat(Cw.getLanguages()),s}function kot(s){return bt.get(Wn).languageIdCodec.encodeLanguageId(s)}function Dot(s,e){return bt.withServices(()=>{const i=bt.get(Wn).onDidRequestRichLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function Tot(s,e){return bt.withServices(()=>{const i=bt.get(Wn).onDidRequestBasicLanguageFeatures(n=>{n===s&&(i.dispose(),e())});return i})}function Not(s,e){if(!bt.get(Wn).isRegisteredLanguageId(s))throw new Error(`Cannot set configuration for unknown language ${s}`);return bt.get(wn).register(s,e,100)}class Rot{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return iE.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new i4(n.tokens,n.endState)}}class iE{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let o=0,r=e.length;o<r;o++){const a=e[o];let l=a.startIndex;o===0?l=0:l<n&&(l=n),i[o]=new HL(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const o=t.tokenize(i,n),r=iE._toClassicTokens(o.tokens,e);let a;return o.endState.equals(n)?a=n:a=o.endState,new w$(r,a)}tokenize(e,t,i){return iE.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,o=[];let r=0,a=0;for(let c=0,d=t.length;c<d;c++){const h=t[c],u=n.match(i,h.scopes)|1024;if(r>0&&o[r-1]===u)continue;let f=h.startIndex;c===0?f=0:f<a&&(f=a),o[r++]=f,o[r++]=u,a=f}const l=new Uint32Array(r);for(let c=0;c<r;c++)l[c]=o[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),o=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let r;return n.endState.equals(i)?r=i:r=n.endState,new i4(o,r)}}function Mot(s){return typeof s.getInitialState=="function"}function Aot(s){return"tokenizeEncoded"in s}function Nfe(s){return s&&typeof s.then=="function"}function Pot(s){const e=bt.get(ol);if(s){const t=[null];for(let i=1,n=s.length;i<n;i++)t[i]=re.fromHex(s[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function Rfe(s,e){return Aot(e)?new Rot(s,e):new iE(s,e,bt.get(Wn),bt.get(ol))}function Jj(s,e){const t=new T4e(async()=>{const i=await Promise.resolve(e.create());return i?Mot(i)?Rfe(s,i):new YI(bt.get(Wn),bt.get(ol),s,Tfe(s,i),bt.get(xt)):null});return An.registerFactory(s,t)}function Oot(s,e){if(!bt.get(Wn).isRegisteredLanguageId(s))throw new Error(`Cannot set tokens provider for unknown language ${s}`);return Nfe(e)?Jj(s,{create:()=>e}):An.register(s,Rfe(s,e))}function Fot(s,e){const t=i=>new YI(bt.get(Wn),bt.get(ol),s,Tfe(s,i),bt.get(xt));return Nfe(e)?Jj(s,{create:()=>e}):An.register(s,t(e))}function Bot(s,e){return bt.get(We).referenceProvider.register(s,e)}function Wot(s,e){return bt.get(We).renameProvider.register(s,e)}function Hot(s,e){return bt.get(We).newSymbolNamesProvider.register(s,e)}function Vot(s,e){return bt.get(We).signatureHelpProvider.register(s,e)}function zot(s,e){return bt.get(We).hoverProvider.register(s,{provideHover:async(i,n,o,r)=>{const a=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,o,r)).then(l=>{if(l)return!l.range&&a&&(l.range=new D(n.lineNumber,a.startColumn,n.lineNumber,a.endColumn)),l.range||(l.range=new D(n.lineNumber,n.column,n.lineNumber,n.column)),l})}})}function Uot(s,e){return bt.get(We).documentSymbolProvider.register(s,e)}function $ot(s,e){return bt.get(We).documentHighlightProvider.register(s,e)}function qot(s,e){return bt.get(We).linkedEditingRangeProvider.register(s,e)}function jot(s,e){return bt.get(We).definitionProvider.register(s,e)}function Kot(s,e){return bt.get(We).implementationProvider.register(s,e)}function Got(s,e){return bt.get(We).typeDefinitionProvider.register(s,e)}function Yot(s,e){return bt.get(We).codeLensProvider.register(s,e)}function Xot(s,e,t){return bt.get(We).codeActionProvider.register(s,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(n,o,r,a)=>{const c=bt.get(Wh).read({resource:n.uri}).filter(d=>D.areIntersectingOrTouching(d,o));return e.provideCodeActions(n,o,{markers:c,only:r.only,trigger:r.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function Zot(s,e){return bt.get(We).documentFormattingEditProvider.register(s,e)}function Qot(s,e){return bt.get(We).documentRangeFormattingEditProvider.register(s,e)}function Jot(s,e){return bt.get(We).onTypeFormattingEditProvider.register(s,e)}function ert(s,e){return bt.get(We).linkProvider.register(s,e)}function trt(s,e){return bt.get(We).completionProvider.register(s,e)}function irt(s,e){return bt.get(We).colorProvider.register(s,e)}function nrt(s,e){return bt.get(We).foldingRangeProvider.register(s,e)}function srt(s,e){return bt.get(We).declarationProvider.register(s,e)}function ort(s,e){return bt.get(We).selectionRangeProvider.register(s,e)}function rrt(s,e){return bt.get(We).documentSemanticTokensProvider.register(s,e)}function art(s,e){return bt.get(We).documentRangeSemanticTokensProvider.register(s,e)}function lrt(s,e){return bt.get(We).inlineCompletionsProvider.register(s,e)}function crt(s,e){return bt.get(We).inlayHintsProvider.register(s,e)}function drt(){return{register:Iot,getLanguages:Eot,onLanguage:Dot,onLanguageEncountered:Tot,getEncodedLanguageId:kot,setLanguageConfiguration:Not,setColorMap:Pot,registerTokensProviderFactory:Jj,setTokensProvider:Oot,setMonarchTokensProvider:Fot,registerReferenceProvider:Bot,registerRenameProvider:Wot,registerNewSymbolNameProvider:Hot,registerCompletionItemProvider:trt,registerSignatureHelpProvider:Vot,registerHoverProvider:zot,registerDocumentSymbolProvider:Uot,registerDocumentHighlightProvider:$ot,registerLinkedEditingRangeProvider:qot,registerDefinitionProvider:jot,registerImplementationProvider:Kot,registerTypeDefinitionProvider:Got,registerCodeLensProvider:Yot,registerCodeActionProvider:Xot,registerDocumentFormattingEditProvider:Zot,registerDocumentRangeFormattingEditProvider:Qot,registerOnTypeFormattingEditProvider:Jot,registerLinkProvider:ert,registerColorProvider:irt,registerFoldingRangeProvider:nrt,registerDeclarationProvider:srt,registerSelectionRangeProvider:ort,registerDocumentSemanticTokensProvider:rrt,registerDocumentRangeSemanticTokensProvider:art,registerInlineCompletionsProvider:lrt,registerInlayHintsProvider:crt,DocumentHighlightKind:TH,CompletionItemKind:xH,CompletionItemTag:LH,CompletionItemInsertTextRule:SH,SymbolKind:lV,SymbolTag:cV,IndentAction:FH,CompletionTriggerKind:IH,SignatureHelpTriggerKind:aV,InlayHintKind:WH,InlineCompletionTriggerKind:zH,CodeActionTriggerType:yH,NewSymbolNameTag:YH,NewSymbolNameTriggerKind:XH,PartialAcceptTriggerKind:JH,HoverVerbosityAction:OH,InlineCompletionEndOfLifeReasonKind:HH,InlineCompletionHintStyle:VH,FoldingRangeKind:yv,SelectedSuggestionInfo:uae,EditDeltaInfo:QL}}Go.wrappingIndent.defaultValue=0;Go.glyphMargin.defaultValue=!1;Go.autoIndent.defaultValue=3;Go.overviewRulerLanes.defaultValue=2;EI.setFormatterSelector((s,e,t)=>Promise.resolve(s[0]));const Lr=ofe();Lr.editor=Cot();Lr.languages=drt();const hrt=Lr.CancellationTokenSource,cv=Lr.Emitter,kz=Lr.KeyCode,Dz=Lr.KeyMod,urt=Lr.Position,Mfe=Lr.Range,frt=Lr.Selection,grt=Lr.SelectionDirection,Hu=Lr.MarkerSeverity,Tz=Lr.MarkerTag,mrt=Lr.Uri,prt=Lr.Token,Jw=Lr.editor,Xe=Lr.languages,U3=lU(),H1=globalThis;(U3!=null&&U3.globalAPI||typeof H1.define=="function"&&H1.define.amd)&&(H1.monaco=Lr);typeof H1.require<"u"&&typeof H1.require.config=="function"&&H1.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const _rt=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:hrt,Emitter:cv,KeyCode:kz,KeyMod:Dz,MarkerSeverity:Hu,MarkerTag:Tz,Position:urt,Range:Mfe,Selection:frt,SelectionDirection:grt,Token:prt,Uri:mrt,editor:Jw,languages:Xe},Symbol.toStringTag,{value:"Module"}));let eK=class{constructor(e,t,i){this._onDidChange=new cv,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(e){this.setOptions(e)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}};const tK={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0},format:{newlineBetweenSelectors:!0,newlineBetweenRules:!0,spaceAroundSelectorSeparator:!1,braceStyle:"collapse",maxPreserveNewLines:void 0,preserveNewLines:!0}},iK={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0},Afe=new eK("css",tK,iK),Pfe=new eK("scss",tK,iK),Ofe=new eK("less",tK,iK);function nK(){return Qe(()=>import("./BvYtYsvB.js"),__vite__mapDeps([0,1]),import.meta.url)}Xe.onLanguage("less",()=>{nK().then(s=>s.setupMode(Ofe))});Xe.onLanguage("scss",()=>{nK().then(s=>s.setupMode(Pfe))});Xe.onLanguage("css",()=>{nK().then(s=>s.setupMode(Afe))});const brt=Object.freeze(Object.defineProperty({__proto__:null,cssDefaults:Afe,lessDefaults:Ofe,scssDefaults:Pfe},Symbol.toStringTag,{value:"Module"}));let vrt=class{constructor(e,t,i){this._onDidChange=new cv,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}};const Crt={tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},X4={format:Crt,suggest:{},data:{useDefaultDataProvider:!0}};function Z4(s){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:s===Ax,documentFormattingEdits:s===Ax,documentRangeFormattingEdits:s===Ax}}const Ax="html",rie="handlebars",aie="razor",Ffe=Q4(Ax,X4,Z4(Ax)),wrt=Ffe.defaults,Bfe=Q4(rie,X4,Z4(rie)),yrt=Bfe.defaults,Wfe=Q4(aie,X4,Z4(aie)),Srt=Wfe.defaults;function xrt(){return Qe(()=>import("./mZ7MwQU_.js"),__vite__mapDeps([2,1]),import.meta.url)}function Q4(s,e=X4,t=Z4(s)){const i=new vrt(s,e,t);let n;const o=Xe.onLanguage(s,async()=>{n=(await xrt()).setupMode(i)});return{defaults:i,dispose(){o.dispose(),n==null||n.dispose(),n=void 0}}}const Lrt=Object.freeze(Object.defineProperty({__proto__:null,handlebarDefaults:yrt,handlebarLanguageService:Bfe,htmlDefaults:wrt,htmlLanguageService:Ffe,razorDefaults:Srt,razorLanguageService:Wfe,registerHTMLLanguageService:Q4},Symbol.toStringTag,{value:"Module"}));let Irt=class{constructor(e,t,i){this._onDidChange=new cv,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}};const Ert={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},krt={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},Hfe=new Irt("json",Ert,krt),Drt=()=>Vfe().then(s=>s.getWorker());function Vfe(){return Qe(()=>import("./DJltBpam.js"),__vite__mapDeps([3,1]),import.meta.url)}Xe.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});Xe.onLanguage("json",()=>{Vfe().then(s=>s.setupMode(Hfe))});const Trt=Object.freeze(Object.defineProperty({__proto__:null,getWorker:Drt,jsonDefaults:Hfe},Symbol.toStringTag,{value:"Module"})),Nrt="5.9.3";var zfe=(s=>(s[s.None=0]="None",s[s.CommonJS=1]="CommonJS",s[s.AMD=2]="AMD",s[s.UMD=3]="UMD",s[s.System=4]="System",s[s.ES2015=5]="ES2015",s[s.ESNext=99]="ESNext",s))(zfe||{}),Ufe=(s=>(s[s.None=0]="None",s[s.Preserve=1]="Preserve",s[s.React=2]="React",s[s.ReactNative=3]="ReactNative",s[s.ReactJSX=4]="ReactJSX",s[s.ReactJSXDev=5]="ReactJSXDev",s))(Ufe||{}),$fe=(s=>(s[s.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",s[s.LineFeed=1]="LineFeed",s))($fe||{}),qfe=(s=>(s[s.ES3=0]="ES3",s[s.ES5=1]="ES5",s[s.ES2015=2]="ES2015",s[s.ES2016=3]="ES2016",s[s.ES2017=4]="ES2017",s[s.ES2018=5]="ES2018",s[s.ES2019=6]="ES2019",s[s.ES2020=7]="ES2020",s[s.ESNext=99]="ESNext",s[s.JSON=100]="JSON",s[s.Latest=99]="Latest",s))(qfe||{}),jfe=(s=>(s[s.Classic=1]="Classic",s[s.NodeJs=2]="NodeJs",s))(jfe||{});let Kfe=class{constructor(e,t,i,n,o){this._onDidChange=new cv,this._onDidExtraLibsChange=new cv,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(e),this.setDiagnosticsOptions(t),this.setWorkerOptions(i),this.setInlayHintsOptions(n),this.setModeConfiguration(o),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get modeConfiguration(){return this._modeConfiguration}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(e,t){let i;if(typeof t>"u"?i=`ts:extralib-${Math.random().toString(36).substring(2,15)}`:i=t,this._extraLibs[i]&&this._extraLibs[i].content===e)return{dispose:()=>{}};let n=1;return this._removedExtraLibs[i]&&(n=this._removedExtraLibs[i]+1),this._extraLibs[i]&&(n=this._extraLibs[i].version+1),this._extraLibs[i]={content:e,version:n},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let o=this._extraLibs[i];o&&o.version===n&&(delete this._extraLibs[i],this._removedExtraLibs[i]=n,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(e){for(const t in this._extraLibs)this._removedExtraLibs[t]=this._extraLibs[t].version;if(this._extraLibs=Object.create(null),e&&e.length>0)for(const t of e){const i=t.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,n=t.content;let o=1;this._removedExtraLibs[i]&&(o=this._removedExtraLibs[i]+1),this._extraLibs[i]={content:n,version:o}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout(()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)},0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(e){this._compilerOptions=e||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(e){this._workerOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(e){this._inlayHintsOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(e){}setEagerModelSync(e){this._eagerModelSync=e}getEagerModelSync(){return this._eagerModelSync}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(void 0)}};const Rrt=Nrt,Gfe={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,diagnostics:!0,documentRangeFormattingEdits:!0,signatureHelp:!0,onTypeFormattingEdits:!0,codeActions:!0,inlayHints:!0},Yfe=new Kfe({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{},Gfe),Xfe=new Kfe({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{},Gfe),Mrt=()=>J4().then(s=>s.getTypeScriptWorker()),Art=()=>J4().then(s=>s.getJavaScriptWorker());function J4(){return Qe(()=>import("./CHO02dwy.js"),[],import.meta.url)}Xe.onLanguage("typescript",()=>J4().then(s=>s.setupTypeScript(Yfe)));Xe.onLanguage("javascript",()=>J4().then(s=>s.setupJavaScript(Xfe)));const Prt=Object.freeze(Object.defineProperty({__proto__:null,JsxEmit:Ufe,ModuleKind:zfe,ModuleResolutionKind:jfe,NewLineKind:$fe,ScriptTarget:qfe,getJavaScriptWorker:Art,getTypeScriptWorker:Mrt,javascriptDefaults:Xfe,typescriptDefaults:Yfe,typescriptVersion:Rrt},Symbol.toStringTag,{value:"Module"})),Zfe={},$3={};class sK{static getOrCreate(e){return $3[e]||($3[e]=new sK(e)),$3[e]}constructor(e){this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise((t,i)=>{this._lazyLoadPromiseResolve=t,this._lazyLoadPromiseReject=i})}load(){return this._loadingTriggered||(this._loadingTriggered=!0,Zfe[this._languageId].loader().then(e=>this._lazyLoadPromiseResolve(e),e=>this._lazyLoadPromiseReject(e))),this._lazyLoadPromise}}function ot(s){const e=s.id;Zfe[e]=s,Xe.register(s);const t=sK.getOrCreate(e);Xe.registerTokensProviderFactory(e,{create:async()=>(await t.load()).language}),Xe.onLanguageEncountered(e,async()=>{const i=await t.load();Xe.setLanguageConfiguration(e,i.conf)})}ot({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>Qe(()=>import("./DLDM7-KI.js"),[],import.meta.url)});ot({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>Qe(()=>import("./DNDY2TF8.js"),[],import.meta.url)});ot({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>Qe(()=>import("./Y6nb8tq_.js"),[],import.meta.url)});ot({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>Qe(()=>import("./BwHxbl9M.js"),[],import.meta.url)});ot({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>Qe(()=>import("./CFznDFnq.js"),[],import.meta.url)});ot({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>Qe(()=>import("./Bf6VGUru.js"),[],import.meta.url)});ot({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>Qe(()=>import("./Dnu-v4kV.js"),[],import.meta.url)});ot({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>Qe(()=>import("./Bd8akH9Z.js"),[],import.meta.url)});ot({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>Qe(()=>import("./BbWJElDN.js"),[],import.meta.url)});ot({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>Qe(()=>import("./BbWJElDN.js"),[],import.meta.url)});ot({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>Qe(()=>import("./Co3qMtFm.js"),[],import.meta.url)});ot({id:"csp",extensions:[".csp"],aliases:["CSP","csp"],loader:()=>Qe(()=>import("./D-4FJmMZ.js"),[],import.meta.url)});ot({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>Qe(()=>import("./DdJfP1eB.js"),[],import.meta.url)});ot({id:"cypher",extensions:[".cypher",".cyp"],aliases:["Cypher","OpenCypher"],loader:()=>Qe(()=>import("./cTPe9QuQ.js"),[],import.meta.url)});ot({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>Qe(()=>import("./BOtBlQCF.js"),[],import.meta.url)});ot({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>Qe(()=>import("./BG73LgW2.js"),[],import.meta.url)});ot({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>Qe(()=>import("./BEgZUVRK.js"),[],import.meta.url)});ot({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>Qe(()=>import("./BkW5O-1t.js"),[],import.meta.url)});ot({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>Qe(()=>import("./BeJ5waoc.js"),[],import.meta.url)});ot({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>Qe(()=>import("./PahG7c26.js"),[],import.meta.url)});ot({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagAutoInterpolationDollar)});ot({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagAngleInterpolationDollar)});ot({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagBracketInterpolationDollar)});ot({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagAngleInterpolationBracket)});ot({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagBracketInterpolationBracket)});ot({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagAutoInterpolationDollar)});ot({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>Qe(()=>import("./CVzn4Xaz.js"),[],import.meta.url).then(s=>s.TagAutoInterpolationBracket)});ot({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>Qe(()=>import("./acbASCJo.js"),[],import.meta.url)});ot({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>Qe(()=>import("./BxJiqAUM.js"),[],import.meta.url)});ot({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>Qe(()=>import("./B0fj06gp.js"),[],import.meta.url)});ot({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>Qe(()=>import("./DtV1sZF8.js"),[],import.meta.url)});ot({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>Qe(()=>import("./CSLYJm3w.js"),[],import.meta.url)});ot({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>Qe(()=>import("./Kd9XrMLS.js"),[],import.meta.url)});ot({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>Qe(()=>import("./CXBNlu9o.js"),[],import.meta.url)});ot({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>Qe(()=>import("./CNpyTKY4.js"),__vite__mapDeps([4,5]),import.meta.url)});ot({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>Qe(()=>import("./cl7-CwDS.js"),[],import.meta.url)});ot({id:"kotlin",extensions:[".kt",".kts"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>Qe(()=>import("./s7OhZKlX.js"),[],import.meta.url)});ot({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>Qe(()=>import("./9HpZscsL.js"),[],import.meta.url)});ot({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>Qe(()=>import("./OrD6JF1K.js"),[],import.meta.url)});ot({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>Qe(()=>import("./Cyyb5UIc.js"),[],import.meta.url)});ot({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>Qe(()=>import("./CokCRk_m.js"),[],import.meta.url)});ot({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>Qe(()=>import("./B8OfTtLu.js"),[],import.meta.url)});ot({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>Qe(()=>import("./BFxVWTOG.js"),[],import.meta.url)});ot({id:"mdx",extensions:[".mdx"],aliases:["MDX","mdx"],loader:()=>Qe(()=>import("./CHJtck-5.js"),[],import.meta.url)});ot({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>Qe(()=>import("./CiqrrVzr.js"),[],import.meta.url)});ot({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>Qe(()=>import("./DmeGPVcC.js"),[],import.meta.url)});ot({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>Qe(()=>import("./C_tMU-Nz.js"),[],import.meta.url)});ot({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>Qe(()=>import("./BDtDVThU.js"),[],import.meta.url)});ot({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>Qe(()=>import("./vHIfCaH5.js"),[],import.meta.url)});ot({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>Qe(()=>import("./DtZ0uQbO.js"),[],import.meta.url)});ot({id:"perl",extensions:[".pl",".pm"],aliases:["Perl","pl"],loader:()=>Qe(()=>import("./Ub6l9XKa.js"),[],import.meta.url)});ot({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>Qe(()=>import("./BlNEE0v7.js"),[],import.meta.url)});ot({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>Qe(()=>import("./BBUBE1dy.js"),[],import.meta.url)});ot({id:"pla",extensions:[".pla"],loader:()=>Qe(()=>import("./DSh2-awV.js"),[],import.meta.url)});ot({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>Qe(()=>import("./CocnycG-.js"),[],import.meta.url)});ot({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>Qe(()=>import("./tScXyioY.js"),[],import.meta.url)});ot({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>Qe(()=>import("./COWaemsV.js"),[],import.meta.url)});ot({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>Qe(()=>import("./Brw8urJB.js"),[],import.meta.url)});ot({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>Qe(()=>import("./8SOpv6rk.js"),[],import.meta.url)});ot({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>Qe(()=>import("./Dqx7mQIO.js"),[],import.meta.url)});ot({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>Qe(()=>import("./Bw9ernYp.js"),[],import.meta.url)});ot({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>Qe(()=>import("./j7ic8hl3.js"),[],import.meta.url)});ot({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>Qe(()=>import("./Bkx7w09s.js"),[],import.meta.url)});ot({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>Qe(()=>import("./Bu5POkcn.js"),[],import.meta.url)});ot({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>Qe(()=>import("./Bs9aos_-.js"),[],import.meta.url)});ot({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>Qe(()=>import("./CqXO7rUv.js"),[],import.meta.url)});ot({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>Qe(()=>import("./zBfavPgS.js"),[],import.meta.url)});ot({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>Qe(()=>import("./BzKRNQWT.js"),[],import.meta.url)});ot({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>Qe(()=>import("./BBc9UKZt.js"),[],import.meta.url)});ot({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>Qe(()=>import("./D9hQfWCl.js"),[],import.meta.url)});ot({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>Qe(()=>import("./BPhDTwHR.js"),[],import.meta.url)});ot({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>Qe(()=>import("./CBJaRo0y.js"),[],import.meta.url)});ot({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>Qe(()=>import("./DiJ1NA_G.js"),[],import.meta.url)});ot({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>Qe(()=>import("./Db0IVjzk.js"),[],import.meta.url)});ot({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>Qe(()=>import("./CnS9iZB_.js"),[],import.meta.url)});ot({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>Qe(()=>import("./CJmd_6j2.js"),[],import.meta.url)});ot({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>Qe(()=>import("./ClhHkBeG.js"),[],import.meta.url)});ot({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib",".TcPOU",".TcDUT",".TcGVL",".TcIO"],aliases:["StructuredText","scl","stl"],loader:()=>Qe(()=>import("./CHwy0fLd.js"),[],import.meta.url)});ot({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>Qe(()=>import("./Bqt4WxQ4.js"),[],import.meta.url)});ot({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>Qe(()=>import("./Bs9z6M-B.js"),[],import.meta.url)});ot({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>Qe(()=>import("./Bs9z6M-B.js"),[],import.meta.url)});ot({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>Qe(()=>import("./Dm6ycUr_.js"),[],import.meta.url)});ot({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>Qe(()=>import("./Csy3S7wG.js"),[],import.meta.url)});ot({id:"typescript",extensions:[".ts",".tsx",".cts",".mts"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>Qe(()=>import("./CCkUbLvU.js"),[],import.meta.url)});ot({id:"typespec",extensions:[".tsp"],aliases:["TypeSpec"],loader:()=>Qe(()=>import("./Btyra-wh.js"),[],import.meta.url)});ot({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>Qe(()=>import("./Db0cS2oM.js"),[],import.meta.url)});ot({id:"wgsl",extensions:[".wgsl"],aliases:["WebGPU Shading Language","WGSL","wgsl"],loader:()=>Qe(()=>import("./BTesnYfV.js"),[],import.meta.url)});ot({id:"xml",extensions:[".xml",".xsd",".dtd",".ascx",".csproj",".config",".props",".targets",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xslt",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>Qe(()=>import("./NIb8UhWf.js"),[],import.meta.url)});ot({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>Qe(()=>import("./XaVeRdqN.js"),[],import.meta.url)});var Ort=Object.defineProperty,Frt=(s,e,t)=>e in s?Ort(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,zt=(s,e,t)=>Frt(s,typeof e!="symbol"?e+"":e,t),LT,lie,IT,q3,ET;function Brt(s){return s.method!==void 0}var cie;(function(s){function e(t){return t}s.create=e})(cie||(cie={}));var lc;(function(s){s.parseError=-32700,s.invalidRequest=-32600,s.methodNotFound=-32601,s.invalidParams=-32602,s.internalError=-32603;function e(o){return-32099<=o&&o<=-32e3}s.isServerError=e;function t(o){if(!e(o))throw new Error("Invalid range for a server error.");return o}s.serverError=t,s.unexpectedServerError=-32e3;function i(o){return!0}s.isApplicationError=i;function n(o){return o}s.applicationError=n,s.genericApplicationError=-320100})(lc||(lc={}));var Qfe=class{constructor(){zt(this,"listeners",new Set),zt(this,"event",s=>(this.listeners.add(s),{dispose:()=>{this.listeners.delete(s)}}))}fire(s){this.listeners.forEach(e=>e(s))}},Wrt=class{constructor(s){zt(this,"_value"),zt(this,"eventEmitter"),this._value=s,this.eventEmitter=new Qfe}get value(){return this._value}set value(s){this._value!==s&&(this._value=s,this.eventEmitter.fire(s))}get onChange(){return this.eventEmitter.event}};function Hrt(s,e){const t=setTimeout(e,s);return{dispose:()=>clearTimeout(t)}}function j3(s,e,t){return s instanceof Set?(s.add(e),{dispose:()=>s.delete(e)}):(s.set(e,t),{dispose:()=>s.delete(e)})}var Vrt=class{constructor(){zt(this,"_state","none"),zt(this,"promise"),zt(this,"resolve",()=>{}),zt(this,"reject",()=>{}),this.promise=new Promise((s,e)=>{this.resolve=s,this.reject=e})}get state(){return this._state}};LT=class{constructor(){zt(this,"_unprocessedMessages",[]),zt(this,"_messageListener"),zt(this,"id",LT.id++),zt(this,"_state",new Wrt({state:"open"})),zt(this,"state",this._state)}setListener(s){if(this._messageListener=s,!!s)for(;this._unprocessedMessages.length>0&&this._messageListener!==void 0;){const e=this._unprocessedMessages.shift();this._messageListener(e)}}send(s){return this._sendImpl(s)}_dispatchReceivedMessage(s){this._unprocessedMessages.length===0&&this._messageListener?this._messageListener(s):this._unprocessedMessages.push(s)}_onConnectionClosed(){this._state.value={state:"closed",error:void 0}}log(s){return new zrt(this,s??new Urt)}},zt(LT,"id",0);var zrt=class{constructor(s,e){zt(this,"baseStream"),zt(this,"logger"),this.baseStream=s,this.logger=e}get state(){return this.baseStream.state}setListener(s){if(s===void 0){this.baseStream.setListener(void 0);return}this.baseStream.setListener(e=>{this.logger.log(this.baseStream,"incoming",e),s(e)})}send(s){return this.logger.log(this.baseStream,"outgoing",s),this.baseStream.send(s)}toString(){return`StreamLogger/${this.baseStream.toString()}`}},Urt=class{log(s,e,t){console.log(`${e==="incoming"?"<-":"->"} [${s.toString()}] ${JSON.stringify(t)}`)}},$rt=class Jfe{constructor(e){zt(this,"connect"),this.connect=e}mapContext(e){return new Jfe(t=>this.connect(t?qrt(t,e):void 0))}};function qrt(s,e){return{handleNotification:(t,i)=>s.handleNotification(t,e(i)),handleRequest:(t,i,n)=>s.handleRequest(t,i,e(n))}}var jrt=class ege{constructor(e,t,i){zt(this,"_stream"),zt(this,"_listener"),zt(this,"_logger"),zt(this,"_unprocessedResponses",new Map),zt(this,"_lastUsedRequestId",0),this._stream=e,this._listener=t,this._logger=i,this._stream.setListener(n=>{Brt(n)?n.id===void 0?this._processNotification(n):this._processRequest(n):this._processResponse(n)})}static createChannel(e,t){let i=!1;return new $rt(n=>{if(i)throw new Error(`A channel to the stream ${e} was already constructed!`);return i=!0,new ege(e,n,t)})}get state(){return this._stream.state}async _processNotification(e){if(e.id!==void 0)throw new Error;if(!this._listener){this._logger&&this._logger.debug({text:"Notification ignored",message:e});return}try{await this._listener.handleNotification({method:e.method,params:e.params||null})}catch(t){this._logger&&this._logger.warn({text:`Exception was thrown while handling notification: ${t}`,exception:t,message:e})}}async _processRequest(e){if(e.id===void 0)throw new Error;let t;if(this._listener)try{t=await this._listener.handleRequest({method:e.method,params:e.params||null},e.id)}catch(n){this._logger&&this._logger.warn({text:`Exception was thrown while handling request: ${n}`,message:e,exception:n}),t={error:{code:lc.internalError,message:"An unexpected exception was thrown.",data:void 0}}}else this._logger&&this._logger.debug({text:"Received request even though not listening for requests",message:e}),t={error:{code:lc.methodNotFound,message:"This endpoint does not listen for requests or notifications.",data:void 0}};let i;"result"in t?i={jsonrpc:"2.0",id:e.id,result:t.result}:i={jsonrpc:"2.0",id:e.id,error:t.error},await this._stream.send(i)}_processResponse(e){const t=""+e.id,i=this._unprocessedResponses.get(t);if(!i){this._logger&&this._logger.debug({text:"Got an unexpected response message",message:e});return}this._unprocessedResponses.delete(t),i(e)}_newRequestId(){return this._lastUsedRequestId++}sendRequest(e,t,i){const n={jsonrpc:"2.0",id:this._newRequestId(),method:e.method,params:e.params||void 0};return i&&i(n.id),new Promise((o,r)=>{const a=""+n.id;this._unprocessedResponses.set(a,l=>{"result"in l?o({result:l.result}):(l.error||r(new Error("Response had neither 'result' nor 'error' field set.")),o({error:l.error}))}),this._stream.send(n).then(void 0,l=>{this._unprocessedResponses.delete(a),r(l)})})}sendNotification(e,t){const i={jsonrpc:"2.0",id:void 0,method:e.method,params:e.params||void 0};return this._stream.send(i)}toString(){return"StreamChannel/"+this._stream.toString()}},V1;(function(s){function e(){return{deserializeFromJson:n=>({hasErrors:!1,value:n}),serializeToJson:n=>n}}s.sAny=e;function t(){return{deserializeFromJson:n=>({hasErrors:!1,value:{}}),serializeToJson:n=>({})}}s.sEmptyObject=t;function i(){return{deserializeFromJson:n=>({hasErrors:!1,value:void 0}),serializeToJson:n=>null}}s.sVoidFromNull=i})(V1||(V1={}));const tge=Symbol("OptionalMethodNotFound");var ige=class{contextualize(s){return new Krt(this,s)}},Krt=class extends ige{constructor(s,e){super(),zt(this,"underylingTypedChannel"),zt(this,"converters"),this.underylingTypedChannel=s,this.converters=e}async request(s,e,t){const i=await this.converters.getSendContext(t);return this.underylingTypedChannel.request(s,e,i)}async notify(s,e,t){const i=await this.converters.getSendContext(t);return this.underylingTypedChannel.notify(s,e,i)}registerNotificationHandler(s,e){return this.underylingTypedChannel.registerNotificationHandler(s,async(t,i)=>await e(t,await this.converters.getNewContext(i)))}registerRequestHandler(s,e){return this.underylingTypedChannel.registerRequestHandler(s,async(t,i,n)=>await e(t,i,await this.converters.getNewContext(n)))}},die=class nge extends ige{constructor(e,t={}){super(),zt(this,"channelCtor"),zt(this,"_requestSender"),zt(this,"_handler",new Map),zt(this,"_unknownNotificationHandler",new Set),zt(this,"_timeout"),zt(this,"sendExceptionDetails",!1),zt(this,"_logger"),zt(this,"listeningDeferred",new Vrt),zt(this,"onListening",this.listeningDeferred.promise),zt(this,"_requestDidErrorEventEmitter",new Qfe),zt(this,"onRequestDidError",this._requestDidErrorEventEmitter.event),this.channelCtor=e,this._logger=t.logger,this.sendExceptionDetails=!!t.sendExceptionDetails,this._timeout=Hrt(1e3,()=>{this._requestSender||console.warn(`"${this.startListen.name}" has not been called within 1 second after construction of this channel. Did you forget to call it?`,this)})}static fromTransport(e,t={}){return new nge(jrt.createChannel(e,t.logger),t)}startListen(){if(this._requestSender)throw new Error(`"${this.startListen.name}" can be called only once, but it already has been called.`);this._timeout&&(this._timeout.dispose(),this._timeout=void 0),this._requestSender=this.channelCtor.connect({handleRequest:(e,t,i)=>this.handleRequest(e,t,i),handleNotification:(e,t)=>this.handleNotification(e,t)}),this.listeningDeferred.resolve()}checkChannel(e){if(!e)throw new Error(`"${this.startListen.name}" must be called before any messages can be sent or received.`);return!0}async handleRequest(e,t,i){const n=this._handler.get(e.method);if(!n)return this._logger&&this._logger.debug({text:`No request handler for "${e.method}".`,data:{requestObject:e}}),{error:{code:lc.methodNotFound,message:`No request handler for "${e.method}".`,data:{method:e.method}}};if(n.kind!="request"){const r=`"${e.method}" is registered as notification, but was sent as request.`;return this._logger&&this._logger.debug({text:r,data:{requestObject:e}}),{error:{code:lc.invalidRequest,message:r,data:{method:e.method}}}}const o=n.requestType.paramsSerializer.deserializeFromJson(e.params);if(o.hasErrors){const r=`Got invalid params: ${o.errorMessage}`;return this._logger&&this._logger.debug({text:r,data:{requestObject:e,errorMessage:o.errorMessage}}),{error:{code:lc.invalidParams,message:r,data:{errors:o.errorMessage}}}}else{const r=o.value;let a;try{const l=await n.handler(r,t,i);if("error"in l||"errorMessage"in l){const c=l.error?n.requestType.errorSerializer.serializeToJson(l.error):void 0;a={error:{code:l.errorCode||lc.genericApplicationError,message:l.errorMessage||"An error was returned",data:c}}}else a={result:n.requestType.resultSerializer.serializeToJson(l.ok)}}catch(l){l instanceof uie?a={error:{code:l.code,message:l.message}}:(this._logger&&this._logger.warn({text:`An exception was thrown while handling a request: ${l}.`,exception:l,data:{requestObject:e}}),a={error:{code:lc.unexpectedServerError,message:this.sendExceptionDetails?`An exception was thrown while handling a request: ${l}.`:"Server has thrown an unexpected exception"}})}return a}}async handleNotification(e,t){const i=this._handler.get(e.method);if(!i){for(const r of this._unknownNotificationHandler)r(e);this._unknownNotificationHandler.size===0&&this._logger&&this._logger.debug({text:`Unhandled notification "${e.method}"`,data:{requestObject:e}});return}if(i.kind!="notification"){this._logger&&this._logger.debug({text:`"${e.method}" is registered as request, but was sent as notification.`,data:{requestObject:e}});return}const n=i.notificationType.paramsSerializer.deserializeFromJson(e.params);if(n.hasErrors){this._logger&&this._logger.debug({text:`Got invalid params: ${n}`,data:{requestObject:e,errorMessage:n.errorMessage}});return}const o=n.value;for(const r of i.handlers)try{r(o,t)}catch(a){this._logger&&this._logger.warn({text:`An exception was thrown while handling a notification: ${a}.`,exception:a,data:{requestObject:e}})}}registerUnknownNotificationHandler(e){return j3(this._unknownNotificationHandler,e)}registerRequestHandler(e,t){if(this._handler.get(e.method))throw new Error(`Handler with method "${e.method}" already registered.`);return j3(this._handler,e.method,{kind:"request",requestType:e,handler:t})}registerNotificationHandler(e,t){let i=this._handler.get(e.method);if(!i)i={kind:"notification",notificationType:e,handlers:new Set},this._handler.set(e.method,i);else{if(i.kind!=="notification")throw new Error(`Method "${e.method}" was already registered as request handler.`);if(i.notificationType!==e)throw new Error(`Method "${e.method}" was registered for a different type.`)}return j3(i.handlers,t)}getRegisteredTypes(){const e=[];for(const t of this._handler.values())t.kind==="notification"?e.push(t.notificationType):t.kind==="request"&&e.push(t.requestType);return e}async request(e,t,i){if(!this.checkChannel(this._requestSender))throw new Error("Impossible");const n=e.paramsSerializer.serializeToJson(t);hie(n);const o=await this._requestSender.sendRequest({method:e.method,params:n},i);if("error"in o){if(e.isOptional&&o.error.code===lc.methodNotFound)return tge;let r;if(o.error.data!==void 0){const l=e.errorSerializer.deserializeFromJson(o.error.data);if(l.hasErrors)throw new Error(l.errorMessage);r=l.value}else r=void 0;const a=new uie(o.error.message,r,o.error.code);throw this._requestDidErrorEventEmitter.fire({error:a}),a}else{const r=e.resultSerializer.deserializeFromJson(o.result);if(r.hasErrors)throw new Error("Could not deserialize response: "+r.errorMessage+`

${JSON.stringify(o,null,2)}`);return r.value}}async notify(e,t,i){if(!this.checkChannel(this._requestSender))throw new Error;const n=e.paramsSerializer.serializeToJson(t);hie(n),this._requestSender.sendNotification({method:e.method,params:n},i)}};function hie(s){if(s!==null&&Array.isArray(s)&&typeof s!="object")throw new Error("Invalid value! Only null, array and object is allowed.")}var uie=class sge extends Error{constructor(e,t,i=lc.genericApplicationError){super(e),zt(this,"data"),zt(this,"code"),this.data=t,this.code=i,Object.setPrototypeOf(this,sge.prototype)}},Grt=class Nz{constructor(e,t,i,n,o=!1){zt(this,"method"),zt(this,"paramsSerializer"),zt(this,"resultSerializer"),zt(this,"errorSerializer"),zt(this,"isOptional"),zt(this,"kind","request"),this.method=e,this.paramsSerializer=t,this.resultSerializer=i,this.errorSerializer=n,this.isOptional=o}withMethod(e){return new Nz(e,this.paramsSerializer,this.resultSerializer,this.errorSerializer)}optional(){return new Nz(this.method,this.paramsSerializer,this.resultSerializer,this.errorSerializer,!0)}},Yrt=class oge{constructor(e,t){zt(this,"method"),zt(this,"paramsSerializer"),zt(this,"kind","notification"),this.method=e,this.paramsSerializer=t}withMethod(e){return new oge(e,this.paramsSerializer)}};function Dt(s){return new Grt((s||{}).method,V1.sAny(),V1.sAny(),V1.sAny())}function Gn(s){return new Yrt((s||{}).method,V1.sAny())}const Xrt=Symbol();var fie=(lie=Xrt,IT=class{constructor(s){zt(this,"error"),zt(this,lie),this.error=s}},zt(IT,"factory",s=>new IT(s)),IT);function Zrt(s){const e=gie(s.server),t=gie(s.client);return new Qrt(s.tags||[],e,t)}function gie(s){const e={};for(const[t,i]of Object.entries(s)){const n=i.method?i.method:t;e[t]=i.withMethod(n)}return e}var Qrt=class rge{constructor(e=[],t,i){zt(this,"tags"),zt(this,"server"),zt(this,"client"),this.tags=e,this.server=t,this.client=i}_onlyDesignTime(){return new Error("This property is not meant to be accessed at runtime")}get TContractObject(){throw this._onlyDesignTime()}get TClientInterface(){throw this._onlyDesignTime()}get TServerInterface(){throw this._onlyDesignTime()}get TClientHandler(){throw this._onlyDesignTime()}get TServerHandler(){throw this._onlyDesignTime()}get TTags(){throw this._onlyDesignTime()}getInterface(e,t,i,n){const o=this.buildCounterpart(e,i),r=this.registerHandlers(e,t,n,o);return{counterpart:o,dispose:()=>r.dispose()}}buildCounterpart(e,t){const i={};for(const[n,o]of Object.entries(t)){let r;o.kind==="request"?o.isOptional?r=async(a,l)=>{a===void 0&&(a={});try{return await e.request(o,a,l)}catch(c){if(c&&c.code===lc.methodNotFound)return tge;throw c}}:r=(a,l)=>(a===void 0&&(a={}),e.request(o,a,l)):r=(a,l)=>(a===void 0&&(a={}),e.notify(o,a,l)),i[n]=r}return i}registerHandlers(e,t,i,n){const o=[];for(const[r,a]of Object.entries(t))if(a.kind==="request"){let l=i[r];if(!l)continue;const c=this.createRequestHandler(n,l);o.push(e.registerRequestHandler(a,c))}else{const l=i[r];l&&o.push(e.registerNotificationHandler(a,(c,d)=>{l(c,{context:d,counterpart:n})}))}return{dispose:()=>o.forEach(r=>r.dispose())}}createRequestHandler(e,t){return async(i,n,o)=>{const r=await t(i,{context:o,counterpart:e,newErr:fie.factory,requestId:n});return r instanceof fie?r.error:{ok:r}}}static getServerFromStream(e,t,i,n){const o=die.fromTransport(t,i),{server:r}=e.getServer(o,n);return o.startListen(),{channel:o,server:r}}static registerServerToStream(e,t,i,n){const o=die.fromTransport(t,i),{client:r}=e.registerServer(o,n);return o.startListen(),{channel:o,client:r}}getServer(e,t){const{counterpart:i,dispose:n}=this.getInterface(e,this.client,this.server,t);return{server:i,dispose:n}}registerServer(e,t){const{counterpart:i,dispose:n}=this.getInterface(e,this.server,this.client,t);return{client:i,dispose:n}}withContext(){return new rge(this.tags,this.server,this.client)}};let K3=(function(s){return s.Comment="comment",s.Imports="imports",s.Region="region",s})({}),cs=(function(s){return s[s.File=1]="File",s[s.Module=2]="Module",s[s.Namespace=3]="Namespace",s[s.Package=4]="Package",s[s.Class=5]="Class",s[s.Method=6]="Method",s[s.Property=7]="Property",s[s.Field=8]="Field",s[s.Constructor=9]="Constructor",s[s.Enum=10]="Enum",s[s.Interface=11]="Interface",s[s.Function=12]="Function",s[s.Variable=13]="Variable",s[s.Constant=14]="Constant",s[s.String=15]="String",s[s.Number=16]="Number",s[s.Boolean=17]="Boolean",s[s.Array=18]="Array",s[s.Object=19]="Object",s[s.Key=20]="Key",s[s.Null=21]="Null",s[s.EnumMember=22]="EnumMember",s[s.Struct=23]="Struct",s[s.Event=24]="Event",s[s.Operator=25]="Operator",s[s.TypeParameter=26]="TypeParameter",s})({}),Jrt=(function(s){return s[s.Deprecated=1]="Deprecated",s})({}),mie=(function(s){return s[s.Type=1]="Type",s[s.Parameter=2]="Parameter",s})({}),gs=(function(s){return s[s.Text=1]="Text",s[s.Method=2]="Method",s[s.Function=3]="Function",s[s.Constructor=4]="Constructor",s[s.Field=5]="Field",s[s.Variable=6]="Variable",s[s.Class=7]="Class",s[s.Interface=8]="Interface",s[s.Module=9]="Module",s[s.Property=10]="Property",s[s.Unit=11]="Unit",s[s.Value=12]="Value",s[s.Enum=13]="Enum",s[s.Keyword=14]="Keyword",s[s.Snippet=15]="Snippet",s[s.Color=16]="Color",s[s.File=17]="File",s[s.Reference=18]="Reference",s[s.Folder=19]="Folder",s[s.EnumMember=20]="EnumMember",s[s.Constant=21]="Constant",s[s.Struct=22]="Struct",s[s.Event=23]="Event",s[s.Operator=24]="Operator",s[s.TypeParameter=25]="TypeParameter",s})({}),eat=(function(s){return s[s.Deprecated=1]="Deprecated",s})({}),tat=(function(s){return s[s.PlainText=1]="PlainText",s[s.Snippet=2]="Snippet",s})({}),G3=(function(s){return s[s.Text=1]="Text",s[s.Read=2]="Read",s[s.Write=3]="Write",s})({}),Pg=(function(s){return s[s.Error=1]="Error",s[s.Warning=2]="Warning",s[s.Information=3]="Information",s[s.Hint=4]="Hint",s})({}),pie=(function(s){return s[s.Unnecessary=1]="Unnecessary",s[s.Deprecated=2]="Deprecated",s})({}),Y3=(function(s){return s[s.Invoked=1]="Invoked",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.TriggerForIncompleteCompletions=3]="TriggerForIncompleteCompletions",s})({}),X3=(function(s){return s[s.Invoked=1]="Invoked",s[s.TriggerCharacter=2]="TriggerCharacter",s[s.ContentChange=3]="ContentChange",s})({}),_ie=(function(s){return s[s.Invoked=1]="Invoked",s[s.Automatic=2]="Automatic",s})({});var di=class{constructor(s){this.method=s}};const iat={textDocumentImplementation:new di("textDocument/implementation"),textDocumentTypeDefinition:new di("textDocument/typeDefinition"),textDocumentDocumentColor:new di("textDocument/documentColor"),textDocumentColorPresentation:new di("textDocument/colorPresentation"),textDocumentFoldingRange:new di("textDocument/foldingRange"),textDocumentDeclaration:new di("textDocument/declaration"),textDocumentSelectionRange:new di("textDocument/selectionRange"),textDocumentPrepareCallHierarchy:new di("textDocument/prepareCallHierarchy"),textDocumentSemanticTokensFull:new di("textDocument/semanticTokens/full"),textDocumentSemanticTokensFullDelta:new di("textDocument/semanticTokens/full/delta"),textDocumentLinkedEditingRange:new di("textDocument/linkedEditingRange"),workspaceWillCreateFiles:new di("workspace/willCreateFiles"),workspaceWillRenameFiles:new di("workspace/willRenameFiles"),workspaceWillDeleteFiles:new di("workspace/willDeleteFiles"),textDocumentMoniker:new di("textDocument/moniker"),textDocumentPrepareTypeHierarchy:new di("textDocument/prepareTypeHierarchy"),textDocumentInlineValue:new di("textDocument/inlineValue"),textDocumentInlayHint:new di("textDocument/inlayHint"),textDocumentDiagnostic:new di("textDocument/diagnostic"),textDocumentInlineCompletion:new di("textDocument/inlineCompletion"),textDocumentWillSaveWaitUntil:new di("textDocument/willSaveWaitUntil"),textDocumentCompletion:new di("textDocument/completion"),textDocumentHover:new di("textDocument/hover"),textDocumentSignatureHelp:new di("textDocument/signatureHelp"),textDocumentDefinition:new di("textDocument/definition"),textDocumentReferences:new di("textDocument/references"),textDocumentDocumentHighlight:new di("textDocument/documentHighlight"),textDocumentDocumentSymbol:new di("textDocument/documentSymbol"),textDocumentCodeAction:new di("textDocument/codeAction"),workspaceSymbol:new di("workspace/symbol"),textDocumentCodeLens:new di("textDocument/codeLens"),textDocumentDocumentLink:new di("textDocument/documentLink"),textDocumentFormatting:new di("textDocument/formatting"),textDocumentRangeFormatting:new di("textDocument/rangeFormatting"),textDocumentRangesFormatting:new di("textDocument/rangesFormatting"),textDocumentOnTypeFormatting:new di("textDocument/onTypeFormatting"),textDocumentRename:new di("textDocument/rename"),workspaceExecuteCommand:new di("workspace/executeCommand"),workspaceDidCreateFiles:new di("workspace/didCreateFiles"),workspaceDidRenameFiles:new di("workspace/didRenameFiles"),workspaceDidDeleteFiles:new di("workspace/didDeleteFiles"),workspaceDidChangeConfiguration:new di("workspace/didChangeConfiguration"),textDocumentDidOpen:new di("textDocument/didOpen"),textDocumentDidChange:new di("textDocument/didChange"),textDocumentDidClose:new di("textDocument/didClose"),textDocumentDidSave:new di("textDocument/didSave"),textDocumentWillSave:new di("textDocument/willSave"),workspaceDidChangeWatchedFiles:new di("workspace/didChangeWatchedFiles")};Zrt({server:{textDocumentImplementation:Dt({method:"textDocument/implementation"}),textDocumentTypeDefinition:Dt({method:"textDocument/typeDefinition"}),textDocumentDocumentColor:Dt({method:"textDocument/documentColor"}),textDocumentColorPresentation:Dt({method:"textDocument/colorPresentation"}),textDocumentFoldingRange:Dt({method:"textDocument/foldingRange"}),textDocumentDeclaration:Dt({method:"textDocument/declaration"}),textDocumentSelectionRange:Dt({method:"textDocument/selectionRange"}),textDocumentPrepareCallHierarchy:Dt({method:"textDocument/prepareCallHierarchy"}),callHierarchyIncomingCalls:Dt({method:"callHierarchy/incomingCalls"}),callHierarchyOutgoingCalls:Dt({method:"callHierarchy/outgoingCalls"}),textDocumentSemanticTokensFull:Dt({method:"textDocument/semanticTokens/full"}),textDocumentSemanticTokensFullDelta:Dt({method:"textDocument/semanticTokens/full/delta"}),textDocumentSemanticTokensRange:Dt({method:"textDocument/semanticTokens/range"}),textDocumentLinkedEditingRange:Dt({method:"textDocument/linkedEditingRange"}),workspaceWillCreateFiles:Dt({method:"workspace/willCreateFiles"}),workspaceWillRenameFiles:Dt({method:"workspace/willRenameFiles"}),workspaceWillDeleteFiles:Dt({method:"workspace/willDeleteFiles"}),textDocumentMoniker:Dt({method:"textDocument/moniker"}),textDocumentPrepareTypeHierarchy:Dt({method:"textDocument/prepareTypeHierarchy"}),typeHierarchySupertypes:Dt({method:"typeHierarchy/supertypes"}),typeHierarchySubtypes:Dt({method:"typeHierarchy/subtypes"}),textDocumentInlineValue:Dt({method:"textDocument/inlineValue"}),textDocumentInlayHint:Dt({method:"textDocument/inlayHint"}),inlayHintResolve:Dt({method:"inlayHint/resolve"}),textDocumentDiagnostic:Dt({method:"textDocument/diagnostic"}),workspaceDiagnostic:Dt({method:"workspace/diagnostic"}),textDocumentInlineCompletion:Dt({method:"textDocument/inlineCompletion"}),initialize:Dt({method:"initialize"}),shutdown:Dt({method:"shutdown"}),textDocumentWillSaveWaitUntil:Dt({method:"textDocument/willSaveWaitUntil"}),textDocumentCompletion:Dt({method:"textDocument/completion"}),completionItemResolve:Dt({method:"completionItem/resolve"}),textDocumentHover:Dt({method:"textDocument/hover"}),textDocumentSignatureHelp:Dt({method:"textDocument/signatureHelp"}),textDocumentDefinition:Dt({method:"textDocument/definition"}),textDocumentReferences:Dt({method:"textDocument/references"}),textDocumentDocumentHighlight:Dt({method:"textDocument/documentHighlight"}),textDocumentDocumentSymbol:Dt({method:"textDocument/documentSymbol"}),textDocumentCodeAction:Dt({method:"textDocument/codeAction"}),codeActionResolve:Dt({method:"codeAction/resolve"}),workspaceSymbol:Dt({method:"workspace/symbol"}),workspaceSymbolResolve:Dt({method:"workspaceSymbol/resolve"}),textDocumentCodeLens:Dt({method:"textDocument/codeLens"}),codeLensResolve:Dt({method:"codeLens/resolve"}),textDocumentDocumentLink:Dt({method:"textDocument/documentLink"}),documentLinkResolve:Dt({method:"documentLink/resolve"}),textDocumentFormatting:Dt({method:"textDocument/formatting"}),textDocumentRangeFormatting:Dt({method:"textDocument/rangeFormatting"}),textDocumentRangesFormatting:Dt({method:"textDocument/rangesFormatting"}),textDocumentOnTypeFormatting:Dt({method:"textDocument/onTypeFormatting"}),textDocumentRename:Dt({method:"textDocument/rename"}),textDocumentPrepareRename:Dt({method:"textDocument/prepareRename"}),workspaceExecuteCommand:Dt({method:"workspace/executeCommand"}),workspaceDidChangeWorkspaceFolders:Gn({method:"workspace/didChangeWorkspaceFolders"}),windowWorkDoneProgressCancel:Gn({method:"window/workDoneProgress/cancel"}),workspaceDidCreateFiles:Gn({method:"workspace/didCreateFiles"}),workspaceDidRenameFiles:Gn({method:"workspace/didRenameFiles"}),workspaceDidDeleteFiles:Gn({method:"workspace/didDeleteFiles"}),notebookDocumentDidOpen:Gn({method:"notebookDocument/didOpen"}),notebookDocumentDidChange:Gn({method:"notebookDocument/didChange"}),notebookDocumentDidSave:Gn({method:"notebookDocument/didSave"}),notebookDocumentDidClose:Gn({method:"notebookDocument/didClose"}),initialized:Gn({method:"initialized"}),exit:Gn({method:"exit"}),workspaceDidChangeConfiguration:Gn({method:"workspace/didChangeConfiguration"}),textDocumentDidOpen:Gn({method:"textDocument/didOpen"}),textDocumentDidChange:Gn({method:"textDocument/didChange"}),textDocumentDidClose:Gn({method:"textDocument/didClose"}),textDocumentDidSave:Gn({method:"textDocument/didSave"}),textDocumentWillSave:Gn({method:"textDocument/willSave"}),workspaceDidChangeWatchedFiles:Gn({method:"workspace/didChangeWatchedFiles"}),setTrace:Gn({method:"$/setTrace"}),cancelRequest:Gn({method:"$/cancelRequest"}),progress:Gn({method:"$/progress"})},client:{workspaceWorkspaceFolders:Dt({method:"workspace/workspaceFolders"}).optional(),workspaceConfiguration:Dt({method:"workspace/configuration"}).optional(),workspaceFoldingRangeRefresh:Dt({method:"workspace/foldingRange/refresh"}).optional(),windowWorkDoneProgressCreate:Dt({method:"window/workDoneProgress/create"}).optional(),workspaceSemanticTokensRefresh:Dt({method:"workspace/semanticTokens/refresh"}).optional(),windowShowDocument:Dt({method:"window/showDocument"}).optional(),workspaceInlineValueRefresh:Dt({method:"workspace/inlineValue/refresh"}).optional(),workspaceInlayHintRefresh:Dt({method:"workspace/inlayHint/refresh"}).optional(),workspaceDiagnosticRefresh:Dt({method:"workspace/diagnostic/refresh"}).optional(),clientRegisterCapability:Dt({method:"client/registerCapability"}).optional(),clientUnregisterCapability:Dt({method:"client/unregisterCapability"}).optional(),windowShowMessageRequest:Dt({method:"window/showMessageRequest"}).optional(),workspaceCodeLensRefresh:Dt({method:"workspace/codeLens/refresh"}).optional(),workspaceApplyEdit:Dt({method:"workspace/applyEdit"}).optional(),windowShowMessage:Gn({method:"window/showMessage"}),windowLogMessage:Gn({method:"window/logMessage"}),telemetryEvent:Gn({method:"telemetry/event"}),textDocumentPublishDiagnostics:Gn({method:"textDocument/publishDiagnostics"}),logTrace:Gn({method:"$/logTrace"}),cancelRequest:Gn({method:"$/cancelRequest"}),progress:Gn({method:"$/progress"})}});q3=class{constructor(){zt(this,"_store",new nat)}dispose(){this._store.dispose()}_register(s){if(s===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(s)}},zt(q3,"None",Object.freeze({dispose(){}}));var nat=(ET=class{constructor(){zt(this,"_toDispose",new Set),zt(this,"_isDisposed",!1)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}clear(){if(this._toDispose.size!==0)try{for(const s of this._toDispose)s.dispose()}finally{this._toDispose.clear()}}add(s){if(!s)return s;if(s===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?ET.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(s),s}},zt(ET,"DISABLE_DISPOSED_WARNING",!1),ET);Xe.CodeActionTriggerType.Invoke,_ie.Invoked,Xe.CodeActionTriggerType.Auto,_ie.Automatic;gs.Text,Xe.CompletionItemKind.Text,gs.Method,Xe.CompletionItemKind.Method,gs.Function,Xe.CompletionItemKind.Function,gs.Constructor,Xe.CompletionItemKind.Constructor,gs.Field,Xe.CompletionItemKind.Field,gs.Variable,Xe.CompletionItemKind.Variable,gs.Class,Xe.CompletionItemKind.Class,gs.Interface,Xe.CompletionItemKind.Interface,gs.Module,Xe.CompletionItemKind.Module,gs.Property,Xe.CompletionItemKind.Property,gs.Unit,Xe.CompletionItemKind.Unit,gs.Value,Xe.CompletionItemKind.Value,gs.Enum,Xe.CompletionItemKind.Enum,gs.Keyword,Xe.CompletionItemKind.Keyword,gs.Snippet,Xe.CompletionItemKind.Snippet,gs.Color,Xe.CompletionItemKind.Color,gs.File,Xe.CompletionItemKind.File,gs.Reference,Xe.CompletionItemKind.Reference,gs.Folder,Xe.CompletionItemKind.Folder,gs.EnumMember,Xe.CompletionItemKind.EnumMember,gs.Constant,Xe.CompletionItemKind.Constant,gs.Struct,Xe.CompletionItemKind.Struct,gs.Event,Xe.CompletionItemKind.Event,gs.Operator,Xe.CompletionItemKind.Operator,gs.TypeParameter,Xe.CompletionItemKind.TypeParameter;eat.Deprecated,Xe.CompletionItemTag.Deprecated;Xe.CompletionTriggerKind.Invoke,Y3.Invoked,Xe.CompletionTriggerKind.TriggerCharacter,Y3.TriggerCharacter,Xe.CompletionTriggerKind.TriggerForIncompleteCompletions,Y3.TriggerForIncompleteCompletions;tat.Snippet,Xe.CompletionItemInsertTextRule.InsertAsSnippet;cs.File,Xe.SymbolKind.File,cs.Module,Xe.SymbolKind.Module,cs.Namespace,Xe.SymbolKind.Namespace,cs.Package,Xe.SymbolKind.Package,cs.Class,Xe.SymbolKind.Class,cs.Method,Xe.SymbolKind.Method,cs.Property,Xe.SymbolKind.Property,cs.Field,Xe.SymbolKind.Field,cs.Constructor,Xe.SymbolKind.Constructor,cs.Enum,Xe.SymbolKind.Enum,cs.Interface,Xe.SymbolKind.Interface,cs.Function,Xe.SymbolKind.Function,cs.Variable,Xe.SymbolKind.Variable,cs.Constant,Xe.SymbolKind.Constant,cs.String,Xe.SymbolKind.String,cs.Number,Xe.SymbolKind.Number,cs.Boolean,Xe.SymbolKind.Boolean,cs.Array,Xe.SymbolKind.Array,cs.Object,Xe.SymbolKind.Object,cs.Key,Xe.SymbolKind.Key,cs.Null,Xe.SymbolKind.Null,cs.EnumMember,Xe.SymbolKind.EnumMember,cs.Struct,Xe.SymbolKind.Struct,cs.Event,Xe.SymbolKind.Event,cs.Operator,Xe.SymbolKind.Operator,cs.TypeParameter,Xe.SymbolKind.TypeParameter;Jrt.Deprecated,Xe.SymbolTag.Deprecated;G3.Text,Xe.DocumentHighlightKind.Text,G3.Read,Xe.DocumentHighlightKind.Read,G3.Write,Xe.DocumentHighlightKind.Write;K3.Comment,Xe.FoldingRangeKind.Comment,K3.Imports,Xe.FoldingRangeKind.Imports,K3.Region,Xe.FoldingRangeKind.Region;Hu.Error,Pg.Error,Hu.Warning,Pg.Warning,Hu.Info,Pg.Information,Hu.Hint,Pg.Hint;Pg.Error,Hu.Error,Pg.Warning,Hu.Warning,Pg.Information,Hu.Info,Pg.Hint,Hu.Hint;pie.Unnecessary,Tz.Unnecessary,pie.Deprecated,Tz.Deprecated;Xe.SignatureHelpTriggerKind.Invoke,X3.Invoked,Xe.SignatureHelpTriggerKind.TriggerCharacter,X3.TriggerCharacter,Xe.SignatureHelpTriggerKind.ContentChange,X3.ContentChange;mie.Type,Xe.InlayHintKind.Type,mie.Parameter,Xe.InlayHintKind.Parameter;new Map([...Object.values(iat)].map(s=>[s.method,s]));function sat(s,e){var i;const t=globalThis.MonacoEnvironment;if(t!=null&&t.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(s,e)}catch(n){console.error(n);return}try{return(i=globalThis.trustedTypes)==null?void 0:i.createPolicy(s,e)}catch(n){console.error(n);return}}let tA;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?tA=globalThis.workerttPolicy:tA=sat("defaultWorkerFactory",{createScriptURL:s=>s});function oat(s){const e=s.label,t=globalThis.MonacoEnvironment;if(t){if(typeof t.getWorker=="function")return t.getWorker("workerMain.js",e);if(typeof t.getWorkerUrl=="function"){const i=t.getWorkerUrl("workerMain.js",e);return new Worker(tA?tA.createScriptURL(i):i,{name:e,type:"module"})}}if(s.createWorker)return s.createWorker();throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function $ft(s){const e=Promise.resolve(oat({label:s.label??"monaco-editor-worker",moduleId:s.moduleId,createWorker:s.createWorker})).then(t=>(t.postMessage("ignore"),t.postMessage(s.createData),t));return Jw.createWebWorker({worker:e,host:s.host,keepIdleModels:s.keepIdleModels})}function age(){return _rt}const Z3=globalThis.MonacoEnvironment;Z3!=null&&Z3.globalAPI&&(globalThis.monaco=age());const e5=age();e5.languages.css=brt;e5.languages.html=Lrt;e5.languages.typescript=Prt;e5.languages.json=Trt;class rat{constructor(e,t,i){this._onDidChange=new cv,this._languageId=e,this.setModeConfiguration(t),this._preprocessCode=i??null}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get completionService(){return this._modeConfiguration.completionItems.completionService}get completionSnippets(){return this._modeConfiguration.completionItems.snippets}get triggerCharacters(){return this._modeConfiguration.completionItems.triggerCharacters}get preprocessCode(){return this._preprocessCode}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}}const aat=function(s,e,t,i,n,o){if(!i)return Promise.resolve([]);const{keywords:r}=i,a=r.map(c=>({label:c,kind:Xe.CompletionItemKind.Keyword,detail:"keyword"})),l=(o==null?void 0:o.map(c=>({label:c.label||c.prefix,kind:Xe.CompletionItemKind.Snippet,filterText:c.prefix,insertText:c.insertText,insertTextRules:Xe.CompletionItemInsertTextRule.InsertAsSnippet,detail:c.description||"snippet",documentation:c.insertText})))||[];return Promise.resolve([...a,...l])},uC={completionItems:{enable:!0,completionService:aat,triggerCharacters:["."," "]},diagnostics:!0,definitions:!0,references:!0};var Kd;(function(s){s.FLINK="flinksql",s.HIVE="hivesql",s.MYSQL="mysql",s.PG="pgsql",s.SPARK="sparksql",s.TRINO="trinosql",s.IMPALA="impalasql"})(Kd||(Kd={}));const lat=[{label:"select",prefix:"SELECT",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name};\n$4"]},{label:"select-join",prefix:"SELECT-JOIN",body:["SELECT ${8:column1} FROM ${1:table_name} ${2:t1}","${3:LEFT} JOIN ${4:table2} ${5:t2} ON ${2:t1}.${6:column1} = ${5:t2}.${7:column2};\n$9"]},{label:"select-order-by",prefix:"SELECT-ORDERBY",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name} ORDER BY ${4:column1} ${5:desc};\n$6"]},{label:"insert",prefix:"INSERT-INTO",body:["INSERT INTO ${1:table_name} (${2:column1}, ${3:column2}) VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO TABLE ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"insert-overwrite-table",prefix:"INSERT-OVERWRITE-TABLE",body:["INSERT OVERWRITE TABLE ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"update",prefix:"UPDATE",body:["UPDATE ${1:table_name}","SET ${2:column1} = ${3:value1}","WHERE ${4:column2} = ${5:value2};\n$6"]},{label:"delete",prefix:"DELETE",body:["DELETE FROM ${1:table_name}","WHERE ${2:column1} = ${3:value1};\n$4"]},{label:"create-table",prefix:"CREATE-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","COMMENT '${6:table_comment}'","ROW FORMAT ${7:DELIMITED}","FIELDS TERMINATED BY '${8:\\t}'","STORED AS ${9:PARQUET};\n$10"]},{label:"create-table-as-select",prefix:"CREATE-TABLE-AS-SELECT",body:["CREATE TABLE IF NOT EXISTS ${1:table_name}","AS","SELECT ${2:column1}, ${3:column2}","FROM ${4:source_table}","WHERE ${5:conditions};\n$6"]},{label:"create-partition-table",prefix:"CREATE-PARTITION-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","COMMENT '${6:table_comment}'","PARTITIONED BY (${7:part_column_name} STRING)","ROW FORMAT ${8:DELIMITED}","FIELDS TERMINATED BY '${9:\\t}'","STORED AS ${10:PARQUET};\n$11"]},{label:"create-bucket-table",prefix:"CREATE-BUCKET-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","COMMENT '${6:table_comment}'","PARTITIONED BY (${7:part_column_name} STRING)","CLUSTERED BY (${8:bucket_column_name}) INTO ${9:1} BUCKETS","ROW FORMAT ${10:DELIMITED}","FIELDS TERMINATED BY '${11:\\t}'","STORED AS ${12:PARQUET};\n$13"]},{label:"alter-table-partition",prefix:"ALTER-TABLE-PARTITION",body:["ALTER TABLE ${1:table_name} ${2:ADD} PARTITION (${3:part_column}='${4:part_value}');\n$5"]},{label:"alter-table-properties",prefix:"ALTER-TABLE-PROPERTIES",body:["ALTER TABLE ${1:table_name} SET TBLPROPERTIES ('${2:property_name}'='${3:property_value}');\n$4"]},{label:"alter-table-columns",prefix:"ALTER-TABLE-COLUMNS",body:["ALTER TABLE ${1:table_name} ADD COLUMNS (","	${2:column_name} ${3:STRING} COMMENT '${4:desc}'",`);
$5`]}],cat=[{label:"create-source-table",prefix:"CREATE-SOURCE-TABLE",body:["CREATE TABLE ${1:source_table} (","	id STRING,","	val BIGINT,","	ts TIMESTAMP(3),","	WATERMARK FOR ts AS ts - INTERVAL '5' SECOND",") WITH (","	'connector' = 'kafka',","	'topic' = 'input_topic',","	'properties.bootstrap.servers' = 'localhost:9092',","	'format' = 'json',","	'scan.startup.mode' = 'earliest-offset'",");"]},{label:"create-sink-table",prefix:"CREATE-SINK-TABLE",body:["CREATE TABLE ${1:sink_table} (","	id STRING,","	cnt BIGINT",") WITH (","	'connector' = 'jdbc',","	'url' = 'jdbc:mysql://localhost:3306/test',","	'table-name' = 'output_table',","	'username' = 'root',","	'password' = 'password'",");"]},{label:"tumble-window",prefix:"TUMBLE-WINDOW",body:["SELECT","	window_start,","	window_end,","	SUM(price) as total_price","FROM","	TABLE(TUMBLE(TABLE table_name2,","	DESCRIPTOR(create_time),","	INTERVAL '1' MINUTE))","GROUP BY","	window_start,","	window_end;"]},{label:"hop-window",prefix:"HOP-WINDOW",body:["SELECT","	window_start,","	window_end,","	SUM(price) as total_price","FROM","	TABLE(HOP(TABLE table_name2,","	DESCRIPTOR(create_time),","	INTERVAL '30' SECONDS,","	INTERVAL '1' MINUTE))","GROUP BY","	window_start,","	window_end;"]},{label:"comulate-window",prefix:"CUMULATE-WINDOW",body:["SELECT","	window_start,","	window_end,","	SUM(price) as total_price","FROM","	TABLE(CUMULATE(TABLE table_name2,","	DESCRIPTOR(create_time),","	INTERVAL '30' SECONDS,","	INTERVAL '1' MINUTE))","GROUP BY","	window_start,","	window_end;"]},{label:"session-window",prefix:"SESSION-WINDOW",body:["SELECT","	SESSION_START(create_time, INTERVAL '10' SECOND) AS session_beg,","	SESSION_ROWTIME(create_time, INTERVAL '10' SECOND) AS session_end,","	SUM(price) AS total_price","FROM","	table_name","GROUP BY","	SESSION(create_time, INTERVAL '10' SECOND);"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO ${1:table_name}","SELECT ${2:column1}, ${3:column2}","FROM ${4:source_table}","WHERE ${5:conditions};\n$6"]}],dat=[{label:"select",prefix:"SELECT",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:hive.schema_name.table_name};\n$4"]},{label:"select-join",prefix:"SELECT-JOIN",body:["SELECT ${8:column1} FROM ${1:hive.schema_name.table_name1} ${2:t1}","${3:LEFT} JOIN ${4:hive.schema_name.table_name2} ${5:t2} ON ${2:t1}.${6:column1} = ${5:t2}.${7:column2};\n$9"]},{label:"select-order-by",prefix:"SELECT-ORDER-BY",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:hive.schema_name.table_name} ORDER BY ${4:column1} ${5:desc};\n$6"]},{label:"insert",prefix:"INSERT-INTO",body:["INSERT INTO ${1:hive.schema_name.table_name} (${2:column1}, ${3:column2}) VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO ${1:hive.schema_name.table_name}","SELECT ${2:column1}, ${3:column2}","FROM ${4:source_table}","WHERE ${5:conditions};\n$6"]},{label:"update",prefix:"UPDATE",body:["UPDATE ${1:hive.schema_name.table_name}","SET ${2:column1} = ${3:value1}","WHERE ${4:column2} = ${5:value2};\n$6"]},{label:"delete",prefix:"DELETE",body:["DELETE FROM ${1:hive.schema_name.table_name}","WHERE ${2:column1} = ${3:value1};\n$4"]},{label:"create-catalog",prefix:"CREATE-CATALOG",body:["CREATE CATALOG ${1:catalog_name} USING ${2:hive}","WITH (","	${3:property_name} = '${4:property_value}'",`);
$5`]},{label:"create-schema",prefix:"CREATE-SCHEMA",body:["CREATE SCHEMA ${1:hive.schema_name} WITH (LOCATION = '${2:/hive/data/web}');\n$3"]},{label:"create-table",prefix:"CREATE-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:hive.schema_name.table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","COMMENT '${6:table_comment}'","WITH (","	format = '${7:PARQUET}'",`);
$8`]},{label:"create-table-as-select",prefix:"CREATE-TABLE-AS-SELECT",body:["CREATE TABLE IF NOT EXISTS ${1:hive.schema_name.table_name}","AS","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"alter-table-properties",prefix:"ALTER-TABLE-PROPERTIES",body:["ALTER TABLE ${1:hive.schema_name.table_name} SET PROPERTIES ${2:property_name} = '${3:property_value}';\n$4"]},{label:"alter-table-columns",prefix:"ALTER-TABLE-COLUMNS",body:["ALTER TABLE ${1:hive.schema_name.table_name} ADD COLUMN ${2:column_name} ${3:STRING} COMMENT '${4:desc}';\n$5"]}],hat=[{label:"select",prefix:"SELECT",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name};\n$4"]},{label:"select-join",prefix:"SELECT-JOIN",body:["SELECT ${8:column1} FROM ${1:table_name} ${2:t1}","${3:LEFT} JOIN ${4:table2} ${5:t2} ON ${2:t1}.${6:column1} = ${5:t2}.${7:column2};\n$9"]},{label:"select-order-by",prefix:"SELECT-ORDER-BY",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name} ORDER BY ${4:column1} ${5:desc};\n$6"]},{label:"insert",prefix:"INSERT-INTO",body:["INSERT INTO ${1:table_name} (${2:column1}, ${3:column2}) VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"update",prefix:"UPDATE",body:["UPDATE ${1:table_name}","SET ${2:column1} = ${3:value1}","WHERE ${4:column2} = ${5:value2};\n$6"]},{label:"delete",prefix:"DELETE",body:["DELETE FROM ${1:table_name}","WHERE ${2:column1} = ${3:value1};\n$4"]},{label:"create-table",prefix:"CREATE-TABLE",body:["CREATE TABLE  ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT},","	PRIMARY KEY (${2:column1})",`);
$6`]},{label:"create-table-as-select",prefix:"CREATE-TABLE-AS-SELECT",body:["CREATE TABLE ${1:table_name}","AS","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"create-table-partitioned-by-range",prefix:"CREATE-TABLE-PARTITIONED-BY-RANGE",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT}",")","PARTITION BY RANGE (${2:column1});\n","CREATE TABLE ${6:p0} PARTITION OF ${1:table_name}","	FOR VALUES FROM (${7:start_value}) TO (${8:end_value});\n$9"]},{label:"create-table-partitioned-by-list",prefix:"CREATE-TABLE-PARTITIONED-BY-LIST",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT}",")","PARTITION BY LIST (${2:column1});\n","CREATE TABLE ${6:p0} PARTITION OF ${1:table_name}","	FOR VALUES IN (${7:range_values});\n$8"]},{label:"create-table-partitioned-by-hash",prefix:"CREATE-TABLE-PARTITIONED-BY-HASH",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT}",")","PARTITION BY HASH (${2:column1});\n","CREATE TABLE ${6:p0} PARTITION OF ${1:table_name}","	FOR VALUES WITH (MODULUS ${7:4}, REMAINDER ${8:0});\n$9"]},{label:"alter-table-add-column",prefix:"ALTER-TABLE-ADD-COLUMN",body:["ALTER TABLE ${1:table_name} ADD COLUMN ${2:column_name} ${3:INT};\n$4"]},{label:"alter-table-add-primary-key",prefix:"ALTER-TABLE-ADD-PRIMARY-KEY",body:["ALTER TABLE ${1:table_name} ADD CONSTRAINT ${2:pk_name} PRIMARY KEY (${3:column_name});\n$4"]},{label:"alter-table-add-foreign-key",prefix:"ALTER-TABLE-ADD-FOREIGN-KEY",body:["ALTER TABLE ${1:table_name}","ADD CONSTRAINT ${2:fk_name}","FOREIGN KEY (${3:foreign_column}) REFERENCES ${4:ref_table} (${5:ref_column});\n$6"]}],uat=[{label:"select",prefix:"SELECT",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name};\n$4"]},{label:"select-join",prefix:"SELECT-JOIN",body:["SELECT ${8:column1} FROM ${1:table_name} ${2:t1}","${3:LEFT} JOIN ${4:table2} ${5:t2} ON ${2:t1}.${6:column1} = ${5:t2}.${7:column2};\n$9"]},{label:"select-order-by",prefix:"SELECT-ORDER-BY",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name} ORDER BY ${4:column1} ${5:desc};\n$6"]},{label:"insert",prefix:"INSERT-INTO",body:["INSERT INTO ${1:table_name} (${2:column1}, ${3:column2}) VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO ${1:table_name}","SELECT ${2:column1}, ${3:column2}","FROM ${4:source_table}","WHERE ${5:conditions};\n$6"]},{label:"insert-overwrite-table",prefix:"INSERT-OVERWRITE-TABLE",body:["INSERT OVERWRITE TABLE ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"update",prefix:"UPDATE",body:["UPDATE ${1:table_name}","SET ${2:column1} = ${3:value1}","WHERE ${4:column2} = ${5:value2};\n$6"]},{label:"delete",prefix:"DELETE",body:["DELETE FROM ${1:table_name}","WHERE ${2:column1} = ${3:value1};\n$4"]},{label:"create-table",prefix:"CREATE-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","USING ${6:parquet}","COMMENT '${7:table_comment}';\n$8"]},{label:"create-table-as-select",prefix:"CREATE-TABLE-AS-SELECT",body:["CREATE TABLE IF NOT EXISTS ${1:table_name}","AS","SELECT ${2:column1}, ${3:column2}","FROM ${4:source_table}","WHERE ${5:conditions};\n$6"]},{label:"create-partition-table",prefix:"CREATE-PARTITION-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","USING ${6:parquet}","PARTITIONED BY (${7:part_column_name} ${8:STRING})","COMMENT '${9:table_comment}';\n$10"]},{label:"create-bucket-table",prefix:"CREATE-BUCKET-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","USING ${6:parquet}","CLUSTERED BY (${7:bucket_column}) INTO ${8:1} BUCKETS","COMMENT '${9:table_comment}';\n$10"]},{label:"alter-table-partition",prefix:"ALTER-TABLE-PARTITION",body:["ALTER TABLE ${1:table_name} ${2:ADD} PARTITION (${3:part_column}='${4:part_value}');\n$5"]},{label:"alter-table-properties",prefix:"ALTER-TABLE-PROPERTIES",body:["ALTER TABLE ${1:table_name} SET TBLPROPERTIES ('${2:property_name}'='${3:property_value}');\n$4"]},{label:"alter-table-column",prefix:"ALTER-TABLE-COLUMN",body:["ALTER TABLE ${1:table_name} ADD COLUMN ${2:column_name} ${3:STRING} COMMENT '${4:desc}';\n$5"]}],fat=[{label:"select",prefix:"SELECT",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name};\n$4"]},{label:"select-join",prefix:"SELECT-JOIN",body:["SELECT ${8:column1} FROM ${1:table_name} ${2:t1}","${3:LEFT} JOIN ${4:table2} ${5:t2} ON ${2:t1}.${6:column1} = ${5:t2}.${7:column2};\n$9"]},{label:"select-order-by",prefix:"SELECT-ORDER-BY",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name} ORDER BY ${4:column1} ${5:desc};\n$6"]},{label:"insert",prefix:"INSERT-INTO",body:["INSERT INTO ${1:table_name} (${2:column1}, ${3:column2}) VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"replace-into-table",prefix:"REPLACE-INTO-TABLE",body:["REPLACE INTO ${1:table_name} (${2:column1}, ${3:column2})","VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"update",prefix:"UPDATE",body:["UPDATE ${1:table_name}","SET ${2:column1} = ${3:value1}","WHERE ${4:column2} = ${5:value2};\n$6"]},{label:"delete",prefix:"DELETE",body:["DELETE FROM ${1:table_name}","WHERE ${2:column1} = ${3:value1};\n$4"]},{label:"create-table",prefix:"CREATE-TABLE",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT},","	PRIMARY KEY (${2:column1})",")","COMMENT '${6:table_comment}';\n$7"]},{label:"create-table-as-select",prefix:"CREATE-TABLE-AS-SELECT",body:["CREATE TABLE ${1:table_name}","AS","SELECT ${2:column1}, ${3:column2}","FROM ${4:source_table}","WHERE ${5:conditions};\n$6"]},{label:"create-table-partitioned-by-range",prefix:"CREATE-TABLE-PARTITIONED-BY-RANGE",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT},","	PRIMARY KEY (${2:column1})",")","PARTITION BY RANGE (${2:column1}) (","	PARTITION ${6:p0} VALUES LESS THAN ($7)",`);
$8`]},{label:"create-table-partitioned-by-list",prefix:"CREATE-TABLE-PARTITIONED-BY-LIST",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT},","	PRIMARY KEY (${2:column1})",")","PARTITION BY LIST (${2:column1}) (","	PARTITION ${6:p0} VALUES IN ($7)",`);
$8`]},{label:"create-table-partitioned-by-hash",prefix:"CREATE-TABLE-PARTITIONED-BY-HASH",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT},","	PRIMARY KEY (${2:column1})",")","PARTITION BY HASH (${2:column1})","PARTITIONS ${6:4};\n$7"]},{label:"create-table-partitioned-by-key",prefix:"CREATE-TABLE-PARTITIONED-BY-KEY",body:["CREATE TABLE ${1:table_name} (","	${2:column1} ${3:INT},","	${4:column2} ${5:INT},","	PRIMARY KEY (${2:column1})",")","PARTITION BY KEY (${2:column1})","PARTITIONS ${6:4};\n$7"]},{label:"alter-table-add-column",prefix:"ALTER-TABLE-ADD-COLUMN",body:["ALTER TABLE ${1:table_name} ADD ${2:column_name} ${3:INT} COMMENT '${4:desc}';\n$5"]},{label:"alter-table-add-partition",prefix:"ALTER-TABLE-ADD-PARTITION",body:["ALTER TABLE ${1:table_name} ADD PARTITION (","	$2",`);
$4`]},{label:"alter-table-add-index",prefix:"ALTER-TABLE-ADD-INDEX",body:["ALTER TABLE ${1:table_name} ADD INDEX ${2:index_name} (${3:column_name});\n$4"]},{label:"alter-table-add-primary-key",prefix:"ALTER-TABLE-ADD-PRIMARY-KEY",body:["ALTER TABLE ${1:table_name} ADD PRIMARY KEY (${2:column_name});\n$3"]},{label:"alter-table-add-constraint",prefix:"ALTER-TABLE-ADD-CONSTRAINT",body:["ALTER TABLE ${1:table_name}","ADD CONSTRAINT ${2:constraint_name}","FOREIGN KEY (${3:foreign_column}) REFERENCES ${4:ref_table} (${5:ref_column});\n$6"]}],gat=[{label:"select",prefix:"SELECT",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name};\n$4"]},{label:"select-join",prefix:"SELECT-JOIN",body:["SELECT ${8:column1} FROM ${1:table_name} ${2:t1}","${3:LEFT} JOIN ${4:table2} ${5:t2} ON ${2:t1}.${6:column1} = ${5:t2}.${7:column2};\n$9"]},{label:"select-order-by",prefix:"SELECT-ORDER-BY",body:["SELECT ${2:column1}, ${3:column2} FROM ${1:table_name} ORDER BY ${4:column1} ${5:desc};\n$6"]},{label:"insert",prefix:"INSERT-INTO",body:["INSERT INTO ${1:table_name} (${2:column1}, ${3:column2}) VALUES (${4:value1}, ${5:value2});\n$6"]},{label:"insert-into-select",prefix:"INSERT-INTO-SELECT",body:["INSERT INTO ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"insert-overwrite-table",prefix:"INSERT-OVERWRITE-TABLE",body:["INSERT OVERWRITE TABLE ${1:table_name}","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"update",prefix:"UPDATE",body:["UPDATE ${1:table_name}","SET ${2:column1} = ${3:value1}","WHERE ${4:column2} = ${5:value2};\n$6"]},{label:"delete",prefix:"DELETE",body:["DELETE FROM ${1:table_name}","WHERE ${2:column1} = ${3:value1};\n$4"]},{label:"create-table",prefix:"CREATE-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","COMMENT '${6:table_comment}'","STORED AS ${7:PARQUET};\n$8"]},{label:"create-table-as-select",prefix:"CREATE-TABLE-AS-SELECT",body:["CREATE TABLE IF NOT EXISTS ${1:table_name}","AS","SELECT ${3:column1}, ${4:column2}","FROM ${2:source_table}","WHERE ${5:conditions};\n$6"]},{label:"create-partition-table",prefix:"CREATE-PARTITION-TABLE",body:["CREATE TABLE IF NOT EXISTS ${1:table_name} (","	${2:column1} ${3:STRING},","	${4:column2} ${5:STRING}",")","PARTITIONED BY (${6:part_column_name} ${7:STRING})","COMMENT '${8:table_comment}'","STORED AS ${9:PARQUET};\n$10"]},{label:"alter-table-partition",prefix:"ALTER-TABLE-PARTITION",body:["ALTER TABLE ${1:table_name} ${2:ADD} PARTITION (${3:part_column} = '${4:part_value}');\n$5"]},{label:"alter-table-properties",prefix:"ALTER-TABLE-PROPERTIES",body:["ALTER TABLE ${1:table_name} SET TBLPROPERTIES ('${2:property_name}' = '${3:property_value}');\n$4"]},{label:"alter-table-column",prefix:"ALTER-TABLE-COLUMN",body:["ALTER TABLE ${1:table_name} ADD COLUMN ${2:column_name} ${3:STRING} COMMENT '${4:desc}';\n$5"]}];var mat=function(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(s);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(t[i[n]]=s[i[n]]);return t};const bie=new Map,Q3=new Map,J3=new Map,lge=new Map;function vie(s){const e=s.languageId;Qe(()=>import("./q_KzzaYY.js"),[],import.meta.url).then(t=>{var i;Q3.has(e)&&((i=Q3.get(e))===null||i===void 0||i.dispose()),Q3.set(e,t.setupLanguageMode(s))})}function pat(s,e){var t;if(typeof e!="object")return;const{preprocessCode:i}=e,n=mat(e,["preprocessCode"]),o=bat(s,n),r=new rat(s,o,i);lge.set(s,r),bie.get(s)?vie(r):(J3.has(s)&&((t=J3.get(s))===null||t===void 0||t.dispose()),J3.set(s,Xe.onLanguage(s,()=>{vie(r),bie.set(s,!0)})))}function _at(s){switch(s){case Kd.HIVE:return lat;case Kd.FLINK:return cat;case Kd.IMPALA:return gat;case Kd.MYSQL:return fat;case Kd.PG:return hat;case Kd.SPARK:return uat;case Kd.TRINO:return dat;default:return[]}}function bat(s,e){var t,i,n,o,r,a,l,c,d,h,u;const f=lge.get(s),g=typeof e.diagnostics=="boolean"?e.diagnostics:(t=f==null?void 0:f.modeConfiguration.diagnostics)!==null&&t!==void 0?t:uC.diagnostics,m=typeof e.completionItems=="boolean"?e.completionItems:(i=f==null?void 0:f.modeConfiguration.completionItems.enable)!==null&&i!==void 0?i:uC.completionItems.enable,p=typeof e.completionItems!="boolean"&&typeof((n=e.completionItems)===null||n===void 0?void 0:n.completionService)=="function"?(o=e.completionItems)===null||o===void 0?void 0:o.completionService:(r=f==null?void 0:f.modeConfiguration.completionItems.completionService)!==null&&r!==void 0?r:uC.completionItems.completionService,v=typeof e.completionItems!="boolean"&&Array.isArray((a=e.completionItems)===null||a===void 0?void 0:a.triggerCharacters)?e.completionItems.triggerCharacters:(l=f==null?void 0:f.modeConfiguration.completionItems.triggerCharacters)!==null&&l!==void 0?l:uC.completionItems.triggerCharacters,b=typeof e.references=="boolean"?e.references:(c=f==null?void 0:f.modeConfiguration.references)!==null&&c!==void 0?c:uC.references,w=typeof e.definitions=="boolean"?e.definitions:(d=f==null?void 0:f.modeConfiguration.definitions)!==null&&d!==void 0?d:uC.definitions,C=typeof e.completionItems!="boolean"&&Array.isArray((h=e.completionItems)===null||h===void 0?void 0:h.snippets)?e.completionItems.snippets:(u=f==null?void 0:f.modeConfiguration.completionItems.snippets)!==null&&u!==void 0?u:_at(s);return{diagnostics:g,completionItems:{enable:m,completionService:p,triggerCharacters:v,snippets:C},references:b,definitions:w}}let Cie=!1;async function vat(){Cie||(self.MonacoEnvironment={getWorker(s,e){const t=new URL("data:text/javascript;base64,aW1wb3J0IHsgaXNXb3JrZXJJbml0aWFsaXplZCB9IGZyb20gJy4uL2NvbW1vbi9pbml0aWFsaXplLmpzJzsKZXhwb3J0IHsgaW5pdGlhbGl6ZSB9IGZyb20gJy4uL2NvbW1vbi9pbml0aWFsaXplLmpzJzsKaW1wb3J0IHsgc3RhcnQgfSBmcm9tICcuL2VkaXRvci53b3JrZXIuc3RhcnQuanMnOwoKc2VsZi5vbm1lc3NhZ2UgPSAoKSA9PiB7CiAgaWYgKCFpc1dvcmtlckluaXRpYWxpemVkKCkpIHsKICAgIHN0YXJ0KCgpID0+IHsKICAgICAgcmV0dXJuIHt9OwogICAgfSk7CiAgfQp9Owo=",import.meta.url),i=new Worker(t,{type:"module"});return i.onerror=n=>{n.preventDefault(),console.debug("[Monaco] Worker failed to load, some features may be limited")},i}},pat(Kd.PG,{completionItems:{enable:!1}}),Cat(),Cie=!0)}function Cat(){Jw.defineTheme("seaquel-light",{base:"vs",inherit:!0,rules:[{token:"template-variable",foreground:"9333ea",fontStyle:"bold"}],colors:{}}),Jw.defineTheme("seaquel-dark",{base:"vs-dark",inherit:!0,rules:[{token:"template-variable",foreground:"c084fc",fontStyle:"bold"}],colors:{}})}function wie(s,e){var r,a;const t=[],i=/FROM\s+(?:(\w+)\.)?(\w+)(?:\s+(?:AS\s+)?(\w+))?/gi;let n;for(;(n=i.exec(s))!==null;){const l=(r=n[1])==null?void 0:r.toLowerCase(),c=n[2].toLowerCase(),d=n[3],u=d&&!["WHERE","JOIN","LEFT","RIGHT","INNER","OUTER","FULL","CROSS","ON","ORDER","GROUP","HAVING","LIMIT","OFFSET","UNION","INTERSECT","EXCEPT"].includes(d.toUpperCase())?d:void 0,f=e.find(g=>g.name.toLowerCase()===c&&(!l||g.schema.toLowerCase()===l));f&&t.push({table:f,alias:u})}const o=/JOIN\s+(?:(\w+)\.)?(\w+)(?:\s+(?:AS\s+)?(\w+))?/gi;for(;(n=o.exec(s))!==null;){const l=(a=n[1])==null?void 0:a.toLowerCase(),c=n[2].toLowerCase(),d=n[3],u=d&&!["ON","WHERE","AND","OR","LEFT","RIGHT","INNER"].includes(d.toUpperCase())?d:void 0,f=e.find(g=>g.name.toLowerCase()===c&&(!l||g.schema.toLowerCase()===l));f&&!t.some(g=>g.table.name===f.name)&&t.push({table:f,alias:u})}return t}function cge(s){const e=s.toUpperCase(),t=[],i=[[/\bSELECT\b/gi,"select"],[/\bFROM\b/gi,"from"],[/\bWHERE\b/gi,"where"],[/\bON\b/gi,"on"],[/\bORDER\s+BY\b/gi,"order"],[/\bGROUP\s+BY\b/gi,"group"],[/\bHAVING\b/gi,"having"],[/\bSET\b/gi,"set"],[/\bJOIN\b/gi,"from"]];for(const[n,o]of i){let r;for(;(r=n.exec(e))!==null;)t.push({clause:o,pos:r.index})}return t.length===0?"other":(t.sort((n,o)=>o.pos-n.pos),t[0].clause)}function wat(s){const e=cge(s);return["select","where","on","order","group","having","set"].includes(e)}function yat(s){return{triggerCharacters:["."," ",","],provideCompletionItems(e,t){const i=s(),n=e.getWordUntilPosition(t),o={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:n.startColumn,endColumn:n.endColumn},r=e.getValue(),l=e.getLineContent(t.lineNumber).substring(0,t.column-1),c=e.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:t.lineNumber,endColumn:t.column}),d=[],h=l.match(/(\w+)\.\s*$/);if(h){const b=h[1].toLowerCase(),C=wie(r,i).find(x=>{var S;return x.table.name.toLowerCase()===b||((S=x.alias)==null?void 0:S.toLowerCase())===b}),y=(C==null?void 0:C.table)??i.find(x=>x.name.toLowerCase()===b);if(y)return y.columns.forEach(x=>{const S=[];x.isPrimaryKey&&S.push("PK"),x.isForeignKey&&S.push("FK"),x.nullable||S.push("NOT NULL"),d.push({label:x.name,kind:Xe.CompletionItemKind.Field,detail:`${x.type}${S.length?` (${S.join(", ")})`:""}`,insertText:x.name,range:o})}),{suggestions:d}}const u=wie(r,i);if(u.length>0&&wat(c))return d.push({label:"*",kind:Xe.CompletionItemKind.Constant,detail:"Select all columns",insertText:"*",range:o,sortText:"!0"}),u.forEach(b=>{const w=b.alias??b.table.name,C=u.length>1;b.table.columns.forEach((y,x)=>{const S=[];y.isPrimaryKey&&S.push("PK"),y.isForeignKey&&S.push("FK"),y.nullable||S.push("NOT NULL");const L=C?`${w}.${y.name}`:y.name;d.push({label:L,kind:Xe.CompletionItemKind.Field,detail:`${b.table.name}.${y.name} (${y.type}${S.length?`, ${S.join(", ")}`:""})`,insertText:L,range:o,sortText:`!1${String(x).padStart(3,"0")}`})})}),{suggestions:d};const f=cge(c);return[...new Set(i.map(b=>b.schema))].sort().forEach((b,w)=>{d.push({label:b,kind:Xe.CompletionItemKind.Folder,detail:"schema",insertText:b,range:o,sortText:`0-schema-${String(w).padStart(3,"0")}`})}),[...i].sort((b,w)=>b.name.localeCompare(w.name)).forEach((b,w)=>{d.push({label:b.name,kind:b.type==="view"?Xe.CompletionItemKind.Interface:Xe.CompletionItemKind.Struct,detail:`${b.schema}.${b.name} (${b.type})`,insertText:b.name,range:o,sortText:`1-table-${String(w).padStart(3,"0")}`}),d.push({label:`${b.schema}.${b.name}`,kind:b.type==="view"?Xe.CompletionItemKind.Interface:Xe.CompletionItemKind.Struct,detail:b.columns.length?`${b.columns.length} columns`:"",insertText:`${b.schema}.${b.name}`,range:o,sortText:`1-table-${String(w).padStart(3,"0")}-qualified`})}),f==="from"?{suggestions:d}:(["SELECT","FROM","WHERE","JOIN","LEFT JOIN","RIGHT JOIN","INNER JOIN","FULL OUTER JOIN","CROSS JOIN","ON","AND","OR","NOT","IN","LIKE","ILIKE","ORDER BY","GROUP BY","HAVING","LIMIT","OFFSET","INSERT INTO","UPDATE","DELETE FROM","VALUES","SET","CREATE TABLE","ALTER TABLE","DROP TABLE","AS","DISTINCT","COUNT","SUM","AVG","MIN","MAX","CASE","WHEN","THEN","ELSE","END","NULL","IS NULL","IS NOT NULL","BETWEEN","EXISTS","UNION","UNION ALL","INTERSECT","EXCEPT","WITH","RETURNING","COALESCE","NULLIF","CAST","ASC","DESC"].forEach(b=>{d.push({label:b,kind:Xe.CompletionItemKind.Keyword,insertText:b,range:o})}),["integer","bigint","smallint","serial","bigserial","text","varchar","char","boolean","date","timestamp","timestamptz","time","timetz","interval","uuid","json","jsonb","numeric","decimal","real","double precision","bytea","inet","cidr","macaddr"].forEach(b=>{d.push({label:b,kind:Xe.CompletionItemKind.TypeParameter,insertText:b,range:o})}),{suggestions:d})}}}var Sat=Re("<div></div>");function qft(s,e){Lt(e,!0);let t=Ae(e,"value",15,""),i=Ae(e,"ref",15,null),n=Ae(e,"schema",19,()=>[]),o=Ae(e,"onExecute",3,()=>{}),r=Ae(e,"onToggleSidebar",3,()=>{}),a=Ae(e,"onChange",3,v=>{}),l=Ae(e,"class",3,""),c,d=null,h=null,u=!1;const f=X(()=>AK.current==="dark"?"seaquel-dark":"seaquel-light");let g=null;function m(){if(!d)return;const v=d.getModel();if(!v)return;const b=v.getValue(),w=[],C=/\{\{([a-zA-Z_][a-zA-Z0-9_]*)\}\}/g;let y;for(;(y=C.exec(b))!==null;){const x=v.getPositionAt(y.index),S=v.getPositionAt(y.index+y[0].length);w.push({range:new Mfe(x.lineNumber,x.column,S.lineNumber,S.column),options:{inlineClassName:"template-variable-decoration"}})}g?g.set(w):g=d.createDecorationsCollection(w)}Wz(async()=>{await vat(),d=Jw.create(c,{value:t(),language:"pgsql",theme:I(f),automaticLayout:!0,minimap:{enabled:!1},fontSize:13,fontFamily:"ui-monospace, monospace",lineNumbers:"on",scrollBeyondLastLine:!1,wordWrap:"on",tabSize:2,padding:{top:8,bottom:8},scrollbar:{verticalScrollbarSize:10,horizontalScrollbarSize:10}}),h=Xe.registerCompletionItemProvider("pgsql",yat(()=>n())),d.onDidChangeModelContent(()=>{if(!u&&d){const v=d.getValue();t(v),a()(v)}m()}),m(),d.addCommand(Dz.CtrlCmd|kz.Enter,()=>{o()()}),d.addCommand(Dz.CtrlCmd|kz.KeyB,()=>{r()()}),i({getCursorOffset:()=>{var b;if(!d)return 0;const v=d.getPosition();return v?((b=d.getModel())==null?void 0:b.getOffsetAt(v))??0:0}})}),ty(()=>{h==null||h.dispose(),d==null||d.dispose()}),Br(()=>{const v=t();d&&d.getValue()!==v&&(u=!0,d.setValue(v),u=!1,m())}),Br(()=>{const v=AK.current==="dark"?"seaquel-dark":"seaquel-light";d&&Jw.setTheme(v)});var p=Sat();If(p,v=>c=v,()=>c),ze(v=>Qn(p,1,v),[()=>jo(["h-full w-full",l()].filter(Boolean).join(" "))]),Q(s,p),It()}const xat=new Vge.Parser;function jft(s,e){var t,i,n,o,r,a,l,c,d,h,u,f,g,m,p;if(!s.trim())return{tables:[],joins:[],filters:[],groupBy:[],having:[],orderBy:[],limit:null,selectAggregates:[],columnAggregates:[],subqueries:[],ctes:[]};try{const v=xat.astify(s,{database:"PostgreSQL"}),b=Array.isArray(v)?v[0]:v;if(!b||b.type!=="select")return null;const w=(e==null?void 0:e.validTableNames)===null?null:(e==null?void 0:e.validTableNames)??ise(),C=[],y=[],x=[],S=[],L=new Map,E=[],M=[],R=new Set,T=b;if(T.with&&Array.isArray(T.with))for(const V of T.with){const U=(t=V.name)==null?void 0:t.value;if(U&&V.stmt){const $=nE(V.stmt,void 0,w);$&&(M.push({id:`cte-${M.length}`,name:U,innerQuery:$}),R.add(U),L.set(U,U))}}if(b.from&&Array.isArray(b.from))for(const V of b.from){const U=V;if((i=U.expr)!=null&&i.ast){const $=nE(U.expr.ast,R,w);if($){const Y=E.length;E.push({id:`subquery-${Y}`,role:"from",innerQuery:$}),U.as&&L.set(U.as,U.as)}continue}if("table"in V&&V.table){const $=V.table;if(w!==null&&!w.includes($)&&!R.has($))continue;const Y=V.as||null;if(Y&&L.set(Y,$),L.set($,$),"join"in V&&V.join){const se=dge(V.join);if(V.on){const j=hge(V.on,L);j&&y.push({...j,joinType:se,targetTable:$})}C.push({tableName:$,alias:Y,selectedColumns:[]})}else C.push({tableName:$,alias:Y,selectedColumns:[]})}}if(b.columns&&Array.isArray(b.columns)){for(const V of b.columns)if(V==="*")for(const U of C){const $=pg(U.tableName);$&&(U.selectedColumns=$.columns.map(Y=>Y.name))}else if(V.expr){const U=V.expr;if(U.type==="star"&&U.table){const $=Va(U.table,L),Y=C.find(se=>se.tableName===$);if(Y){const se=pg($);se&&(Y.selectedColumns=se.columns.map(j=>j.name))}}else if(U.type==="column_ref"&&U.column==="*")if(U.table){const $=Va(U.table,L),Y=C.find(se=>se.tableName===$);if(Y){const se=pg($);se&&(Y.selectedColumns=se.columns.map(j=>j.name))}}else for(const $ of C){const Y=pg($.tableName);Y?$.selectedColumns=Y.columns.map(se=>se.name):R.has($.tableName)&&($.selectedColumns=["*"])}else if(U.type==="column_ref"){const $=typeof U.column=="string"?U.column:(o=(n=U.column)==null?void 0:n.expr)==null?void 0:o.value;if($){let Y;if(U.table){const se=Va(U.table,L);Y=C.find(j=>j.tableName===se)}else Y=Vu(C,$);Y&&!Y.selectedColumns.includes($)&&Y.selectedColumns.push($)}}else if(U.type==="aggr_func"&&U.name){const $=U.name.toUpperCase();if(oK($)){const Y=V.as||void 0,se=U.args;if(se!=null&&se.expr)if(se.expr.type==="star")x.push({function:$,expression:"*",alias:Y});else if(se.expr.type==="column_ref"){const j=typeof se.expr.column=="string"?se.expr.column:(a=(r=se.expr.column)==null?void 0:r.expr)==null?void 0:a.value;if(j){const ie=se.expr.table?Va(se.expr.table,L):(l=Vu(C,j))==null?void 0:l.tableName;if(ie){S.push({tableName:ie,column:j,function:$,alias:Y});const te=C.find(pe=>pe.tableName===ie);te&&!te.selectedColumns.includes(j)&&te.selectedColumns.push(j)}}}else x.push({function:$,expression:"*",alias:Y})}}}}const A=b.where?uge(b.where,L,C,E,R,w):[],N=[],P=(c=b.groupby)==null?void 0:c.columns;if(P&&Array.isArray(P)){for(const V of P)if(V.type==="column_ref"){const U=typeof V.column=="string"?V.column:(h=(d=V.column)==null?void 0:d.expr)==null?void 0:h.value,$=typeof U=="string"?U:void 0;if($){let Y;if(V.table)Y=`${Va(V.table,L)}.${$}`;else{const se=Vu(C,$);Y=se?`${se.tableName}.${$}`:$}N.push({column:Y})}}}const W=[];b.having&&iA(b.having,W,"AND",E,R,w);const H=[];if(b.orderby&&Array.isArray(b.orderby)){for(const V of b.orderby)if(((u=V.expr)==null?void 0:u.type)==="column_ref"){const U=typeof V.expr.column=="string"?V.expr.column:(g=(f=V.expr.column)==null?void 0:f.expr)==null?void 0:g.value;if(U){let $;if(V.expr.table)$=`${Va(V.expr.table,L)}.${U}`;else{const Y=Vu(C,U);$=Y?`${Y.tableName}.${U}`:U}H.push({column:$,direction:((m=V.type)==null?void 0:m.toUpperCase())||"ASC"})}}}let G=null;if((p=b.limit)!=null&&p.value&&Array.isArray(b.limit.value)&&b.limit.value.length>0){const V=b.limit.value[0];V.type==="number"&&typeof V.value=="number"&&(G=V.value)}return{tables:C,joins:y,filters:A,groupBy:N,having:W,orderBy:H,limit:G,selectAggregates:x,columnAggregates:S,subqueries:E,ctes:M}}catch{return null}}function dge(s){const e=s.toUpperCase();return e.includes("LEFT")?"LEFT":e.includes("RIGHT")?"RIGHT":e.includes("FULL")?"FULL":"INNER"}function Va(s,e){if(typeof s=="object"&&s!==null){const t=s.value||"";return e.get(t)||t}return e.get(s||"")||s||""}function Vu(s,e){for(const t of s){const i=pg(t.tableName);if(i!=null&&i.columns.some(n=>n.name===e))return t}return s[0]}function hge(s,e){var c,d,h,u;const t=s;if(t.type!=="binary_expr"||t.operator!=="=")return null;const i=t.left,n=t.right;if((i==null?void 0:i.type)!=="column_ref"||(n==null?void 0:n.type)!=="column_ref")return null;const o=i.table?Va(i.table,e):null,r=n.table?Va(n.table,e):null,a=typeof i.column=="string"?i.column:(d=(c=i.column)==null?void 0:c.expr)==null?void 0:d.value,l=typeof n.column=="string"?n.column:(u=(h=n.column)==null?void 0:h.expr)==null?void 0:u.value;return!o||!r||!a||!l?null:{sourceTable:o,sourceColumn:a,targetColumn:l}}function uge(s,e,t,i,n,o){const r=[];return Rz(s,e,t,r,i,"AND",n,o),r}function Rz(s,e,t,i,n,o,r,a){var c,d,h,u;const l=s;if(!(!l||typeof l!="object")){if(l.type==="binary_expr"&&(l.operator==="AND"||l.operator==="OR")){Rz(l.left,e,t,i,n,o,r,a),Rz(l.right,e,t,i,n,l.operator,r,a);return}if(l.type==="binary_expr"){const f=l.left,g=l.right;if((f==null?void 0:f.type)==="column_ref"){const m=typeof f.column=="string"?f.column:(d=(c=f.column)==null?void 0:c.expr)==null?void 0:d.value;if(m){let p;if(f.table)p=`${Va(f.table,e)}.${m}`;else{const C=Vu(t,m);p=C?`${C.tableName}.${m}`:m}const v=Lat(l.operator),b=g;let w=null;if((g==null?void 0:g.type)==="select"?w=g:g!=null&&g.ast?w=g.ast:(b==null?void 0:b.type)==="expr_list"&&((u=(h=b.value)==null?void 0:h[0])!=null&&u.ast)&&(w=b.value[0].ast),w){const C=nE(w,r,a);if(C&&v){const y=n.length;n.push({id:`subquery-${y}`,role:"where",linkedFilterIndex:i.length,innerQuery:C}),i.push({column:p,operator:v,value:"",connector:o,subqueryIndex:y})}}else{const C=fge(g);v&&C!==null&&i.push({column:p,operator:v,value:C,connector:o})}}}}l.type==="unary_expr"||l.type==="binary_expr"&&l.operator}}function nE(s,e,t){var p,v,b,w,C,y,x,S,L,E,M,R,T,A,N,P,W,H,G,V;const i=s;if(!i||i.type!=="select")return null;const n=t===void 0?ise():t,o=[],r=[],a=[],l=[],c=new Map,d=[];if(i.from&&Array.isArray(i.from))for(const U of i.from){const $=U;if((p=$.expr)!=null&&p.ast){const Y=nE($.expr.ast,e,n);if(Y){const se=d.length;d.push({id:`subquery-${se}`,role:"from",innerQuery:Y}),$.as&&c.set($.as,$.as)}continue}if($.table){const Y=$.table;if(n!==null&&!n.includes(Y)&&!(e!=null&&e.has(Y)))continue;const se=$.as||null;if(se&&c.set(se,Y),c.set(Y,Y),$.join){const j=dge($.join);if($.on){const ie=hge($.on,c);ie&&r.push({...ie,joinType:j,targetTable:Y})}}o.push({tableName:Y,alias:se,selectedColumns:[],isCteReference:e==null?void 0:e.has(Y)})}}if(i.columns&&Array.isArray(i.columns))for(const U of i.columns)if(U==="*")for(const $ of o){const Y=pg($.tableName);Y&&($.selectedColumns=Y.columns.map(se=>se.name))}else{const $=U;if(((v=$.expr)==null?void 0:v.type)==="column_ref"&&$.expr.column==="*")if($.expr.table){const Y=Va($.expr.table,c),se=o.find(j=>j.tableName===Y);if(se){const j=pg(Y);j&&(se.selectedColumns=j.columns.map(ie=>ie.name))}}else for(const Y of o){const se=pg(Y.tableName);se&&(Y.selectedColumns=se.columns.map(j=>j.name))}else if(((b=$.expr)==null?void 0:b.type)==="column_ref"){const Y=typeof $.expr.column=="string"?$.expr.column:(C=(w=$.expr.column)==null?void 0:w.expr)==null?void 0:C.value;if(Y&&Y!=="*"){const se=$.expr.table?Va($.expr.table,c):(y=Vu(o,Y))==null?void 0:y.tableName,j=o.find(ie=>ie.tableName===se);j&&!j.selectedColumns.includes(Y)&&j.selectedColumns.push(Y)}}else if(((x=$.expr)==null?void 0:x.type)==="aggr_func"&&$.expr.name){const Y=$.expr.name.toUpperCase();if(oK(Y)){const se=$.as||void 0,j=$.expr.args;if(j!=null&&j.expr)if(j.expr.type==="star")a.push({function:Y,expression:"*",alias:se});else if(j.expr.type==="column_ref"){const ie=typeof j.expr.column=="string"?j.expr.column:(L=(S=j.expr.column)==null?void 0:S.expr)==null?void 0:L.value;if(ie){const te=j.expr.table?Va(j.expr.table,c):(E=Vu(o,ie))==null?void 0:E.tableName;if(te){l.push({tableName:te,column:ie,function:Y,alias:se});const pe=o.find(J=>J.tableName===te);pe&&!pe.selectedColumns.includes(ie)&&pe.selectedColumns.push(ie)}}}else a.push({function:Y,expression:"*",alias:se})}}}const h=i.where?uge(i.where,c,o,d,e,n):[],u=[];if((M=i.groupby)!=null&&M.columns&&Array.isArray(i.groupby.columns))for(const U of i.groupby.columns){const $=U;if($.type==="column_ref"){const Y=typeof $.column=="string"?$.column:(T=(R=$.column)==null?void 0:R.expr)==null?void 0:T.value;if(Y){const se=$.table?Va($.table,c):(A=Vu(o,Y))==null?void 0:A.tableName,j=se?`${se}.${Y}`:Y;u.push({column:j})}}}const f=[];i.having&&iA(i.having,f,"AND",d,e,n);const g=[];if(i.orderby&&Array.isArray(i.orderby))for(const U of i.orderby){const $=U;if(((N=$.expr)==null?void 0:N.type)==="column_ref"){const Y=typeof $.expr.column=="string"?$.expr.column:(W=(P=$.expr.column)==null?void 0:P.expr)==null?void 0:W.value;if(Y){const se=$.expr.table?Va($.expr.table,c):(H=Vu(o,Y))==null?void 0:H.tableName,j=se?`${se}.${Y}`:Y;g.push({column:j,direction:((G=$.type)==null?void 0:G.toUpperCase())||"ASC"})}}}let m=null;if((V=i.limit)!=null&&V.value&&Array.isArray(i.limit.value)&&i.limit.value.length>0){const U=i.limit.value[0];U.type==="number"&&typeof U.value=="number"&&(m=U.value)}return{tables:o,joins:r,filters:h,groupBy:u,having:f,orderBy:g,limit:m,selectAggregates:a,columnAggregates:l,subqueries:d}}function Lat(s){return s&&{"=":"=","!=":"!=","<>":"!=",">":">","<":"<",">=":">=","<=":"<=",LIKE:"LIKE","NOT LIKE":"NOT LIKE",IN:"IN","NOT IN":"NOT IN",BETWEEN:"BETWEEN"}[s.toUpperCase()]||null}function fge(s){return s&&(s.type==="number"||s.type==="string"||s.type==="single_quote_string"||s.type==="double_quote_string")?String(s.value):null}function iA(s,e,t,i,n,o){var a,l,c,d;const r=s;if(!(!r||typeof r!="object")){if(r.type==="binary_expr"&&(r.operator==="AND"||r.operator==="OR")){iA(r.left,e,t,i,n,o),iA(r.right,e,r.operator,i,n,o);return}if(r.type==="binary_expr"){const h=r.left,u=r.right;if((h==null?void 0:h.type)==="aggr_func"&&h.name){const f=h.name.toUpperCase();if(oK(f)){const g=Iat(r.operator),m=u;if(m!=null&&m.ast&&i){const v=nE(m.ast,n,o);if(v&&g){const b=i.length;i.push({id:`subquery-${b}`,role:"where",innerQuery:v});let w="";const C=h.args;C!=null&&C.expr&&(C.expr.type==="star"?w="":C.expr.type==="column_ref"&&(w=typeof C.expr.column=="string"?C.expr.column:((l=(a=C.expr.column)==null?void 0:a.expr)==null?void 0:l.value)||"")),e.push({aggregateFunction:f,column:w,operator:g,value:"(subquery)",connector:t})}return}const p=fge(u);if(g&&p!==null){let v="";const b=h.args;b!=null&&b.expr&&(b.expr.type==="star"?v="":b.expr.type==="column_ref"&&(v=typeof b.expr.column=="string"?b.expr.column:((d=(c=b.expr.column)==null?void 0:c.expr)==null?void 0:d.value)||"")),e.push({aggregateFunction:f,column:v,operator:g,value:p,connector:t})}}}}}}function oK(s){return["COUNT","SUM","AVG","MIN","MAX"].includes(s)}function Iat(s){return s&&{"=":"=","!=":"!=","<>":"!=",">":">","<":"<",">=":">=","<=":"<="}[s.toUpperCase()]||null}let Px=null,Ox=null,nA=null;function Kft(){return[{name:"categories",schema:"main",type:"table",columns:[{name:"id",type:"INTEGER",nullable:!1,isPrimaryKey:!0,isForeignKey:!1},{name:"name",type:"TEXT",nullable:!1,isPrimaryKey:!1,isForeignKey:!1},{name:"description",type:"TEXT",nullable:!0,isPrimaryKey:!1,isForeignKey:!1}],indexes:[]},{name:"products",schema:"main",type:"table",columns:[{name:"id",type:"INTEGER",nullable:!1,isPrimaryKey:!0,isForeignKey:!1},{name:"name",type:"TEXT",nullable:!1,isPrimaryKey:!1,isForeignKey:!1},{name:"description",type:"TEXT",nullable:!0,isPrimaryKey:!1,isForeignKey:!1},{name:"price",type:"DECIMAL(10,2)",nullable:!1,isPrimaryKey:!1,isForeignKey:!1},{name:"stock",type:"INTEGER",nullable:!0,defaultValue:"0",isPrimaryKey:!1,isForeignKey:!1},{name:"category_id",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!0,foreignKeyRef:{referencedSchema:"main",referencedTable:"categories",referencedColumn:"id"}},{name:"created_at",type:"DATETIME",nullable:!0,defaultValue:"CURRENT_TIMESTAMP",isPrimaryKey:!1,isForeignKey:!1}],indexes:[]},{name:"customers",schema:"main",type:"table",columns:[{name:"id",type:"INTEGER",nullable:!1,isPrimaryKey:!0,isForeignKey:!1},{name:"name",type:"TEXT",nullable:!1,isPrimaryKey:!1,isForeignKey:!1},{name:"email",type:"TEXT",nullable:!1,isPrimaryKey:!1,isForeignKey:!1},{name:"country",type:"TEXT",nullable:!0,isPrimaryKey:!1,isForeignKey:!1},{name:"created_at",type:"DATETIME",nullable:!0,defaultValue:"CURRENT_TIMESTAMP",isPrimaryKey:!1,isForeignKey:!1}],indexes:[]},{name:"orders",schema:"main",type:"table",columns:[{name:"id",type:"INTEGER",nullable:!1,isPrimaryKey:!0,isForeignKey:!1},{name:"customer_id",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!0,foreignKeyRef:{referencedSchema:"main",referencedTable:"customers",referencedColumn:"id"}},{name:"status",type:"TEXT",nullable:!0,defaultValue:"'pending'",isPrimaryKey:!1,isForeignKey:!1},{name:"total",type:"DECIMAL(10,2)",nullable:!0,isPrimaryKey:!1,isForeignKey:!1},{name:"created_at",type:"DATETIME",nullable:!0,defaultValue:"CURRENT_TIMESTAMP",isPrimaryKey:!1,isForeignKey:!1}],indexes:[]},{name:"order_items",schema:"main",type:"table",columns:[{name:"id",type:"INTEGER",nullable:!1,isPrimaryKey:!0,isForeignKey:!1},{name:"order_id",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!0,foreignKeyRef:{referencedSchema:"main",referencedTable:"orders",referencedColumn:"id"}},{name:"product_id",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!0,foreignKeyRef:{referencedSchema:"main",referencedTable:"products",referencedColumn:"id"}},{name:"quantity",type:"INTEGER",nullable:!1,isPrimaryKey:!1,isForeignKey:!1},{name:"unit_price",type:"DECIMAL(10,2)",nullable:!1,isPrimaryKey:!1,isForeignKey:!1}],indexes:[]},{name:"reviews",schema:"main",type:"table",columns:[{name:"id",type:"INTEGER",nullable:!1,isPrimaryKey:!0,isForeignKey:!1},{name:"product_id",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!0,foreignKeyRef:{referencedSchema:"main",referencedTable:"products",referencedColumn:"id"}},{name:"customer_id",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!0,foreignKeyRef:{referencedSchema:"main",referencedTable:"customers",referencedColumn:"id"}},{name:"rating",type:"INTEGER",nullable:!0,isPrimaryKey:!1,isForeignKey:!1},{name:"comment",type:"TEXT",nullable:!0,isPrimaryKey:!1,isForeignKey:!1},{name:"created_at",type:"DATETIME",nullable:!0,defaultValue:"CURRENT_TIMESTAMP",isPrimaryKey:!1,isForeignKey:!1}],indexes:[]}]}async function Eat(){if(!(Ox||nA))if(Aie()){const e=await(await Qe(async()=>{const{default:t}=await import("./BrUSJa21.js");return{default:t}},__vite__mapDeps([6,7]),import.meta.url)).default.load("sqlite::memory:");nA=e,await kat(e)}else Px=await zge(),Ox=await Px.connect({type:"duckdb",databaseName:":memory:"}),await Dat(Px,Ox)}async function kat(s){await gge(e=>s.execute(e))}async function Dat(s,e){await gge(t=>s.execute(e,t))}async function gge(s){await s(`
    CREATE TABLE IF NOT EXISTS categories (
      id INTEGER PRIMARY KEY,
      name TEXT NOT NULL,
      description TEXT
    )
  `),await s(`
    CREATE TABLE IF NOT EXISTS products (
      id INTEGER PRIMARY KEY,
      name TEXT NOT NULL,
      description TEXT,
      price DECIMAL(10,2) NOT NULL,
      stock INTEGER DEFAULT 0,
      category_id INTEGER,
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )
  `),await s(`
    CREATE TABLE IF NOT EXISTS customers (
      id INTEGER PRIMARY KEY,
      name TEXT NOT NULL,
      email TEXT NOT NULL,
      country TEXT,
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )
  `),await s(`
    CREATE TABLE IF NOT EXISTS orders (
      id INTEGER PRIMARY KEY,
      customer_id INTEGER,
      status TEXT DEFAULT 'pending',
      total DECIMAL(10,2),
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )
  `),await s(`
    CREATE TABLE IF NOT EXISTS order_items (
      id INTEGER PRIMARY KEY,
      order_id INTEGER,
      product_id INTEGER,
      quantity INTEGER NOT NULL,
      unit_price DECIMAL(10,2) NOT NULL
    )
  `),await s(`
    CREATE TABLE IF NOT EXISTS reviews (
      id INTEGER PRIMARY KEY,
      product_id INTEGER,
      customer_id INTEGER,
      rating INTEGER,
      comment TEXT,
      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    )
  `),await s("INSERT INTO categories (id, name, description) VALUES (1, 'Electronics', 'Phones, laptops, and gadgets')"),await s("INSERT INTO categories (id, name, description) VALUES (2, 'Clothing', 'Apparel and accessories')"),await s("INSERT INTO categories (id, name, description) VALUES (3, 'Books', 'Fiction and non-fiction')"),await s("INSERT INTO categories (id, name, description) VALUES (4, 'Home', 'Furniture and decor')"),await s("INSERT INTO categories (id, name, description) VALUES (5, 'Sports', 'Equipment and gear')"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (1, 'Smartphone X', 'Latest smartphone with 5G', 799.99, 50, 1)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (2, 'Laptop Pro', '15-inch professional laptop', 1299.99, 30, 1)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (3, 'Wireless Earbuds', 'Noise-canceling earbuds', 149.99, 100, 1)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (4, 'Cotton T-Shirt', 'Classic fit cotton tee', 24.99, 200, 2)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (5, 'Denim Jeans', 'Slim fit blue jeans', 59.99, 100, 2)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (6, 'The Great Novel', 'Bestselling fiction', 14.99, 200, 3)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (7, 'Learn SQL', 'Database fundamentals', 39.99, 100, 3)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (8, 'Coffee Table', 'Modern wooden table', 199.99, 20, 4)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (9, 'Yoga Mat', 'Non-slip exercise mat', 29.99, 100, 5)"),await s("INSERT INTO products (id, name, description, price, stock, category_id) VALUES (10, 'Dumbbells', '10lb dumbbell pair', 49.99, 50, 5)"),await s("INSERT INTO customers (id, name, email, country) VALUES (1, 'Alice Johnson', 'alice@email.com', 'USA')"),await s("INSERT INTO customers (id, name, email, country) VALUES (2, 'Bob Smith', 'bob@email.com', 'USA')"),await s("INSERT INTO customers (id, name, email, country) VALUES (3, 'Carol White', 'carol@email.com', 'Canada')"),await s("INSERT INTO customers (id, name, email, country) VALUES (4, 'David Brown', 'david@email.com', 'UK')"),await s("INSERT INTO customers (id, name, email, country) VALUES (5, 'Emma Davis', 'emma@email.com', 'Australia')"),await s("INSERT INTO orders (id, customer_id, status, total) VALUES (1, 1, 'delivered', 849.98)"),await s("INSERT INTO orders (id, customer_id, status, total) VALUES (2, 1, 'shipped', 24.99)"),await s("INSERT INTO orders (id, customer_id, status, total) VALUES (3, 2, 'pending', 1349.98)"),await s("INSERT INTO orders (id, customer_id, status, total) VALUES (4, 3, 'delivered', 89.98)"),await s("INSERT INTO orders (id, customer_id, status, total) VALUES (5, 4, 'cancelled', 199.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (1, 1, 1, 1, 799.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (2, 1, 3, 1, 49.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (3, 2, 4, 1, 24.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (4, 3, 2, 1, 1299.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (5, 3, 10, 1, 49.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (6, 4, 5, 1, 59.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (7, 4, 9, 1, 29.99)"),await s("INSERT INTO order_items (id, order_id, product_id, quantity, unit_price) VALUES (8, 5, 8, 1, 199.99)"),await s("INSERT INTO reviews (id, product_id, customer_id, rating, comment) VALUES (1, 1, 1, 5, 'Excellent phone!')"),await s("INSERT INTO reviews (id, product_id, customer_id, rating, comment) VALUES (2, 2, 2, 4, 'Great laptop, a bit pricey')"),await s("INSERT INTO reviews (id, product_id, customer_id, rating, comment) VALUES (3, 4, 3, 5, 'Very comfortable')"),await s("INSERT INTO reviews (id, product_id, customer_id, rating, comment) VALUES (4, 6, 4, 3, 'Good read')"),await s("INSERT INTO reviews (id, product_id, customer_id, rating, comment) VALUES (5, 9, 5, 5, 'Perfect for yoga')")}async function Gft(s){if(await Eat(),Aie()&&nA)return nA.select(s);if(Px&&Ox)return Px.select(Ox,s);throw new Error("Tutorial database not initialized")}function Tat(s){return typeof s=="function"}function rK(s){return s!==null&&typeof s=="object"}const Nat=["string","number","bigint","boolean"];function Mz(s){return s==null||Nat.includes(typeof s)?!0:Array.isArray(s)?s.every(e=>Mz(e)):typeof s=="object"?Object.getPrototypeOf(s)===Object.prototype:!1}const sE=Symbol("box"),aK=Symbol("is-writable");function Rat(s){return rK(s)&&sE in s}function Mat(s){return zi.isBox(s)&&aK in s}function zi(s){let e=At(Dr(s));return{[sE]:!0,[aK]:!0,get current(){return I(e)},set current(t){Le(e,t,!0)}}}function Aat(s,e){const t=X(s);return e?{[sE]:!0,[aK]:!0,get current(){return I(t)},set current(i){e(i)}}:{[sE]:!0,get current(){return s()}}}function Pat(s){return zi.isBox(s)?s:Tat(s)?zi.with(s):zi(s)}function Oat(s){return Object.entries(s).reduce((e,[t,i])=>zi.isBox(i)?(zi.isWritableBox(i)?Object.defineProperty(e,t,{get(){return i.current},set(n){i.current=n}}):Object.defineProperty(e,t,{get(){return i.current}}),e):Object.assign(e,{[t]:i}),{})}function Fat(s){return zi.isWritableBox(s)?{[sE]:!0,get current(){return s.current}}:s}zi.from=Pat;zi.with=Aat;zi.flatten=Oat;zi.readonly=Fat;zi.isBox=Rat;zi.isWritableBox=Mat;function Bat(...s){return function(e){var t;for(const i of s)if(i){if(e.defaultPrevented)return;typeof i=="function"?i.call(this,e):(t=i.current)==null||t.call(this,e)}}}const Wat=/\d/,Hat=["-","_","/","."];function Vat(s=""){if(!Wat.test(s))return s!==s.toLowerCase()}function zat(s){const e=[];let t="",i,n;for(const o of s){const r=Hat.includes(o);if(r===!0){e.push(t),t="",i=void 0;continue}const a=Vat(o);if(n===!1){if(i===!1&&a===!0){e.push(t),t=o,i=a;continue}if(i===!0&&a===!1&&t.length>1){const l=t.at(-1);e.push(t.slice(0,Math.max(0,t.length-1))),t=l+o,i=a;continue}}t+=o,i=a,n=r}return e.push(t),e}function mge(s){return s?zat(s).map(e=>$at(e)).join(""):""}function Uat(s){return qat(mge(s||""))}function $at(s){return s?s[0].toUpperCase()+s.slice(1):""}function qat(s){return s?s[0].toLowerCase()+s.slice(1):""}function kT(s){if(!s)return{};const e={};function t(i,n){if(i.startsWith("-moz-")||i.startsWith("-webkit-")||i.startsWith("-ms-")||i.startsWith("-o-")){e[mge(i)]=n;return}if(i.startsWith("--")){e[i]=n;return}e[Uat(i)]=n}return Fge(s,t),e}function pge(...s){return(...e)=>{for(const t of s)typeof t=="function"&&t(...e)}}function jat(s,e,t,i){const n=Array.isArray(e)?e:[e];return n.forEach(o=>s.addEventListener(o,t,i)),()=>{n.forEach(o=>s.removeEventListener(o,t,i))}}function Kat(s,e){const t=RegExp(s,"g");return i=>{if(typeof i!="string")throw new TypeError(`expected an argument of type string, but got ${typeof i}`);return i.match(t)?i.replace(t,e):i}}const Gat=Kat(/[A-Z]/,s=>`-${s.toLowerCase()}`);function Yat(s){if(!s||typeof s!="object"||Array.isArray(s))throw new TypeError(`expected an argument of type object, but got ${typeof s}`);return Object.keys(s).map(e=>`${Gat(e)}: ${s[e]};`).join(`
`)}function _ge(s={}){return Yat(s).replace(`
`," ")}const Xat={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",transform:"translateX(-100%)"};_ge(Xat);const Zat=["onabort","onanimationcancel","onanimationend","onanimationiteration","onanimationstart","onauxclick","onbeforeinput","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncompositionend","oncompositionstart","oncompositionupdate","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onfocusin","onfocusout","onformdata","ongotpointercapture","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onlostpointercapture","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onpaste","onpause","onplay","onplaying","onpointercancel","onpointerdown","onpointerenter","onpointerleave","onpointermove","onpointerout","onpointerover","onpointerup","onprogress","onratechange","onreset","onresize","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onselectionchange","onselectstart","onslotchange","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ontransitioncancel","ontransitionend","ontransitionrun","ontransitionstart","onvolumechange","onwaiting","onwebkitanimationend","onwebkitanimationiteration","onwebkitanimationstart","onwebkittransitionend","onwheel"],Qat=new Set(Zat);function Jat(s){return Qat.has(s)}function lK(...s){const e={...s[0]};for(let t=1;t<s.length;t++){const i=s[t];if(i){for(const n of Object.keys(i)){const o=e[n],r=i[n],a=typeof o=="function",l=typeof r=="function";if(a&&Jat(n)){const c=o,d=r;e[n]=Bat(c,d)}else if(a&&l)e[n]=pge(o,r);else if(n==="class"){const c=Mz(o),d=Mz(r);c&&d?e[n]=r5(o,r):c?e[n]=r5(o):d&&(e[n]=r5(r))}else if(n==="style"){const c=typeof o=="object",d=typeof r=="object",h=typeof o=="string",u=typeof r=="string";if(c&&d)e[n]={...o,...r};else if(c&&u){const f=kT(r);e[n]={...o,...f}}else if(h&&d){const f=kT(o);e[n]={...f,...r}}else if(h&&u){const f=kT(o),g=kT(r);e[n]={...f,...g}}else c?e[n]=o:d?e[n]=r:h?e[n]=o:u&&(e[n]=r)}else e[n]=r!==void 0?r:o}for(const n of Object.getOwnPropertySymbols(i)){const o=e[n],r=i[n];e[n]=r!==void 0?r:o}}}return typeof e.style=="object"&&(e.style=_ge(e.style).replaceAll(`
`," ")),e.hidden!==!0&&(e.hidden=void 0,delete e.hidden),e.disabled!==!0&&(e.disabled=void 0,delete e.disabled),e}const elt=typeof window<"u"?window:void 0;function tlt(s){let e=s.activeElement;for(;e!=null&&e.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}var nw,RE,Tie;let ilt=(Tie=class{constructor(e={}){ke(this,nw);ke(this,RE);const{window:t=elt,document:i=t==null?void 0:t.document}=e;t!==void 0&&(Sd(this,nw,i),Sd(this,RE,Mie(n=>{const o=oc(t,"focusin",n),r=oc(t,"focusout",n);return()=>{o(),r()}})))}get current(){var e;return(e=Z(this,RE))==null||e.call(this),Z(this,nw)?tlt(Z(this,nw)):null}},nw=new WeakMap,RE=new WeakMap,Tie);new ilt;function nlt(s){Rge().then(s)}const slt=9;function olt(s){return rK(s)&&s.nodeType===slt}function rlt(s){var e;return rK(s)&&((e=s.constructor)==null?void 0:e.name)==="VisualViewport"}function alt(s){return olt(s)?s:rlt(s)?s.document:(s==null?void 0:s.ownerDocument)??document}function llt(s){let e=s.activeElement;for(;e!=null&&e.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}var ME;class cK{constructor(e){pt(this,"element");ke(this,ME,X(()=>this.element.current?this.element.current.getRootNode()??document:document));pt(this,"getDocument",()=>alt(this.root));pt(this,"getWindow",()=>this.getDocument().defaultView??window);pt(this,"getActiveElement",()=>llt(this.root));pt(this,"isActiveElement",e=>e===this.getActiveElement());pt(this,"querySelector",e=>this.root?this.root.querySelector(e):null);pt(this,"querySelectorAll",e=>this.root?this.root.querySelectorAll(e):[]);pt(this,"setTimeout",(e,t)=>this.getWindow().setTimeout(e,t));pt(this,"clearTimeout",e=>this.getWindow().clearTimeout(e));typeof e=="function"?this.element=zi.with(e):this.element=e}get root(){return I(Z(this,ME))}set root(e){Le(Z(this,ME),e)}getElementById(e){return this.root.getElementById(e)}}ME=new WeakMap;function dK(s,e){return{[Bge()]:t=>zi.isBox(s)?(s.current=t,ch(()=>e==null?void 0:e(t)),()=>{"isConnected"in t&&t.isConnected||(s.current=null)}):(s(t),ch(()=>e==null?void 0:e(t)),()=>{"isConnected"in t&&t.isConnected||s(null)})}}function clt({layout:s,panesArray:e,pivotIndices:t}){let i=0,n=100,o=0,r=0;const a=t[0];for(let h=0;h<e.length;h++){const u=e[h].constraints,{maxSize:f=100,minSize:g=0}=u;h===a?(i=g,n=f):(o+=g,r+=f)}const l=Math.min(n,100-o),c=Math.max(i,100-r),d=s[a];return{valueMax:l,valueMin:c,valueNow:d}}function ps(s,e="Assertion failed!"){if(!s)throw console.error(e),new Error(e)}const dlt=100,hK=10;function Pa(s,e,t=hK){return oE(s,e,t)===0}function oE(s,e,t=hK){const i=yie(s,t),n=yie(e,t);return Math.sign(i-n)}function uS(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function yie(s,e){return Number.parseFloat(s.toFixed(e))}const t5=typeof document<"u";function hlt(s){return s instanceof HTMLElement}function bge(s){return s.type==="keydown"}function vge(s){return s.type.startsWith("mouse")}function Cge(s){return s.type.startsWith("touch")}function jC({paneConstraints:s,paneIndex:e,initialSize:t}){const i=s[e];ps(i!=null,"Pane constraints should not be null.");const{collapsedSize:n=0,collapsible:o,maxSize:r=100,minSize:a=0}=i;let l=t;return oE(l,a)<0&&(l=ult(l,o,n,a)),l=Math.min(r,l),Number.parseFloat(l.toFixed(hK))}function ult(s,e,t,i){if(!e)return i;const n=(t+i)/2;return oE(s,n)<0?t:i}function y_(){}function flt({groupId:s,layout:e,panesArray:t,domContext:i}){const n=qk(s,i);for(let o=0;o<t.length-1;o++){const{valueMax:r,valueMin:a,valueNow:l}=clt({layout:e,panesArray:t,pivotIndices:[o,o+1]}),c=n[o];if(hlt(c)){const d=t[o];c.setAttribute("aria-controls",d.opts.id.current),c.setAttribute("aria-valuemax",`${Math.round(r)}`),c.setAttribute("aria-valuemin",`${Math.round(a)}`),c.setAttribute("aria-valuenow",l!=null?`${Math.round(l)}`:"")}}return()=>{for(const o of n)o.removeAttribute("aria-controls"),o.removeAttribute("aria-valuemax"),o.removeAttribute("aria-valuemin"),o.removeAttribute("aria-valuenow")}}function qk(s,e){return t5?Array.from(e.querySelectorAll(`[data-pane-resizer-id][data-pane-group-id="${s}"]`)):[]}function wge({groupId:s,id:e,domContext:t}){return t5?qk(s,t).findIndex(o=>o.getAttribute("data-pane-resizer-id")===e)??null:null}function Sie({groupId:s,dragHandleId:e,domContext:t}){const i=wge({groupId:s,id:e,domContext:t});return i!=null?[i,i+1]:[-1,-1]}function fC(s,e,t){const i=s.map(c=>c.constraints),n=yC(s,e),o=i[n],a=n===s.length-1?[n-1,n]:[n,n+1],l=t[n];return{...o,paneSize:l,pivotIndices:a}}function yC(s,e){return s.findIndex(t=>t.opts.id.current===e.opts.id.current)}function fS(s,e,t){for(let i=0;i<e.length;i++){const n=e[i],o=s[i];ps(o);const{collapsedSize:r=0,collapsible:a}=o.constraints,l=t[o.opts.id.current];if(!(l==null||n!==l))continue;t[o.opts.id.current]=n;const{onCollapse:c,onExpand:d,onResize:h}=o.callbacks;h==null||h(n,l),a&&(c||d)&&(d&&(l==null||l===r)&&n!==r&&d(),c&&(l==null||l!==r)&&n===r&&c())}}function glt({panesArray:s}){const e=Array(s.length),t=s.map(o=>o.constraints);let i=0,n=100;for(let o=0;o<s.length;o++){const r=t[o];ps(r);const{defaultSize:a}=r;a!=null&&(i++,e[o]=a,n-=a)}for(let o=0;o<s.length;o++){const r=t[o];ps(r);const{defaultSize:a}=r;if(a!=null)continue;const l=s.length-i,c=n/l;i++,e[o]=c,n-=c}return e}function mlt({layout:s,paneConstraints:e}){const t=[...s],i=t.reduce((o,r)=>o+r,0);if(t.length!==e.length)throw new Error(`Invalid ${e.length} pane layout: ${t.map(o=>`${o}%`).join(", ")}`);if(!Pa(i,100))for(let o=0;o<e.length;o++){const r=t[o];ps(r!=null);const a=100/i*r;t[o]=a}let n=0;for(let o=0;o<e.length;o++){const r=t[o];ps(r!=null);const a=jC({paneConstraints:e,paneIndex:o,initialSize:r});r!==a&&(n+=r-a,t[o]=a)}if(!Pa(n,0))for(let o=0;o<e.length;o++){const r=t[o];ps(r!=null);const a=r+n,l=jC({paneConstraints:e,paneIndex:o,initialSize:a});if(r!==l&&(n-=l-r,t[o]=l,Pa(n,0)))break}return t}function plt(s,e){if(!t5)return null;const t=e.querySelector(`[data-pane-group][data-pane-group-id="${s}"]`);return t||null}function uK(s,e){if(!t5)return null;const t=e.querySelector(`[data-pane-resizer-id="${s}"]`);return t||null}function _lt({event:s,dragHandleId:e,dir:t,initialDragState:i,domContext:n}){const o=t==="horizontal",r=uK(e,n);ps(r);const a=r.getAttribute("data-pane-group-id");ps(a);const{initialCursorPosition:l}=i,c=yge(t,s),d=plt(a,n);ps(d);const h=d.getBoundingClientRect(),u=o?h.width:h.height;return(c-l)/u*100}function blt({event:s,dragHandleId:e,dir:t,initialDragState:i,keyboardResizeBy:n,domContext:o}){if(bge(s)){const r=t==="horizontal";let a=0;s.shiftKey?a=100:n!=null?a=n:a=10;let l=0;switch(s.key){case"ArrowDown":l=r?0:a;break;case"ArrowLeft":l=r?-a:0;break;case"ArrowRight":l=r?a:0;break;case"ArrowUp":l=r?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return i==null?0:_lt({event:s,dragHandleId:e,dir:t,initialDragState:i,domContext:o})}function yge(s,e){const t=s==="horizontal";if(vge(e))return t?e.clientX:e.clientY;if(Cge(e)){const i=e.touches[0];return ps(i),t?i.screenX:i.screenY}else throw new Error(`Unsupported event type "${e.type}"`)}function vlt({groupId:s,handleId:e,panesArray:t,domContext:i}){var c,d;const n=uK(e,i),o=qk(s,i),r=n?o.indexOf(n):-1,a=((c=t[r])==null?void 0:c.opts.id.current)??null,l=((d=t[r+1])==null?void 0:d.opts.id.current)??null;return[a,l]}const Clt=typeof window<"u"?window:void 0;function wlt(s){let e=s.activeElement;for(;e!=null&&e.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}var sw,AE;class ylt{constructor(e={}){ke(this,sw);ke(this,AE);const{window:t=Clt,document:i=t==null?void 0:t.document}=e;t!==void 0&&(Sd(this,sw,i),Sd(this,AE,Mie(n=>{const o=oc(t,"focusin",n),r=oc(t,"focusout",n);return()=>{o(),r()}})))}get current(){var e;return(e=Z(this,AE))==null||e.call(this),Z(this,sw)?wlt(Z(this,sw)):null}}sw=new WeakMap,AE=new WeakMap;new ylt;function Slt(s,e){switch(s){case"post":Br(e);break;case"pre":Bz(e);break}}function Sge(s,e,t,i={}){const{lazy:n=!1}=i;let o=!n,r=Array.isArray(s)?[]:void 0;Slt(e,()=>{const a=Array.isArray(s)?s.map(c=>c()):s();if(!o){o=!0,r=a;return}const l=ch(()=>t(a,r));return r=a,l})}function Fx(s,e,t){Sge(s,"post",e,t)}function xlt(s,e,t){Sge(s,"pre",e,t)}Fx.pre=xlt;var PE,wu;class Llt{constructor(e){ke(this,PE);ke(this,wu);Sd(this,PE,e),Sd(this,wu,Symbol(e))}get key(){return Z(this,wu)}exists(){return Nie(Z(this,wu))}get(){const e=wb(Z(this,wu));if(e===void 0)throw new Error(`Context "${Z(this,PE)}" not found`);return e}getOr(e){const t=wb(Z(this,wu));return t===void 0?e:t}set(e){return ey(Z(this,wu),e)}}PE=new WeakMap,wu=new WeakMap;function gS({delta:s,layout:e,paneConstraints:t,pivotIndices:i,trigger:n}){if(Pa(s,0))return e;const o=[...e],[r,a]=i;let l=0;if(n==="keyboard"){{const d=s<0?a:r,h=t[d];if(ps(h),h.collapsible){const u=e[d];ps(u!=null);const f=t[d];ps(f);const{collapsedSize:g=0,minSize:m=0}=f;if(Pa(u,g)){const p=m-u;oE(p,Math.abs(s))>0&&(s=s<0?0-p:p)}}}{const d=s<0?r:a,h=t[d];ps(h);const{collapsible:u}=h;if(u){const f=e[d];ps(f!=null);const g=t[d];ps(g);const{collapsedSize:m=0,minSize:p=0}=g;if(Pa(f,p)){const v=f-m;oE(v,Math.abs(s))>0&&(s=s<0?0-v:v)}}}}{const d=s<0?1:-1;let h=s<0?a:r,u=0;for(;;){const g=e[h];ps(g!=null);const p=jC({paneConstraints:t,paneIndex:h,initialSize:100})-g;if(u+=p,h+=d,h<0||h>=t.length)break}const f=Math.min(Math.abs(s),Math.abs(u));s=s<0?0-f:f}{let h=s<0?r:a;for(;h>=0&&h<t.length;){const u=Math.abs(s)-Math.abs(l),f=e[h];ps(f!=null);const g=f-u,m=jC({paneConstraints:t,paneIndex:h,initialSize:g});if(!Pa(f,m)&&(l+=f-m,o[h]=m,l.toPrecision(3).localeCompare(Math.abs(s).toPrecision(3),void 0,{numeric:!0})>=0))break;s<0?h--:h++}}if(Pa(l,0))return e;{const d=s<0?a:r,h=e[d];ps(h!=null);const u=h+l,f=jC({paneConstraints:t,paneIndex:d,initialSize:u});if(o[d]=f,!Pa(f,u)){let g=u-f,p=s<0?a:r;for(;p>=0&&p<t.length;){const v=o[p];ps(v!=null);const b=v+g,w=jC({paneConstraints:t,paneIndex:p,initialSize:b});if(Pa(v,w)||(g-=w-v,o[p]=w),Pa(g,0))break;s>0?p--:p++}}}const c=o.reduce((d,h)=>h+d,0);return Pa(c,100)?o:e}let Az=null,s_=null;function xge(s){switch(s){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function Ilt(){s_!==null&&(document.head.removeChild(s_),Az=null,s_=null)}function e9(s,e){if(Az===s)return;Az=s;const t=xge(s);s_===null&&(s_=e.createElement("style"),e.head.appendChild(s_)),s_.innerHTML=`*{cursor: ${t}!important;}`}function Elt({defaultSize:s,dragState:e,layout:t,panesArray:i,paneIndex:n,precision:o=3}){const r=t[n];let a;return r==null?a=s??"1":i.length===1?a="1":a=r.toPrecision(o),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function xie(s){try{if(typeof localStorage>"u")throw new TypeError("localStorage is not supported in this environment");s.getItem=e=>localStorage.getItem(e),s.setItem=(e,t)=>localStorage.setItem(e,t)}catch(e){console.error(e),s.getItem=()=>null,s.setItem=()=>{}}}function Lge(s){return`paneforge:${s}`}function Ige(s){return s.map(t=>t.opts.order.current?`${t.opts.order.current}:${JSON.stringify(t.constraints)}`:JSON.stringify(t.constraints)).sort().join(",")}function Ege(s,e){try{const t=Lge(s),i=e.getItem(t),n=JSON.parse(i||"");if(typeof n=="object"&&n!==null)return n}catch{}return null}function klt(s,e,t){const i=Ege(s,t)||{},n=Ige(e);return i[n]||null}function Dlt(s,e,t,i,n){const o=Lge(s),r=Ige(e),a=Ege(s,n)||{};a[r]={expandToSizes:Object.fromEntries(t.entries()),layout:i};try{n.setItem(o,JSON.stringify(a))}catch(l){console.error(l)}}const Lie={};function Tlt(s,e=10){let t=null;return(...n)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{s(...n)},e)}}function Nlt({autoSaveId:s,layout:e,storage:t,panesArray:i,paneSizeBeforeCollapse:n}){if(e.length===0||e.length!==i.length)return;let o=Lie[s];o==null&&(o=Tlt(Dlt,dlt),Lie[s]=o);const r=[...i],a=new Map(n);o(s,r,a,e,t)}const FS={getItem:s=>(xie(FS),FS.getItem(s)),setItem:(s,e)=>{xie(FS),FS.setItem(s,e)}},fK=new Llt("PaneGroup");var OE,FE,BE,WE,HE,qP,VE;const EK=class EK{constructor(e){pt(this,"opts");pt(this,"attachment");pt(this,"domContext");ke(this,OE,At(null));ke(this,FE,At([]));ke(this,BE,At([]));ke(this,WE,At(!1));ke(this,HE,At(Dr({})));pt(this,"paneSizeBeforeCollapseMap",new Map);pt(this,"prevDelta",0);pt(this,"setLayout",e=>{this.layout=e});pt(this,"registerResizeHandle",e=>t=>{var v,b;t.preventDefault();const i=this.opts.direction.current,n=this.dragState,o=this.opts.id.current,r=this.opts.keyboardResizeBy.current,a=this.layout,l=this.panesArray,{initialLayout:c}=n??{},d=this.domContext.getDocument(),h=Sie({groupId:o,dragHandleId:e,domContext:this.domContext});let u=blt({event:t,dragHandleId:e,dir:i,initialDragState:n,keyboardResizeBy:r,domContext:this.domContext});if(u===0)return;const f=i==="horizontal";d.dir==="rtl"&&f&&(u=-u);const g=l.map(w=>w.constraints),m=gS({delta:u,layout:c??a,paneConstraints:g,pivotIndices:h,trigger:bge(t)?"keyboard":"mouse-or-touch"}),p=!uS(a,m);(vge(t)||Cge(t))&&this.prevDelta!==u&&(this.prevDelta=u,e9(p?f?"horizontal":"vertical":f?u<0?"horizontal-min":"horizontal-max":u<0?"vertical-min":"vertical-max",d)),p&&(this.setLayout(m),(b=(v=this.opts.onLayout).current)==null||b.call(v,m),fS(l,m,this.paneIdToLastNotifiedSizeMap))});pt(this,"resizePane",(e,t)=>{var h,u;const i=this.layout,n=this.panesArray,o=n.map(f=>f.constraints),{paneSize:r,pivotIndices:a}=fC(n,e,i);ps(r!=null);const c=yC(n,e)===n.length-1?r-t:t-r,d=gS({delta:c,layout:i,paneConstraints:o,pivotIndices:a,trigger:"imperative-api"});uS(i,d)||(this.setLayout(d),(u=(h=this.opts.onLayout).current)==null||u.call(h,d),fS(n,d,this.paneIdToLastNotifiedSizeMap))});pt(this,"startDragging",(e,t)=>{const i=this.opts.direction.current,n=this.layout,o=uK(e,this.domContext);ps(o);const r=yge(i,t);this.dragState={dragHandleId:e,dragHandleRect:o.getBoundingClientRect(),initialCursorPosition:r,initialLayout:n}});pt(this,"stopDragging",()=>{Ilt(),this.dragState=null});pt(this,"isPaneCollapsed",e=>{const t=this.panesArray,i=this.layout,{collapsedSize:n=0,collapsible:o,paneSize:r}=fC(t,e,i);return typeof r!="number"||typeof n!="number"?!1:o===!0&&Pa(r,n)});pt(this,"expandPane",e=>{var g,m;const t=this.layout,i=this.panesArray;if(!e.constraints.collapsible)return;const n=i.map(p=>p.constraints),{collapsedSize:o=0,paneSize:r,minSize:a=0,pivotIndices:l}=fC(i,e,t);if(r!==o)return;const c=this.paneSizeBeforeCollapseMap.get(e.opts.id.current),d=c!=null&&c>=a?c:a,u=yC(i,e)===i.length-1?r-d:d-r,f=gS({delta:u,layout:t,paneConstraints:n,pivotIndices:l,trigger:"imperative-api"});uS(t,f)||(this.setLayout(f),(m=(g=this.opts.onLayout).current)==null||m.call(g,f),fS(i,f,this.paneIdToLastNotifiedSizeMap))});pt(this,"collapsePane",e=>{var h,u;const t=this.layout,i=this.panesArray;if(!e.constraints.collapsible)return;const n=i.map(f=>f.constraints),{collapsedSize:o=0,paneSize:r,pivotIndices:a}=fC(i,e,t);if(ps(r!=null),r===o)return;this.paneSizeBeforeCollapseMap.set(e.opts.id.current,r);const c=yC(i,e)===i.length-1?r-o:o-r,d=gS({delta:c,layout:t,paneConstraints:n,pivotIndices:a,trigger:"imperative-api"});uS(t,d)||(this.layout=d,(u=(h=this.opts.onLayout).current)==null||u.call(h,d),fS(i,d,this.paneIdToLastNotifiedSizeMap))});pt(this,"getPaneSize",e=>fC(this.panesArray,e,this.layout).paneSize);pt(this,"getPaneStyle",(e,t)=>{const i=this.panesArray,n=this.layout,o=this.dragState,r=yC(i,e);return Elt({defaultSize:t,dragState:o,layout:n,panesArray:i,paneIndex:r})});pt(this,"isPaneExpanded",e=>{const{collapsedSize:t=0,collapsible:i,paneSize:n}=fC(this.panesArray,e,this.layout);return!i||n>t});pt(this,"registerPane",e=>{const t=[...this.panesArray,e];return t.sort((i,n)=>{const o=i.opts.order.current,r=n.opts.order.current;return o==null&&r==null?0:o==null?-1:r==null?1:o-r}),this.panesArray=t,this.panesArrayChanged=!0,()=>{const i=[...this.panesArray],n=yC(this.panesArray,e);n<0||(i.splice(n,1),this.panesArray=i,delete this.paneIdToLastNotifiedSizeMap[e.opts.id.current],this.panesArrayChanged=!0)}});ke(this,qP,()=>{const e=this.opts.id.current,t=qk(e,this.domContext),i=this.panesArray,n=t.map(o=>{const r=o.getAttribute("data-pane-resizer-id");if(!r)return y_;const[a,l]=vlt({groupId:e,handleId:r,panesArray:i,domContext:this.domContext});if(a==null||l==null)return y_;const d=jat(o,"keydown",h=>{if(h.defaultPrevented||h.key!=="Enter")return;h.preventDefault();const u=this.panesArray,f=u.findIndex(y=>y.opts.id.current===a);if(f<0)return;const g=u[f];ps(g);const m=this.layout,p=m[f],{collapsedSize:v=0,collapsible:b,minSize:w=0}=g.constraints;if(!(p!=null&&b))return;const C=gS({delta:Pa(p,v)?w-p:v-p,layout:m,paneConstraints:u.map(y=>y.constraints),pivotIndices:Sie({groupId:e,dragHandleId:r,domContext:this.domContext}),trigger:"keyboard"});m!==C&&(this.layout=C)});return()=>{d()}});return()=>{for(const o of n)o()}});ke(this,VE,X(()=>({id:this.opts.id.current,"data-pane-group":"","data-direction":this.opts.direction.current,"data-pane-group-id":this.opts.id.current,style:{display:"flex",flexDirection:this.opts.direction.current==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"},...this.attachment})));this.opts=e,this.attachment=dK(this.opts.ref),this.domContext=new cK(this.opts.ref),Fx([()=>this.opts.id.current,()=>this.layout,()=>this.panesArray],()=>flt({groupId:this.opts.id.current,layout:this.layout,panesArray:this.panesArray,domContext:this.domContext})),Br(()=>ch(()=>Z(this,qP).call(this))),Fx([()=>this.opts.autoSaveId.current,()=>this.layout,()=>this.opts.storage.current],()=>{this.opts.autoSaveId.current&&Nlt({autoSaveId:this.opts.autoSaveId.current,layout:this.layout,storage:this.opts.storage.current,panesArray:this.panesArray,paneSizeBeforeCollapse:this.paneSizeBeforeCollapseMap})}),Fx(()=>this.panesArrayChanged,()=>{var o,r;if(!this.panesArrayChanged)return;this.panesArrayChanged=!1;const t=this.layout;let i=null;if(this.opts.autoSaveId.current){const a=klt(this.opts.autoSaveId.current,this.panesArray,this.opts.storage.current);a&&(this.paneSizeBeforeCollapseMap=new Map(Object.entries(a.expandToSizes)),i=a.layout)}i==null&&(i=glt({panesArray:this.panesArray}));const n=mlt({layout:i,paneConstraints:this.panesArray.map(a=>a.constraints)});uS(t,n)||(this.layout=n,(r=(o=this.opts.onLayout).current)==null||r.call(o,n),fS(this.panesArray,n,this.paneIdToLastNotifiedSizeMap))})}static create(e){return fK.set(new EK(e))}get dragState(){return I(Z(this,OE))}set dragState(e){Le(Z(this,OE),e)}get layout(){return I(Z(this,FE))}set layout(e){Le(Z(this,FE),e)}get panesArray(){return I(Z(this,BE))}set panesArray(e){Le(Z(this,BE),e)}get panesArrayChanged(){return I(Z(this,WE))}set panesArrayChanged(e){Le(Z(this,WE),e,!0)}get paneIdToLastNotifiedSizeMap(){return I(Z(this,HE))}set paneIdToLastNotifiedSizeMap(e){Le(Z(this,HE),e,!0)}get props(){return I(Z(this,VE))}set props(e){Le(Z(this,VE),e)}};OE=new WeakMap,FE=new WeakMap,BE=new WeakMap,WE=new WeakMap,HE=new WeakMap,qP=new WeakMap,VE=new WeakMap;let Pz=EK;const Rlt=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home"];var Ma,zE,ow,UE,rw,jP,KP,GP,YP,XP,ZP,QP,JP,$E;const kK=class kK{constructor(e,t){pt(this,"opts");ke(this,Ma);pt(this,"attachment");pt(this,"domContext");ke(this,zE,X(()=>{var e;return((e=Z(this,Ma).dragState)==null?void 0:e.dragHandleId)===this.opts.id.current}));ke(this,ow,At(!1));pt(this,"resizeHandler",null);ke(this,UE,e=>{e.preventDefault(),!this.opts.disabled.current&&(Z(this,Ma).startDragging(this.opts.id.current,e),this.opts.onDraggingChange.current(!0))});ke(this,rw,()=>{const e=this.opts.ref.current;e&&(e.blur(),Z(this,Ma).stopDragging(),this.opts.onDraggingChange.current(!1))});ke(this,jP,e=>{if(this.opts.disabled.current||!this.resizeHandler||e.defaultPrevented)return;if(Rlt.includes(e.key)){e.preventDefault(),this.resizeHandler(e);return}if(e.key!=="F6")return;e.preventDefault();const t=qk(Z(this,Ma).opts.id.current,this.domContext),i=wge({groupId:Z(this,Ma).opts.id.current,id:this.opts.id.current,domContext:this.domContext});if(i===null)return;let n=0;e.shiftKey?i>0?n=i-1:n=t.length-1:i+1<t.length?n=i+1:n=0,t[n].focus()});ke(this,KP,()=>{Le(Z(this,ow),!1)});ke(this,GP,()=>{Le(Z(this,ow),!0)});ke(this,YP,e=>{Z(this,UE).call(this,e)});ke(this,XP,()=>{Z(this,rw).call(this)});ke(this,ZP,()=>{Z(this,rw).call(this)});ke(this,QP,()=>{Z(this,rw).call(this)});ke(this,JP,e=>{Z(this,UE).call(this,e)});ke(this,$E,X(()=>({id:this.opts.id.current,role:"separator","data-direction":Z(this,Ma).opts.direction.current,"data-pane-group-id":Z(this,Ma).opts.id.current,"data-active":I(Z(this,zE))?"pointer":I(Z(this,ow))?"keyboard":void 0,"data-enabled":!this.opts.disabled.current,"data-pane-resizer-id":this.opts.id.current,"data-pane-resizer":"",tabIndex:this.opts.tabIndex.current,style:{cursor:xge(Z(this,Ma).opts.direction.current),touchAction:"none",userSelect:"none","-webkit-user-select":"none","-webkit-touch-callout":"none"},onkeydown:Z(this,jP),onblur:Z(this,KP),onfocus:Z(this,GP),onmousedown:Z(this,YP),onmouseup:Z(this,XP),ontouchcancel:Z(this,ZP),ontouchend:Z(this,QP),ontouchstart:Z(this,JP),...this.attachment})));this.opts=e,Sd(this,Ma,t),this.attachment=dK(this.opts.ref),this.domContext=new cK(this.opts.ref),Br(()=>{this.opts.disabled.current?this.resizeHandler=null:this.resizeHandler=Z(this,Ma).registerResizeHandle(this.opts.id.current)}),Br(()=>{const i=this.opts.ref.current;if(!i)return;const n=this.opts.disabled.current,o=this.resizeHandler,r=I(Z(this,zE));if(n||o===null||!r)return;const a=u=>{o(u)},l=u=>{o(u)},c=()=>{i.blur(),Z(this,Ma).stopDragging(),this.opts.onDraggingChange.current(!1)},d=this.domContext.getDocument().body,h=this.domContext.getWindow();return pge(oc(d,"contextmenu",c),oc(d,"mousemove",a),oc(d,"touchmove",a,{passive:!1}),oc(d,"mouseleave",l),oc(h,"mouseup",c),oc(h,"touchend",c))})}static create(e){return new kK(e,fK.get())}get props(){return I(Z(this,$E))}set props(e){Le(Z(this,$E),e)}};Ma=new WeakMap,zE=new WeakMap,ow=new WeakMap,UE=new WeakMap,rw=new WeakMap,jP=new WeakMap,KP=new WeakMap,GP=new WeakMap,YP=new WeakMap,XP=new WeakMap,ZP=new WeakMap,QP=new WeakMap,JP=new WeakMap,$E=new WeakMap;let Oz=kK;var yu,qE,jE,KE,aw,eO,GE;const DK=class DK{constructor(e,t){pt(this,"opts");pt(this,"group");pt(this,"attachment");pt(this,"domContext");ke(this,yu,At(""));ke(this,qE,X(()=>({onCollapse:this.opts.onCollapse.current,onExpand:this.opts.onExpand.current,onResize:this.opts.onResize.current})));ke(this,jE,X(()=>({collapsedSize:this.opts.collapsedSize.current,collapsible:this.opts.collapsible.current,defaultSize:this.opts.defaultSize.current,maxSize:this.opts.maxSize.current,minSize:this.opts.minSize.current})));ke(this,KE,e=>{Le(Z(this,yu),e,!0),nlt(()=>{if(this.opts.ref.current){const t=this.opts.ref.current;if(!(getComputedStyle(t).transitionDuration!=="0s")){Le(Z(this,yu),"");return}const o=r=>{r.propertyName==="flex-grow"&&(Le(Z(this,yu),""),t.removeEventListener("transitionend",o))};t.addEventListener("transitionend",o)}else Le(Z(this,yu),"")})});pt(this,"pane",{collapse:()=>{Z(this,KE).call(this,"collapsing"),this.group.collapsePane(this)},expand:()=>{Z(this,KE).call(this,"expanding"),this.group.expandPane(this)},getSize:()=>this.group.getPaneSize(this),isCollapsed:()=>this.group.isPaneCollapsed(this),isExpanded:()=>this.group.isPaneExpanded(this),resize:e=>this.group.resizePane(this,e),getId:()=>this.opts.id.current});ke(this,aw,X(()=>this.group.isPaneCollapsed(this)));ke(this,eO,X(()=>I(Z(this,yu))!==""?I(Z(this,yu)):I(Z(this,aw))?"collapsed":"expanded"));ke(this,GE,X(()=>({id:this.opts.id.current,style:this.group.getPaneStyle(this,this.opts.defaultSize.current),"data-pane":"","data-pane-id":this.opts.id.current,"data-pane-group-id":this.group.opts.id.current,"data-collapsed":I(Z(this,aw))?"":void 0,"data-expanded":I(Z(this,aw))?void 0:"","data-pane-state":I(Z(this,eO)),...this.attachment})));this.opts=e,this.group=t,this.attachment=dK(this.opts.ref),this.domContext=new cK(this.opts.ref),Wz(()=>this.group.registerPane(this)),Fx(()=>zz(this.constraints),()=>{this.group.panesArrayChanged=!0})}static create(e){return new DK(e,fK.get())}get callbacks(){return I(Z(this,qE))}set callbacks(e){Le(Z(this,qE),e)}get constraints(){return I(Z(this,jE))}set constraints(e){Le(Z(this,jE),e)}get props(){return I(Z(this,GE))}set props(e){Le(Z(this,GE),e)}};yu=new WeakMap,qE=new WeakMap,jE=new WeakMap,KE=new WeakMap,aw=new WeakMap,eO=new WeakMap,GE=new WeakMap;let Fz=DK;var Mlt=Re("<div><!></div>");function Alt(s,e){const t=Hz();Lt(e,!0);let i=Ae(e,"autoSaveId",3,null),n=Ae(e,"id",3,t),o=Ae(e,"keyboardResizeBy",3,null),r=Ae(e,"onLayoutChange",3,y_),a=Ae(e,"storage",3,FS),l=Ae(e,"ref",15,null),c=vn(e,["$$slots","$$events","$$legacy","autoSaveId","direction","id","keyboardResizeBy","onLayoutChange","storage","ref","child","children"]);const d=Pz.create({id:zi.with(()=>n()??t),ref:zi.with(()=>l(),C=>l(C)),autoSaveId:zi.with(()=>i()),direction:zi.with(()=>e.direction),keyboardResizeBy:zi.with(()=>o()),onLayout:zi.with(()=>r()),storage:zi.with(()=>a())}),h=()=>d.layout,u=d.setLayout,f=()=>d.opts.id.current,g=X(()=>lK(c,d.props));var m={getLayout:h,setLayout:u,getId:f},p=gt(),v=De(p);{var b=C=>{var y=gt(),x=De(y);Hi(x,()=>e.child,()=>({props:I(g)})),Q(C,y)},w=C=>{var y=Mlt();vc(y,()=>({...I(g)}));var x=Ee(y);Hi(x,()=>e.children??jn),Ie(y),Q(C,y)};St(v,C=>{e.child?C(b):C(w,!1)})}return Q(s,p),It(m)}var Plt=Re("<div><!></div>");function Xft(s,e){const t=Hz();Lt(e,!0);let i=Ae(e,"id",3,t),n=Ae(e,"ref",15,null),o=Ae(e,"onCollapse",3,y_),r=Ae(e,"onExpand",3,y_),a=Ae(e,"onResize",3,y_),l=vn(e,["$$slots","$$events","$$legacy","id","ref","collapsedSize","collapsible","defaultSize","maxSize","minSize","onCollapse","onExpand","onResize","order","child","children"]);const c=Fz.create({id:zi.with(()=>i()),ref:zi.with(()=>n(),S=>n(S)),collapsedSize:zi.with(()=>e.collapsedSize),collapsible:zi.with(()=>e.collapsible),defaultSize:zi.with(()=>e.defaultSize),maxSize:zi.with(()=>e.maxSize),minSize:zi.with(()=>e.minSize),onCollapse:zi.with(()=>o()),onExpand:zi.with(()=>r()),onResize:zi.with(()=>a()),order:zi.with(()=>e.order)}),d=c.pane.collapse,h=c.pane.expand,u=c.pane.getSize,f=c.pane.isCollapsed,g=c.pane.isExpanded,m=c.pane.resize,p=c.pane.getId,v=X(()=>lK(l,c.props));var b={collapse:d,expand:h,getSize:u,isCollapsed:f,isExpanded:g,resize:m,getId:p},w=gt(),C=De(w);{var y=S=>{var L=gt(),E=De(L);Hi(E,()=>e.child,()=>({props:I(v)})),Q(S,L)},x=S=>{var L=Plt();vc(L,()=>({...I(v)}));var E=Ee(L);Hi(E,()=>e.children??jn),Ie(L),Q(S,L)};St(C,S=>{e.child?S(y):S(x,!1)})}return Q(s,w),It(b)}var Olt=Re("<div><!></div>");function Flt(s,e){const t=Hz();Lt(e,!0);let i=Ae(e,"id",3,t),n=Ae(e,"ref",15,null),o=Ae(e,"disabled",3,!1),r=Ae(e,"onDraggingChange",3,y_),a=Ae(e,"tabindex",3,0),l=vn(e,["$$slots","$$events","$$legacy","id","ref","disabled","onDraggingChange","tabindex","child","children"]);const c=Oz.create({id:zi.with(()=>i()),ref:zi.with(()=>n(),m=>n(m)),disabled:zi.with(()=>o()),onDraggingChange:zi.with(()=>r()),tabIndex:zi.with(()=>a())}),d=X(()=>lK(l,c.props));var h=gt(),u=De(h);{var f=m=>{var p=gt(),v=De(p);Hi(v,()=>e.child,()=>({props:I(d)})),Q(m,p)},g=m=>{var p=Olt();vc(p,()=>({...I(d)}));var v=Ee(p);Hi(v,()=>e.children??jn),Ie(p),Q(m,p)};St(u,m=>{e.child?m(f):m(g,!1)})}Q(s,h),It()}var Blt=Re('<div class="bg-border rounded-xs z-10 flex h-4 w-3 items-center justify-center border"><!></div>');function Zft(s,e){Lt(e,!0);let t=Ae(e,"ref",15,null),i=Ae(e,"withHandle",3,!1),n=vn(e,["$$slots","$$events","$$legacy","ref","class","withHandle"]);var o=gt(),r=De(o);{let a=X(()=>Pie("bg-border focus-visible:ring-ring focus-visible:outline-hidden relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:start-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 data-[direction=vertical]:h-px data-[direction=vertical]:w-full data-[direction=vertical]:after:start-0 data-[direction=vertical]:after:h-1 data-[direction=vertical]:after:w-full data-[direction=vertical]:after:-translate-y-1/2 data-[direction=vertical]:after:translate-x-0 [&[data-direction=vertical]>div]:rotate-90",e.class));Rt(r,()=>Flt,(l,c)=>{c(l,zn({"data-slot":"resizable-handle",get class(){return I(a)}},()=>n,{get ref(){return t()},set ref(d){t(d)},children:(d,h)=>{var u=gt(),f=De(u);{var g=m=>{var p=Blt(),v=Ee(p);mS(v,{class:"size-2.5"}),Ie(p),Q(m,p)};St(f,m=>{i()&&m(g)})}Q(d,u)},$$slots:{default:!0}}))})}Q(s,o),It()}function Qft(s,e){Lt(e,!0),Ae(e,"ref",11,null);let t=Ae(e,"this",15),i=vn(e,["$$slots","$$events","$$legacy","ref","this","class"]);var n=gt(),o=De(n);{let r=X(()=>Pie("flex h-full w-full data-[direction=vertical]:flex-col",e.class));Rt(o,()=>Alt,(a,l)=>{If(l(a,zn({"data-slot":"resizable-pane-group",get class(){return I(r)}},()=>i)),c=>t(c),()=>t())})}Q(s,n),It()}var Wlt=Re('<div class="flex items-center gap-1"><!> <!></div>'),Hlt=Re('<span class="text-muted-foreground italic">NULL</span>'),Vlt=Re('<span class="text-muted-foreground">&nbsp;</span>'),zlt=Re("<span><!></span>");function Ult(s,e){Lt(e,!0);let t=Ae(e,"isEditable",3,!1),i=At(!1),n=At(""),o=At(!1),r=At(null);function a(){t()&&(Le(n,l(e.value),!0),Le(i,!0),setTimeout(()=>{var p;return(p=I(r))==null?void 0:p.focus()},0))}function l(p){return p==null?"":typeof p=="object"?JSON.stringify(p):String(p)}async function c(){const p=l(e.value);if(I(n)===p){Le(i,!1);return}Le(o,!0);try{await e.onSave(I(n)),Le(i,!1)}finally{Le(o,!1)}}function d(p){p.key==="Enter"?(p.preventDefault(),c()):p.key==="Escape"&&(Le(n,l(e.value),!0),Le(i,!1))}function h(){I(o)||c()}var u=gt(),f=De(u);{var g=p=>{var v=Wlt(),b=Ee(v);ul(b,{onblur:h,onkeydown:d,get disabled(){return I(o)},class:"h-6 text-xs py-0 px-1",get ref(){return I(r)},set ref(y){Le(r,y,!0)},get value(){return I(n)},set value(y){Le(n,y,!0)}});var w=ue(b,2);{var C=y=>{jie(y,{class:"size-3 animate-spin shrink-0"})};St(w,y=>{I(o)&&y(C)})}Ie(v),Q(p,v)},m=p=>{var v=zlt();v.__dblclick=a,v.__keydown=y=>y.key==="Enter"&&a();var b=Ee(v);{var w=y=>{var x=Hlt();Q(y,x)},C=y=>{var x=gt(),S=De(x);{var L=M=>{var R=Vlt();Q(M,R)},E=M=>{var R=gt(),T=De(R);{var A=P=>{var W=pn();ze(H=>tt(W,H),[()=>JSON.stringify(e.value)]),Q(P,W)},N=P=>{var W=pn();ze(()=>tt(W,e.value)),Q(P,W)};St(T,P=>{typeof e.value=="object"?P(A):P(N,!1)},!0)}Q(M,R)};St(S,M=>{e.value===void 0||e.value===""?M(L):M(E,!1)},!0)}Q(y,x)};St(b,y=>{e.value===null?y(w):y(C,!1)})}Ie(v),ze(()=>{Qn(v,1,jo(t()?"cursor-pointer hover:bg-muted rounded px-1 -mx-1":"")),Xt(v,"role",t()?"button":void 0),Xt(v,"tabindex",t()?0:void 0)}),Q(p,v)};St(f,p=>{I(i)&&t()?p(g):p(m,!1)})}Q(s,u),It()}dv(["dblclick","keydown"]);var $lt=Re("<!> ",1),qlt=Re("<!> <!>",1);function jlt(s,e){Lt(e,!0);let t=Ae(e,"isDeleting",3,!1);var i=gt(),n=De(i);Rt(n,()=>Wie,(o,r)=>{r(o,{children:(a,l)=>{var c=qlt(),d=De(c);{const u=(f,g)=>{fo(f,zn(()=>g==null?void 0:g().props,{variant:"ghost",size:"icon",class:"h-6 w-6",get disabled(){return t()},children:(p,v)=>{var b=gt(),w=De(b);{var C=x=>{jie(x,{class:"size-3 animate-spin"})},y=x=>{rme(x,{class:"size-3"})};St(w,x=>{t()?x(C):x(y,!1)})}Q(p,b)},$$slots:{default:!0}}))};Rt(d,()=>Hie,(f,g)=>{g(f,{child:u,$$slots:{child:!0}})})}var h=ue(d,2);Rt(h,()=>Vie,(u,f)=>{f(u,{align:"start",children:(g,m)=>{var p=gt(),v=De(p);Rt(v,()=>zie,(b,w)=>{w(b,{get onclick(){return e.onDelete},class:"text-destructive focus:text-destructive",children:(C,y)=>{var x=$lt(),S=De(x);hme(S,{class:"size-4 me-2"});var L=ue(S);ze(E=>tt(L,` ${E??""}`),[()=>Wme()]),Q(C,x)},$$slots:{default:!0}})}),Q(g,p)},$$slots:{default:!0}})}),Q(a,c)},$$slots:{default:!0}})}),Q(s,i),It()}var Klt=Re("<div></div>"),Glt=Re('<div class="relative flex items-center group"><div> </div>  <div class="absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-primary/50 group-hover:bg-border transition-colors" role="separator" aria-orientation="vertical"></div></div>'),Ylt=Re("<div><!></div>"),Xlt=Re("<div><!></div>"),Zlt=Re("<div><!> <!></div>"),Qlt=Re('<div><div class="min-w-fit"><div><!> <!></div> <div></div></div></div>'),Jlt=Re("<!> ",1),ect=Re("<!> ",1),tct=Re("<!> ",1),ict=Re("<!> <!> <!>",1),nct=Re("<!> <!>",1);function Jft(s,e){Lt(e,!0);const t=U=>{var $=Qlt(),Y=Ee($),se=Ee(Y),j=Ee(se);{var ie=J=>{var le=Klt();let be;ze(()=>be=Qn(le,1,jo(h()?"px-1 py-1":"px-2 py-2"),null,be,{flex:!0,"items-center":!0})),Q(J,le)};St(j,J=>{i()&&J(ie)})}var te=ue(j,2);Xn(te,17,()=>e.columns,tc,(J,le,be)=>{var Ce=Glt(),Je=Ee(Ce),qe=Ee(Je,!0);Ie(Je);var mt=ue(Je,2);mt.__mousedown=Ke=>P(be,Ke),Ie(Ce),ze(()=>{Qn(Je,1,jo(["font-medium flex-1 truncate",h()?"px-2 py-1":"px-4 py-2"])),tt(qe,I(le))}),Q(J,Ce)}),Ie(se);var pe=ue(se,2);Xn(pe,21,()=>I(T),({row:J,index:le,offset:be})=>le,(J,le)=>{let be=()=>I(le).row,Ce=()=>I(le).index,Je=()=>I(le).offset;var qe=Zlt(),mt=Ee(qe);{var Ke=ft=>{var Pe=Ylt(),Be=Ee(Pe);{let Me=X(()=>r()===Ce());jlt(Be,{onDelete:async()=>o()(Ce(),be()),get isDeleting(){return I(Me)}})}Ie(Pe),ze(()=>Qn(Pe,1,jo(["flex items-center",h()?"px-1 py-0.5":"px-2 py-1"]))),Q(ft,Pe)};St(mt,ft=>{i()&&ft(Ke)})}var nt=ue(mt,2);Xn(nt,17,()=>e.columns,tc,(ft,Pe)=>{var Be=Xlt();Be.__contextmenu=()=>d()(be()[I(Pe)],I(Pe),be());var Me=Ee(Be);Ult(Me,{get value(){return be()[I(Pe)]},get isEditable(){return i()},onSave:rt=>n()(Ce(),I(Pe),rt)}),Ie(Be),ze(()=>Qn(Be,1,jo(["flex items-center overflow-hidden",h()?"px-2 py-1":"px-4 py-2"]))),Q(ft,Be)}),Ie(qe),ze(()=>{Qn(qe,1,jo(["border-b hover:bg-muted/50 grid",h()?"text-xs":"text-sm",Ce()%2===0&&"bg-muted/20"])),El(qe,`position: absolute; top: ${Je()??""}px; left: 0; right: 0; height: ${I(u)??""}px; grid-template-columns: ${I(A)??""};`)}),Q(J,qe)}),Ie(pe),Ie(Y),Ie($),If($,J=>Le(w,J),()=>I(w)),ze(()=>{Qn($,1,jo(["h-full overflow-auto",h()&&"nowheel"])),Qn(se,1,jo(["grid bg-muted border-b sticky top-0 z-10",h()?"text-xs":"text-sm"])),El(se,`height: ${I(f)??""}px; grid-template-columns: ${I(A)??""};`),El(pe,`height: ${I(L)??""}px; position: relative;`)}),ku("scroll",$,N),Q(U,$)};let i=Ae(e,"isEditable",3,!1),n=Ae(e,"onCellSave",3,async()=>{}),o=Ae(e,"onRowDelete",3,()=>{}),r=Ae(e,"deletingRowIndex",3,null),a=Ae(e,"onCopyCell",3,()=>{}),l=Ae(e,"onCopyRow",3,()=>{}),c=Ae(e,"onCopyColumn",3,()=>{}),d=Ae(e,"onCellRightClick",3,()=>{}),h=Ae(e,"compact",3,!1);const u=X(()=>h()?28:37),f=X(()=>h()?28:37),g=10,m=X(()=>h()?100:150),p=50;let v=At(0),b=At(0),w=At(void 0),C=At(Dr([]));Br(()=>{e.columns.length!==I(C).length&&Le(C,e.columns.map(()=>I(m)),!0)});let y=At(null),x=At(0),S=At(0);const L=X(()=>e.rows.length*I(u)),E=X(()=>Math.max(0,Math.floor(I(v)/I(u))-g)),M=X(()=>Math.ceil(I(b)/I(u))+g*2),R=X(()=>Math.min(e.rows.length,I(E)+I(M))),T=X(()=>e.rows.slice(I(E),I(R)).map((U,$)=>({row:U,index:I(E)+$,offset:(I(E)+$)*I(u)}))),A=X(()=>(i()?"40px ":"")+I(C).map(U=>`${U}px`).join(" "));function N(U){const $=U.target;Le(v,$.scrollTop,!0)}Br(()=>{if(I(w)){const U=new ResizeObserver($=>{var Y;Le(b,((Y=$[0])==null?void 0:Y.contentRect.height)??0,!0)});return U.observe(I(w)),()=>U.disconnect()}});function P(U,$){$.preventDefault(),Le(y,U,!0),Le(x,$.clientX,!0),Le(S,I(C)[U],!0),document.addEventListener("mousemove",W),document.addEventListener("mouseup",H),document.body.style.cursor="col-resize",document.body.style.userSelect="none"}function W(U){if(I(y)===null)return;const $=U.clientX-I(x),Y=Math.max(p,I(S)+$);I(C)[I(y)]=Y}function H(){Le(y,null),document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",H),document.body.style.cursor="",document.body.style.userSelect=""}var G=gt(),V=De(G);Rt(V,()=>Uge,(U,$)=>{$(U,{children:(Y,se)=>{var j=nct(),ie=De(j);Rt(ie,()=>$ge,(pe,J)=>{J(pe,{class:"flex-1 overflow-auto min-h-0 block",children:(le,be)=>{t(le)},$$slots:{default:!0}})});var te=ue(ie,2);Rt(te,()=>qge,(pe,J)=>{J(pe,{children:(le,be)=>{var Ce=gt(),Je=De(Ce);Rt(Je,()=>jge,(qe,mt)=>{mt(qe,{class:"w-48",children:(Ke,nt)=>{var ft=ict(),Pe=De(ft);Rt(Pe,()=>a5,(rt,Et)=>{Et(rt,{get onclick(){return a()},children:(qt,Ge)=>{var at=Jlt(),yt=De(at);l5(yt,{class:"size-4 me-2"});var Jt=ue(yt);ze(li=>tt(Jt,` ${li??""}`),[()=>bme()]),Q(qt,at)},$$slots:{default:!0}})});var Be=ue(Pe,2);Rt(Be,()=>a5,(rt,Et)=>{Et(rt,{get onclick(){return l()},children:(qt,Ge)=>{var at=ect(),yt=De(at);l5(yt,{class:"size-4 me-2"});var Jt=ue(yt);ze(li=>tt(Jt,` ${li??""}`),[()=>Lme()]),Q(qt,at)},$$slots:{default:!0}})});var Me=ue(Be,2);Rt(Me,()=>a5,(rt,Et)=>{Et(rt,{get onclick(){return c()},children:(qt,Ge)=>{var at=tct(),yt=De(at);l5(yt,{class:"size-4 me-2"});var Jt=ue(yt);ze(li=>tt(Jt,` ${li??""}`),[()=>Rme()]),Q(qt,at)},$$slots:{default:!0}})}),Q(Ke,ft)},$$slots:{default:!0}})}),Q(le,Ce)},$$slots:{default:!0}})}),Q(Y,j)},$$slots:{default:!0}})}),Q(s,G),It()}dv(["mousedown","contextmenu"]);var sct=Re("<!> <!>",1),oct=Re(' <span class="text-xs text-muted-foreground font-normal"> </span>',1),rct=Re("<!> <!>",1),act=Re("<!> <!>",1),lct=Re('<div class="grid gap-2"><!> <!></div>'),cct=Re("<!> <!>",1),dct=Re('<!> <div class="overflow-y-auto flex-1 py-4"><div class="grid gap-4"></div></div> <!>',1);function egt(s,e){Lt(e,!0);let t=Ae(e,"open",15,!1),i=At(Dr({}));Br(()=>{if(t()){const c={};e.parameters.forEach(d=>{c[d.name]=d.defaultValue??""}),Le(i,c,!0)}});const n=()=>{const c=e.parameters.map(d=>({name:d.name,value:Jge(I(i)[d.name]??"",d.type)}));e.onExecute(c),t(!1)},o=()=>{t(!1),e.onCancel()},r=c=>{c.key==="Enter"&&(c.metaKey||c.ctrlKey)&&(c.preventDefault(),n())},a=c=>{switch(c){case"number":return"number";case"date":return"date";case"datetime":return"datetime-local";default:return"text"}},l=c=>c.description??Cpe({name:c.name});Kge(s,{get open(){return t()},set open(c){t(c)},children:(c,d)=>{Gge(c,{class:"max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:(h,u)=>{var f=dct(),g=De(f);Yge(g,{children:(b,w)=>{var C=sct(),y=De(C);Xge(y,{children:(S,L)=>{Oi();var E=pn();ze(M=>tt(E,M),[()=>jme()]),Q(S,E)},$$slots:{default:!0}});var x=ue(y,2);Zge(x,{children:(S,L)=>{Oi();var E=pn();ze(M=>tt(E,M),[()=>Jme()]),Q(S,E)},$$slots:{default:!0}}),Q(b,C)},$$slots:{default:!0}});var m=ue(g,2);m.__keydown=r;var p=Ee(m);Xn(p,21,()=>e.parameters,b=>b.name,(b,w)=>{var C=lct(),y=Ee(C);Uie(y,{get for(){return I(w).name},class:"flex items-center gap-2",children:(E,M)=>{Oi();var R=oct(),T=De(R),A=ue(T),N=Ee(A);Ie(A),ze(()=>{tt(T,`${I(w).name??""} `),tt(N,`(${I(w).type??""})`)}),Q(E,R)},$$slots:{default:!0}});var x=ue(y,2);{var S=E=>{Oc(E,{type:"single",get value(){return I(i)[I(w).name]},onValueChange:M=>{M&&(I(i)[I(w).name]=M)},children:(M,R)=>{var T=act(),A=De(T);Ac(A,{class:"w-full",children:(P,W)=>{Oi();var H=pn();ze(G=>tt(H,G),[()=>I(i)[I(w).name]==="true"?"True":I(i)[I(w).name]==="false"?"False":Epe()]),Q(P,H)},$$slots:{default:!0}});var N=ue(A,2);Pc(N,{children:(P,W)=>{var H=rct(),G=De(H);hl(G,{value:"true",children:(U,$)=>{Oi();var Y=pn("True");Q(U,Y)},$$slots:{default:!0}});var V=ue(G,2);hl(V,{value:"false",children:(U,$)=>{Oi();var Y=pn("False");Q(U,Y)},$$slots:{default:!0}}),Q(P,H)},$$slots:{default:!0}}),Q(M,T)},$$slots:{default:!0}})},L=E=>{{let M=X(()=>a(I(w).type)),R=X(()=>l(I(w)));ul(E,{get id(){return I(w).name},get type(){return I(M)},get placeholder(){return I(R)},get value(){return I(i)[I(w).name]},set value(T){I(i)[I(w).name]=T}})}};St(x,E=>{I(w).type==="boolean"?E(S):E(L,!1)})}Ie(C),Q(b,C)}),Ie(p),Ie(m);var v=ue(m,2);Qge(v,{children:(b,w)=>{var C=cct(),y=De(C);fo(y,{variant:"outline",onclick:o,children:(S,L)=>{Oi();var E=pn();ze(M=>tt(E,M),[()=>fpe()]),Q(S,E)},$$slots:{default:!0}});var x=ue(y,2);fo(x,{onclick:n,children:(S,L)=>{Oi();var E=pn();ze(M=>tt(E,M),[()=>rpe()]),Q(S,E)},$$slots:{default:!0}}),Q(b,C)},$$slots:{default:!0}}),Q(h,f)},$$slots:{default:!0}})},$$slots:{default:!0}}),It()}dv(["keydown"]);export{s9 as A,PK as B,Tct as C,Oct as D,RLe as E,Wct as F,JLe as G,Ib as H,jLe as I,ame as J,lme as K,jie as L,Hu as M,dme as N,nme as O,Xft as P,LIe as Q,Nct as R,Mct as S,Bct as T,mrt as U,Jft as V,Act as W,Rct as X,tse as Y,Qft as a,Zft as b,$ft as c,Mfe as d,Jw as e,Tz as f,qft as g,egt as h,Fct as i,Kft as j,Gft as k,Xe as l,ese as m,ESe as n,hv as o,jft as p,Em as q,SSe as r,Pct as s,Yfe as t,uv as u,rO as v,hO as w,Ci as x,Gd as y,BS as z};
